{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"(English Documents Available) \u4e00\u3001TencentOS Tiny \u7b80\u4ecb TencentOS tiny \u662f\u817e\u8baf\u9762\u5411\u7269\u8054\u7f51\u9886\u57df\u5f00\u53d1\u7684\u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5177\u6709\u4f4e\u529f\u8017\uff0c\u4f4e\u8d44\u6e90\u5360\u7528\uff0c\u6a21\u5757\u5316\uff0c\u5b89\u5168\u53ef\u9760\u7b49\u7279\u70b9\uff0c\u53ef\u6709\u6548\u63d0\u5347\u7269\u8054\u7f51\u7ec8\u7aef\u4ea7\u54c1\u5f00\u53d1\u6548\u7387\u3002TencentOS tiny \u63d0\u4f9b\u7cbe\u7b80\u7684 RTOS \u5185\u6838\uff0c\u5185\u6838\u7ec4\u4ef6\u53ef\u88c1\u526a\u53ef\u914d\u7f6e\uff0c\u53ef\u5feb\u901f\u79fb\u690d\u5230\u591a\u79cd\u4e3b\u6d41 MCU (\u5982 STM32 \u5168\u7cfb\u5217)\u53ca\u6a21\u7ec4\u82af\u7247\u4e0a\u3002\u800c\u4e14\uff0c\u57fa\u4e8e RTOS \u5185\u6838\u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684\u7269\u8054\u7f51\u7ec4\u4ef6\uff0c\u5185\u90e8\u96c6\u6210\u4e3b\u6d41\u7269\u8054\u7f51\u534f\u8bae\u6808\uff08\u5982 CoAP/MQTT/TLS/DTLS/LoRaWAN/NB-IoT \u7b49\uff09\uff0c\u53ef\u52a9\u529b\u7269\u8054\u7f51\u7ec8\u7aef\u8bbe\u5907\u53ca\u4e1a\u52a1\u5feb\u901f\u63a5\u5165\u817e\u8baf\u4e91\u7269\u8054\u7f51\u5e73\u53f0\u3002 1\u3001TencentOS tiny\u6574\u4f53\u67b6\u6784 TencentOS tiny \u4e3b\u4f53\u67b6\u6784\u56fe\uff0c\u4ece\u4e0b\u5230\u4e0a\u4e3b\u8981\u5305\u62ec\uff1a CPU \u5e93 \uff1aTencentOS tiny \u652f\u6301\u7684 CPU IP \u6838\u67b6\u6784\uff0c\u5f53\u524d\u4e3b\u8981\u652f\u6301 ARM Cortex M0/3/4/7\uff0cCortex A7\uff0cRISC-V\u3001MSP430\u3001AVR\u3001STM8 \u7b49\u3002 \u9a71\u52a8\u7ba1\u7406\u5c42 \uff1a\u5305\u62ec\u677f\u7ea7\u652f\u6301\u5305\uff08BSP\uff0c\u4e3b\u8981\u7531 MCU \u82af\u7247\u5382\u5bb6\u5f00\u53d1\u4e0e\u7ef4\u62a4\uff09\u3001\u786c\u4ef6\u62bd\u8c61\u5c42\uff08HAL\uff0c\u4e3b\u8981\u7531 TencentOS tiny \u63d0\u4f9b\uff0c\u65b9\u4fbf\u4e0d\u540c\u82af\u7247\u7684\u9002\u914d\u4e0e\u79fb\u690d\uff09\u3001\u8bbe\u5907\u9a71\u52a8\uff08Drivers\uff0c\u4f8b\u5982 Wi-Fi\u3001GPRS\u3001LoRa \u7b49\u6a21\u5757\u7684\u9a71\u52a8\u7a0b\u5e8f\uff09\u3002 \u5185\u6838 \uff1aTencentOS tiny \u5b9e\u65f6\u5185\u6838\u5305\u62ec\u4efb\u52a1\u7ba1\u7406\u3001\u5b9e\u65f6\u8c03\u5ea6\u3001\u65f6\u95f4\u7ba1\u7406\u3001\u4e2d\u65ad\u7ba1\u7406\u3001\u5185\u5b58\u7ba1\u7406\u3001\u5f02\u5e38\u5904\u7406\u3001\u8f6f\u4ef6\u5b9a\u65f6\u5668\u3001\u94fe\u8868\u3001\u6d88\u606f\u961f\u5217\u3001\u4fe1\u53f7\u91cf\u3001\u4e92\u65a5\u9501\u3001\u4e8b\u4ef6\u6807\u5fd7\u7b49\u6a21\u5757\u3002 IoT \u534f\u8bae\u6808 \uff1aTencentOS tiny \u63d0\u4f9b lwip\u3001AT Adapter\u3001SAL \u5c42\uff0c\u652f\u6301\u4e0d\u540c\u7684\u7f51\u7edc\u786c\u4ef6\uff0c\u4f8b\u5982\u4ee5\u592a\u7f51\u3001\u4e32\u53e3 Wi-Fi\u3001GPRS\u3001NB-IoT\u30014G \u7b49\u901a\u4fe1\u6a21\u5757\u3002TCP/IP \u7f51\u7edc\u534f\u8bae\u6808\u4e0a\u63d0\u4f9b\u5e38\u7528\u7684\u7269\u8054\u7f51\u534f\u8bae\u6808\uff0c\u4f8b\u5982 CoAP\u3001MQTT\uff0c\u652f\u6491\u7ec8\u7aef\u4e1a\u52a1\u5feb\u901f\u63a5\u5165\u817e\u8baf\u4e91\u3002 \u5b89\u5168\u6846\u67b6 \uff1aTencentOS tiny \u4e3a\u4e86\u786e\u4fdd\u7269\u8054\u7f51\u7ec8\u7aef\u6570\u636e\u4f20\u8f93\u5b89\u5168\u4ee5\u53ca\u8bbe\u5907\u8ba4\u8bc1\u5b89\u5168\uff0c\u63d0\u4f9b\u4e86\u5b8c\u6574\u7684\u5b89\u5168\u89e3\u51b3\u65b9\u6848\u3002\u5b89\u5168\u6846\u67b6\u63d0\u4f9b\u7684 DTLS \u548c TLS \u5b89\u5168\u534f\u8bae\uff0c\u52a0\u56fa\u4e86 COAP \u53ca MQTT \u7684\u4f20\u8f93\u5c42\uff0c\u53ef\u786e\u4fdd\u7269\u8054\u7f51\u7ec8\u7aef\u5728\u5bf9\u63a5\u817e\u8baf\u4e91\u65f6\u5b9e\u73b0\u5b89\u5168\u8ba4\u8bc1\u548c\u6570\u636e\u52a0\u5bc6\uff1b\u53e6\u5916\u9488\u5bf9\u4f4e\u8d44\u6e90\u7684\u7ec8\u7aef\u786c\u4ef6\uff0c\u5b89\u5168\u6846\u67b6\u8fd8\u63d0\u4f9b\u4e0e\u817e\u8baf\u4e91 IoTHub \u914d\u5957\u7684\u5bc6\u94a5\u8ba4\u8bc1\u65b9\u6848\uff0c\u786e\u4fdd\u8d44\u6e90\u53d7\u9650\u8bbe\u5907\u4e5f\u80fd\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u5b9e\u73b0\u8bbe\u5907\u5b89\u5168\u8ba4\u8bc1\u3002 \u7ec4\u4ef6\u6846\u67b6 \uff1aTencentOS tiny \u63d0\u4f9b\u6587\u4ef6\u7cfb\u7edf\u3001KV \u5b58\u50a8\u3001\u81ea\u7ec4\u7f51\u3001JS \u5f15\u64ce\u3001\u4f4e\u529f\u8017\u6846\u67b6\u3001\u8bbe\u5907\u6846\u67b6\u3001OTA\u3001\u8c03\u8bd5\u5de5\u5177\u94fe\u7b49\u4e00\u7cfb\u5217\u7ec4\u4ef6\uff0c\u4f9b\u7528\u6237\u6839\u636e\u4e1a\u52a1\u573a\u666f\u9009\u7528\u3002 \u5f00\u653e API\uff08\u89c4\u5212\u5f00\u53d1\u4e2d\uff09 \uff1aTencentOS tiny \u5c06\u5728\u534f\u8bae\u4e2d\u95f4\u4ef6\u548c\u6846\u67b6\u5c42\u4e0a\u63d0\u4f9b\u5f00\u653e API \u51fd\u6570\uff0c\u65b9\u4fbf\u7528\u6237\u8c03\u7528\u4e2d\u95f4\u4ef6\u529f\u80fd\uff0c\u4f7f\u7528\u6237\u65e0\u9700\u8fc7\u591a\u5173\u5fc3\u4e2d\u95f4\u4ef6\u5177\u4f53\u5b9e\u73b0\uff0c\u5feb\u901f\u5bf9\u63a5\u817e\u8baf\u4e91\uff0c\u5b9e\u73b0\u7ec8\u7aef\u4e1a\u52a1\u4e0a\u4e91\u7684\u9700\u6c42\uff0c\u671f\u671b\u6700\u5927\u7a0b\u5ea6\u51cf\u5c11\u7ec8\u7aef\u7269\u8054\u7f51\u4ea7\u54c1\u5f00\u53d1\u5468\u671f\uff0c\u8282\u7701\u5f00\u53d1\u6210\u672c\u3002 \u793a\u4f8b\u5e94\u7528 \uff1aTencentOS tiny \u63d0\u4f9b\u7684\u793a\u4f8b\u4ee3\u7801\uff0c\u6a21\u5757\u6d4b\u8bd5\u4ee3\u7801\u7b49\uff0c\u65b9\u4fbf\u7528\u6237\u53c2\u8003\u4f7f\u7528\u3002 2\u3001TencentOS tiny \u4f18\u52bf (1).\u5c0f\u4f53\u79ef \u6700\u5c0f\u5185\u6838\uff1aRAM 0.6KB\uff0cROM 1.8KB \u5178\u578b LoraWAN \u53ca\u4f20\u611f\u5668\u5e94\u7528\uff1aRAM 3.3KB\uff0cROM 12KB (2).\u4f4e\u529f\u8017 \u4f11\u7720\u6700\u4f4e\u529f\u8017\u4f4e\u81f3 2uA \u652f\u6301\u5916\u8bbe\u529f\u8017\u7ba1\u7406\u6846\u67b6 (3).\u4e30\u5bcc\u7684 IoT \u7ec4\u4ef6 \u96c6\u6210\u4e3b\u6d41 IoT \u534f\u8bae\u6808 \u591a\u79cd\u901a\u4fe1\u6a21\u7ec4SAL\u5c42\u9002\u914d\u6846\u67b6\uff1b \u652f\u6301 OTA \u5347\u7ea7 \u63d0\u4f9b\u7b80\u5355\u6613\u7528\u7aef\u4e91 API\uff0c\u52a0\u901f\u7528\u6237\u4e1a\u52a1\u63a5\u5165\u817e\u8baf\u4e91 (4).\u53ef\u9760\u7684\u5b89\u5168\u6846\u67b6 \u591a\u6837\u5316\u7684\u5b89\u5168\u5206\u7ea7\u65b9\u6848 \u5747\u8861\u5b89\u5168\u9700\u6c42&\u6210\u672c\u63a7\u5236 (5).\u826f\u597d\u7684\u53ef\u79fb\u690d\u6027 \u5185\u6838\u53caIoT\u7ec4\u4ef6\u9ad8\u5ea6\u89e3\u8026\uff0c\u63d0\u4f9b\u6807\u51c6\u9002\u914d\u5c42 \u63d0\u4f9b\u81ea\u52a8\u5316\u79fb\u690d\u5de5\u5177\uff0c\u63d0\u5347\u5f00\u53d1\u6548\u7387 (6).\u4fbf\u6377\u7684\u8c03\u8bd5\u624b\u6bb5 \u63d0\u4f9b\u4e91\u5316\u7684\u6700\u540e\u4e00\u5c4f\u8c03\u8bd5\u529f\u80fd \u6545\u969c\u73b0\u573a\u4fe1\u606f\u81ea\u52a8\u4e0a\u4f20\u4e91\u5e73\u53f0\uff0c\u65b9\u4fbf\u5f00\u53d1\u4eba\u5458\u8c03\u8bd5\u5206\u6790 3\u3001TencentOS tiny\u643a\u624b\u5408\u4f5c\u4f19\u4f34\u5171\u5efaIoT\u751f\u6001 TencentOS tiny \u81ea\u5f00\u6e90\u53d1\u5e03\u4ee5\u6765\u4e5f\u5728\u52aa\u529b\u53d1\u5c55\u5408\u4f5c\u4f19\u4f34\uff0c\u671f\u5f85\u5408\u4f5c\u5171\u8d62\uff0c\u5171\u540c\u6269\u5c55 IoT \u5e94\u7528\u751f\u6001\u3002\u76ee\u524d\u5df2\u7ecf\u4e0e\u591a\u5bb6 MCU/IP \u6838\u5382\u5bb6\u8fbe\u6210\u4e86\u5408\u4f5c\uff0c\u5305\u62ec\u610f\u6cd5\u534a\u5bfc\u4f53\u3001\u6069\u667a\u6d66\u534a\u5bfc\u4f53\u3001\u5146\u6613\u534a\u5bfc\u4f53\u3001ARM\u3001\u534e\u5927\u534a\u5bfc\u4f53\u3001\u82af\u6765\u79d1\u6280\u7b49\uff1b\u4e5f\u4e0e\u65e0\u7ebf SOC \u548c\u6a21\u7ec4\u5382\u5bb6\u8fbe\u6210\u4e86\u5e7f\u6cdb\u7684\u5408\u4f5c\u5173\u7cfb\uff0c\u5305\u62ec\u745e\u5174\u6052\u65b9\u3001\u56fd\u6c11\u6280\u672f\u3001Nordic \u84dd\u7259\u3001\u4eae\u725b\u534a\u5bfc\u4f53\u3001\u6709\u4eba\u7269\u8054\u7f51\u7b49\uff0c \u9664\u4e86MCU\u548c\u6a21\u7ec4\u5916\uff0cTencentOS tiny \u4e5f\u79ef\u6781\u63a8\u8fdb\u7ec8\u7aef\u4ea7\u54c1\u53ca\u9879\u76ee\u7684\u843d\u5730\uff0c\u76ee\u524d\u5df2\u7ecf\u5f62\u6210\u4e86AI\u667a\u6167\u519c\u4e1a\u3001\u667a\u80fd\u8d27\u67dc\u3001\u667a\u6167\u4f1a\u8bae\u5ba4\u7b49\u65b9\u6848\uff0c\u5e76\u4e14\u5728\u817e\u8baf\u5185\u90e8\u4e0e AI \u5e73\u53f0\u90e8\u3001\u817e\u8baf\u5fae\u74f4\u3001QQ family \u8fbe\u6210\u5185\u90e8\u5408\u4f5c\uff0c\u5171\u540c\u6269\u5c55\u884c\u4e1a\u751f\u6001\uff1b\u540c\u65f6\u4e5f\u5f00\u59cb\u79ef\u6781\u53d1\u5c55\u5916\u90e8\u5ba2\u6237\uff0c\u76ee\u524d\u4e0e\u6df1\u5733\u5149\u5408\u663e\u793a\u79d1\u6280\u7684\u58a8\u6c34\u5c4f\u96f6\u552e\u6807\u7b7e\u3001\u946b\u60a6\u8d2d\u5145\u7535\u6869\u7b49\u8fbe\u6210\u4e1a\u52a1\u5408\u4f5c\u3002TencentOS tiny \u5c06\u643a\u624b\u5408\u4f5c\u4f19\u4f34\u4e3a\u7269\u8054\u7f51\u7ec8\u7aef\u5382\u5bb6\u63d0\u4f9b\u66f4\u4f18\u8d28\u7684 IoT \u7ec8\u7aef\u8f6f\u4ef6\u89e3\u51b3\u65b9\u6848\uff0c\u65b9\u4fbf\u5404\u79cd\u7269\u8054\u7f51\u8bbe\u5907\u5feb\u901f\u63a5\u5165\u817e\u8baf\u4e91\uff0c\u5171\u540c\u6269\u5c55 IoT \u751f\u6001\uff0c\u66f4\u597d\u5730\u652f\u6491\u667a\u6167\u57ce\u5e02\u3001\u667a\u80fd\u6c34\u8868\u3001\u667a\u80fd\u5bb6\u5c45\u3001\u667a\u80fd\u7a7f\u6234\u3001\u8f66\u8054\u7f51\u7b49\u591a\u79cd\u884c\u4e1a\u5e94\u7528\u3002 \u6b22\u8fce IoT \u76f8\u5173\u9879\u76ee\u5408\u4f5c\uff0c\u6709\u5408\u4f5c\u9700\u6c42\u7684\u8bf7\u90ae\u4ef6\u8054\u7cfb TencentOS tiny \u5b98\u65b9\u5de5\u4f5c\u4eba\u5458\uff0c\u90ae\u7bb1\u5730\u5740 \uff1a supowang@tencent.com \u4e8c\u3001TencentOS tiny \u4ee3\u7801\u76ee\u5f55 TencentOS tiny \u4ee3\u7801\u76ee\u5f55\u8bf4\u660e \u4e09\u3001TencentOS tiny \u53c2\u8003\u6587\u6863 1\u3001\u79fb\u690d\u6307\u5357 TencentOS tiny \u79fb\u690d\u6307\u5357\uff08KEIL \u7248\u672c\uff09 TencentOS tiny \u79fb\u690d\u6307\u5357\uff08IAR \u7248\u672c\uff09 TencentOS tiny \u79fb\u690d\u6307\u5357\uff08GCC \u7248\u672c\uff09 2\u3001TencentOS tiny \u5f00\u53d1\u6307\u5357 TencentOS tiny \u5185\u6838\u5f00\u53d1\u6307\u5357 TencentOS tiny API \u53c2\u8003 TencentOS tiny \u5bf9\u63a5\u817e\u8baf\u4e91 IoTHub \u5f00\u53d1\u6307\u5357 3\u3001TencentOS tiny \u817e\u8baf\u4e91\u5927\u5b66\u89c6\u9891\u6559\u7a0b TencentOS tiny \u7aef\u4fa7\u5f00\u53d1\u5b9e\u8df5\u8bfe \u56db\u3001TencentOS tiny \u5f00\u6e90\u534f\u8bae TencentOS tiny \u9075\u5faa BSD-3 \u5f00\u6e90\u8bb8\u53ef\u534f\u8bae \u4e94\u3001TencentOS tiny \u652f\u6301\u7684\u7269\u8054\u7f51\u5e73\u53f0 TencentOS tiny \u80fd\u652f\u6301\u7269\u8054\u7f51\u7ec8\u7aef\u8bbe\u5907\u548c\u4e1a\u52a1\u5feb\u901f\u63a5\u5165 \u817e\u8baf\u4e91\u7269\u8054\u7f51\u5e73\u53f0 IoT Explorer \u3002 TencentOS tiny \u7ed3\u5408\u817e\u8baf\u4e91\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0 IoT Explorer\uff0c\u5df2\u7ecf\u6784\u7b51\u8d77\u8fde\u63a5\u901a\u8baf\u82af\u7247\u5230\u4e91\u5f00\u53d1\u7684\u80fd\u529b\uff0c\u52a0\u4e0a\u5df2\u7ecf\u5efa\u8bbe\u5b8c\u6210\u7684\u56fd\u5185\u6700\u5927\u89c4\u6a21 LoRa \u7f51\u7edc\uff0c\u817e\u8baf\u5f7b\u5e95\u6253\u901a\u4ece\u82af\u7247\u901a\u8baf\u5f00\u53d1\u3001\u7f51\u7edc\u652f\u6491\u670d\u52a1\uff0c\u7269\u7406\u8bbe\u5907\u5b9a\u4e49\u7ba1\u7406\uff0c\u6570\u636e\u5206\u6790\u548c\u591a\u573a\u666f\u5e94\u7528\u5f00\u53d1\u7b49\u5168\u94fe\u6761IoT\u4e91\u5f00\u53d1\u670d\u52a1\u80fd\u529b\uff0c\u91cd\u65b0\u5b9a\u4e49\u4e86\u7269\u8054\u7f51\u5f00\u53d1\u6a21\u5f0f\uff0c\u52a9\u529b\u4ebf\u7ea7\u8bbe\u5907\u591a\u65b9\u5f0f\u591a\u6a21\u5f0f\u4f4e\u95e8\u69db\u63a5\u5165\u817e\u8baf\u4e91\u670d\u52a1\u3002\u4f5c\u4e3a\u7269\u8054\u7f51\u57fa\u7840\u8bbe\u65bd\u5efa\u8bbe\u670d\u52a1\u8005\uff0c\u817e\u8baf\u5c06\u6301\u7eed\u6253\u9020\u5f00\u653e\u7684\u7269\u8054\u7f51\u751f\u6001\u4f53\u7cfb\uff0c\u4fc3\u8fdb\u7269\u8054\u7f51\u751f\u6001\u826f\u6027\u53d1\u5c55\u3002 \u516d\u3001TencentOS tiny \u5feb\u901f\u5165\u95e8\u53c2\u8003 TencentOS tiny \u8054\u5408\u5408\u4f5c\u4f19\u4f34(\u5357\u4eac\u539a\u5fb7\u7269\u8054\u7f51)\u8bbe\u8ba1\u4e86\u5b9a\u5236\u5f00\u53d1\u677f\uff0c\u5982\u4e0b\u56fe\uff1a TencentOS tiny \u5b9a\u5236\u5f00\u53d1\u677f\u4ecb\u7ecd\u9875 \uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u57fa\u4e8e\u5b9a\u5236\u5f00\u53d1\u677f\u8fdb\u884c\u5feb\u901f\u5165\u95e8\u5b66\u4e60\uff0c\u70b9\u51fb\u4e0b\u8f7d\u53c2\u8003\u6587\u6863 TencentOS-tiny \u5b9a\u5236\u5f00\u53d1\u677f\u5165\u95e8\u6307\u5357 \u4e03\u3001\u8d21\u732e\u4ee3\u7801 \u5728\u60a8\u81ea\u5df1\u7684 GitHub \u8d26\u6237\u4e0b Fork TencentOS tiny \u5f00\u6e90\u9879\u76ee\uff1b \u6839\u636e\u60a8\u7684\u9700\u6c42\u5728\u672c\u5730 clone \u4e00\u4efd TencentOS tiny \u4ee3\u7801\uff1b \u60a8\u4fee\u6539\u6216\u8005\u65b0\u589e\u529f\u80fd\u540e\uff0cpush \u5230\u60a8 fork \u7684\u8fdc\u7a0b\u5206\u652f\uff1b \u521b\u5efa pull request\uff0c\u5411 TencentOS tiny \u5b98\u65b9\u5f00\u53d1\u5206\u652f\u63d0\u4ea4\u5408\u5165\u8bf7\u6c42\uff1b TencentOS tiny \u7814\u53d1\u56e2\u961f\u4f1a\u5b9a\u671f review \u4ee3\u7801\uff0c\u901a\u8fc7\u6d4b\u8bd5\u540e\u5408\u5165\u3002 \u516b\u3001\u52a0\u5165TencentOS tiny\u5b98\u65b9QQ\u6280\u672f\u4ea4\u6d41\u7fa4 \u626b\u7801\u52a0\u7fa4\uff0c\u8bf7\u5907\u6ce8 TencentOS tiny \u5f00\u53d1\u8005\uff0c\u5de5\u4f5c\u4eba\u5458\u4f1a\u6839\u636e\u5907\u6ce8\u8fdb\u884c\u5ba1\u6838\uff1a \u4e5d\u3001\u7b2c\u4e09\u65b9\u5f00\u53d1\u8005\u8bc4\u6d4b 1.\u57fa\u4e8e TencentOS tiny \u7684\u73af\u5883\u76d1\u6d4b\u5b9e\u6218\u9879\u76ee \u3010TencentOS tiny\u3011\u73af\u5883\u76d1\u6d4b\u5b9e\u6218\u9879\u76ee\u6700\u7ec8\u5b8c\u6574\u7248 \u611f\u8c22\u963f\u6b63\u7684\u8d21\u732e 2.\u57fa\u4e8e\u91ce\u706b stm32f103 \u5f00\u53d1\u677f\u4e0a\u79fb\u690d\u7684 TencentOS tiny \u4f8b\u7a0b\u3001\u6e90\u7801\u5256\u6790\u3001\u89c6\u9891\u8bb2\u89e3\u3002 \u611f\u8c22 CSDN \u535a\u5ba2\u4e13\u5bb6\u6770\u6770\u7684\u8d21\u732e \u7b80\u5355\u4e0a\u624b\uff1a \u8d85\u8be6\u7ec6\u7684 TencentOS tiny \u79fb\u690d\u5230 STM32F103 \u5168\u6559\u7a0b \u6df1\u5ea6\u6e90\u7801\u5206\u6790\uff1a \u3010TencentOS tiny \u5b66\u4e60\u3011\u6e90\u7801\u5206\u6790\uff081\uff09\u2014\u2014task \u3010TencentOS tiny \u5b66\u4e60\u3011\u6e90\u7801\u5206\u6790\uff082\uff09\u2014\u2014\u8c03\u5ea6\u5668 \u3010TencentOS tiny \u5b66\u4e60\u3011\u6e90\u7801\u5206\u6790\uff083\uff09\u2014\u2014\u961f\u5217 \u3010TencentOS tiny \u5b66\u4e60\u3011\u6e90\u7801\u5206\u6790\uff084\uff09\u2014\u2014\u6d88\u606f\u961f\u5217 \u3010TencentOS tiny \u5b66\u4e60\u3011\u6e90\u7801\u5206\u6790\uff085\uff09\u2014\u2014\u4fe1\u53f7\u91cf \u3010TencentOS tiny \u5b66\u4e60\u3011\u6e90\u7801\u5206\u6790\uff086\uff09\u2014\u2014\u4e92\u65a5\u9501 \u3010TencentOS tiny \u5b66\u4e60\u3011\u6e90\u7801\u5206\u6790\uff087\uff09\u2014\u2014\u4e8b\u4ef6 \u3010TencentOS tiny \u5b66\u4e60\u3011\u6e90\u7801\u5206\u6790\uff088\uff09\u2014\u2014\u8f6f\u4ef6\u5b9a\u65f6\u5668 \u914d\u5957\u4f8b\u7a0b\uff1a \u3010TencentOS tiny \u5b66\u4e60\u3011\u4f8b\u7a0b\uff080\uff09\u2014\u2014hello world \u3010TencentOS tiny \u5b66\u4e60\u3011\u4f8b\u7a0b\uff081\uff09\u2014\u2014task \u3010TencentOS tiny \u5b66\u4e60\u3011\u4f8b\u7a0b\uff082\uff09\u2014\u2014\u961f\u5217 \u3010TencentOS tiny \u5b66\u4e60\u3011\u4f8b\u7a0b\uff083\uff09\u2014\u2014\u6d88\u606f\u961f\u5217 \u3010TencentOS tiny \u5b66\u4e60\u3011\u4f8b\u7a0b\uff084\uff09\u2014\u2014\u4fe1\u53f7\u91cf \u3010TencentOS tiny \u5b66\u4e60\u3011\u4f8b\u7a0b\uff085\uff09\u2014\u2014\u4e92\u65a5\u9501 \u3010TencentOS tiny \u5b66\u4e60\u3011\u4f8b\u7a0b\uff086\uff09\u2014\u2014\u4e8b\u4ef6 \u3010TencentOS tiny \u5b66\u4e60\u3011\u4f8b\u7a0b\uff087\uff09\u2014\u2014\u8f6f\u4ef6\u5b9a\u65f6\u5668 \u3010TencentOS tiny \u5b66\u4e60\u3011\u4f8b\u7a0b\uff088\uff09\u2014\u2014\u5185\u5b58\u6c60 \u3010TencentOS tiny \u5b66\u4e60\u3011\u4f8b\u7a0b\uff089\uff09\u2014\u2014\u5185\u5b58\u5806 \u89c6\u9891\u6559\u7a0b\uff1a \u3010TencentOS tiny \u5b66\u4e60\u3011\u89c6\u9891\u6c47\u603b \u3010\u89c6\u9891\u301101-\u521d\u8bc6 TencentOS tiny \u3010\u89c6\u9891\u301102-TencentOS tiny \u57fa\u7840\u77e5\u8bc6 \u3010\u89c6\u9891\u301103-TencentOS tiny \u79fb\u690d \u3010\u89c6\u9891\u301104-TencentOS tiny \u4efb\u52a1-1 \u3010\u89c6\u9891\u301105-TencentOS tiny \u4efb\u52a1-2 \u3010\u89c6\u9891\u301106-TencentOS tiny \u961f\u5217-1 \u3010\u89c6\u9891\u301107-TencentOS tiny \u961f\u5217-2 \u3010\u89c6\u9891\u301108-TencentOS tiny \u6d88\u606f\u961f\u5217 \u3010\u89c6\u9891\u301109-TencentOS tiny \u4fe1\u53f7\u91cf-1 \u3010\u89c6\u9891\u301110-TencentOS tiny \u4fe1\u53f7\u91cf-2 \u3010\u89c6\u9891\u301111-TencentOS tiny \u4e92\u65a5\u9501-1 \u3010\u89c6\u9891\u301112-TencentOS tiny \u4e92\u65a5\u9501-2 \u3010\u89c6\u9891\u301113-TencentOS tiny \u4e92\u65a5\u9501-3 \u3010\u89c6\u9891\u301114-TencentOS tiny \u4e8b\u4ef6-1 \u3010\u89c6\u9891\u301115-TencentOS tiny \u4e8b\u4ef6-2 \u3010\u89c6\u9891\u301116-TencentOS tiny \u8f6f\u4ef6\u5b9a\u65f6\u5668-1 \u3010\u89c6\u9891\u301117-TencentOS tiny \u8f6f\u4ef6\u5b9a\u65f6\u5668-2 \u3010\u89c6\u9891\u301118-TencentOS tiny \u8f6f\u4ef6\u5b9a\u65f6\u5668-3 \u76f8\u5173PPT\u8d44\u6599\uff1a \u3010TencentOS tiny \u5b66\u4e60\u3011\u89c6\u9891 PPT","title":"\u4e3b\u9875"},{"location":"#tencentos-tiny","text":"TencentOS tiny \u662f\u817e\u8baf\u9762\u5411\u7269\u8054\u7f51\u9886\u57df\u5f00\u53d1\u7684\u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5177\u6709\u4f4e\u529f\u8017\uff0c\u4f4e\u8d44\u6e90\u5360\u7528\uff0c\u6a21\u5757\u5316\uff0c\u5b89\u5168\u53ef\u9760\u7b49\u7279\u70b9\uff0c\u53ef\u6709\u6548\u63d0\u5347\u7269\u8054\u7f51\u7ec8\u7aef\u4ea7\u54c1\u5f00\u53d1\u6548\u7387\u3002TencentOS tiny \u63d0\u4f9b\u7cbe\u7b80\u7684 RTOS \u5185\u6838\uff0c\u5185\u6838\u7ec4\u4ef6\u53ef\u88c1\u526a\u53ef\u914d\u7f6e\uff0c\u53ef\u5feb\u901f\u79fb\u690d\u5230\u591a\u79cd\u4e3b\u6d41 MCU (\u5982 STM32 \u5168\u7cfb\u5217)\u53ca\u6a21\u7ec4\u82af\u7247\u4e0a\u3002\u800c\u4e14\uff0c\u57fa\u4e8e RTOS \u5185\u6838\u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684\u7269\u8054\u7f51\u7ec4\u4ef6\uff0c\u5185\u90e8\u96c6\u6210\u4e3b\u6d41\u7269\u8054\u7f51\u534f\u8bae\u6808\uff08\u5982 CoAP/MQTT/TLS/DTLS/LoRaWAN/NB-IoT \u7b49\uff09\uff0c\u53ef\u52a9\u529b\u7269\u8054\u7f51\u7ec8\u7aef\u8bbe\u5907\u53ca\u4e1a\u52a1\u5feb\u901f\u63a5\u5165\u817e\u8baf\u4e91\u7269\u8054\u7f51\u5e73\u53f0\u3002","title":"\u4e00\u3001TencentOS Tiny \u7b80\u4ecb"},{"location":"#1tencentos-tiny","text":"TencentOS tiny \u4e3b\u4f53\u67b6\u6784\u56fe\uff0c\u4ece\u4e0b\u5230\u4e0a\u4e3b\u8981\u5305\u62ec\uff1a CPU \u5e93 \uff1aTencentOS tiny \u652f\u6301\u7684 CPU IP \u6838\u67b6\u6784\uff0c\u5f53\u524d\u4e3b\u8981\u652f\u6301 ARM Cortex M0/3/4/7\uff0cCortex A7\uff0cRISC-V\u3001MSP430\u3001AVR\u3001STM8 \u7b49\u3002 \u9a71\u52a8\u7ba1\u7406\u5c42 \uff1a\u5305\u62ec\u677f\u7ea7\u652f\u6301\u5305\uff08BSP\uff0c\u4e3b\u8981\u7531 MCU \u82af\u7247\u5382\u5bb6\u5f00\u53d1\u4e0e\u7ef4\u62a4\uff09\u3001\u786c\u4ef6\u62bd\u8c61\u5c42\uff08HAL\uff0c\u4e3b\u8981\u7531 TencentOS tiny \u63d0\u4f9b\uff0c\u65b9\u4fbf\u4e0d\u540c\u82af\u7247\u7684\u9002\u914d\u4e0e\u79fb\u690d\uff09\u3001\u8bbe\u5907\u9a71\u52a8\uff08Drivers\uff0c\u4f8b\u5982 Wi-Fi\u3001GPRS\u3001LoRa \u7b49\u6a21\u5757\u7684\u9a71\u52a8\u7a0b\u5e8f\uff09\u3002 \u5185\u6838 \uff1aTencentOS tiny \u5b9e\u65f6\u5185\u6838\u5305\u62ec\u4efb\u52a1\u7ba1\u7406\u3001\u5b9e\u65f6\u8c03\u5ea6\u3001\u65f6\u95f4\u7ba1\u7406\u3001\u4e2d\u65ad\u7ba1\u7406\u3001\u5185\u5b58\u7ba1\u7406\u3001\u5f02\u5e38\u5904\u7406\u3001\u8f6f\u4ef6\u5b9a\u65f6\u5668\u3001\u94fe\u8868\u3001\u6d88\u606f\u961f\u5217\u3001\u4fe1\u53f7\u91cf\u3001\u4e92\u65a5\u9501\u3001\u4e8b\u4ef6\u6807\u5fd7\u7b49\u6a21\u5757\u3002 IoT \u534f\u8bae\u6808 \uff1aTencentOS tiny \u63d0\u4f9b lwip\u3001AT Adapter\u3001SAL \u5c42\uff0c\u652f\u6301\u4e0d\u540c\u7684\u7f51\u7edc\u786c\u4ef6\uff0c\u4f8b\u5982\u4ee5\u592a\u7f51\u3001\u4e32\u53e3 Wi-Fi\u3001GPRS\u3001NB-IoT\u30014G \u7b49\u901a\u4fe1\u6a21\u5757\u3002TCP/IP \u7f51\u7edc\u534f\u8bae\u6808\u4e0a\u63d0\u4f9b\u5e38\u7528\u7684\u7269\u8054\u7f51\u534f\u8bae\u6808\uff0c\u4f8b\u5982 CoAP\u3001MQTT\uff0c\u652f\u6491\u7ec8\u7aef\u4e1a\u52a1\u5feb\u901f\u63a5\u5165\u817e\u8baf\u4e91\u3002 \u5b89\u5168\u6846\u67b6 \uff1aTencentOS tiny \u4e3a\u4e86\u786e\u4fdd\u7269\u8054\u7f51\u7ec8\u7aef\u6570\u636e\u4f20\u8f93\u5b89\u5168\u4ee5\u53ca\u8bbe\u5907\u8ba4\u8bc1\u5b89\u5168\uff0c\u63d0\u4f9b\u4e86\u5b8c\u6574\u7684\u5b89\u5168\u89e3\u51b3\u65b9\u6848\u3002\u5b89\u5168\u6846\u67b6\u63d0\u4f9b\u7684 DTLS \u548c TLS \u5b89\u5168\u534f\u8bae\uff0c\u52a0\u56fa\u4e86 COAP \u53ca MQTT \u7684\u4f20\u8f93\u5c42\uff0c\u53ef\u786e\u4fdd\u7269\u8054\u7f51\u7ec8\u7aef\u5728\u5bf9\u63a5\u817e\u8baf\u4e91\u65f6\u5b9e\u73b0\u5b89\u5168\u8ba4\u8bc1\u548c\u6570\u636e\u52a0\u5bc6\uff1b\u53e6\u5916\u9488\u5bf9\u4f4e\u8d44\u6e90\u7684\u7ec8\u7aef\u786c\u4ef6\uff0c\u5b89\u5168\u6846\u67b6\u8fd8\u63d0\u4f9b\u4e0e\u817e\u8baf\u4e91 IoTHub \u914d\u5957\u7684\u5bc6\u94a5\u8ba4\u8bc1\u65b9\u6848\uff0c\u786e\u4fdd\u8d44\u6e90\u53d7\u9650\u8bbe\u5907\u4e5f\u80fd\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u5b9e\u73b0\u8bbe\u5907\u5b89\u5168\u8ba4\u8bc1\u3002 \u7ec4\u4ef6\u6846\u67b6 \uff1aTencentOS tiny \u63d0\u4f9b\u6587\u4ef6\u7cfb\u7edf\u3001KV \u5b58\u50a8\u3001\u81ea\u7ec4\u7f51\u3001JS \u5f15\u64ce\u3001\u4f4e\u529f\u8017\u6846\u67b6\u3001\u8bbe\u5907\u6846\u67b6\u3001OTA\u3001\u8c03\u8bd5\u5de5\u5177\u94fe\u7b49\u4e00\u7cfb\u5217\u7ec4\u4ef6\uff0c\u4f9b\u7528\u6237\u6839\u636e\u4e1a\u52a1\u573a\u666f\u9009\u7528\u3002 \u5f00\u653e API\uff08\u89c4\u5212\u5f00\u53d1\u4e2d\uff09 \uff1aTencentOS tiny \u5c06\u5728\u534f\u8bae\u4e2d\u95f4\u4ef6\u548c\u6846\u67b6\u5c42\u4e0a\u63d0\u4f9b\u5f00\u653e API \u51fd\u6570\uff0c\u65b9\u4fbf\u7528\u6237\u8c03\u7528\u4e2d\u95f4\u4ef6\u529f\u80fd\uff0c\u4f7f\u7528\u6237\u65e0\u9700\u8fc7\u591a\u5173\u5fc3\u4e2d\u95f4\u4ef6\u5177\u4f53\u5b9e\u73b0\uff0c\u5feb\u901f\u5bf9\u63a5\u817e\u8baf\u4e91\uff0c\u5b9e\u73b0\u7ec8\u7aef\u4e1a\u52a1\u4e0a\u4e91\u7684\u9700\u6c42\uff0c\u671f\u671b\u6700\u5927\u7a0b\u5ea6\u51cf\u5c11\u7ec8\u7aef\u7269\u8054\u7f51\u4ea7\u54c1\u5f00\u53d1\u5468\u671f\uff0c\u8282\u7701\u5f00\u53d1\u6210\u672c\u3002 \u793a\u4f8b\u5e94\u7528 \uff1aTencentOS tiny \u63d0\u4f9b\u7684\u793a\u4f8b\u4ee3\u7801\uff0c\u6a21\u5757\u6d4b\u8bd5\u4ee3\u7801\u7b49\uff0c\u65b9\u4fbf\u7528\u6237\u53c2\u8003\u4f7f\u7528\u3002","title":"1\u3001TencentOS tiny\u6574\u4f53\u67b6\u6784"},{"location":"#2tencentos-tiny","text":"","title":"2\u3001TencentOS tiny \u4f18\u52bf"},{"location":"#1","text":"\u6700\u5c0f\u5185\u6838\uff1aRAM 0.6KB\uff0cROM 1.8KB \u5178\u578b LoraWAN \u53ca\u4f20\u611f\u5668\u5e94\u7528\uff1aRAM 3.3KB\uff0cROM 12KB","title":"(1).\u5c0f\u4f53\u79ef"},{"location":"#2","text":"\u4f11\u7720\u6700\u4f4e\u529f\u8017\u4f4e\u81f3 2uA \u652f\u6301\u5916\u8bbe\u529f\u8017\u7ba1\u7406\u6846\u67b6","title":"(2).\u4f4e\u529f\u8017"},{"location":"#3-iot","text":"\u96c6\u6210\u4e3b\u6d41 IoT \u534f\u8bae\u6808 \u591a\u79cd\u901a\u4fe1\u6a21\u7ec4SAL\u5c42\u9002\u914d\u6846\u67b6\uff1b \u652f\u6301 OTA \u5347\u7ea7 \u63d0\u4f9b\u7b80\u5355\u6613\u7528\u7aef\u4e91 API\uff0c\u52a0\u901f\u7528\u6237\u4e1a\u52a1\u63a5\u5165\u817e\u8baf\u4e91","title":"(3).\u4e30\u5bcc\u7684 IoT \u7ec4\u4ef6"},{"location":"#4","text":"\u591a\u6837\u5316\u7684\u5b89\u5168\u5206\u7ea7\u65b9\u6848 \u5747\u8861\u5b89\u5168\u9700\u6c42&\u6210\u672c\u63a7\u5236","title":"(4).\u53ef\u9760\u7684\u5b89\u5168\u6846\u67b6"},{"location":"#5","text":"\u5185\u6838\u53caIoT\u7ec4\u4ef6\u9ad8\u5ea6\u89e3\u8026\uff0c\u63d0\u4f9b\u6807\u51c6\u9002\u914d\u5c42 \u63d0\u4f9b\u81ea\u52a8\u5316\u79fb\u690d\u5de5\u5177\uff0c\u63d0\u5347\u5f00\u53d1\u6548\u7387","title":"(5).\u826f\u597d\u7684\u53ef\u79fb\u690d\u6027"},{"location":"#6","text":"\u63d0\u4f9b\u4e91\u5316\u7684\u6700\u540e\u4e00\u5c4f\u8c03\u8bd5\u529f\u80fd \u6545\u969c\u73b0\u573a\u4fe1\u606f\u81ea\u52a8\u4e0a\u4f20\u4e91\u5e73\u53f0\uff0c\u65b9\u4fbf\u5f00\u53d1\u4eba\u5458\u8c03\u8bd5\u5206\u6790","title":"(6).\u4fbf\u6377\u7684\u8c03\u8bd5\u624b\u6bb5"},{"location":"#3tencentos-tinyiot","text":"TencentOS tiny \u81ea\u5f00\u6e90\u53d1\u5e03\u4ee5\u6765\u4e5f\u5728\u52aa\u529b\u53d1\u5c55\u5408\u4f5c\u4f19\u4f34\uff0c\u671f\u5f85\u5408\u4f5c\u5171\u8d62\uff0c\u5171\u540c\u6269\u5c55 IoT \u5e94\u7528\u751f\u6001\u3002\u76ee\u524d\u5df2\u7ecf\u4e0e\u591a\u5bb6 MCU/IP \u6838\u5382\u5bb6\u8fbe\u6210\u4e86\u5408\u4f5c\uff0c\u5305\u62ec\u610f\u6cd5\u534a\u5bfc\u4f53\u3001\u6069\u667a\u6d66\u534a\u5bfc\u4f53\u3001\u5146\u6613\u534a\u5bfc\u4f53\u3001ARM\u3001\u534e\u5927\u534a\u5bfc\u4f53\u3001\u82af\u6765\u79d1\u6280\u7b49\uff1b\u4e5f\u4e0e\u65e0\u7ebf SOC \u548c\u6a21\u7ec4\u5382\u5bb6\u8fbe\u6210\u4e86\u5e7f\u6cdb\u7684\u5408\u4f5c\u5173\u7cfb\uff0c\u5305\u62ec\u745e\u5174\u6052\u65b9\u3001\u56fd\u6c11\u6280\u672f\u3001Nordic \u84dd\u7259\u3001\u4eae\u725b\u534a\u5bfc\u4f53\u3001\u6709\u4eba\u7269\u8054\u7f51\u7b49\uff0c \u9664\u4e86MCU\u548c\u6a21\u7ec4\u5916\uff0cTencentOS tiny \u4e5f\u79ef\u6781\u63a8\u8fdb\u7ec8\u7aef\u4ea7\u54c1\u53ca\u9879\u76ee\u7684\u843d\u5730\uff0c\u76ee\u524d\u5df2\u7ecf\u5f62\u6210\u4e86AI\u667a\u6167\u519c\u4e1a\u3001\u667a\u80fd\u8d27\u67dc\u3001\u667a\u6167\u4f1a\u8bae\u5ba4\u7b49\u65b9\u6848\uff0c\u5e76\u4e14\u5728\u817e\u8baf\u5185\u90e8\u4e0e AI \u5e73\u53f0\u90e8\u3001\u817e\u8baf\u5fae\u74f4\u3001QQ family \u8fbe\u6210\u5185\u90e8\u5408\u4f5c\uff0c\u5171\u540c\u6269\u5c55\u884c\u4e1a\u751f\u6001\uff1b\u540c\u65f6\u4e5f\u5f00\u59cb\u79ef\u6781\u53d1\u5c55\u5916\u90e8\u5ba2\u6237\uff0c\u76ee\u524d\u4e0e\u6df1\u5733\u5149\u5408\u663e\u793a\u79d1\u6280\u7684\u58a8\u6c34\u5c4f\u96f6\u552e\u6807\u7b7e\u3001\u946b\u60a6\u8d2d\u5145\u7535\u6869\u7b49\u8fbe\u6210\u4e1a\u52a1\u5408\u4f5c\u3002TencentOS tiny \u5c06\u643a\u624b\u5408\u4f5c\u4f19\u4f34\u4e3a\u7269\u8054\u7f51\u7ec8\u7aef\u5382\u5bb6\u63d0\u4f9b\u66f4\u4f18\u8d28\u7684 IoT \u7ec8\u7aef\u8f6f\u4ef6\u89e3\u51b3\u65b9\u6848\uff0c\u65b9\u4fbf\u5404\u79cd\u7269\u8054\u7f51\u8bbe\u5907\u5feb\u901f\u63a5\u5165\u817e\u8baf\u4e91\uff0c\u5171\u540c\u6269\u5c55 IoT \u751f\u6001\uff0c\u66f4\u597d\u5730\u652f\u6491\u667a\u6167\u57ce\u5e02\u3001\u667a\u80fd\u6c34\u8868\u3001\u667a\u80fd\u5bb6\u5c45\u3001\u667a\u80fd\u7a7f\u6234\u3001\u8f66\u8054\u7f51\u7b49\u591a\u79cd\u884c\u4e1a\u5e94\u7528\u3002 \u6b22\u8fce IoT \u76f8\u5173\u9879\u76ee\u5408\u4f5c\uff0c\u6709\u5408\u4f5c\u9700\u6c42\u7684\u8bf7\u90ae\u4ef6\u8054\u7cfb TencentOS tiny \u5b98\u65b9\u5de5\u4f5c\u4eba\u5458\uff0c\u90ae\u7bb1\u5730\u5740 \uff1a supowang@tencent.com","title":"3\u3001TencentOS tiny\u643a\u624b\u5408\u4f5c\u4f19\u4f34\u5171\u5efaIoT\u751f\u6001"},{"location":"#tencentos-tiny_1","text":"TencentOS tiny \u4ee3\u7801\u76ee\u5f55\u8bf4\u660e","title":"\u4e8c\u3001TencentOS tiny \u4ee3\u7801\u76ee\u5f55"},{"location":"#tencentos-tiny_2","text":"","title":"\u4e09\u3001TencentOS tiny \u53c2\u8003\u6587\u6863"},{"location":"#1_1","text":"TencentOS tiny \u79fb\u690d\u6307\u5357\uff08KEIL \u7248\u672c\uff09 TencentOS tiny \u79fb\u690d\u6307\u5357\uff08IAR \u7248\u672c\uff09 TencentOS tiny \u79fb\u690d\u6307\u5357\uff08GCC \u7248\u672c\uff09","title":"1\u3001\u79fb\u690d\u6307\u5357"},{"location":"#2tencentos-tiny_1","text":"TencentOS tiny \u5185\u6838\u5f00\u53d1\u6307\u5357 TencentOS tiny API \u53c2\u8003 TencentOS tiny \u5bf9\u63a5\u817e\u8baf\u4e91 IoTHub \u5f00\u53d1\u6307\u5357","title":"2\u3001TencentOS tiny \u5f00\u53d1\u6307\u5357"},{"location":"#3tencentos-tiny","text":"TencentOS tiny \u7aef\u4fa7\u5f00\u53d1\u5b9e\u8df5\u8bfe","title":"3\u3001TencentOS tiny \u817e\u8baf\u4e91\u5927\u5b66\u89c6\u9891\u6559\u7a0b"},{"location":"#tencentos-tiny_3","text":"TencentOS tiny \u9075\u5faa BSD-3 \u5f00\u6e90\u8bb8\u53ef\u534f\u8bae","title":"\u56db\u3001TencentOS tiny \u5f00\u6e90\u534f\u8bae"},{"location":"#tencentos-tiny_4","text":"TencentOS tiny \u80fd\u652f\u6301\u7269\u8054\u7f51\u7ec8\u7aef\u8bbe\u5907\u548c\u4e1a\u52a1\u5feb\u901f\u63a5\u5165 \u817e\u8baf\u4e91\u7269\u8054\u7f51\u5e73\u53f0 IoT Explorer \u3002 TencentOS tiny \u7ed3\u5408\u817e\u8baf\u4e91\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0 IoT Explorer\uff0c\u5df2\u7ecf\u6784\u7b51\u8d77\u8fde\u63a5\u901a\u8baf\u82af\u7247\u5230\u4e91\u5f00\u53d1\u7684\u80fd\u529b\uff0c\u52a0\u4e0a\u5df2\u7ecf\u5efa\u8bbe\u5b8c\u6210\u7684\u56fd\u5185\u6700\u5927\u89c4\u6a21 LoRa \u7f51\u7edc\uff0c\u817e\u8baf\u5f7b\u5e95\u6253\u901a\u4ece\u82af\u7247\u901a\u8baf\u5f00\u53d1\u3001\u7f51\u7edc\u652f\u6491\u670d\u52a1\uff0c\u7269\u7406\u8bbe\u5907\u5b9a\u4e49\u7ba1\u7406\uff0c\u6570\u636e\u5206\u6790\u548c\u591a\u573a\u666f\u5e94\u7528\u5f00\u53d1\u7b49\u5168\u94fe\u6761IoT\u4e91\u5f00\u53d1\u670d\u52a1\u80fd\u529b\uff0c\u91cd\u65b0\u5b9a\u4e49\u4e86\u7269\u8054\u7f51\u5f00\u53d1\u6a21\u5f0f\uff0c\u52a9\u529b\u4ebf\u7ea7\u8bbe\u5907\u591a\u65b9\u5f0f\u591a\u6a21\u5f0f\u4f4e\u95e8\u69db\u63a5\u5165\u817e\u8baf\u4e91\u670d\u52a1\u3002\u4f5c\u4e3a\u7269\u8054\u7f51\u57fa\u7840\u8bbe\u65bd\u5efa\u8bbe\u670d\u52a1\u8005\uff0c\u817e\u8baf\u5c06\u6301\u7eed\u6253\u9020\u5f00\u653e\u7684\u7269\u8054\u7f51\u751f\u6001\u4f53\u7cfb\uff0c\u4fc3\u8fdb\u7269\u8054\u7f51\u751f\u6001\u826f\u6027\u53d1\u5c55\u3002","title":"\u4e94\u3001TencentOS tiny \u652f\u6301\u7684\u7269\u8054\u7f51\u5e73\u53f0"},{"location":"#tencentos-tiny_5","text":"TencentOS tiny \u8054\u5408\u5408\u4f5c\u4f19\u4f34(\u5357\u4eac\u539a\u5fb7\u7269\u8054\u7f51)\u8bbe\u8ba1\u4e86\u5b9a\u5236\u5f00\u53d1\u677f\uff0c\u5982\u4e0b\u56fe\uff1a TencentOS tiny \u5b9a\u5236\u5f00\u53d1\u677f\u4ecb\u7ecd\u9875 \uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u57fa\u4e8e\u5b9a\u5236\u5f00\u53d1\u677f\u8fdb\u884c\u5feb\u901f\u5165\u95e8\u5b66\u4e60\uff0c\u70b9\u51fb\u4e0b\u8f7d\u53c2\u8003\u6587\u6863 TencentOS-tiny \u5b9a\u5236\u5f00\u53d1\u677f\u5165\u95e8\u6307\u5357","title":"\u516d\u3001TencentOS tiny \u5feb\u901f\u5165\u95e8\u53c2\u8003"},{"location":"#_1","text":"\u5728\u60a8\u81ea\u5df1\u7684 GitHub \u8d26\u6237\u4e0b Fork TencentOS tiny \u5f00\u6e90\u9879\u76ee\uff1b \u6839\u636e\u60a8\u7684\u9700\u6c42\u5728\u672c\u5730 clone \u4e00\u4efd TencentOS tiny \u4ee3\u7801\uff1b \u60a8\u4fee\u6539\u6216\u8005\u65b0\u589e\u529f\u80fd\u540e\uff0cpush \u5230\u60a8 fork \u7684\u8fdc\u7a0b\u5206\u652f\uff1b \u521b\u5efa pull request\uff0c\u5411 TencentOS tiny \u5b98\u65b9\u5f00\u53d1\u5206\u652f\u63d0\u4ea4\u5408\u5165\u8bf7\u6c42\uff1b TencentOS tiny \u7814\u53d1\u56e2\u961f\u4f1a\u5b9a\u671f review \u4ee3\u7801\uff0c\u901a\u8fc7\u6d4b\u8bd5\u540e\u5408\u5165\u3002","title":"\u4e03\u3001\u8d21\u732e\u4ee3\u7801"},{"location":"#tencentos-tinyqq","text":"\u626b\u7801\u52a0\u7fa4\uff0c\u8bf7\u5907\u6ce8 TencentOS tiny \u5f00\u53d1\u8005\uff0c\u5de5\u4f5c\u4eba\u5458\u4f1a\u6839\u636e\u5907\u6ce8\u8fdb\u884c\u5ba1\u6838\uff1a","title":"\u516b\u3001\u52a0\u5165TencentOS tiny\u5b98\u65b9QQ\u6280\u672f\u4ea4\u6d41\u7fa4"},{"location":"#_2","text":"1.\u57fa\u4e8e TencentOS tiny \u7684\u73af\u5883\u76d1\u6d4b\u5b9e\u6218\u9879\u76ee \u3010TencentOS tiny\u3011\u73af\u5883\u76d1\u6d4b\u5b9e\u6218\u9879\u76ee\u6700\u7ec8\u5b8c\u6574\u7248 \u611f\u8c22\u963f\u6b63\u7684\u8d21\u732e 2.\u57fa\u4e8e\u91ce\u706b stm32f103 \u5f00\u53d1\u677f\u4e0a\u79fb\u690d\u7684 TencentOS tiny \u4f8b\u7a0b\u3001\u6e90\u7801\u5256\u6790\u3001\u89c6\u9891\u8bb2\u89e3\u3002 \u611f\u8c22 CSDN \u535a\u5ba2\u4e13\u5bb6\u6770\u6770\u7684\u8d21\u732e","title":"\u4e5d\u3001\u7b2c\u4e09\u65b9\u5f00\u53d1\u8005\u8bc4\u6d4b"},{"location":"#_3","text":"\u8d85\u8be6\u7ec6\u7684 TencentOS tiny \u79fb\u690d\u5230 STM32F103 \u5168\u6559\u7a0b","title":"\u7b80\u5355\u4e0a\u624b\uff1a"},{"location":"#_4","text":"\u3010TencentOS tiny \u5b66\u4e60\u3011\u6e90\u7801\u5206\u6790\uff081\uff09\u2014\u2014task \u3010TencentOS tiny \u5b66\u4e60\u3011\u6e90\u7801\u5206\u6790\uff082\uff09\u2014\u2014\u8c03\u5ea6\u5668 \u3010TencentOS tiny \u5b66\u4e60\u3011\u6e90\u7801\u5206\u6790\uff083\uff09\u2014\u2014\u961f\u5217 \u3010TencentOS tiny \u5b66\u4e60\u3011\u6e90\u7801\u5206\u6790\uff084\uff09\u2014\u2014\u6d88\u606f\u961f\u5217 \u3010TencentOS tiny \u5b66\u4e60\u3011\u6e90\u7801\u5206\u6790\uff085\uff09\u2014\u2014\u4fe1\u53f7\u91cf \u3010TencentOS tiny \u5b66\u4e60\u3011\u6e90\u7801\u5206\u6790\uff086\uff09\u2014\u2014\u4e92\u65a5\u9501 \u3010TencentOS tiny \u5b66\u4e60\u3011\u6e90\u7801\u5206\u6790\uff087\uff09\u2014\u2014\u4e8b\u4ef6 \u3010TencentOS tiny \u5b66\u4e60\u3011\u6e90\u7801\u5206\u6790\uff088\uff09\u2014\u2014\u8f6f\u4ef6\u5b9a\u65f6\u5668","title":"\u6df1\u5ea6\u6e90\u7801\u5206\u6790\uff1a"},{"location":"#_5","text":"\u3010TencentOS tiny \u5b66\u4e60\u3011\u4f8b\u7a0b\uff080\uff09\u2014\u2014hello world \u3010TencentOS tiny \u5b66\u4e60\u3011\u4f8b\u7a0b\uff081\uff09\u2014\u2014task \u3010TencentOS tiny \u5b66\u4e60\u3011\u4f8b\u7a0b\uff082\uff09\u2014\u2014\u961f\u5217 \u3010TencentOS tiny \u5b66\u4e60\u3011\u4f8b\u7a0b\uff083\uff09\u2014\u2014\u6d88\u606f\u961f\u5217 \u3010TencentOS tiny \u5b66\u4e60\u3011\u4f8b\u7a0b\uff084\uff09\u2014\u2014\u4fe1\u53f7\u91cf \u3010TencentOS tiny \u5b66\u4e60\u3011\u4f8b\u7a0b\uff085\uff09\u2014\u2014\u4e92\u65a5\u9501 \u3010TencentOS tiny \u5b66\u4e60\u3011\u4f8b\u7a0b\uff086\uff09\u2014\u2014\u4e8b\u4ef6 \u3010TencentOS tiny \u5b66\u4e60\u3011\u4f8b\u7a0b\uff087\uff09\u2014\u2014\u8f6f\u4ef6\u5b9a\u65f6\u5668 \u3010TencentOS tiny \u5b66\u4e60\u3011\u4f8b\u7a0b\uff088\uff09\u2014\u2014\u5185\u5b58\u6c60 \u3010TencentOS tiny \u5b66\u4e60\u3011\u4f8b\u7a0b\uff089\uff09\u2014\u2014\u5185\u5b58\u5806","title":"\u914d\u5957\u4f8b\u7a0b\uff1a"},{"location":"#_6","text":"\u3010TencentOS tiny \u5b66\u4e60\u3011\u89c6\u9891\u6c47\u603b \u3010\u89c6\u9891\u301101-\u521d\u8bc6 TencentOS tiny \u3010\u89c6\u9891\u301102-TencentOS tiny \u57fa\u7840\u77e5\u8bc6 \u3010\u89c6\u9891\u301103-TencentOS tiny \u79fb\u690d \u3010\u89c6\u9891\u301104-TencentOS tiny \u4efb\u52a1-1 \u3010\u89c6\u9891\u301105-TencentOS tiny \u4efb\u52a1-2 \u3010\u89c6\u9891\u301106-TencentOS tiny \u961f\u5217-1 \u3010\u89c6\u9891\u301107-TencentOS tiny \u961f\u5217-2 \u3010\u89c6\u9891\u301108-TencentOS tiny \u6d88\u606f\u961f\u5217 \u3010\u89c6\u9891\u301109-TencentOS tiny \u4fe1\u53f7\u91cf-1 \u3010\u89c6\u9891\u301110-TencentOS tiny \u4fe1\u53f7\u91cf-2 \u3010\u89c6\u9891\u301111-TencentOS tiny \u4e92\u65a5\u9501-1 \u3010\u89c6\u9891\u301112-TencentOS tiny \u4e92\u65a5\u9501-2 \u3010\u89c6\u9891\u301113-TencentOS tiny \u4e92\u65a5\u9501-3 \u3010\u89c6\u9891\u301114-TencentOS tiny \u4e8b\u4ef6-1 \u3010\u89c6\u9891\u301115-TencentOS tiny \u4e8b\u4ef6-2 \u3010\u89c6\u9891\u301116-TencentOS tiny \u8f6f\u4ef6\u5b9a\u65f6\u5668-1 \u3010\u89c6\u9891\u301117-TencentOS tiny \u8f6f\u4ef6\u5b9a\u65f6\u5668-2 \u3010\u89c6\u9891\u301118-TencentOS tiny \u8f6f\u4ef6\u5b9a\u65f6\u5668-3","title":"\u89c6\u9891\u6559\u7a0b\uff1a"},{"location":"#ppt","text":"\u3010TencentOS tiny \u5b66\u4e60\u3011\u89c6\u9891 PPT","title":"\u76f8\u5173PPT\u8d44\u6599\uff1a"},{"location":"01.Introduction/","text":"TencentOS tiny \u4ea7\u54c1\u7b80\u4ecb TencentOS tiny\u662f\u817e\u8baf\u9762\u5411\u7269\u8054\u7f51\u9886\u57df\u5f00\u53d1\u7684\u5b9e\u65f6\u7ec8\u7aef\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5177\u6709\u4f4e\u529f\u8017\uff0c\u4f4e\u8d44\u6e90\u5360\u7528\uff0c\u6a21\u5757\u5316\uff0c\u53ef\u88c1\u526a\u7b49\u7279\u6027\u3002 TencentOS tiny\u63d0\u4f9b\u6700\u7cbe\u7b80\u7684RTOS\u5185\u6838\uff0c\u5185\u6838\u7ec4\u4ef6\u53ef\u88c1\u526a\u53ef\u914d\u7f6e\uff0c\u53ef\u7075\u6d3b\u79fb\u690d\u5230\u591a\u79cd\u7ec8\u7aefMCU\u4e0a\u3002\u800c\u4e14\uff0c\u57fa\u4e8eRTOS\u5185\u6838\uff0c\u63d0\u4f9b\u4e86COAP/MQTT/TLS/DTLS\u7b49\u5e38\u7528\u7269\u8054\u7f51\u534f\u8bae\u6808\u53ca\u7ec4\u4ef6\uff0c\u65b9\u4fbf\u7528\u6237\u5feb\u901f\u63a5\u5165\u817e\u8baf\u4e91IoT Hub\u3002 TencentOS tiny\u4e3a\u7269\u8054\u7f51\u7ec8\u7aef\u5382\u5bb6\u63d0\u4f9b\u4e00\u7ad9\u5f0f\u8f6f\u4ef6\u89e3\u51b3\u65b9\u6848\uff0c\u65b9\u4fbf\u5404\u79cd\u7269\u8054\u7f51\u8bbe\u5907\u5feb\u901f\u63a5\u5165\u817e\u8baf\u4e91\uff0c\u53ef\u652f\u6491\u667a\u6167\u57ce\u5e02\u3001\u667a\u80fd\u6c34\u8868\u3001\u667a\u80fd\u5bb6\u5c45\u3001\u667a\u80fd\u7a7f\u6234\u3001\u8f66\u8054\u7f51\u7b49\u591a\u79cd\u884c\u4e1a\u5e94\u7528\u3002 TencentOS tiny\u7684\u4f18\u52bf\uff1a 1.\u5c0f\u4f53\u79ef \u6700\u5c0f\u5185\u6838\uff1aRAM 0.6KB\uff0cROM 1.8KB \u5178\u578bLoraWAN\u53ca\u4f20\u611f\u5668\u5e94\u7528\uff1aRAM 3.3KB\uff0cROM 12KB 2.\u4f4e\u529f\u8017 \u4f11\u7720\u6700\u4f4e\u529f\u8017\u4f4e\u81f32 uA \u652f\u6301\u5916\u8bbe\u529f\u8017\u7ba1\u7406\u6846\u67b6\uff0c\u65b9\u4fbf\u5f00\u53d1\u4eba\u5458\u964d\u4f4e\u8bbe\u5907\u529f\u8017\uff0c\u5ef6\u957f\u8bbe\u5907\u5bff\u547d 3.\u4e30\u5bcc\u7684IoT\u7ec4\u4ef6 \u96c6\u6210\u4e3b\u6d41IoT\u534f\u8bae\u6808\uff08MQTT\u3001CoAP\u3001LoRaWAN\u3001NB-IoT\u7b49\uff09 \u591a\u79cd\u901a\u4fe1\u6a21\u7ec4SAL\u5c42\u9002\u914d\u6846\u67b6\uff0c\u964d\u4f4e\u7f51\u7edc\u786c\u4ef6\u9002\u914d\u65f6\u95f4\u6210\u672c \u652f\u6301OTA\u5347\u7ea7 \u63d0\u4f9b\u7b80\u5355\u6613\u7528\u7aef\u4e91API\uff0c\u52a0\u901f\u7528\u6237\u4e1a\u52a1\u63a5\u5165\u817e\u8baf\u4e91 4.\u53ef\u9760\u7684\u5b89\u5168\u6846\u67b6 \u591a\u6837\u5316\u7684\u5b89\u5168\u5206\u7ea7\u65b9\u6848 \u5747\u8861\u5b89\u5168\u9700\u6c42&\u6210\u672c\u63a7\u5236 5.\u826f\u597d\u7684\u53ef\u79fb\u690d\u6027 \u5185\u6838\u53caIoT\u7ec4\u4ef6\u9ad8\u5ea6\u89e3\u8026\uff0c\u63d0\u4f9b\u6807\u51c6\u9002\u914d\u5c42 \u63d0\u4f9b\u81ea\u52a8\u5316\u79fb\u690d\u5de5\u5177\uff0c\u63d0\u5347\u5f00\u53d1\u6548\u7387 6.\u4fbf\u6377\u7684\u8c03\u8bd5\u624b\u6bb5 \u63d0\u4f9b\u4e91\u5316\u7684\u6700\u540e\u4e00\u5c4f\u8c03\u8bd5\u529f\u80fd \u6545\u969c\u73b0\u573a\u4fe1\u606f\u81ea\u52a8\u4e0a\u4f20\u4e91\u5e73\u53f0\uff0c\u65b9\u4fbf\u5f00\u53d1\u4eba\u5458\u8c03\u8bd5\u5206\u6790 TencentOS tiny\u53ef\u4ee5\u6709\u6548\u51cf\u5c11\u5f00\u53d1\u4eba\u5458\u5728\u4efb\u52a1\u7ba1\u7406\u3001\u786c\u4ef6\u652f\u6301\u3001\u7f51\u7edc\u534f\u8bae\u652f\u6301\u3001\u5b89\u5168\u65b9\u6848\u4ee5\u53ca\u6587\u4ef6\u7cfb\u7edf\u3001 KV \u5b58\u50a8\u3001\u5728\u7ebf\u5347\u7ea7\u7b49\u5e38\u7528\u529f\u80fd\u7ec4\u4ef6\u76f8\u5173\u7684\u5f00\u53d1\u4e2d\u6240\u9700\u8981\u7684\u65f6\u95f4\u548c\u5de5\u4f5c\u91cf\uff0c\u5e76\u4e14\u80fd\u591f\u5feb\u901f\u9ad8\u6548\u7684\u5b9e\u73b0\u8bbe\u5907\u7684\u4f4e\u529f\u8017\u8fd0\u884c\uff0c\u540c\u65f6\u63d0\u4f9b\u5f3a\u5927\u7684\u5f00\u53d1\u8c03\u8bd5\u529f\u80fd\uff0c \u51cf\u5c11\u5f00\u53d1\u6d4b\u8bd5\u4eba\u529b\u6210\u672c\uff0c\u80fd\u591f\u8ba9\u5ba2\u6237\u7684\u4ea7\u54c1\u5b9e\u73b0\u5feb\u901f\u5f00\u53d1\u548c\u5feb\u901f\u4e0a\u7ebf\u4ea4\u4ed8\u3002\u540c\u65f6\uff0c\u6781\u4f4e\u7684\u8d44\u6e90\u5360\u7528\u53ef\u6709\u6548\u964d\u4f4e\u5ba2\u6237\u4ea7\u54c1\u5bf9\u786c\u4ef6\u89c4\u683c\u7684\u9700\u6c42\uff0c\u53ef\u6709\u6548\u964d\u4f4e\u8bbe\u5907\u6210\u672c\u3002 TencentOS tiny\u6574\u4f53\u67b6\u6784 TencentOS tiny\u4e3b\u8981\u7531\u4e00\u4e2a\u8f7b\u91cf\u7ea7RTOS\u5185\u6838+\u591a\u4e2a\u7269\u8054\u7f51\u7ec4\u4ef6\u6784\u6210\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u4e3aTencentOS tiny\u7684\u4e3b\u4f53\u67b6\u6784\u56fe\uff0c\u4ece\u4e0b\u5230\u4e0a\u4e3b\u8981\u5305\u62ec\uff1a CPU\u5e93 \uff1aTencentOS tiny\u652f\u6301\u7684CPU IP\u6838\u67b6\u6784\uff0c\u5f53\u524d\u4e3b\u8981\u652f\u6301ARM Cortex M0/3/4/7\uff0c\u540e\u7eed\u53ef\u652f\u6301\u66f4\u591aIP\u6838\uff0c\u652f\u6301\u66f4\u591a\u79cd\u7c7b\u7684\u5f00\u53d1\u677f\uff1b \u9a71\u52a8\u7ba1\u7406\u5c42 \uff1a\u5305\u62ec\u677f\u7ea7\u652f\u6301\u5305\uff08BSP\uff0c\u4e3b\u8981\u7531MCU\u82af\u7247\u5382\u5bb6\u5f00\u53d1\u4e0e\u7ef4\u62a4\uff09\u3001\u786c\u4ef6\u62bd\u8c61\uff08HAL\uff0c\u4e3b\u8981\u7531TencentOS tiny\u63d0\u4f9b\uff0c\u65b9\u4fbf\u4e0d\u540c\u82af\u7247\u7684\u9002\u914d\u4e0e\u79fb\u690d\uff09\u3001\u8bbe\u5907\u9a71\u52a8\uff08Drivers\uff0c\u6bd4\u5982wifi\u3001GPRS\u3001LORA\u7b49\u6a21\u5757\u7684\u9a71\u52a8\u7a0b\u5e8f\uff09\uff1b \u5185\u6838 \uff1aTencentOS tiny\u5b9e\u65f6\u5185\u6838\u5305\u62ec\u4efb\u52a1\u7ba1\u7406\u3001\u5b9e\u65f6\u8c03\u5ea6\u3001\u65f6\u95f4\u7ba1\u7406\u3001\u4e2d\u65ad\u7ba1\u7406\u3001\u5185\u5b58\u7ba1\u7406\u3001\u5f02\u5e38\u5904\u7406\u3001\u8f6f\u4ef6\u5b9a\u65f6\u5668\u3001\u94fe\u8868\u3001\u6d88\u606f\u961f\u5217\u3001\u4fe1\u53f7\u91cf\u3001\u4e92\u65a5\u9501\u3001\u4e8b\u4ef6\u6807\u5fd7\u7b49\u6a21\u5757\uff1b IoT\u534f\u8bae\u6808 \uff1aTencentOS tiny\u63d0\u4f9blwip\u3001AT Adapter\u3001SAL\u5c42\uff0c\u652f\u6301\u4e0d\u540c\u7684\u7f51\u7edc\u786c\u4ef6\uff0c\u5982\u4ee5\u592a\u7f51\u3001\u4e32\u53e3WIFI\u3001GPRS\u3001NB-IoT\u30014G\u7b49\u901a\u4fe1\u6a21\u5757\u3002TCP/IP\u7f51\u7edc\u534f\u8bae\u6808\u4e0a\u63d0\u4f9b\u5e38\u7528\u7684\u7269\u8054\u7f51\u534f\u8bae\u6808\uff0c\u5982COAP\u3001MQTT\uff0c\u652f\u6491\u7ec8\u7aef\u4e1a\u52a1\u5feb\u901f\u63a5\u5165\u817e\u8baf\u4e91\uff1b \u5b89\u5168\u6846\u67b6 \uff1aTencentOS tiny\u4e3a\u4e86\u786e\u4fdd\u7269\u8054\u7f51\u7ec8\u7aef\u6570\u636e\u4f20\u8f93\u5b89\u5168\u4ee5\u53ca\u8bbe\u5907\u8ba4\u8bc1\u5b89\u5168\uff0c\u63d0\u4f9b\u4e86\u6bd4\u8f83\u5b8c\u6574\u7684\u5b89\u5168\u89e3\u51b3\u65b9\u6848\u3002\u5b89\u5168\u6846\u67b6\u63d0\u4f9b\u7684DTLS\u548cTLS\u5b89\u5168\u534f\u8bae\u52a0\u56fa\u4e86COAP\u53caMQTT\u7684\u4f20\u8f93\u5c42\uff0c\u53ef\u786e\u4fdd\u7269\u8054\u7f51\u7ec8\u7aef\u5728\u5bf9\u63a5\u817e\u8baf\u4e91\u65f6\u5b9e\u73b0\u5b89\u5168\u8ba4\u8bc1\u548c\u6570\u636e\u52a0\u5bc6\uff1b\u53e6\u5916\u9488\u5bf9\u4f4e\u8d44\u6e90\u7684\u7ec8\u7aef\u786c\u4ef6\uff0c\u5b89\u5168\u6846\u67b6\u8fd8\u63d0\u4f9b\u4e0e\u817e\u8baf\u4e91IoTHub\u914d\u5957\u7684\u5bc6\u94a5\u8ba4\u8bc1\u65b9\u6848\uff0c\u786e\u4fdd\u8d44\u6e90\u53d7\u9650\u8bbe\u5907\u4e5f\u80fd\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u5b9e\u73b0\u8bbe\u5907\u5b89\u5168\u8ba4\u8bc1\uff1b \u7ec4\u4ef6\u6846\u67b6 \uff1aTencentOS tiny\u63d0\u4f9b\u6587\u4ef6\u7cfb\u7edf\u3001KV\u5b58\u50a8\u3001\u81ea\u7ec4\u7f51\u3001JS\u5f15\u64ce\u3001\u4f4e\u529f\u8017\u6846\u67b6\u3001\u8bbe\u5907\u6846\u67b6\u3001OTA\u3001\u8c03\u8bd5\u5de5\u5177\u94fe\u7b49\u4e00\u7cfb\u5217\u7ec4\u4ef6\uff0c\u4f9b\u7528\u6237\u6839\u636e\u4e1a\u52a1\u573a\u666f\u9009\u7528\uff1b \u5f00\u653eAPI (\u89c4\u5212\u5f00\u53d1\u4e2d)\uff1aTencentOS tiny\u5c06\u5728\u534f\u8bae\u4e2d\u95f4\u4ef6\u548c\u6846\u67b6\u5c42\u4e0a\u63d0\u4f9b\u5f00\u653eAPI\u51fd\u6570\uff0c\u65b9\u4fbf\u7528\u6237\u8c03\u7528\u4e2d\u95f4\u4ef6\u529f\u80fd\uff0c\u4f7f\u7528\u6237\u4e0d\u7528\u8fc7\u591a\u5173\u5fc3\u4e2d\u95f4\u4ef6\u5177\u4f53\u5b9e\u73b0\uff0c\u5feb\u901f\u5bf9\u63a5\u817e\u8baf\u4e91\uff0c\u5b9e\u73b0\u7ec8\u7aef\u4e1a\u52a1\u4e0a\u4e91\u7684\u9700\u6c42\uff0c\u671f\u671b\u6700\u5927\u7a0b\u5ea6\u51cf\u5c11\u7ec8\u7aef\u7269\u8054\u7f51\u4ea7\u54c1\u5f00\u53d1\u5468\u671f\uff0c\u8282\u7701\u5f00\u53d1\u6210\u672c\uff1b \u793a\u4f8b\u5e94\u7528 \uff1aTencentOS tiny\u63d0\u4f9b\u7684\u793a\u4f8b\u4ee3\u7801\uff0c\u6a21\u5757\u6d4b\u8bd5\u4ee3\u7801\u7b49\uff0c\u65b9\u4fbf\u7528\u6237\u53c2\u8003\u4f7f\u7528\u3002","title":"01.Introduction"},{"location":"01.Introduction/#tencentos-tiny","text":"TencentOS tiny\u662f\u817e\u8baf\u9762\u5411\u7269\u8054\u7f51\u9886\u57df\u5f00\u53d1\u7684\u5b9e\u65f6\u7ec8\u7aef\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5177\u6709\u4f4e\u529f\u8017\uff0c\u4f4e\u8d44\u6e90\u5360\u7528\uff0c\u6a21\u5757\u5316\uff0c\u53ef\u88c1\u526a\u7b49\u7279\u6027\u3002 TencentOS tiny\u63d0\u4f9b\u6700\u7cbe\u7b80\u7684RTOS\u5185\u6838\uff0c\u5185\u6838\u7ec4\u4ef6\u53ef\u88c1\u526a\u53ef\u914d\u7f6e\uff0c\u53ef\u7075\u6d3b\u79fb\u690d\u5230\u591a\u79cd\u7ec8\u7aefMCU\u4e0a\u3002\u800c\u4e14\uff0c\u57fa\u4e8eRTOS\u5185\u6838\uff0c\u63d0\u4f9b\u4e86COAP/MQTT/TLS/DTLS\u7b49\u5e38\u7528\u7269\u8054\u7f51\u534f\u8bae\u6808\u53ca\u7ec4\u4ef6\uff0c\u65b9\u4fbf\u7528\u6237\u5feb\u901f\u63a5\u5165\u817e\u8baf\u4e91IoT Hub\u3002 TencentOS tiny\u4e3a\u7269\u8054\u7f51\u7ec8\u7aef\u5382\u5bb6\u63d0\u4f9b\u4e00\u7ad9\u5f0f\u8f6f\u4ef6\u89e3\u51b3\u65b9\u6848\uff0c\u65b9\u4fbf\u5404\u79cd\u7269\u8054\u7f51\u8bbe\u5907\u5feb\u901f\u63a5\u5165\u817e\u8baf\u4e91\uff0c\u53ef\u652f\u6491\u667a\u6167\u57ce\u5e02\u3001\u667a\u80fd\u6c34\u8868\u3001\u667a\u80fd\u5bb6\u5c45\u3001\u667a\u80fd\u7a7f\u6234\u3001\u8f66\u8054\u7f51\u7b49\u591a\u79cd\u884c\u4e1a\u5e94\u7528\u3002 TencentOS tiny\u7684\u4f18\u52bf\uff1a 1.\u5c0f\u4f53\u79ef \u6700\u5c0f\u5185\u6838\uff1aRAM 0.6KB\uff0cROM 1.8KB \u5178\u578bLoraWAN\u53ca\u4f20\u611f\u5668\u5e94\u7528\uff1aRAM 3.3KB\uff0cROM 12KB 2.\u4f4e\u529f\u8017 \u4f11\u7720\u6700\u4f4e\u529f\u8017\u4f4e\u81f32 uA \u652f\u6301\u5916\u8bbe\u529f\u8017\u7ba1\u7406\u6846\u67b6\uff0c\u65b9\u4fbf\u5f00\u53d1\u4eba\u5458\u964d\u4f4e\u8bbe\u5907\u529f\u8017\uff0c\u5ef6\u957f\u8bbe\u5907\u5bff\u547d 3.\u4e30\u5bcc\u7684IoT\u7ec4\u4ef6 \u96c6\u6210\u4e3b\u6d41IoT\u534f\u8bae\u6808\uff08MQTT\u3001CoAP\u3001LoRaWAN\u3001NB-IoT\u7b49\uff09 \u591a\u79cd\u901a\u4fe1\u6a21\u7ec4SAL\u5c42\u9002\u914d\u6846\u67b6\uff0c\u964d\u4f4e\u7f51\u7edc\u786c\u4ef6\u9002\u914d\u65f6\u95f4\u6210\u672c \u652f\u6301OTA\u5347\u7ea7 \u63d0\u4f9b\u7b80\u5355\u6613\u7528\u7aef\u4e91API\uff0c\u52a0\u901f\u7528\u6237\u4e1a\u52a1\u63a5\u5165\u817e\u8baf\u4e91 4.\u53ef\u9760\u7684\u5b89\u5168\u6846\u67b6 \u591a\u6837\u5316\u7684\u5b89\u5168\u5206\u7ea7\u65b9\u6848 \u5747\u8861\u5b89\u5168\u9700\u6c42&\u6210\u672c\u63a7\u5236 5.\u826f\u597d\u7684\u53ef\u79fb\u690d\u6027 \u5185\u6838\u53caIoT\u7ec4\u4ef6\u9ad8\u5ea6\u89e3\u8026\uff0c\u63d0\u4f9b\u6807\u51c6\u9002\u914d\u5c42 \u63d0\u4f9b\u81ea\u52a8\u5316\u79fb\u690d\u5de5\u5177\uff0c\u63d0\u5347\u5f00\u53d1\u6548\u7387 6.\u4fbf\u6377\u7684\u8c03\u8bd5\u624b\u6bb5 \u63d0\u4f9b\u4e91\u5316\u7684\u6700\u540e\u4e00\u5c4f\u8c03\u8bd5\u529f\u80fd \u6545\u969c\u73b0\u573a\u4fe1\u606f\u81ea\u52a8\u4e0a\u4f20\u4e91\u5e73\u53f0\uff0c\u65b9\u4fbf\u5f00\u53d1\u4eba\u5458\u8c03\u8bd5\u5206\u6790 TencentOS tiny\u53ef\u4ee5\u6709\u6548\u51cf\u5c11\u5f00\u53d1\u4eba\u5458\u5728\u4efb\u52a1\u7ba1\u7406\u3001\u786c\u4ef6\u652f\u6301\u3001\u7f51\u7edc\u534f\u8bae\u652f\u6301\u3001\u5b89\u5168\u65b9\u6848\u4ee5\u53ca\u6587\u4ef6\u7cfb\u7edf\u3001 KV \u5b58\u50a8\u3001\u5728\u7ebf\u5347\u7ea7\u7b49\u5e38\u7528\u529f\u80fd\u7ec4\u4ef6\u76f8\u5173\u7684\u5f00\u53d1\u4e2d\u6240\u9700\u8981\u7684\u65f6\u95f4\u548c\u5de5\u4f5c\u91cf\uff0c\u5e76\u4e14\u80fd\u591f\u5feb\u901f\u9ad8\u6548\u7684\u5b9e\u73b0\u8bbe\u5907\u7684\u4f4e\u529f\u8017\u8fd0\u884c\uff0c\u540c\u65f6\u63d0\u4f9b\u5f3a\u5927\u7684\u5f00\u53d1\u8c03\u8bd5\u529f\u80fd\uff0c \u51cf\u5c11\u5f00\u53d1\u6d4b\u8bd5\u4eba\u529b\u6210\u672c\uff0c\u80fd\u591f\u8ba9\u5ba2\u6237\u7684\u4ea7\u54c1\u5b9e\u73b0\u5feb\u901f\u5f00\u53d1\u548c\u5feb\u901f\u4e0a\u7ebf\u4ea4\u4ed8\u3002\u540c\u65f6\uff0c\u6781\u4f4e\u7684\u8d44\u6e90\u5360\u7528\u53ef\u6709\u6548\u964d\u4f4e\u5ba2\u6237\u4ea7\u54c1\u5bf9\u786c\u4ef6\u89c4\u683c\u7684\u9700\u6c42\uff0c\u53ef\u6709\u6548\u964d\u4f4e\u8bbe\u5907\u6210\u672c\u3002","title":"TencentOS tiny \u4ea7\u54c1\u7b80\u4ecb"},{"location":"01.Introduction/#tencentos-tiny_1","text":"TencentOS tiny\u4e3b\u8981\u7531\u4e00\u4e2a\u8f7b\u91cf\u7ea7RTOS\u5185\u6838+\u591a\u4e2a\u7269\u8054\u7f51\u7ec4\u4ef6\u6784\u6210\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u4e3aTencentOS tiny\u7684\u4e3b\u4f53\u67b6\u6784\u56fe\uff0c\u4ece\u4e0b\u5230\u4e0a\u4e3b\u8981\u5305\u62ec\uff1a CPU\u5e93 \uff1aTencentOS tiny\u652f\u6301\u7684CPU IP\u6838\u67b6\u6784\uff0c\u5f53\u524d\u4e3b\u8981\u652f\u6301ARM Cortex M0/3/4/7\uff0c\u540e\u7eed\u53ef\u652f\u6301\u66f4\u591aIP\u6838\uff0c\u652f\u6301\u66f4\u591a\u79cd\u7c7b\u7684\u5f00\u53d1\u677f\uff1b \u9a71\u52a8\u7ba1\u7406\u5c42 \uff1a\u5305\u62ec\u677f\u7ea7\u652f\u6301\u5305\uff08BSP\uff0c\u4e3b\u8981\u7531MCU\u82af\u7247\u5382\u5bb6\u5f00\u53d1\u4e0e\u7ef4\u62a4\uff09\u3001\u786c\u4ef6\u62bd\u8c61\uff08HAL\uff0c\u4e3b\u8981\u7531TencentOS tiny\u63d0\u4f9b\uff0c\u65b9\u4fbf\u4e0d\u540c\u82af\u7247\u7684\u9002\u914d\u4e0e\u79fb\u690d\uff09\u3001\u8bbe\u5907\u9a71\u52a8\uff08Drivers\uff0c\u6bd4\u5982wifi\u3001GPRS\u3001LORA\u7b49\u6a21\u5757\u7684\u9a71\u52a8\u7a0b\u5e8f\uff09\uff1b \u5185\u6838 \uff1aTencentOS tiny\u5b9e\u65f6\u5185\u6838\u5305\u62ec\u4efb\u52a1\u7ba1\u7406\u3001\u5b9e\u65f6\u8c03\u5ea6\u3001\u65f6\u95f4\u7ba1\u7406\u3001\u4e2d\u65ad\u7ba1\u7406\u3001\u5185\u5b58\u7ba1\u7406\u3001\u5f02\u5e38\u5904\u7406\u3001\u8f6f\u4ef6\u5b9a\u65f6\u5668\u3001\u94fe\u8868\u3001\u6d88\u606f\u961f\u5217\u3001\u4fe1\u53f7\u91cf\u3001\u4e92\u65a5\u9501\u3001\u4e8b\u4ef6\u6807\u5fd7\u7b49\u6a21\u5757\uff1b IoT\u534f\u8bae\u6808 \uff1aTencentOS tiny\u63d0\u4f9blwip\u3001AT Adapter\u3001SAL\u5c42\uff0c\u652f\u6301\u4e0d\u540c\u7684\u7f51\u7edc\u786c\u4ef6\uff0c\u5982\u4ee5\u592a\u7f51\u3001\u4e32\u53e3WIFI\u3001GPRS\u3001NB-IoT\u30014G\u7b49\u901a\u4fe1\u6a21\u5757\u3002TCP/IP\u7f51\u7edc\u534f\u8bae\u6808\u4e0a\u63d0\u4f9b\u5e38\u7528\u7684\u7269\u8054\u7f51\u534f\u8bae\u6808\uff0c\u5982COAP\u3001MQTT\uff0c\u652f\u6491\u7ec8\u7aef\u4e1a\u52a1\u5feb\u901f\u63a5\u5165\u817e\u8baf\u4e91\uff1b \u5b89\u5168\u6846\u67b6 \uff1aTencentOS tiny\u4e3a\u4e86\u786e\u4fdd\u7269\u8054\u7f51\u7ec8\u7aef\u6570\u636e\u4f20\u8f93\u5b89\u5168\u4ee5\u53ca\u8bbe\u5907\u8ba4\u8bc1\u5b89\u5168\uff0c\u63d0\u4f9b\u4e86\u6bd4\u8f83\u5b8c\u6574\u7684\u5b89\u5168\u89e3\u51b3\u65b9\u6848\u3002\u5b89\u5168\u6846\u67b6\u63d0\u4f9b\u7684DTLS\u548cTLS\u5b89\u5168\u534f\u8bae\u52a0\u56fa\u4e86COAP\u53caMQTT\u7684\u4f20\u8f93\u5c42\uff0c\u53ef\u786e\u4fdd\u7269\u8054\u7f51\u7ec8\u7aef\u5728\u5bf9\u63a5\u817e\u8baf\u4e91\u65f6\u5b9e\u73b0\u5b89\u5168\u8ba4\u8bc1\u548c\u6570\u636e\u52a0\u5bc6\uff1b\u53e6\u5916\u9488\u5bf9\u4f4e\u8d44\u6e90\u7684\u7ec8\u7aef\u786c\u4ef6\uff0c\u5b89\u5168\u6846\u67b6\u8fd8\u63d0\u4f9b\u4e0e\u817e\u8baf\u4e91IoTHub\u914d\u5957\u7684\u5bc6\u94a5\u8ba4\u8bc1\u65b9\u6848\uff0c\u786e\u4fdd\u8d44\u6e90\u53d7\u9650\u8bbe\u5907\u4e5f\u80fd\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u5b9e\u73b0\u8bbe\u5907\u5b89\u5168\u8ba4\u8bc1\uff1b \u7ec4\u4ef6\u6846\u67b6 \uff1aTencentOS tiny\u63d0\u4f9b\u6587\u4ef6\u7cfb\u7edf\u3001KV\u5b58\u50a8\u3001\u81ea\u7ec4\u7f51\u3001JS\u5f15\u64ce\u3001\u4f4e\u529f\u8017\u6846\u67b6\u3001\u8bbe\u5907\u6846\u67b6\u3001OTA\u3001\u8c03\u8bd5\u5de5\u5177\u94fe\u7b49\u4e00\u7cfb\u5217\u7ec4\u4ef6\uff0c\u4f9b\u7528\u6237\u6839\u636e\u4e1a\u52a1\u573a\u666f\u9009\u7528\uff1b \u5f00\u653eAPI (\u89c4\u5212\u5f00\u53d1\u4e2d)\uff1aTencentOS tiny\u5c06\u5728\u534f\u8bae\u4e2d\u95f4\u4ef6\u548c\u6846\u67b6\u5c42\u4e0a\u63d0\u4f9b\u5f00\u653eAPI\u51fd\u6570\uff0c\u65b9\u4fbf\u7528\u6237\u8c03\u7528\u4e2d\u95f4\u4ef6\u529f\u80fd\uff0c\u4f7f\u7528\u6237\u4e0d\u7528\u8fc7\u591a\u5173\u5fc3\u4e2d\u95f4\u4ef6\u5177\u4f53\u5b9e\u73b0\uff0c\u5feb\u901f\u5bf9\u63a5\u817e\u8baf\u4e91\uff0c\u5b9e\u73b0\u7ec8\u7aef\u4e1a\u52a1\u4e0a\u4e91\u7684\u9700\u6c42\uff0c\u671f\u671b\u6700\u5927\u7a0b\u5ea6\u51cf\u5c11\u7ec8\u7aef\u7269\u8054\u7f51\u4ea7\u54c1\u5f00\u53d1\u5468\u671f\uff0c\u8282\u7701\u5f00\u53d1\u6210\u672c\uff1b \u793a\u4f8b\u5e94\u7528 \uff1aTencentOS tiny\u63d0\u4f9b\u7684\u793a\u4f8b\u4ee3\u7801\uff0c\u6a21\u5757\u6d4b\u8bd5\u4ee3\u7801\u7b49\uff0c\u65b9\u4fbf\u7528\u6237\u53c2\u8003\u4f7f\u7528\u3002","title":"TencentOS tiny\u6574\u4f53\u67b6\u6784"},{"location":"02.Help/","text":"TencentOS tiny \u670d\u52a1\u514d\u8d39\u3002 \u5f53\u60a8\u9047\u5230\u95ee\u9898\u65f6\uff0c\u8bf7\u8054\u7cfb\u6211\u4eec\u5bfb\u6c42\u76f8\u5e94\u7684\u5e2e\u52a9\u3002 \u8054\u7cfb\u65b9\u5f0f \u90ae\u7bb1\uff1a supowang@tencent.com \u7535\u8bdd\uff1a075586013388\u8f6c875674","title":"02.Help"},{"location":"03.Summary/","text":"\u7b2c 1 \u6b65\uff1a \u767b\u5f55\u6ce8\u518c \u767b\u5f55\u817e\u8baf\u4e91\u5b98\u7f51\u3002\u5982\u679c\u6ca1\u6709\u8d26\u53f7\uff0c\u8bf7\u53c2\u8003\u8d26\u53f7\u6ce8\u518c\u6559\u7a0b\uff08https://www.qcloud.com/document/product/378/8415\uff09\u3002 \u7b2c 2 \u6b65\uff1a\u6e90\u7801\u4e0b\u8f7d \u76ee\u524d\u817e\u8baf\u7269\u8054\u7f51\u7ec8\u7aef\u64cd\u4f5c\u7cfb\u7edf TencentOS tiny \u5df2\u7ecf\u5728 github \u5f00\u6e90\uff0c\u60a8\u53ef\u4ee5\u76f4\u63a5 \u4e0b\u8f7d\u5de5\u7a0b \uff0c\u6839\u636e\u5de5\u7a0b\u5305\u5185\u7684\u6307\u793a\u8fdb\u884c\u5f00\u53d1\u4f7f\u7528\u3002 \u7b2c 3 \u6b65\uff1a\u5f00\u53d1\u6307\u5357 \u60a8\u53ef\u4ee5\u53c2\u8003\u817e\u8baf\u7269\u8054\u7f51\u7ec8\u7aef\u64cd\u4f5c\u7cfb\u7edf TencentOS tiny \u5f00\u53d1\u6307\u5357\u6587\u6863\u8fdb\u884c\u5f00\u53d1\uff0c\u5f00\u53d1\u6307\u5357\u4f1a\u8be6\u7ec6\u4ecb\u7ecd\u57fa\u7840\u5185\u6838\u3001\u901a\u4fe1SDK\u7b49\u76f8\u5173\u4fe1\u606f\u3002 \u7b2c 4 \u6b65\uff1a\u4f7f\u7528\u53cd\u9988 \u60a8\u5bf9TencentOS tiny\u4ea7\u54c1\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u6709\u4efb\u4f55\u95ee\u9898\u6216\u8005\u5efa\u8bae\uff0c\u6b22\u8fce\u8ddf\u6211\u4eec\u7684\u4ea7\u54c1\u56e2\u961f\u53cd\u9988\u3002 \u53cd\u9988\u90ae\u7bb1\uff1asupowang@tencent.com","title":"03.Summary"},{"location":"03.Summary/#1","text":"\u767b\u5f55\u817e\u8baf\u4e91\u5b98\u7f51\u3002\u5982\u679c\u6ca1\u6709\u8d26\u53f7\uff0c\u8bf7\u53c2\u8003\u8d26\u53f7\u6ce8\u518c\u6559\u7a0b\uff08https://www.qcloud.com/document/product/378/8415\uff09\u3002","title":"\u7b2c 1 \u6b65\uff1a \u767b\u5f55\u6ce8\u518c"},{"location":"03.Summary/#2","text":"\u76ee\u524d\u817e\u8baf\u7269\u8054\u7f51\u7ec8\u7aef\u64cd\u4f5c\u7cfb\u7edf TencentOS tiny \u5df2\u7ecf\u5728 github \u5f00\u6e90\uff0c\u60a8\u53ef\u4ee5\u76f4\u63a5 \u4e0b\u8f7d\u5de5\u7a0b \uff0c\u6839\u636e\u5de5\u7a0b\u5305\u5185\u7684\u6307\u793a\u8fdb\u884c\u5f00\u53d1\u4f7f\u7528\u3002","title":"\u7b2c 2 \u6b65\uff1a\u6e90\u7801\u4e0b\u8f7d"},{"location":"03.Summary/#3","text":"\u60a8\u53ef\u4ee5\u53c2\u8003\u817e\u8baf\u7269\u8054\u7f51\u7ec8\u7aef\u64cd\u4f5c\u7cfb\u7edf TencentOS tiny \u5f00\u53d1\u6307\u5357\u6587\u6863\u8fdb\u884c\u5f00\u53d1\uff0c\u5f00\u53d1\u6307\u5357\u4f1a\u8be6\u7ec6\u4ecb\u7ecd\u57fa\u7840\u5185\u6838\u3001\u901a\u4fe1SDK\u7b49\u76f8\u5173\u4fe1\u606f\u3002","title":"\u7b2c 3 \u6b65\uff1a\u5f00\u53d1\u6307\u5357"},{"location":"03.Summary/#4","text":"\u60a8\u5bf9TencentOS tiny\u4ea7\u54c1\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u6709\u4efb\u4f55\u95ee\u9898\u6216\u8005\u5efa\u8bae\uff0c\u6b22\u8fce\u8ddf\u6211\u4eec\u7684\u4ea7\u54c1\u56e2\u961f\u53cd\u9988\u3002 \u53cd\u9988\u90ae\u7bb1\uff1asupowang@tencent.com","title":"\u7b2c 4 \u6b65\uff1a\u4f7f\u7528\u53cd\u9988"},{"location":"04.Development_Manual/","text":"TencentOS tiny\u5f00\u53d1\u6307\u5357 \u76ee\u5f55 TencentOS tiny\u5f00\u53d1\u6307\u5357 1. \u6982\u8ff0 1.1 \u57fa\u7840\u5185\u6838\u7ec4\u4ef6 2. \u57fa\u7840\u5185\u6838 2.1 \u7cfb\u7edf\u7ba1\u7406 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.2 \u4efb\u52a1\u7ba1\u7406 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.3 \u4efb\u52a1\u95f4\u901a\u4fe1 2.3.1 \u4e92\u65a5\u91cf \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.3.2 \u4fe1\u53f7\u91cf \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.3.3 \u4e8b\u4ef6 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.3.4 \u5b8c\u6210\u91cf \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.3.5 \u8ba1\u6570\u9501 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.3.6 \u6805\u680f \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.3.7 \u6d88\u606f\u961f\u5217 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.3.8 \u90ae\u7bb1\u961f\u5217 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.3.9 \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.3.10 \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.4 \u5185\u5b58\u7ba1\u7406 2.4.1 \u52a8\u6001\u5185\u5b58 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.4.2 \u9759\u6001\u5185\u5b58 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.5 \u65f6\u95f4\u7ba1\u7406 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.6 \u8f6f\u4ef6\u5b9a\u65f6\u5668 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.7 \u65f6\u95f4\u7247\u8f6e\u8f6c\u673a\u5236 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.8 \u5185\u6838\u57fa\u7840\u7ec4\u4ef6 2.8.1 \u73af\u5f62\u961f\u5217 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.8.2 \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.8.3 \u4e8c\u9879\u5806 \u6982\u8ff0 2.8.4 \u4f18\u5148\u7ea7\u961f\u5217 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.9 \u529f\u8017\u7ba1\u7406 2.9.1 \u4f4e\u529f\u8017 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.9.2 tickless \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 1. \u6982\u8ff0 TencentOS tiny\u662f\u9762\u5411\u7269\u8054\u7f51\uff08IOT\uff09\u9886\u57df\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0c\u7531\u4e00\u4e2a\u5b9e\u73b0\u7cbe\u7b80\u7684\u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf\uff08RTOS\uff09\u5185\u6838\uff0c\u4ee5\u53ca\u4e30\u5bcc\u7684\u7269\u8054\u7f51\u7ec4\u4ef6\u7ec4\u6210\u3002 1.1 \u57fa\u7840\u5185\u6838\u7ec4\u4ef6 \u7cfb\u7edf\u7ba1\u7406 \u7cfb\u7edf\u7ba1\u7406\u6a21\u5757\uff0c\u4e3b\u8981\u63d0\u4f9b\u4e86\u5185\u6838\u7684\u521d\u59cb\u5316\u3001\u5185\u6838\u8fd0\u884c\u542f\u52a8\uff0c\u4e2d\u65ad\u8fdb\u5165/\u9000\u51fa\u6d41\u7a0b\u6258\u7ba1\u3001\u7cfb\u7edf\u8c03\u5ea6\u9501\u5b9a\u53ca\u89e3\u9501\u7b49\u529f\u80fd\u3002 \u4efb\u52a1\u7ba1\u7406 \u63d0\u4f9b\u4e86\u4efb\u52a1\u7684\u521b\u5efa\u3001\u5220\u9664\u3001\u7761\u7720\u3001\u53d6\u6d88\u7761\u7720\u3001\u6302\u8d77\u3001\u6062\u590d\u3001\u4f18\u5148\u7ea7\u4fee\u6539\u3001\u4e3b\u52a8\u653e\u5f03CPU\u7b49\u529f\u80fd\u3002 \u4efb\u52a1\u95f4\u901a\u4fe1 \u63d0\u4f9b\u4e92\u65a5\u91cf\u3001\u4fe1\u53f7\u91cf\u3001\u961f\u5217\u3001\u4e8b\u4ef6\u7b49\u5e38\u7528\u4efb\u52a1\u95f4\u901a\u4fe1\u673a\u5236\u3002 \u5185\u5b58\u7ba1\u7406 \u63d0\u4f9b\u4e86\u57fa\u4e8e\u5806\u7684\u52a8\u6001\u5185\u5b58\u7ba1\u7406\uff0c\u4ee5\u53ca\u9759\u6001\u5185\u5b58\u5757\u7ba1\u7406\u673a\u5236\u3002 \u65f6\u95f4\u7ba1\u7406 \u63d0\u4f9b\u4e86\u83b7\u53d6/\u8bbe\u7f6e\u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570\u3001\u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570\u4e0e\u5899\u4e0a\u65f6\u949f\u65f6\u95f4\u8f6c\u6362\u3001\u57fa\u4e8e\u5899\u4e0a\u65f6\u949f\u65f6\u95f4\u7684\u4efb\u52a1\u7761\u7720\u7b49\u673a\u5236\u3002 \u8f6f\u4ef6\u5b9a\u65f6\u5668 \u63d0\u4f9b\u4e86\u8f6f\u4ef6\u5b9a\u65f6\u5668\u7684\u521b\u5efa\u3001\u5220\u9664\u3001\u542f\u52a8\u3001\u505c\u6b62\u7b49\u673a\u5236\u3002 \u65f6\u95f4\u7247\u8f6e\u8f6c\u673a\u5236 TencentOS tiny\u5185\u6838\u5728\u63d0\u4f9b\u53ef\u62a2\u5360\u5f0f\u8c03\u5ea6\u5185\u6838\u57fa\u7840\u4e0a\uff0c\u8fd8\u63d0\u4f9b\u4e86\u6309\u65f6\u95f4\u7247\u8f6e\u8f6c\u7684robin\u673a\u5236\u3002 \u5185\u6838\u57fa\u7840\u7ec4\u4ef6 \u63d0\u4f9b\u4e86\u6d88\u606f\u961f\u5217\u3001\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u7b49\u673a\u5236\u3002 \u529f\u8017\u7ba1\u7406 \u63d0\u4f9b\u4e86CPU\u4f4e\u529f\u8017\u8fd0\u884c\u6a21\u5f0f\u8bbe\u7f6e\u3001\u4f4e\u529f\u8017\u8bbe\u5907\u6ce8\u518c\u3001\u677f\u7ea7\u5524\u9192\u95f9\u949f\u8bbe\u7f6e\u7b49\u673a\u5236\u3002 2. \u57fa\u7840\u5185\u6838 2.1 \u7cfb\u7edf\u7ba1\u7406 \u6982\u8ff0 \u7cfb\u7edf\u7ba1\u7406\u6a21\u5757\u63d0\u4f9b\u4e86\u51e0\u4e2a\u63a5\u53e3\uff0c\u7528\u4ee5\u521d\u59cb\u5316/\u542f\u52a8TencentOS tiny\u5185\u6838\u3001\u9501\u5b9a/\u89e3\u9501\u7cfb\u7edf\u8c03\u5ea6\u7b49\u3002 API\u8bb2\u89e3 k_err_t tos_knl_init(void); \u521d\u59cb\u5316\u5185\u6838\u3002 k_err_t tos_knl_start(void); \u542f\u52a8\u8fd0\u884c\u5185\u6838\uff0c\u5f00\u59cb\u7b2c\u4e00\u4e2a\u4efb\u52a1\u8c03\u5ea6\u3002 int tos_knl_is_running(void); \u5224\u65ad\u5185\u6838\u662f\u5426\u5df2\u542f\u52a8\u8fd0\u884c\u3002 void tos_knl_irq_enter(void); \u6b64\u51fd\u6570\u5e94\u8be5\u5728\u4e2d\u65ad\u8c03\u7528\u51fd\u6570\u7684\u6700\u524d\u7aef\u88ab\u8c03\u7528\u3002 void tos_knl_irq_leave(void); \u6b64\u51fd\u6570\u5e94\u8be5\u5728\u4e2d\u65ad\u8c03\u7528\u51fd\u6570\u7684\u5c3e\u7aef\u88ab\u8c03\u7528\u3002 k_err_t tos_knl_sched_lock(void); \u9501\u5b9a\u7cfb\u7edf\u8c03\u5ea6\uff0c\u6b64\u51fd\u6570\u88ab\u8c03\u7528\u5e76\u8fd4\u56deK_ERR_NONE\u65f6\uff0c\u7cfb\u7edf\u8c03\u5ea6\u4f1a\u88ab\u9501\u5b9a\uff0c\u7cfb\u7edf\u8c03\u5ea6\u5668\u4e0d\u518d\u8fdb\u884c\u4efb\u52a1\u7684\u5207\u6362\u3002 k_err_t tos_knl_sched_unlock(void); \u89e3\u9501\u7cfb\u7edf\u8c03\u5ea6\uff0c\u5141\u8bb8\u4efb\u52a1\u5207\u6362\u3002 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.2 \u4efb\u52a1\u7ba1\u7406 \u6982\u8ff0 TencentOS tiny\u5185\u6838\u662f\u5355\u5730\u5740\u7a7a\u95f4\u7684\u53ef\u62a2\u5360\u5f0f\u5b9e\u65f6\u5185\u6838\uff0cTencentOS tiny\u5185\u6838\u4e0d\u63d0\u4f9b\u8fdb\u7a0b\u6a21\u578b\uff0c\u4efb\u52a1\u5bf9\u5e94\u7ebf\u7a0b\u7684\u6982\u5ff5\uff0c\u662f\u6700\u5c0f\u7684\u8c03\u5ea6\u8fd0\u884c\u4f53\uff0c\u4e5f\u662f\u6700\u5c0f\u7684\u8d44\u6e90\u6301\u6709\u5355\u4f4d\u3002 \u4efb\u52a1\u7684\u672c\u8d28\u662f\u4e00\u4e2a\u62e5\u6709\u72ec\u7acb\u6808\u7a7a\u95f4\u7684\u53ef\u8c03\u5ea6\u8fd0\u884c\u5b9e\u4f53\uff0c\u7528\u6237\u53ef\u4ee5\u5728\u4efb\u52a1\u7684\u5165\u53e3\u51fd\u6570\u4e2d\u7f16\u5199\u81ea\u5df1\u7684\u4e1a\u52a1\u903b\u8f91\uff1b\u591a\u4e2a\u4efb\u52a1\u4e4b\u95f4\u53ef\u4ee5\u901a\u8fc7\u7cfb\u7edf\u63d0\u4f9b\u7684\u4efb\u52a1\u95f4\u901a\u4fe1\u673a\u5236\u8fdb\u884c\u540c\u6b65\u6216\u8005\u4fe1\u606f\u4f20\u9012\u7b49\u64cd\u4f5c\uff1b\u6bcf\u4e2a\u4efb\u52a1\u90fd\u6709\u4f18\u5148\u7ea7\uff0c\u9ad8\u4f18\u5148\u7ea7\u4efb\u52a1\u53ef\u4ee5\u62a2\u5360\u4f4e\u4f18\u5148\u7ea7\u4efb\u52a1\u7684\u8fd0\u884c\u3002 API\u8bb2\u89e3 \u521b\u5efa\u4efb\u52a1\u7684\u7cfb\u7edfapi\u63a5\u53e3\u4e3atos_task_create\uff0c\u63a5\u53e3\u539f\u578b\u5982\u4e0b\uff1a k_err_t tos_task_create(k_task_t *task, char *name, k_task_entry_t entry, void *arg, k_prio_t prio, k_stack_t *stk_base, size_t stk_size, k_timeslice_t timeslice); \u8fd9\u91cc\u8be6\u7ec6\u8bb2\u89e3\u6b64api\u53c2\u6570\u610f\u4e49\uff1a task \u8fd9\u662f\u4e00\u4e2ak_task_t\u7c7b\u578b\u7684\u6307\u9488\uff0ck_task_t\u662f\u5185\u6838\u7684\u4efb\u52a1\u7ed3\u6784\u4f53\u7c7b\u578b\u3002\u6ce8\u610f\uff1atask\u6307\u9488\uff0c\u5e94\u8be5\u6307\u5411\u751f\u547d\u5468\u671f\u5927\u4e8e\u5f85\u521b\u5efa\u4efb\u52a1\u4f53\u751f\u547d\u5468\u671f\u7684k_task_t\u7c7b\u578b\u53d8\u91cf\uff0c\u5982\u679c\u8be5\u6307\u9488\u6307\u5411\u7684\u53d8\u91cf\u751f\u547d\u5468\u671f\u6bd4\u5f85\u521b\u5efa\u7684\u4efb\u52a1\u4f53\u751f\u547d\u5468\u671f\u77ed\uff0c\u8b6c\u5982\u53ef\u80fd\u662f\u4e00\u4e2a\u751f\u547d\u5468\u671f\u6781\u7aef\u7684\u51fd\u6570\u6808\u4e0a\u53d8\u91cf\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u4efb\u52a1\u4f53\u8fd8\u5728\u8fd0\u884c\u800ck_task_t\u53d8\u91cf\u5df2\u88ab\u9500\u6bc1\uff0c\u4f1a\u5bfc\u81f4\u7cfb\u7edf\u8c03\u5ea6\u51fa\u73b0\u4e0d\u53ef\u9884\u77e5\u95ee\u9898\u3002 name \u6307\u5411\u4efb\u52a1\u540d\u5b57\u7b26\u4e32\u7684\u6307\u9488\u3002\u6ce8\u610f\uff1a\u540ctask\uff0c\u8be5\u6307\u9488\u6307\u5411\u7684\u5b57\u7b26\u4e32\u751f\u547d\u5468\u671f\u5e94\u8be5\u5927\u4e8e\u5f85\u521b\u5efa\u7684\u4efb\u52a1\u4f53\u751f\u547d\u5468\u671f\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u4f20\u5165\u5b57\u7b26\u4e32\u5e38\u91cf\u6307\u9488\u5373\u53ef\u3002 entry \u4efb\u52a1\u4f53\u8fd0\u884c\u7684\u51fd\u6570\u5165\u53e3\u3002\u5f53\u4efb\u52a1\u521b\u5efa\u5b8c\u6bd5\u8fdb\u5165\u8fd0\u884c\u72b6\u6001\u540e\uff0centry\u662f\u4efb\u52a1\u6267\u884c\u7684\u5165\u53e3\uff0c\u7528\u6237\u53ef\u4ee5\u5728\u6b64\u51fd\u6570\u4e2d\u7f16\u5199\u4e1a\u52a1\u903b\u8f91\u3002 arg \u4f20\u9012\u7ed9\u4efb\u52a1\u5165\u53e3\u51fd\u6570\u7684\u53c2\u6570\u3002 prio \u4efb\u52a1\u4f18\u5148\u7ea7\u3002prio\u7684\u6570\u503c\u8d8a\u5c0f\uff0c\u4f18\u5148\u7ea7\u8d8a\u9ad8\u3002\u7528\u6237\u53ef\u4ee5\u5728tos_config.h\u4e2d\uff0c\u901a\u8fc7TOS_CFG_TASK_PRIO_MAX\u6765\u914d\u7f6e\u4efb\u52a1\u4f18\u5148\u7ea7\u7684\u6700\u5927\u6570\u503c\uff0c\u5728\u5185\u6838\u7684\u5b9e\u73b0\u4e2d\uff0cidle\u4efb\u52a1\u7684\u4f18\u5148\u7ea7\u4f1a\u88ab\u5206\u914d\u4e3aTOS_CFG_TASK_PRIO_MAX - 1,\u6b64\u4f18\u5148\u7ea7\u53ea\u80fd\u88abidle\u4efb\u52a1\u4f7f\u7528\u3002\u56e0\u6b64\u5bf9\u4e8e\u4e00\u4e2a\u7528\u6237\u521b\u5efa\u7684\u4efb\u52a1\u6765\u8bf4\uff0c\u5408\u7406\u7684\u4f18\u5148\u7ea7\u8303\u56f4\u5e94\u8be5\u4e3a[0, TOS_CFG_TASK_PRIO_MAX - 2]\u3002\u53e6\u5916TOS_CFG_TASK_PRIO_MAX\u7684\u914d\u7f6e\u503c\u5fc5\u9700\u5927\u4e8e\u7b49\u4e8e8\u3002 stk_base \u4efb\u52a1\u5728\u8fd0\u884c\u65f6\u4f7f\u7528\u7684\u6808\u7a7a\u95f4\u7684\u8d77\u59cb\u5730\u5740\u3002\u6ce8\u610f\uff1a\u540ctask\uff0c\u8be5\u6307\u9488\u6307\u5411\u7684\u5185\u5b58\u7a7a\u95f4\u7684\u751f\u547d\u5468\u671f\u5e94\u8be5\u5927\u4e8e\u5f85\u521b\u5efa\u7684\u4efb\u52a1\u4f53\u751f\u547d\u5468\u671f\u3002stk_base\u662fk_stack_t\u7c7b\u578b\u7684\u6570\u7ec4\u8d77\u59cb\u5730\u5740\u3002 stk_size \u4efb\u52a1\u7684\u6808\u7a7a\u95f4\u5927\u5c0f\u3002\u6ce8\u610f\uff1a\u56e0\u4e3astk_base\u662fk_stack_t\u7c7b\u578b\u7684\u6570\u7ec4\u6307\u9488\uff0c\u56e0\u6b64\u5b9e\u9645\u6808\u7a7a\u95f4\u6240\u5360\u5185\u5b58\u5927\u5c0f\u4e3astk_size * sizeof(k_stack_t)\u3002 timeslice \u65f6\u95f4\u7247\u8f6e\u8f6c\u673a\u5236\u4e0b\u5f53\u524d\u4efb\u52a1\u7684\u65f6\u95f4\u7247\u5927\u5c0f\u3002\u5f53timeslice\u4e3a0\u65f6\uff0c\u4efb\u52a1\u8c03\u5ea6\u65f6\u95f4\u7247\u4f1a\u88ab\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u5927\u5c0f\uff08TOS_CFG_CPU_TICK_PER_SECOND / 10\uff09\uff0c\u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\uff08systick\uff09\u6570 / 10\u3002 \u7f16\u7a0b\u5b9e\u4f8b 1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u6700\u5927\u4efb\u52a1\u4f18\u5148\u7ea7TOS_CFG_TASK_PRIO_MAX\uff1a #define TOS_CFG_TASK_PRIO_MAX 10u 2\u3001\u914d\u7f6e\u6bcf\u79d2\u949f\u7684\u7cfb\u7edf\u6ef4\u7b54\u6570TOS_CFG_CPU_TICK_PER_SECOND\uff1a #define TOS_CFG_CPU_TICK_PER_SECOND 1000u 3\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" // \u6dfb\u52a0TencentOS tiny\u5185\u6838\u63a5\u53e3\u5934\u6587\u4ef6 #include \"mcu_init.h\" // \u5305\u542bmcu\u521d\u59cb\u5316\u5934\u6587\u4ef6\uff0c\u91cc\u9762\u6709board_init\u7b49\u677f\u7ea7\u542f\u52a8\u4ee3\u7801\u51fd\u6570\u539f\u578b\u58f0\u660e #define STK_SIZE_TASK_PRIO4 512 // \u4f18\u5148\u7ea7\u4e3a4\u7684\u4efb\u52a1\u6808\u5927\u5c0f\u4e3a512 #define STK_SIZE_TASK_PRIO5 1024 // \u4f18\u5148\u7ea7\u4e3a5\u7684\u4efb\u52a1\u6808\u5927\u5c0f\u4e3a1024 k_stack_t stack_task_prio4[STK_SIZE_TASK_PRIO4]; // \u4f18\u5148\u7ea7\u4e3a4\u7684\u4efb\u52a1\u6808\u7a7a\u95f4 k_stack_t stack_task_prio5[STK_SIZE_TASK_PRIO5]; // \u4f18\u5148\u7ea7\u4e3a5\u7684\u4efb\u52a1\u6808\u7a7a\u95f4 k_task_t task_prio4; // \u4f18\u5148\u7ea7\u4e3a4\u7684\u4efb\u52a1\u4f53 k_task_t task_prio5; // \u4f18\u5148\u7ea7\u4e3a5\u7684\u4efb\u52a1\u4f53 extern void entry_task_prio4(void *arg); // \u4f18\u5148\u7ea7\u4e3a4\u7684\u4efb\u52a1\u4f53\u5165\u53e3\u51fd\u6570 extern void entry_task_prio5(void *arg); // \u4f18\u5148\u7ea7\u4e3a5\u7684\u4efb\u52a1\u4f53\u5165\u53e3\u51fd\u6570 uint32_t arg_task_prio4_array[3] = { // \u4f18\u5148\u7ea7\u4e3a4\u7684\u4efb\u52a1\u4f53\u5165\u53e3\u51fd\u6570\u5165\u53c2 1, 2, 3, }; char *arg_task_prio5_string = \"arg for task_prio5\"; // \u4f18\u5148\u7ea7\u4e3a5\u7684\u4efb\u52a1\u4f53\u5165\u53e3\u51fd\u6570\u5165\u53c2 static void dump_uint32_array(uint32_t *array, size_t len) { size_t i = 0; for (i = 0; i < len; ++i) { printf(\"%d\\t\", array[i]); } printf(\"\\n\\n\"); } void entry_task_prio4(void *arg) { uint32_t *array_from_main = (uint32_t *)arg; // \u6355\u83b7\u8c03\u7528\u8005\u4f20\u5165\u7684\u53c2\u6570 printf(\"array from main:\\n\"); dump_uint32_array(array_from_main, 3); // dump\u4f20\u5165\u7684\u53c2\u6570\uff08\u6570\u7ec4\uff09 while (K_TRUE) { printf(\"task_prio4 body\\n\"); // \u4efb\u52a1\u8fd0\u884c\u4f53\uff0c\u4e0d\u65ad\u6253\u5370\u8fd9\u6761\u4fe1\u606f tos_task_delay(1000); // \u7761\u77201000\u4e2a\u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\uff08\u4ee5\u4e0b\u8bb0\u4f5csystick\uff09\uff0c\u56e0\u4e3aTOS_CFG_CPU_TICK_PER_SECOND\u4e3a1000\uff0c\u4e5f\u5c31\u662f\u4e00\u79d2\u949f\u4f1a\u67091000\u4e2asystick\uff0c\u56e0\u6b64\u7761\u77201000\u4e2asystick\u5c31\u662f\u7761\u7720\u4e861\u79d2\u3002 } } void entry_task_prio5(void *arg) { int i = 0; char *string_from_main = (char *)arg; printf(\"string from main:\\n\"); printf(\"%s\\n\\n\", string_from_main); // \u6253\u5370\u51fa\u8c03\u7528\u8005\u4f20\u5165\u7684\u5b57\u7b26\u4e32\u53c2\u6570 while (K_TRUE) { if (i == 2) { printf(\"i = %d\\n\", i); // i\u4e3a2\u65f6\uff0c\u6302\u8d77task_prio4\uff0ctask_prio4\u505c\u6b62\u8fd0\u884c tos_task_suspend(&task_prio4); } else if (i == 4) { printf(\"i = %d\\n\", i); // i\u4e3a4\u65f6\uff0c\u6062\u590dtask_prio4\u7684\u8fd0\u884c tos_task_resume(&task_prio4); } else if (i == 6) { printf(\"i = %d\\n\", i); // i\u4e3a6\u65f6\uff0c\u5220\u9664task_prio4\uff0ctask_prio4\u4e0d\u518d\u8fd0\u884c tos_task_destroy(&task_prio4); } printf(\"task_prio5 body\\n\"); tos_task_delay(1000); ++i; } } int main(void) { board_init(); // \u6267\u884c\u677f\u7ea7\u521d\u59cb\u5316\u4ee3\u7801\uff0c\u521d\u59cb\u5316\u4e32\u53e3\u7b49\u5916\u8bbe\u3002 tos_knl_init(); // \u521d\u59cb\u5316TencentOS tiny\u5185\u6838 // \u521b\u5efa\u4e00\u4e2a\u4f18\u5148\u7ea7\u4e3a4\u7684\u4efb\u52a1 (void)tos_task_create(&task_prio4, \"task_prio4\", entry_task_prio4, (void *)(&arg_task_prio4_array[0]), 4, stack_task_prio4, STK_SIZE_TASK_PRIO4, 0); // \u521b\u5efa\u4e00\u4e2a\u4f18\u5148\u7ea7\u4e3a5\u7684\u4efb\u52a1 (void)tos_task_create(&task_prio5, \"task_prio5\", entry_task_prio5, (void *)arg_task_prio5_string, 5, stack_task_prio5, STK_SIZE_TASK_PRIO5, 0); // \u5f00\u59cb\u5185\u6838\u8c03\u5ea6 tos_knl_start(); } \u8fd0\u884c\u6548\u679c array from main: 1 2 3 task_prio4 body string from main: arg for task_prio5 task_prio5 body task_prio4 body task_prio5 body task_prio4 body i = 2 task_prio5 body task_prio5 body i = 4 task_prio4 body task_prio5 body task_prio4 body task_prio5 body task_prio4 body i = 6 task_prio5 body task_prio5 body task_prio5 body task_prio5 body task_prio5 body task_prio5 body task_prio5 body \u5b9e\u4f8b\u4ee3\u7801 2.3 \u4efb\u52a1\u95f4\u901a\u4fe1 2.3.1 \u4e92\u65a5\u91cf \u6982\u8ff0 \u4e92\u65a5\u91cf\u53c8\u79f0\u4e92\u65a5\u9501\uff0c\u4e00\u822c\u7528\u4e8e\u5171\u4eab\u8d44\u6e90\u7684\u4e92\u65a5\u6392\u4ed6\u6027\u8bbf\u95ee\u4fdd\u62a4\u3002 \u4e92\u65a5\u91cf\u5728\u4efb\u610f\u65f6\u523b\u5904\u4e8e\u4e14\u4ec5\u4f1a\u5904\u4e8e\u89e3\u9501\u6216\u9501\u5b9a\u72b6\u6001\uff0c\u5f53\u4e00\u4e2a\u4efb\u52a1\u83b7\u53d6\u5230\u4e00\u628a\u9501\u540e\uff08\u4e92\u65a5\u91cf\u9501\u5b9a\uff09\uff0c\u5176\u4ed6\u4efb\u52a1\u518d\u5c1d\u8bd5\u83b7\u5f97\u8fd9\u628a\u9501\u65f6\u4f1a\u5931\u8d25\u6216\u8fdb\u5165\u963b\u585e\u72b6\u6001\uff0c\u5f53\u8be5\u4efb\u52a1\u91ca\u653e\u6301\u6709\u7684\u9501\u65f6\uff08\u4e92\u65a5\u91cf\u89e3\u9501\uff09\uff0c\u4f1a\u5524\u9192\u4e00\u4e2a\u6b63\u963b\u585e\u7b49\u5f85\u6b64\u4e92\u65a5\u91cf\u7684\u4efb\u52a1\uff0c\u88ab\u5524\u9192\u7684\u4efb\u52a1\u5c06\u4f1a\u83b7\u53d6\u8fd9\u628a\u9501\u3002 \u5728\u591a\u4efb\u52a1\u8fd0\u884c\u73af\u5883\u4e2d\uff0c\u6709\u4e9b\u5171\u4eab\u8d44\u6e90\u4e0d\u5177\u6709\u591a\u7ebf\u7a0b\u53ef\u91cd\u5165\u6027\uff0c\u5bf9\u4e8e\u8fd9\u7c7b\u4e0d\u5e0c\u671b\u88ab\u591a\u4efb\u52a1\u540c\u65f6\u8bbf\u95ee\u7684\u8d44\u6e90\uff08\u4e34\u754c\u8d44\u6e90\uff09\uff0c\u53ef\u4ee5\u91c7\u7528\u4e92\u65a5\u91cf\u6765\u8fdb\u884c\u4fdd\u62a4\uff0c\u540e\u9762\u7684\u7f16\u7a0b\u5b9e\u4f8b\u7ae0\u8282\u4f1a\u6f14\u793a\u8fd9\u4e00\u7f16\u7a0b\u8303\u5f0f\u3002 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b 1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u4e92\u65a5\u91cf\u7ec4\u4ef6\u5f00\u5173TOS_CFG_MUTEX_EN\uff1a #define TOS_CFG_MUTEX_EN 1u 2\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_WRITER 512 #define STK_SIZE_TASK_READER 512 k_stack_t stack_task_writer[STK_SIZE_TASK_WRITER]; k_stack_t stack_task_reader[STK_SIZE_TASK_READER]; k_task_t task_writer; k_task_t task_reader; extern void entry_task_writer(void *arg); extern void entry_task_reader(void *arg); k_mutex_t critical_resource_locker; // \u4e00\u7247\u4e34\u754c\u533a\u5185\u5b58 static uint32_t critical_resource[3]; static void write_critical_resource(int salt) { size_t i = 0; // \u6b64\u51fd\u6570\u6bcf\u6b21\u5411\u5171\u4eab\u5185\u5b58\u4e2d\u6309\u9012\u589e\u987a\u5e8f\u5199\u5165\u4e09\u4e2a\u65e0\u7b26\u53f7\u6574\u6570 printf(\"writting critical resource:\\n\"); for (i = 0; i < 3; ++i) { printf(\"%d\\t\", salt + i); critical_resource[i] = salt + i; } printf(\"\\n\"); } void entry_task_writer(void *arg) { size_t salt = 0; k_err_t err; while (K_TRUE) { // \u5728\u5411\u4e34\u754c\u533a\u5199\u5165\u6570\u636e\u4e4b\u524d\uff0c\u5148\u5c1d\u8bd5\u83b7\u53d6\u4e34\u754c\u533a\u4fdd\u62a4\u9501 err = tos_mutex_pend(&critical_resource_locker); if (err == K_ERR_NONE) { // \u6210\u529f\u83b7\u53d6\u9501\u4e4b\u540e\uff0c\u5411\u4e34\u754c\u533a\u5199\u5165\u6570\u636e write_critical_resource(salt); // \u5199\u5b8c\u6570\u636e\u540e\uff0c\u91ca\u653e\u4e92\u65a5\u9501 tos_mutex_post(&critical_resource_locker); } tos_task_delay(1000); ++salt; } } static void read_critical_resource(void) { size_t i = 0; // \u4ece\u4e34\u754c\u533a\u8bfb\u53d6\u6570\u636e printf(\"reading critical resource:\\n\"); for (i = 0; i < 3; ++i) { printf(\"%d\\t\", critical_resource[i]); } printf(\"\\n\"); } void entry_task_reader(void *arg) { k_err_t err; while (K_TRUE) { // \u8bfb\u53d6\u4e34\u754c\u533a\u6570\u636e\u4e4b\u524d\uff0c\u5148\u5c1d\u8bd5\u83b7\u53d6\u4e34\u754c\u533a\u4fdd\u62a4\u9501 err = tos_mutex_pend(&critical_resource_locker); if (err == K_ERR_NONE) { // \u6210\u529f\u83b7\u53d6\u9501\u4e4b\u540e\uff0c\u4ece\u4e34\u754c\u533a\u8bfb\u53d6\u6570\u636e read_critical_resource(); // \u8bfb\u53d6\u6570\u636e\u5b8c\u6bd5\u540e\uff0c\u91ca\u653e\u4e92\u65a5\u9501 tos_mutex_post(&critical_resource_locker); } tos_task_delay(1000); } } int main(void) { board_init(); tos_knl_init(); // \u521b\u5efa\u4e34\u754c\u533a\u4fdd\u62a4\u4e92\u65a5\u9501 tos_mutex_create(&critical_resource_locker); (void)tos_task_create(&task_writer, \"writer\", entry_task_writer, NULL, 4, stack_task_writer, STK_SIZE_TASK_WRITER, 0); (void)tos_task_create(&task_reader, \"reader\", entry_task_reader, NULL, 4, stack_task_reader, STK_SIZE_TASK_READER, 0); tos_knl_start(); } \u8fd0\u884c\u6548\u679c writting critical resource: 0 1 2 reading critical resource: 0 1 2 writting critical resource: 1 2 3 reading critical resource: 1 2 3 writting critical resource: 2 3 4 reading critical resource: 2 3 4 writting critical resource: 3 4 5 reading critical resource: 3 4 5 writting critical resource: 4 5 6 reading critical resource: 4 5 6 writting critical resource: 5 6 7 reading critical resource: 5 6 7 writting critical resource: 6 7 8 reading critical resource: 6 7 8 writting critical resource: 7 8 9 reading critical resource: 7 8 9 \u5b9e\u4f8b\u4ee3\u7801 2.3.2 \u4fe1\u53f7\u91cf \u6982\u8ff0 \u4fe1\u53f7\u91cf\u662f\u4e00\u79cd\u5b9e\u73b0\u4efb\u52a1\u95f4\u540c\u6b65\u7684\u673a\u5236\uff0c\u4e00\u822c\u7528\u4e8e\u591a\u4e2a\u4efb\u52a1\u95f4\u6709\u9650\u8d44\u6e90\u7ade\u4e89\u8bbf\u95ee\u3002 \u901a\u5e38\u6765\u8bf4\uff0c\u4e00\u4e2a\u4fe1\u53f7\u91cf\u4e2d\u6301\u6709\u4e00\u4e2a\u6574\u5f62\u6570\u503c\uff0c\u7528\u4ee5\u8868\u793a\u53ef\u7528\u8d44\u6e90\u7684\u6570\u91cf\u3002\u5f53\u4e00\u4e2a\u4fe1\u53f7\u91cf\u7684\u53ef\u7528\u8d44\u6e90\u6570\u91cf\u5927\u4e8e0\u65f6\uff0c\u4efb\u52a1\u5c1d\u8bd5\u83b7\u53d6\u8be5\u4fe1\u53f7\u91cf\u6210\u529f\uff0c\u4fe1\u53f7\u91cf\u7684\u53ef\u7528\u8d44\u6e90\u6570\u51cf\u4e00\uff1b\u5f53\u4e00\u4e2a\u4fe1\u53f7\u91cf\u7684\u53ef\u7528\u8d44\u6e90\u6570\u7b49\u4e8e0\u65f6\uff0c\u4efb\u52a1\u5c1d\u8bd5\u83b7\u53d6\u8be5\u4fe1\u53f7\u91cf\u5931\u8d25\u6216\u8fdb\u5165\u963b\u585e\u72b6\u6001\u3002\u4fe1\u53f7\u91cf\u7684\u8fd9\u4e00\u6a21\u5f0f\uff0c\u5f53\u53ef\u7528\u8d44\u6e90\u6570\u4e3a1\u65f6\uff0c\u53ef\u5c06\u5176\u7528\u4e8e\u8d44\u6e90\u7684\u4e92\u65a5\u8bbf\u95ee\uff1b\u6216\u8005\u89e3\u51b3\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u95ee\u9898\u4e2d\u7684\u8d44\u6e90\u751f\u4ea7-\u6d88\u8d39\u95ee\u9898\u3002\u7f16\u7a0b\u5b9e\u4f8b\u7ae0\u8282\u4f1a\u6f14\u793a\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u95ee\u9898\u7684\u89e3\u51b3\u8303\u5f0f\u3002 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b 1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u4fe1\u53f7\u91cf\u7ec4\u4ef6\u5f00\u5173TOS_CFG_SEM_EN\uff1a #define TOS_CFG_SEM_EN 1u 2\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_PRODUCER 512 #define STK_SIZE_TASK_CONSUMER 512 k_stack_t stack_task_producer[STK_SIZE_TASK_PRODUCER]; k_stack_t stack_task_consumer[STK_SIZE_TASK_CONSUMER]; k_task_t task_producer; k_task_t task_consumer; extern void entry_task_producer(void *arg); extern void entry_task_consumer(void *arg); k_mutex_t buffer_locker; k_sem_t full; k_sem_t empty; #define RESOURCE_COUNT_MAX 3 struct resource_st { int cursor; uint32_t buffer[RESOURCE_COUNT_MAX]; } resource = { 0, {0} }; static void produce_item(int salt) { printf(\"produce item:\\n\"); printf(\"%d\", salt); resource.buffer[resource.cursor++] = salt; printf(\"\\n\"); } void entry_task_producer(void *arg) { size_t salt = 0; k_err_t err; while (K_TRUE) { err = tos_sem_pend(&empty, TOS_TIME_FOREVER); if (err != K_ERR_NONE) { continue; } err = tos_mutex_pend(&buffer_locker); if (err != K_ERR_NONE) { continue; } produce_item(salt); tos_mutex_post(&buffer_locker); tos_sem_post(&full); tos_task_delay(1000); ++salt; } } static void consume_item(void) { printf(\"cosume item:\\n\"); printf(\"%d\\t\", resource.buffer[--resource.cursor]); printf(\"\\n\"); } void entry_task_consumer(void *arg) { k_err_t err; while (K_TRUE) { err = tos_sem_pend(&full, TOS_TIME_FOREVER); if (err != K_ERR_NONE) { continue; } tos_mutex_pend(&buffer_locker); if (err != K_ERR_NONE) { continue; } consume_item(); tos_mutex_post(&buffer_locker); tos_sem_post(&empty); tos_task_delay(2000); } } int main(void) { board_init(); tos_knl_init(); tos_mutex_create(&buffer_locker); tos_sem_create(&full, 0); tos_sem_create(&empty, RESOURCE_COUNT_MAX); (void)tos_task_create(&task_producer, \"producer\", entry_task_producer, NULL, 4, stack_task_producer, STK_SIZE_TASK_PRODUCER, 0); (void)tos_task_create(&task_consumer, \"consumer\", entry_task_consumer, NULL, 4, stack_task_consumer, STK_SIZE_TASK_CONSUMER, 0); tos_knl_start(); } \u8fd0\u884c\u6548\u679c produce iterm: 0 cosume iterm: 0 produce iterm: 1 produce iterm: 2 cosume iterm: 2 produce iterm: 3 produce iterm: 4 cosume iterm: 4 produce iterm: 5 cosume iterm: 5 produce iterm: 6 cosume iterm: 6 produce iterm: 7 cosume iterm: 7 produce iterm: 8 cosume iterm: 8 produce iterm: 9 cosume iterm: 9 produce iterm: 10 \u5b9e\u4f8b\u4ee3\u7801 2.3.3 \u4e8b\u4ef6 \u6982\u8ff0 \u4e8b\u4ef6\u63d0\u4f9b\u4e86\u4e00\u79cd\u4efb\u52a1\u95f4\u5b9e\u73b0\u540c\u6b65\u548c\u4fe1\u606f\u4f20\u9012\u7684\u673a\u5236\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u4e00\u4e2a\u4e8b\u4ef6\u4e2d\u5305\u542b\u4e86\u4e00\u4e2a\u65d7\u6807\uff0c\u8fd9\u4e2a\u65d7\u6807\u7684\u6bcf\u4e00\u4f4d\u8868\u793a\u4e00\u4e2a\u201c\u4e8b\u4ef6\u201d\u3002 \u4e00\u4e2a\u4efb\u52a1\u53ef\u4ee5\u7b49\u5f85\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u201c\u4e8b\u4ef6\u201d\u7684\u53d1\u751f\uff0c\u5176\u4ed6\u4efb\u52a1\u5728\u4e00\u5b9a\u7684\u4e1a\u52a1\u6761\u4ef6\u4e0b\u53ef\u4ee5\u901a\u8fc7\u5199\u5165\u7279\u5b9a\u201c\u4e8b\u4ef6\u201d\u5524\u9192\u7b49\u5f85\u6b64\u201c\u4e8b\u4ef6\u201d\u7684\u4efb\u52a1\uff0c\u5b9e\u73b0\u4e00\u79cd\u7c7b\u4f3c\u4fe1\u53f7\u7684\u7f16\u7a0b\u8303\u5f0f\u3002 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b 1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u4e8b\u4ef6\u7ec4\u4ef6\u5f00\u5173TOS_CFG_EVENT_EN\uff1a #define TOS_CFG_EVENT_EN 1u 2\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_LISTENER 512 #define STK_SIZE_TASK_TRIGGER 512 k_stack_t stack_task_listener1[STK_SIZE_TASK_LISTENER]; k_stack_t stack_task_listener2[STK_SIZE_TASK_LISTENER]; k_stack_t stack_task_trigger[STK_SIZE_TASK_TRIGGER]; k_task_t task_listener1; k_task_t task_listener2; k_task_t task_trigger; extern void entry_task_listener1(void *arg); extern void entry_task_listener2(void *arg); extern void entry_task_trigger(void *arg); const k_event_flag_t event_eeny = (k_event_flag_t)(1 << 0); const k_event_flag_t event_meeny = (k_event_flag_t)(1 << 1); const k_event_flag_t event_miny = (k_event_flag_t)(1 << 2); const k_event_flag_t event_moe = (k_event_flag_t)(1 << 3); k_event_t event; void entry_task_listener1(void *arg) { k_event_flag_t flag_match; k_err_t err; while (K_TRUE) { // \u6b64\u4efb\u52a1\u76d1\u542c\u56db\u4e2a\u4e8b\u4ef6\uff0c\u56e0\u4e3a\u4f7f\u7528\u4e86TOS_OPT_EVENT_PEND_ALL\u9009\u9879\uff0c\u56e0\u6b64\u5fc5\u987b\u662f\u56db\u4e2a\u4e8b\u4ef6\u540c\u65f6\u5230\u8fbe\u6b64\u4efb\u52a1\u624d\u4f1a\u88ab\u5524\u9192 err = tos_event_pend(&event, event_eeny | event_meeny | event_miny | event_moe, &flag_match, TOS_TIME_FOREVER, TOS_OPT_EVENT_PEND_ALL | TOS_OPT_EVENT_PEND_CLR); if (err == K_ERR_NONE) { printf(\"entry_task_listener1:\\n\"); printf(\"eeny, meeny, miny, moe, they all come\\n\"); } } } void entry_task_listener2(void *arg) { k_event_flag_t flag_match; k_err_t err; while (K_TRUE) { // \u6b64\u4efb\u52a1\u76d1\u542c\u56db\u4e2a\u4e8b\u4ef6\uff0c\u56e0\u4e3a\u4f7f\u7528\u4e86TOS_OPT_EVENT_PEND_ANY\u9009\u9879\uff0c\u56e0\u6b64\u56db\u4e2a\u4e8b\u4ef6\u4efb\u610f\u4e00\u4e2a\u5230\u8fbe\uff08\u5305\u62ec\u56db\u4e2a\u4e8b\u4ef6\u540c\u65f6\u5230\u8fbe\uff09\u4efb\u52a1\u5c31\u4f1a\u88ab\u5524\u9192 err = tos_event_pend(&event, event_eeny | event_meeny | event_miny | event_moe, &flag_match, TOS_TIME_FOREVER, TOS_OPT_EVENT_PEND_ANY | TOS_OPT_EVENT_PEND_CLR); if (err == K_ERR_NONE) { printf(\"entry_task_listener2:\\n\"); // \u6709\u4e8b\u4ef6\u5230\u8fbe\uff0c\u5224\u65ad\u5177\u4f53\u662f\u54ea\u4e2a\u4e8b\u4ef6 if (flag_match == event_eeny) { printf(\"eeny comes\\n\"); } if (flag_match == event_meeny) { printf(\"meeny comes\\n\"); } if (flag_match == event_miny) { printf(\"miny comes\\n\"); } if (flag_match == event_moe) { printf(\"moe comes\\n\"); } if (flag_match == (event_eeny | event_meeny | event_miny | event_moe)) { printf(\"all come\\n\"); } } } } void entry_task_trigger(void *arg) { int i = 1; while (K_TRUE) { if (i == 2) { printf(\"entry_task_trigger:\\n\"); printf(\"eeny will come\\n\"); // \u53d1\u9001eeny\u4e8b\u4ef6\uff0ctask_listener2\u4f1a\u88ab\u5524\u9192 tos_event_post(&event, event_eeny); } if (i == 3) { printf(\"entry_task_trigger:\\n\"); printf(\"meeny will come\\n\"); // \u53d1\u9001eeny\u4e8b\u4ef6\uff0ctask_listener2\u4f1a\u88ab\u5524\u9192 tos_event_post(&event, event_meeny); } if (i == 4) { printf(\"entry_task_trigger:\\n\"); printf(\"miny will come\\n\"); // \u53d1\u9001eeny\u4e8b\u4ef6\uff0ctask_listener2\u4f1a\u88ab\u5524\u9192 tos_event_post(&event, event_miny); } if (i == 5) { printf(\"entry_task_trigger:\\n\"); printf(\"moe will come\\n\"); // \u53d1\u9001eeny\u4e8b\u4ef6\uff0ctask_listener2\u4f1a\u88ab\u5524\u9192 tos_event_post(&event, event_moe); } if (i == 6) { printf(\"entry_task_trigger:\\n\"); printf(\"all will come\\n\"); // \u540c\u65f6\u53d1\u9001\u56db\u4e2a\u4e8b\u4ef6\uff0c\u56e0\u4e3atask_listener1\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8etask_listener2\uff0c\u56e0\u6b64\u8fd9\u91cctask_listener1\u4f1a\u88ab\u5524\u9192 tos_event_post(&event, event_eeny | event_meeny | event_miny | event_moe); } tos_task_delay(1000); ++i; } } int main(void) { board_init(); tos_knl_init(); tos_event_create(&event, (k_event_flag_t)0u); // \u8fd9\u91cctask_listener1\u7684\u4f18\u5148\u7ea7\u6bd4task_listener2\u9ad8\uff0c\u56e0\u6b64\u5728task_trigger\u53d1\u9001\u6240\u6709\u4e8b\u4ef6\u65f6\uff0ctask_listener1\u4f1a\u88ab\u5524\u9192 // \u8bfb\u8005\u53ef\u4ee5\u5c1d\u8bd5\u5c06task_listener1\u4f18\u5148\u7ea7\u4fee\u6539\u4e3a5\uff08\u6bd4task_listener2\u4f4e\uff09\uff0c\u6b64\u8bbe\u7f6e\u4e0b\uff0c\u5728task_trigger\u53d1\u9001\u6240\u6709\u4e8b\u4ef6\u65f6\uff0ctask_listener2\u5c06\u4f1a\u88ab\u5524\u9192\u3002 (void)tos_task_create(&task_listener1, \"listener1\", entry_task_listener1, NULL, 3, stack_task_listener1, STK_SIZE_TASK_LISTENER, 0); (void)tos_task_create(&task_listener2, \"listener2\", entry_task_listener2, NULL, 4, stack_task_listener2, STK_SIZE_TASK_LISTENER, 0); (void)tos_task_create(&task_trigger, \"trigger\", entry_task_trigger, NULL, 4, stack_task_trigger, STK_SIZE_TASK_TRIGGER, 0); tos_knl_start(); } \u8fd0\u884c\u6548\u679c entry_task_trigger: eeny will come entry_task_listener2: eeny comes entry_task_trigger: meeny will come entry_task_listener2: meeny comes entry_task_trigger: miny will come entry_task_listener2: miny comes entry_task_trigger: moe will come entry_task_listener2: moe comes entry_task_trigger: all will come entry_task_listener1: eeny, meeny, miny, moe, they all come \u5b9e\u4f8b\u4ee3\u7801 2.3.4 \u5b8c\u6210\u91cf \u6982\u8ff0 \u5b8c\u6210\u91cf\u662f\u4e00\u79cd\u7b80\u5355\u7684\u4efb\u52a1\u95f4\u901a\u4fe1\u673a\u5236\uff0c\u7528\u4ee5\u5728\u4efb\u52a1\u95f4\u540c\u6b65\u67d0\u4e00\u4e8b\u4ef6\u662f\u5426\u5df2\u201c\u5b8c\u6210\u201d\u7684\u4fe1\u606f\u3002 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b 1\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a /* \u8fd9\u4e2a\u4f8b\u5b50\u91cc\u521b\u5efa\u4e86\u4e24\u4e2a\u4efb\u52a1\uff0c\u4e00\u4e2a\u4efb\u52a1task_wait\u7b49\u5f85\u5b8c\u6210\u91cf\u5b8c\u6210\uff0c\u53e6\u4e00\u4e2a\u4efb\u52a1\u8d1f\u8d23\u89e6\u53d1\u5b8c\u6210\u91cf\uff08\u8ba9\u5b8c\u6210\u91cf\u5b8c\u6210\uff09 */ #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_WAIT 512 #define STK_SIZE_TASK_TRIGGER 512 k_stack_t stack_task_wait[STK_SIZE_TASK_WAIT]; k_stack_t stack_task_trigger[STK_SIZE_TASK_TRIGGER]; k_task_t task_wait; k_task_t task_trigger; k_completion_t completion; void entry_task_wait(void *arg) { printf(\"wait: I won't go further until someone do the trigger(make it 'complete')\\n\"); tos_completion_pend(&completion); printf(\"wait: someone has made it complete, so I'm here\\n\"); } void entry_task_trigger(void *arg) { printf(\"trigger: I'm the one who make complete, anyone waitting for the complete won't go further until I do the trigger\\n\"); tos_completion_post(&completion); printf(\"trigger: I have done the completion\\n\"); } int main(void) { board_init(); tos_knl_init(); tos_completion_create(&completion); (void)tos_task_create(&task_wait, \"wait\", entry_task_wait, NULL, 3, stack_task_wait, STK_SIZE_TASK_WAIT, 0); (void)tos_task_create(&task_trigger, \"trigger\", entry_task_trigger, NULL, 4, stack_task_trigger, STK_SIZE_TASK_TRIGGER, 0); tos_knl_start(); } \u8fd0\u884c\u6548\u679c wait: I won't go further until someone do the trigger(make it 'complete') trigger: I'm the one who make complete, anyone waitting for the complete won't go further until I do the trigger wait: someone make it complete, so I'm here trigger: I have done the completion \u5b9e\u4f8b\u4ee3\u7801 2.3.5 \u8ba1\u6570\u9501 \u6982\u8ff0 \u8ba1\u6570\u9501\u63d0\u4f9b\u4e86\u4e00\u79cd\u201c\u8ba1\u6570\u4fe1\u606f\u201d\u540c\u6b65\u7684\u6982\u5ff5\uff0c\u8ba1\u6570\u9501\u521b\u5efa\u7684\u65f6\u5019\u4f1a\u6307\u5b9a\u4e00\u4e2a\u8ba1\u6570\u503c\uff0c\u6bcf\u5f53\u6709\u4efb\u52a1\u6267\u884ctos_countdownlatch_post\u65f6\uff0c\u8be5\u8ba1\u6570\u9501\u7684\u8ba1\u6570\u503c\u51cf\u4e00\uff0c\u76f4\u5230\u8ba1\u6570\u9501\u7684\u8ba1\u6570\u503c\u4e3a\u96f6\u65f6\uff0c\u7b49\u5f85\u6b64\u8ba1\u6570\u9501\u7684\u4efb\u52a1\u624d\u4f1a\u88ab\u5524\u9192\u3002 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b 1\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a /* \u5047\u8bbe\u6709\u8fd9\u6837\u7684\u4e1a\u52a1\u573a\u666f\uff0c\u5171\u6709\u4e09\u4e2a\u52c7\u58eb\uff0c\u6b64\u4e09\u4e2a\u52c7\u58eb\u5206\u5934\u53bb\u5bfb\u627e\u4e09\u4e2a\u6b66\u5668\u7684\u788e\u7247\uff0c\u53ea\u6709\u8fd9\u4e09\u4e2a\u52c7\u58eb\u90fd\u627e\u5230\u788e\u7247\u540e\uff0c\u6cd5\u5e08\u624d\u80fd\u5c06\u4e09\u4e2a\u788e\u7247\u5408\u6210\u4e3a\u6b66\u5668\u3002\u7528\u4ee3\u7801\u770b\u5177\u4f53\u5982\u4f55\u4f7f\u7528\u8ba1\u6570\u9501\u6765\u5b8c\u6210\u8fd9\u4e2a\u6a21\u578b\u3002 */ #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_WIZARD 512 #define STK_SIZE_TASK_WARRIOR 512 k_stack_t stack_task_wizard[STK_SIZE_TASK_WIZARD]; k_stack_t stack_task_warrior_0[STK_SIZE_TASK_WARRIOR]; k_stack_t stack_task_warrior_1[STK_SIZE_TASK_WARRIOR]; k_stack_t stack_task_warrior_2[STK_SIZE_TASK_WARRIOR]; k_task_t task_wizard; k_task_t task_warrior_0; k_task_t task_warrior_1; k_task_t task_warrior_2; k_countdownlatch_t countdownlatch; void entry_task_warrior_0(void *arg) { printf(\"warrior 0: I have done my job\\n\"); tos_countdownlatch_post(&countdownlatch); } void entry_task_warrior_1(void *arg) { printf(\"warrior 1: I have done my job\\n\"); tos_countdownlatch_post(&countdownlatch); } void entry_task_warrior_2(void *arg) { printf(\"warrior 2: I have done my job\\n\"); tos_countdownlatch_post(&countdownlatch); } void entry_task_wizard(void *arg) { printf(\"wizard: I will set 3 warriors to find the fragments\\n\"); tos_countdownlatch_create(&countdownlatch, 3); (void)tos_task_create(&task_warrior_0, \"warrior_0\", entry_task_warrior_0, NULL, 4, stack_task_warrior_0, STK_SIZE_TASK_WARRIOR, 0); (void)tos_task_create(&task_warrior_1, \"warrior_1\", entry_task_warrior_1, NULL, 4, stack_task_warrior_1, STK_SIZE_TASK_WARRIOR, 0); (void)tos_task_create(&task_warrior_2, \"warrior_2\", entry_task_warrior_2, NULL, 4, stack_task_warrior_2, STK_SIZE_TASK_WARRIOR, 0); printf(\"wizard: now warriors are on their way, I will wait here until they all done the job\\n\"); tos_countdownlatch_pend(&countdownlatch); printf(\"wizard: the warriors all have done their jobs, let's make the weapon\\n\"); } int main(void) { board_init(); tos_knl_init(); (void)tos_task_create(&task_wizard, \"wizard\", entry_task_wizard, NULL, 3, stack_task_wizard, STK_SIZE_TASK_WIZARD, 0); tos_knl_start(); } \u8fd0\u884c\u6548\u679c wizard: I will set 3 warriors to find the fragments wizard: now warriors are on their way, I will wait here until they all done the job warrior 0: I have done my job warrior 1: I have done my job warrior 2: I have done my job wizard: the warriors all have done their jobs, let's make the weapon \u5b9e\u4f8b\u4ee3\u7801 2.3.6 \u6805\u680f \u6982\u8ff0 \u6805\u680f\u63d0\u4f9b\u4e86\u4e00\u79cd\u8bbe\u7f6e\u4efb\u52a1\u963b\u585e\u5c4f\u969c\u7684\u673a\u5236\uff0c\u6805\u680f\u521b\u5efa\u7684\u65f6\u5019\u4f1a\u6307\u5b9a\u4e00\u4e2a\u8ba1\u6570\u503c\uff0c\u6bcf\u5f53\u6709\u4efb\u52a1\u6267\u884ctos_barrier_pend\u65f6\uff0c\u8be5\u8ba1\u6570\u9501\u7684\u8ba1\u6570\u503c\u51cf\u4e00\uff0c\u76f4\u5230\u8ba1\u6570\u9501\u7684\u8ba1\u6570\u503c\u4e3a\u96f6\u65f6\uff0c\u6240\u6709\u963b\u585e\u5728tos_barrier_pend\u70b9\u4e0a\u7684\u4efb\u52a1\u624d\u53ef\u4ee5\u5f80\u4e0b\u8fd0\u884c\u3002 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b 1\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a /* \u5047\u8bbe\u6709\u8fd9\u6837\u7684\u4e1a\u52a1\u573a\u666f\uff0c\u5171\u6709\u4e09\u4e2a\u52c7\u58eb\uff0c\u6b64\u4e09\u4e2a\u52c7\u58eb\u5206\u5934\u53bb\u5bfb\u627e\u4e09\u4e2a\u6b66\u5668\u7684\u788e\u7247\uff0c\u4efb\u610f\u52c7\u58eb\u627e\u5230\u81ea\u5df1\u7684\u90a3\u5757\u6b66\u5668\u788e\u7247\u65f6\uff0c\u90fd\u5728\u539f\u5730\u7b49\u5f85\uff0c\u76f4\u5230\u6240\u6709\u7684\u5c0f\u4f19\u4f34\u90fd\u627e\u5230\u4e86\u81ea\u5df1\u7684\u6b66\u5668\u788e\u7247\u540e\uff0c\u624d\u5404\u81ea\u91c7\u53d6\u4e0b\u4e00\u6b65\u884c\u52a8\u3002\u7528\u4ee3\u7801\u770b\u5177\u4f53\u5982\u4f55\u4f7f\u7528\u6805\u680f\u6765\u5b8c\u6210\u8fd9\u4e2a\u6a21\u578b\u3002 */ #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_WARRIOR 512 k_stack_t stack_task_warrior_0[STK_SIZE_TASK_WARRIOR]; k_stack_t stack_task_warrior_1[STK_SIZE_TASK_WARRIOR]; k_stack_t stack_task_warrior_2[STK_SIZE_TASK_WARRIOR]; k_task_t task_warrior_0; k_task_t task_warrior_1; k_task_t task_warrior_2; k_barrier_t barrier; void entry_task_warrior_0(void *arg) { printf(\"warrior 0: I'm searching the fragment\\n\"); tos_task_delay(1000); printf(\"warrior 0: I have done my job, waitting other buddies done their job\\n\"); tos_barrier_pend(&barrier); printf(\"warrior 0: all buddies find their fragment, do my next job\\n\"); } void entry_task_warrior_1(void *arg) { printf(\"warrior 1: I'm searching the fragment\\n\"); tos_task_delay(1500); printf(\"warrior 1: I have done my job, waitting other buddies done their job\\n\"); tos_barrier_pend(&barrier); printf(\"warrior 1: all buddies find their fragment, do my next job\\n\"); } void entry_task_warrior_2(void *arg) { printf(\"warrior 2: I'm searching the fragment\\n\"); tos_task_delay(2000); printf(\"warrior 2: I have done my job, waitting other buddies done their job\\n\"); tos_barrier_pend(&barrier); printf(\"warrior 2: all buddies find their fragment, do my next job\\n\"); } int main(void) { board_init(); tos_knl_init(); tos_barrier_create(&barrier, 3); (void)tos_task_create(&task_warrior_0, \"warrior_0\", entry_task_warrior_0, NULL, 4, stack_task_warrior_0, STK_SIZE_TASK_WARRIOR, 0); (void)tos_task_create(&task_warrior_1, \"warrior_1\", entry_task_warrior_1, NULL, 4, stack_task_warrior_1, STK_SIZE_TASK_WARRIOR, 0); (void)tos_task_create(&task_warrior_2, \"warrior_2\", entry_task_warrior_2, NULL, 4, stack_task_warrior_2, STK_SIZE_TASK_WARRIOR, 0); tos_knl_start(); } \u8fd0\u884c\u6548\u679c warrior 0: I'm searching the fragment warrior 1: I'm searching the fragment warrior 2: I'm searching the fragment warrior 0: I have done my job, waitting other buddies done their job warrior 1: I have done my job, waitting other buddies done their job warrior 2: I have done my job, waitting other buddies done their job warrior 2: all buddies find their fragment, do my next job warrior 0: all buddies find their fragment, do my next job warrior 1: all buddies find their fragment, do my next job \u5b9e\u4f8b\u4ee3\u7801 2.3.7 \u6d88\u606f\u961f\u5217 \u6982\u8ff0 \u6d88\u606f\u961f\u5217\u63d0\u4f9b\u4e86\u4efb\u52a1\u95f4\u4f20\u9012\u6307\u9488\u6570\u636e\u7684\u673a\u5236\uff0c\u6240\u8c13\u7684\u201c\u6d88\u606f\u201c\u5c31\u662f\u6307\u9488\u3002\u6d88\u606f\u672c\u8eab\u5982\u4f55\u89e3\u6790\u4f7f\u7528\uff0c\u7531\u4f20\u9012\u6d88\u606f\u7684\u4e24\u4e2a\u4efb\u52a1\u81ea\u884c\u89c4\u5b9a\uff0c\u6d88\u606f\u961f\u5217\u4e0d\u5bf9\u6d88\u606f\u672c\u8eab\u505a\u4efb\u4f55\u89c4\u5b9a\u548c\u9650\u5236\uff0c\u6d88\u606f\u961f\u5217\u4ec5\u627f\u62c5\u6307\u9488\u6570\u636e\u7684\u4f20\u9012\u4e49\u52a1\u3002 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b 1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u6d88\u606f\u961f\u5217\u7ec4\u4ef6\u5f00\u5173TOS_CFG_MESSAGE_QUEUE_EN\uff1a #define TOS_CFG_MESSAGE_QUEUE_EN 1u 2\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a /* \u8fd9\u91cc\u6f14\u793a\u5982\u4f55\u4f7f\u7528\u6d88\u606f\u961f\u5217\u5728sender\u548creceiver\u4efb\u52a1\u4e4b\u95f4\u4f20\u9012\u6d88\u606f\uff08\u4e00\u4e2a\u6307\u9488\uff0c\u6b64\u6848\u4f8b\u4e2d\u8fd9\u4e2a\u6307\u9488\u4fe1\u606f\u6307\u5411\u7684\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff09 */ #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_RECEIVER 512 #define STK_SIZE_TASK_SENDER 512 #define PRIO_TASK_RECEIVER_HIGHER_PRIO 4 #define PRIO_TASK_RECEIVER_LOWER_PRIO (PRIO_TASK_RECEIVER_HIGHER_PRIO + 1) #define MESSAGE_MAX 10 k_stack_t stack_task_receiver_higher_prio[STK_SIZE_TASK_RECEIVER]; k_stack_t stack_task_receiver_lower_prio[STK_SIZE_TASK_RECEIVER]; k_stack_t stack_task_sender[STK_SIZE_TASK_SENDER]; uint8_t msg_pool[MESSAGE_MAX * sizeof(void *)]; k_task_t task_receiver_higher_prio; k_task_t task_receiver_lower_prio; k_task_t task_sender; k_msg_q_t msg_q; extern void entry_task_receiver_higher_prio(void *arg); extern void entry_task_receiver_lower_prio(void *arg); extern void entry_task_sender(void *arg); void entry_task_receiver_higher_prio(void *arg) { k_err_t err; void *msg_received; while (K_TRUE) { err = tos_msg_q_pend(&msg_q, &msg_received, TOS_TIME_FOREVER); if (err == K_ERR_NONE) { printf(\"higher: msg incoming[%s]\\n\", (char *)msg_received); } } } void entry_task_receiver_lower_prio(void *arg) { k_err_t err; void *msg_received; while (K_TRUE) { err = tos_msg_q_pend(&msg_q, &msg_received, TOS_TIME_FOREVER); if (err == K_ERR_NONE) { printf(\"lower: msg incoming[%s]\\n\", (char *)msg_received); } } } void entry_task_sender(void *arg) { int i = 1; char *msg_to_one_receiver = \"message for one receiver(with highest priority)\"; char *msg_to_all_receiver = \"message for all receivers\"; while (K_TRUE) { if (i == 2) { printf(\"sender: send a message to one receiver, and shoud be the highest priority one\\n\"); tos_msg_q_post(&msg_q, msg_to_one_receiver); } if (i == 3) { printf(\"sender: send a message to all recevier\\n\"); tos_msg_q_post_all(&msg_q, msg_to_all_receiver); } if (i == 4) { printf(\"sender: send a message to one receiver, and shoud be the highest priority one\\n\"); tos_msg_q_post(&msg_q, msg_to_one_receiver); } if (i == 5) { printf(\"sender: send a message to all recevier\\n\"); tos_msg_q_post_all(&msg_q, msg_to_all_receiver); } tos_task_delay(1000); ++i; } } int main(void) { board_init(); tos_knl_init(); tos_msg_q_create(&msg_q, msg_pool, MESSAGE_MAX); (void)tos_task_create(&task_receiver_higher_prio, \"receiver_higher_prio\", entry_task_receiver_higher_prio, NULL, PRIO_TASK_RECEIVER_HIGHER_PRIO, stack_task_receiver_higher_prio, STK_SIZE_TASK_RECEIVER, 0); (void)tos_task_create(&task_receiver_lower_prio, \"receiver_lower_prio\", entry_task_receiver_lower_prio, NULL, PRIO_TASK_RECEIVER_LOWER_PRIO, stack_task_receiver_lower_prio, STK_SIZE_TASK_RECEIVER, 0); (void)tos_task_create(&task_sender, \"sender\", entry_task_sender, NULL, 4, stack_task_sender, STK_SIZE_TASK_SENDER, 0); tos_knl_start(); } \u8fd0\u884c\u6548\u679c sender: send a message to one receiver, and shoud be the highest priority one higher: msg incoming[message for one receiver(with highest priority)] sender: send a message to all recevier higher: msg incoming[message for all receivers] lower: msg incoming[message for all receivers] sender: send a message to one receiver, and shoud be the highest priority one higher: msg incoming[message for one receiver(with highest priority)] sender: send a message to all recevier higher: msg incoming[message for all receivers] lower: msg incoming[message for all receivers] \u5b9e\u4f8b\u4ee3\u7801 2.3.8 \u90ae\u7bb1\u961f\u5217 \u6982\u8ff0 \u6d88\u606f\u961f\u5217\u4f20\u9012\u7684\u662f\u6307\u9488\uff0c\u90ae\u7bb1\u961f\u5217\u4f20\u9012\u7684\u662f\u5927\u7247\u7684\u5185\u5b58\u6570\u636e\u3002 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b 1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u90ae\u7bb1\u961f\u5217\u7ec4\u4ef6\u5f00\u5173TOS_CFG_MAIL_QUEUE_EN\uff1a #define TOS_CFG_MAIL_QUEUE_EN 1u 2\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a /* \u8fd9\u91cc\u6f14\u793a\u5982\u4f55\u4f7f\u7528\u90ae\u7bb1\u961f\u5217\u5728sender\u548creceiver\u4efb\u52a1\u4e4b\u95f4\u4f20\u9012\u90ae\u7bb1\uff08\u6b64\u6848\u4f8b\u4e2d\u90ae\u4ef6\uff0c\u4e5f\u5c31\u662f\u90ae\u7bb1\u8981\u4f20\u9012\u7684\u5185\u5b58\u6570\u636e\u4e3a\u4e00\u4e2amail_t\u7c7b\u578b\u7684\u7ed3\u6784\u4f53\uff0c\u4ece\u6b64\u6848\u4f8b\u4e2d\u53ef\u4ee5\u770b\u51fa\u6765\uff0c\u90ae\u7bb1\u961f\u5217\u76f8\u5bf9\u6d88\u606f\u961f\u5217\u6765\u8bf4\uff0c\u53ef\u4ee5\u4f20\u9012\u66f4\u4e3a\u590d\u6742\u7684\u5185\u5b58\u5757\u6570\u636e\uff09 */ #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_RECEIVER 512 #define STK_SIZE_TASK_SENDER 512 #define PRIO_TASK_RECEIVER_HIGHER_PRIO 4 #define PRIO_TASK_RECEIVER_LOWER_PRIO (PRIO_TASK_RECEIVER_HIGHER_PRIO + 1) #define MAIL_MAX 10 k_stack_t stack_task_receiver_higher_prio[STK_SIZE_TASK_RECEIVER]; k_stack_t stack_task_receiver_lower_prio[STK_SIZE_TASK_RECEIVER]; k_stack_t stack_task_sender[STK_SIZE_TASK_SENDER]; typedef struct mail_st { char *message; int payload; } mail_t; uint8_t mail_pool[MAIL_MAX * sizeof(mail_t)]; k_task_t task_receiver_higher_prio; k_task_t task_receiver_lower_prio; k_task_t task_sender; k_mail_q_t mail_q; extern void entry_task_receiver_higher_prio(void *arg); extern void entry_task_receiver_lower_prio(void *arg); extern void entry_task_sender(void *arg); void entry_task_receiver_higher_prio(void *arg) { k_err_t err; mail_t mail; size_t mail_size; while (K_TRUE) { err = tos_mail_q_pend(&mail_q, &mail, &mail_size, TOS_TIME_FOREVER); if (err == K_ERR_NONE) { TOS_ASSERT(mail_size == sizeof(mail_t)); printf(\"higher: msg incoming[%s], payload[%d]\\n\", mail.message, mail.payload); } } } void entry_task_receiver_lower_prio(void *arg) { k_err_t err; mail_t mail; size_t mail_size; while (K_TRUE) { err = tos_mail_q_pend(&mail_q, &mail, &mail_size, TOS_TIME_FOREVER); if (err == K_ERR_NONE) { TOS_ASSERT(mail_size == sizeof(mail_t)); printf(\"lower: msg incoming[%s], payload[%d]\\n\", mail.message, mail.payload); } } } void entry_task_sender(void *arg) { int i = 1; mail_t mail; while (K_TRUE) { if (i == 2) { printf(\"sender: send a mail to one receiver, and shoud be the highest priority one\\n\"); mail.message = \"1st time post\"; mail.payload = 1; tos_mail_q_post(&mail_q, &mail, sizeof(mail_t)); } if (i == 3) { printf(\"sender: send a message to all recevier\\n\"); mail.message = \"2nd time post\"; mail.payload = 2; tos_mail_q_post_all(&mail_q, &mail, sizeof(mail_t)); } if (i == 4) { printf(\"sender: send a message to one receiver, and shoud be the highest priority one\\n\"); mail.message = \"3rd time post\"; mail.payload = 3; tos_mail_q_post(&mail_q, &mail, sizeof(mail_t)); } if (i == 5) { printf(\"sender: send a message to all recevier\\n\"); mail.message = \"4th time post\"; mail.payload = 4; tos_mail_q_post_all(&mail_q, &mail, sizeof(mail_t)); } tos_task_delay(1000); ++i; } } int main(void) { board_init(); tos_knl_init(); tos_mail_q_create(&mail_q, mail_pool, MAIL_MAX, sizeof(mail_t)); (void)tos_task_create(&task_receiver_higher_prio, \"receiver_higher_prio\", entry_task_receiver_higher_prio, NULL, PRIO_TASK_RECEIVER_HIGHER_PRIO, stack_task_receiver_higher_prio, STK_SIZE_TASK_RECEIVER, 0); (void)tos_task_create(&task_receiver_lower_prio, \"receiver_lower_prio\", entry_task_receiver_lower_prio, NULL, PRIO_TASK_RECEIVER_LOWER_PRIO, stack_task_receiver_lower_prio, STK_SIZE_TASK_RECEIVER, 0); (void)tos_task_create(&task_sender, \"sender\", entry_task_sender, NULL, 5, stack_task_sender, STK_SIZE_TASK_SENDER, 0); tos_knl_start(); } \u8fd0\u884c\u6548\u679c sender: send a mail to one receiver, and shoud be the highest priority one higher: msg incoming[1st time post], payload[1] sender: send a message to all recevier higher: msg incoming[2nd time post], payload[2] lower: msg incoming[2nd time post], payload[2] sender: send a message to one receiver, and shoud be the highest priority one higher: msg incoming[3rd time post], payload[3] sender: send a message to all recevier higher: msg incoming[4th time post], payload[4] lower: msg incoming[4th time post], payload[4] \u5b9e\u4f8b\u4ee3\u7801 2.3.9 \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217 \u6982\u8ff0 \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u76f8\u5bf9\u6d88\u606f\u961f\u5217\u6765\u8bf4\uff0c\u7ed9\u6d88\u606f\u9644\u52a0\u4e86\u4e00\u4e2a\u4f18\u5148\u7ea7\u7684\u6982\u5ff5\uff0c\u8f83\u9ad8\u4f18\u5148\u7ea7\u7684\u6d88\u606f\u4f1a\u6bd4\u8f83\u4f4e\u4f18\u5148\u7ea7\u7684\u6d88\u606f\u66f4\u5feb\u5730\u88ab\u5176\u4ed6\u4efb\u52a1\u6536\u5230\uff08\u672c\u8d28\u4e0a\uff0c\u6d88\u606f\u961f\u5217\u7684\u5e95\u5c42\u6570\u636e\u5bb9\u5668\u662f\u73af\u5f62\u961f\u5217\uff0c\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u7684\u5e95\u5c42\u6570\u636e\u5bb9\u5668\u662f\u4f18\u5148\u7ea7\u961f\u5217\uff09\u3002 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b 1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u7ec4\u4ef6\u5f00\u5173TOS_CFG_PRIORITY_MESSAGE_QUEUE_EN\uff1a #define TOS_CFG_PRIORITY_MESSAGE_QUEUE_EN 1u 2\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_RECEIVER 512 #define STK_SIZE_TASK_SENDER 512 #define MESSAGE_MAX 10 k_stack_t stack_task_receiver[STK_SIZE_TASK_RECEIVER]; k_stack_t stack_task_sender[STK_SIZE_TASK_SENDER]; uint8_t msg_pool[MESSAGE_MAX * sizeof(void *)]; k_task_t task_receiver; k_task_t task_sender; k_prio_msg_q_t prio_msg_q; extern void entry_task_receiver(void *arg); extern void entry_task_sender(void *arg); void entry_task_receiver(void *arg) { k_err_t err; void *msg_received; while (K_TRUE) { err = tos_prio_msg_q_pend(&prio_msg_q, &msg_received, TOS_TIME_FOREVER); if (err == K_ERR_NONE) { printf(\"receiver: msg incoming[%s]\\n\", (char *)msg_received); } } } void entry_task_sender(void *arg) { char *msg_prio_0 = \"msg with priority 0\"; char *msg_prio_1 = \"msg with priority 1\"; char *msg_prio_2 = \"msg with priority 2\"; printf(\"sender: post a message with priority 2\\n\"); tos_prio_msg_q_post(&prio_msg_q, msg_prio_2, 2); printf(\"sender: post a message with priority 1\\n\"); tos_prio_msg_q_post(&prio_msg_q, msg_prio_1, 1); printf(\"sender: post a message with priority 0\\n\"); tos_prio_msg_q_post(&prio_msg_q, msg_prio_0, 0); } int main(void) { board_init(); tos_knl_init(); tos_prio_msg_q_create(&prio_msg_q, msg_pool, MESSAGE_MAX); (void)tos_task_create(&task_receiver, \"receiver\", entry_task_receiver, NULL, 5, stack_task_receiver, STK_SIZE_TASK_RECEIVER, 0); (void)tos_task_create(&task_sender, \"sender\", entry_task_sender, NULL, 4, stack_task_sender, STK_SIZE_TASK_SENDER, 0); tos_knl_start(); } \u8fd0\u884c\u6548\u679c sender: post a message with priority 2 sender: post a message with priority 1 sender: post a message with priority 0 receiver: msg incoming[msg with priority 0] receiver: msg incoming[msg with priority 1] receiver: msg incoming[msg with priority 2] \u5b9e\u4f8b\u4ee3\u7801 2.3.10 \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217 \u6982\u8ff0 \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u76f8\u5bf9\u90ae\u7bb1\u961f\u5217\u6765\u8bf4\uff0c\u7ed9\u90ae\u4ef6\u9644\u52a0\u4e86\u4e00\u4e2a\u4f18\u5148\u7ea7\u7684\u6982\u5ff5\uff0c\u8f83\u9ad8\u4f18\u5148\u7ea7\u7684\u90ae\u4ef6\u4f1a\u6bd4\u8f83\u4f4e\u4f18\u5148\u7ea7\u7684\u90ae\u4ef6\u66f4\u5feb\u5730\u88ab\u5176\u4ed6\u4efb\u52a1\u6536\u5230\uff08\u672c\u8d28\u4e0a\uff0c\u90ae\u7bb1\u961f\u5217\u7684\u5e95\u5c42\u6570\u636e\u5bb9\u5668\u662f\u73af\u5f62\u961f\u5217\uff0c\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u7684\u5e95\u5c42\u6570\u636e\u5bb9\u5668\u662f\u4f18\u5148\u7ea7\u961f\u5217\uff09\u3002 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b 1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u7ec4\u4ef6\u5f00\u5173TOS_CFG_PRIORITY_MAIL_QUEUE_EN\uff1a #define TOS_CFG_PRIORITY_MAIL_QUEUE_EN 1u 2\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a /* \u8fd9\u91cc\u6f14\u793a\u4e86\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u7684\u4f7f\u7528\uff0c\u4ecesender\u4efb\u52a1\u4e2d\u7684\u903b\u8f91\u53ef\u4ee5\u770b\u51fa\u6765\uff0c\u4f9d\u6b21post\u4e86\u4e09\u4e2amail\uff0c\u4f18\u5148\u7ea7\u6309\u65f6\u95f4\u987a\u5e8f\u4f9d\u6b21\u4e3a2\u30011\u30010\uff08\u6570\u503c\u8d8a\u9ad8\u4f18\u5148\u7ea7\u8d8a\u4f4e\uff09\u3002\u5982\u679c\u662f\u4f20\u7edf\u7684\u90ae\u7bb1\u961f\u5217\uff0c\u90a3\u4e2areceiver\u5e94\u8be5\u662f\u4f9d\u6b21\u6536\u5230\u4f18\u5148\u7ea7\u4e3a2\u30011\u30010\u7684\u90ae\u4ef6\uff1b\u4f46\u8fd9\u662f\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\uff0c\u56e0\u800creceiver\u4f1a\u6309\u4f18\u5148\u7ea7\u987a\u5e8f\u6536\u5230\u8fd9\u4e09\u4e2a\u90ae\u4ef6\uff0c\u4e5f\u5c31\u662f\u4f9d\u6b21\u6536\u5230\u4f18\u5148\u7ea7\u4e3a0\u30011\u30012\u7684\u90ae\u4ef6\u3002 */ #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_RECEIVER 512 #define STK_SIZE_TASK_SENDER 512 #define MAIL_MAX 10 k_stack_t stack_task_receiver[STK_SIZE_TASK_RECEIVER]; k_stack_t stack_task_sender[STK_SIZE_TASK_SENDER]; typedef struct mail_st { char *message; int payload; } mail_t; uint8_t mail_pool[MAIL_MAX * sizeof(mail_t)]; k_task_t task_receiver; k_task_t task_sender; k_prio_mail_q_t prio_mail_q; extern void entry_task_receiver(void *arg); extern void entry_task_sender(void *arg); void entry_task_receiver(void *arg) { k_err_t err; mail_t mail; size_t mail_size; while (K_TRUE) { err = tos_prio_mail_q_pend(&prio_mail_q, &mail, &mail_size, TOS_TIME_FOREVER); if (err == K_ERR_NONE) { TOS_ASSERT(mail_size == sizeof(mail_t)); printf(\"receiver: msg incoming[%s], payload[%d]\\n\", mail.message, mail.payload); } } } void entry_task_sender(void *arg) { mail_t mail_0, mail_1, mail_2; printf(\"sender: post a mail with priority 2\\n\"); mail_2.message = \"priority 2\"; mail_2.payload = 2; tos_prio_mail_q_post(&prio_mail_q, &mail_2, sizeof(mail_t), 2); printf(\"sender: post a mail with priority 1\\n\"); mail_1.message = \"priority 1\"; mail_1.payload = 1; tos_prio_mail_q_post_all(&prio_mail_q, &mail_1, sizeof(mail_t), 1); printf(\"sender: post a mail with priority 0\\n\"); mail_0.message = \"priority 0\"; mail_0.payload = 0; tos_prio_mail_q_post(&prio_mail_q, &mail_0, sizeof(mail_t), 0); } int main(void) { board_init(); tos_knl_init(); tos_prio_mail_q_create(&prio_mail_q, mail_pool, MAIL_MAX, sizeof(mail_t)); (void)tos_task_create(&task_receiver, \"receiver\", entry_task_receiver, NULL, 6, stack_task_receiver, STK_SIZE_TASK_RECEIVER, 0); (void)tos_task_create(&task_sender, \"sender\", entry_task_sender, NULL, 5, stack_task_sender, STK_SIZE_TASK_SENDER, 0); tos_knl_start(); } \u8fd0\u884c\u6548\u679c sender: post a mail with priority 2 sender: post a mail with priority 1 sender: post a mail with priority 0 receiver: msg incoming[priority 0], payload[0] receiver: msg incoming[priority 1], payload[1] receiver: msg incoming[priority 2], payload[2] \u5b9e\u4f8b\u4ee3\u7801 2.4 \u5185\u5b58\u7ba1\u7406 2.4.1 \u52a8\u6001\u5185\u5b58 \u6982\u8ff0 \u52a8\u6001\u5185\u5b58\u7ba1\u7406\u6a21\u5757\uff0c\u63d0\u4f9b\u4e86\u4e00\u5957\u52a8\u6001\u7ba1\u7406\u7cfb\u7edf\u5185\u5b58\u7684\u673a\u5236\uff0c\u652f\u6301\u7528\u6237\u52a8\u6001\u7684\u7533\u8bf7\u3001\u91ca\u653e\u4e0d\u5b9a\u957f\u5185\u5b58\u5757\u3002 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b 1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u52a8\u6001\u5185\u5b58\u7ec4\u4ef6\u5f00\u5173TOS_CFG_MMHEAP_EN\uff1a #define TOS_CFG_MMHEAP_EN 1u 2\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u52a8\u6001\u5185\u5b58\u6c60\u5927\u5c0f\uff1a #define TOS_CFG_MMHEAP_POOL_SIZE 0x2000 3\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_DEMO 512 k_stack_t stack_task_demo[STK_SIZE_TASK_DEMO]; k_task_t task_demo; extern void entry_task_demo(void *arg); void entry_task_demo(void *arg) { void *p = K_NULL, *p_aligned = K_NULL; int i = 0; while (K_TRUE) { if (i == 1) { p = tos_mmheap_alloc(0x30); if (p) { printf(\"alloc: %x\\n\", (cpu_addr_t)p); } } else if (i == 2) { if (p) { printf(\"free: %x\\n\", p); tos_mmheap_free(p); } } else if (i == 3) { p = tos_mmheap_alloc(0x30); if (p) { printf(\"alloc: %x\\n\", (cpu_addr_t)p); } } else if (i == 4) { p_aligned = tos_mmheap_aligned_alloc(0x50, 16); if (p_aligned) { printf(\"aligned alloc: %x\\n\", (cpu_addr_t)p_aligned); if ((cpu_addr_t)p_aligned % 16 == 0) { printf(\"%x is 16 aligned\\n\", (cpu_addr_t)p_aligned); } else { printf(\"should not happen\\n\"); } } } else if (i == 5) { p = tos_mmheap_realloc(p, 0x40); if (p) { printf(\"realloc: %x\\n\", (cpu_addr_t)p); } } else if (i == 6) { if (p) { tos_mmheap_free(p); } if (p_aligned) { tos_mmheap_free(p_aligned); } } tos_task_delay(1000); ++i; } } int main(void) { board_init(); tos_knl_init(); (void)tos_task_create(&task_demo, \"receiver_higher_prio\", entry_task_demo, NULL, 4, stack_task_demo, STK_SIZE_TASK_DEMO, 0); tos_knl_start(); } \u8fd0\u884c\u6548\u679c alloc: 20000c8c free: 20000c8c alloc: 20000c8c aligned alloc: 20000cc0 20000cc0 is 16 aligned realloc: 20000d14 \u5b9e\u4f8b\u4ee3\u7801 2.4.2 \u9759\u6001\u5185\u5b58 \u6982\u8ff0 \u9759\u6001\u5185\u5b58\u7ba1\u7406\u6a21\u5757\uff0c\u63d0\u4f9b\u4e86\u4e00\u5957\u7ba1\u7406\u9759\u6001\u5185\u5b58\u5757\u7684\u673a\u5236\uff0c\u652f\u6301\u7528\u6237\u7533\u8bf7\u3001\u91ca\u653e\u5b9a\u957f\u7684\u5185\u5b58\u5757\u3002 API\u8bb2\u89e3 \u521b\u5efa\u9759\u6001\u5185\u5b58\u6c60\u63a5\u53e3\uff1a k_err_t tos_mmblk_pool_create(k_mmblk_pool_t *mbp, void *pool_start, size_t blk_num, size_t blk_size); \u8fd9\u91cc\u8be6\u7ec6\u8bb2\u89e3\u6b64api\u53c2\u6570\u610f\u4e49\uff1a mbp \u9759\u6001\u5185\u5b58\u6c60\u53e5\u67c4\u3002 pool_start \u9759\u6001\u5185\u5b58\u6c60\u8d77\u59cb\u5730\u5740\u3002 blk_num \u5185\u5b58\u6c60\u5c06\u8981\u5212\u5206\u7684\u5185\u5b58\u5757\u4e2a\u6570\u3002 blk_size \u6bcf\u4e2a\u5185\u5b58\u5757\u7684\u5927\u5c0f\u3002 \u7f16\u7a0b\u5b9e\u4f8b 1\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_DEMO 512 k_stack_t stack_task_demo[STK_SIZE_TASK_DEMO]; k_task_t task_demo; #define MMBLK_BLK_NUM 5 #define MMBLK_BLK_SIZE 0x20 k_mmblk_pool_t mmblk_pool; // \u9700\u8981\u7ba1\u7406\u7684\u9759\u6001\u5185\u5b58\u6c60 uint8_t mmblk_pool_buffer[MMBLK_BLK_NUM * MMBLK_BLK_SIZE]; // \u8bb0\u5f55\u4ece\u5185\u5b58\u6c60\u4e2d\u5206\u914d\u5230\u7684\u5730\u5740 void *p[MMBLK_BLK_NUM] = { K_NULL }; extern void entry_task_demo(void *arg); void entry_task_demo(void *arg) { void *p_dummy = K_NULL; k_err_t err; int i = 0; printf(\"mmblk_pool has %d blocks, size of each block is 0x%x\\n\", 5, 0x20); // \u4ece\u5185\u5b58\u6c60\u4e2d\u83b7\u53d6\u6240\u6709\u7684block for (; i < MMBLK_BLK_NUM; ++i) { err = tos_mmblk_alloc(&mmblk_pool, &p[i]); if (err == K_ERR_NONE) { printf(\"%d block alloced: 0x%x\\n\", i, p[i]); } else { printf(\"should not happen\\n\"); } } // \u524d\u6587\u903b\u8f91\u5df2\u7ecf\u5c06\u6240\u6709\u53ef\u7528block\u5206\u914d\u5b8c\u6bd5\uff0c\u7ee7\u7eed\u5206\u914d\u4f1a\u8fd4\u56deK_ERR_MMBLK_POOL_EMPTY\u9519\u8bef\u7801 err = tos_mmblk_alloc(&mmblk_pool, &p_dummy); if (err == K_ERR_MMBLK_POOL_EMPTY) { printf(\"blocks exhausted, all blocks is alloced\\n\"); } else { printf(\"should not happen\\n\"); } // \u5c06\u524d\u6587\u5206\u914d\u5f97\u5230\u7684\u6240\u6709block\u5f52\u8fd8\u5230\u6c60\u4e2d for (i = 0; i < MMBLK_BLK_NUM; ++i) { err = tos_mmblk_free(&mmblk_pool, p[i]); if (err != K_ERR_NONE) { printf(\"should not happen\\n\"); } } // \u524d\u6587\u7684\u5f52\u8fd8\u52a8\u4f5c\u4e2d\u5df2\u7ecf\u5c06\u6240\u6709\u7684block\u5f52\u8fd8\u5230\u6c60\u4e2d\uff0c\u7ee7\u7eed\u89c4\u8303\u4f1a\u8fd4\u56deK_ERR_MMBLK_POOL_FULL\u9519\u8bef\u7801 err = tos_mmblk_free(&mmblk_pool, p[0]); if (err == K_ERR_MMBLK_POOL_FULL) { printf(\"pool is full\\n\"); } else { printf(\"should not happen\\n\"); } } int main(void) { board_init(); tos_knl_init(); // \u521b\u5efa\u9759\u6001\u5185\u5b58\u6c60 tos_mmblk_pool_create(&mmblk_pool, mmblk_pool_buffer, MMBLK_BLK_NUM, MMBLK_BLK_SIZE); (void)tos_task_create(&task_demo, \"receiver_higher_prio\", entry_task_demo, NULL, 4, stack_task_demo, STK_SIZE_TASK_DEMO, 0); tos_knl_start(); } \u8fd0\u884c\u6548\u679c mmblk_pool has 5 blocks, size of each block is 0x20 0 block alloced: 0x20000974 1 block alloced: 0x20000994 2 block alloced: 0x200009b4 3 block alloced: 0x200009d4 4 block alloced: 0x200009f4 blocks exhausted, all blocks is alloced pool is full \u5b9e\u4f8b\u4ee3\u7801 2.5 \u65f6\u95f4\u7ba1\u7406 \u6982\u8ff0 \u65f6\u95f4\u7ba1\u7406\uff0c\u63d0\u4f9b\u4e86\u4e00\u65cf\u4e0e\u65f6\u95f4\u76f8\u5173\u7684\u51fd\u6570\uff0c\u53ef\u4ee5\u83b7\u53d6/\u8bbe\u7f6e\u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570\uff08systick\uff09\u3001systick\u4e0e\u6beb\u79d2\u5355\u4f4d\u4e4b\u95f4\u4e92\u76f8\u8f6c\u5316\u3001\u6309\u6beb\u79d2\u3001\u5899\u4e0a\u65f6\u949f\u7b49\u5355\u4f4d\u8fdb\u884c\u4efb\u52a1\u7761\u7720\u7684\u529f\u80fd\u3002 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b 1\u3001\u914d\u7f6e\u6bcf\u79d2\u949f\u7684\u7cfb\u7edf\u6ef4\u7b54\u6570TOS_CFG_CPU_TICK_PER_SECOND\uff1a #define TOS_CFG_CPU_TICK_PER_SECOND 1000u 2\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_DEMO 512 k_stack_t stack_task_demo[STK_SIZE_TASK_DEMO]; k_task_t task_demo; extern void entry_task_demo(void *arg); void entry_task_demo(void *arg) { k_time_t ms; k_tick_t systick, after_systick; // \u56e0\u4e3aTOS_CFG_CPU_TICK_PER_SECOND\u4e3a1000\uff0c\u4e5f\u5c31\u662f\u4e00\u79d2\u949f\u4f1a\u67091000\u4e2asystick\uff0c\u56e0\u6b641000\u4e2asystick\u7b49\u4e8e1000\u6beb\u79d2\u3002 systick = tos_millisec2tick(2000); printf(\"%d millisec equals to %lld ticks\\n\", 2000, systick); ms = tos_tick2millisec(1000); printf(\"%lld ticks equals to %d millisec\\n\", (k_tick_t)1000, ms); systick = tos_systick_get(); printf(\"before sleep, systick is %lld\\n\", systick); tos_msleep(2000); after_systick = tos_systick_get(); printf(\"after sleep %d ms, systick is %lld\\n\", 2000, after_systick); printf(\"milliseconds sleep is about: %d\\n\", tos_ticks2millisec(after_systick - systick)); } int main(void) { board_init(); tos_knl_init(); (void)tos_task_create(&task_demo, \"receiver_higher_prio\", entry_task_demo, NULL, 4, stack_task_demo, STK_SIZE_TASK_DEMO, 0); tos_knl_start(); } \u8fd0\u884c\u6548\u679c 2000 millisec equals to 2000 ticks 1000 ticks equals to 1000 millisec before sleep, systick is 7 after sleep 2000 ms, systick is 2009 milliseconds sleep is about: 2002 \u5b9e\u4f8b\u4ee3\u7801 2.6 \u8f6f\u4ef6\u5b9a\u65f6\u5668 \u6982\u8ff0 \u8f6f\u4ef6\u5b9a\u65f6\u5668\u63d0\u4f9b\u4e86\u4e00\u5957\u4ece\u8f6f\u4ef6\u5c42\u6b21\u5b9e\u73b0\u7684\u5b9a\u65f6\u5668\u673a\u5236\uff0c\u76f8\u5bf9\u5e94\u7684\u6982\u5ff5\u662f\u786c\u4ef6\u5b9a\u65f6\u5668\u3002\u7528\u6237\u53ef\u4ee5\u521b\u5efa\u4e00\u7cfb\u5217\u7684\u8f6f\u4ef6\u5b9a\u65f6\u5668\uff0c\u5e76\u6307\u5b9a\u8f6f\u4ef6\u5b9a\u65f6\u5668\u5230\u671f\u7684\u6761\u4ef6\u4ee5\u53ca\u6267\u884c\u56de\u8c03\uff0c\u5f53\u8f6f\u4ef6\u5b9a\u65f6\u5668\u5230\u671f\u65f6\u4f1a\u6267\u884c\u6ce8\u518c\u7684\u56de\u8c03\u3002 \u901a\u5e38\u6765\u8bf4\uff0c\u7528\u6237\u6ce8\u518c\u7684\u8f6f\u4ef6\u5b9a\u65f6\u5668\u56de\u8c03\u4e2d\u5f88\u53ef\u80fd\u5305\u542b\u5ef6\u8fdf\u52a8\u4f5c\u6216\u540c\u6b65\u7b49\u5f85\u64cd\u4f5c\uff0c\u6216\u8005\u56de\u8c03\u51fd\u6570\u672c\u8eab\u903b\u8f91\u590d\u6742\u6267\u884c\u8017\u65f6\u8f83\u957f\uff0c\u56e0\u6b64\u7cfb\u7edf\u5c06\u8f6f\u4ef6\u5b9a\u65f6\u5668\u7ba1\u7406\u903b\u8f91\u8bbe\u8ba1\u6210\u4e00\u4e2a\u4efb\u52a1\uff0c\u5728\u8fd9\u4e2a\u4efb\u52a1\u4e2d\u626b\u63cf\u5b9a\u65f6\u5668\u662f\u5426\u8fc7\u671f\u5e76\u6267\u884c\u5b9a\u65f6\u5668\u56de\u8c03\u3002\u4f46\u662f\u5982\u4f60\u6240\u77e5\uff0c\u521b\u5efa\u4e00\u4e2a\u4efb\u52a1\u662f\u9700\u8981\u6d88\u8017\u7cfb\u7edf\u5185\u5b58\u8d44\u6e90\u7684\uff08\u4efb\u52a1\u7684\u6808\u3001\u4efb\u52a1\u53e5\u67c4\u672c\u8eab\u7684\u5185\u5b58\u7a7a\u95f4\u7b49\u7b49\uff09\uff0c\u800c\u5982\u679c\u7528\u6237\u6ce8\u518c\u7684\u8f6f\u4ef6\u5b9a\u65f6\u5668\u56de\u8c03\u4e2d\u5e76\u4e0d\u5305\u542b\u5ef6\u8fdf\u52a8\u4f5c\u4e5f\u4e0d\u5305\u542b\u540c\u6b65\u7b49\u5f85\u64cd\u4f5c\uff0c\u6216\u8005\u56de\u8c03\u672c\u8eab\u6267\u884c\u8017\u65f6\u5f88\u77ed\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u8f6f\u4ef6\u5b9a\u65f6\u5668\u7ba1\u7406\u903b\u8f91\u65e0\u9700\u88ab\u8bbe\u8ba1\u6210\u4efb\u52a1\uff0c\u800c\u662f\u53ef\u4ee5\u88ab\u8bbe\u8ba1\u6210\u65f6\u949f\u4e2d\u65ad\u4e2d\u88ab\u8c03\u7528\u7684\u4e00\u4e2a\u51fd\u6570\u3002\u5f53\u8f6f\u4ef6\u5b9a\u65f6\u5668\u7ba1\u7406\u903b\u8f91\u88ab\u8bbe\u8ba1\u6210\u4e00\u4e2a\u51fd\u6570\u65f6\uff0c\u5c31\u53ef\u4ee5\u8282\u7701\u521b\u5efa\u4efb\u52a1\u6240\u9700\u7684\u8d44\u6e90\u3002 \u7cfb\u7edf\u9ed8\u8ba4\u91c7\u7528\u7684\u5b9e\u73b0\u662f\u5c06\u5b9a\u65f6\u5668\u7ba1\u7406\u903b\u8f91\u8bbe\u8ba1\u4e3a\u4efb\u52a1\uff0c\u5f53\u7528\u6237\u7684\u5b9a\u65f6\u5668\u56de\u8c03\u90fd\u662f\u8017\u65f6\u6781\u77ed\u7684\u64cd\u4f5c\u65f6\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u5c06\u8f6f\u4ef6\u5b9a\u65f6\u5668\u7ba1\u7406\u903b\u8f91\u914d\u7f6e\u4e3a\u51fd\u6570\u6765\u8282\u7701\u5185\u5b58\u8d44\u6e90\u3002\u901a\u8fc7\u5728tos_config.h\u4e2d\u6253\u5f00TOS_CFG_TIMER_AS_PROC\u5f00\u5173\u6765\u8bb2\u8f6f\u4ef6\u5b9a\u65f6\u5668\u7ba1\u7406\u903b\u8f91\u914d\u7f6e\u4e3a\u51fd\u6570\uff1a #define TOS_CFG_TIMER_AS_PROC 1u API\u8bb2\u89e3 k_err_t tos_timer_create(k_timer_t *tmr, k_tick_t delay, k_tick_t period, k_timer_callback_t callback, void *cb_arg, k_opt_t opt) \u8fd9\u91cc\u8be6\u7ec6\u8bb2\u89e3\u6b64api\u53c2\u6570\u610f\u4e49\uff1a tmr \u8f6f\u4ef6\u5b9a\u65f6\u5668\u53e5\u67c4\u3002 delay \u8be5\u5b9a\u65f6\u5668\u5ef6\u8fdf\u591a\u4e45\u540e\u6267\u884c\u3002 period \u4e00\u4e2a\u5b9a\u65f6\u5668\u7684\u6267\u884c\u5468\u671f\u3002 callback \u5b9a\u65f6\u5668\u5230\u671f\u540e\u7684\u6267\u884c\u56de\u8c03\u3002 cb_arg \u6267\u884c\u56de\u8c03\u7684\u5165\u53c2\u3002 opt \u6b64opt\u7684\u4f20\u5165\u4e3b\u8981\u662f\u754c\u5b9atmr\u7684\u5c5e\u6027\uff0c\u5982\u679c\u4f20\u5165\u7684\u662fTOS_OPT_TIMER_ONESHOT\uff0c\u8868\u660e\u6b64tmr\u662f\u4e00\u6b21\u6027\u7684\uff0c\u5f53delay\u65f6\u95f4\u5230\u671f\uff0ctmr\u7684\u6267\u884c\u56de\u8c03\u8c03\u7528\u5b8c\u6bd5\u540e\u6b64tmr\u751f\u547d\u5468\u671f\u5c31\u7ed3\u675f\u4e86\uff1b\u5982\u679c\u4f20\u5165\u7684\u662fTOS_OPT_TIMER_PERIODIC\uff0c\u8868\u660e\u6b64tmr\u662f\u5468\u671f\u6027\u5b9a\u65f6\u5668\uff0c\u5f53tmr\u5b9a\u65f6\u65f6\u95f4\u5230\u671f\uff0ctmr\u7684\u6267\u884c\u56de\u8c03\u8c03\u7528\u5b8c\u6bd5\u540e\uff0c\u7cfb\u7edf\u4f1a\u91cd\u65b0\u6309period\u53c2\u6570\u4e3a\u5230\u671f\u65f6\u95f4\u5c06tmr\u52a0\u5165\u5230\u5b9a\u65f6\u961f\u5217\uff0c\u5f00\u542f\u4e0b\u4e00\u4e2a\u5468\u671f\u3002 \u7f16\u7a0b\u5b9e\u4f8b 1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u8f6f\u4ef6\u5b9a\u65f6\u5668\u7ec4\u4ef6\u5f00\u5173TOS_CFG_TIMER_EN\uff1a #define TOS_CFG_TIMER_EN 1000u 2\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_DEMO 512 k_stack_t stack_task_demo[STK_SIZE_TASK_DEMO]; k_task_t task_demo; extern void entry_task_demo(void *arg); void oneshot_timer_cb(void *arg) { printf(\"this is oneshot timer callback, current systick: %lld\\n\", tos_systick_get()); } void periodic_timer_cb(void *arg) { printf(\"this is periodic timer callback, current systick: %lld\\n\", tos_systick_get()); } void entry_task_demo(void *arg) { k_timer_t oneshot_tmr; k_timer_t periodic_tmr; // \u8fd9\u662f\u4e00\u4e2a\u4e00\u6b21\u6027\u7684timer\uff0c\u4e14\u8d85\u65f6\u65f6\u95f4\u662f3000\u4e2atick\u4e4b\u540e tos_timer_create(&oneshot_tmr, 3000, 0, oneshot_timer_cb, K_NULL, TOS_OPT_TIMER_ONESHOT); // \u8fd9\u662f\u4e00\u4e2a\u5468\u671f\u6027\u7684timer\uff0c\u7b2c\u4e00\u6b21\u8d85\u65f6\u65f6\u95f4\u662f2000\u4e2atick\u4e4b\u540e\uff0c\u4e4b\u540e\u63093000\u4e2atick\u4e3a\u5468\u671f\u6267\u884c\u56de\u8c03 tos_timer_create(&periodic_tmr, 2000, 3000, periodic_timer_cb, K_NULL, TOS_OPT_TIMER_PERIODIC); printf(\"current systick: %lld\\n\", tos_systick_get()); tos_timer_start(&oneshot_tmr); tos_timer_start(&periodic_tmr); while (K_TRUE) { tos_task_delay(1000); } } int main(void) { board_init(); tos_knl_init(); (void)tos_task_create(&task_demo, \"receiver_higher_prio\", entry_task_demo, NULL, 4, stack_task_demo, STK_SIZE_TASK_DEMO, 0); tos_knl_start(); } \u8fd0\u884c\u6548\u679c current systick: 0 this is periodic timer callback, current systick: 2001 this is oneshot timer callback, current systick: 3001 this is periodic timer callback, current systick: 5001 this is periodic timer callback, current systick: 8001 this is periodic timer callback, current systick: 11001 this is periodic timer callback, current systick: 14001 \u5b9e\u4f8b\u4ee3\u7801 2.7 \u65f6\u95f4\u7247\u8f6e\u8f6c\u673a\u5236 \u6982\u8ff0 TencentOS tiny\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u662f\u4e00\u4e2a\u62a2\u5360\u5f0f\u5185\u6838\uff0c\u62a2\u5360\u5f0f\u5185\u6838\u7684\u7279\u70b9\u662f\uff0c\u5982\u679c\u6700\u9ad8\u4f18\u5148\u7ea7\u7684\u4efb\u52a1\u4e0d\u653e\u5f03CPU\uff08\u8c03\u7528tos_task_delay\u3001tos_task_yeild\u7b49\u4e3b\u52a8\u653e\u6743\uff0c\u6216\u8005\u4efb\u52a1\u95f4\u540c\u6b65\u901a\u4fe1\u673a\u5236\u7684pend\u63a5\u53e3\u7b49\uff09\uff0c\u90a3\u4e48CPU\u5c06\u4f1a\u4e00\u76f4\u88ab\u6b64\u4efb\u52a1\u72ec\u5360\u3002 \u5047\u8bbe\u8fd9\u6837\u4e00\u79cd\u573a\u666f\uff1a\u7cfb\u7edf\u4e2d\u5305\u542b\u591a\u4e2a\u540c\u7b49\u4f18\u5148\u7ea7\u7684\u4efb\u52a1\uff0c\u4e14\u8fd9\u51e0\u4e2a\u4efb\u52a1\u4f53\u4e2d\u90fd\u6ca1\u6709\u653e\u5f03CPU\u7684\u884c\u4e3a\uff0c\u5219\u4f1a\u51fa\u73b0\u7684\u60c5\u51b5\u662f\uff0c\u8fd9\u51e0\u4e2a\u4efb\u52a1\u59cb\u7ec8\u53ea\u6709\u7b2c\u4e00\u4e2a\u88ab\u5f97\u5230\u8c03\u5ea6\u7684\u90a3\u4e2a\u5728\u8fd0\u884c\uff0c\u56e0\u4e3a\u7b2c\u4e00\u4e2a\u5f97\u5230\u8c03\u5ea6\u7684\u4efb\u52a1\u4f53\u4e2d\u4e0d\u4f1a\u4e3b\u52a8\u653e\u5f03CPU\uff0c\u800c\u5176\u4ed6\u4efb\u52a1\u4f18\u5148\u7ea7\u4e0a\u4e0e\u5176\u76f8\u7b49\u65e0\u6cd5\u62a2\u5360\u3002\u6b64\u79cd\u573a\u666f\u4e0b\uff0c\u5176\u4ed6\u4efb\u52a1\u4f1a\u56e0\u5f97\u4e0d\u5230CPU\u800c\u9677\u5165\u9965\u997f\u72b6\u6001\u3002 \u65f6\u95f4\u7247\u8f6e\u8f6c\u673a\u5236\u63d0\u4f9b\u4e86\u6309\u65f6\u95f4\u7247\u5360\u7528\u8c03\u5ea6\u7684\u7b56\u7565\uff0c\u53ef\u4ee5\u89e3\u51b3\u4e0a\u8ff0\u573a\u666f\u4e0b\u7684\u4efb\u52a1\u9965\u997f\u95ee\u9898\u3002 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b 1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u65f6\u95f4\u7247\u8f6e\u8f6c\u7ec4\u4ef6\u5f00\u5173TOS_CFG_ROUND_ROBIN_EN\uff1a #define TOS_CFG_ROUND_ROBIN_EN 1u 2\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_DEMO 512 #define STK_SIZE_TASK_SAMPLE 512 /* \u6b64\u4ee3\u7801\u4e2d\u521b\u5efa\u4e86\u4e24\u4e2a\u540c\u7b49\u4f18\u5148\u7ea7\uff08PRIO_TASK_DEMO\uff09\u7684\u4efb\u52a1task_demo1\u3001task_demo2\uff0c\u4e24\u4e2a\u4efb\u52a1\u4f53\u4e2d\u505a\u7684\u64cd\u4f5c\u662f\u4e0d\u65ad\u5bf9\u5404\u81ea\u7684\u8ba1\u6570\u5668\uff08demo1_counter\u3001demo2_counter\uff09\u505a\u81ea\u589e\u64cd\u4f5c\uff08\u6ca1\u6709\u653e\u5f03CPU\u7684\u64cd\u4f5c\uff09\uff0c\u65f6\u95f4\u7247\u5206\u522b\u4e3atimeslice_demo1\u3001timeslice_demo2\u3002 \u540c\u65f6\u521b\u5efa\u4e86\u4e00\u4e2a\u4f18\u5148\u7ea7\u6bd4task_demo1\u3001task_demo2\u8f83\u9ad8\u7684\u91c7\u6837\u4efb\u52a1task_sample\uff0c\u6b64\u4efb\u52a1\u4e0d\u95f4\u6b47\u7684\u5bf9\u4e24\u4e2a\u8ba1\u6570\u5668\u8fdb\u884c\u91c7\u6837\u3002\u5728\u5f00\u542f\u65f6\u95f4\u7247\u8f6e\u8f6c\u7684\u60c5\u51b5\u4e0b\uff0ctask_demo1\u3001task_demo2\u5f97\u5230\u8fd0\u884c\u7684\u65f6\u95f4\u6bd4\u4f8b\u5e94\u8be5\u662ftimeslice_demo1\u4e0etimeslice_demo2\u7684\u6bd4\u4f8b\uff0c\u90a3\u4e48demo1_counter\u548cdemo2_counter\u503c\u7684\u6bd4\u4f8b\u5e94\u8be5\u4e5f\u5dee\u4e0d\u591a\u662ftimeslice_demo1\u4e0etimeslice_demo2\u7684\u6bd4\u4f8b\u3002 */ // task_demo1\u548ctask_demo2\u7684\u4f18\u5148\u7ea7 #define PRIO_TASK_DEMO 4 // \u91c7\u6837\u4efb\u52a1\u7684\u4f18\u5148\u7ea7 #define PRIO_TASK_SAMPLE (PRIO_TASK_DEMO - 1) // task_demo1\u7684\u65f6\u95f4\u7247\uff0c\u5728tos_task_create\u65f6\u4f20\u5165 const k_timeslice_t timeslice_demo1 = 10; // task_demo2\u7684\u65f6\u95f4\u7247\uff0c\u5728tos_task_create\u65f6\u4f20\u5165 const k_timeslice_t timeslice_demo2 = 20; k_stack_t stack_task_demo1[STK_SIZE_TASK_DEMO]; k_stack_t stack_task_demo2[STK_SIZE_TASK_DEMO]; k_stack_t stack_task_sample[STK_SIZE_TASK_SAMPLE]; k_task_t task_demo1; k_task_t task_demo2; k_task_t task_sample; extern void entry_task_demo1(void *arg); extern void entry_task_demo2(void *arg); extern void entry_task_sample(void *arg); uint64_t demo1_counter = 0; uint64_t demo2_counter = 0; void entry_task_demo1(void *arg) { while (K_TRUE) { ++demo1_counter; } } void entry_task_demo2(void *arg) { while (K_TRUE) { ++demo2_counter; } } void entry_task_sample(void *arg) { while (K_TRUE) { ++demo2_counter; printf(\"demo1_counter: %lld\\n\", demo1_counter); printf(\"demo2_counter: %lld\\n\", demo2_counter); printf(\"demo2_counter / demo1_counter = %f\\n\", (double)demo2_counter / demo1_counter); printf(\"should almost equals to:\\n\"); printf(\"timeslice_demo2 / timeslice_demo1 = %f\\n\\n\", (double)timeslice_demo2 / timeslice_demo1); tos_task_delay(1000); } } int main(void) { board_init(); tos_knl_init(); // \u914d\u7f6erobin\u673a\u5236\u53c2\u6570 tos_robin_default_timeslice_config((k_timeslice_t)500u); (void)tos_task_create(&task_demo1, \"demo1\", entry_task_demo1, NULL, PRIO_TASK_DEMO, stack_task_demo1, STK_SIZE_TASK_DEMO, timeslice_demo1); (void)tos_task_create(&task_demo2, \"demo2\", entry_task_demo2, NULL, PRIO_TASK_DEMO, stack_task_demo2, STK_SIZE_TASK_DEMO, timeslice_demo2); (void)tos_task_create(&task_sample, \"sample\", entry_task_sample, NULL, PRIO_TASK_SAMPLE, stack_task_sample, STK_SIZE_TASK_SAMPLE, 0); tos_knl_start(); } \u8fd0\u884c\u6548\u679c demo1_counter: 0 demo2_counter: 1 demo2_counter / demo1_counter = 0.000000 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 demo1_counter: 1915369 demo2_counter: 3720158 demo2_counter / demo1_counter = 1.942267 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 demo1_counter: 3774985 demo2_counter: 7493508 demo2_counter / demo1_counter = 1.985043 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 demo1_counter: 5634601 demo2_counter: 11266858 demo2_counter / demo1_counter = 1.999584 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 demo1_counter: 7546896 demo2_counter: 14987015 demo2_counter / demo1_counter = 1.985852 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 demo1_counter: 9406512 demo2_counter: 18759340 demo2_counter / demo1_counter = 1.994293 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 demo1_counter: 11266128 demo2_counter: 22531664 demo2_counter / demo1_counter = 1.999947 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 demo1_counter: 13177398 demo2_counter: 26251821 demo2_counter / demo1_counter = 1.992185 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 demo1_counter: 15037014 demo2_counter: 30023632 demo2_counter / demo1_counter = 1.996649 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 demo1_counter: 16896630 demo2_counter: 33795443 demo2_counter / demo1_counter = 2.000129 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 demo1_counter: 18807900 demo2_counter: 37515600 demo2_counter / demo1_counter = 1.994672 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 \u5b9e\u4f8b\u4ee3\u7801 2.8 \u5185\u6838\u57fa\u7840\u7ec4\u4ef6 2.8.1 \u73af\u5f62\u961f\u5217 \u6982\u8ff0 \u73af\u5f62\u961f\u5217\u672c\u8d28\u4e0a\u5c31\u662f\u652f\u6301\u5148\u5165\u5148\u51fa\u64cd\u4f5c\u7684\u73af\u5f62buffer\uff0c\u662f\u7cfb\u7edf\u7684\u4e00\u4e2a\u57fa\u7840\u7ec4\u4ef6\uff0c\u901a\u5e38\u7528\u6765\u4f5c\u4e3a\u5b9e\u73b0\u4e0a\u5c42\u673a\u5236\u7684\u5e95\u5c42\u6570\u636e\u5bb9\u5668\u3002 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b 1\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_DEMO 512 #define PRIO_TASK_DEMO 4 k_stack_t stack_task_demo[STK_SIZE_TASK_DEMO]; k_task_t task_demo; typedef struct item_st { int a; int b; int c; } item_t; #define RING_QUEUE_ITEM_MAX 5 uint8_t ring_q_buffer[RING_QUEUE_ITEM_MAX * sizeof(item_t)]; k_ring_q_t rinq_q; void entry_task_demo(void *arg) { k_err_t err; int i = 0; item_t item; size_t item_size; tos_ring_q_create(&rinq_q, ring_q_buffer, RING_QUEUE_ITEM_MAX, sizeof(item_t)); for (i = 0; i < RING_QUEUE_ITEM_MAX; ++i) { printf(\"enqueue: %d %d %d\\n\", i, i, i); item.a = i; item.b = i; item.c = i; err = tos_ring_q_enqueue(&rinq_q, &item, sizeof(item_t)); if (err != K_ERR_NONE) { printf(\"should never happen\\n\"); } } err = tos_ring_q_enqueue(&rinq_q, &item, sizeof(item_t)); if (err == K_ERR_RING_Q_FULL) { printf(\"ring queue is full: %s\\n\", tos_ring_q_is_full(&rinq_q) ? \"TRUE\" : \"FALSE\"); } else { printf(\"should never happen\\n\"); } for (i = 0; i < RING_QUEUE_ITEM_MAX; ++i) { err = tos_ring_q_dequeue(&rinq_q, &item, &item_size); if (err == K_ERR_NONE) { printf(\"dequeue: %d %d %d\\n\", item.a, item.b, item.c); } else { printf(\"should never happen\\n\"); } } err = tos_ring_q_dequeue(&rinq_q, &item, &item_size); if (err == K_ERR_RING_Q_EMPTY) { printf(\"ring queue is empty: %s\\n\", tos_ring_q_is_empty(&rinq_q) ? \"TRUE\" : \"FALSE\"); } else { printf(\"should never happen\\n\"); } } int main(void) { board_init(); tos_knl_init(); (void)tos_task_create(&task_demo, \"demo\", entry_task_demo, NULL, PRIO_TASK_DEMO, stack_task_demo, STK_SIZE_TASK_DEMO, 0); tos_knl_start(); } \u8fd0\u884c\u6548\u679c enqueue: 0 0 0 enqueue: 1 1 1 enqueue: 2 2 2 enqueue: 3 3 3 enqueue: 4 4 4 ring queue is full: TRUE dequeue: 0 0 0 dequeue: 1 1 1 dequeue: 2 2 2 dequeue: 3 3 3 dequeue: 4 4 4 ring queue is empty: TRUE \u5b9e\u4f8b\u4ee3\u7801 2.8.2 \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217 \u6982\u8ff0 \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\uff0c\u63d0\u4f9b\u7684\u662f\u4e00\u4e2a\u9762\u5411\u5b57\u7b26\u64cd\u4f5c\u7684\u73af\u5f62\u961f\u5217\u5b9e\u73b0\uff0c\u63d0\u4f9b\u4e86\u57fa\u672c\u7684\u5b57\u7b26\u6d41\u5165\u961f\u51fa\u961f\u64cd\u4f5c\u3002\u672c\u8d28\u4e0a\u5c31\u662f\u73af\u5f62\u961f\u5217\u4e2d\u5143\u7d20\u4e3a\u5b57\u7b26\uff08\u5355\u5b57\u8282\u957f\u5ea6\uff09\u65f6\u7684\u7279\u4f8b\uff0c\u5b9e\u9645\u4e0a\u5b57\u7b26\u6d41\u5148\u51fa\u5148\u51fa\u961f\u5217\u5e95\u5c42\u7684\u5b9e\u73b0\u5c31\u662f\u73af\u5f62\u961f\u5217\u3002 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b 1\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_DEMO 512 #define PRIO_TASK_DEMO 4 k_stack_t stack_task_demo[STK_SIZE_TASK_DEMO]; k_task_t task_demo; #define FIFO_BUFFER_SIZE 5 uint8_t fifo_buffer[FIFO_BUFFER_SIZE]; k_chr_fifo_t fifo; extern void entry_task_demo(void *arg); void char_push(void) { k_err_t err; int i = 0; uint8_t data; // \u5f80fifo\u4e2d\u538b\u5165FIFO_BUFFER_SIZE\u4e2a\u5b57\u7b26\uff0c\u5206\u522b\u662fa\u3001b\u3001c\u3001d\u3001e for (i = 0; i < FIFO_BUFFER_SIZE; ++i) { printf(\"char pushed: %c\\n\", 'a' + i); err = tos_chr_fifo_push(&fifo, 'a' + i); if (err != K_ERR_NONE) { printf(\"should never happen\\n\"); } } // fifo\u6700\u591a\u5305\u542bFIFO_BUFFER_SIZE\u4e2a\u5b57\u7b26\uff0c\u4e0a\u6587\u903b\u8f91\u4e2d\u5df2\u7ecf\u538b\u5165\u4e86\u6700\u5927\u7684\u5b57\u7b26\u91cf\uff0c\u6b64\u65f6\u7ee7\u7eed\u538b\u5165\u5b57\u7b26\u4f1a\u8fd4\u56deK_ERR_FIFO_FULL\uff08fifo\u5df2\u6ee1\uff09 err = tos_chr_fifo_push(&fifo, 'z'); if (err == K_ERR_RING_Q_FULL) { printf(\"fifo is full: %s\\n\", tos_chr_fifo_is_full(&fifo) ? \"TRUE\" : \"FALSE\"); } else { printf(\"should never happen\\n\"); } // \u4ecefifo\u4e2d\u628a\u6240\u6709\u7684\u5b57\u7b26\u90fd\u5f39\u51fa\u6765 for (i = 0; i < FIFO_BUFFER_SIZE; ++i) { err = tos_chr_fifo_pop(&fifo, &data); if (err == K_ERR_NONE) { printf(\"%d pop: %c\\n\", i, data); } else { printf(\"should never happen\\n\"); } } // \u6b64\u65f6\u7ee7\u7eed\u5f39\u51fa\u5b57\u7b26\uff0c\u4f1a\u8fd4\u56deK_ERR_FIFO_EMPTY\uff08fifo\u5df2\u7a7a\uff09 err = tos_chr_fifo_pop(&fifo, &data); if (err == K_ERR_RING_Q_EMPTY) { printf(\"fifo is empty: %s\\n\", tos_chr_fifo_is_empty(&fifo) ? \"TRUE\" : \"FALSE\"); } else { printf(\"should never happen\\n\"); } } void stream_push(void) { int count = 0, i = 0; uint8_t stream[FIFO_BUFFER_SIZE] = { 'a', 'b', 'c', 'd', 'e' }; uint8_t stream_dummy[1] = { 'z' }; uint8_t stream_pop[FIFO_BUFFER_SIZE]; // \u538b\u5165\u5b57\u7b26\u6d41\uff0c\u5b57\u7b26\u6d41\u7684\u957f\u5ea6\u662f5\uff0c\u4e0d\u8d85\u8fc7fifo\u7684\u6700\u5927\u957f\u5ea6FIFO_BUFFER_SIZE\uff0c\u4f1a\u538b\u5165\u6210\u529f\uff0c\u5e76\u8fd4\u56de\u538b\u5165\u5b57\u7b26\u6d41\u7684\u957f\u5ea65 count = tos_chr_fifo_push_stream(&fifo, &stream[0], FIFO_BUFFER_SIZE); if (count != FIFO_BUFFER_SIZE) { printf(\"should never happen\\n\"); } // \u7ee7\u7eed\u538b\u5165\u5b57\u7b26\u6d41\uff08\u5373\u4f7f\u662f\u957f\u5ea6\u4e3a1\u7684\u5b57\u7b26\u6d41\uff09\uff0c\u56e0fifo\u5df2\u6ee1\u65e0\u6cd5\u7ee7\u7eed\u538b\u5165\uff0c\u8fd4\u56de\u957f\u5ea60\uff08\u538b\u5165\u5931\u8d25\uff09 count = tos_chr_fifo_push_stream(&fifo, &stream_dummy[0], 1); if (count == 0) { printf(\"fifo is full: %s\\n\", tos_chr_fifo_is_full(&fifo) ? \"TRUE\" : \"FALSE\"); } else { printf(\"should never happen\\n\"); } // \u5c06\u524d\u6587\u4e2d\u538b\u5165\u7684\u5b57\u7b26\u6d41\u5168\u90e8\u5f39\u51fa\uff0c\u8fd4\u56de\u524d\u6587\u538b\u5165\u7684\u5b57\u7b26\u6d41\u957f\u5ea65\uff08\u5f39\u51fa\u7684\u5b57\u7b26\u6d41\u957f\u5ea6\uff09 count = tos_chr_fifo_pop_stream(&fifo, &stream_pop[0], FIFO_BUFFER_SIZE); if (count == FIFO_BUFFER_SIZE) { printf(\"stream popped:\\n\"); for (i = 0; i < FIFO_BUFFER_SIZE; ++i) { printf(\"%c\", stream_pop[i]); } printf(\"\\n\"); } else { printf(\"should never happen\\n\"); } // \u7ee7\u7eed\u5f39\u51fa\uff0c\u56e0fifo\u5df2\u7a7a\uff0c\u8fd4\u56de0 count = tos_chr_fifo_pop_stream(&fifo, &stream_pop[0], 1); if (count == 0) { printf(\"fifo is empty: %s\\n\", tos_chr_fifo_is_empty(&fifo) ? \"TRUE\" : \"FALSE\"); } else { printf(\"should never happen\\n\"); } } void entry_task_demo(void *arg) { // \u521b\u5efa\u4e86\u4e00\u4e2a\u6700\u591a\u5305\u542bFIFO_BUFFER_SIZE\u4e2a\u5b57\u7b26\u7684fifo tos_chr_fifo_create(&fifo, &fifo_buffer[0], FIFO_BUFFER_SIZE); printf(\"fifo, dealing with char\\n\"); char_push(); printf(\"fifo, dealing with stream\\n\"); stream_push(); } int main(void) { board_init(); tos_knl_init(); (void)tos_task_create(&task_demo, \"demo\", entry_task_demo, NULL, PRIO_TASK_DEMO, stack_task_demo, STK_SIZE_TASK_DEMO, 0); tos_knl_start(); } \u8fd0\u884c\u6548\u679c fifo, dealing with char char pushed: a char pushed: b char pushed: c char pushed: d char pushed: e fifo is full: TRUE 0 pop: a 1 pop: b 2 pop: c 3 pop: d 4 pop: e fifo is empty: TRUE fifo, dealing with stream fifo is full: TRUE stream popped: abcde fifo is empty: TRUE \u5b9e\u4f8b\u4ee3\u7801 2.8.3 \u4e8c\u9879\u5806 \u6982\u8ff0 \u6b64\u7ec4\u4ef6\u7528\u6765\u5185\u90e8\u5b9e\u73b0\u4f18\u5148\u7ea7\u961f\u5217\uff0c\u4e0d\u63a8\u8350\u7528\u6237\u4f7f\u7528\u3002 2.8.4 \u4f18\u5148\u7ea7\u961f\u5217 \u6982\u8ff0 \u63d0\u4f9b\u4e86\u57fa\u4e8e\u4f18\u5148\u7ea7\u7684\u961f\u5217\u7ba1\u7406\u3002\u73af\u5f62\u961f\u5217\u7684\u5165\u961f\u51fa\u961f\u89c4\u5219\u662f\u5148\u5165\u961f\u7684\u5148\u51fa\u961f\uff08first in, first out\uff09\uff0c\u4f18\u5148\u7ea7\u961f\u5217\u7684\u51fa\u961f\u987a\u5e8f\u662f\u6309\u7167\u4f18\u5148\u7ea7\u6765\u7684\uff0c\u4f18\u5148\u7ea7\u8f83\u9ad8\u7684\u5143\u7d20\u5148\u51fa\u961f\u3002 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b 1\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a /* \u6b64\u6848\u4f8b\u5c55\u793a\u4e86\u4f18\u5148\u7ea7\u961f\u5217\u7684\u51fa\u961f\u89c4\u5219\uff1a\u4f9d\u6b21\u5165\u961f\u4f18\u5148\u7ea7\u4e3a5\u30014\u30013\u30012\u30011\u7684\u5143\u7d20\uff0c\u51fa\u961f\u65f6\u7684\u987a\u5e8f\u662f\u6309\u7167\u4f18\u5148\u7ea7\u6765\u7684\uff0c\u4e5f\u5c31\u662f\u6309\u4f18\u5148\u7ea7\u4ece\u9ad8\u5230\u4f4e\uff08\u6570\u503c\u8d8a\u5927\uff0c\u4f18\u5148\u7ea7\u8d8a\u5c0f\uff09\uff0c\u4f9d\u6b21\u51fa\u961f\u4f18\u5148\u7ea7\u4e3a1\u30012\u30013\u30014\u30015\u5143\u7d20\u3002 */ #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_DEMO 512 #define PRIO_TASK_DEMO 4 k_stack_t stack_task_demo[STK_SIZE_TASK_DEMO]; k_task_t task_demo; typedef struct item_st { int a; int b; int c; } item_t; #define PRIO_QUEUE_ITEM_MAX 5 uint8_t ring_q_buffer[PRIO_QUEUE_ITEM_MAX * sizeof(item_t)]; uint8_t mgr_pool[TOS_PRIO_Q_MGR_ARRAY_SIZE(PRIO_QUEUE_ITEM_MAX)]; k_prio_q_t prio_q; void entry_task_demo(void *arg) { k_err_t err; int i = 0; item_t item; k_prio_t prio; size_t item_size; tos_prio_q_create(&prio_q, mgr_pool, ring_q_buffer, PRIO_QUEUE_ITEM_MAX, sizeof(item_t)); for (i = PRIO_QUEUE_ITEM_MAX; i > 0; --i) { printf(\"enqueue: %d %d %d\\n\", i, i, i); item.a = i; item.b = i; item.c = i; err = tos_prio_q_enqueue(&prio_q, &item, sizeof(item_t), i); if (err != K_ERR_NONE) { printf(\"should never happen\\n\"); } } err = tos_prio_q_enqueue(&prio_q, &item, sizeof(item_t), i); if (err == K_ERR_PRIO_Q_FULL) { printf(\"priority queue is full: %s\\n\", tos_prio_q_is_full(&prio_q) ? \"TRUE\" : \"FALSE\"); } else { printf(\"should never happen\\n\"); } for (i = 0; i < PRIO_QUEUE_ITEM_MAX; ++i) { err = tos_prio_q_dequeue(&prio_q, &item, &item_size, &prio); if (err == K_ERR_NONE) { printf(\"dequeue: %d %d %d, prio: %d\\n\", item.a, item.b, item.c, prio); } else { printf(\"should never happen\\n\"); } } err = tos_prio_q_dequeue(&prio_q, &item, &item_size, &prio); if (err == K_ERR_PRIO_Q_EMPTY) { printf(\"priority queue is empty: %s\\n\", tos_prio_q_is_empty(&prio_q) ? \"TRUE\" : \"FALSE\"); } else { printf(\"should never happen\\n\"); } } int main(void) { board_init(); tos_knl_init(); (void)tos_task_create(&task_demo, \"demo\", entry_task_demo, NULL, PRIO_TASK_DEMO, stack_task_demo, STK_SIZE_TASK_DEMO, 0); tos_knl_start(); } \u8fd0\u884c\u6548\u679c enqueue: 5 5 5 enqueue: 4 4 4 enqueue: 3 3 3 enqueue: 2 2 2 enqueue: 1 1 1 priority queue is full: TRUE dequeue: 1 1 1, prio: 1 dequeue: 2 2 2, prio: 2 dequeue: 3 3 3, prio: 3 dequeue: 4 4 4, prio: 4 dequeue: 5 5 5, prio: 5 priority queue is empty: TRUE \u5b9e\u4f8b\u4ee3\u7801 2.9 \u529f\u8017\u7ba1\u7406 2.9.1 \u4f4e\u529f\u8017 \u6982\u8ff0 TencentOS tiny\u63d0\u4f9b\u4e86\u591a\u7ea7\u4f4e\u529f\u8017\u7ba1\u7406\u6846\u67b6\u3002\u521d\u7ea7\u4f4e\u529f\u8017\u7684\u65b9\u6848\u662f\uff0c\u5f53\u7cfb\u7edf\u5904\u4e8e\u201c\u7a7a\u95f2\u201d\u72b6\u6001\uff0c\u4e5f\u5373\u8fdb\u5165idle\u4efb\u52a1\u65f6\uff0c\u7cfb\u7edf\u8c03\u7528\u5904\u7406\u5668\uff08\u76ee\u524d\u652f\u6301\u7684\u67b6\u6784\u662farm v7m\uff09\u4f4e\u529f\u8017\u63a5\u53e3\u8fdb\u5165\u77ed\u6682\u7684\u7761\u7720\u6a21\u5f0f\u3002 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u5bf9\u4e8e\u521d\u7ea7\u4f4e\u529f\u8017\u6a21\u5f0f\uff0c\u65e0\u9700\u7528\u6237\u7f16\u5199\u4efb\u4f55\u4ee3\u7801\uff0c\u76f4\u63a5\u901a\u8fc7\u5728tos_config.h\u6253\u5f00TOS_CFG_PMR_MGR_EN\u5f00\u5173\u5373\u53ef\uff1a #define TOS_CFG_PWR_MGR_EN 1u \u8fd0\u884c\u6548\u679c 2.9.2 tickless \u6982\u8ff0 TencentOS tiny\u7684tickless\u673a\u5236\u63d0\u4f9b\u4e86\u4e00\u5957\u975e\u5468\u671f\u6027\u65f6\u949f\u7684\u65b9\u6848\uff0c\u5728\u7cfb\u7edf\u65e0\u9700systick\u9a71\u52a8\u8c03\u5ea6\u7684\u60c5\u51b5\u4e0b\uff0c\u505c\u6389systick\u3002 \u521d\u7ea7\u529f\u8017\u7ba1\u7406\u65b9\u6848\u4e0b\uff0c\u56e0\u4e3a\u8fd8\u6709\u7cfb\u7edfsystick\u7684\u5b58\u5728\uff0c\u56e0\u6b64\u7cfb\u7edf\u8fdb\u5165idle\u4efb\u52a1\u540e\uff0c\u5e76\u4e0d\u4f1a\u5728\u7761\u7720\u6a21\u5f0f\u4e0b\u505c\u7559\u592a\u4e45\u3002\u8981\u60f3\u8fdb\u5165\u5230\u66f4\u6781\u81f4\u7684\u4f4e\u529f\u8017\u72b6\u6001\uff0c\u9700\u8981\u6682\u505csystick\u3002 arm\u67b6\u6784\u63d0\u4f9b\u4e09\u7ea7\u4f4e\u529f\u8017\u6a21\u5f0f\uff0csleep\u3001stop\u3001standby\u6a21\u5f0f\uff0c\u4e09\u79cd\u6a21\u5f0f\u8fd0\u884c\u529f\u8017\u9010\u6b21\u964d\u4f4e\uff0cstandby\u6a21\u5f0f\u6700\u4f4e\u3002TencentOS tiny\u7684\u5185\u6838\u63d0\u4f9b\u4e86\u7b80\u6d01\u6e05\u6670\u7684\u63a5\u53e3\u6765\u7ba1\u7406\u5404\u7ea7\u6a21\u5f0f\u3002 API\u8bb2\u89e3 void tos_tickless_wkup_alarm_install(k_cpu_lpwr_mode_t mode, k_tickless_wkup_alarm_t *wkup_alarm); \u6b64\u63a5\u53e3\u7528\u4ee5\u5b89\u88c5\u5404\u4f4e\u529f\u8017\u6a21\u5f0f\u4e0b\u7684\u5524\u9192\u95f9\u949f\u3002\u5f53\u5185\u6838\u8fdb\u5165tickless\u6a21\u5f0f\u4e0b\u540e\uff0csystick\u4ee5\u53ca\u505c\u6b62\u4e86\uff0c\u56e0\u6b64\u9700\u8981\u5176\u4ed6\u8ba1\u65f6\u5668\u6765\u5c06CPU\u4ece\u4f4e\u529f\u8017\u6a21\u5f0f\u4e0b\u5524\u9192\u3002 \u6839\u636earm v7m\u7684\u82af\u7247\u89c4\u683c\uff0c\u4e09\u79cd\u6a21\u5f0f\u4e0b\u7684\u5524\u9192\u6e90\u5206\u522b\u4e3a\uff1a sleep CPU\u8fdb\u5165sleep\u6a21\u5f0f\u540e\uff0c\u53ef\u4ee5\u7531systick\u3001\u786c\u4ef6timer\u3001RTC\u65f6\u949f\u5524\u9192\uff08wakeup/alarm\u4e2d\u65ad\uff09\u3002 stop CPU\u8fdb\u5165stop\u6a21\u5f0f\u540e\uff0c\u53ef\u4ee5\u7531RTC\u65f6\u949f\uff08wakeup/alarm\u4e2d\u65ad\uff09\u5524\u9192\u3002 standby CPU\u8fdb\u5165standby\u6a21\u5f0f\u540e\uff0c\u53ea\u53ef\u7531RTC\u65f6\u949f\u7684alarm\u4e2d\u65ad\u5524\u9192\uff08\u8fd8\u53ef\u4ee5\u901a\u8fc7\u5916\u90e8\u7ba1\u811a\u5524\u9192\uff0c\u4f46\u8fd9\u4e0d\u5c5e\u4e8eTencentOS tiny\u5185\u6838\u673a\u5236\u8bbe\u8ba1\u7684\u8303\u7574\uff09\u3002 k_tickless_wkup_alarm_t\u5b9a\u4e49\u5982\u4e0b\uff1a typedef struct k_tickless_wakeup_alarm_st { int (*init)(void); int (*setup)(k_time_t millisecond); int (*dismiss)(void); k_time_t (*max_delay)(void); /* in millisecond */ } k_tickless_wkup_alarm_t; \u4e00\u4e2a\u5524\u9192\u95f9\u949f\u6709\u56db\u4e2a\u6210\u5458\u65b9\u6cd5\uff1a init \u95f9\u949f\u521d\u59cb\u5316\u51fd\u6570\u3002 setup \u95f9\u949f\u8bbe\u5b9a\u51fd\u6570\uff0c\u5165\u53c2\u4e3a\u95f9\u949f\u5230\u671f\u65f6\u95f4\uff08\u5355\u4f4d\u6beb\u79d2\uff09\u3002\u6b64\u95f9\u949f\u5728\u8bbe\u5b9a\u5b8c\u6bd5\u540e\u7684millisecond\u6beb\u79d2\u65f6\u6765\u4e2d\u65ad\u3002 dismiss \u95f9\u949f\u89e3\u9664\u51fd\u6570\uff0c\u6267\u884c\u5b8c\u540e\u95f9\u949f\u4e2d\u65ad\u4e0d\u4f1a\u518d\u6765\u3002 max_delay \u6b64\u95f9\u949f\u6700\u957f\u7684\u5230\u671f\u65f6\u95f4\uff08\u5355\u4f4d\u4e3a\u6beb\u79d2\uff09\u3002 k_err_t tos_tickless_wkup_alarm_init(k_cpu_lpwr_mode_t mode); \u6b64\u51fd\u6570\u7528\u6765\u521d\u59cb\u5316\u7279\u5b9a\u6a21\u5f0f\u4e0b\u7684\u5524\u9192\u95f9\u949f\uff08\u5b9e\u9645\u4e0a\u8c03\u7528\u7684\u662ftos_tickless_wkup_alarm_install\u63a5\u53e3\u4e2d\u5b89\u88c5\u7684k_tickless_wkup_alarm_t\u7684init\u65b9\u6cd5\uff09\u3002 k_err_t tos_pm_cpu_lpwr_mode_set(k_cpu_lpwr_mode_t cpu_lpwr_mode); \u8bbe\u7f6e\u5185\u6838\u5728tickless\u6a21\u5f0f\u4e0b\u8fdb\u5165\u7684CPU\u4f4e\u529f\u8017\u6a21\u5f0f\u3002 \u7f16\u7a0b\u5b9e\u4f8b 1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u4f4e\u529f\u8017\u7ec4\u4ef6\u5f00\u5173TOS_CFG_PWR_MGR_EN\uff1a #define TOS_CFG_PWR_MGR_EN 1u 2\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6etickless\u7ec4\u4ef6\u5f00\u5173TOS_CFG_TICKLESS_EN\uff1a #define TOS_CFG_TICKLESS_EN 1u 3\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_DEMO 512 #define PRIO_TASK_DEMO 4 k_stack_t stack_task_demo[STK_SIZE_TASK_DEMO]; k_task_t task_demo; extern void entry_task_demo(void *arg); void timer_callback(void *arg) { printf(\"timer callback: %lld\\n\", tos_systick_get()); } void entry_task_demo(void *arg) { k_timer_t tmr; // \u521b\u5efa\u4e00\u4e2a\u8f6f\u4ef6\u5b9a\u65f6\u5668\uff0c\u6bcf6000\u4e2atick\u89e6\u53d1\u4e00\u6b21 tos_timer_create(&tmr, 0u, 6000u, timer_callback, K_NULL, TOS_OPT_TIMER_PERIODIC); tos_timer_start(&tmr); // \u6b64\u4efb\u52a1\u4f53\u5185\u6bcf3000\u4e2atick\u8fd0\u884c\u4e00\u6b21 while (K_TRUE) { printf(\"entry task demo: %lld\\n\", tos_systick_get()); tos_task_delay(3000); } } int main(void) { board_init(); tos_knl_init(); (void)tos_task_create(&task_demo, \"demo1\", entry_task_demo, NULL, PRIO_TASK_DEMO, stack_task_demo, STK_SIZE_TASK_DEMO, 0); tos_knl_start(); } 4\u3001\u5b9e\u73b0tos_bsp_tickless_setup\u56de\u8c03\uff08\u53c2\u8003board\\TOS_tiny_EVK_STM32L431CBT6\\BSP\\Src\\tickless\\bsp_pwr_mgr.c\u3001board\\TOS_tiny_EVK_STM32L431CBT6\\BSP\\Src\\tickless\\bsp_tickless_alarm.c\uff09\uff1a #include \"tos_k.h\" #include \"tickless/bsp_pm_device.h\" #include \"tickless/bsp_tickless_alarm.h\" int tos_bsp_tickless_setup(void) { #if TOS_CFG_TICKLESS_EN > 0u // sleep\u6a21\u5f0f\u4e0b\u7684\u5524\u9192\u6e90\uff0c\u57fa\u672c\u5b9a\u65f6\u5668 tos_tickless_wkup_alarm_install(TOS_LOW_POWER_MODE_SLEEP, &tickless_wkup_alarm_tim); // \u521d\u59cb\u5316\u5524\u9192\u6e90\u95f9\u949f tos_tickless_wkup_alarm_init(TOS_LOW_POWER_MODE_SLEEP); // \u8bbe\u7f6etickless\u72b6\u6001\u65f6\u8fdb\u5165sleep\u6a21\u5f0f tos_pm_cpu_lpwr_mode_set(TOS_LOW_POWER_MODE_SLEEP); #endif } 5\u3001\u4e3a\u4e86\u89c2\u5bdf\u5728tickless\u65f6\u662f\u5426\u786e\u5b9e\u6ca1\u6709systick\u4e2d\u65ad\uff0c\u5728tos_sys.c\u7684idle\u4efb\u52a1\u4f53\u5185\u52a0\u4e00\u53e5\u8c03\u8bd5\u4ee3\u7801\uff1a __STATIC__ void knl_idle_entry(void *arg) { arg = arg; // make compiler happy while (K_TRUE) { // \u8fd9\u91cc\u5728idle\u4efb\u52a1\u4f53\u5185\u52a0\u4e0a\u4e00\u53e5\u6253\u5370\uff0c\u5982\u679csystick\u6b63\u5e38\u5f00\u542f\uff0c\u5728\u6ca1\u6709\u7528\u6237\u4efb\u52a1\u8fd0\u884c\u65f6\uff0c\u6b64\u8c03\u8bd5\u4fe1\u606f\u4f1a\u4e0d\u65ad\u6253\u5370\uff1b\u5982\u679c\u662ftickless\u72b6\u6001\uff0c\u6b64\u8c03\u8bd5\u4fe1\u606f\u5e94\u8be5\u53ea\u4f1a\u7b2c\u4e00\u6b21\u8fdb\u5165idle\u4efb\u52a1\u65f6\uff0c\u6216\u5728\u7528\u6237\u4efb\u52a1\u7b49\u5f85\u5230\u671f\uff0c\u6216\u7528\u6237\u7684\u8f6f\u4ef6\u5b9a\u65f6\u5668\u5230\u671f\u65f6\uff0c\u624d\u6253\u5370\u4e00\u6b21\u3002 printf(\"idle entry: %lld\\n\", tos_systick_get()); #if TOS_CFG_PWR_MGR_EN > 0u pm_power_manager(); #endif } } \u8fd0\u884c\u6548\u679c entry task demo: 0 idle entry: 2 entry task demo: 3002 idle entry: 3002 timer callback: 6000 idle entry: 6000 entry task demo: 6002 idle entry: 6002 entry task demo: 9002 idle entry: 9002 timer callback: 12000 idle entry: 12000 entry task demo: 12002 idle entry: 12002 entry task demo: 15002 idle entry: 15002 timer callback: 18000 idle entry: 18000 entry task demo: 18002 idle entry: 18002","title":"04.Development_Manual"},{"location":"04.Development_Manual/#tencentos-tiny","text":"\u76ee\u5f55 TencentOS tiny\u5f00\u53d1\u6307\u5357 1. \u6982\u8ff0 1.1 \u57fa\u7840\u5185\u6838\u7ec4\u4ef6 2. \u57fa\u7840\u5185\u6838 2.1 \u7cfb\u7edf\u7ba1\u7406 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.2 \u4efb\u52a1\u7ba1\u7406 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.3 \u4efb\u52a1\u95f4\u901a\u4fe1 2.3.1 \u4e92\u65a5\u91cf \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.3.2 \u4fe1\u53f7\u91cf \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.3.3 \u4e8b\u4ef6 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.3.4 \u5b8c\u6210\u91cf \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.3.5 \u8ba1\u6570\u9501 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.3.6 \u6805\u680f \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.3.7 \u6d88\u606f\u961f\u5217 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.3.8 \u90ae\u7bb1\u961f\u5217 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.3.9 \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.3.10 \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.4 \u5185\u5b58\u7ba1\u7406 2.4.1 \u52a8\u6001\u5185\u5b58 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.4.2 \u9759\u6001\u5185\u5b58 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.5 \u65f6\u95f4\u7ba1\u7406 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.6 \u8f6f\u4ef6\u5b9a\u65f6\u5668 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.7 \u65f6\u95f4\u7247\u8f6e\u8f6c\u673a\u5236 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.8 \u5185\u6838\u57fa\u7840\u7ec4\u4ef6 2.8.1 \u73af\u5f62\u961f\u5217 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.8.2 \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.8.3 \u4e8c\u9879\u5806 \u6982\u8ff0 2.8.4 \u4f18\u5148\u7ea7\u961f\u5217 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.9 \u529f\u8017\u7ba1\u7406 2.9.1 \u4f4e\u529f\u8017 \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c 2.9.2 tickless \u6982\u8ff0 API\u8bb2\u89e3 \u7f16\u7a0b\u5b9e\u4f8b \u8fd0\u884c\u6548\u679c","title":"TencentOS tiny\u5f00\u53d1\u6307\u5357"},{"location":"04.Development_Manual/#1","text":"TencentOS tiny\u662f\u9762\u5411\u7269\u8054\u7f51\uff08IOT\uff09\u9886\u57df\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0c\u7531\u4e00\u4e2a\u5b9e\u73b0\u7cbe\u7b80\u7684\u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf\uff08RTOS\uff09\u5185\u6838\uff0c\u4ee5\u53ca\u4e30\u5bcc\u7684\u7269\u8054\u7f51\u7ec4\u4ef6\u7ec4\u6210\u3002","title":"1. \u6982\u8ff0"},{"location":"04.Development_Manual/#11","text":"\u7cfb\u7edf\u7ba1\u7406 \u7cfb\u7edf\u7ba1\u7406\u6a21\u5757\uff0c\u4e3b\u8981\u63d0\u4f9b\u4e86\u5185\u6838\u7684\u521d\u59cb\u5316\u3001\u5185\u6838\u8fd0\u884c\u542f\u52a8\uff0c\u4e2d\u65ad\u8fdb\u5165/\u9000\u51fa\u6d41\u7a0b\u6258\u7ba1\u3001\u7cfb\u7edf\u8c03\u5ea6\u9501\u5b9a\u53ca\u89e3\u9501\u7b49\u529f\u80fd\u3002 \u4efb\u52a1\u7ba1\u7406 \u63d0\u4f9b\u4e86\u4efb\u52a1\u7684\u521b\u5efa\u3001\u5220\u9664\u3001\u7761\u7720\u3001\u53d6\u6d88\u7761\u7720\u3001\u6302\u8d77\u3001\u6062\u590d\u3001\u4f18\u5148\u7ea7\u4fee\u6539\u3001\u4e3b\u52a8\u653e\u5f03CPU\u7b49\u529f\u80fd\u3002 \u4efb\u52a1\u95f4\u901a\u4fe1 \u63d0\u4f9b\u4e92\u65a5\u91cf\u3001\u4fe1\u53f7\u91cf\u3001\u961f\u5217\u3001\u4e8b\u4ef6\u7b49\u5e38\u7528\u4efb\u52a1\u95f4\u901a\u4fe1\u673a\u5236\u3002 \u5185\u5b58\u7ba1\u7406 \u63d0\u4f9b\u4e86\u57fa\u4e8e\u5806\u7684\u52a8\u6001\u5185\u5b58\u7ba1\u7406\uff0c\u4ee5\u53ca\u9759\u6001\u5185\u5b58\u5757\u7ba1\u7406\u673a\u5236\u3002 \u65f6\u95f4\u7ba1\u7406 \u63d0\u4f9b\u4e86\u83b7\u53d6/\u8bbe\u7f6e\u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570\u3001\u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570\u4e0e\u5899\u4e0a\u65f6\u949f\u65f6\u95f4\u8f6c\u6362\u3001\u57fa\u4e8e\u5899\u4e0a\u65f6\u949f\u65f6\u95f4\u7684\u4efb\u52a1\u7761\u7720\u7b49\u673a\u5236\u3002 \u8f6f\u4ef6\u5b9a\u65f6\u5668 \u63d0\u4f9b\u4e86\u8f6f\u4ef6\u5b9a\u65f6\u5668\u7684\u521b\u5efa\u3001\u5220\u9664\u3001\u542f\u52a8\u3001\u505c\u6b62\u7b49\u673a\u5236\u3002 \u65f6\u95f4\u7247\u8f6e\u8f6c\u673a\u5236 TencentOS tiny\u5185\u6838\u5728\u63d0\u4f9b\u53ef\u62a2\u5360\u5f0f\u8c03\u5ea6\u5185\u6838\u57fa\u7840\u4e0a\uff0c\u8fd8\u63d0\u4f9b\u4e86\u6309\u65f6\u95f4\u7247\u8f6e\u8f6c\u7684robin\u673a\u5236\u3002 \u5185\u6838\u57fa\u7840\u7ec4\u4ef6 \u63d0\u4f9b\u4e86\u6d88\u606f\u961f\u5217\u3001\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u7b49\u673a\u5236\u3002 \u529f\u8017\u7ba1\u7406 \u63d0\u4f9b\u4e86CPU\u4f4e\u529f\u8017\u8fd0\u884c\u6a21\u5f0f\u8bbe\u7f6e\u3001\u4f4e\u529f\u8017\u8bbe\u5907\u6ce8\u518c\u3001\u677f\u7ea7\u5524\u9192\u95f9\u949f\u8bbe\u7f6e\u7b49\u673a\u5236\u3002","title":"1.1 \u57fa\u7840\u5185\u6838\u7ec4\u4ef6"},{"location":"04.Development_Manual/#2","text":"","title":"2. \u57fa\u7840\u5185\u6838"},{"location":"04.Development_Manual/#21","text":"","title":"2.1 \u7cfb\u7edf\u7ba1\u7406"},{"location":"04.Development_Manual/#_1","text":"\u7cfb\u7edf\u7ba1\u7406\u6a21\u5757\u63d0\u4f9b\u4e86\u51e0\u4e2a\u63a5\u53e3\uff0c\u7528\u4ee5\u521d\u59cb\u5316/\u542f\u52a8TencentOS tiny\u5185\u6838\u3001\u9501\u5b9a/\u89e3\u9501\u7cfb\u7edf\u8c03\u5ea6\u7b49\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api","text":"k_err_t tos_knl_init(void); \u521d\u59cb\u5316\u5185\u6838\u3002 k_err_t tos_knl_start(void); \u542f\u52a8\u8fd0\u884c\u5185\u6838\uff0c\u5f00\u59cb\u7b2c\u4e00\u4e2a\u4efb\u52a1\u8c03\u5ea6\u3002 int tos_knl_is_running(void); \u5224\u65ad\u5185\u6838\u662f\u5426\u5df2\u542f\u52a8\u8fd0\u884c\u3002 void tos_knl_irq_enter(void); \u6b64\u51fd\u6570\u5e94\u8be5\u5728\u4e2d\u65ad\u8c03\u7528\u51fd\u6570\u7684\u6700\u524d\u7aef\u88ab\u8c03\u7528\u3002 void tos_knl_irq_leave(void); \u6b64\u51fd\u6570\u5e94\u8be5\u5728\u4e2d\u65ad\u8c03\u7528\u51fd\u6570\u7684\u5c3e\u7aef\u88ab\u8c03\u7528\u3002 k_err_t tos_knl_sched_lock(void); \u9501\u5b9a\u7cfb\u7edf\u8c03\u5ea6\uff0c\u6b64\u51fd\u6570\u88ab\u8c03\u7528\u5e76\u8fd4\u56deK_ERR_NONE\u65f6\uff0c\u7cfb\u7edf\u8c03\u5ea6\u4f1a\u88ab\u9501\u5b9a\uff0c\u7cfb\u7edf\u8c03\u5ea6\u5668\u4e0d\u518d\u8fdb\u884c\u4efb\u52a1\u7684\u5207\u6362\u3002 k_err_t tos_knl_sched_unlock(void); \u89e3\u9501\u7cfb\u7edf\u8c03\u5ea6\uff0c\u5141\u8bb8\u4efb\u52a1\u5207\u6362\u3002","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_2","text":"","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_3","text":"","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#22","text":"","title":"2.2 \u4efb\u52a1\u7ba1\u7406"},{"location":"04.Development_Manual/#_4","text":"TencentOS tiny\u5185\u6838\u662f\u5355\u5730\u5740\u7a7a\u95f4\u7684\u53ef\u62a2\u5360\u5f0f\u5b9e\u65f6\u5185\u6838\uff0cTencentOS tiny\u5185\u6838\u4e0d\u63d0\u4f9b\u8fdb\u7a0b\u6a21\u578b\uff0c\u4efb\u52a1\u5bf9\u5e94\u7ebf\u7a0b\u7684\u6982\u5ff5\uff0c\u662f\u6700\u5c0f\u7684\u8c03\u5ea6\u8fd0\u884c\u4f53\uff0c\u4e5f\u662f\u6700\u5c0f\u7684\u8d44\u6e90\u6301\u6709\u5355\u4f4d\u3002 \u4efb\u52a1\u7684\u672c\u8d28\u662f\u4e00\u4e2a\u62e5\u6709\u72ec\u7acb\u6808\u7a7a\u95f4\u7684\u53ef\u8c03\u5ea6\u8fd0\u884c\u5b9e\u4f53\uff0c\u7528\u6237\u53ef\u4ee5\u5728\u4efb\u52a1\u7684\u5165\u53e3\u51fd\u6570\u4e2d\u7f16\u5199\u81ea\u5df1\u7684\u4e1a\u52a1\u903b\u8f91\uff1b\u591a\u4e2a\u4efb\u52a1\u4e4b\u95f4\u53ef\u4ee5\u901a\u8fc7\u7cfb\u7edf\u63d0\u4f9b\u7684\u4efb\u52a1\u95f4\u901a\u4fe1\u673a\u5236\u8fdb\u884c\u540c\u6b65\u6216\u8005\u4fe1\u606f\u4f20\u9012\u7b49\u64cd\u4f5c\uff1b\u6bcf\u4e2a\u4efb\u52a1\u90fd\u6709\u4f18\u5148\u7ea7\uff0c\u9ad8\u4f18\u5148\u7ea7\u4efb\u52a1\u53ef\u4ee5\u62a2\u5360\u4f4e\u4f18\u5148\u7ea7\u4efb\u52a1\u7684\u8fd0\u884c\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_1","text":"\u521b\u5efa\u4efb\u52a1\u7684\u7cfb\u7edfapi\u63a5\u53e3\u4e3atos_task_create\uff0c\u63a5\u53e3\u539f\u578b\u5982\u4e0b\uff1a k_err_t tos_task_create(k_task_t *task, char *name, k_task_entry_t entry, void *arg, k_prio_t prio, k_stack_t *stk_base, size_t stk_size, k_timeslice_t timeslice); \u8fd9\u91cc\u8be6\u7ec6\u8bb2\u89e3\u6b64api\u53c2\u6570\u610f\u4e49\uff1a task \u8fd9\u662f\u4e00\u4e2ak_task_t\u7c7b\u578b\u7684\u6307\u9488\uff0ck_task_t\u662f\u5185\u6838\u7684\u4efb\u52a1\u7ed3\u6784\u4f53\u7c7b\u578b\u3002\u6ce8\u610f\uff1atask\u6307\u9488\uff0c\u5e94\u8be5\u6307\u5411\u751f\u547d\u5468\u671f\u5927\u4e8e\u5f85\u521b\u5efa\u4efb\u52a1\u4f53\u751f\u547d\u5468\u671f\u7684k_task_t\u7c7b\u578b\u53d8\u91cf\uff0c\u5982\u679c\u8be5\u6307\u9488\u6307\u5411\u7684\u53d8\u91cf\u751f\u547d\u5468\u671f\u6bd4\u5f85\u521b\u5efa\u7684\u4efb\u52a1\u4f53\u751f\u547d\u5468\u671f\u77ed\uff0c\u8b6c\u5982\u53ef\u80fd\u662f\u4e00\u4e2a\u751f\u547d\u5468\u671f\u6781\u7aef\u7684\u51fd\u6570\u6808\u4e0a\u53d8\u91cf\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u4efb\u52a1\u4f53\u8fd8\u5728\u8fd0\u884c\u800ck_task_t\u53d8\u91cf\u5df2\u88ab\u9500\u6bc1\uff0c\u4f1a\u5bfc\u81f4\u7cfb\u7edf\u8c03\u5ea6\u51fa\u73b0\u4e0d\u53ef\u9884\u77e5\u95ee\u9898\u3002 name \u6307\u5411\u4efb\u52a1\u540d\u5b57\u7b26\u4e32\u7684\u6307\u9488\u3002\u6ce8\u610f\uff1a\u540ctask\uff0c\u8be5\u6307\u9488\u6307\u5411\u7684\u5b57\u7b26\u4e32\u751f\u547d\u5468\u671f\u5e94\u8be5\u5927\u4e8e\u5f85\u521b\u5efa\u7684\u4efb\u52a1\u4f53\u751f\u547d\u5468\u671f\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u4f20\u5165\u5b57\u7b26\u4e32\u5e38\u91cf\u6307\u9488\u5373\u53ef\u3002 entry \u4efb\u52a1\u4f53\u8fd0\u884c\u7684\u51fd\u6570\u5165\u53e3\u3002\u5f53\u4efb\u52a1\u521b\u5efa\u5b8c\u6bd5\u8fdb\u5165\u8fd0\u884c\u72b6\u6001\u540e\uff0centry\u662f\u4efb\u52a1\u6267\u884c\u7684\u5165\u53e3\uff0c\u7528\u6237\u53ef\u4ee5\u5728\u6b64\u51fd\u6570\u4e2d\u7f16\u5199\u4e1a\u52a1\u903b\u8f91\u3002 arg \u4f20\u9012\u7ed9\u4efb\u52a1\u5165\u53e3\u51fd\u6570\u7684\u53c2\u6570\u3002 prio \u4efb\u52a1\u4f18\u5148\u7ea7\u3002prio\u7684\u6570\u503c\u8d8a\u5c0f\uff0c\u4f18\u5148\u7ea7\u8d8a\u9ad8\u3002\u7528\u6237\u53ef\u4ee5\u5728tos_config.h\u4e2d\uff0c\u901a\u8fc7TOS_CFG_TASK_PRIO_MAX\u6765\u914d\u7f6e\u4efb\u52a1\u4f18\u5148\u7ea7\u7684\u6700\u5927\u6570\u503c\uff0c\u5728\u5185\u6838\u7684\u5b9e\u73b0\u4e2d\uff0cidle\u4efb\u52a1\u7684\u4f18\u5148\u7ea7\u4f1a\u88ab\u5206\u914d\u4e3aTOS_CFG_TASK_PRIO_MAX - 1,\u6b64\u4f18\u5148\u7ea7\u53ea\u80fd\u88abidle\u4efb\u52a1\u4f7f\u7528\u3002\u56e0\u6b64\u5bf9\u4e8e\u4e00\u4e2a\u7528\u6237\u521b\u5efa\u7684\u4efb\u52a1\u6765\u8bf4\uff0c\u5408\u7406\u7684\u4f18\u5148\u7ea7\u8303\u56f4\u5e94\u8be5\u4e3a[0, TOS_CFG_TASK_PRIO_MAX - 2]\u3002\u53e6\u5916TOS_CFG_TASK_PRIO_MAX\u7684\u914d\u7f6e\u503c\u5fc5\u9700\u5927\u4e8e\u7b49\u4e8e8\u3002 stk_base \u4efb\u52a1\u5728\u8fd0\u884c\u65f6\u4f7f\u7528\u7684\u6808\u7a7a\u95f4\u7684\u8d77\u59cb\u5730\u5740\u3002\u6ce8\u610f\uff1a\u540ctask\uff0c\u8be5\u6307\u9488\u6307\u5411\u7684\u5185\u5b58\u7a7a\u95f4\u7684\u751f\u547d\u5468\u671f\u5e94\u8be5\u5927\u4e8e\u5f85\u521b\u5efa\u7684\u4efb\u52a1\u4f53\u751f\u547d\u5468\u671f\u3002stk_base\u662fk_stack_t\u7c7b\u578b\u7684\u6570\u7ec4\u8d77\u59cb\u5730\u5740\u3002 stk_size \u4efb\u52a1\u7684\u6808\u7a7a\u95f4\u5927\u5c0f\u3002\u6ce8\u610f\uff1a\u56e0\u4e3astk_base\u662fk_stack_t\u7c7b\u578b\u7684\u6570\u7ec4\u6307\u9488\uff0c\u56e0\u6b64\u5b9e\u9645\u6808\u7a7a\u95f4\u6240\u5360\u5185\u5b58\u5927\u5c0f\u4e3astk_size * sizeof(k_stack_t)\u3002 timeslice \u65f6\u95f4\u7247\u8f6e\u8f6c\u673a\u5236\u4e0b\u5f53\u524d\u4efb\u52a1\u7684\u65f6\u95f4\u7247\u5927\u5c0f\u3002\u5f53timeslice\u4e3a0\u65f6\uff0c\u4efb\u52a1\u8c03\u5ea6\u65f6\u95f4\u7247\u4f1a\u88ab\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u5927\u5c0f\uff08TOS_CFG_CPU_TICK_PER_SECOND / 10\uff09\uff0c\u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\uff08systick\uff09\u6570 / 10\u3002","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_5","text":"1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u6700\u5927\u4efb\u52a1\u4f18\u5148\u7ea7TOS_CFG_TASK_PRIO_MAX\uff1a #define TOS_CFG_TASK_PRIO_MAX 10u 2\u3001\u914d\u7f6e\u6bcf\u79d2\u949f\u7684\u7cfb\u7edf\u6ef4\u7b54\u6570TOS_CFG_CPU_TICK_PER_SECOND\uff1a #define TOS_CFG_CPU_TICK_PER_SECOND 1000u 3\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" // \u6dfb\u52a0TencentOS tiny\u5185\u6838\u63a5\u53e3\u5934\u6587\u4ef6 #include \"mcu_init.h\" // \u5305\u542bmcu\u521d\u59cb\u5316\u5934\u6587\u4ef6\uff0c\u91cc\u9762\u6709board_init\u7b49\u677f\u7ea7\u542f\u52a8\u4ee3\u7801\u51fd\u6570\u539f\u578b\u58f0\u660e #define STK_SIZE_TASK_PRIO4 512 // \u4f18\u5148\u7ea7\u4e3a4\u7684\u4efb\u52a1\u6808\u5927\u5c0f\u4e3a512 #define STK_SIZE_TASK_PRIO5 1024 // \u4f18\u5148\u7ea7\u4e3a5\u7684\u4efb\u52a1\u6808\u5927\u5c0f\u4e3a1024 k_stack_t stack_task_prio4[STK_SIZE_TASK_PRIO4]; // \u4f18\u5148\u7ea7\u4e3a4\u7684\u4efb\u52a1\u6808\u7a7a\u95f4 k_stack_t stack_task_prio5[STK_SIZE_TASK_PRIO5]; // \u4f18\u5148\u7ea7\u4e3a5\u7684\u4efb\u52a1\u6808\u7a7a\u95f4 k_task_t task_prio4; // \u4f18\u5148\u7ea7\u4e3a4\u7684\u4efb\u52a1\u4f53 k_task_t task_prio5; // \u4f18\u5148\u7ea7\u4e3a5\u7684\u4efb\u52a1\u4f53 extern void entry_task_prio4(void *arg); // \u4f18\u5148\u7ea7\u4e3a4\u7684\u4efb\u52a1\u4f53\u5165\u53e3\u51fd\u6570 extern void entry_task_prio5(void *arg); // \u4f18\u5148\u7ea7\u4e3a5\u7684\u4efb\u52a1\u4f53\u5165\u53e3\u51fd\u6570 uint32_t arg_task_prio4_array[3] = { // \u4f18\u5148\u7ea7\u4e3a4\u7684\u4efb\u52a1\u4f53\u5165\u53e3\u51fd\u6570\u5165\u53c2 1, 2, 3, }; char *arg_task_prio5_string = \"arg for task_prio5\"; // \u4f18\u5148\u7ea7\u4e3a5\u7684\u4efb\u52a1\u4f53\u5165\u53e3\u51fd\u6570\u5165\u53c2 static void dump_uint32_array(uint32_t *array, size_t len) { size_t i = 0; for (i = 0; i < len; ++i) { printf(\"%d\\t\", array[i]); } printf(\"\\n\\n\"); } void entry_task_prio4(void *arg) { uint32_t *array_from_main = (uint32_t *)arg; // \u6355\u83b7\u8c03\u7528\u8005\u4f20\u5165\u7684\u53c2\u6570 printf(\"array from main:\\n\"); dump_uint32_array(array_from_main, 3); // dump\u4f20\u5165\u7684\u53c2\u6570\uff08\u6570\u7ec4\uff09 while (K_TRUE) { printf(\"task_prio4 body\\n\"); // \u4efb\u52a1\u8fd0\u884c\u4f53\uff0c\u4e0d\u65ad\u6253\u5370\u8fd9\u6761\u4fe1\u606f tos_task_delay(1000); // \u7761\u77201000\u4e2a\u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\uff08\u4ee5\u4e0b\u8bb0\u4f5csystick\uff09\uff0c\u56e0\u4e3aTOS_CFG_CPU_TICK_PER_SECOND\u4e3a1000\uff0c\u4e5f\u5c31\u662f\u4e00\u79d2\u949f\u4f1a\u67091000\u4e2asystick\uff0c\u56e0\u6b64\u7761\u77201000\u4e2asystick\u5c31\u662f\u7761\u7720\u4e861\u79d2\u3002 } } void entry_task_prio5(void *arg) { int i = 0; char *string_from_main = (char *)arg; printf(\"string from main:\\n\"); printf(\"%s\\n\\n\", string_from_main); // \u6253\u5370\u51fa\u8c03\u7528\u8005\u4f20\u5165\u7684\u5b57\u7b26\u4e32\u53c2\u6570 while (K_TRUE) { if (i == 2) { printf(\"i = %d\\n\", i); // i\u4e3a2\u65f6\uff0c\u6302\u8d77task_prio4\uff0ctask_prio4\u505c\u6b62\u8fd0\u884c tos_task_suspend(&task_prio4); } else if (i == 4) { printf(\"i = %d\\n\", i); // i\u4e3a4\u65f6\uff0c\u6062\u590dtask_prio4\u7684\u8fd0\u884c tos_task_resume(&task_prio4); } else if (i == 6) { printf(\"i = %d\\n\", i); // i\u4e3a6\u65f6\uff0c\u5220\u9664task_prio4\uff0ctask_prio4\u4e0d\u518d\u8fd0\u884c tos_task_destroy(&task_prio4); } printf(\"task_prio5 body\\n\"); tos_task_delay(1000); ++i; } } int main(void) { board_init(); // \u6267\u884c\u677f\u7ea7\u521d\u59cb\u5316\u4ee3\u7801\uff0c\u521d\u59cb\u5316\u4e32\u53e3\u7b49\u5916\u8bbe\u3002 tos_knl_init(); // \u521d\u59cb\u5316TencentOS tiny\u5185\u6838 // \u521b\u5efa\u4e00\u4e2a\u4f18\u5148\u7ea7\u4e3a4\u7684\u4efb\u52a1 (void)tos_task_create(&task_prio4, \"task_prio4\", entry_task_prio4, (void *)(&arg_task_prio4_array[0]), 4, stack_task_prio4, STK_SIZE_TASK_PRIO4, 0); // \u521b\u5efa\u4e00\u4e2a\u4f18\u5148\u7ea7\u4e3a5\u7684\u4efb\u52a1 (void)tos_task_create(&task_prio5, \"task_prio5\", entry_task_prio5, (void *)arg_task_prio5_string, 5, stack_task_prio5, STK_SIZE_TASK_PRIO5, 0); // \u5f00\u59cb\u5185\u6838\u8c03\u5ea6 tos_knl_start(); }","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_6","text":"array from main: 1 2 3 task_prio4 body string from main: arg for task_prio5 task_prio5 body task_prio4 body task_prio5 body task_prio4 body i = 2 task_prio5 body task_prio5 body i = 4 task_prio4 body task_prio5 body task_prio4 body task_prio5 body task_prio4 body i = 6 task_prio5 body task_prio5 body task_prio5 body task_prio5 body task_prio5 body task_prio5 body task_prio5 body \u5b9e\u4f8b\u4ee3\u7801","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#23","text":"","title":"2.3 \u4efb\u52a1\u95f4\u901a\u4fe1"},{"location":"04.Development_Manual/#231","text":"","title":"2.3.1 \u4e92\u65a5\u91cf"},{"location":"04.Development_Manual/#_7","text":"\u4e92\u65a5\u91cf\u53c8\u79f0\u4e92\u65a5\u9501\uff0c\u4e00\u822c\u7528\u4e8e\u5171\u4eab\u8d44\u6e90\u7684\u4e92\u65a5\u6392\u4ed6\u6027\u8bbf\u95ee\u4fdd\u62a4\u3002 \u4e92\u65a5\u91cf\u5728\u4efb\u610f\u65f6\u523b\u5904\u4e8e\u4e14\u4ec5\u4f1a\u5904\u4e8e\u89e3\u9501\u6216\u9501\u5b9a\u72b6\u6001\uff0c\u5f53\u4e00\u4e2a\u4efb\u52a1\u83b7\u53d6\u5230\u4e00\u628a\u9501\u540e\uff08\u4e92\u65a5\u91cf\u9501\u5b9a\uff09\uff0c\u5176\u4ed6\u4efb\u52a1\u518d\u5c1d\u8bd5\u83b7\u5f97\u8fd9\u628a\u9501\u65f6\u4f1a\u5931\u8d25\u6216\u8fdb\u5165\u963b\u585e\u72b6\u6001\uff0c\u5f53\u8be5\u4efb\u52a1\u91ca\u653e\u6301\u6709\u7684\u9501\u65f6\uff08\u4e92\u65a5\u91cf\u89e3\u9501\uff09\uff0c\u4f1a\u5524\u9192\u4e00\u4e2a\u6b63\u963b\u585e\u7b49\u5f85\u6b64\u4e92\u65a5\u91cf\u7684\u4efb\u52a1\uff0c\u88ab\u5524\u9192\u7684\u4efb\u52a1\u5c06\u4f1a\u83b7\u53d6\u8fd9\u628a\u9501\u3002 \u5728\u591a\u4efb\u52a1\u8fd0\u884c\u73af\u5883\u4e2d\uff0c\u6709\u4e9b\u5171\u4eab\u8d44\u6e90\u4e0d\u5177\u6709\u591a\u7ebf\u7a0b\u53ef\u91cd\u5165\u6027\uff0c\u5bf9\u4e8e\u8fd9\u7c7b\u4e0d\u5e0c\u671b\u88ab\u591a\u4efb\u52a1\u540c\u65f6\u8bbf\u95ee\u7684\u8d44\u6e90\uff08\u4e34\u754c\u8d44\u6e90\uff09\uff0c\u53ef\u4ee5\u91c7\u7528\u4e92\u65a5\u91cf\u6765\u8fdb\u884c\u4fdd\u62a4\uff0c\u540e\u9762\u7684\u7f16\u7a0b\u5b9e\u4f8b\u7ae0\u8282\u4f1a\u6f14\u793a\u8fd9\u4e00\u7f16\u7a0b\u8303\u5f0f\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_2","text":"","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_8","text":"1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u4e92\u65a5\u91cf\u7ec4\u4ef6\u5f00\u5173TOS_CFG_MUTEX_EN\uff1a #define TOS_CFG_MUTEX_EN 1u 2\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_WRITER 512 #define STK_SIZE_TASK_READER 512 k_stack_t stack_task_writer[STK_SIZE_TASK_WRITER]; k_stack_t stack_task_reader[STK_SIZE_TASK_READER]; k_task_t task_writer; k_task_t task_reader; extern void entry_task_writer(void *arg); extern void entry_task_reader(void *arg); k_mutex_t critical_resource_locker; // \u4e00\u7247\u4e34\u754c\u533a\u5185\u5b58 static uint32_t critical_resource[3]; static void write_critical_resource(int salt) { size_t i = 0; // \u6b64\u51fd\u6570\u6bcf\u6b21\u5411\u5171\u4eab\u5185\u5b58\u4e2d\u6309\u9012\u589e\u987a\u5e8f\u5199\u5165\u4e09\u4e2a\u65e0\u7b26\u53f7\u6574\u6570 printf(\"writting critical resource:\\n\"); for (i = 0; i < 3; ++i) { printf(\"%d\\t\", salt + i); critical_resource[i] = salt + i; } printf(\"\\n\"); } void entry_task_writer(void *arg) { size_t salt = 0; k_err_t err; while (K_TRUE) { // \u5728\u5411\u4e34\u754c\u533a\u5199\u5165\u6570\u636e\u4e4b\u524d\uff0c\u5148\u5c1d\u8bd5\u83b7\u53d6\u4e34\u754c\u533a\u4fdd\u62a4\u9501 err = tos_mutex_pend(&critical_resource_locker); if (err == K_ERR_NONE) { // \u6210\u529f\u83b7\u53d6\u9501\u4e4b\u540e\uff0c\u5411\u4e34\u754c\u533a\u5199\u5165\u6570\u636e write_critical_resource(salt); // \u5199\u5b8c\u6570\u636e\u540e\uff0c\u91ca\u653e\u4e92\u65a5\u9501 tos_mutex_post(&critical_resource_locker); } tos_task_delay(1000); ++salt; } } static void read_critical_resource(void) { size_t i = 0; // \u4ece\u4e34\u754c\u533a\u8bfb\u53d6\u6570\u636e printf(\"reading critical resource:\\n\"); for (i = 0; i < 3; ++i) { printf(\"%d\\t\", critical_resource[i]); } printf(\"\\n\"); } void entry_task_reader(void *arg) { k_err_t err; while (K_TRUE) { // \u8bfb\u53d6\u4e34\u754c\u533a\u6570\u636e\u4e4b\u524d\uff0c\u5148\u5c1d\u8bd5\u83b7\u53d6\u4e34\u754c\u533a\u4fdd\u62a4\u9501 err = tos_mutex_pend(&critical_resource_locker); if (err == K_ERR_NONE) { // \u6210\u529f\u83b7\u53d6\u9501\u4e4b\u540e\uff0c\u4ece\u4e34\u754c\u533a\u8bfb\u53d6\u6570\u636e read_critical_resource(); // \u8bfb\u53d6\u6570\u636e\u5b8c\u6bd5\u540e\uff0c\u91ca\u653e\u4e92\u65a5\u9501 tos_mutex_post(&critical_resource_locker); } tos_task_delay(1000); } } int main(void) { board_init(); tos_knl_init(); // \u521b\u5efa\u4e34\u754c\u533a\u4fdd\u62a4\u4e92\u65a5\u9501 tos_mutex_create(&critical_resource_locker); (void)tos_task_create(&task_writer, \"writer\", entry_task_writer, NULL, 4, stack_task_writer, STK_SIZE_TASK_WRITER, 0); (void)tos_task_create(&task_reader, \"reader\", entry_task_reader, NULL, 4, stack_task_reader, STK_SIZE_TASK_READER, 0); tos_knl_start(); }","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_9","text":"writting critical resource: 0 1 2 reading critical resource: 0 1 2 writting critical resource: 1 2 3 reading critical resource: 1 2 3 writting critical resource: 2 3 4 reading critical resource: 2 3 4 writting critical resource: 3 4 5 reading critical resource: 3 4 5 writting critical resource: 4 5 6 reading critical resource: 4 5 6 writting critical resource: 5 6 7 reading critical resource: 5 6 7 writting critical resource: 6 7 8 reading critical resource: 6 7 8 writting critical resource: 7 8 9 reading critical resource: 7 8 9 \u5b9e\u4f8b\u4ee3\u7801","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#232","text":"","title":"2.3.2 \u4fe1\u53f7\u91cf"},{"location":"04.Development_Manual/#_10","text":"\u4fe1\u53f7\u91cf\u662f\u4e00\u79cd\u5b9e\u73b0\u4efb\u52a1\u95f4\u540c\u6b65\u7684\u673a\u5236\uff0c\u4e00\u822c\u7528\u4e8e\u591a\u4e2a\u4efb\u52a1\u95f4\u6709\u9650\u8d44\u6e90\u7ade\u4e89\u8bbf\u95ee\u3002 \u901a\u5e38\u6765\u8bf4\uff0c\u4e00\u4e2a\u4fe1\u53f7\u91cf\u4e2d\u6301\u6709\u4e00\u4e2a\u6574\u5f62\u6570\u503c\uff0c\u7528\u4ee5\u8868\u793a\u53ef\u7528\u8d44\u6e90\u7684\u6570\u91cf\u3002\u5f53\u4e00\u4e2a\u4fe1\u53f7\u91cf\u7684\u53ef\u7528\u8d44\u6e90\u6570\u91cf\u5927\u4e8e0\u65f6\uff0c\u4efb\u52a1\u5c1d\u8bd5\u83b7\u53d6\u8be5\u4fe1\u53f7\u91cf\u6210\u529f\uff0c\u4fe1\u53f7\u91cf\u7684\u53ef\u7528\u8d44\u6e90\u6570\u51cf\u4e00\uff1b\u5f53\u4e00\u4e2a\u4fe1\u53f7\u91cf\u7684\u53ef\u7528\u8d44\u6e90\u6570\u7b49\u4e8e0\u65f6\uff0c\u4efb\u52a1\u5c1d\u8bd5\u83b7\u53d6\u8be5\u4fe1\u53f7\u91cf\u5931\u8d25\u6216\u8fdb\u5165\u963b\u585e\u72b6\u6001\u3002\u4fe1\u53f7\u91cf\u7684\u8fd9\u4e00\u6a21\u5f0f\uff0c\u5f53\u53ef\u7528\u8d44\u6e90\u6570\u4e3a1\u65f6\uff0c\u53ef\u5c06\u5176\u7528\u4e8e\u8d44\u6e90\u7684\u4e92\u65a5\u8bbf\u95ee\uff1b\u6216\u8005\u89e3\u51b3\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u95ee\u9898\u4e2d\u7684\u8d44\u6e90\u751f\u4ea7-\u6d88\u8d39\u95ee\u9898\u3002\u7f16\u7a0b\u5b9e\u4f8b\u7ae0\u8282\u4f1a\u6f14\u793a\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u95ee\u9898\u7684\u89e3\u51b3\u8303\u5f0f\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_3","text":"","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_11","text":"1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u4fe1\u53f7\u91cf\u7ec4\u4ef6\u5f00\u5173TOS_CFG_SEM_EN\uff1a #define TOS_CFG_SEM_EN 1u 2\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_PRODUCER 512 #define STK_SIZE_TASK_CONSUMER 512 k_stack_t stack_task_producer[STK_SIZE_TASK_PRODUCER]; k_stack_t stack_task_consumer[STK_SIZE_TASK_CONSUMER]; k_task_t task_producer; k_task_t task_consumer; extern void entry_task_producer(void *arg); extern void entry_task_consumer(void *arg); k_mutex_t buffer_locker; k_sem_t full; k_sem_t empty; #define RESOURCE_COUNT_MAX 3 struct resource_st { int cursor; uint32_t buffer[RESOURCE_COUNT_MAX]; } resource = { 0, {0} }; static void produce_item(int salt) { printf(\"produce item:\\n\"); printf(\"%d\", salt); resource.buffer[resource.cursor++] = salt; printf(\"\\n\"); } void entry_task_producer(void *arg) { size_t salt = 0; k_err_t err; while (K_TRUE) { err = tos_sem_pend(&empty, TOS_TIME_FOREVER); if (err != K_ERR_NONE) { continue; } err = tos_mutex_pend(&buffer_locker); if (err != K_ERR_NONE) { continue; } produce_item(salt); tos_mutex_post(&buffer_locker); tos_sem_post(&full); tos_task_delay(1000); ++salt; } } static void consume_item(void) { printf(\"cosume item:\\n\"); printf(\"%d\\t\", resource.buffer[--resource.cursor]); printf(\"\\n\"); } void entry_task_consumer(void *arg) { k_err_t err; while (K_TRUE) { err = tos_sem_pend(&full, TOS_TIME_FOREVER); if (err != K_ERR_NONE) { continue; } tos_mutex_pend(&buffer_locker); if (err != K_ERR_NONE) { continue; } consume_item(); tos_mutex_post(&buffer_locker); tos_sem_post(&empty); tos_task_delay(2000); } } int main(void) { board_init(); tos_knl_init(); tos_mutex_create(&buffer_locker); tos_sem_create(&full, 0); tos_sem_create(&empty, RESOURCE_COUNT_MAX); (void)tos_task_create(&task_producer, \"producer\", entry_task_producer, NULL, 4, stack_task_producer, STK_SIZE_TASK_PRODUCER, 0); (void)tos_task_create(&task_consumer, \"consumer\", entry_task_consumer, NULL, 4, stack_task_consumer, STK_SIZE_TASK_CONSUMER, 0); tos_knl_start(); }","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_12","text":"produce iterm: 0 cosume iterm: 0 produce iterm: 1 produce iterm: 2 cosume iterm: 2 produce iterm: 3 produce iterm: 4 cosume iterm: 4 produce iterm: 5 cosume iterm: 5 produce iterm: 6 cosume iterm: 6 produce iterm: 7 cosume iterm: 7 produce iterm: 8 cosume iterm: 8 produce iterm: 9 cosume iterm: 9 produce iterm: 10 \u5b9e\u4f8b\u4ee3\u7801","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#233","text":"","title":"2.3.3 \u4e8b\u4ef6"},{"location":"04.Development_Manual/#_13","text":"\u4e8b\u4ef6\u63d0\u4f9b\u4e86\u4e00\u79cd\u4efb\u52a1\u95f4\u5b9e\u73b0\u540c\u6b65\u548c\u4fe1\u606f\u4f20\u9012\u7684\u673a\u5236\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u4e00\u4e2a\u4e8b\u4ef6\u4e2d\u5305\u542b\u4e86\u4e00\u4e2a\u65d7\u6807\uff0c\u8fd9\u4e2a\u65d7\u6807\u7684\u6bcf\u4e00\u4f4d\u8868\u793a\u4e00\u4e2a\u201c\u4e8b\u4ef6\u201d\u3002 \u4e00\u4e2a\u4efb\u52a1\u53ef\u4ee5\u7b49\u5f85\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u201c\u4e8b\u4ef6\u201d\u7684\u53d1\u751f\uff0c\u5176\u4ed6\u4efb\u52a1\u5728\u4e00\u5b9a\u7684\u4e1a\u52a1\u6761\u4ef6\u4e0b\u53ef\u4ee5\u901a\u8fc7\u5199\u5165\u7279\u5b9a\u201c\u4e8b\u4ef6\u201d\u5524\u9192\u7b49\u5f85\u6b64\u201c\u4e8b\u4ef6\u201d\u7684\u4efb\u52a1\uff0c\u5b9e\u73b0\u4e00\u79cd\u7c7b\u4f3c\u4fe1\u53f7\u7684\u7f16\u7a0b\u8303\u5f0f\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_4","text":"","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_14","text":"1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u4e8b\u4ef6\u7ec4\u4ef6\u5f00\u5173TOS_CFG_EVENT_EN\uff1a #define TOS_CFG_EVENT_EN 1u 2\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_LISTENER 512 #define STK_SIZE_TASK_TRIGGER 512 k_stack_t stack_task_listener1[STK_SIZE_TASK_LISTENER]; k_stack_t stack_task_listener2[STK_SIZE_TASK_LISTENER]; k_stack_t stack_task_trigger[STK_SIZE_TASK_TRIGGER]; k_task_t task_listener1; k_task_t task_listener2; k_task_t task_trigger; extern void entry_task_listener1(void *arg); extern void entry_task_listener2(void *arg); extern void entry_task_trigger(void *arg); const k_event_flag_t event_eeny = (k_event_flag_t)(1 << 0); const k_event_flag_t event_meeny = (k_event_flag_t)(1 << 1); const k_event_flag_t event_miny = (k_event_flag_t)(1 << 2); const k_event_flag_t event_moe = (k_event_flag_t)(1 << 3); k_event_t event; void entry_task_listener1(void *arg) { k_event_flag_t flag_match; k_err_t err; while (K_TRUE) { // \u6b64\u4efb\u52a1\u76d1\u542c\u56db\u4e2a\u4e8b\u4ef6\uff0c\u56e0\u4e3a\u4f7f\u7528\u4e86TOS_OPT_EVENT_PEND_ALL\u9009\u9879\uff0c\u56e0\u6b64\u5fc5\u987b\u662f\u56db\u4e2a\u4e8b\u4ef6\u540c\u65f6\u5230\u8fbe\u6b64\u4efb\u52a1\u624d\u4f1a\u88ab\u5524\u9192 err = tos_event_pend(&event, event_eeny | event_meeny | event_miny | event_moe, &flag_match, TOS_TIME_FOREVER, TOS_OPT_EVENT_PEND_ALL | TOS_OPT_EVENT_PEND_CLR); if (err == K_ERR_NONE) { printf(\"entry_task_listener1:\\n\"); printf(\"eeny, meeny, miny, moe, they all come\\n\"); } } } void entry_task_listener2(void *arg) { k_event_flag_t flag_match; k_err_t err; while (K_TRUE) { // \u6b64\u4efb\u52a1\u76d1\u542c\u56db\u4e2a\u4e8b\u4ef6\uff0c\u56e0\u4e3a\u4f7f\u7528\u4e86TOS_OPT_EVENT_PEND_ANY\u9009\u9879\uff0c\u56e0\u6b64\u56db\u4e2a\u4e8b\u4ef6\u4efb\u610f\u4e00\u4e2a\u5230\u8fbe\uff08\u5305\u62ec\u56db\u4e2a\u4e8b\u4ef6\u540c\u65f6\u5230\u8fbe\uff09\u4efb\u52a1\u5c31\u4f1a\u88ab\u5524\u9192 err = tos_event_pend(&event, event_eeny | event_meeny | event_miny | event_moe, &flag_match, TOS_TIME_FOREVER, TOS_OPT_EVENT_PEND_ANY | TOS_OPT_EVENT_PEND_CLR); if (err == K_ERR_NONE) { printf(\"entry_task_listener2:\\n\"); // \u6709\u4e8b\u4ef6\u5230\u8fbe\uff0c\u5224\u65ad\u5177\u4f53\u662f\u54ea\u4e2a\u4e8b\u4ef6 if (flag_match == event_eeny) { printf(\"eeny comes\\n\"); } if (flag_match == event_meeny) { printf(\"meeny comes\\n\"); } if (flag_match == event_miny) { printf(\"miny comes\\n\"); } if (flag_match == event_moe) { printf(\"moe comes\\n\"); } if (flag_match == (event_eeny | event_meeny | event_miny | event_moe)) { printf(\"all come\\n\"); } } } } void entry_task_trigger(void *arg) { int i = 1; while (K_TRUE) { if (i == 2) { printf(\"entry_task_trigger:\\n\"); printf(\"eeny will come\\n\"); // \u53d1\u9001eeny\u4e8b\u4ef6\uff0ctask_listener2\u4f1a\u88ab\u5524\u9192 tos_event_post(&event, event_eeny); } if (i == 3) { printf(\"entry_task_trigger:\\n\"); printf(\"meeny will come\\n\"); // \u53d1\u9001eeny\u4e8b\u4ef6\uff0ctask_listener2\u4f1a\u88ab\u5524\u9192 tos_event_post(&event, event_meeny); } if (i == 4) { printf(\"entry_task_trigger:\\n\"); printf(\"miny will come\\n\"); // \u53d1\u9001eeny\u4e8b\u4ef6\uff0ctask_listener2\u4f1a\u88ab\u5524\u9192 tos_event_post(&event, event_miny); } if (i == 5) { printf(\"entry_task_trigger:\\n\"); printf(\"moe will come\\n\"); // \u53d1\u9001eeny\u4e8b\u4ef6\uff0ctask_listener2\u4f1a\u88ab\u5524\u9192 tos_event_post(&event, event_moe); } if (i == 6) { printf(\"entry_task_trigger:\\n\"); printf(\"all will come\\n\"); // \u540c\u65f6\u53d1\u9001\u56db\u4e2a\u4e8b\u4ef6\uff0c\u56e0\u4e3atask_listener1\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8etask_listener2\uff0c\u56e0\u6b64\u8fd9\u91cctask_listener1\u4f1a\u88ab\u5524\u9192 tos_event_post(&event, event_eeny | event_meeny | event_miny | event_moe); } tos_task_delay(1000); ++i; } } int main(void) { board_init(); tos_knl_init(); tos_event_create(&event, (k_event_flag_t)0u); // \u8fd9\u91cctask_listener1\u7684\u4f18\u5148\u7ea7\u6bd4task_listener2\u9ad8\uff0c\u56e0\u6b64\u5728task_trigger\u53d1\u9001\u6240\u6709\u4e8b\u4ef6\u65f6\uff0ctask_listener1\u4f1a\u88ab\u5524\u9192 // \u8bfb\u8005\u53ef\u4ee5\u5c1d\u8bd5\u5c06task_listener1\u4f18\u5148\u7ea7\u4fee\u6539\u4e3a5\uff08\u6bd4task_listener2\u4f4e\uff09\uff0c\u6b64\u8bbe\u7f6e\u4e0b\uff0c\u5728task_trigger\u53d1\u9001\u6240\u6709\u4e8b\u4ef6\u65f6\uff0ctask_listener2\u5c06\u4f1a\u88ab\u5524\u9192\u3002 (void)tos_task_create(&task_listener1, \"listener1\", entry_task_listener1, NULL, 3, stack_task_listener1, STK_SIZE_TASK_LISTENER, 0); (void)tos_task_create(&task_listener2, \"listener2\", entry_task_listener2, NULL, 4, stack_task_listener2, STK_SIZE_TASK_LISTENER, 0); (void)tos_task_create(&task_trigger, \"trigger\", entry_task_trigger, NULL, 4, stack_task_trigger, STK_SIZE_TASK_TRIGGER, 0); tos_knl_start(); }","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_15","text":"entry_task_trigger: eeny will come entry_task_listener2: eeny comes entry_task_trigger: meeny will come entry_task_listener2: meeny comes entry_task_trigger: miny will come entry_task_listener2: miny comes entry_task_trigger: moe will come entry_task_listener2: moe comes entry_task_trigger: all will come entry_task_listener1: eeny, meeny, miny, moe, they all come \u5b9e\u4f8b\u4ee3\u7801","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#234","text":"","title":"2.3.4 \u5b8c\u6210\u91cf"},{"location":"04.Development_Manual/#_16","text":"\u5b8c\u6210\u91cf\u662f\u4e00\u79cd\u7b80\u5355\u7684\u4efb\u52a1\u95f4\u901a\u4fe1\u673a\u5236\uff0c\u7528\u4ee5\u5728\u4efb\u52a1\u95f4\u540c\u6b65\u67d0\u4e00\u4e8b\u4ef6\u662f\u5426\u5df2\u201c\u5b8c\u6210\u201d\u7684\u4fe1\u606f\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_5","text":"","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_17","text":"1\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a /* \u8fd9\u4e2a\u4f8b\u5b50\u91cc\u521b\u5efa\u4e86\u4e24\u4e2a\u4efb\u52a1\uff0c\u4e00\u4e2a\u4efb\u52a1task_wait\u7b49\u5f85\u5b8c\u6210\u91cf\u5b8c\u6210\uff0c\u53e6\u4e00\u4e2a\u4efb\u52a1\u8d1f\u8d23\u89e6\u53d1\u5b8c\u6210\u91cf\uff08\u8ba9\u5b8c\u6210\u91cf\u5b8c\u6210\uff09 */ #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_WAIT 512 #define STK_SIZE_TASK_TRIGGER 512 k_stack_t stack_task_wait[STK_SIZE_TASK_WAIT]; k_stack_t stack_task_trigger[STK_SIZE_TASK_TRIGGER]; k_task_t task_wait; k_task_t task_trigger; k_completion_t completion; void entry_task_wait(void *arg) { printf(\"wait: I won't go further until someone do the trigger(make it 'complete')\\n\"); tos_completion_pend(&completion); printf(\"wait: someone has made it complete, so I'm here\\n\"); } void entry_task_trigger(void *arg) { printf(\"trigger: I'm the one who make complete, anyone waitting for the complete won't go further until I do the trigger\\n\"); tos_completion_post(&completion); printf(\"trigger: I have done the completion\\n\"); } int main(void) { board_init(); tos_knl_init(); tos_completion_create(&completion); (void)tos_task_create(&task_wait, \"wait\", entry_task_wait, NULL, 3, stack_task_wait, STK_SIZE_TASK_WAIT, 0); (void)tos_task_create(&task_trigger, \"trigger\", entry_task_trigger, NULL, 4, stack_task_trigger, STK_SIZE_TASK_TRIGGER, 0); tos_knl_start(); }","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_18","text":"wait: I won't go further until someone do the trigger(make it 'complete') trigger: I'm the one who make complete, anyone waitting for the complete won't go further until I do the trigger wait: someone make it complete, so I'm here trigger: I have done the completion \u5b9e\u4f8b\u4ee3\u7801","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#235","text":"","title":"2.3.5 \u8ba1\u6570\u9501"},{"location":"04.Development_Manual/#_19","text":"\u8ba1\u6570\u9501\u63d0\u4f9b\u4e86\u4e00\u79cd\u201c\u8ba1\u6570\u4fe1\u606f\u201d\u540c\u6b65\u7684\u6982\u5ff5\uff0c\u8ba1\u6570\u9501\u521b\u5efa\u7684\u65f6\u5019\u4f1a\u6307\u5b9a\u4e00\u4e2a\u8ba1\u6570\u503c\uff0c\u6bcf\u5f53\u6709\u4efb\u52a1\u6267\u884ctos_countdownlatch_post\u65f6\uff0c\u8be5\u8ba1\u6570\u9501\u7684\u8ba1\u6570\u503c\u51cf\u4e00\uff0c\u76f4\u5230\u8ba1\u6570\u9501\u7684\u8ba1\u6570\u503c\u4e3a\u96f6\u65f6\uff0c\u7b49\u5f85\u6b64\u8ba1\u6570\u9501\u7684\u4efb\u52a1\u624d\u4f1a\u88ab\u5524\u9192\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_6","text":"","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_20","text":"1\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a /* \u5047\u8bbe\u6709\u8fd9\u6837\u7684\u4e1a\u52a1\u573a\u666f\uff0c\u5171\u6709\u4e09\u4e2a\u52c7\u58eb\uff0c\u6b64\u4e09\u4e2a\u52c7\u58eb\u5206\u5934\u53bb\u5bfb\u627e\u4e09\u4e2a\u6b66\u5668\u7684\u788e\u7247\uff0c\u53ea\u6709\u8fd9\u4e09\u4e2a\u52c7\u58eb\u90fd\u627e\u5230\u788e\u7247\u540e\uff0c\u6cd5\u5e08\u624d\u80fd\u5c06\u4e09\u4e2a\u788e\u7247\u5408\u6210\u4e3a\u6b66\u5668\u3002\u7528\u4ee3\u7801\u770b\u5177\u4f53\u5982\u4f55\u4f7f\u7528\u8ba1\u6570\u9501\u6765\u5b8c\u6210\u8fd9\u4e2a\u6a21\u578b\u3002 */ #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_WIZARD 512 #define STK_SIZE_TASK_WARRIOR 512 k_stack_t stack_task_wizard[STK_SIZE_TASK_WIZARD]; k_stack_t stack_task_warrior_0[STK_SIZE_TASK_WARRIOR]; k_stack_t stack_task_warrior_1[STK_SIZE_TASK_WARRIOR]; k_stack_t stack_task_warrior_2[STK_SIZE_TASK_WARRIOR]; k_task_t task_wizard; k_task_t task_warrior_0; k_task_t task_warrior_1; k_task_t task_warrior_2; k_countdownlatch_t countdownlatch; void entry_task_warrior_0(void *arg) { printf(\"warrior 0: I have done my job\\n\"); tos_countdownlatch_post(&countdownlatch); } void entry_task_warrior_1(void *arg) { printf(\"warrior 1: I have done my job\\n\"); tos_countdownlatch_post(&countdownlatch); } void entry_task_warrior_2(void *arg) { printf(\"warrior 2: I have done my job\\n\"); tos_countdownlatch_post(&countdownlatch); } void entry_task_wizard(void *arg) { printf(\"wizard: I will set 3 warriors to find the fragments\\n\"); tos_countdownlatch_create(&countdownlatch, 3); (void)tos_task_create(&task_warrior_0, \"warrior_0\", entry_task_warrior_0, NULL, 4, stack_task_warrior_0, STK_SIZE_TASK_WARRIOR, 0); (void)tos_task_create(&task_warrior_1, \"warrior_1\", entry_task_warrior_1, NULL, 4, stack_task_warrior_1, STK_SIZE_TASK_WARRIOR, 0); (void)tos_task_create(&task_warrior_2, \"warrior_2\", entry_task_warrior_2, NULL, 4, stack_task_warrior_2, STK_SIZE_TASK_WARRIOR, 0); printf(\"wizard: now warriors are on their way, I will wait here until they all done the job\\n\"); tos_countdownlatch_pend(&countdownlatch); printf(\"wizard: the warriors all have done their jobs, let's make the weapon\\n\"); } int main(void) { board_init(); tos_knl_init(); (void)tos_task_create(&task_wizard, \"wizard\", entry_task_wizard, NULL, 3, stack_task_wizard, STK_SIZE_TASK_WIZARD, 0); tos_knl_start(); }","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_21","text":"wizard: I will set 3 warriors to find the fragments wizard: now warriors are on their way, I will wait here until they all done the job warrior 0: I have done my job warrior 1: I have done my job warrior 2: I have done my job wizard: the warriors all have done their jobs, let's make the weapon \u5b9e\u4f8b\u4ee3\u7801","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#236","text":"","title":"2.3.6 \u6805\u680f"},{"location":"04.Development_Manual/#_22","text":"\u6805\u680f\u63d0\u4f9b\u4e86\u4e00\u79cd\u8bbe\u7f6e\u4efb\u52a1\u963b\u585e\u5c4f\u969c\u7684\u673a\u5236\uff0c\u6805\u680f\u521b\u5efa\u7684\u65f6\u5019\u4f1a\u6307\u5b9a\u4e00\u4e2a\u8ba1\u6570\u503c\uff0c\u6bcf\u5f53\u6709\u4efb\u52a1\u6267\u884ctos_barrier_pend\u65f6\uff0c\u8be5\u8ba1\u6570\u9501\u7684\u8ba1\u6570\u503c\u51cf\u4e00\uff0c\u76f4\u5230\u8ba1\u6570\u9501\u7684\u8ba1\u6570\u503c\u4e3a\u96f6\u65f6\uff0c\u6240\u6709\u963b\u585e\u5728tos_barrier_pend\u70b9\u4e0a\u7684\u4efb\u52a1\u624d\u53ef\u4ee5\u5f80\u4e0b\u8fd0\u884c\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_7","text":"","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_23","text":"1\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a /* \u5047\u8bbe\u6709\u8fd9\u6837\u7684\u4e1a\u52a1\u573a\u666f\uff0c\u5171\u6709\u4e09\u4e2a\u52c7\u58eb\uff0c\u6b64\u4e09\u4e2a\u52c7\u58eb\u5206\u5934\u53bb\u5bfb\u627e\u4e09\u4e2a\u6b66\u5668\u7684\u788e\u7247\uff0c\u4efb\u610f\u52c7\u58eb\u627e\u5230\u81ea\u5df1\u7684\u90a3\u5757\u6b66\u5668\u788e\u7247\u65f6\uff0c\u90fd\u5728\u539f\u5730\u7b49\u5f85\uff0c\u76f4\u5230\u6240\u6709\u7684\u5c0f\u4f19\u4f34\u90fd\u627e\u5230\u4e86\u81ea\u5df1\u7684\u6b66\u5668\u788e\u7247\u540e\uff0c\u624d\u5404\u81ea\u91c7\u53d6\u4e0b\u4e00\u6b65\u884c\u52a8\u3002\u7528\u4ee3\u7801\u770b\u5177\u4f53\u5982\u4f55\u4f7f\u7528\u6805\u680f\u6765\u5b8c\u6210\u8fd9\u4e2a\u6a21\u578b\u3002 */ #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_WARRIOR 512 k_stack_t stack_task_warrior_0[STK_SIZE_TASK_WARRIOR]; k_stack_t stack_task_warrior_1[STK_SIZE_TASK_WARRIOR]; k_stack_t stack_task_warrior_2[STK_SIZE_TASK_WARRIOR]; k_task_t task_warrior_0; k_task_t task_warrior_1; k_task_t task_warrior_2; k_barrier_t barrier; void entry_task_warrior_0(void *arg) { printf(\"warrior 0: I'm searching the fragment\\n\"); tos_task_delay(1000); printf(\"warrior 0: I have done my job, waitting other buddies done their job\\n\"); tos_barrier_pend(&barrier); printf(\"warrior 0: all buddies find their fragment, do my next job\\n\"); } void entry_task_warrior_1(void *arg) { printf(\"warrior 1: I'm searching the fragment\\n\"); tos_task_delay(1500); printf(\"warrior 1: I have done my job, waitting other buddies done their job\\n\"); tos_barrier_pend(&barrier); printf(\"warrior 1: all buddies find their fragment, do my next job\\n\"); } void entry_task_warrior_2(void *arg) { printf(\"warrior 2: I'm searching the fragment\\n\"); tos_task_delay(2000); printf(\"warrior 2: I have done my job, waitting other buddies done their job\\n\"); tos_barrier_pend(&barrier); printf(\"warrior 2: all buddies find their fragment, do my next job\\n\"); } int main(void) { board_init(); tos_knl_init(); tos_barrier_create(&barrier, 3); (void)tos_task_create(&task_warrior_0, \"warrior_0\", entry_task_warrior_0, NULL, 4, stack_task_warrior_0, STK_SIZE_TASK_WARRIOR, 0); (void)tos_task_create(&task_warrior_1, \"warrior_1\", entry_task_warrior_1, NULL, 4, stack_task_warrior_1, STK_SIZE_TASK_WARRIOR, 0); (void)tos_task_create(&task_warrior_2, \"warrior_2\", entry_task_warrior_2, NULL, 4, stack_task_warrior_2, STK_SIZE_TASK_WARRIOR, 0); tos_knl_start(); }","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_24","text":"warrior 0: I'm searching the fragment warrior 1: I'm searching the fragment warrior 2: I'm searching the fragment warrior 0: I have done my job, waitting other buddies done their job warrior 1: I have done my job, waitting other buddies done their job warrior 2: I have done my job, waitting other buddies done their job warrior 2: all buddies find their fragment, do my next job warrior 0: all buddies find their fragment, do my next job warrior 1: all buddies find their fragment, do my next job \u5b9e\u4f8b\u4ee3\u7801","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#237","text":"","title":"2.3.7 \u6d88\u606f\u961f\u5217"},{"location":"04.Development_Manual/#_25","text":"\u6d88\u606f\u961f\u5217\u63d0\u4f9b\u4e86\u4efb\u52a1\u95f4\u4f20\u9012\u6307\u9488\u6570\u636e\u7684\u673a\u5236\uff0c\u6240\u8c13\u7684\u201c\u6d88\u606f\u201c\u5c31\u662f\u6307\u9488\u3002\u6d88\u606f\u672c\u8eab\u5982\u4f55\u89e3\u6790\u4f7f\u7528\uff0c\u7531\u4f20\u9012\u6d88\u606f\u7684\u4e24\u4e2a\u4efb\u52a1\u81ea\u884c\u89c4\u5b9a\uff0c\u6d88\u606f\u961f\u5217\u4e0d\u5bf9\u6d88\u606f\u672c\u8eab\u505a\u4efb\u4f55\u89c4\u5b9a\u548c\u9650\u5236\uff0c\u6d88\u606f\u961f\u5217\u4ec5\u627f\u62c5\u6307\u9488\u6570\u636e\u7684\u4f20\u9012\u4e49\u52a1\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_8","text":"","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_26","text":"1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u6d88\u606f\u961f\u5217\u7ec4\u4ef6\u5f00\u5173TOS_CFG_MESSAGE_QUEUE_EN\uff1a #define TOS_CFG_MESSAGE_QUEUE_EN 1u 2\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a /* \u8fd9\u91cc\u6f14\u793a\u5982\u4f55\u4f7f\u7528\u6d88\u606f\u961f\u5217\u5728sender\u548creceiver\u4efb\u52a1\u4e4b\u95f4\u4f20\u9012\u6d88\u606f\uff08\u4e00\u4e2a\u6307\u9488\uff0c\u6b64\u6848\u4f8b\u4e2d\u8fd9\u4e2a\u6307\u9488\u4fe1\u606f\u6307\u5411\u7684\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff09 */ #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_RECEIVER 512 #define STK_SIZE_TASK_SENDER 512 #define PRIO_TASK_RECEIVER_HIGHER_PRIO 4 #define PRIO_TASK_RECEIVER_LOWER_PRIO (PRIO_TASK_RECEIVER_HIGHER_PRIO + 1) #define MESSAGE_MAX 10 k_stack_t stack_task_receiver_higher_prio[STK_SIZE_TASK_RECEIVER]; k_stack_t stack_task_receiver_lower_prio[STK_SIZE_TASK_RECEIVER]; k_stack_t stack_task_sender[STK_SIZE_TASK_SENDER]; uint8_t msg_pool[MESSAGE_MAX * sizeof(void *)]; k_task_t task_receiver_higher_prio; k_task_t task_receiver_lower_prio; k_task_t task_sender; k_msg_q_t msg_q; extern void entry_task_receiver_higher_prio(void *arg); extern void entry_task_receiver_lower_prio(void *arg); extern void entry_task_sender(void *arg); void entry_task_receiver_higher_prio(void *arg) { k_err_t err; void *msg_received; while (K_TRUE) { err = tos_msg_q_pend(&msg_q, &msg_received, TOS_TIME_FOREVER); if (err == K_ERR_NONE) { printf(\"higher: msg incoming[%s]\\n\", (char *)msg_received); } } } void entry_task_receiver_lower_prio(void *arg) { k_err_t err; void *msg_received; while (K_TRUE) { err = tos_msg_q_pend(&msg_q, &msg_received, TOS_TIME_FOREVER); if (err == K_ERR_NONE) { printf(\"lower: msg incoming[%s]\\n\", (char *)msg_received); } } } void entry_task_sender(void *arg) { int i = 1; char *msg_to_one_receiver = \"message for one receiver(with highest priority)\"; char *msg_to_all_receiver = \"message for all receivers\"; while (K_TRUE) { if (i == 2) { printf(\"sender: send a message to one receiver, and shoud be the highest priority one\\n\"); tos_msg_q_post(&msg_q, msg_to_one_receiver); } if (i == 3) { printf(\"sender: send a message to all recevier\\n\"); tos_msg_q_post_all(&msg_q, msg_to_all_receiver); } if (i == 4) { printf(\"sender: send a message to one receiver, and shoud be the highest priority one\\n\"); tos_msg_q_post(&msg_q, msg_to_one_receiver); } if (i == 5) { printf(\"sender: send a message to all recevier\\n\"); tos_msg_q_post_all(&msg_q, msg_to_all_receiver); } tos_task_delay(1000); ++i; } } int main(void) { board_init(); tos_knl_init(); tos_msg_q_create(&msg_q, msg_pool, MESSAGE_MAX); (void)tos_task_create(&task_receiver_higher_prio, \"receiver_higher_prio\", entry_task_receiver_higher_prio, NULL, PRIO_TASK_RECEIVER_HIGHER_PRIO, stack_task_receiver_higher_prio, STK_SIZE_TASK_RECEIVER, 0); (void)tos_task_create(&task_receiver_lower_prio, \"receiver_lower_prio\", entry_task_receiver_lower_prio, NULL, PRIO_TASK_RECEIVER_LOWER_PRIO, stack_task_receiver_lower_prio, STK_SIZE_TASK_RECEIVER, 0); (void)tos_task_create(&task_sender, \"sender\", entry_task_sender, NULL, 4, stack_task_sender, STK_SIZE_TASK_SENDER, 0); tos_knl_start(); }","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_27","text":"sender: send a message to one receiver, and shoud be the highest priority one higher: msg incoming[message for one receiver(with highest priority)] sender: send a message to all recevier higher: msg incoming[message for all receivers] lower: msg incoming[message for all receivers] sender: send a message to one receiver, and shoud be the highest priority one higher: msg incoming[message for one receiver(with highest priority)] sender: send a message to all recevier higher: msg incoming[message for all receivers] lower: msg incoming[message for all receivers] \u5b9e\u4f8b\u4ee3\u7801","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#238","text":"","title":"2.3.8 \u90ae\u7bb1\u961f\u5217"},{"location":"04.Development_Manual/#_28","text":"\u6d88\u606f\u961f\u5217\u4f20\u9012\u7684\u662f\u6307\u9488\uff0c\u90ae\u7bb1\u961f\u5217\u4f20\u9012\u7684\u662f\u5927\u7247\u7684\u5185\u5b58\u6570\u636e\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_9","text":"","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_29","text":"1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u90ae\u7bb1\u961f\u5217\u7ec4\u4ef6\u5f00\u5173TOS_CFG_MAIL_QUEUE_EN\uff1a #define TOS_CFG_MAIL_QUEUE_EN 1u 2\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a /* \u8fd9\u91cc\u6f14\u793a\u5982\u4f55\u4f7f\u7528\u90ae\u7bb1\u961f\u5217\u5728sender\u548creceiver\u4efb\u52a1\u4e4b\u95f4\u4f20\u9012\u90ae\u7bb1\uff08\u6b64\u6848\u4f8b\u4e2d\u90ae\u4ef6\uff0c\u4e5f\u5c31\u662f\u90ae\u7bb1\u8981\u4f20\u9012\u7684\u5185\u5b58\u6570\u636e\u4e3a\u4e00\u4e2amail_t\u7c7b\u578b\u7684\u7ed3\u6784\u4f53\uff0c\u4ece\u6b64\u6848\u4f8b\u4e2d\u53ef\u4ee5\u770b\u51fa\u6765\uff0c\u90ae\u7bb1\u961f\u5217\u76f8\u5bf9\u6d88\u606f\u961f\u5217\u6765\u8bf4\uff0c\u53ef\u4ee5\u4f20\u9012\u66f4\u4e3a\u590d\u6742\u7684\u5185\u5b58\u5757\u6570\u636e\uff09 */ #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_RECEIVER 512 #define STK_SIZE_TASK_SENDER 512 #define PRIO_TASK_RECEIVER_HIGHER_PRIO 4 #define PRIO_TASK_RECEIVER_LOWER_PRIO (PRIO_TASK_RECEIVER_HIGHER_PRIO + 1) #define MAIL_MAX 10 k_stack_t stack_task_receiver_higher_prio[STK_SIZE_TASK_RECEIVER]; k_stack_t stack_task_receiver_lower_prio[STK_SIZE_TASK_RECEIVER]; k_stack_t stack_task_sender[STK_SIZE_TASK_SENDER]; typedef struct mail_st { char *message; int payload; } mail_t; uint8_t mail_pool[MAIL_MAX * sizeof(mail_t)]; k_task_t task_receiver_higher_prio; k_task_t task_receiver_lower_prio; k_task_t task_sender; k_mail_q_t mail_q; extern void entry_task_receiver_higher_prio(void *arg); extern void entry_task_receiver_lower_prio(void *arg); extern void entry_task_sender(void *arg); void entry_task_receiver_higher_prio(void *arg) { k_err_t err; mail_t mail; size_t mail_size; while (K_TRUE) { err = tos_mail_q_pend(&mail_q, &mail, &mail_size, TOS_TIME_FOREVER); if (err == K_ERR_NONE) { TOS_ASSERT(mail_size == sizeof(mail_t)); printf(\"higher: msg incoming[%s], payload[%d]\\n\", mail.message, mail.payload); } } } void entry_task_receiver_lower_prio(void *arg) { k_err_t err; mail_t mail; size_t mail_size; while (K_TRUE) { err = tos_mail_q_pend(&mail_q, &mail, &mail_size, TOS_TIME_FOREVER); if (err == K_ERR_NONE) { TOS_ASSERT(mail_size == sizeof(mail_t)); printf(\"lower: msg incoming[%s], payload[%d]\\n\", mail.message, mail.payload); } } } void entry_task_sender(void *arg) { int i = 1; mail_t mail; while (K_TRUE) { if (i == 2) { printf(\"sender: send a mail to one receiver, and shoud be the highest priority one\\n\"); mail.message = \"1st time post\"; mail.payload = 1; tos_mail_q_post(&mail_q, &mail, sizeof(mail_t)); } if (i == 3) { printf(\"sender: send a message to all recevier\\n\"); mail.message = \"2nd time post\"; mail.payload = 2; tos_mail_q_post_all(&mail_q, &mail, sizeof(mail_t)); } if (i == 4) { printf(\"sender: send a message to one receiver, and shoud be the highest priority one\\n\"); mail.message = \"3rd time post\"; mail.payload = 3; tos_mail_q_post(&mail_q, &mail, sizeof(mail_t)); } if (i == 5) { printf(\"sender: send a message to all recevier\\n\"); mail.message = \"4th time post\"; mail.payload = 4; tos_mail_q_post_all(&mail_q, &mail, sizeof(mail_t)); } tos_task_delay(1000); ++i; } } int main(void) { board_init(); tos_knl_init(); tos_mail_q_create(&mail_q, mail_pool, MAIL_MAX, sizeof(mail_t)); (void)tos_task_create(&task_receiver_higher_prio, \"receiver_higher_prio\", entry_task_receiver_higher_prio, NULL, PRIO_TASK_RECEIVER_HIGHER_PRIO, stack_task_receiver_higher_prio, STK_SIZE_TASK_RECEIVER, 0); (void)tos_task_create(&task_receiver_lower_prio, \"receiver_lower_prio\", entry_task_receiver_lower_prio, NULL, PRIO_TASK_RECEIVER_LOWER_PRIO, stack_task_receiver_lower_prio, STK_SIZE_TASK_RECEIVER, 0); (void)tos_task_create(&task_sender, \"sender\", entry_task_sender, NULL, 5, stack_task_sender, STK_SIZE_TASK_SENDER, 0); tos_knl_start(); }","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_30","text":"sender: send a mail to one receiver, and shoud be the highest priority one higher: msg incoming[1st time post], payload[1] sender: send a message to all recevier higher: msg incoming[2nd time post], payload[2] lower: msg incoming[2nd time post], payload[2] sender: send a message to one receiver, and shoud be the highest priority one higher: msg incoming[3rd time post], payload[3] sender: send a message to all recevier higher: msg incoming[4th time post], payload[4] lower: msg incoming[4th time post], payload[4] \u5b9e\u4f8b\u4ee3\u7801","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#239","text":"","title":"2.3.9 \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217"},{"location":"04.Development_Manual/#_31","text":"\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u76f8\u5bf9\u6d88\u606f\u961f\u5217\u6765\u8bf4\uff0c\u7ed9\u6d88\u606f\u9644\u52a0\u4e86\u4e00\u4e2a\u4f18\u5148\u7ea7\u7684\u6982\u5ff5\uff0c\u8f83\u9ad8\u4f18\u5148\u7ea7\u7684\u6d88\u606f\u4f1a\u6bd4\u8f83\u4f4e\u4f18\u5148\u7ea7\u7684\u6d88\u606f\u66f4\u5feb\u5730\u88ab\u5176\u4ed6\u4efb\u52a1\u6536\u5230\uff08\u672c\u8d28\u4e0a\uff0c\u6d88\u606f\u961f\u5217\u7684\u5e95\u5c42\u6570\u636e\u5bb9\u5668\u662f\u73af\u5f62\u961f\u5217\uff0c\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u7684\u5e95\u5c42\u6570\u636e\u5bb9\u5668\u662f\u4f18\u5148\u7ea7\u961f\u5217\uff09\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_10","text":"","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_32","text":"1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u7ec4\u4ef6\u5f00\u5173TOS_CFG_PRIORITY_MESSAGE_QUEUE_EN\uff1a #define TOS_CFG_PRIORITY_MESSAGE_QUEUE_EN 1u 2\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_RECEIVER 512 #define STK_SIZE_TASK_SENDER 512 #define MESSAGE_MAX 10 k_stack_t stack_task_receiver[STK_SIZE_TASK_RECEIVER]; k_stack_t stack_task_sender[STK_SIZE_TASK_SENDER]; uint8_t msg_pool[MESSAGE_MAX * sizeof(void *)]; k_task_t task_receiver; k_task_t task_sender; k_prio_msg_q_t prio_msg_q; extern void entry_task_receiver(void *arg); extern void entry_task_sender(void *arg); void entry_task_receiver(void *arg) { k_err_t err; void *msg_received; while (K_TRUE) { err = tos_prio_msg_q_pend(&prio_msg_q, &msg_received, TOS_TIME_FOREVER); if (err == K_ERR_NONE) { printf(\"receiver: msg incoming[%s]\\n\", (char *)msg_received); } } } void entry_task_sender(void *arg) { char *msg_prio_0 = \"msg with priority 0\"; char *msg_prio_1 = \"msg with priority 1\"; char *msg_prio_2 = \"msg with priority 2\"; printf(\"sender: post a message with priority 2\\n\"); tos_prio_msg_q_post(&prio_msg_q, msg_prio_2, 2); printf(\"sender: post a message with priority 1\\n\"); tos_prio_msg_q_post(&prio_msg_q, msg_prio_1, 1); printf(\"sender: post a message with priority 0\\n\"); tos_prio_msg_q_post(&prio_msg_q, msg_prio_0, 0); } int main(void) { board_init(); tos_knl_init(); tos_prio_msg_q_create(&prio_msg_q, msg_pool, MESSAGE_MAX); (void)tos_task_create(&task_receiver, \"receiver\", entry_task_receiver, NULL, 5, stack_task_receiver, STK_SIZE_TASK_RECEIVER, 0); (void)tos_task_create(&task_sender, \"sender\", entry_task_sender, NULL, 4, stack_task_sender, STK_SIZE_TASK_SENDER, 0); tos_knl_start(); }","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_33","text":"sender: post a message with priority 2 sender: post a message with priority 1 sender: post a message with priority 0 receiver: msg incoming[msg with priority 0] receiver: msg incoming[msg with priority 1] receiver: msg incoming[msg with priority 2] \u5b9e\u4f8b\u4ee3\u7801","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#2310","text":"","title":"2.3.10 \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217"},{"location":"04.Development_Manual/#_34","text":"\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u76f8\u5bf9\u90ae\u7bb1\u961f\u5217\u6765\u8bf4\uff0c\u7ed9\u90ae\u4ef6\u9644\u52a0\u4e86\u4e00\u4e2a\u4f18\u5148\u7ea7\u7684\u6982\u5ff5\uff0c\u8f83\u9ad8\u4f18\u5148\u7ea7\u7684\u90ae\u4ef6\u4f1a\u6bd4\u8f83\u4f4e\u4f18\u5148\u7ea7\u7684\u90ae\u4ef6\u66f4\u5feb\u5730\u88ab\u5176\u4ed6\u4efb\u52a1\u6536\u5230\uff08\u672c\u8d28\u4e0a\uff0c\u90ae\u7bb1\u961f\u5217\u7684\u5e95\u5c42\u6570\u636e\u5bb9\u5668\u662f\u73af\u5f62\u961f\u5217\uff0c\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u7684\u5e95\u5c42\u6570\u636e\u5bb9\u5668\u662f\u4f18\u5148\u7ea7\u961f\u5217\uff09\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_11","text":"","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_35","text":"1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u7ec4\u4ef6\u5f00\u5173TOS_CFG_PRIORITY_MAIL_QUEUE_EN\uff1a #define TOS_CFG_PRIORITY_MAIL_QUEUE_EN 1u 2\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a /* \u8fd9\u91cc\u6f14\u793a\u4e86\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u7684\u4f7f\u7528\uff0c\u4ecesender\u4efb\u52a1\u4e2d\u7684\u903b\u8f91\u53ef\u4ee5\u770b\u51fa\u6765\uff0c\u4f9d\u6b21post\u4e86\u4e09\u4e2amail\uff0c\u4f18\u5148\u7ea7\u6309\u65f6\u95f4\u987a\u5e8f\u4f9d\u6b21\u4e3a2\u30011\u30010\uff08\u6570\u503c\u8d8a\u9ad8\u4f18\u5148\u7ea7\u8d8a\u4f4e\uff09\u3002\u5982\u679c\u662f\u4f20\u7edf\u7684\u90ae\u7bb1\u961f\u5217\uff0c\u90a3\u4e2areceiver\u5e94\u8be5\u662f\u4f9d\u6b21\u6536\u5230\u4f18\u5148\u7ea7\u4e3a2\u30011\u30010\u7684\u90ae\u4ef6\uff1b\u4f46\u8fd9\u662f\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\uff0c\u56e0\u800creceiver\u4f1a\u6309\u4f18\u5148\u7ea7\u987a\u5e8f\u6536\u5230\u8fd9\u4e09\u4e2a\u90ae\u4ef6\uff0c\u4e5f\u5c31\u662f\u4f9d\u6b21\u6536\u5230\u4f18\u5148\u7ea7\u4e3a0\u30011\u30012\u7684\u90ae\u4ef6\u3002 */ #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_RECEIVER 512 #define STK_SIZE_TASK_SENDER 512 #define MAIL_MAX 10 k_stack_t stack_task_receiver[STK_SIZE_TASK_RECEIVER]; k_stack_t stack_task_sender[STK_SIZE_TASK_SENDER]; typedef struct mail_st { char *message; int payload; } mail_t; uint8_t mail_pool[MAIL_MAX * sizeof(mail_t)]; k_task_t task_receiver; k_task_t task_sender; k_prio_mail_q_t prio_mail_q; extern void entry_task_receiver(void *arg); extern void entry_task_sender(void *arg); void entry_task_receiver(void *arg) { k_err_t err; mail_t mail; size_t mail_size; while (K_TRUE) { err = tos_prio_mail_q_pend(&prio_mail_q, &mail, &mail_size, TOS_TIME_FOREVER); if (err == K_ERR_NONE) { TOS_ASSERT(mail_size == sizeof(mail_t)); printf(\"receiver: msg incoming[%s], payload[%d]\\n\", mail.message, mail.payload); } } } void entry_task_sender(void *arg) { mail_t mail_0, mail_1, mail_2; printf(\"sender: post a mail with priority 2\\n\"); mail_2.message = \"priority 2\"; mail_2.payload = 2; tos_prio_mail_q_post(&prio_mail_q, &mail_2, sizeof(mail_t), 2); printf(\"sender: post a mail with priority 1\\n\"); mail_1.message = \"priority 1\"; mail_1.payload = 1; tos_prio_mail_q_post_all(&prio_mail_q, &mail_1, sizeof(mail_t), 1); printf(\"sender: post a mail with priority 0\\n\"); mail_0.message = \"priority 0\"; mail_0.payload = 0; tos_prio_mail_q_post(&prio_mail_q, &mail_0, sizeof(mail_t), 0); } int main(void) { board_init(); tos_knl_init(); tos_prio_mail_q_create(&prio_mail_q, mail_pool, MAIL_MAX, sizeof(mail_t)); (void)tos_task_create(&task_receiver, \"receiver\", entry_task_receiver, NULL, 6, stack_task_receiver, STK_SIZE_TASK_RECEIVER, 0); (void)tos_task_create(&task_sender, \"sender\", entry_task_sender, NULL, 5, stack_task_sender, STK_SIZE_TASK_SENDER, 0); tos_knl_start(); }","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_36","text":"sender: post a mail with priority 2 sender: post a mail with priority 1 sender: post a mail with priority 0 receiver: msg incoming[priority 0], payload[0] receiver: msg incoming[priority 1], payload[1] receiver: msg incoming[priority 2], payload[2] \u5b9e\u4f8b\u4ee3\u7801","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#24","text":"","title":"2.4 \u5185\u5b58\u7ba1\u7406"},{"location":"04.Development_Manual/#241","text":"","title":"2.4.1 \u52a8\u6001\u5185\u5b58"},{"location":"04.Development_Manual/#_37","text":"\u52a8\u6001\u5185\u5b58\u7ba1\u7406\u6a21\u5757\uff0c\u63d0\u4f9b\u4e86\u4e00\u5957\u52a8\u6001\u7ba1\u7406\u7cfb\u7edf\u5185\u5b58\u7684\u673a\u5236\uff0c\u652f\u6301\u7528\u6237\u52a8\u6001\u7684\u7533\u8bf7\u3001\u91ca\u653e\u4e0d\u5b9a\u957f\u5185\u5b58\u5757\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_12","text":"","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_38","text":"1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u52a8\u6001\u5185\u5b58\u7ec4\u4ef6\u5f00\u5173TOS_CFG_MMHEAP_EN\uff1a #define TOS_CFG_MMHEAP_EN 1u 2\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u52a8\u6001\u5185\u5b58\u6c60\u5927\u5c0f\uff1a #define TOS_CFG_MMHEAP_POOL_SIZE 0x2000 3\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_DEMO 512 k_stack_t stack_task_demo[STK_SIZE_TASK_DEMO]; k_task_t task_demo; extern void entry_task_demo(void *arg); void entry_task_demo(void *arg) { void *p = K_NULL, *p_aligned = K_NULL; int i = 0; while (K_TRUE) { if (i == 1) { p = tos_mmheap_alloc(0x30); if (p) { printf(\"alloc: %x\\n\", (cpu_addr_t)p); } } else if (i == 2) { if (p) { printf(\"free: %x\\n\", p); tos_mmheap_free(p); } } else if (i == 3) { p = tos_mmheap_alloc(0x30); if (p) { printf(\"alloc: %x\\n\", (cpu_addr_t)p); } } else if (i == 4) { p_aligned = tos_mmheap_aligned_alloc(0x50, 16); if (p_aligned) { printf(\"aligned alloc: %x\\n\", (cpu_addr_t)p_aligned); if ((cpu_addr_t)p_aligned % 16 == 0) { printf(\"%x is 16 aligned\\n\", (cpu_addr_t)p_aligned); } else { printf(\"should not happen\\n\"); } } } else if (i == 5) { p = tos_mmheap_realloc(p, 0x40); if (p) { printf(\"realloc: %x\\n\", (cpu_addr_t)p); } } else if (i == 6) { if (p) { tos_mmheap_free(p); } if (p_aligned) { tos_mmheap_free(p_aligned); } } tos_task_delay(1000); ++i; } } int main(void) { board_init(); tos_knl_init(); (void)tos_task_create(&task_demo, \"receiver_higher_prio\", entry_task_demo, NULL, 4, stack_task_demo, STK_SIZE_TASK_DEMO, 0); tos_knl_start(); }","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_39","text":"alloc: 20000c8c free: 20000c8c alloc: 20000c8c aligned alloc: 20000cc0 20000cc0 is 16 aligned realloc: 20000d14 \u5b9e\u4f8b\u4ee3\u7801","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#242","text":"","title":"2.4.2 \u9759\u6001\u5185\u5b58"},{"location":"04.Development_Manual/#_40","text":"\u9759\u6001\u5185\u5b58\u7ba1\u7406\u6a21\u5757\uff0c\u63d0\u4f9b\u4e86\u4e00\u5957\u7ba1\u7406\u9759\u6001\u5185\u5b58\u5757\u7684\u673a\u5236\uff0c\u652f\u6301\u7528\u6237\u7533\u8bf7\u3001\u91ca\u653e\u5b9a\u957f\u7684\u5185\u5b58\u5757\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_13","text":"\u521b\u5efa\u9759\u6001\u5185\u5b58\u6c60\u63a5\u53e3\uff1a k_err_t tos_mmblk_pool_create(k_mmblk_pool_t *mbp, void *pool_start, size_t blk_num, size_t blk_size); \u8fd9\u91cc\u8be6\u7ec6\u8bb2\u89e3\u6b64api\u53c2\u6570\u610f\u4e49\uff1a mbp \u9759\u6001\u5185\u5b58\u6c60\u53e5\u67c4\u3002 pool_start \u9759\u6001\u5185\u5b58\u6c60\u8d77\u59cb\u5730\u5740\u3002 blk_num \u5185\u5b58\u6c60\u5c06\u8981\u5212\u5206\u7684\u5185\u5b58\u5757\u4e2a\u6570\u3002 blk_size \u6bcf\u4e2a\u5185\u5b58\u5757\u7684\u5927\u5c0f\u3002","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_41","text":"1\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_DEMO 512 k_stack_t stack_task_demo[STK_SIZE_TASK_DEMO]; k_task_t task_demo; #define MMBLK_BLK_NUM 5 #define MMBLK_BLK_SIZE 0x20 k_mmblk_pool_t mmblk_pool; // \u9700\u8981\u7ba1\u7406\u7684\u9759\u6001\u5185\u5b58\u6c60 uint8_t mmblk_pool_buffer[MMBLK_BLK_NUM * MMBLK_BLK_SIZE]; // \u8bb0\u5f55\u4ece\u5185\u5b58\u6c60\u4e2d\u5206\u914d\u5230\u7684\u5730\u5740 void *p[MMBLK_BLK_NUM] = { K_NULL }; extern void entry_task_demo(void *arg); void entry_task_demo(void *arg) { void *p_dummy = K_NULL; k_err_t err; int i = 0; printf(\"mmblk_pool has %d blocks, size of each block is 0x%x\\n\", 5, 0x20); // \u4ece\u5185\u5b58\u6c60\u4e2d\u83b7\u53d6\u6240\u6709\u7684block for (; i < MMBLK_BLK_NUM; ++i) { err = tos_mmblk_alloc(&mmblk_pool, &p[i]); if (err == K_ERR_NONE) { printf(\"%d block alloced: 0x%x\\n\", i, p[i]); } else { printf(\"should not happen\\n\"); } } // \u524d\u6587\u903b\u8f91\u5df2\u7ecf\u5c06\u6240\u6709\u53ef\u7528block\u5206\u914d\u5b8c\u6bd5\uff0c\u7ee7\u7eed\u5206\u914d\u4f1a\u8fd4\u56deK_ERR_MMBLK_POOL_EMPTY\u9519\u8bef\u7801 err = tos_mmblk_alloc(&mmblk_pool, &p_dummy); if (err == K_ERR_MMBLK_POOL_EMPTY) { printf(\"blocks exhausted, all blocks is alloced\\n\"); } else { printf(\"should not happen\\n\"); } // \u5c06\u524d\u6587\u5206\u914d\u5f97\u5230\u7684\u6240\u6709block\u5f52\u8fd8\u5230\u6c60\u4e2d for (i = 0; i < MMBLK_BLK_NUM; ++i) { err = tos_mmblk_free(&mmblk_pool, p[i]); if (err != K_ERR_NONE) { printf(\"should not happen\\n\"); } } // \u524d\u6587\u7684\u5f52\u8fd8\u52a8\u4f5c\u4e2d\u5df2\u7ecf\u5c06\u6240\u6709\u7684block\u5f52\u8fd8\u5230\u6c60\u4e2d\uff0c\u7ee7\u7eed\u89c4\u8303\u4f1a\u8fd4\u56deK_ERR_MMBLK_POOL_FULL\u9519\u8bef\u7801 err = tos_mmblk_free(&mmblk_pool, p[0]); if (err == K_ERR_MMBLK_POOL_FULL) { printf(\"pool is full\\n\"); } else { printf(\"should not happen\\n\"); } } int main(void) { board_init(); tos_knl_init(); // \u521b\u5efa\u9759\u6001\u5185\u5b58\u6c60 tos_mmblk_pool_create(&mmblk_pool, mmblk_pool_buffer, MMBLK_BLK_NUM, MMBLK_BLK_SIZE); (void)tos_task_create(&task_demo, \"receiver_higher_prio\", entry_task_demo, NULL, 4, stack_task_demo, STK_SIZE_TASK_DEMO, 0); tos_knl_start(); }","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_42","text":"mmblk_pool has 5 blocks, size of each block is 0x20 0 block alloced: 0x20000974 1 block alloced: 0x20000994 2 block alloced: 0x200009b4 3 block alloced: 0x200009d4 4 block alloced: 0x200009f4 blocks exhausted, all blocks is alloced pool is full \u5b9e\u4f8b\u4ee3\u7801","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#25","text":"","title":"2.5 \u65f6\u95f4\u7ba1\u7406"},{"location":"04.Development_Manual/#_43","text":"\u65f6\u95f4\u7ba1\u7406\uff0c\u63d0\u4f9b\u4e86\u4e00\u65cf\u4e0e\u65f6\u95f4\u76f8\u5173\u7684\u51fd\u6570\uff0c\u53ef\u4ee5\u83b7\u53d6/\u8bbe\u7f6e\u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570\uff08systick\uff09\u3001systick\u4e0e\u6beb\u79d2\u5355\u4f4d\u4e4b\u95f4\u4e92\u76f8\u8f6c\u5316\u3001\u6309\u6beb\u79d2\u3001\u5899\u4e0a\u65f6\u949f\u7b49\u5355\u4f4d\u8fdb\u884c\u4efb\u52a1\u7761\u7720\u7684\u529f\u80fd\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_14","text":"","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_44","text":"1\u3001\u914d\u7f6e\u6bcf\u79d2\u949f\u7684\u7cfb\u7edf\u6ef4\u7b54\u6570TOS_CFG_CPU_TICK_PER_SECOND\uff1a #define TOS_CFG_CPU_TICK_PER_SECOND 1000u 2\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_DEMO 512 k_stack_t stack_task_demo[STK_SIZE_TASK_DEMO]; k_task_t task_demo; extern void entry_task_demo(void *arg); void entry_task_demo(void *arg) { k_time_t ms; k_tick_t systick, after_systick; // \u56e0\u4e3aTOS_CFG_CPU_TICK_PER_SECOND\u4e3a1000\uff0c\u4e5f\u5c31\u662f\u4e00\u79d2\u949f\u4f1a\u67091000\u4e2asystick\uff0c\u56e0\u6b641000\u4e2asystick\u7b49\u4e8e1000\u6beb\u79d2\u3002 systick = tos_millisec2tick(2000); printf(\"%d millisec equals to %lld ticks\\n\", 2000, systick); ms = tos_tick2millisec(1000); printf(\"%lld ticks equals to %d millisec\\n\", (k_tick_t)1000, ms); systick = tos_systick_get(); printf(\"before sleep, systick is %lld\\n\", systick); tos_msleep(2000); after_systick = tos_systick_get(); printf(\"after sleep %d ms, systick is %lld\\n\", 2000, after_systick); printf(\"milliseconds sleep is about: %d\\n\", tos_ticks2millisec(after_systick - systick)); } int main(void) { board_init(); tos_knl_init(); (void)tos_task_create(&task_demo, \"receiver_higher_prio\", entry_task_demo, NULL, 4, stack_task_demo, STK_SIZE_TASK_DEMO, 0); tos_knl_start(); }","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_45","text":"2000 millisec equals to 2000 ticks 1000 ticks equals to 1000 millisec before sleep, systick is 7 after sleep 2000 ms, systick is 2009 milliseconds sleep is about: 2002 \u5b9e\u4f8b\u4ee3\u7801","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#26","text":"","title":"2.6 \u8f6f\u4ef6\u5b9a\u65f6\u5668"},{"location":"04.Development_Manual/#_46","text":"\u8f6f\u4ef6\u5b9a\u65f6\u5668\u63d0\u4f9b\u4e86\u4e00\u5957\u4ece\u8f6f\u4ef6\u5c42\u6b21\u5b9e\u73b0\u7684\u5b9a\u65f6\u5668\u673a\u5236\uff0c\u76f8\u5bf9\u5e94\u7684\u6982\u5ff5\u662f\u786c\u4ef6\u5b9a\u65f6\u5668\u3002\u7528\u6237\u53ef\u4ee5\u521b\u5efa\u4e00\u7cfb\u5217\u7684\u8f6f\u4ef6\u5b9a\u65f6\u5668\uff0c\u5e76\u6307\u5b9a\u8f6f\u4ef6\u5b9a\u65f6\u5668\u5230\u671f\u7684\u6761\u4ef6\u4ee5\u53ca\u6267\u884c\u56de\u8c03\uff0c\u5f53\u8f6f\u4ef6\u5b9a\u65f6\u5668\u5230\u671f\u65f6\u4f1a\u6267\u884c\u6ce8\u518c\u7684\u56de\u8c03\u3002 \u901a\u5e38\u6765\u8bf4\uff0c\u7528\u6237\u6ce8\u518c\u7684\u8f6f\u4ef6\u5b9a\u65f6\u5668\u56de\u8c03\u4e2d\u5f88\u53ef\u80fd\u5305\u542b\u5ef6\u8fdf\u52a8\u4f5c\u6216\u540c\u6b65\u7b49\u5f85\u64cd\u4f5c\uff0c\u6216\u8005\u56de\u8c03\u51fd\u6570\u672c\u8eab\u903b\u8f91\u590d\u6742\u6267\u884c\u8017\u65f6\u8f83\u957f\uff0c\u56e0\u6b64\u7cfb\u7edf\u5c06\u8f6f\u4ef6\u5b9a\u65f6\u5668\u7ba1\u7406\u903b\u8f91\u8bbe\u8ba1\u6210\u4e00\u4e2a\u4efb\u52a1\uff0c\u5728\u8fd9\u4e2a\u4efb\u52a1\u4e2d\u626b\u63cf\u5b9a\u65f6\u5668\u662f\u5426\u8fc7\u671f\u5e76\u6267\u884c\u5b9a\u65f6\u5668\u56de\u8c03\u3002\u4f46\u662f\u5982\u4f60\u6240\u77e5\uff0c\u521b\u5efa\u4e00\u4e2a\u4efb\u52a1\u662f\u9700\u8981\u6d88\u8017\u7cfb\u7edf\u5185\u5b58\u8d44\u6e90\u7684\uff08\u4efb\u52a1\u7684\u6808\u3001\u4efb\u52a1\u53e5\u67c4\u672c\u8eab\u7684\u5185\u5b58\u7a7a\u95f4\u7b49\u7b49\uff09\uff0c\u800c\u5982\u679c\u7528\u6237\u6ce8\u518c\u7684\u8f6f\u4ef6\u5b9a\u65f6\u5668\u56de\u8c03\u4e2d\u5e76\u4e0d\u5305\u542b\u5ef6\u8fdf\u52a8\u4f5c\u4e5f\u4e0d\u5305\u542b\u540c\u6b65\u7b49\u5f85\u64cd\u4f5c\uff0c\u6216\u8005\u56de\u8c03\u672c\u8eab\u6267\u884c\u8017\u65f6\u5f88\u77ed\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u8f6f\u4ef6\u5b9a\u65f6\u5668\u7ba1\u7406\u903b\u8f91\u65e0\u9700\u88ab\u8bbe\u8ba1\u6210\u4efb\u52a1\uff0c\u800c\u662f\u53ef\u4ee5\u88ab\u8bbe\u8ba1\u6210\u65f6\u949f\u4e2d\u65ad\u4e2d\u88ab\u8c03\u7528\u7684\u4e00\u4e2a\u51fd\u6570\u3002\u5f53\u8f6f\u4ef6\u5b9a\u65f6\u5668\u7ba1\u7406\u903b\u8f91\u88ab\u8bbe\u8ba1\u6210\u4e00\u4e2a\u51fd\u6570\u65f6\uff0c\u5c31\u53ef\u4ee5\u8282\u7701\u521b\u5efa\u4efb\u52a1\u6240\u9700\u7684\u8d44\u6e90\u3002 \u7cfb\u7edf\u9ed8\u8ba4\u91c7\u7528\u7684\u5b9e\u73b0\u662f\u5c06\u5b9a\u65f6\u5668\u7ba1\u7406\u903b\u8f91\u8bbe\u8ba1\u4e3a\u4efb\u52a1\uff0c\u5f53\u7528\u6237\u7684\u5b9a\u65f6\u5668\u56de\u8c03\u90fd\u662f\u8017\u65f6\u6781\u77ed\u7684\u64cd\u4f5c\u65f6\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u5c06\u8f6f\u4ef6\u5b9a\u65f6\u5668\u7ba1\u7406\u903b\u8f91\u914d\u7f6e\u4e3a\u51fd\u6570\u6765\u8282\u7701\u5185\u5b58\u8d44\u6e90\u3002\u901a\u8fc7\u5728tos_config.h\u4e2d\u6253\u5f00TOS_CFG_TIMER_AS_PROC\u5f00\u5173\u6765\u8bb2\u8f6f\u4ef6\u5b9a\u65f6\u5668\u7ba1\u7406\u903b\u8f91\u914d\u7f6e\u4e3a\u51fd\u6570\uff1a #define TOS_CFG_TIMER_AS_PROC 1u","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_15","text":"k_err_t tos_timer_create(k_timer_t *tmr, k_tick_t delay, k_tick_t period, k_timer_callback_t callback, void *cb_arg, k_opt_t opt) \u8fd9\u91cc\u8be6\u7ec6\u8bb2\u89e3\u6b64api\u53c2\u6570\u610f\u4e49\uff1a tmr \u8f6f\u4ef6\u5b9a\u65f6\u5668\u53e5\u67c4\u3002 delay \u8be5\u5b9a\u65f6\u5668\u5ef6\u8fdf\u591a\u4e45\u540e\u6267\u884c\u3002 period \u4e00\u4e2a\u5b9a\u65f6\u5668\u7684\u6267\u884c\u5468\u671f\u3002 callback \u5b9a\u65f6\u5668\u5230\u671f\u540e\u7684\u6267\u884c\u56de\u8c03\u3002 cb_arg \u6267\u884c\u56de\u8c03\u7684\u5165\u53c2\u3002 opt \u6b64opt\u7684\u4f20\u5165\u4e3b\u8981\u662f\u754c\u5b9atmr\u7684\u5c5e\u6027\uff0c\u5982\u679c\u4f20\u5165\u7684\u662fTOS_OPT_TIMER_ONESHOT\uff0c\u8868\u660e\u6b64tmr\u662f\u4e00\u6b21\u6027\u7684\uff0c\u5f53delay\u65f6\u95f4\u5230\u671f\uff0ctmr\u7684\u6267\u884c\u56de\u8c03\u8c03\u7528\u5b8c\u6bd5\u540e\u6b64tmr\u751f\u547d\u5468\u671f\u5c31\u7ed3\u675f\u4e86\uff1b\u5982\u679c\u4f20\u5165\u7684\u662fTOS_OPT_TIMER_PERIODIC\uff0c\u8868\u660e\u6b64tmr\u662f\u5468\u671f\u6027\u5b9a\u65f6\u5668\uff0c\u5f53tmr\u5b9a\u65f6\u65f6\u95f4\u5230\u671f\uff0ctmr\u7684\u6267\u884c\u56de\u8c03\u8c03\u7528\u5b8c\u6bd5\u540e\uff0c\u7cfb\u7edf\u4f1a\u91cd\u65b0\u6309period\u53c2\u6570\u4e3a\u5230\u671f\u65f6\u95f4\u5c06tmr\u52a0\u5165\u5230\u5b9a\u65f6\u961f\u5217\uff0c\u5f00\u542f\u4e0b\u4e00\u4e2a\u5468\u671f\u3002","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_47","text":"1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u8f6f\u4ef6\u5b9a\u65f6\u5668\u7ec4\u4ef6\u5f00\u5173TOS_CFG_TIMER_EN\uff1a #define TOS_CFG_TIMER_EN 1000u 2\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_DEMO 512 k_stack_t stack_task_demo[STK_SIZE_TASK_DEMO]; k_task_t task_demo; extern void entry_task_demo(void *arg); void oneshot_timer_cb(void *arg) { printf(\"this is oneshot timer callback, current systick: %lld\\n\", tos_systick_get()); } void periodic_timer_cb(void *arg) { printf(\"this is periodic timer callback, current systick: %lld\\n\", tos_systick_get()); } void entry_task_demo(void *arg) { k_timer_t oneshot_tmr; k_timer_t periodic_tmr; // \u8fd9\u662f\u4e00\u4e2a\u4e00\u6b21\u6027\u7684timer\uff0c\u4e14\u8d85\u65f6\u65f6\u95f4\u662f3000\u4e2atick\u4e4b\u540e tos_timer_create(&oneshot_tmr, 3000, 0, oneshot_timer_cb, K_NULL, TOS_OPT_TIMER_ONESHOT); // \u8fd9\u662f\u4e00\u4e2a\u5468\u671f\u6027\u7684timer\uff0c\u7b2c\u4e00\u6b21\u8d85\u65f6\u65f6\u95f4\u662f2000\u4e2atick\u4e4b\u540e\uff0c\u4e4b\u540e\u63093000\u4e2atick\u4e3a\u5468\u671f\u6267\u884c\u56de\u8c03 tos_timer_create(&periodic_tmr, 2000, 3000, periodic_timer_cb, K_NULL, TOS_OPT_TIMER_PERIODIC); printf(\"current systick: %lld\\n\", tos_systick_get()); tos_timer_start(&oneshot_tmr); tos_timer_start(&periodic_tmr); while (K_TRUE) { tos_task_delay(1000); } } int main(void) { board_init(); tos_knl_init(); (void)tos_task_create(&task_demo, \"receiver_higher_prio\", entry_task_demo, NULL, 4, stack_task_demo, STK_SIZE_TASK_DEMO, 0); tos_knl_start(); }","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_48","text":"current systick: 0 this is periodic timer callback, current systick: 2001 this is oneshot timer callback, current systick: 3001 this is periodic timer callback, current systick: 5001 this is periodic timer callback, current systick: 8001 this is periodic timer callback, current systick: 11001 this is periodic timer callback, current systick: 14001 \u5b9e\u4f8b\u4ee3\u7801","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#27","text":"","title":"2.7 \u65f6\u95f4\u7247\u8f6e\u8f6c\u673a\u5236"},{"location":"04.Development_Manual/#_49","text":"TencentOS tiny\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u662f\u4e00\u4e2a\u62a2\u5360\u5f0f\u5185\u6838\uff0c\u62a2\u5360\u5f0f\u5185\u6838\u7684\u7279\u70b9\u662f\uff0c\u5982\u679c\u6700\u9ad8\u4f18\u5148\u7ea7\u7684\u4efb\u52a1\u4e0d\u653e\u5f03CPU\uff08\u8c03\u7528tos_task_delay\u3001tos_task_yeild\u7b49\u4e3b\u52a8\u653e\u6743\uff0c\u6216\u8005\u4efb\u52a1\u95f4\u540c\u6b65\u901a\u4fe1\u673a\u5236\u7684pend\u63a5\u53e3\u7b49\uff09\uff0c\u90a3\u4e48CPU\u5c06\u4f1a\u4e00\u76f4\u88ab\u6b64\u4efb\u52a1\u72ec\u5360\u3002 \u5047\u8bbe\u8fd9\u6837\u4e00\u79cd\u573a\u666f\uff1a\u7cfb\u7edf\u4e2d\u5305\u542b\u591a\u4e2a\u540c\u7b49\u4f18\u5148\u7ea7\u7684\u4efb\u52a1\uff0c\u4e14\u8fd9\u51e0\u4e2a\u4efb\u52a1\u4f53\u4e2d\u90fd\u6ca1\u6709\u653e\u5f03CPU\u7684\u884c\u4e3a\uff0c\u5219\u4f1a\u51fa\u73b0\u7684\u60c5\u51b5\u662f\uff0c\u8fd9\u51e0\u4e2a\u4efb\u52a1\u59cb\u7ec8\u53ea\u6709\u7b2c\u4e00\u4e2a\u88ab\u5f97\u5230\u8c03\u5ea6\u7684\u90a3\u4e2a\u5728\u8fd0\u884c\uff0c\u56e0\u4e3a\u7b2c\u4e00\u4e2a\u5f97\u5230\u8c03\u5ea6\u7684\u4efb\u52a1\u4f53\u4e2d\u4e0d\u4f1a\u4e3b\u52a8\u653e\u5f03CPU\uff0c\u800c\u5176\u4ed6\u4efb\u52a1\u4f18\u5148\u7ea7\u4e0a\u4e0e\u5176\u76f8\u7b49\u65e0\u6cd5\u62a2\u5360\u3002\u6b64\u79cd\u573a\u666f\u4e0b\uff0c\u5176\u4ed6\u4efb\u52a1\u4f1a\u56e0\u5f97\u4e0d\u5230CPU\u800c\u9677\u5165\u9965\u997f\u72b6\u6001\u3002 \u65f6\u95f4\u7247\u8f6e\u8f6c\u673a\u5236\u63d0\u4f9b\u4e86\u6309\u65f6\u95f4\u7247\u5360\u7528\u8c03\u5ea6\u7684\u7b56\u7565\uff0c\u53ef\u4ee5\u89e3\u51b3\u4e0a\u8ff0\u573a\u666f\u4e0b\u7684\u4efb\u52a1\u9965\u997f\u95ee\u9898\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_16","text":"","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_50","text":"1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u65f6\u95f4\u7247\u8f6e\u8f6c\u7ec4\u4ef6\u5f00\u5173TOS_CFG_ROUND_ROBIN_EN\uff1a #define TOS_CFG_ROUND_ROBIN_EN 1u 2\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_DEMO 512 #define STK_SIZE_TASK_SAMPLE 512 /* \u6b64\u4ee3\u7801\u4e2d\u521b\u5efa\u4e86\u4e24\u4e2a\u540c\u7b49\u4f18\u5148\u7ea7\uff08PRIO_TASK_DEMO\uff09\u7684\u4efb\u52a1task_demo1\u3001task_demo2\uff0c\u4e24\u4e2a\u4efb\u52a1\u4f53\u4e2d\u505a\u7684\u64cd\u4f5c\u662f\u4e0d\u65ad\u5bf9\u5404\u81ea\u7684\u8ba1\u6570\u5668\uff08demo1_counter\u3001demo2_counter\uff09\u505a\u81ea\u589e\u64cd\u4f5c\uff08\u6ca1\u6709\u653e\u5f03CPU\u7684\u64cd\u4f5c\uff09\uff0c\u65f6\u95f4\u7247\u5206\u522b\u4e3atimeslice_demo1\u3001timeslice_demo2\u3002 \u540c\u65f6\u521b\u5efa\u4e86\u4e00\u4e2a\u4f18\u5148\u7ea7\u6bd4task_demo1\u3001task_demo2\u8f83\u9ad8\u7684\u91c7\u6837\u4efb\u52a1task_sample\uff0c\u6b64\u4efb\u52a1\u4e0d\u95f4\u6b47\u7684\u5bf9\u4e24\u4e2a\u8ba1\u6570\u5668\u8fdb\u884c\u91c7\u6837\u3002\u5728\u5f00\u542f\u65f6\u95f4\u7247\u8f6e\u8f6c\u7684\u60c5\u51b5\u4e0b\uff0ctask_demo1\u3001task_demo2\u5f97\u5230\u8fd0\u884c\u7684\u65f6\u95f4\u6bd4\u4f8b\u5e94\u8be5\u662ftimeslice_demo1\u4e0etimeslice_demo2\u7684\u6bd4\u4f8b\uff0c\u90a3\u4e48demo1_counter\u548cdemo2_counter\u503c\u7684\u6bd4\u4f8b\u5e94\u8be5\u4e5f\u5dee\u4e0d\u591a\u662ftimeslice_demo1\u4e0etimeslice_demo2\u7684\u6bd4\u4f8b\u3002 */ // task_demo1\u548ctask_demo2\u7684\u4f18\u5148\u7ea7 #define PRIO_TASK_DEMO 4 // \u91c7\u6837\u4efb\u52a1\u7684\u4f18\u5148\u7ea7 #define PRIO_TASK_SAMPLE (PRIO_TASK_DEMO - 1) // task_demo1\u7684\u65f6\u95f4\u7247\uff0c\u5728tos_task_create\u65f6\u4f20\u5165 const k_timeslice_t timeslice_demo1 = 10; // task_demo2\u7684\u65f6\u95f4\u7247\uff0c\u5728tos_task_create\u65f6\u4f20\u5165 const k_timeslice_t timeslice_demo2 = 20; k_stack_t stack_task_demo1[STK_SIZE_TASK_DEMO]; k_stack_t stack_task_demo2[STK_SIZE_TASK_DEMO]; k_stack_t stack_task_sample[STK_SIZE_TASK_SAMPLE]; k_task_t task_demo1; k_task_t task_demo2; k_task_t task_sample; extern void entry_task_demo1(void *arg); extern void entry_task_demo2(void *arg); extern void entry_task_sample(void *arg); uint64_t demo1_counter = 0; uint64_t demo2_counter = 0; void entry_task_demo1(void *arg) { while (K_TRUE) { ++demo1_counter; } } void entry_task_demo2(void *arg) { while (K_TRUE) { ++demo2_counter; } } void entry_task_sample(void *arg) { while (K_TRUE) { ++demo2_counter; printf(\"demo1_counter: %lld\\n\", demo1_counter); printf(\"demo2_counter: %lld\\n\", demo2_counter); printf(\"demo2_counter / demo1_counter = %f\\n\", (double)demo2_counter / demo1_counter); printf(\"should almost equals to:\\n\"); printf(\"timeslice_demo2 / timeslice_demo1 = %f\\n\\n\", (double)timeslice_demo2 / timeslice_demo1); tos_task_delay(1000); } } int main(void) { board_init(); tos_knl_init(); // \u914d\u7f6erobin\u673a\u5236\u53c2\u6570 tos_robin_default_timeslice_config((k_timeslice_t)500u); (void)tos_task_create(&task_demo1, \"demo1\", entry_task_demo1, NULL, PRIO_TASK_DEMO, stack_task_demo1, STK_SIZE_TASK_DEMO, timeslice_demo1); (void)tos_task_create(&task_demo2, \"demo2\", entry_task_demo2, NULL, PRIO_TASK_DEMO, stack_task_demo2, STK_SIZE_TASK_DEMO, timeslice_demo2); (void)tos_task_create(&task_sample, \"sample\", entry_task_sample, NULL, PRIO_TASK_SAMPLE, stack_task_sample, STK_SIZE_TASK_SAMPLE, 0); tos_knl_start(); }","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_51","text":"demo1_counter: 0 demo2_counter: 1 demo2_counter / demo1_counter = 0.000000 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 demo1_counter: 1915369 demo2_counter: 3720158 demo2_counter / demo1_counter = 1.942267 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 demo1_counter: 3774985 demo2_counter: 7493508 demo2_counter / demo1_counter = 1.985043 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 demo1_counter: 5634601 demo2_counter: 11266858 demo2_counter / demo1_counter = 1.999584 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 demo1_counter: 7546896 demo2_counter: 14987015 demo2_counter / demo1_counter = 1.985852 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 demo1_counter: 9406512 demo2_counter: 18759340 demo2_counter / demo1_counter = 1.994293 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 demo1_counter: 11266128 demo2_counter: 22531664 demo2_counter / demo1_counter = 1.999947 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 demo1_counter: 13177398 demo2_counter: 26251821 demo2_counter / demo1_counter = 1.992185 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 demo1_counter: 15037014 demo2_counter: 30023632 demo2_counter / demo1_counter = 1.996649 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 demo1_counter: 16896630 demo2_counter: 33795443 demo2_counter / demo1_counter = 2.000129 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 demo1_counter: 18807900 demo2_counter: 37515600 demo2_counter / demo1_counter = 1.994672 should almost equals to: timeslice_demo2 / timeslice_demo1 = 2.000000 \u5b9e\u4f8b\u4ee3\u7801","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#28","text":"","title":"2.8 \u5185\u6838\u57fa\u7840\u7ec4\u4ef6"},{"location":"04.Development_Manual/#281","text":"","title":"2.8.1 \u73af\u5f62\u961f\u5217"},{"location":"04.Development_Manual/#_52","text":"\u73af\u5f62\u961f\u5217\u672c\u8d28\u4e0a\u5c31\u662f\u652f\u6301\u5148\u5165\u5148\u51fa\u64cd\u4f5c\u7684\u73af\u5f62buffer\uff0c\u662f\u7cfb\u7edf\u7684\u4e00\u4e2a\u57fa\u7840\u7ec4\u4ef6\uff0c\u901a\u5e38\u7528\u6765\u4f5c\u4e3a\u5b9e\u73b0\u4e0a\u5c42\u673a\u5236\u7684\u5e95\u5c42\u6570\u636e\u5bb9\u5668\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_17","text":"","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_53","text":"1\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_DEMO 512 #define PRIO_TASK_DEMO 4 k_stack_t stack_task_demo[STK_SIZE_TASK_DEMO]; k_task_t task_demo; typedef struct item_st { int a; int b; int c; } item_t; #define RING_QUEUE_ITEM_MAX 5 uint8_t ring_q_buffer[RING_QUEUE_ITEM_MAX * sizeof(item_t)]; k_ring_q_t rinq_q; void entry_task_demo(void *arg) { k_err_t err; int i = 0; item_t item; size_t item_size; tos_ring_q_create(&rinq_q, ring_q_buffer, RING_QUEUE_ITEM_MAX, sizeof(item_t)); for (i = 0; i < RING_QUEUE_ITEM_MAX; ++i) { printf(\"enqueue: %d %d %d\\n\", i, i, i); item.a = i; item.b = i; item.c = i; err = tos_ring_q_enqueue(&rinq_q, &item, sizeof(item_t)); if (err != K_ERR_NONE) { printf(\"should never happen\\n\"); } } err = tos_ring_q_enqueue(&rinq_q, &item, sizeof(item_t)); if (err == K_ERR_RING_Q_FULL) { printf(\"ring queue is full: %s\\n\", tos_ring_q_is_full(&rinq_q) ? \"TRUE\" : \"FALSE\"); } else { printf(\"should never happen\\n\"); } for (i = 0; i < RING_QUEUE_ITEM_MAX; ++i) { err = tos_ring_q_dequeue(&rinq_q, &item, &item_size); if (err == K_ERR_NONE) { printf(\"dequeue: %d %d %d\\n\", item.a, item.b, item.c); } else { printf(\"should never happen\\n\"); } } err = tos_ring_q_dequeue(&rinq_q, &item, &item_size); if (err == K_ERR_RING_Q_EMPTY) { printf(\"ring queue is empty: %s\\n\", tos_ring_q_is_empty(&rinq_q) ? \"TRUE\" : \"FALSE\"); } else { printf(\"should never happen\\n\"); } } int main(void) { board_init(); tos_knl_init(); (void)tos_task_create(&task_demo, \"demo\", entry_task_demo, NULL, PRIO_TASK_DEMO, stack_task_demo, STK_SIZE_TASK_DEMO, 0); tos_knl_start(); }","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_54","text":"enqueue: 0 0 0 enqueue: 1 1 1 enqueue: 2 2 2 enqueue: 3 3 3 enqueue: 4 4 4 ring queue is full: TRUE dequeue: 0 0 0 dequeue: 1 1 1 dequeue: 2 2 2 dequeue: 3 3 3 dequeue: 4 4 4 ring queue is empty: TRUE \u5b9e\u4f8b\u4ee3\u7801","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#282","text":"","title":"2.8.2 \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217"},{"location":"04.Development_Manual/#_55","text":"\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\uff0c\u63d0\u4f9b\u7684\u662f\u4e00\u4e2a\u9762\u5411\u5b57\u7b26\u64cd\u4f5c\u7684\u73af\u5f62\u961f\u5217\u5b9e\u73b0\uff0c\u63d0\u4f9b\u4e86\u57fa\u672c\u7684\u5b57\u7b26\u6d41\u5165\u961f\u51fa\u961f\u64cd\u4f5c\u3002\u672c\u8d28\u4e0a\u5c31\u662f\u73af\u5f62\u961f\u5217\u4e2d\u5143\u7d20\u4e3a\u5b57\u7b26\uff08\u5355\u5b57\u8282\u957f\u5ea6\uff09\u65f6\u7684\u7279\u4f8b\uff0c\u5b9e\u9645\u4e0a\u5b57\u7b26\u6d41\u5148\u51fa\u5148\u51fa\u961f\u5217\u5e95\u5c42\u7684\u5b9e\u73b0\u5c31\u662f\u73af\u5f62\u961f\u5217\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_18","text":"","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_56","text":"1\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_DEMO 512 #define PRIO_TASK_DEMO 4 k_stack_t stack_task_demo[STK_SIZE_TASK_DEMO]; k_task_t task_demo; #define FIFO_BUFFER_SIZE 5 uint8_t fifo_buffer[FIFO_BUFFER_SIZE]; k_chr_fifo_t fifo; extern void entry_task_demo(void *arg); void char_push(void) { k_err_t err; int i = 0; uint8_t data; // \u5f80fifo\u4e2d\u538b\u5165FIFO_BUFFER_SIZE\u4e2a\u5b57\u7b26\uff0c\u5206\u522b\u662fa\u3001b\u3001c\u3001d\u3001e for (i = 0; i < FIFO_BUFFER_SIZE; ++i) { printf(\"char pushed: %c\\n\", 'a' + i); err = tos_chr_fifo_push(&fifo, 'a' + i); if (err != K_ERR_NONE) { printf(\"should never happen\\n\"); } } // fifo\u6700\u591a\u5305\u542bFIFO_BUFFER_SIZE\u4e2a\u5b57\u7b26\uff0c\u4e0a\u6587\u903b\u8f91\u4e2d\u5df2\u7ecf\u538b\u5165\u4e86\u6700\u5927\u7684\u5b57\u7b26\u91cf\uff0c\u6b64\u65f6\u7ee7\u7eed\u538b\u5165\u5b57\u7b26\u4f1a\u8fd4\u56deK_ERR_FIFO_FULL\uff08fifo\u5df2\u6ee1\uff09 err = tos_chr_fifo_push(&fifo, 'z'); if (err == K_ERR_RING_Q_FULL) { printf(\"fifo is full: %s\\n\", tos_chr_fifo_is_full(&fifo) ? \"TRUE\" : \"FALSE\"); } else { printf(\"should never happen\\n\"); } // \u4ecefifo\u4e2d\u628a\u6240\u6709\u7684\u5b57\u7b26\u90fd\u5f39\u51fa\u6765 for (i = 0; i < FIFO_BUFFER_SIZE; ++i) { err = tos_chr_fifo_pop(&fifo, &data); if (err == K_ERR_NONE) { printf(\"%d pop: %c\\n\", i, data); } else { printf(\"should never happen\\n\"); } } // \u6b64\u65f6\u7ee7\u7eed\u5f39\u51fa\u5b57\u7b26\uff0c\u4f1a\u8fd4\u56deK_ERR_FIFO_EMPTY\uff08fifo\u5df2\u7a7a\uff09 err = tos_chr_fifo_pop(&fifo, &data); if (err == K_ERR_RING_Q_EMPTY) { printf(\"fifo is empty: %s\\n\", tos_chr_fifo_is_empty(&fifo) ? \"TRUE\" : \"FALSE\"); } else { printf(\"should never happen\\n\"); } } void stream_push(void) { int count = 0, i = 0; uint8_t stream[FIFO_BUFFER_SIZE] = { 'a', 'b', 'c', 'd', 'e' }; uint8_t stream_dummy[1] = { 'z' }; uint8_t stream_pop[FIFO_BUFFER_SIZE]; // \u538b\u5165\u5b57\u7b26\u6d41\uff0c\u5b57\u7b26\u6d41\u7684\u957f\u5ea6\u662f5\uff0c\u4e0d\u8d85\u8fc7fifo\u7684\u6700\u5927\u957f\u5ea6FIFO_BUFFER_SIZE\uff0c\u4f1a\u538b\u5165\u6210\u529f\uff0c\u5e76\u8fd4\u56de\u538b\u5165\u5b57\u7b26\u6d41\u7684\u957f\u5ea65 count = tos_chr_fifo_push_stream(&fifo, &stream[0], FIFO_BUFFER_SIZE); if (count != FIFO_BUFFER_SIZE) { printf(\"should never happen\\n\"); } // \u7ee7\u7eed\u538b\u5165\u5b57\u7b26\u6d41\uff08\u5373\u4f7f\u662f\u957f\u5ea6\u4e3a1\u7684\u5b57\u7b26\u6d41\uff09\uff0c\u56e0fifo\u5df2\u6ee1\u65e0\u6cd5\u7ee7\u7eed\u538b\u5165\uff0c\u8fd4\u56de\u957f\u5ea60\uff08\u538b\u5165\u5931\u8d25\uff09 count = tos_chr_fifo_push_stream(&fifo, &stream_dummy[0], 1); if (count == 0) { printf(\"fifo is full: %s\\n\", tos_chr_fifo_is_full(&fifo) ? \"TRUE\" : \"FALSE\"); } else { printf(\"should never happen\\n\"); } // \u5c06\u524d\u6587\u4e2d\u538b\u5165\u7684\u5b57\u7b26\u6d41\u5168\u90e8\u5f39\u51fa\uff0c\u8fd4\u56de\u524d\u6587\u538b\u5165\u7684\u5b57\u7b26\u6d41\u957f\u5ea65\uff08\u5f39\u51fa\u7684\u5b57\u7b26\u6d41\u957f\u5ea6\uff09 count = tos_chr_fifo_pop_stream(&fifo, &stream_pop[0], FIFO_BUFFER_SIZE); if (count == FIFO_BUFFER_SIZE) { printf(\"stream popped:\\n\"); for (i = 0; i < FIFO_BUFFER_SIZE; ++i) { printf(\"%c\", stream_pop[i]); } printf(\"\\n\"); } else { printf(\"should never happen\\n\"); } // \u7ee7\u7eed\u5f39\u51fa\uff0c\u56e0fifo\u5df2\u7a7a\uff0c\u8fd4\u56de0 count = tos_chr_fifo_pop_stream(&fifo, &stream_pop[0], 1); if (count == 0) { printf(\"fifo is empty: %s\\n\", tos_chr_fifo_is_empty(&fifo) ? \"TRUE\" : \"FALSE\"); } else { printf(\"should never happen\\n\"); } } void entry_task_demo(void *arg) { // \u521b\u5efa\u4e86\u4e00\u4e2a\u6700\u591a\u5305\u542bFIFO_BUFFER_SIZE\u4e2a\u5b57\u7b26\u7684fifo tos_chr_fifo_create(&fifo, &fifo_buffer[0], FIFO_BUFFER_SIZE); printf(\"fifo, dealing with char\\n\"); char_push(); printf(\"fifo, dealing with stream\\n\"); stream_push(); } int main(void) { board_init(); tos_knl_init(); (void)tos_task_create(&task_demo, \"demo\", entry_task_demo, NULL, PRIO_TASK_DEMO, stack_task_demo, STK_SIZE_TASK_DEMO, 0); tos_knl_start(); }","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_57","text":"fifo, dealing with char char pushed: a char pushed: b char pushed: c char pushed: d char pushed: e fifo is full: TRUE 0 pop: a 1 pop: b 2 pop: c 3 pop: d 4 pop: e fifo is empty: TRUE fifo, dealing with stream fifo is full: TRUE stream popped: abcde fifo is empty: TRUE \u5b9e\u4f8b\u4ee3\u7801","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#283","text":"","title":"2.8.3 \u4e8c\u9879\u5806"},{"location":"04.Development_Manual/#_58","text":"\u6b64\u7ec4\u4ef6\u7528\u6765\u5185\u90e8\u5b9e\u73b0\u4f18\u5148\u7ea7\u961f\u5217\uff0c\u4e0d\u63a8\u8350\u7528\u6237\u4f7f\u7528\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#284","text":"","title":"2.8.4 \u4f18\u5148\u7ea7\u961f\u5217"},{"location":"04.Development_Manual/#_59","text":"\u63d0\u4f9b\u4e86\u57fa\u4e8e\u4f18\u5148\u7ea7\u7684\u961f\u5217\u7ba1\u7406\u3002\u73af\u5f62\u961f\u5217\u7684\u5165\u961f\u51fa\u961f\u89c4\u5219\u662f\u5148\u5165\u961f\u7684\u5148\u51fa\u961f\uff08first in, first out\uff09\uff0c\u4f18\u5148\u7ea7\u961f\u5217\u7684\u51fa\u961f\u987a\u5e8f\u662f\u6309\u7167\u4f18\u5148\u7ea7\u6765\u7684\uff0c\u4f18\u5148\u7ea7\u8f83\u9ad8\u7684\u5143\u7d20\u5148\u51fa\u961f\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_19","text":"","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_60","text":"1\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a /* \u6b64\u6848\u4f8b\u5c55\u793a\u4e86\u4f18\u5148\u7ea7\u961f\u5217\u7684\u51fa\u961f\u89c4\u5219\uff1a\u4f9d\u6b21\u5165\u961f\u4f18\u5148\u7ea7\u4e3a5\u30014\u30013\u30012\u30011\u7684\u5143\u7d20\uff0c\u51fa\u961f\u65f6\u7684\u987a\u5e8f\u662f\u6309\u7167\u4f18\u5148\u7ea7\u6765\u7684\uff0c\u4e5f\u5c31\u662f\u6309\u4f18\u5148\u7ea7\u4ece\u9ad8\u5230\u4f4e\uff08\u6570\u503c\u8d8a\u5927\uff0c\u4f18\u5148\u7ea7\u8d8a\u5c0f\uff09\uff0c\u4f9d\u6b21\u51fa\u961f\u4f18\u5148\u7ea7\u4e3a1\u30012\u30013\u30014\u30015\u5143\u7d20\u3002 */ #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_DEMO 512 #define PRIO_TASK_DEMO 4 k_stack_t stack_task_demo[STK_SIZE_TASK_DEMO]; k_task_t task_demo; typedef struct item_st { int a; int b; int c; } item_t; #define PRIO_QUEUE_ITEM_MAX 5 uint8_t ring_q_buffer[PRIO_QUEUE_ITEM_MAX * sizeof(item_t)]; uint8_t mgr_pool[TOS_PRIO_Q_MGR_ARRAY_SIZE(PRIO_QUEUE_ITEM_MAX)]; k_prio_q_t prio_q; void entry_task_demo(void *arg) { k_err_t err; int i = 0; item_t item; k_prio_t prio; size_t item_size; tos_prio_q_create(&prio_q, mgr_pool, ring_q_buffer, PRIO_QUEUE_ITEM_MAX, sizeof(item_t)); for (i = PRIO_QUEUE_ITEM_MAX; i > 0; --i) { printf(\"enqueue: %d %d %d\\n\", i, i, i); item.a = i; item.b = i; item.c = i; err = tos_prio_q_enqueue(&prio_q, &item, sizeof(item_t), i); if (err != K_ERR_NONE) { printf(\"should never happen\\n\"); } } err = tos_prio_q_enqueue(&prio_q, &item, sizeof(item_t), i); if (err == K_ERR_PRIO_Q_FULL) { printf(\"priority queue is full: %s\\n\", tos_prio_q_is_full(&prio_q) ? \"TRUE\" : \"FALSE\"); } else { printf(\"should never happen\\n\"); } for (i = 0; i < PRIO_QUEUE_ITEM_MAX; ++i) { err = tos_prio_q_dequeue(&prio_q, &item, &item_size, &prio); if (err == K_ERR_NONE) { printf(\"dequeue: %d %d %d, prio: %d\\n\", item.a, item.b, item.c, prio); } else { printf(\"should never happen\\n\"); } } err = tos_prio_q_dequeue(&prio_q, &item, &item_size, &prio); if (err == K_ERR_PRIO_Q_EMPTY) { printf(\"priority queue is empty: %s\\n\", tos_prio_q_is_empty(&prio_q) ? \"TRUE\" : \"FALSE\"); } else { printf(\"should never happen\\n\"); } } int main(void) { board_init(); tos_knl_init(); (void)tos_task_create(&task_demo, \"demo\", entry_task_demo, NULL, PRIO_TASK_DEMO, stack_task_demo, STK_SIZE_TASK_DEMO, 0); tos_knl_start(); }","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_61","text":"enqueue: 5 5 5 enqueue: 4 4 4 enqueue: 3 3 3 enqueue: 2 2 2 enqueue: 1 1 1 priority queue is full: TRUE dequeue: 1 1 1, prio: 1 dequeue: 2 2 2, prio: 2 dequeue: 3 3 3, prio: 3 dequeue: 4 4 4, prio: 4 dequeue: 5 5 5, prio: 5 priority queue is empty: TRUE \u5b9e\u4f8b\u4ee3\u7801","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#29","text":"","title":"2.9 \u529f\u8017\u7ba1\u7406"},{"location":"04.Development_Manual/#291","text":"","title":"2.9.1 \u4f4e\u529f\u8017"},{"location":"04.Development_Manual/#_62","text":"TencentOS tiny\u63d0\u4f9b\u4e86\u591a\u7ea7\u4f4e\u529f\u8017\u7ba1\u7406\u6846\u67b6\u3002\u521d\u7ea7\u4f4e\u529f\u8017\u7684\u65b9\u6848\u662f\uff0c\u5f53\u7cfb\u7edf\u5904\u4e8e\u201c\u7a7a\u95f2\u201d\u72b6\u6001\uff0c\u4e5f\u5373\u8fdb\u5165idle\u4efb\u52a1\u65f6\uff0c\u7cfb\u7edf\u8c03\u7528\u5904\u7406\u5668\uff08\u76ee\u524d\u652f\u6301\u7684\u67b6\u6784\u662farm v7m\uff09\u4f4e\u529f\u8017\u63a5\u53e3\u8fdb\u5165\u77ed\u6682\u7684\u7761\u7720\u6a21\u5f0f\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_20","text":"","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_63","text":"\u5bf9\u4e8e\u521d\u7ea7\u4f4e\u529f\u8017\u6a21\u5f0f\uff0c\u65e0\u9700\u7528\u6237\u7f16\u5199\u4efb\u4f55\u4ee3\u7801\uff0c\u76f4\u63a5\u901a\u8fc7\u5728tos_config.h\u6253\u5f00TOS_CFG_PMR_MGR_EN\u5f00\u5173\u5373\u53ef\uff1a #define TOS_CFG_PWR_MGR_EN 1u","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_64","text":"","title":"\u8fd0\u884c\u6548\u679c"},{"location":"04.Development_Manual/#292-tickless","text":"","title":"2.9.2 tickless"},{"location":"04.Development_Manual/#_65","text":"TencentOS tiny\u7684tickless\u673a\u5236\u63d0\u4f9b\u4e86\u4e00\u5957\u975e\u5468\u671f\u6027\u65f6\u949f\u7684\u65b9\u6848\uff0c\u5728\u7cfb\u7edf\u65e0\u9700systick\u9a71\u52a8\u8c03\u5ea6\u7684\u60c5\u51b5\u4e0b\uff0c\u505c\u6389systick\u3002 \u521d\u7ea7\u529f\u8017\u7ba1\u7406\u65b9\u6848\u4e0b\uff0c\u56e0\u4e3a\u8fd8\u6709\u7cfb\u7edfsystick\u7684\u5b58\u5728\uff0c\u56e0\u6b64\u7cfb\u7edf\u8fdb\u5165idle\u4efb\u52a1\u540e\uff0c\u5e76\u4e0d\u4f1a\u5728\u7761\u7720\u6a21\u5f0f\u4e0b\u505c\u7559\u592a\u4e45\u3002\u8981\u60f3\u8fdb\u5165\u5230\u66f4\u6781\u81f4\u7684\u4f4e\u529f\u8017\u72b6\u6001\uff0c\u9700\u8981\u6682\u505csystick\u3002 arm\u67b6\u6784\u63d0\u4f9b\u4e09\u7ea7\u4f4e\u529f\u8017\u6a21\u5f0f\uff0csleep\u3001stop\u3001standby\u6a21\u5f0f\uff0c\u4e09\u79cd\u6a21\u5f0f\u8fd0\u884c\u529f\u8017\u9010\u6b21\u964d\u4f4e\uff0cstandby\u6a21\u5f0f\u6700\u4f4e\u3002TencentOS tiny\u7684\u5185\u6838\u63d0\u4f9b\u4e86\u7b80\u6d01\u6e05\u6670\u7684\u63a5\u53e3\u6765\u7ba1\u7406\u5404\u7ea7\u6a21\u5f0f\u3002","title":"\u6982\u8ff0"},{"location":"04.Development_Manual/#api_21","text":"void tos_tickless_wkup_alarm_install(k_cpu_lpwr_mode_t mode, k_tickless_wkup_alarm_t *wkup_alarm); \u6b64\u63a5\u53e3\u7528\u4ee5\u5b89\u88c5\u5404\u4f4e\u529f\u8017\u6a21\u5f0f\u4e0b\u7684\u5524\u9192\u95f9\u949f\u3002\u5f53\u5185\u6838\u8fdb\u5165tickless\u6a21\u5f0f\u4e0b\u540e\uff0csystick\u4ee5\u53ca\u505c\u6b62\u4e86\uff0c\u56e0\u6b64\u9700\u8981\u5176\u4ed6\u8ba1\u65f6\u5668\u6765\u5c06CPU\u4ece\u4f4e\u529f\u8017\u6a21\u5f0f\u4e0b\u5524\u9192\u3002 \u6839\u636earm v7m\u7684\u82af\u7247\u89c4\u683c\uff0c\u4e09\u79cd\u6a21\u5f0f\u4e0b\u7684\u5524\u9192\u6e90\u5206\u522b\u4e3a\uff1a sleep CPU\u8fdb\u5165sleep\u6a21\u5f0f\u540e\uff0c\u53ef\u4ee5\u7531systick\u3001\u786c\u4ef6timer\u3001RTC\u65f6\u949f\u5524\u9192\uff08wakeup/alarm\u4e2d\u65ad\uff09\u3002 stop CPU\u8fdb\u5165stop\u6a21\u5f0f\u540e\uff0c\u53ef\u4ee5\u7531RTC\u65f6\u949f\uff08wakeup/alarm\u4e2d\u65ad\uff09\u5524\u9192\u3002 standby CPU\u8fdb\u5165standby\u6a21\u5f0f\u540e\uff0c\u53ea\u53ef\u7531RTC\u65f6\u949f\u7684alarm\u4e2d\u65ad\u5524\u9192\uff08\u8fd8\u53ef\u4ee5\u901a\u8fc7\u5916\u90e8\u7ba1\u811a\u5524\u9192\uff0c\u4f46\u8fd9\u4e0d\u5c5e\u4e8eTencentOS tiny\u5185\u6838\u673a\u5236\u8bbe\u8ba1\u7684\u8303\u7574\uff09\u3002 k_tickless_wkup_alarm_t\u5b9a\u4e49\u5982\u4e0b\uff1a typedef struct k_tickless_wakeup_alarm_st { int (*init)(void); int (*setup)(k_time_t millisecond); int (*dismiss)(void); k_time_t (*max_delay)(void); /* in millisecond */ } k_tickless_wkup_alarm_t; \u4e00\u4e2a\u5524\u9192\u95f9\u949f\u6709\u56db\u4e2a\u6210\u5458\u65b9\u6cd5\uff1a init \u95f9\u949f\u521d\u59cb\u5316\u51fd\u6570\u3002 setup \u95f9\u949f\u8bbe\u5b9a\u51fd\u6570\uff0c\u5165\u53c2\u4e3a\u95f9\u949f\u5230\u671f\u65f6\u95f4\uff08\u5355\u4f4d\u6beb\u79d2\uff09\u3002\u6b64\u95f9\u949f\u5728\u8bbe\u5b9a\u5b8c\u6bd5\u540e\u7684millisecond\u6beb\u79d2\u65f6\u6765\u4e2d\u65ad\u3002 dismiss \u95f9\u949f\u89e3\u9664\u51fd\u6570\uff0c\u6267\u884c\u5b8c\u540e\u95f9\u949f\u4e2d\u65ad\u4e0d\u4f1a\u518d\u6765\u3002 max_delay \u6b64\u95f9\u949f\u6700\u957f\u7684\u5230\u671f\u65f6\u95f4\uff08\u5355\u4f4d\u4e3a\u6beb\u79d2\uff09\u3002 k_err_t tos_tickless_wkup_alarm_init(k_cpu_lpwr_mode_t mode); \u6b64\u51fd\u6570\u7528\u6765\u521d\u59cb\u5316\u7279\u5b9a\u6a21\u5f0f\u4e0b\u7684\u5524\u9192\u95f9\u949f\uff08\u5b9e\u9645\u4e0a\u8c03\u7528\u7684\u662ftos_tickless_wkup_alarm_install\u63a5\u53e3\u4e2d\u5b89\u88c5\u7684k_tickless_wkup_alarm_t\u7684init\u65b9\u6cd5\uff09\u3002 k_err_t tos_pm_cpu_lpwr_mode_set(k_cpu_lpwr_mode_t cpu_lpwr_mode); \u8bbe\u7f6e\u5185\u6838\u5728tickless\u6a21\u5f0f\u4e0b\u8fdb\u5165\u7684CPU\u4f4e\u529f\u8017\u6a21\u5f0f\u3002","title":"API\u8bb2\u89e3"},{"location":"04.Development_Manual/#_66","text":"1\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6e\u4f4e\u529f\u8017\u7ec4\u4ef6\u5f00\u5173TOS_CFG_PWR_MGR_EN\uff1a #define TOS_CFG_PWR_MGR_EN 1u 2\u3001\u5728tos_config.h\u4e2d\uff0c\u914d\u7f6etickless\u7ec4\u4ef6\u5f00\u5173TOS_CFG_TICKLESS_EN\uff1a #define TOS_CFG_TICKLESS_EN 1u 3\u3001\u7f16\u5199main.c\u793a\u4f8b\u4ee3\u7801\uff1a #include \"tos_k.h\" #include \"mcu_init.h\" #define STK_SIZE_TASK_DEMO 512 #define PRIO_TASK_DEMO 4 k_stack_t stack_task_demo[STK_SIZE_TASK_DEMO]; k_task_t task_demo; extern void entry_task_demo(void *arg); void timer_callback(void *arg) { printf(\"timer callback: %lld\\n\", tos_systick_get()); } void entry_task_demo(void *arg) { k_timer_t tmr; // \u521b\u5efa\u4e00\u4e2a\u8f6f\u4ef6\u5b9a\u65f6\u5668\uff0c\u6bcf6000\u4e2atick\u89e6\u53d1\u4e00\u6b21 tos_timer_create(&tmr, 0u, 6000u, timer_callback, K_NULL, TOS_OPT_TIMER_PERIODIC); tos_timer_start(&tmr); // \u6b64\u4efb\u52a1\u4f53\u5185\u6bcf3000\u4e2atick\u8fd0\u884c\u4e00\u6b21 while (K_TRUE) { printf(\"entry task demo: %lld\\n\", tos_systick_get()); tos_task_delay(3000); } } int main(void) { board_init(); tos_knl_init(); (void)tos_task_create(&task_demo, \"demo1\", entry_task_demo, NULL, PRIO_TASK_DEMO, stack_task_demo, STK_SIZE_TASK_DEMO, 0); tos_knl_start(); } 4\u3001\u5b9e\u73b0tos_bsp_tickless_setup\u56de\u8c03\uff08\u53c2\u8003board\\TOS_tiny_EVK_STM32L431CBT6\\BSP\\Src\\tickless\\bsp_pwr_mgr.c\u3001board\\TOS_tiny_EVK_STM32L431CBT6\\BSP\\Src\\tickless\\bsp_tickless_alarm.c\uff09\uff1a #include \"tos_k.h\" #include \"tickless/bsp_pm_device.h\" #include \"tickless/bsp_tickless_alarm.h\" int tos_bsp_tickless_setup(void) { #if TOS_CFG_TICKLESS_EN > 0u // sleep\u6a21\u5f0f\u4e0b\u7684\u5524\u9192\u6e90\uff0c\u57fa\u672c\u5b9a\u65f6\u5668 tos_tickless_wkup_alarm_install(TOS_LOW_POWER_MODE_SLEEP, &tickless_wkup_alarm_tim); // \u521d\u59cb\u5316\u5524\u9192\u6e90\u95f9\u949f tos_tickless_wkup_alarm_init(TOS_LOW_POWER_MODE_SLEEP); // \u8bbe\u7f6etickless\u72b6\u6001\u65f6\u8fdb\u5165sleep\u6a21\u5f0f tos_pm_cpu_lpwr_mode_set(TOS_LOW_POWER_MODE_SLEEP); #endif } 5\u3001\u4e3a\u4e86\u89c2\u5bdf\u5728tickless\u65f6\u662f\u5426\u786e\u5b9e\u6ca1\u6709systick\u4e2d\u65ad\uff0c\u5728tos_sys.c\u7684idle\u4efb\u52a1\u4f53\u5185\u52a0\u4e00\u53e5\u8c03\u8bd5\u4ee3\u7801\uff1a __STATIC__ void knl_idle_entry(void *arg) { arg = arg; // make compiler happy while (K_TRUE) { // \u8fd9\u91cc\u5728idle\u4efb\u52a1\u4f53\u5185\u52a0\u4e0a\u4e00\u53e5\u6253\u5370\uff0c\u5982\u679csystick\u6b63\u5e38\u5f00\u542f\uff0c\u5728\u6ca1\u6709\u7528\u6237\u4efb\u52a1\u8fd0\u884c\u65f6\uff0c\u6b64\u8c03\u8bd5\u4fe1\u606f\u4f1a\u4e0d\u65ad\u6253\u5370\uff1b\u5982\u679c\u662ftickless\u72b6\u6001\uff0c\u6b64\u8c03\u8bd5\u4fe1\u606f\u5e94\u8be5\u53ea\u4f1a\u7b2c\u4e00\u6b21\u8fdb\u5165idle\u4efb\u52a1\u65f6\uff0c\u6216\u5728\u7528\u6237\u4efb\u52a1\u7b49\u5f85\u5230\u671f\uff0c\u6216\u7528\u6237\u7684\u8f6f\u4ef6\u5b9a\u65f6\u5668\u5230\u671f\u65f6\uff0c\u624d\u6253\u5370\u4e00\u6b21\u3002 printf(\"idle entry: %lld\\n\", tos_systick_get()); #if TOS_CFG_PWR_MGR_EN > 0u pm_power_manager(); #endif } }","title":"\u7f16\u7a0b\u5b9e\u4f8b"},{"location":"04.Development_Manual/#_67","text":"entry task demo: 0 idle entry: 2 entry task demo: 3002 idle entry: 3002 timer callback: 6000 idle entry: 6000 entry task demo: 6002 idle entry: 6002 entry task demo: 9002 idle entry: 9002 timer callback: 12000 idle entry: 12000 entry task demo: 12002 idle entry: 12002 entry task demo: 15002 idle entry: 15002 timer callback: 18000 idle entry: 18000 entry task demo: 18002 idle entry: 18002","title":"\u8fd0\u884c\u6548\u679c"},{"location":"05.SDK_Manual/","text":"*TencentOS Tiny SDK\u6587\u6863 *TencentOS Tiny SDK\u6587\u6863 \u5185\u6838API \u7cfb\u7edf\u7ba1\u7406 tos_knl_init tos_knl_start tos_knl_is_running tos_knl_irq_enter tos_knl_irq_leave tos_knl_sched_lock tos_knl_sched_unlock \u4efb\u52a1\u7ba1\u7406 tos_task_create tos_task_create_dyn tos_task_destroy tos_task_destroy_dyn tos_task_delay tos_task_delay_abort tos_task_suspend tos_task_resume tos_task_prio_change tos_task_yield tos_task_stack_draught_depth tos_task_curr_task_get tos_task_walkthru \u5806\u5185\u5b58\u7ba1\u7406 tos_mmheap_pool_add tos_mmheap_pool_rmv tos_mmheap_alloc tos_mmheap_aligned_alloc tos_mmheap_realloc tos_mmheap_free tos_mmheap_pool_check tos_mmheap_check \u5757\u5185\u5b58\u7ba1\u7406 tos_mmblk_pool_create tos_mmblk_alloc tos_mmblk_free \u4e92\u65a5\u91cfmutex tos_mutex_create tos_mutex_destroy tos_mutex_pend tos_mutex_pend_timed tos_mutex_post \u4fe1\u53f7\u91cfsemaphore tos_sem_create tos_sem_create_max tos_sem_destroy tos_sem_pend tos_sem_post tos_sem_post_all \u4e8b\u4ef6event tos_event_create tos_event_destroy tos_event_pend tos_event_post tos_event_post_keep \u5b8c\u6210\u91cfcompletion tos_completion_create tos_completion_destroy tos_completion_pend tos_completion_pend_timed tos_completion_post tos_completion_post_all tos_completion_reset tos_completion_is_done \u8ba1\u6570\u9501countdown latch tos_countdownlatch_create tos_countdownlatch_destroy tos_countdownlatch_pend tos_countdownlatch_pend_timed tos_countdownlatch_post tos_countdownlatch_reset \u6805\u680fbarrier tos_barrier_create tos_barrier_destroy tos_barrier_pend tos_barrier_reset \u8bfb\u5199\u9501rwlock tos_rwlock_create tos_rwlock_destroy tos_rwlock_rpend_timed tos_rwlock_rpend tos_rwlock_rpend_try tos_rwlock_wpend_timed tos_rwlock_wpend tos_rwlock_wpend_try tos_rwlock_rpost tos_rwlock_wpost tos_rwlock_post \u6d88\u606f\u961f\u5217message queue tos_msg_q_create tos_msg_q_create_dyn tos_msg_q_destroy tos_msg_q_destroy_dyn tos_msg_q_flush tos_msg_q_pend tos_msg_q_post tos_msg_q_post_all \u90ae\u7bb1\u961f\u5217mail queue tos_mail_q_create tos_mail_q_create_dyn tos_mail_q_destroy tos_mail_q_destroy_dyn tos_mail_q_flush tos_mail_q_pend tos_mail_q_post tos_mail_q_post_all \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217priority message queue tos_prio_msg_q_create tos_prio_msg_q_create_dyn tos_prio_msg_q_destroy tos_prio_msg_q_destroy_dyn tos_prio_msg_q_flush tos_prio_msg_q_pend tos_prio_msg_q_post tos_prio_msg_q_post_all \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217priority mail queue tos_prio_mail_q_create tos_prio_mail_q_create_dyn tos_prio_mail_q_destroy tos_prio_mail_q_destroy_dyn tos_prio_mail_q_flush tos_prio_mail_q_pend tos_prio_mail_q_post tos_prio_mail_q_post_all \u73af\u5f62\u961f\u5217ring queue tos_ring_q_create tos_ring_q_create_dyn tos_ring_q_destroy tos_ring_q_destroy_dyn tos_ring_q_enqueue tos_ring_q_dequeue tos_ring_q_flush tos_ring_q_is_empty tos_ring_q_is_full \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217fifo tos_chr_fifo_create tos_chr_fifo_create_dyn tos_chr_fifo_destroy tos_chr_fifo_destroy_dyn tos_chr_fifo_push tos_chr_fifo_push_stream tos_chr_fifo_pop tos_chr_fifo_pop_stream tos_chr_fifo_flush tos_chr_fifo_is_empty tos_chr_fifo_is_full \u4e8c\u9879\u5806binary heap tos_bin_heap_create tos_bin_heap_create_dyn tos_bin_heap_destroy tos_bin_heap_destroy_dyn tos_bin_heap_push tos_bin_heap_pop tos_bin_heap_flush tos_bin_heap_is_empty tos_bin_heap_is_full \u4f18\u5148\u7ea7\u961f\u5217priority queue tos_prio_q_create tos_prio_q_create_dyn tos_prio_q_destroy tos_prio_q_destroy_dyn tos_prio_q_enqueue tos_prio_q_dequeue tos_prio_q_flush tos_prio_q_is_empty tos_prio_q_is_full \u5b9a\u65f6\u5668timer tos_timer_create tos_timer_destroy tos_timer_start tos_timer_stop tos_timer_delay_change tos_timer_period_change \u8ba1\u65f6\u8868stopwatch tos_stopwatch_create tos_stopwatch_destroy tos_stopwatch_countdown tos_stopwatch_countdown_ms tos_stopwatch_delay tos_stopwatch_delay_ms tos_stopwatch_remain tos_stopwatch_remain_ms tos_stopwatch_is_expired \u4f4d\u56febitmap tos_bitmap_create_empty tos_bitmap_create_full tos_bitmap_destroy tos_bitmap_set tos_bitmap_reset tos_bitmap_is_set tos_bitmap_is_reset tos_bitmap_lsb \u65f6\u95f4\u7ba1\u7406 tos_systick_get tos_systick_set tos_tick2millisec tos_millisec2tick tos_sleep_ms tos_sleep_hmsm \u529f\u8017\u7ba1\u7406 tos_pm_cpu_lpwr_mode_set tos_pm_device_register tos_tickless_wkup_alarm_install tos_tickless_wkup_alarm_init \u7ec4\u4ef6API MQTT\u7aef\u4e91\u5bf9\u63a5 tos_mqtt_connect tos_mqtt_publish tos_mqtt_subscribe tos_mqtt_receive CMSIS\u9002\u914d\u5c42 osKernelStart osKernelInitialize osKernelRunning osKernelSysTick osThreadCreate osThreadGetId osThreadTerminate osThreadSetPriority osThreadGetPriority osDelay osTimerCreate osTimerStart osTimerStop osTimerDelete osMutexCreate osMutexWait osMutexRelease osMutexDelete osSemaphoreCreate osSemaphoreWait osSemaphoreRelease osSemaphoreDelete osPoolCreate osPoolAlloc osPoolCAlloc osPoolFree osMessageCreate osMessagePut osMessageGet \u7f51\u7edcAPI sal\u6a21\u7ec4\u8054\u7f51\u63a5\u53e3 tos_sal_module_register tos_sal_module_init tos_sal_module_parse_domain tos_sal_module_connect tos_sal_module_send tos_sal_module_recv tos_sal_module_recv_timeout tos_sal_module_sendto tos_sal_module_recvfrom tos_sal_module_close lora\u6a21\u7ec4\u8054\u7f51\u63a5\u53e3 tos_lora_module_register tos_lora_module_init tos_lora_module_join tos_lora_module_send tos_lora_module_recv tos_lora_module_recv_timeout tos_lora_module_close \u817e\u8baf\u5b9a\u5236\u56fa\u4ef6\u6a21\u7ec4\u8054\u7f51\u63a5\u53e3 tos_tf_module_register tos_tf_module_init tos_tf_module_info_set tos_tf_module_mqtt_conn tos_tf_module_mqtt_discon tos_tf_module_mqtt_pub tos_tf_module_mqtt_publ tos_tf_module_mqtt_sub tos_tf_module_mqtt_unsub tos_tf_module_mqtt_state tos_tf_module_debug_level_set \u5185\u6838API \u7cfb\u7edf\u7ba1\u7406 tos_knl_init k_err_t tos_knl_init(void); \u529f\u80fd\u63cf\u8ff0 \u521d\u59cb\u5316\u5185\u6838\u3002 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c K_ERR_NONE \u5185\u6838\u521d\u59cb\u5316\u6210\u529f\u3002 \u975eK_ERR_NONE \u5185\u6838\u521d\u59cb\u5316\u5931\u8d25\u3002 tos_knl_start k_err_t tos_knl_start(void); \u529f\u80fd\u63cf\u8ff0 \u542f\u52a8\u5185\u6838\u3002 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c K_ERR_NONE \u5185\u6838\u542f\u52a8\u6210\u529f\u3002 \u975eK_ERR_NONE \u5185\u6838\u542f\u52a8\u5931\u8d25\u3002 tos_knl_is_running int tos_knl_is_running(void); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u5185\u6838\u662f\u5426\u6b63\u5728\u8fd0\u884c\u3002 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c 0 \u5185\u6838\u4e0d\u5728\u8fd0\u884c\u3002 \u975e0 \u5185\u6838\u6b63\u5728\u8fd0\u884c\u3002 tos_knl_irq_enter void tos_knl_irq_enter(void); \u529f\u80fd\u63cf\u8ff0 \u6b64\u51fd\u6570\u5e94\u8be5\u5728\u4e2d\u65ad\u670d\u52a1\u51fd\u6570\u5f00\u59cb\u4e4b\u524d\u88ab\u8c03\u7528\u3002 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c \u65e0 tos_knl_irq_leave void tos_knl_irq_leave(void); \u529f\u80fd\u63cf\u8ff0 \u6b64\u51fd\u6570\u5e94\u8be5\u5728\u4e2d\u65ad\u670d\u52a1\u51fd\u6570\u7ed3\u675f\u4e4b\u524d\u88ab\u8c03\u7528\u3002 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c \u65e0 tos_knl_sched_lock k_err_t tos_knl_sched_lock(void); \u529f\u80fd\u63cf\u8ff0 \u9501\u5185\u6838\u8c03\u5ea6\u3002 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c K_ERR_NONE \u5185\u6838\u8c03\u5ea6\u9501\u5b9a\u6210\u529f\u3002 K_ERR_KNL_NOT_RUNNING \u5185\u6838\u5e76\u672a\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\u3002 K_ERR_LOCK_NESTING_OVERFLOW \u8c03\u5ea6\u9501\u6ea2\u51fa\u3002 tos_knl_sched_unlock k_err_t tos_knl_sched_unlock(void); \u529f\u80fd\u63cf\u8ff0 \u89e3\u9501\u5185\u6838\u8c03\u5ea6\u3002 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c K_ERR_NONE \u5185\u6838\u8c03\u5ea6\u89e3\u9501\u6210\u529f\u3002 K_ERR_KNL_NOT_RUNNING \u5185\u6838\u5e76\u672a\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\u3002 K_ERR_SCHED_NOT_LOCKED \u5185\u6838\u8c03\u5ea6\u5e76\u672a\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 \u4efb\u52a1\u7ba1\u7406 tos_task_create k_err_t tos_task_create(k_task_t *task, char *name, k_task_entry_t entry, void *arg, k_prio_t prio, k_stack_t *stk_base, size_t stk_size, k_timeslice_t timeslice); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] task \u4efb\u52a1\u7ed3\u6784\u4f53\u63cf\u8ff0\u7b26 [in] name \u4efb\u52a1\u540d\u79f0 [in] entry \u4efb\u52a1\u5165\u53e3\u51fd\u6570 [in] arg \u4efb\u52a1\u5165\u53e3\u51fd\u6570\u53c2\u6570 [in] prio \u4efb\u52a1\u4f18\u5148\u7ea7 [in] stk_base \u4efb\u52a1\u6808\u7a7a\u95f4\u9996\u5730\u5740 [in] stk_size \u4efb\u52a1\u6808\u7a7a\u95f4\u7684\u5927\u5c0f [in] timeslice \u65f6\u95f4\u7247\u8f6e\u8f6c\u8c03\u5ea6\u4fa7\u7b56\u7565\u4e2d\uff0c\u65f6\u95f4\u7247\u7684\u5927\u5c0f\u8bbe\u7f6e\uff0c0\u8868\u793a\u8bbe\u7f6e\u4e3a\u7cfb\u7edf\u9ed8\u8ba4\u503c \u8fd4\u56de\u503c K_ERR_NONE \u4efb\u52a1\u521b\u5efa\u6210\u529f\u3002 K_ERR_TASK_STK_SIZE_INVALID \u975e\u6cd5\u7684\u4efb\u52a1\u6808\u5927\u5c0f\u3002 K_ERR_TASK_PRIO_INVALID \u975e\u6cd5\u7684\u4efb\u52a1\u4f18\u5148\u7ea7\u3002 tos_task_create_dyn k_err_t tos_task_create_dyn(k_task_t **task, char *name, k_task_entry_t entry, void *arg, k_prio_t prio, size_t stk_size, k_timeslice_t timeslice); \u529f\u80fd\u63cf\u8ff0 \u52a8\u6001\u521b\u5efa\u4efb\u52a1\uff0ctask\u53e5\u67c4\u53catask\u6240\u9700\u7684\u6808\u7686\u4e3a\u7cfb\u7edf\u52a8\u6001\u5206\u914d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [out] task \u4efb\u52a1\u7ed3\u6784\u4f53\u63cf\u8ff0\u7b26 [in] name \u4efb\u52a1\u540d\u79f0 [in] entry \u4efb\u52a1\u5165\u53e3\u51fd\u6570 [in] arg \u4efb\u52a1\u5165\u53e3\u51fd\u6570\u53c2\u6570 [in] prio \u4efb\u52a1\u4f18\u5148\u7ea7 [in] stk_size \u4efb\u52a1\u6808\u7a7a\u95f4\u7684\u5927\u5c0f [in] timeslice \u65f6\u95f4\u7247\u8f6e\u8f6c\u8c03\u5ea6\u4fa7\u7b56\u7565\u4e2d\uff0c\u65f6\u95f4\u7247\u7684\u5927\u5c0f\u8bbe\u7f6e\uff0c0\u8868\u793a\u8bbe\u7f6e\u4e3a\u7cfb\u7edf\u9ed8\u8ba4\u503c \u8fd4\u56de\u503c K_ERR_NONE \u4efb\u52a1\u521b\u5efa\u6210\u529f\u3002 K_ERR_TASK_STK_SIZE_INVALID \u975e\u6cd5\u7684\u4efb\u52a1\u6808\u5927\u5c0f\u3002 K_ERR_TASK_PRIO_INVALID \u975e\u6cd5\u7684\u4efb\u52a1\u4f18\u5148\u7ea7\u3002 K_ERR_TASK_OUT_OF_MEMORY \u7cfb\u7edf\u5806\u5185\u5b58\u4e0d\u8db3\u3002 tos_task_destroy k_err_t tos_task_destroy(k_task_t *task) \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] task \u4efb\u52a1\u7ed3\u6784\u4f53\u63cf\u8ff0\u7b26 \u8fd4\u56de\u503c K_ERR_NONE \u4efb\u52a1\u9500\u6bc1\u6210\u529f\u3002 K_ERR_TASK_DESTROY_IDLE \u8bd5\u56fe\u9500\u6bc1idle\u4efb\u52a1\uff08\u975e\u6cd5\uff09\u3002 tos_task_destroy_dyn k_err_t tos_task_destroy_dyn(k_task_t *task) \u529f\u80fd\u63cf\u8ff0 static\u51fd\u6570\uff0c\u975e\u5bf9\u5916\u63a5\u53e3\uff0c\u9500\u6bc1\u52a8\u6001\u521b\u5efa\uff08tos_task_create_dyn\uff09\u7684\u4efb\u52a1\uff0c\u9ed8\u8ba4\u7531tos_task_destroy()\u51fd\u6570\u8c03\u7528\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] task \u4efb\u52a1\u7ed3\u6784\u4f53\u63cf\u8ff0\u7b26 \u8fd4\u56de\u503c K_ERR_NONE \u4efb\u52a1\u9500\u6bc1\u6210\u529f\u3002 K_ERR_TASK_DESTROY_IDLE \u8bd5\u56fe\u9500\u6bc1idle\u4efb\u52a1\uff08\u975e\u6cd5\uff09\u3002 tos_task_delay k_err_t tos_task_delay(k_tick_t delay); \u529f\u80fd\u63cf\u8ff0 \u7761\u7720\u5f53\u524d\u4efb\u52a1\uff0c\u4ee5\u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570\u4e3a\u5355\u4f4d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] delay \u4efb\u52a1\u7761\u7720\u65f6\u95f4 \u8fd4\u56de\u503c K_ERR_NONE \u4efb\u52a1\u5ef6\u8fdf\u6210\u529f\u3002 K_ERR_DELAY_ZERO delay\u503c\u4e3a\u96f6\uff08\u975e\u6cd5\uff09\u3002 tos_task_delay_abort k_err_t tos_task_delay_abort(k_task_t *task); \u529f\u80fd\u63cf\u8ff0 \u53d6\u6d88\u4e00\u4e2a\u4efb\u52a1\u7684delay\u72b6\u6001\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] task \u4efb\u52a1\u7ed3\u6784\u4f53\u63cf\u8ff0\u7b26 \u8fd4\u56de\u503c K_ERR_NONE \u53d6\u6d88delay\u6210\u529f\u3002 K_ERR_TASK_NOT_DELAY task\u5e76\u672a\u5904\u4e8edelay\u72b6\u6001\u3002 K_ERR_TASK_SUSPENDED task\u88ab\u6302\u8d77\uff08suspend\uff09\u3002 tos_task_suspend k_err_t tos_task_suspend(k_task_t *task); \u529f\u80fd\u63cf\u8ff0 \u6302\u8d77\u4e00\u4e2a\u4efb\u52a1\uff08\u5265\u593a\u4e00\u4e2a\u4efb\u52a1\u7684\u8fd0\u884c\u8c03\u5ea6\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] task \u4efb\u52a1\u7ed3\u6784\u4f53\u63cf\u8ff0\u7b26 \u8fd4\u56de\u503c TOS_ERR_NONE \u6302\u8d77\u4efb\u52a1\u6210\u529f\u3002 K_ERR_TASK_SUSPEND_IDLE \u8bd5\u56fe\u6302\u8d77idle\u4efb\u52a1\uff08\u975e\u6cd5\uff09\u3002 tos_task_resume k_err_t tos_task_resume(k_task_t *task); \u529f\u80fd\u63cf\u8ff0 \u6062\u590d\u4e00\u4e2a\u4efb\u52a1\u7684\u8c03\u5ea6\u8fd0\u884c\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] task \u4efb\u52a1\u7ed3\u6784\u4f53\u63cf\u8ff0\u7b26 \u8fd4\u56de\u503c TOS_ERR_NONE \u6062\u590d\u4efb\u52a1\u8fd0\u884c\u6210\u529f\u3002 K_ERR_TASK_RESUME_SELF \u8bd5\u56fe\u6062\u590d\u5f53\u524d\u4efb\u52a1\uff08\u975e\u6cd5\uff09\u3002 tos_task_prio_change k_err_t tos_task_prio_change(k_task_t *task, k_prio_t prio_new); \u529f\u80fd\u63cf\u8ff0 \u66f4\u6539\u4e00\u4e2a\u4efb\u52a1\u7684\u4f18\u5148\u7ea7\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] task \u4efb\u52a1\u7ed3\u6784\u4f53\u63cf\u8ff0\u7b26 [in] prio_new \u65b0\u7684\u4f18\u5148\u7ea7 \u8fd4\u56de\u503c K_ERR_NONE \u4efb\u52a1\u4f18\u5148\u7ea7\u66f4\u65b0\u6210\u529f\u3002 K_ERR_TASK_PRIO_INVALID \u4f18\u5148\u7ea7\u975e\u6cd5\u3002 tos_task_yield void tos_task_yield(void); \u529f\u80fd\u63cf\u8ff0 \u5f53\u524d\u4efb\u52a1\u4e3b\u52a8\u653e\u5f03cpu\u3002 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c \u65e0 tos_task_stack_draught_depth k_err_t tos_task_stack_draught_depth(k_task_t *task, int *depth); \u529f\u80fd\u63cf\u8ff0 \u83b7\u53d6\u4e00\u4e2a\u4efb\u52a1\u6808\u7684\u6700\u5927\u5403\u6c34\u6df1\u5ea6\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] task \u4efb\u52a1\u7ed3\u6784\u4f53\u63cf\u8ff0\u7b26 [out] depth \u4efb\u52a1\u6808\u7684\u5403\u6c34\u6df1\u5ea6 \u8fd4\u56de\u503c K_ERR_NONE \u4efb\u52a1\u6808\u72b6\u6001\u6b63\u5e38\u3002 K_ERR_TASK_STK_OVERFLOW \u4efb\u52a1\u6808\u6ea2\u51fa\u3002 tos_task_curr_task_get k_task_t *tos_task_curr_task_get(void); \u529f\u80fd\u63cf\u8ff0 \u83b7\u53d6\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684\u4efb\u52a1\u53e5\u67c4\u3002 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c K_NULL \u5f53\u524d\u65e0\u6b63\u5728\u8fd0\u884c\u4efb\u52a1\uff08\u5185\u6838\u5c1a\u672a\u542f\u52a8\uff09\u3002 \u975eK_NULL \u4efb\u52a1\u53e5\u67c4\u3002 tos_task_walkthru void tos_task_walkthru(k_task_walker walker); \u529f\u80fd\u63cf\u8ff0 \u904d\u5386\u5f53\u524d\u7cfb\u7edf\u5df2\u521b\u5efa\u7684\uff08\u4e0d\u5305\u62ec\u5df2\u5220\u9664\u7684\uff09\u4efb\u52a1\uff0c\u5e76\u5141\u8bb8\u7528\u6237\u4f20\u5165\u4e00\u4e2a\u56de\u8c03\uff0c\u5728\u904d\u5386\u6240\u6709\u4efb\u52a1\u65f6\uff0c\u5c06\u4efb\u52a1\u53e5\u67c4\u4f5c\u4e3a\u53c2\u6570\u8c03\u7528\u6b64\u56de\u8c03\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] walker \u904d\u5386\u6240\u6709\u4efb\u52a1\u65f6\u88ab\u8c03\u7528\u7684\u56de\u8c03\uff08walker\u4e3a\u4e00\u4e2a\u5165\u53c2\u4e3ak_task_t *\u7684\u51fd\u6570\uff09 \u8fd4\u56de\u503c \u65e0 \u975eK_NULL \u4efb\u52a1\u53e5\u67c4\u3002 \u5806\u5185\u5b58\u7ba1\u7406 tos_mmheap_pool_add k_err_t tos_mmheap_pool_add(void *pool_start, size_t pool_size); \u529f\u80fd\u63cf\u8ff0 \u5411\u5806\u5185\u5b58\u4e2d\u6dfb\u52a0\u5185\u5b58\u6c60\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] pool_start \u5f85\u6dfb\u52a0\u5185\u5b58\u6c60\u8d77\u59cb\u5730\u5740 [in] pool_size \u5f85\u6dfb\u52a0\u5185\u5b58\u6c60\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u6dfb\u52a0\u6210\u529f\u3002 K_ERR_MMHEAP_INVALID_POOL_ADDR \u5185\u5b58\u6c60\u8d77\u59cb\u5730\u5740\u975e\u6cd5\u3002 K_ERR_MMHEAP_INVALID_POOL_SIZE \u5185\u5b58\u6c60\u5927\u5c0f\u975e\u6cd5\u3002 tos_mmheap_pool_rmv k_err_t tos_mmheap_pool_rmv(void *pool_start); \u529f\u80fd\u63cf\u8ff0 \u4ece\u5806\u5185\u5b58\u4e2d\u5220\u9664\u5185\u5b58\u6c60\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] pool_start \u5f85\u5220\u9664\u7684\u5185\u5b58\u6c60\u8d77\u59cb\u5730\u5740 \u8fd4\u56de\u503c \u65e0 tos_mmheap_alloc void *tos_mmheap_alloc(size_t size); \u529f\u80fd\u63cf\u8ff0 \u4ece\u5806\u5185\u5b58\u4e2d\u5206\u914d\u4e00\u5757\u5185\u5b58\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] size \u671f\u671b\u5206\u914d\u7684\u5185\u5b58\u5927\u5c0f \u8fd4\u56de\u503c \u5206\u914d\u5230\u7684\u5185\u5b58\u8d77\u59cb\u5730\u5740\uff08\u8fd4\u56deK_NULL\u8868\u793a\u5206\u914d\u5931\u8d25\uff09\u3002 tos_mmheap_aligned_alloc void *tos_mmheap_aligned_alloc(size_t size, size_t align); \u529f\u80fd\u63cf\u8ff0 \u4ece\u5806\u5185\u5b58\u4e2d\u5206\u914d\u4e00\u5757\u5185\u5b58\uff0c\u6b64\u5185\u5b58\u8d77\u59cb\u5730\u5740\u6309align\u53c2\u6570\u5bf9\u9f50\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] size \u671f\u671b\u5206\u914d\u7684\u5185\u5b58\u5927\u5c0f [in] align \u5bf9\u9f50\u53c2\u6570 \u8fd4\u56de\u503c \u5206\u914d\u5230\u7684\u5185\u5b58\u8d77\u59cb\u5730\u5740\uff08\u8fd4\u56deK_NULL\u8868\u793a\u5206\u914d\u5931\u8d25\uff09\u3002 tos_mmheap_realloc void *tos_mmheap_realloc(void *ptr, size_t size); \u529f\u80fd\u63cf\u8ff0 \u4ece\u5806\u5185\u5b58\u4e2d\u91cd\u65b0\u5206\u914d\u4e00\u5757\u5185\u5b58\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ptr \u539f\u5185\u5b58\u8d77\u59cb\u5730\u5740 [in] size \u671f\u671b\u91cd\u65b0\u5206\u914d\u7684\u5185\u5b58\u5927\u5c0f \u8fd4\u56de\u503c \u5206\u914d\u5230\u7684\u5185\u5b58\u8d77\u59cb\u5730\u5740\uff08\u8fd4\u56deK_NULL\u8868\u793a\u5206\u914d\u5931\u8d25\uff09\u3002 tos_mmheap_free void *tos_mmheap_free(void *ptr); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4e00\u7247\u4ece\u5806\u5185\u5b58\u4e2d\u5206\u914d\u5230\u7684\u5185\u5b58\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ptr \u5f85\u91ca\u653e\u7684\u5185\u5b58\u8d77\u59cb\u5730\u5740 \u8fd4\u56de\u503c \u65e0\u3002 tos_mmheap_pool_check k_err_t tos_mmheap_pool_check(void *pool_start, k_mmheap_info_t *info); \u529f\u80fd\u63cf\u8ff0 \u83b7\u53d6\u5806\u5185\u5b58\u4e2d\u67d0\u4e2a\u6c60\u7684\u4f7f\u7528\u60c5\u51b5\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] pool_start \u5806\u5185\u5b58\u4e2d\u67d0\u4e2a\u6c60\u7684\u8d77\u59cb\u5730\u5740 [out] info \u8be5\u6c60\u7684\u4f7f\u7528\u60c5\u51b5\uff08\u4f7f\u7528\u91cf\u548c\u5269\u4f59\u91cf\u4fe1\u606f\uff09 \u8fd4\u56de\u503c K_ERR_NONE \u51fd\u6570\u8fd4\u56de\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL pool_start\u6216info\u4e3a\u7a7a\u6307\u9488\u3002 tos_mmheap_check k_err_t tos_mmheap_check(k_mmheap_info_t *info); \u529f\u80fd\u63cf\u8ff0 \u83b7\u53d6\u5806\u5185\u5b58\u7684\u6574\u4f53\u4f7f\u7528\u60c5\u51b5\uff08\u5305\u542b\u4e86\u6240\u6709\u7684\u6c60\u7684\u4fe1\u606f\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [out] info \u5806\u5185\u5b58\u7684\u6574\u4f53\u4f7f\u7528\u60c5\u51b5\uff08\u4f7f\u7528\u91cf\u548c\u5269\u4f59\u91cf\u4fe1\u606f\uff09 \u8fd4\u56de\u503c K_ERR_NONE \u51fd\u6570\u8fd4\u56de\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL info\u4e3a\u7a7a\u6307\u9488\u3002 \u5757\u5185\u5b58\u7ba1\u7406 tos_mmblk_pool_create k_err_t tos_mmblk_pool_create(k_mmblk_pool_t *mbp, void *pool_start, size_t blk_num, size_t blk_size); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u5757\u5185\u5b58\u6c60\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mbp \u5f85\u521b\u5efa\u7684\u5757\u5185\u5b58\u53e5\u67c4 [in] pool_start \u5757\u5185\u5b58\u6c60\u8d77\u59cb\u5730\u5740 [in] blk_num \u5185\u5b58\u5757\u6570\u91cf [in] blk_size \u5355\u4e2a\u5185\u5b58\u5757\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u5757\u5185\u5b58\u521b\u5efa\u6210\u529f\u3002 K_ERR_MMBLK_INVALID_POOL_ADDR \u5757\u5185\u5b58\u6c60\u8d77\u59cb\u5730\u5740\u975e\u6cd5\u3002 K_ERR_MMBLK_INVALID_BLK_SIZE \u5757\u5185\u5b58\u5927\u5c0f\u975e\u6cd5\u3002 tos_mmblk_alloc k_err_t tos_mmblk_alloc(k_mmblk_pool_t *mbp, void **blk); \u529f\u80fd\u63cf\u8ff0 \u4ece\u5185\u5b58\u6c60\u4e2d\u5206\u914d\u4e00\u4e2a\u5185\u5b58\u5757\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mbp \u5757\u5185\u5b58\u53e5\u67c4 [out] blk \u8fd4\u56de\u7684\u5757\u5185\u5b58\u8d77\u59cb\u5730\u5740 \u8fd4\u56de\u503c K_ERR_NONE \u5757\u5185\u5b58\u5206\u914d\u6210\u529f\uff0cblk\u6307\u5411\u5206\u914d\u5230\u7684\u5185\u5b58\u5757\u8d77\u59cb\u5730\u5740\u3002 K_ERR_MMBLK_POOL_EMPTY \u5185\u5b58\u6c60\u662f\u7a7a\u7684\uff0cblk\u4e3aK_NULL\u3002 tos_mmblk_free k_err_t tos_mmblk_free(k_mmblk_pool_t *mbp, void *blk); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4e00\u4e2a\u5185\u5b58\u5757\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mbp \u5757\u5185\u5b58\u53e5\u67c4 [in] blk \u5f85\u91ca\u653e\u7684\u5757\u5185\u5b58\u8d77\u59cb\u5730\u5740 \u8fd4\u56de\u503c K_ERR_NONE \u5757\u5185\u5b58\u91ca\u653e\u6210\u529f\u3002 K_ERR_MMBLK_POOL_FULL \u5185\u5b58\u6c60\u662f\u6ee1\u7684\u3002 \u4e92\u65a5\u91cfmutex tos_mutex_create k_err_t tos_mutex_create(k_mutex_t *mutex); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u4e92\u65a5\u91cf\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mutex \u4e92\u65a5\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4e92\u65a5\u91cf\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL mutex\u4e3a\u7a7a\u6307\u9488\u3002 tos_mutex_destroy k_err_t tos_mutex_destroy(k_mutex_t *mutex); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u4e92\u65a5\u91cf\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mutex \u4e92\u65a5\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4e92\u65a5\u91cf\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL mutex\u4e3a\u7a7a\u6307\u9488\u3002 K_ERR_OBJ_INVALID mutex\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4e92\u65a5\u91cf\u3002 tos_mutex_pend k_err_t tos_mutex_pend(k_mutex_t *mutex); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u83b7\u53d6\u4e00\u4e2a\u4e92\u65a5\u91cf\uff08\u6c38\u4e45\u963b\u585e\u5f0f\u7b49\u5f85\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mutex \u4e92\u65a5\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u83b7\u53d6\u4e92\u65a5\u91cf\u6210\u529f\u3002 K_ERR_MUTEX_NESTING_OVERFLOW \u4e92\u65a5\u91cf\u62e5\u6709\u8005\u5d4c\u5957\u83b7\u53d6\u6ea2\u51fa\u3002 K_ERR_MUTEX_NESTING \u4e92\u65a5\u91cf\u62e5\u6709\u8005\u5d4c\u5957\u83b7\u53d6\u3002 K_ERR_PEND_SCHED_LOCKED \u6b64\u4e92\u65a5\u91cf\u88ab\u5176\u4ed6\u4efb\u52a1\u6301\u6709\uff0c\u4e14\u7cfb\u7edf\u8c03\u5ea6\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5f53\u524d\u4efb\u52a1\u8bd5\u56fe\u83b7\u53d6\u7684\u4e92\u65a5\u91cf\u88ab\u9500\u6bc1\uff08tos_mutex_destroy\uff09\u4e86\u3002 tos_mutex_pend_timed k_err_t tos_mutex_pend(k_mutex_t *mutex, k_tick_t timeout); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u83b7\u53d6\u4e00\u4e2a\u4e92\u65a5\u91cf\uff08\u6709\u9650\u65f6\u95f4\u5185\u7684\u963b\u585e\u7b49\u5f85\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mutex \u4e92\u65a5\u91cf\u53e5\u67c4 [in] timeout \u7b49\u5f85\u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u83b7\u53d6\u4e92\u65a5\u91cf\u6210\u529f\u3002 K_ERR_MUTEX_NESTING_OVERFLOW \u4e92\u65a5\u91cf\u62e5\u6709\u8005\u5d4c\u5957\u83b7\u53d6\u6ea2\u51fa\u3002 K_ERR_MUTEX_NESTING \u4e92\u65a5\u91cf\u62e5\u6709\u8005\u5d4c\u5957\u83b7\u53d6\u3002 K_ERR_PEND_NOWAIT \u6b64\u4e92\u65a5\u91cf\u88ab\u5176\u4ed6\u4efb\u52a1\u6301\u6709\uff0c\u540c\u65f6timeout\u53c2\u6570\u4e3aTOS_TIME_NOWAIT\uff08\u8868\u793a\u83b7\u53d6\u4e0d\u5230\u4e92\u65a5\u91cf\u65f6\u7acb\u5373\u8fd4\u56de\uff09 K_ERR_PEND_SCHED_LOCKED \u6b64\u4e92\u65a5\u91cf\u88ab\u5176\u4ed6\u4efb\u52a1\u6301\u6709\uff08\u83b7\u53d6\u5931\u8d25\uff09\uff0c\u4e14\u7cfb\u7edf\u8c03\u5ea6\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_TIMEOUT \u5728timeout\u65f6\u95f4\u8303\u56f4\u5185\u672a\u83b7\u53d6\u5230\u4e92\u65a5\u91cf\u3002 K_ERR_PEND_DESTROY \u5f53\u524d\u4efb\u52a1\u8bd5\u56fe\u83b7\u53d6\u7684\u4e92\u65a5\u91cf\u88ab\u9500\u6bc1\uff08tos_mutex_destroy\uff09\u4e86\u3002 tos_mutex_post k_err_t tos_mutex_post(k_mutex_t *mutex); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4e92\u65a5\u91cf\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mutex \u4e92\u65a5\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4e92\u65a5\u91cf\u91ca\u653e\u6210\u529f\u3002 K_ERR_MUTEX_NOT_OWNER \u5f53\u524d\u4efb\u52a1\u5e76\u975e\u6b64\u4e92\u65a5\u91cf\u7684\u62e5\u6709\u8005\u3002 K_ERR_MUTEX_NESTING_OVERFLOW \u4e92\u65a5\u91cf\u62e5\u6709\u8005\u5d4c\u5957\u91ca\u653e\u6ea2\u51fa\u3002 K_ERR_MUTEX_NESTING \u4e92\u65a5\u91cf\u62e5\u6709\u8005\u5d4c\u5957\u91ca\u653e\u3002 \u4fe1\u53f7\u91cfsemaphore tos_sem_create k_err_t tos_sem_create(k_sem_t *sem, k_sem_cnt_t init_count); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u4fe1\u53f7\u91cf\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sem \u4fe1\u53f7\u91cf\u53e5\u67c4 [in] init_count \u4fe1\u53f7\u91cf\u521d\u59cb\u91cf \u8fd4\u56de\u503c K_ERR_NONE \u4fe1\u53f7\u91cf\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL sem\u6307\u9488\u4e3a\u7a7a\u3002 tos_sem_create_max k_err_t tos_sem_create_max(k_sem_t *sem, k_sem_cnt_t init_count, k_sem_cnt_t max_count); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u4fe1\u53f7\u91cf\u5e76\u6307\u5b9a\u4fe1\u53f7\u91cf\u7684\u6700\u5927\u503c\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sem \u4fe1\u53f7\u91cf\u53e5\u67c4 [in] init_count \u4fe1\u53f7\u91cf\u521d\u59cb\u91cf [in] max_count \u4fe1\u53f7\u91cf\u7684\u6700\u5927\u503c \u8fd4\u56de\u503c K_ERR_NONE \u4fe1\u53f7\u91cf\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL sem\u6307\u9488\u4e3a\u7a7a\u3002 tos_sem_destroy k_err_t tos_sem_destroy(k_sem_t *sem); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u4fe1\u53f7\u91cf\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sem \u4fe1\u53f7\u91cf\u6570\u636e\u7ed3\u6784\u6307\u9488 \u8fd4\u56de\u503c K_ERR_NONE \u4fe1\u53f7\u91cf\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_INVALID sem\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4fe1\u53f7\u91cf\u3002 K_ERR_OBJ_PTR_NULL sem\u6307\u9488\u4e3a\u7a7a\u3002 tos_sem_pend k_err_t tos_sem_pend(k_sem_t *sem, k_tick_t timeout); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u83b7\u53d6\u4e00\u4e2a\u4fe1\u53f7\u91cf\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sem \u4fe1\u53f7\u91cf\u53e5\u67c4 [in] timeout \u7b49\u5f85\u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u83b7\u53d6\u4fe1\u53f7\u91cf\u6210\u529f\u3002 K_ERR_PEND_NOWAIT \u83b7\u53d6\u4fe1\u53f7\u91cf\u5931\u8d25\uff08\u4fe1\u53f7\u91cf\u8d44\u6e90\u4e0d\u8db3\uff09\uff0c\u540c\u65f6timeout\u53c2\u6570\u4e3aTOS_TIME_NOWAIT\uff08\u8868\u793a\u83b7\u53d6\u4e0d\u5230\u4fe1\u53f7\u91cf\u65f6\u7acb\u5373\u8fd4\u56de\uff09 K_ERR_PEND_SCHED_LOCKED \u83b7\u53d6\u4fe1\u53f7\u91cf\u5931\u8d25\uff0c\u540c\u65f6\u7cfb\u7edf\u8c03\u5ea6\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_TIMEOUT \u5728timeout\u8d85\u65f6\u8303\u56f4\u5185\u672a\u83b7\u53d6\u5230\u4fe1\u53f7\u91cf\u3002 K_ERR_PEND_DESTROY \u8bd5\u56fe\u83b7\u53d6\u7684\u4fe1\u53f7\u91cf\u88ab\u9500\u6bc1\u4e86\uff08tos_sem_destroy\uff09 tos_sem_post k_err_t tos_sem_post(k_sem_t *sem); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4fe1\u53f7\u91cf\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u4e00\u4e2a\u4efb\u52a1\u3002\u5982\u679c\u6709\u591a\u4e2a\u4efb\u52a1\u5728\u6b64\u4fe1\u53f7\u91cf\u7684\u7b49\u5f85\u961f\u5217\u4e0a\uff0c\u5524\u9192\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sem \u4fe1\u53f7\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4fe1\u53f7\u91cf\u91ca\u653e\u6210\u529f\u3002 K_ERR_SEM_OVERFLOW \u4fe1\u53f7\u91cf\u503c\u6ea2\u51fa\u3002 tos_sem_post_all k_err_t tos_sem_post_all(k_sem_t *sem); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4fe1\u53f7\u91cf\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u6240\u6709\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sem \u4fe1\u53f7\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4fe1\u53f7\u91cf\u91ca\u653e\u6210\u529f\u3002 K_ERR_SEM_OVERFLOW \u4fe1\u53f7\u91cf\u503c\u6ea2\u51fa\u3002 \u4e8b\u4ef6event tos_event_create k_err_t tos_event_create(k_event_t *event, k_event_flag_t init_flag); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u4e8b\u4ef6\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] event \u4e8b\u4ef6\u53e5\u67c4 [in] init_flag \u4e8b\u4ef6\u521d\u59cb\u65d7\u6807 \u8fd4\u56de\u503c K_ERR_NONE \u4e8b\u4ef6\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL event\u6307\u9488\u4e3a\u7a7a\u3002 tos_event_destroy k_err_t tos_event_destroy(k_event_t *event); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u4e8b\u4ef6\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] event \u4e8b\u4ef6\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4e8b\u4ef6\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL event\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID event\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4e8b\u4ef6\u3002 tos_event_pend k_err_t tos_event_pend(k_event_t *event, k_event_flag_t flag_expect, k_event_flag_t *flag_match, k_tick_t timeout, k_opt_t opt); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u83b7\u53d6\u4e00\u4e2a\u7279\u5b9a\u7684\u4e8b\u4ef6\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] event \u4e8b\u4ef6\u53e5\u67c4 [in] flag_expect \u671f\u671b\u83b7\u53d6\u5230\u7684\u4e8b\u4ef6\u65d7\u6807 [out] flag_match \u5b9e\u9645\u83b7\u53d6\u5230\u7684\u4e8b\u4ef6\u65d7\u6807 [in] timeout \u7b49\u5f85\u8d85\u65f6\u53c2\u6570 [in] opt \u9009\u9879 \u6ce8\u610f opt\u9009\u9879\u8bf4\u660e\uff1a 1\u3001TOS_OPT_EVENT_PEND_ANY \u200b \u5c1d\u8bd5\u4ece\u4e8b\u4ef6\u4e2d\u83b7\u53d6\u4e00\u7ec4\u65d7\u6807\uff0c\u5e76\u4e14\u8fd9\u4e00\u7ec4\u65d7\u6807\u5305\u542bflag_expect\u4e2d\u6807\u8bc6\u7684\u4efb\u610f\u4e00\u4e2a\u65d7\u6807\uff0c\u5982\u679c\u5728\u6b64\u573a\u666f\u4e0b\u89c6\u4f5cevent\u83b7\u53d6\u6210\u529f\uff0c\u5219opt\u4f20\u9012\u6b64\u53c2\u6570\u3002 \u200b \u4e3e\u4f8b\u6765\u8bf4\uff0c\u5982\u679c\u4f20\u5165\u7684flag_expect\u4e3a0x9\uff080x8 | 0x1\uff09\uff0c\u4e14opt\u4e3aTOS_OPT_EVENT_PEND_ANY\uff0c\u5219event\u5305\u542b\u7684\u65d7\u6807\u5305\u542b0x8\u6216\u80050x1\u5373\u89c6\u4e3a\u4e8b\u4ef6\u83b7\u53d6\u6210\u529f\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0cevent\u5305\u542b\u7684\u65d7\u6807\u4e3a(0x8 | X, X\u4e3a\u6574\u6570\uff0c\u4e14X\u2208(0, 0xFFFFFFFF])\uff0c\u6216\u8005(0x1 | X, X\u4e3a\u6574\u6570\uff0c\u4e14X\u2208(0, 0xFFFFFFFF])\u3002 2\u3001TOS_OPT_EVENT_PEND_ALL \u200b \u5c1d\u8bd5\u4ece\u4e8b\u4ef6\u4e2d\u83b7\u53d6\u4e00\u7ec4\u65d7\u6807\uff0c\u5e76\u4e14\u8fd9\u4e00\u7ec4\u65d7\u6807\u5fc5\u987b\u81f3\u5c11\u5305\u542bflag_expect\u4e2d\u6807\u8bc6\u7684\u6240\u6709\u65d7\u6807\uff0c\u5982\u679c\u53ea\u5728\u6b64\u79cd\u573a\u666f\u4e0b\u89c6\u4f5cevent\u83b7\u53d6\u6210\u529f\uff0c\u5219opt\u4f20\u9012\u6b64\u53c2\u6570\u3002 \u200b \u4e3e\u4f8b\u6765\u8bf4\uff0c\u5982\u679c\u4f20\u5165\u7684flag_expect\u4e3a0x9\uff080x8 | 0x1\uff09\uff0c\u4e14opt\u4e3aTOS_OPT_EVENT_PEND_ALL\uff0c\u5219event\u5305\u542b\u7684\u65d7\u6807\u81f3\u5c11\u4e3a0x9\u7684\u6700\u5c0f\u5168\u96c6\u624d\u89c6\u4e3a\u4e8b\u4ef6\u83b7\u53d6\u6210\u529f\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0cevent\u5305\u542b\u7684\u65d7\u6807\u5e94\u4e3a(0x9 | X, X\u4e3a\u6574\u6570\uff0c\u4e14X\u2208(0, 0xFFFFFFFF])\u3002 3\u3001TOS_OPT_EVENT_PEND_CLR \u200b \u5982\u679c\u5e0c\u671b\u8bfb\u53d6\u5b8c\u4e8b\u4ef6\u540e\uff0c\u76f4\u63a5\u590d\u4f4d\u6e05\u7a7aevent\u7684\u6240\u6709\u65d7\u6807\uff0c\u5219opt\u4f20\u9012\u6b64\u53c2\u6570\u3002 \u200b \u4e3e\u4f8b\u6765\u8bf4\uff0c\u539fevent\u5305\u542b\u65d7\u6807\u4e3a0x9\uff0c\u5728\u4f20\u9012TOS_OPT_EVENT_PEND_CLR\u53c2\u6570\u5e76\u6210\u529f\u83b7\u53d6event\u4e2d\u7684\u65d7\u6807\u540e\uff0cevent\u5305\u542b\u7684\u65d7\u6807\u4f1a\u590d\u4f4d\u4e3a0x0\u3002 \u200b \u5982\u679c\u5e0c\u671b\u4e00\u6b21\u4f20\u5165\u591a\u4e2a\u9009\u9879\uff0c\u53ef\u4ee5\u7528\u903b\u8f91\u201c\u6216\u201d\u5c06\u591a\u4e2a\u53c2\u6570\u8fde\u63a5\u4f20\u5165\uff0c\u8b6c\u5982\u540c\u65f6\u5e0c\u671b\u91c7\u7528TOS_OPT_EVENT_PEND_ANY \u8bed\u4e49\u53caTOS_OPT_EVENT_PEND_CLR\uff0c\u53ef\u4ee5\u4f20\u5165\uff08TOS_OPT_EVENT_PEND_ANY | TOS_OPT_EVENT_PEND_CLR\uff09\u3002 \u200b \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4e0d\u53ef\u4ee5\u540c\u65f6\u4f20\u5165TOS_OPT_EVENT_PEND_ANY\u4e0eTOS_OPT_EVENT_PEND_ALL\u3002 \u8fd4\u56de\u503c K_ERR_NONE \u8bfb\u53d6\u7279\u5b9a\u7684\u4e8b\u4ef6\u6210\u529f\u3002 K_ERR_EVENT_PEND_OPT_INVALID opt\u53c2\u6570\u975e\u6cd5\u3002 K_ERR_PEND_NOWAIT \u672a\u80fd\u4eceevent\u4e2d\u83b7\u53d6\u5230\u671f\u671b\u7684\u65d7\u6807\uff0c\u5e76\u4e14timeout\u53c2\u6570\u4e3aTOS_TIME_NOWAIT\uff08\u8868\u793a\u672a\u83b7\u53d6\u5230\u671f\u671b\u65d7\u6807\u65f6\u7acb\u5373\u8fd4\u56de\uff09\u3002 K_ERR_PEND_SCHED_LOCKED \u672a\u80fd\u4eceevent\u4e2d\u83b7\u53d6\u5230\u671f\u671b\u7684\u65d7\u6807\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u5904\u4e8e\u9501\u5b9a\u7684\u72b6\u6001\u3002 K_ERR_PEND_TIMEOUT \u5728\u8d85\u65f6\u8303\u56f4\u5185\u672a\u80fd\u4eceevent\u4e2d\u83b7\u53d6\u5230\u671f\u671b\u7684\u65d7\u6807\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u83b7\u53d6\u65d7\u6807\u7684\u4e8b\u4ef6\u88ab\u9500\u6bc1\u4e86\uff08tos_event_destroy\uff09\u3002 tos_event_post k_err_t tos_event_post(k_event_t *event, k_event_flag_t flag); \u529f\u80fd\u63cf\u8ff0 \u5411\u4e8b\u4ef6\u4e2d\u653e\u7f6e\u4e00\u7ec4\u65d7\u6807 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] event \u4e8b\u4ef6\u53e5\u67c4 [in] flag \u8981\u653e\u7f6e\u7684\u65d7\u6807 \u6ce8\u610f \u8c03\u7528\u6b64\u63a5\u53e3\u653e\u7f6e\u4e00\u7ec4\u65d7\u6807\u65f6\uff0c\u539fevent\u4e2d\u5305\u542b\u7684\u65d7\u6807\u5c06\u88ab\u8986\u76d6\u3002 \u4e3e\u4f8b\u6765\u8bf4\uff0c\u5982\u679c\u539f\u4e8b\u4ef6\u7684\u65d7\u6807\u4e3a0x1\uff0c\u5e76\u4e14\u8981\u653e\u7f6e\u7684\u65d7\u6807\u4e3a0x8\uff0c\u6b64\u63a5\u53e3\u8c03\u7528\u7ed3\u675f\u540e\uff0c\u4e8b\u4ef6\u7684\u65d7\u6807\u5c06\u88ab\u8986\u5199\u4e3a0x8\u3002 \u8fd4\u56de\u503c K_ERR_NONE \u65d7\u6807\u653e\u7f6e\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL event\u4e3a\u7a7a\u6307\u9488\u3002 K_ERR_OBJ_INVALID event\u6307\u5411\u7684\u5e76\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4e8b\u4ef6\u3002 tos_event_post_keep k_err_t tos_event_post_keep(k_event_t *event, k_event_flag_t flag); \u529f\u80fd\u63cf\u8ff0 \u5411\u4e8b\u4ef6\u4e2d\u653e\u7f6e\u4e00\u7ec4\u65d7\u6807\uff0c\u539fevent\u4e2d\u5305\u542b\u7684\u65d7\u6807\u5c06\u88ab\u4fdd\u7559\u3002 \u4e3e\u4f8b\u6765\u8bf4\uff0c\u5982\u679c\u539f\u4e8b\u4ef6\u7684\u65d7\u6807\u4e3a0x1\uff0c\u5e76\u4e14\u8981\u653e\u7f6e\u7684\u65d7\u6807\u4e3a0x8\uff0c\u6b64\u63a5\u53e3\u8c03\u7528\u7ed3\u675f\u540e\uff0c\u4e8b\u4ef6\u7684\u65d7\u6807\u5c06\u88ab\u4fee\u6539\u4e3a0x9(0x8 | 0x1)\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u539f\u4e8b\u4ef6\u7684\u5305\u542b\u7684\u65d7\u6807\u88ab\u4fdd\u7559\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] event \u4e8b\u4ef6\u53e5\u67c4 [in] flag \u8981\u653e\u7f6e\u7684\u65d7\u6807 \u8fd4\u56de\u503c K_ERR_NONE \u65d7\u6807\u653e\u7f6e\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL event\u4e3a\u7a7a\u6307\u9488\u3002 K_ERR_OBJ_INVALID event\u6307\u5411\u7684\u5e76\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4e8b\u4ef6\u3002 \u5b8c\u6210\u91cfcompletion tos_completion_create k_err_t tos_completion_create(k_completion_t *completion); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u5b8c\u6210\u91cf\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] completion \u5b8c\u6210\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u5b8c\u6210\u91cf\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL completion\u6307\u9488\u4e3a\u7a7a\u3002 tos_completion_destroy k_err_t tos_completion_destroy(k_completion_t *completion); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u5b8c\u6210\u91cf\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] completion \u5b8c\u6210\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u5b8c\u6210\u91cf\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL completion\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID completion\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u5b8c\u6210\u91cf\u3002 tos_completion_pend k_err_t tos_completion_pend(k_completion_t *completion); \u529f\u80fd\u63cf\u8ff0 \u7b49\u5f85\u5b8c\u6210\u91cf\u5b8c\u6210\uff08\u6c38\u4e45\u963b\u585e\u7b49\u5f85\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] completion \u5b8c\u6210\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u5b8c\u6210\u91cf\u5df2\u5b8c\u6210\u3002 K_ERR_PEND_SCHED_LOCKED \u5b8c\u6210\u91cf\u6ca1\u6709\u5b8c\u6210\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u5b8c\u6210\u91cf\u88ab\u5220\u9664\u4e86\u3002 tos_completion_pend_timed k_err_t tos_completion_pend_timed(k_completion_t *completion, k_tick_t timeout); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u7b49\u5f85\u5b8c\u6210\u91cf\u5b8c\u6210\uff08\u6709\u9650\u65f6\u95f4\u5185\u7684\u963b\u585e\u7b49\u5f85\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] completion \u5b8c\u6210\u91cf\u53e5\u67c4 [in] timeout \u7b49\u5f85\u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u5b8c\u6210\u91cf\u5df2\u5b8c\u6210\u3002 K_ERR_PEND_NOWAIT \u6b64\u5b8c\u6210\u91cf\u5c1a\u672a\u5b8c\u6210\uff0c\u540c\u65f6timeout\u53c2\u6570\u4e3aTOS_TIME_NOWAIT\uff08\u8868\u793a\u5b8c\u6210\u91cf\u672a\u5b8c\u6210\u65f6\u7acb\u5373\u8fd4\u56de\uff09 K_ERR_PEND_SCHED_LOCKED \u5b8c\u6210\u91cf\u6ca1\u6709\u5b8c\u6210\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u5b8c\u6210\u91cf\u88ab\u5220\u9664\u4e86\u3002 K_ERR_PEND_TIMEOUT \u5728timeout\u65f6\u95f4\u8303\u56f4\u5185\u5b8c\u6210\u91cf\u672a\u5b8c\u6210\u3002 tos_completion_post k_err_t tos_completion_post(k_completion_t *completion); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u5b8c\u6210\u91cf\uff08\u6b64\u5b8c\u6210\u91cf\u72b6\u6001\u53d8\u4e3a\u5df2\u5b8c\u6210\uff09\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u4e00\u4e2a\u4efb\u52a1\u3002\u5982\u679c\u6709\u591a\u4e2a\u4efb\u52a1\u5728\u6b64\u5b8c\u6210\u91cf\u7684\u7b49\u5f85\u961f\u5217\u4e0a\uff0c\u5524\u9192\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] completion \u5b8c\u6210\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u5b8c\u6210\u91cf\u91ca\u653e\u6210\u529f\u3002 tos_completion_post_all k_err_t tos_completion_post_all(k_completion_t *completion); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u5b8c\u6210\u91cf\uff08\u6b64\u5b8c\u6210\u91cf\u72b6\u6001\u53d8\u4e3a\u5df2\u5b8c\u6210\uff09\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u6240\u6709\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] completion \u5b8c\u6210\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u5b8c\u6210\u91cf\u91ca\u653e\u6210\u529f\u3002 tos_completion_reset k_err_t tos_completion_reset(k_completion_t *completion); \u529f\u80fd\u63cf\u8ff0 \u590d\u4f4d\u5b8c\u6210\u91cf\uff08\u5c06\u6b64\u5b8c\u6210\u91cf\u72b6\u6001\u66f4\u6539\u4e3a\u672a\u5b8c\u6210\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] completion \u5b8c\u6210\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u5b8c\u6210\u91cf\u590d\u4f4d\u6210\u529f\u3002 tos_completion_is_done k_err_t tos_completion_is_done(k_completion_t *completion); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u6b64\u5b8c\u6210\u91cf\u662f\u5426\u5df2\u5b8c\u6210\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] completion \u5b8c\u6210\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_TRUE \u5b8c\u6210\u91cf\u5df2\u5b8c\u6210\u3002 K_FALSE \u5b8c\u6210\u91cf\u672a\u5b8c\u6210\u3002 \u8ba1\u6570\u9501countdown latch tos_countdownlatch_create k_err_t tos_countdownlatch_create(k_countdownlatch_t *countdownlatch, k_countdownlatch_cnt_t count); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u8ba1\u6570\u9501\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] countdownlatch \u8ba1\u6570\u9501\u53e5\u67c4 [in] count \u671f\u671b\u7b49\u5f85\u7684\u8ba1\u6570\u503c \u8fd4\u56de\u503c K_ERR_NONE \u8ba1\u6570\u9501\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL countdownlatch\u6307\u9488\u4e3a\u7a7a\u3002 tos_countdownlatch_destroy k_err_t tos_countdownlatch_destroy(k_countdownlatch_t *countdownlatch); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u8ba1\u6570\u9501\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] countdownlatch \u8ba1\u6570\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u8ba1\u6570\u9501\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL countdownlatch\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID countdownlatch\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u8ba1\u6570\u9501\u3002 tos_countdownlatch_pend k_err_t tos_countdownlatch_pend(k_countdownlatch_t *countdownlatch); \u529f\u80fd\u63cf\u8ff0 \u7b49\u5f85\u8ba1\u6570\u9501\u5b8c\u6210\uff08\u6c38\u4e45\u963b\u585e\u7b49\u5f85\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] countdownlatch \u8ba1\u6570\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u8ba1\u6570\u9501\u5df2\u5b8c\u6210\u3002 K_ERR_PEND_SCHED_LOCKED \u8ba1\u6570\u9501\u6ca1\u6709\u5b8c\u6210\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u8ba1\u6570\u9501\u88ab\u5220\u9664\u4e86\u3002 tos_countdownlatch_pend_timed k_err_t tos_countdownlatch_pend_timed(k_countdownlatch_t *countdownlatch, k_tick_t timeout); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u7b49\u5f85\u8ba1\u6570\u9501\u5b8c\u6210\uff08\u6709\u9650\u65f6\u95f4\u5185\u7684\u963b\u585e\u7b49\u5f85\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] countdownlatch \u8ba1\u6570\u9501\u53e5\u67c4 [in] timeout \u7b49\u5f85\u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u8ba1\u6570\u9501\u5df2\u5b8c\u6210\u3002 K_ERR_PEND_NOWAIT \u6b64\u8ba1\u6570\u9501\u5c1a\u672a\u5b8c\u6210\uff0c\u540c\u65f6timeout\u53c2\u6570\u4e3aTOS_TIME_NOWAIT\uff08\u8868\u793a\u8ba1\u6570\u9501\u672a\u5b8c\u6210\u65f6\u7acb\u5373\u8fd4\u56de\uff09 K_ERR_PEND_SCHED_LOCKED \u8ba1\u6570\u9501\u6ca1\u6709\u5b8c\u6210\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u8ba1\u6570\u9501\u88ab\u5220\u9664\u4e86\u3002 K_ERR_PEND_TIMEOUT \u5728timeout\u65f6\u95f4\u8303\u56f4\u5185\u8ba1\u6570\u9501\u672a\u5b8c\u6210\u3002 tos_countdownlatch_post k_err_t tos_countdownlatch_post(k_countdownlatch_t *countdownlatch); \u529f\u80fd\u63cf\u8ff0 \u8ba1\u6570\u9501\uff08\u6b64\u8ba1\u6570\u9501\u7684\u8ba1\u6570\u503c\u51cf\u4e00\uff09\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u4e00\u4e2a\u4efb\u52a1\u3002\u5982\u679c\u6709\u591a\u4e2a\u4efb\u52a1\u5728\u6b64\u8ba1\u6570\u9501\u7684\u7b49\u5f85\u961f\u5217\u4e0a\uff0c\u5524\u9192\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] countdownlatch \u8ba1\u6570\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u8ba1\u6570\u9501\u91ca\u653e\u6210\u529f\u3002 tos_countdownlatch_reset k_err_t tos_countdownlatch_reset(k_countdownlatch_t *countdownlatch, k_countdownlatch_cnt_t count); \u529f\u80fd\u63cf\u8ff0 \u590d\u4f4d\u8ba1\u6570\u9501\uff08\u5c06\u6b64\u8ba1\u6570\u9501\u7684\u8ba1\u6570\u503c\u590d\u4f4d\u4e3a\u65b0\u7684\u671f\u671b\u503c\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] countdownlatch \u8ba1\u6570\u9501\u53e5\u67c4 [in] count \u671f\u671b\u590d\u4f4d\u7684\u65b0\u7684\u8ba1\u6570\u503c \u8fd4\u56de\u503c K_ERR_NONE \u8ba1\u6570\u9501\u590d\u4f4d\u6210\u529f\u3002 \u6805\u680fbarrier tos_barrier_create k_err_t tos_barrier_create(k_barrier_t *barrier, k_barrier_cnt_t count); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u6805\u680f\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] barrier \u6805\u680f\u53e5\u67c4 [in] count \u671f\u671b\u7b49\u5f85\u7684\u8ba1\u6570\u503c \u8fd4\u56de\u503c K_ERR_NONE \u6805\u680f\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL barrier\u6307\u9488\u4e3a\u7a7a\u3002 tos_barrier_destroy k_err_t tos_barrier_destroy(k_barrier_t *barrier); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u6805\u680f\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] barrier \u6805\u680f\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6805\u680f\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL barrier\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID barrier\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u6805\u680f\u3002 tos_barrier_pend k_err_t tos_barrier_pend(k_barrier_t *barrier); \u529f\u80fd\u63cf\u8ff0 \u7b49\u5f85\u6805\u680f\u5168\u90e8\u89e3\u9664\uff08\u6c38\u4e45\u963b\u585e\u7b49\u5f85\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] barrier \u6805\u680f\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6805\u680f\u5df2\u5b8c\u6210\u3002 K_ERR_PEND_SCHED_LOCKED \u6805\u680f\u6ca1\u6709\u5b8c\u6210\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u6805\u680f\u88ab\u5220\u9664\u4e86\u3002 K_ERR_BARRIER_OVERFLOW \u6805\u680f\u7684pend\u6b21\u6570\u8d85\u8fc7\u4e86\u521d\u59cb\u7684count\u6570\u91cf\u3002 tos_barrier_reset k_err_t tos_barrier_reset(k_barrier_t *barrier, k_barrier_cnt_t count); \u529f\u80fd\u63cf\u8ff0 \u590d\u4f4d\u6805\u680f\uff08\u5c06\u6805\u680f\u7684count\u8ba1\u6570\u590d\u4f4d\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] barrier \u6805\u680f\u53e5\u67c4 [in] count \u590d\u4f4d\u7684\u8ba1\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u6805\u680f\u590d\u4f4d\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL barrier\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID barrier\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u6805\u680f\u3002 \u8bfb\u5199\u9501rwlock tos_rwlock_create k_err_t tos_rwlock_create(k_rwlock_t *rwlock); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u8bfb\u5199\u9501\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u8bfb\u5199\u9501\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL rwlock\u6307\u9488\u4e3a\u7a7a\u3002 tos_rwlock_destroy k_err_t tos_rwlock_destroy(k_rwlock_t *rwlock); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u6805\u680f\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u8bfb\u5199\u9501\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL rwlock\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID rwlock\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u8bfb\u5199\u9501\u3002 tos_rwlock_rpend_timed k_err_t tos_rwlock_rpend_timed(k_rwlock_t *rwlock, k_tick_t timeout); \u529f\u80fd\u63cf\u8ff0 \u6709\u9650\u7684\u65f6\u95f4\u5185\u5c1d\u8bd5\u83b7\u53d6\u8bfb\u9501\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 [in] timeout \u8d85\u65f6\u65f6\u9650 \u8fd4\u56de\u503c K_ERR_NONE \u6210\u529f\u83b7\u53d6\u8bfb\u9501\u3002 K_ERR_PEND_SCHED_LOCKED \u672a\u6210\u529f\u83b7\u53d6\u5230\u8bfb\u9501\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u8bfb\u9501\u88ab\u5220\u9664\u4e86\u3002 K_ERR_PEND_TIMEOUT \u672a\u5728\u8d85\u65f6\u65f6\u9650\u5185\u6210\u529f\u83b7\u53d6\u5230\u8bfb\u9501\u3002 K_ERR_RWLOCK_READERS_TO_MANY \u5df2\u83b7\u53d6\u8bfb\u9501\u7684\u8bfb\u8005\u8fc7\u591a\u3002 tos_rwlock_rpend k_err_t tos_rwlock_rpend(k_rwlock_t *rwlock); \u529f\u80fd\u63cf\u8ff0 \u6c38\u4e45\u6027\u963b\u585e\u5c1d\u8bd5\u83b7\u53d6\u8bfb\u9501\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6210\u529f\u83b7\u53d6\u8bfb\u9501\u3002 K_ERR_PEND_SCHED_LOCKED \u5728\u8d85\u65f6\u65f6\u9650\u5185\u672a\u6210\u529f\u83b7\u53d6\u5230\u8bfb\u9501\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u8bfb\u9501\u88ab\u5220\u9664\u4e86\u3002 K_ERR_RWLOCK_READERS_TO_MANY \u5df2\u83b7\u53d6\u8bfb\u9501\u7684\u8bfb\u8005\u8fc7\u591a\u3002 tos_rwlock_rpend_try k_err_t tos_rwlock_rpend_try(k_rwlock_t *rwlock); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u83b7\u53d6\u8bfb\u9501\uff0c\u4e14\u5e76\u4e0d\u963b\u585e\u7b49\u5f85\uff0c\u7acb\u5373\u8fd4\u56de\u9519\u8bef\u7801\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6210\u529f\u83b7\u53d6\u8bfb\u9501\u3002 K_ERR_PEND_SCHED_LOCKED \u5728\u8d85\u65f6\u65f6\u9650\u5185\u672a\u6210\u529f\u83b7\u53d6\u5230\u8bfb\u9501\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u8bfb\u9501\u88ab\u5220\u9664\u4e86\u3002 K_ERR_RWLOCK_READERS_TO_MANY \u5df2\u83b7\u53d6\u8bfb\u9501\u7684\u8bfb\u8005\u8fc7\u591a\u3002 tos_rwlock_wpend_timed k_err_t tos_rwlock_wpend_timed(k_rwlock_t *rwlock, k_tick_t timeout); \u529f\u80fd\u63cf\u8ff0 \u6709\u9650\u7684\u65f6\u95f4\u5185\u5c1d\u8bd5\u83b7\u53d6\u5199\u9501\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 [in] timeout \u8d85\u65f6\u65f6\u9650 \u8fd4\u56de\u503c K_ERR_NONE \u6210\u529f\u83b7\u53d6\u8bfb\u9501\u3002 K_ERR_PEND_SCHED_LOCKED \u672a\u6210\u529f\u83b7\u53d6\u5230\u5199\u9501\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u5199\u9501\u88ab\u5220\u9664\u4e86\u3002 K_ERR_PEND_TIMEOUT \u672a\u5728\u8d85\u65f6\u65f6\u9650\u5185\u6210\u529f\u83b7\u53d6\u5230\u5199\u9501\u3002 K_ERR_RWLOCK_WAITING_WRITERS_TO_MANY \u5c1d\u8bd5\u83b7\u53d6\u5199\u9501\u7684\u4efb\u52a1\u8fc7\u591a\u3002 tos_rwlock_wpend k_err_t tos_rwlock_wpend(k_rwlock_t *rwlock); \u529f\u80fd\u63cf\u8ff0 \u6c38\u4e45\u6027\u963b\u585e\u5c1d\u8bd5\u83b7\u53d6\u5199\u9501\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6210\u529f\u83b7\u53d6\u5199\u9501\u3002 K_ERR_PEND_SCHED_LOCKED \u5728\u8d85\u65f6\u65f6\u9650\u5185\u672a\u6210\u529f\u83b7\u53d6\u5230\u5199\u9501\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u5199\u9501\u88ab\u5220\u9664\u4e86\u3002 K_ERR_RWLOCK_WAITING_WRITERS_TO_MANY \u5c1d\u8bd5\u83b7\u53d6\u5199\u9501\u7684\u4efb\u52a1\u8fc7\u591a\u3002 tos_rwlock_wpend_try k_err_t tos_rwlock_wpend_try(k_rwlock_t *rwlock); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u83b7\u53d6\u5199\u9501\uff0c\u4e14\u5e76\u4e0d\u963b\u585e\u7b49\u5f85\uff0c\u7acb\u5373\u8fd4\u56de\u9519\u8bef\u7801\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6210\u529f\u83b7\u53d6\u5199\u9501\u3002 K_ERR_PEND_SCHED_LOCKED \u5728\u8d85\u65f6\u65f6\u9650\u5185\u672a\u6210\u529f\u83b7\u53d6\u5230\u5199\u9501\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u5199\u9501\u88ab\u5220\u9664\u4e86\u3002 K_ERR_RWLOCK_WAITING_WRITERS_TO_MANY \u5c1d\u8bd5\u83b7\u53d6\u5199\u9501\u7684\u4efb\u52a1\u8fc7\u591a\u3002 tos_rwlock_rpost k_err_t tos_rwlock_rpost(k_rwlock_t *rwlock); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4e00\u4e2a\u8bfb\u9501\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6210\u529f\u91ca\u653e\u8bfb\u9501\u3002 K_ERR_RWLOCK_NOT_READING \u5f53\u524d\u4efb\u52a1\u5e76\u975e\u6b64\u8bfb\u9501\u62e5\u6709\u8005\u3002 tos_rwlock_wpost k_err_t tos_rwlock_wpost(k_rwlock_t *rwlock); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4e00\u4e2a\u5199\u9501\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6210\u529f\u91ca\u653e\u5199\u9501\u3002 K_ERR_RWLOCK_NOT_WRITTING \u5f53\u524d\u4efb\u52a1\u5e76\u975e\u6b64\u5199\u9501\u62e5\u6709\u8005\u3002 tos_rwlock_post k_err_t tos_rwlock_post(k_rwlock_t *rwlock); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4e00\u4e2a\u8bfb\u5199\u9501\u3002 \u5982\u679c\u5f53\u524d\u8bfb\u5199\u9501\u88ab\u8bfb\u8005\u6301\u6709\uff0c\u5219\u91ca\u653e\u8bfb\u9501\uff1b\u5982\u679c\u662f\u88ab\u5199\u8005\u6301\u6709\uff0c\u5219\u91ca\u653e\u5199\u9501\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6210\u529f\u91ca\u653e\u5199\u9501\u3002 K_ERR_RWLOCK_NOT_TAKEN \u6b64\u8bfb\u5199\u9501\u5e76\u672a\u88ab\u4efb\u4f55\u8bfb\u8005\u6216\u5199\u8005\u5360\u6709\u3002 \u6d88\u606f\u961f\u5217message queue tos_msg_q_create k_err_t tos_msg_q_create(k_msg_q_t *msg_q, void *pool, size_t msg_cnt); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u6d88\u606f\u961f\u5217\uff08\u6d88\u606f\u5c31\u662f\u6307\u9488\uff09\u3002\u6d88\u606f\u961f\u5217\u662f\u7528\u6765\u5728\u4efb\u52a1\u95f4\u4f20\u9012\u6307\u9488\u4fe1\u606f\u7684\u673a\u5236\u3002pool\u7531\u7528\u6237\u4f20\u5165\uff0cpool\u662f\u4e00\u7247\u5927\u5c0f\u4e3a(msg_cnt * sizeof(void *))\u7684\u5185\u5b58buffer\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] msg_q \u6d88\u606f\u961f\u5217\u53e5\u67c4 [in] pool \u6d88\u606f\u961f\u5217\u7684buffer\u6c60 [in] msg_cnt \u6d88\u606f\u961f\u5217\u7684\u6700\u5927\u6d88\u606f\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u6d88\u606f\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL msg_q\u6307\u9488\u4e3a\u7a7a\u3002 tos_msg_q_create_dyn k_err_t tos_msg_q_create_dyn(k_msg_q_t *msg_q, size_t msg_cnt); \u529f\u80fd\u63cf\u8ff0 \u52a8\u6001\u521b\u5efa\u4e00\u4e2a\u6d88\u606f\u961f\u5217\uff08\u6d88\u606f\u5c31\u662f\u6307\u9488\uff09\u3002\u6d88\u606f\u961f\u5217\u662f\u7528\u6765\u5728\u4efb\u52a1\u95f4\u4f20\u9012\u6307\u9488\u4fe1\u606f\u7684\u673a\u5236\u3002\u5185\u90e8buffer\u7531\u52a8\u6001\u5185\u5b58\u5206\u914d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] msg_q \u6d88\u606f\u961f\u5217\u53e5\u67c4 [in] msg_cnt \u6d88\u606f\u961f\u5217\u7684\u6700\u5927\u6d88\u606f\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u6d88\u606f\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL msg_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OUT_OF_MEMORY \u5806\u5185\u5b58\u4e0d\u8db3\u3002 tos_msg_q_destroy k_err_t tos_msg_q_destroy(k_msg_q_t *msg_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u6d88\u606f\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] msg_q \u6d88\u606f\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6d88\u606f\u961f\u5217\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL msg_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID msg_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u6d88\u606f\u961f\u5217\u3002 tos_msg_q_destroy_dyn k_err_t tos_msg_q_destroy_dyn(k_msg_q_t *msg_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u52a8\u6001\u521b\u5efa\u7684\uff08tos_msg_q_create_dyn\uff09\u6d88\u606f\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] msg_q \u6d88\u606f\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6d88\u606f\u961f\u5217\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL msg_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID msg_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u6d88\u606f\u961f\u5217\u3002 tos_msg_q_flush k_err_t tos_msg_q_flush(k_msg_q_t *msg_q); \u529f\u80fd\u63cf\u8ff0 \u51b2\u6d17\u6d88\u606f\u961f\u5217\uff08\u4e22\u5f03\u6d88\u606f\u961f\u5217\u4e2d\u7684\u6240\u6709\u6d88\u606f\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] msg_q \u6d88\u606f\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6d88\u606f\u961f\u5217\u51b2\u6d17\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL msg_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID msg_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u6d88\u606f\u961f\u5217\u3002 tos_msg_q_pend k_err_t tos_msg_q_pend(k_msg_q_t *msg_q, void **msg_ptr, k_tick_t timeout); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u4ece\u6d88\u606f\u961f\u5217\u4e2d\u83b7\u53d6\u6d88\u606f\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] msg_q \u6d88\u606f\u961f\u5217\u53e5\u67c4 [out] msg_ptr \u83b7\u53d6\u5230\u7684\u6d88\u606f\u5730\u5740 [in] timeout \u7b49\u5f85\u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u4ece\u6d88\u606f\u961f\u5217\u83b7\u53d6\u6d88\u606f\u6210\u529f\uff0cmsg_addr\u548cmsg_size\u5206\u522b\u662f\u83b7\u53d6\u5230\u7684\u6d88\u606f\u5730\u5740\u548c\u6d88\u606f\u957f\u5ea6\u3002 K_ERR_PEND_NOWAIT \u672a\u80fd\u4ece\u6d88\u606f\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u6d88\u606f\uff0c\u5e76\u4e14timeout\u53c2\u6570\u4e3aTOS_TIME_NOWAIT\uff08\u8868\u793a\u83b7\u53d6\u4e0d\u5230\u6d88\u606f\u65f6\u7acb\u5373\u8fd4\u56de\uff09\u3002 K_ERR_PEND_SCHED_LOCKED \u672a\u80fd\u4ece\u6d88\u606f\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u6d88\u606f\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_TIMEOUT \u5728timeout\u8d85\u65f6\u8303\u56f4\u5185\u672a\u80fd\u4ece\u6d88\u606f\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u6d88\u606f\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u83b7\u53d6\u6d88\u606f\u7684\u961f\u5217\u88ab\u9500\u6bc1\u4e86\uff08tos_msg_q_destroy\uff09\u3002 tos_msg_q_post k_err_t tos_msg_q_post(k_msg_q_t *msg_q, void *msg_ptr); \u529f\u80fd\u63cf\u8ff0 \u5411\u6d88\u606f\u961f\u5217\u4e2d\u653e\u5165\u4e00\u4e2a\u6d88\u606f\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u4e00\u4e2a\u4efb\u52a1\u3002\u5982\u679c\u6709\u591a\u4e2a\u4efb\u52a1\u5728\u6b64\u6d88\u606f\u961f\u5217\u7684\u7b49\u5f85\u961f\u5217\u4e0a\uff0c\u5524\u9192\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] msg_q \u6d88\u606f\u961f\u5217\u53e5\u67c4 [in] msg_ptr \u6d88\u606f\u5730\u5740 \u8fd4\u56de\u503c K_ERR_NONE \u5411\u6d88\u606f\u961f\u5217\u4e2d\u653e\u5165\u6d88\u606f\u6210\u529f\u3002 K_ERR_RING_Q_FULL \u6d88\u606f\u961f\u5217\u5df2\u6ee1\u3002 tos_msg_q_post_all k_err_t tos_msg_q_post_all(k_msg_q_t *msg_q, void *msg_ptr); \u529f\u80fd\u63cf\u8ff0 \u5411\u6d88\u606f\u961f\u5217\u4e2d\u653e\u5165\u4e00\u4e2a\u6d88\u606f\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u6240\u6709\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] msg_q \u6d88\u606f\u961f\u5217\u53e5\u67c4 [in] msg_ptr \u6d88\u606f\u5730\u5740 \u8fd4\u56de\u503c K_ERR_NONE \u5411\u6d88\u606f\u961f\u5217\u4e2d\u653e\u5165\u6d88\u606f\u6210\u529f\u3002 K_ERR_RING_Q_FULL \u6d88\u606f\u961f\u5217\u5df2\u6ee1\u3002 \u90ae\u7bb1\u961f\u5217mail queue tos_mail_q_create k_err_t tos_mail_q_create(k_mail_q_t *mail_q, void *pool, size_t mail_cnt, size_t mail_size); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u90ae\u7bb1\u961f\u5217\uff08\u90ae\u4ef6\u662f\u4e00\u7247\u56fa\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\uff09\u3002\u90ae\u7bb1\u961f\u5217\u662f\u7528\u6765\u5728\u4efb\u52a1\u95f4\u4f20\u9012\u5177\u6709\u7279\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\u4fe1\u606f\u7684\u673a\u5236\u3002pool\u7531\u7528\u6237\u4f20\u5165\uff0cpool\u662f\u4e00\u7247\u5927\u5c0f\u4e3a(mail_cnt* mail_size)\u7684\u5185\u5b58buffer\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mail_q \u90ae\u7bb1\u961f\u5217\u53e5\u67c4 [in] pool \u90ae\u7bb1\u961f\u5217\u7684buffer\u6c60 [in] mail_cnt \u90ae\u4ef6\u7684\u6700\u5927\u6570\u91cf [in] mail_size \u90ae\u4ef6\u7684\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u90ae\u7bb1\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL mail_q\u6307\u9488\u4e3a\u7a7a\u3002 tos_mail_q_create_dyn k_err_t tos_mail_q_create_dyn(k_mail_q_t *mail_q, size_t mail_cnt, size_t mail_size); \u529f\u80fd\u63cf\u8ff0 \u52a8\u6001\u521b\u5efa\u4e00\u4e2a\u90ae\u7bb1\u961f\u5217\uff08\u90ae\u4ef6\u662f\u4e00\u7247\u56fa\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\uff09\u3002\u90ae\u7bb1\u961f\u5217\u662f\u7528\u6765\u5728\u4efb\u52a1\u95f4\u4f20\u9012\u5177\u6709\u7279\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\u4fe1\u606f\u7684\u673a\u5236\u3002\u5185\u90e8buffer\u7531\u52a8\u6001\u5185\u5b58\u5206\u914d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mail_q \u90ae\u7bb1\u961f\u5217\u53e5\u67c4 [in] mail_cnt \u90ae\u4ef6\u7684\u6700\u5927\u6570\u91cf [in] mail_size \u90ae\u4ef6\u7684\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u90ae\u7bb1\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL mail_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OUT_OF_MEMORY \u5806\u5185\u5b58\u4e0d\u8db3\u3002 tos_mail_q_destroy k_err_t tos_mail_q_destroy(k_mail_q_t *mail_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u90ae\u7bb1\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mail_q \u90ae\u7bb1\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u90ae\u7bb1\u961f\u5217\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL mail_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID mail_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u90ae\u7bb1\u961f\u5217\u3002 tos_mail_q_destroy_dyn k_err_t tos_mail_q_destroy_dyn(k_mail_q_t *mail_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u52a8\u6001\u521b\u5efa\u7684\uff08tos_mail_q_create_dyn\uff09\u90ae\u7bb1\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mail_q \u90ae\u7bb1\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u90ae\u7bb1\u961f\u5217\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL mail_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID mail_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u90ae\u7bb1\u961f\u5217\u3002 tos_mail_q_flush k_err_t tos_mail_q_flush(k_mail_q_t *mail_q); \u529f\u80fd\u63cf\u8ff0 \u51b2\u6d17\u90ae\u7bb1\u961f\u5217\uff08\u4e22\u5f03\u90ae\u7bb1\u961f\u5217\u4e2d\u7684\u6240\u6709\u90ae\u4ef6\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mail_q \u90ae\u7bb1\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u90ae\u7bb1\u961f\u5217\u51b2\u6d17\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL mail_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID mail_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u90ae\u7bb1\u961f\u5217\u3002 tos_mail_q_pend k_err_t tos_mail_q_pend(k_mail_q_t *mail_q, void *mail_buf, size_t *mail_size, k_tick_t timeout); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u4ece\u90ae\u7bb1\u961f\u5217\u4e2d\u83b7\u53d6\u90ae\u4ef6\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mail_q \u90ae\u7bb1\u961f\u5217\u53e5\u67c4 [out] mail_buf \u7528\u6765\u627f\u8f7d\u90ae\u4ef6\u5185\u5bb9\u7684buffer\u5730\u5740 [in] mail_size \u83b7\u53d6\u5230\u7684\u90ae\u4ef6\u957f\u5ea6 [in] timeout \u7b49\u5f85\u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u4ece\u90ae\u7bb1\u961f\u5217\u83b7\u53d6\u90ae\u4ef6\u6210\u529f\uff0cmail_buf\u4e2d\u88ab\u5199\u5165\u90ae\u4ef6\u5185\u5bb9\uff0cmsg_size\u83b7\u53d6\u5230\u7684\u90ae\u4ef6\u957f\u5ea6\u3002 K_ERR_PEND_NOWAIT \u672a\u80fd\u4ece\u90ae\u7bb1\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u90ae\u4ef6\uff0c\u5e76\u4e14timeout\u53c2\u6570\u4e3aTOS_TIME_NOWAIT\uff08\u8868\u793a\u83b7\u53d6\u4e0d\u5230\u90ae\u4ef6\u65f6\u7acb\u5373\u8fd4\u56de\uff09\u3002 K_ERR_PEND_SCHED_LOCKED \u672a\u80fd\u4ece\u90ae\u7bb1\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u90ae\u4ef6\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_TIMEOUT \u5728timeout\u8d85\u65f6\u8303\u56f4\u5185\u672a\u80fd\u4ece\u90ae\u7bb1\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u90ae\u4ef6\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u83b7\u53d6\u90ae\u4ef6\u7684\u961f\u5217\u88ab\u9500\u6bc1\u4e86\uff08tos_mail_q_destroy\uff09\u3002 tos_mail_q_post k_err_t tos_mail_q_post(k_mail_q_t *mail_q, void *mail_buf, size_t mail_size); \u529f\u80fd\u63cf\u8ff0 \u5411\u90ae\u7bb1\u961f\u5217\u4e2d\u653e\u5165\u4e00\u4e2a\u90ae\u4ef6\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u4e00\u4e2a\u4efb\u52a1\u3002\u5982\u679c\u6709\u591a\u4e2a\u4efb\u52a1\u5728\u6b64\u90ae\u7bb1\u961f\u5217\u7684\u7b49\u5f85\u961f\u5217\u4e0a\uff0c\u5524\u9192\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mail_q \u90ae\u7bb1\u961f\u5217\u53e5\u67c4 [in] mail_buf \u8981\u653e\u5165\u90ae\u7bb1\u961f\u5217\u7684\u90ae\u4ef6 [in] mail_size \u90ae\u4ef6\u957f\u5ea6 \u8fd4\u56de\u503c K_ERR_NONE \u5411\u90ae\u7bb1\u961f\u5217\u4e2d\u653e\u5165\u90ae\u4ef6\u6210\u529f\u3002 K_ERR_RING_Q_FULL \u90ae\u7bb1\u961f\u5217\u5df2\u6ee1\u3002 tos_mail_q_post_all k_err_t tos_mail_q_post_all(k_mail_q_t *mail_q, void *mail_buf, size_t mail_size); \u529f\u80fd\u63cf\u8ff0 \u5411\u90ae\u7bb1\u961f\u5217\u4e2d\u653e\u5165\u4e00\u4e2a\u90ae\u4ef6\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u6240\u6709\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mail_q \u90ae\u7bb1\u961f\u5217\u53e5\u67c4 [in] mail_buf \u8981\u653e\u5165\u90ae\u7bb1\u961f\u5217\u7684\u90ae\u4ef6 [in] mail_size \u90ae\u4ef6\u957f\u5ea6 \u8fd4\u56de\u503c K_ERR_NONE \u5411\u90ae\u7bb1\u961f\u5217\u4e2d\u653e\u5165\u90ae\u4ef6\u6210\u529f\u3002 K_ERR_RING_Q_FULL \u90ae\u7bb1\u961f\u5217\u5df2\u6ee1\u3002 \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217priority message queue tos_prio_msg_q_create k_err_t tos_prio_msg_q_create(k_prio_msg_q_t *prio_msg_q, void *pool, size_t msg_cnt); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\uff08\u6d88\u606f\u5c31\u662f\u6307\u9488\uff09\u3002\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u662f\u7528\u6765\u5728\u4efb\u52a1\u95f4\u4f20\u9012\u6307\u9488\u4fe1\u606f\u7684\u673a\u5236\uff0c\u4e0e\u6d88\u606f\u961f\u5217\u4e0d\u540c\u7684\u5730\u65b9\u5728\u4e8e\uff0c\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u53ef\u4ee5\u7ed9\u6d88\u606f\u8d4b\u4e88\u4e00\u4e2a\u4f18\u5148\u7ea7\uff0c\u8f83\u9ad8\u4f18\u5148\u7ea7\uff08\u6570\u503c\u4e0a\u66f4\u5c0f\uff09\u7684\u6d88\u606f\u4f1a\u6bd4\u8f83\u4f4e\u4f18\u5148\u7ea7\u7684\u6d88\u606f\u66f4\u5feb\u4f20\u9012\u5230\u7b49\u5f85\u4efb\u52a1\u3002pool\u7531\u7528\u6237\u4f20\u5165\uff0cpool\u662f\u4e00\u7247\u5927\u5c0f\u4e3a(msg_cnt * sizeof(void *))\u7684\u5185\u5b58buffer\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_msg_q \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u53e5\u67c4 [in] pool \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u7684buffer\u6c60 [in] msg_cnt \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u7684\u6700\u5927\u6d88\u606f\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL prio_msg_q\u6307\u9488\u4e3a\u7a7a\u3002 tos_prio_msg_q_create_dyn k_err_t tos_prio_msg_q_create_dyn(k_prio_msg_q_t *prio_msg_q, size_t msg_cnt); \u529f\u80fd\u63cf\u8ff0 \u52a8\u6001\u521b\u5efa\u4e00\u4e2a\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\uff08\u6d88\u606f\u5c31\u662f\u6307\u9488\uff09\u3002\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u662f\u7528\u6765\u5728\u4efb\u52a1\u95f4\u4f20\u9012\u6307\u9488\u4fe1\u606f\u7684\u673a\u5236\uff0c\u4e0e\u6d88\u606f\u961f\u5217\u4e0d\u540c\u7684\u5730\u65b9\u5728\u4e8e\uff0c\u4f18\u5148\u7ea7\u961f\u5217\u53ef\u4ee5\u7ed9\u6d88\u606f\u8d4b\u4e88\u4e00\u4e2a\u4f18\u5148\u7ea7\uff0c\u8f83\u9ad8\u4f18\u5148\u7ea7\uff08\u6570\u503c\u4e0a\u66f4\u5c0f\uff09\u7684\u6d88\u606f\u4f1a\u6bd4\u8f83\u4f4e\u4f18\u5148\u7ea7\u7684\u6d88\u606f\u66f4\u5feb\u4f20\u9012\u5230\u7b49\u5f85\u4efb\u52a1\u3002\u5185\u90e8buffer\u7531\u52a8\u6001\u5185\u5b58\u5206\u914d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_msg_q \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u53e5\u67c4 [in] msg_cnt \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u7684\u6700\u5927\u6d88\u606f\u6570 \u8fd4\u56de\u503c K_ERR_NONE\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL prio_msg_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OUT_OF_MEMORY \u5806\u5185\u5b58\u4e0d\u8db3\u3002 tos_prio_msg_q_destroy k_err_t tos_prio_msg_q_destroy(k_prio_msg_q_t *prio_msg_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_msg_q \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL msg_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID prio_msg_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u3002 tos_prio_msg_q_destroy_dyn k_err_t tos_prio_msg_q_destroy_dyn(k_prio_msg_q_t *prio_msg_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u52a8\u6001\u521b\u5efa\u7684\uff08tos_prio_msg_q_create_dyn\uff09\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_msg_q \u4f18\u5148\u7ea7\u606f\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL prio_msg_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID prio_msg_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u3002 tos_prio_msg_q_flush k_err_t tos_prio_msg_q_flush(k_prio_msg_q_t *prio_msg_q); \u529f\u80fd\u63cf\u8ff0 \u51b2\u6d17 \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\uff08\u4e22\u5f03\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u4e2d\u7684\u6240\u6709\u6d88\u606f\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_msg_q \u4f18\u5148\u7ea7\u606f\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u51b2\u6d17\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL prio_msg_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID prio_msg_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u3002 tos_prio_msg_q_pend k_err_t tos_prio_msg_q_pend(k_prio_msg_q_t *prio_msg_q, void **msg_ptr, k_tick_t timeout); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u4ece\u6d88\u606f\u961f\u5217\u4e2d\u83b7\u53d6\u6d88\u606f\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_msg_q \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u53e5\u67c4 [out] msg_ptr \u83b7\u53d6\u5230\u7684\u6d88\u606f\u5730\u5740 [in] timeout \u7b49\u5f85\u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u4ece\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u83b7\u53d6\u6d88\u606f\u6210\u529f\uff0cmsg_addr\u548cmsg_size\u5206\u522b\u662f\u83b7\u53d6\u5230\u7684\u6d88\u606f\u5730\u5740\u548c\u6d88\u606f\u957f\u5ea6\u3002 K_ERR_PEND_NOWAIT \u672a\u80fd\u4ece\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u6d88\u606f\uff0c\u5e76\u4e14timeout\u53c2\u6570\u4e3aTOS_TIME_NOWAIT\uff08\u8868\u793a\u83b7\u53d6\u4e0d\u5230\u6d88\u606f\u65f6\u7acb\u5373\u8fd4\u56de\uff09\u3002 K_ERR_PEND_SCHED_LOCKED \u672a\u80fd\u4ece\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u6d88\u606f\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_TIMEOUT \u5728timeout\u8d85\u65f6\u8303\u56f4\u5185\u672a\u80fd\u4ece\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u6d88\u606f\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u83b7\u53d6\u6d88\u606f\u7684\u961f\u5217\u88ab\u9500\u6bc1\u4e86\uff08tos_prio_msg_q_destroy\uff09\u3002 tos_prio_msg_q_post k_err_t tos_prio_msg_q_post(k_prio_msg_q_t *prio_msg_q, void *msg_ptr, k_prio_t prio); \u529f\u80fd\u63cf\u8ff0 \u5411\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u4e2d\u653e\u5165\u4e00\u4e2a\u6d88\u606f\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u4e00\u4e2a\u4efb\u52a1\u3002\u5982\u679c\u6709\u591a\u4e2a\u4efb\u52a1\u5728\u6b64\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u7684\u7b49\u5f85\u961f\u5217\u4e0a\uff0c\u5524\u9192\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_msg_q \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u53e5\u67c4 [in] msg_ptr \u6d88\u606f\u5730\u5740 [in] prio \u6d88\u606f\u7684\u4f18\u5148\u7ea7 \u8fd4\u56de\u503c K_ERR_NONE \u5411\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u4e2d\u653e\u5165\u6d88\u606f\u6210\u529f\u3002 K_ERR_RING_Q_FULL \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u5df2\u6ee1\u3002 tos_prio_msg_q_post_all k_err_t tos_prio_msg_q_post_all(k_prio_msg_q_t *prio_msg_q, void *msg_ptr, k_prio_t prio); \u529f\u80fd\u63cf\u8ff0 \u5411\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u4e2d\u653e\u5165\u4e00\u4e2a\u6d88\u606f\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u6240\u6709\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_msg_q \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u53e5\u67c4 [in] msg_ptr \u6d88\u606f\u5730\u5740 [in] prio \u6d88\u606f\u7684\u4f18\u5148\u7ea7 \u8fd4\u56de\u503c K_ERR_NONE \u5411\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u4e2d\u653e\u5165\u6d88\u606f\u6210\u529f\u3002 K_ERR_RING_Q_FULL \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u5df2\u6ee1\u3002 \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217priority mail queue tos_prio_mail_q_create k_err_t tos_prio_msg_q_create(k_prio_mail_q_t *prio_mail_q, void *pool, size_t mail_cnt, size_t mail_size); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\uff08\u90ae\u4ef6\u662f\u4e00\u7247\u56fa\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\uff09\u3002\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u662f\u7528\u6765\u5728\u4efb\u52a1\u95f4\u4f20\u9012\u5177\u6709\u7279\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\u4fe1\u606f\u7684\u673a\u5236\uff0c\u4e0e\u90ae\u7bb1\u961f\u5217\u4e0d\u540c\u7684\u5730\u65b9\u5728\u4e8e\uff0c\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u53ef\u4ee5\u7ed9\u90ae\u4ef6\u8d4b\u4e88\u4e00\u4e2a\u4f18\u5148\u7ea7\uff0c\u8f83\u9ad8\u4f18\u5148\u7ea7\uff08\u6570\u503c\u4e0a\u66f4\u5c0f\uff09\u7684\u90ae\u4ef6\u4f1a\u6bd4\u8f83\u4f4e\u4f18\u5148\u7ea7\u7684\u90ae\u4ef6\u66f4\u5feb\u4f20\u9012\u5230\u7b49\u5f85\u4efb\u52a1\u3002pool\u7531\u7528\u6237\u4f20\u5165\uff0cpool\u662f\u4e00\u7247\u5927\u5c0f\u4e3a(mail_cnt* mail_size)\u7684\u5185\u5b58buffer\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_mail_q \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u53e5\u67c4 [in] pool \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u7684buffer\u6c60 [in] mail_cnt \u90ae\u4ef6\u7684\u6700\u5927\u6570\u91cf [in] mail_size \u90ae\u4ef6\u7684\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL prio_mail_q\u6307\u9488\u4e3a\u7a7a\u3002 tos_prio_mail_q_create_dyn k_err_t tos_prio_mail_q_create_dyn(k_prio_mail_q_t *prio_mail_q, size_t mail_cnt, size_t mail_size); \u529f\u80fd\u63cf\u8ff0 \u52a8\u6001\u521b\u5efa\u4e00\u4e2a\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\uff08\u90ae\u4ef6\u662f\u4e00\u7247\u56fa\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\uff09\u3002\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u662f\u7528\u6765\u5728\u4efb\u52a1\u95f4\u4f20\u9012\u5177\u6709\u7279\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\u4fe1\u606f\u7684\u673a\u5236\u3002\u5185\u90e8buffer\u7531\u52a8\u6001\u5185\u5b58\u5206\u914d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_mail_q \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u53e5\u67c4 [in] mail_cnt \u90ae\u4ef6\u7684\u6700\u5927\u6570\u91cf [in] mail_size \u90ae\u4ef6\u7684\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL prio_mail_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OUT_OF_MEMORY \u5806\u5185\u5b58\u4e0d\u8db3\u3002 tos_prio_mail_q_destroy k_err_t tos_prio_mail_q_destroy(k_prio_mail_q_t *prio_mail_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u90ae\u7bb1\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_mail_q \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL prio_mail_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID prio_mail_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u90ae\u7bb1\u961f\u5217\u3002 tos_prio_mail_q_destroy_dyn k_err_t tos_prio_mail_q_destroy_dyn(k_prio_mail_q_t *prio_mail_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u52a8\u6001\u521b\u5efa\u7684\uff08tos_mail_q_create_dyn\uff09\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_mail_q \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL prio_mail_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID prio_mail_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u3002 tos_prio_mail_q_flush k_err_t tos_prio_mail_q_flush(k_prio_mail_q_t *prio_mail_q); \u529f\u80fd\u63cf\u8ff0 \u51b2\u6d17\u90ae\u7bb1\u961f\u5217\uff08\u4e22\u5f03\u90ae\u7bb1\u961f\u5217\u4e2d\u7684\u6240\u6709\u90ae\u4ef6\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_mail_q \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u51b2\u6d17\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL prio_mail_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID prio_mail_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u90ae\u7bb1\u961f\u5217\u3002 tos_prio_mail_q_pend k_err_t tos_prio_mail_q_pend(k_prio_mail_q_t *prio_mail_q, void *mail_buf, size_t *mail_size, k_tick_t timeout); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u4ece\u90ae\u7bb1\u961f\u5217\u4e2d\u83b7\u53d6\u90ae\u4ef6\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_mail_q \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u53e5\u67c4 [out] mail_buf \u7528\u6765\u627f\u8f7d\u90ae\u4ef6\u5185\u5bb9\u7684buffer\u5730\u5740 [in] mail_size \u83b7\u53d6\u5230\u7684\u90ae\u4ef6\u957f\u5ea6 [in] timeout \u7b49\u5f85\u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u4ece\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u83b7\u53d6\u90ae\u4ef6\u6210\u529f\uff0cmail_buf\u4e2d\u88ab\u5199\u5165\u90ae\u4ef6\u5185\u5bb9\uff0cmsg_size\u83b7\u53d6\u5230\u7684\u90ae\u4ef6\u957f\u5ea6\u3002 K_ERR_PEND_NOWAIT \u672a\u80fd\u4ece\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u90ae\u4ef6\uff0c\u5e76\u4e14timeout\u53c2\u6570\u4e3aTOS_TIME_NOWAIT\uff08\u8868\u793a\u83b7\u53d6\u4e0d\u5230\u90ae\u4ef6\u65f6\u7acb\u5373\u8fd4\u56de\uff09\u3002 K_ERR_PEND_SCHED_LOCKED \u672a\u80fd\u4ece\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u90ae\u4ef6\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_TIMEOUT \u5728timeout\u8d85\u65f6\u8303\u56f4\u5185\u672a\u80fd\u4ece\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u90ae\u4ef6\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u83b7\u53d6\u90ae\u4ef6\u7684\u961f\u5217\u88ab\u9500\u6bc1\u4e86\uff08tos_prio_mail_q_destroy\uff09\u3002 tos_prio_mail_q_post k_err_t tos_prio_mail_q_post(k_prio_mail_q_t *prio_mail_q, void *mail_buf, size_t mail_size, k_prio_t prio); \u529f\u80fd\u63cf\u8ff0 \u5411\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u4e2d\u653e\u5165\u4e00\u4e2a\u90ae\u4ef6\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u4e00\u4e2a\u4efb\u52a1\u3002\u5982\u679c\u6709\u591a\u4e2a\u4efb\u52a1\u5728\u6b64\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u7684\u7b49\u5f85\u961f\u5217\u4e0a\uff0c\u5524\u9192\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_mail_q \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u53e5\u67c4 [in] mail_buf \u8981\u653e\u5165\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u7684\u90ae\u4ef6 [in] mail_size \u90ae\u4ef6\u957f\u5ea6 [in] prio \u90ae\u4ef6\u7684\u4f18\u5148\u7ea7 \u8fd4\u56de\u503c K_ERR_NONE \u5411\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u4e2d\u653e\u5165\u90ae\u4ef6\u6210\u529f\u3002 K_ERR_RING_Q_FULL \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u5df2\u6ee1\u3002 tos_prio_mail_q_post_all k_err_t tos_prio_mail_q_post_all(k_prio_mail_q_t *prio_mail_q, void *mail_buf, size_t mail_size, k_prio_t prio); \u529f\u80fd\u63cf\u8ff0 \u5411\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u4e2d\u653e\u5165\u4e00\u4e2a\u90ae\u4ef6\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u6240\u6709\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_mail_q \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u53e5\u67c4 [in] mail_buf \u8981\u653e\u5165\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u7684\u90ae\u4ef6 [in] mail_size \u90ae\u4ef6\u957f\u5ea6 [in] prio \u90ae\u4ef6\u7684\u4f18\u5148\u7ea7 \u8fd4\u56de\u503c K_ERR_NONE \u5411\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u4e2d\u653e\u5165\u90ae\u4ef6\u6210\u529f\u3002 K_ERR_RING_Q_FULL \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u5df2\u6ee1\u3002 \u73af\u5f62\u961f\u5217ring queue tos_ring_q_create k_err_t tos_ring_q_create(k_ring_q_t *ring_q, void *pool, size_t item_cnt, size_t item_size); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u73af\u5f62\u961f\u5217\u3002\u73af\u5f62\u961f\u5217\u63d0\u4f9b\u4e86\u4e00\u79cd\u5bf9\u6570\u636e\u8fdb\u884c\u5148\u5165\u5148\u51fa\u7ba1\u7406\u7684\u673a\u5236\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u4e0a\u5c42\u6570\u636e\u7ed3\u6784\u6216\u7b97\u6cd5\u7684\u5e95\u5c42\u6570\u636e\u5bb9\u5668\u3002pool\u7531\u7528\u6237\u4f20\u5165\uff0cpool\u662f\u4e00\u7247\u5927\u5c0f\u4e3a(item_cnt * item_size)\u7684\u5185\u5b58buffer\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ring_q \u73af\u5f62\u961f\u5217\u53e5\u67c4 [in] pool \u73af\u5f62\u961f\u5217\u7684buffer\u6c60 [in] item_cnt \u73af\u5f62\u961f\u5217\u7ba1\u7406\u7684\u5143\u7d20\u7684\u6570\u91cf [in] item_size \u73af\u5f62\u961f\u5217\u7ba1\u7406\u7684\u5143\u7d20\u7684\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u73af\u5f62\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 tos_ring_q_create_dyn k_err_t tos_ring_q_create(k_ring_q_t *ring_q, size_t item_cnt, size_t item_size); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u52a8\u6001\u5206\u914d\u7684\u73af\u5f62\u961f\u5217\u3002\u73af\u5f62\u961f\u5217\u63d0\u4f9b\u4e86\u4e00\u79cd\u5bf9\u6570\u636e\u8fdb\u884c\u5148\u5165\u5148\u51fa\u7ba1\u7406\u7684\u673a\u5236\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u4e0a\u5c42\u6570\u636e\u7ed3\u6784\u6216\u7b97\u6cd5\u7684\u5e95\u5c42\u6570\u636e\u5bb9\u5668\u3002\u5185\u90e8\u7684pool\u6c60\u7531\u52a8\u6001\u5185\u5b58\u5206\u914d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ring_q \u73af\u5f62\u961f\u5217\u53e5\u67c4 [in] item_cnt \u73af\u5f62\u961f\u5217\u7ba1\u7406\u7684\u5143\u7d20\u7684\u6570\u91cf [in] item_size \u73af\u5f62\u961f\u5217\u7ba1\u7406\u7684\u5143\u7d20\u7684\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u73af\u5f62\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OUT_OF_MEMORY \u5806\u5185\u5b58\u4e0d\u8db3\u3002 tos_ring_q_destroy k_err_t tos_ring_q_destroy(k_ring_q_t *ring_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u73af\u5f62\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ring_q \u73af\u5f62\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u9500\u6bc1\u73af\u5f62\u961f\u5217\u6210\u529f\u3002 K_ERR_OBJ_INVALID ring_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u73af\u5f62\u961f\u5217\u3002 tos_ring_q_destroy_dyn k_err_t tos_ring_q_destroy_dyn(k_ring_q_t *ring_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u52a8\u6001\u521b\u5efa\u7684\u73af\u5f62\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ring_q \u73af\u5f62\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u9500\u6bc1\u73af\u5f62\u961f\u5217\u6210\u529f\u3002 K_ERR_OBJ_INVALID ring_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u73af\u5f62\u961f\u5217\u3002 tos_ring_q_enqueue k_err_t tos_ring_q_enqueue(k_ring_q_t *ring_q, void *item, size_t item_size); \u529f\u80fd\u63cf\u8ff0 \u5411\u73af\u5f62\u961f\u5217\u4e2d\u653e\u5165\u4e00\u4e2a\u5143\u7d20\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ring_q \u73af\u5f62\u961f\u5217\u53e5\u67c4 [in] item \u5f85\u5165\u961f\u7684\u5143\u7d20\u5730\u5740 [in] item_size \u5f85\u5165\u961f\u7684\u5143\u7d20\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u5143\u7d20\u5165\u961f\u6210\u529f\u3002 K_ERR_RING_Q_FULL \u73af\u5f62\u961f\u5217\u5df2\u6ee1\u3002 tos_ring_q_dequeue k_err_t tos_ring_q_dequeue(k_ring_q_t *ring_q, void *item, size_t *item_size); \u529f\u80fd\u63cf\u8ff0 \u4ece\u73af\u5f62\u961f\u5217\u4e2d\u83b7\u53d6\u4e00\u4e2a\u5143\u7d20\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ring_q \u73af\u5f62\u961f\u5217\u53e5\u67c4 [out] item \u627f\u63a5\u51fa\u961f\u5143\u7d20\u7684\u5185\u5b58buffer [out] item_size \u51fa\u961f\u7684\u5143\u7d20\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u5143\u7d20\u51fa\u961f\u6210\u529f\u3002 K_ERR_RING_Q_EMPTY \u73af\u5f62\u961f\u5217\u5df2\u7a7a\u3002 tos_ring_q_flush k_err_t tos_ring_q_flush(k_ring_q_t *ring_q); \u529f\u80fd\u63cf\u8ff0 \u51b2\u6d17\u73af\u5f62\u961f\u5217\uff08\u590d\u4f4d\u73af\u5f62\u961f\u5217\uff0c\u4e22\u5f03\u73af\u5f62\u961f\u5217\u4e2d\u7684\u6240\u6709\u5143\u7d20\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ring_q \u73af\u5f62\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u51b2\u6d17\u73af\u5f62\u961f\u5217\u6210\u529f\u3002 tos_ring_q_is_empty k_err_t tos_ring_q_is_empty(k_ring_q_t *ring_q); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u4e00\u4e2a\u73af\u5f62\u961f\u5217\u662f\u5426\u4e3a\u7a7a\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ring_q \u73af\u5f62\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_TRUE \u73af\u5f62\u961f\u5217\u4e3a\u7a7a\u3002 K_FALSE \u73af\u5f62\u961f\u5217\u975e\u7a7a\u3002 tos_ring_q_is_full k_err_t tos_ring_q_is_full(k_ring_q_t *ring_q); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u4e00\u4e2a\u73af\u5f62\u961f\u5217\u662f\u5426\u4e3a\u6ee1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ring_q \u73af\u5f62\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_TRUE \u73af\u5f62\u961f\u5217\u4e3a\u6ee1\u3002 K_FALSE \u73af\u5f62\u961f\u5217\u975e\u6ee1\u3002 \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217fifo tos_chr_fifo_create k_err_t tos_chr_fifo_create(k_chr_fifo_t *chr_fifo, uint8_t *buffer, size_t size); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u3002\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u7684\u5e95\u5c42\u6570\u636e\u5bb9\u5668\u662f\u73af\u5f62\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 [in] buffer \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u5185\u5b58\u6c60 [in] size \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u5185\u5b58\u6c60\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL fifo\u662f\u7a7a\u6307\u9488\u3002 tos_chr_fifo_create_dyn k_err_t tos_chr_fifo_create(k_chr_fifo_t *chr_fifo, size_t fifo_size); \u529f\u80fd\u63cf\u8ff0 \u52a8\u6001\u521b\u5efa\u4e00\u4e2a\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\uff08\u5185\u90e8buffer\u52a8\u6001\u5206\u914d\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 [in] size \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u5185\u5b58\u6c60\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL chr_fifo\u662f\u7a7a\u6307\u9488\u3002 K_ERR_OUT_OF_MEMORY \u5806\u5185\u5b58\u4e0d\u8db3\u3002 tos_chr_fifo_destroy k_err_t tos_chr_fifo_destroy(k_chr_fifo_t *chr_fifo); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL chr_fifo\u662f\u7a7a\u6307\u9488\u3002 K_ERR_OBJ_INVALID chr_fifo\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u5148\u5165\u5148\u51fa\u961f\u5217\u3002 tos_chr_fifo_destroy_dyn k_err_t tos_chr_fifo_destroy_dyn(k_chr_fifo_t *chr_fifo); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u52a8\u6001\u521b\u5efa\uff08tos_chr_fifo_create_dyn\uff09\u7684\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL chr_fifo\u662f\u7a7a\u6307\u9488\u3002 K_ERR_OBJ_INVALID chr_fifo\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u5148\u5165\u5148\u51fa\u961f\u5217\u3002 tos_chr_fifo_push k_err_t tos_chr_fifo_push(k_chr_fifo_t *chr_fifo, uint8_t data); \u529f\u80fd\u63cf\u8ff0 \u5411\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u538b\u5165\u4e00\u4e2a\u5b57\u7b26\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 [in] data \u538b\u5165\u7684\u5b57\u7b26 \u8fd4\u56de\u503c K_ERR_NONE \u5b57\u7b26\u538b\u5165\u6210\u529f\u3002 K_ERR_FIFO_FULL \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u5df2\u6ee1\u3002 tos_chr_fifo_push_stream k_err_t tos_chr_fifo_push_stream(k_chr_fifo_t *chr_fifo, uint8_t *stream, size_t size); \u529f\u80fd\u63cf\u8ff0 \u5411\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u538b\u5165\u4e00\u4e2a\u5b57\u7b26\u6d41\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 [in] stream \u538b\u5165\u7684\u5b57\u7b26\u6d41 [in] size \u5b57\u7b26\u6d41\u957f\u5ea6 \u8fd4\u56de\u503c \u5b9e\u9645\u538b\u5165\u7684\u5b57\u7b26\u6d41\u957f\u5ea6\u3002 tos_chr_fifo_pop k_err_t tos_chr_fifo_pop(k_chr_fifo_t *chr_fifo, uint8_t *out); \u529f\u80fd\u63cf\u8ff0 \u4ece\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u5f39\u51fa\u4e00\u4e2a\u5b57\u7b26\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 [out] out \u5f39\u51fa\u7684\u5b57\u7b26 \u8fd4\u56de\u503c K_ERR_NONE \u5b57\u7b26\u5f39\u51fa\u6210\u529f\u3002 K_ERR_FIFO_EMPTY \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u5185\u5b58\u6c60\u5df2\u7a7a\u3002 tos_chr_fifo_pop_stream int tos_chr_fifo_pop_stream(k_chr_fifo_t *fifo, uint8_t *buffer, size_t size); \u529f\u80fd\u63cf\u8ff0 \u4ece\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u5f39\u51fa\u4e00\u4e2a\u5b57\u7b26\u6d41\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 [out] stream \u5f39\u51fa\u7684\u5b57\u7b26\u6d41 [in] size \u5b57\u7b26\u6d41\u957f\u5ea6 \u8fd4\u56de\u503c \u5b9e\u9645\u5f39\u51fa\u7684\u5b57\u7b26\u6d41\u957f\u5ea6\u3002 tos_chr_fifo_flush void tos_chr_fifo_flush(k_chr_fifo_t *chr_fifo); \u529f\u80fd\u63cf\u8ff0 \u51b2\u6d17\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c \u65e0 tos_chr_fifo_is_empty int tos_chr_fifo_is_empty(k_chr_fifo_t *chr_fifo); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u662f\u5426\u4e3a\u7a7a\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c 0\uff0cfifo\u4e0d\u4e3a\u7a7a\u3002 \u975e0\u503c\uff0cfifo\u4e3a\u7a7a\u3002 tos_chr_fifo_is_full int tos_chr_fifo_is_full(k_chr_fifo_t *chr_fifo); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u662f\u5426\u4e3a\u6ee1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c 0\uff0cfifo\u4e0d\u4e3a\u6ee1\u3002 \u975e0\u503c\uff0cfifo\u4e3a\u6ee1\u3002 \u4e8c\u9879\u5806binary heap tos_bin_heap_create k_err_t tos_bin_heap_create(k_bin_heap_t *bin_heap, void *pool, size_t item_cnt, size_t item_size, k_bin_heap_cmp cmp); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u4e8c\u9879\u5806\u3002\u4e8c\u9879\u5806\u662f\u5b9e\u73b0\u4f18\u5148\u7ea7\u961f\u5217\u7684\u5e95\u5c42\u6570\u636e\u7ed3\u6784\u3002pool\u7531\u7528\u6237\u4f20\u5165\uff0cpool\u662f\u4e00\u7247\u5927\u5c0f\u4e3a(item_cnt * item_size)\u7684\u5185\u5b58buffer\uff0ccmp\u662f\u6bd4\u8f83\u4e24\u4e2a\u5143\u7d20\u5927\u5c0f\u7684\u6bd4\u8f83\u51fd\u6570\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bin_heap \u4e8c\u9879\u5806\u53e5\u67c4 [in] pool \u4e8c\u9879\u5806\u7684buffer\u6c60 [in] item_cnt \u4e8c\u9879\u5806\u7ba1\u7406\u7684\u5143\u7d20\u7684\u6570\u91cf [in] item_size \u4e8c\u9879\u5806\u7ba1\u7406\u7684\u5143\u7d20\u7684\u5927\u5c0f [in] cmp \u6bd4\u8f83\u4e24\u4e2a\u4e8c\u9879\u5806\u5143\u7d20\u5927\u5c0f\u7684\u63a5\u53e3 \u8fd4\u56de\u503c K_ERR_NONE \u4e8c\u9879\u5806\u521b\u5efa\u6210\u529f\u3002 tos_bin_heap_create_dyn k_err_t tos_bin_heap_create_dyn(k_bin_heap_t *bin_heap, size_t item_cnt, size_t item_size, k_bin_heap_cmp cmp); \u529f\u80fd\u63cf\u8ff0 \u52a8\u6001\u521b\u5efa\u4e00\u4e2a\u4e8c\u9879\u5806\u3002\u5185\u90e8\u7684pool\u6c60\u7531\u52a8\u6001\u5185\u5b58\u5206\u914d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bin_heap \u73af\u5f62\u961f\u5217\u53e5\u67c4 [in] item_cnt \u6b64\u73af\u5f62\u961f\u5217\u7ba1\u7406\u7684\u5143\u7d20\u7684\u6570\u91cf [in] item_size \u4ece\u73af\u5f62\u961f\u5217\u7ba1\u7406\u7684\u5143\u7d20\u7684\u5927\u5c0f [in] cmp \u6bd4\u8f83\u4e24\u4e2a\u4e8c\u9879\u5806\u5143\u7d20\u5927\u5c0f\u7684\u63a5\u53e3 \u8fd4\u56de\u503c K_ERR_NONE \u4e8c\u9879\u5806\u521b\u5efa\u6210\u529f\u3002 K_ERR_OUT_OF_MEMORY \u5806\u5185\u5b58\u4e0d\u8db3\u3002 tos_bin_heap_destroy k_err_t tos_bin_heap_destroy(k_bin_heap_t *bin_heap); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u4e8c\u9879\u5806\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bin_heap \u4e8c\u9879\u5806\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u9500\u6bc1\u4e8c\u9879\u5806\u6210\u529f\u3002 K_ERR_OBJ_INVALID bin_heap\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4e8c\u9879\u5806\u3002 tos_bin_heap_destroy_dyn k_err_t tos_bin_heap_destroy_dyn(k_bin_heap_t *bin_heap); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u52a8\u6001\u521b\u5efa\u7684\u4e8c\u9879\u5806\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bin_heap \u4e8c\u9879\u5806\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u9500\u6bc1\u4e8c\u9879\u5806\u6210\u529f\u3002 K_ERR_OBJ_INVALID bin_heap\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4e8c\u9879\u5806\u3002 tos_bin_heap_push k_err_t tos_bin_heap_push(k_bin_heap_t *bin_heap, void *item, size_t item_size); \u529f\u80fd\u63cf\u8ff0 \u5411\u4e8c\u9879\u5806\u4e2d\u653e\u5165\u4e00\u4e2a\u5143\u7d20\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bin_heap \u4e8c\u9879\u5806\u53e5\u67c4 [out] item \u5f85\u5165\u5806\u7684\u5143\u7d20\u5730\u5740 [out] item_size \u5f85\u5165\u5806\u7684\u5143\u7d20\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u5143\u7d20\u5165\u5806\u6210\u529f\u3002 K_ERR_BIN_HEAP_FULL \u4e8c\u9879\u5806\u5df2\u6ee1\u3002 tos_bin_heap_pop k_err_t tos_bin_heap_pop(k_bin_heap_t *bin_heap, void *item, size_t *item_size); \u529f\u80fd\u63cf\u8ff0 \u4ece\u4e8c\u9879\u5806\u4e2d\u83b7\u53d6\u4e00\u4e2a\u5143\u7d20\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bin_heap \u4e8c\u9879\u5806\u53e5\u67c4 [out] item \u627f\u63a5\u51fa\u5806\u5143\u7d20\u7684\u5185\u5b58buffer [out] item_size \u51fa\u5806\u7684\u5143\u7d20\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u5143\u7d20\u51fa\u5806\u6210\u529f\u3002 K_ERR_BIN_HEAP_EMPTY \u4e8c\u9879\u5806\u5df2\u7a7a\u3002 tos_bin_heap_flush k_err_t tos_bin_heap_flush(k_bin_heap_t *bin_heap); \u529f\u80fd\u63cf\u8ff0 \u51b2\u6d17\u4e8c\u9879\u5806\uff08\u590d\u4f4d\u4e8c\u9879\u5806\uff0c\u4e22\u5f03\u4e8c\u9879\u5806\u4e2d\u7684\u6240\u6709\u5143\u7d20\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bin_heap \u4e8c\u9879\u5806\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u51b2\u6d17\u4e8c\u9879\u5806\u6210\u529f\u3002 tos_bin_heap_is_empty int tos_bin_heap_is_empty(k_bin_heap_t *bin_heap); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u4e00\u4e2a\u4e8c\u9879\u5806\u662f\u5426\u4e3a\u7a7a\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bin_heap \u4e8c\u9879\u5806\u53e5\u67c4 \u8fd4\u56de\u503c K_TRUE \u4e8c\u9879\u5806\u4e3a\u7a7a\u3002 K_FALSE \u4e8c\u9879\u5806\u975e\u7a7a\u3002 tos_bin_heap_is_full int tos_bin_heap_is_full(k_bin_heap_t *bin_heap); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u4e00\u4e2a\u4e8c\u9879\u5806\u662f\u5426\u4e3a\u6ee1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bin_heap \u4e8c\u9879\u5806\u53e5\u67c4 \u8fd4\u56de\u503c K_TRUE \u4e8c\u9879\u5806\u4e3a\u6ee1\u3002 K_FALSE \u4e8c\u9879\u5806\u975e\u6ee1\u3002 \u4f18\u5148\u7ea7\u961f\u5217priority queue tos_prio_q_create k_err_t tos_prio_q_create(k_prio_q_t *prio_q, void *mgr_array, void *pool, size_t item_cnt, size_t item_size); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u4f18\u5148\u7ea7\u961f\u5217\u3002\u4f18\u5148\u7ea7\u63d0\u4f9b\u4e86\u4e00\u79cd\u5bf9\u6570\u636e\u8fdb\u884c\u57fa\u4e8e\u4f18\u5148\u7ea7\u7ba1\u7406\u7684\u673a\u5236\uff0c\u6bcf\u6b21\u51fa\u961f\u7684\u603b\u662f\u961f\u5217\u4e2d\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u5143\u7d20\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u4e0a\u5c42\u6570\u636e\u7ed3\u6784\u6216\u7b97\u6cd5\u7684\u5e95\u5c42\u6570\u636e\u5bb9\u5668\u3002pool\u7531\u7528\u6237\u4f20\u5165\uff0cpool\u662f\u4e00\u7247\u5927\u5c0f\u4e3a(item_cnt * item_size)\u7684\u5185\u5b58buffer\uff0cmgr_array\u4e5f\u662f\u7531\u7528\u6237\u4f20\u5165\uff0c\u662f\u4e00\u7247\u5927\u5c0f\u4e3aTOS_PRIO_Q_MGR_ARRAY_SIZE(item_cnt)\u7684\u5185\u5b58buffer\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_q \u4f18\u5148\u7ea7\u961f\u5217\u53e5\u67c4 [in] mgr_array \u4f18\u5148\u7ea7\u961f\u5217\u7684\u5185\u90e8\u7ba1\u7406\u6570\u636e\u6c60 [in] pool \u4f18\u5148\u7ea7\u961f\u5217\u7684buffer\u6c60 [in] item_cnt \u4f18\u5148\u7ea7\u961f\u5217\u7ba1\u7406\u7684\u5143\u7d20\u7684\u6570\u91cf [in] item_size \u4f18\u5148\u7ea7\u961f\u5217\u7ba1\u7406\u7684\u5143\u7d20\u7684\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 tos_prio_q_create_dyn k_err_t tos_prio_q_create_dyn(k_prio_q_t *prio_q, size_t item_cnt, size_t item_size); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u52a8\u6001\u5206\u914d\u7684\u4f18\u5148\u7ea7\u961f\u5217\u3002\u4f18\u5148\u7ea7\u63d0\u4f9b\u4e86\u4e00\u79cd\u5bf9\u6570\u636e\u8fdb\u884c\u57fa\u4e8e\u4f18\u5148\u7ea7\u7ba1\u7406\u7684\u673a\u5236\uff0c\u6bcf\u6b21\u51fa\u961f\u7684\u603b\u662f\u961f\u5217\u4e2d\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u5143\u7d20\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u4e0a\u5c42\u6570\u636e\u7ed3\u6784\u6216\u7b97\u6cd5\u7684\u5e95\u5c42\u6570\u636e\u5bb9\u5668\u3002\u5185\u90e8\u7684pool\u6c60\u53ca\u7ba1\u7406\u6570\u636e\u6c60\u7531\u52a8\u6001\u5185\u5b58\u5206\u914d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_q \u4f18\u5148\u7ea7\u961f\u5217\u53e5\u67c4 [in] item_cnt \u4f18\u5148\u7ea7\u961f\u5217\u7ba1\u7406\u7684\u5143\u7d20\u7684\u6570\u91cf [in] item_size \u4f18\u5148\u7ea7\u961f\u5217\u7ba1\u7406\u7684\u5143\u7d20\u7684\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OUT_OF_MEMORY \u5806\u5185\u5b58\u4e0d\u8db3\u3002 tos_prio_q_destroy k_err_t tos_prio_q_destroy(k_prio_q_t *prio_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u4f18\u5148\u7ea7\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_q \u4f18\u5148\u7ea7\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u9500\u6bc1\u4f18\u5148\u7ea7\u961f\u5217\u6210\u529f\u3002 K_ERR_OBJ_INVALID prio_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4f18\u5148\u7ea7\u961f\u5217\u3002 tos_prio_q_destroy_dyn k_err_t tos_prio_q_destroy_dyn(k_prio_q_t *prio_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u52a8\u6001\u521b\u5efa\u7684\u4f18\u5148\u7ea7\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_q \u4f18\u5148\u7ea7\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u9500\u6bc1\u4f18\u5148\u7ea7\u961f\u5217\u6210\u529f\u3002 K_ERR_OBJ_INVALID prio_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4f18\u5148\u7ea7\u961f\u5217\u3002 tos_prio_q_enqueue k_err_t tos_prio_q_enqueue(k_prio_q_t *prio_q, void *item, size_t item_size, k_prio_t prio); \u529f\u80fd\u63cf\u8ff0 \u5411\u4f18\u5148\u7ea7\u961f\u5217\u4e2d\u653e\u5165\u4e00\u4e2a\u5143\u7d20\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_q \u4f18\u5148\u7ea7\u961f\u5217\u53e5\u67c4 [in] item \u5f85\u5165\u961f\u7684\u5143\u7d20\u5730\u5740 [in] item_size \u5f85\u5165\u961f\u7684\u5143\u7d20\u5927\u5c0f [in] prio \u5165\u961f\u5143\u7d20\u7684\u4f18\u5148\u7ea7 \u8fd4\u56de\u503c K_ERR_NONE \u5143\u7d20\u5165\u961f\u6210\u529f\u3002 K_ERR_PRIO_Q_FULL \u4f18\u5148\u7ea7\u961f\u5217\u5df2\u6ee1\u3002 tos_prio_q_dequeue k_err_t tos_prio_q_dequeue(k_prio_q_t *prio_q, void *item, size_t *item_size, k_prio_t *prio); \u529f\u80fd\u63cf\u8ff0 \u4ece\u4f18\u5148\u7ea7\u961f\u5217\u4e2d\u83b7\u53d6\u4e00\u4e2a\u5143\u7d20\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_q \u4f18\u5148\u7ea7\u961f\u5217\u53e5\u67c4 [out] item \u627f\u63a5\u51fa\u961f\u5143\u7d20\u7684\u5185\u5b58buffer [out] item_size \u51fa\u961f\u7684\u5143\u7d20\u5927\u5c0f [out] prio \u51fa\u961f\u7684\u5143\u7d20\u7684\u4f18\u5148\u7ea7 \u8fd4\u56de\u503c K_ERR_NONE \u5143\u7d20\u51fa\u961f\u6210\u529f\u3002 K_ERR_PRIO_Q_EMPTY \u4f18\u5148\u7ea7\u961f\u5217\u5df2\u7a7a\u3002 tos_prio_q_flush k_err_t tos_prio_q_flush(k_prio_q_t *prio_q); \u529f\u80fd\u63cf\u8ff0 \u51b2\u6d17\u4f18\u5148\u7ea7\u961f\u5217\uff08\u590d\u4f4d\u4f18\u5148\u7ea7\u961f\u5217\uff0c\u4e22\u5f03\u4f18\u5148\u7ea7\u961f\u5217\u4e2d\u7684\u6240\u6709\u5143\u7d20\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_q \u4f18\u5148\u7ea7\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u51b2\u6d17\u4f18\u5148\u7ea7\u961f\u5217\u6210\u529f\u3002 tos_prio_q_is_empty int tos_prio_q_is_empty(k_prio_q_t *prio_q); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u4e00\u4e2a\u4f18\u5148\u7ea7\u961f\u5217\u662f\u5426\u4e3a\u7a7a\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_q \u4f18\u5148\u7ea7\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_TRUE \u4f18\u5148\u7ea7\u961f\u5217\u4e3a\u7a7a\u3002 K_FALSE \u4f18\u5148\u7ea7\u961f\u5217\u975e\u7a7a\u3002 tos_prio_q_is_full int tos_prio_q_is_full(k_prio_q_t *prio_q); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u4e00\u4e2a\u4f18\u5148\u7ea7\u961f\u5217\u662f\u5426\u4e3a\u6ee1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_q \u4f18\u5148\u7ea7\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_TRUE \u4f18\u5148\u7ea7\u961f\u5217\u4e3a\u6ee1\u3002 K_FALSE \u4f18\u5148\u7ea7\u961f\u5217\u975e\u6ee1\u3002 \u5b9a\u65f6\u5668timer tos_timer_create k_err_t tos_timer_create(k_timer_t *tmr, k_tick_t delay, k_tick_t period, k_timer_callback_t callback, void *cb_arg, k_opt_t opt); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u5b9a\u65f6\u5668\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] tmr \u5b9a\u65f6\u5668\u53e5\u67c4 [in] delay \u5b9a\u65f6\u5668\u5ef6\u8fdf\u591a\u4e45\u540e\u6267\u884c [in] period \u5468\u671f\u6027timer\u7684\u5468\u671f [in] callback \u5b9a\u65f6\u5668\u56de\u8c03 [in] cb_arg \u5b9a\u65f6\u5668\u56de\u8c03\u53c2\u6570 [in] opt \u9009\u9879 \u6ce8\u610f opt\u9009\u9879\u8bf4\u660e\uff1a 1\u3001TOS_OPT_TIMER_ONESHOT \u200b \u4e00\u6b21\u6027\u5b9a\u65f6\u5668\uff0c\u521b\u5efa\u5b9a\u65f6\u5668\u65f6\u4f20\u5165\u6b64\u53c2\u6570\uff0c\u8868\u793a\u8be5\u5b9a\u65f6\u5668\u662f\u4e00\u6b21\u6027\u7684\uff0c\u53ea\u4f1a\u6267\u884c\u4e00\u6b21\u3002 2\u3001TOS_OPT_TIMER_PERIODIC \u200b \u5468\u671f\u6027\u5b9a\u65f6\u5668\uff0c\u521b\u5efa\u5b9a\u65f6\u5668\u65f6\u4f20\u5165\u6b64\u53c2\u6570\uff0c\u8868\u793a\u8be5\u5b9a\u65f6\u5668\u662f\u5468\u671f\u6027\u7684\uff0c\u5b9a\u65f6\u5668\u5230\u671f\u540e\uff0c\u4f1a\u6309period\u53c2\u6570\u5f00\u542f\u4e0b\u4e00\u4e2a\u5468\u671f\u3002 \u8fd4\u56de\u503c K_ERR_NONE \u5b9a\u65f6\u5668\u521b\u5efa\u6210\u529f\u3002 K_ERR_TIMER_INVALID_PERIOD \u975e\u6cd5\u7684period\u53c2\u6570\u3002 K_ERR_TIMER_INVALID_DELAY \u975e\u6cd5\u7684delay\u53c2\u6570\u3002 tos_timer_destroy k_err_t tos_timer_destroy(k_timer_t *tmr); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u5b9a\u65f6\u5668\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] tmr \u5b9a\u65f6\u5668\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u5b9a\u65f6\u5668\u542f\u52a8\u6210\u529f\u3002 K_ERR_TIMER_INACTIVE \u5b9a\u65f6\u5668\u5e76\u672a\u88ab\u521b\u5efa\u3002 tos_timer_start k_err_t tos_timer_start(k_timer_t *tmr); \u529f\u80fd\u63cf\u8ff0 \u542f\u52a8\u4e00\u4e2a\u5b9a\u65f6\u5668\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] tmr \u5b9a\u65f6\u5668\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u5b9a\u65f6\u5668\u542f\u52a8\u6210\u529f\u3002 K_ERR_TIMER_INACTIVE \u5b9a\u65f6\u5668\u5e76\u672a\u88ab\u521b\u5efa\u3002 K_ERR_TIMER_INVALID_STATE \u5b9a\u65f6\u5668\u72b6\u6001\u975e\u6cd5\u3002 tos_timer_stop k_err_t tos_timer_stop(k_timer_t *tmr); \u529f\u80fd\u63cf\u8ff0 \u505c\u6b62\u4e00\u4e2a\u5b9a\u65f6\u5668\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] tmr \u5b9a\u65f6\u5668\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u505c\u6b62\u5b9a\u65f6\u5668\u6210\u529f\u3002 K_ERR_TIMER_INACTIVE \u5b9a\u65f6\u5668\u5e76\u672a\u88ab\u521b\u5efa\u3002 K_ERR_TIMER_STOPPED \u5b9a\u65f6\u5668\u5df2\u7ecf\u5904\u4e8e\u505c\u6b62\u72b6\u6001\u3002 tos_timer_delay_change k_err_t tos_timer_delay_change(k_timer_t *tmr, k_tick_t delay); \u529f\u80fd\u63cf\u8ff0 \u4fee\u6539\u4e00\u4e2a\u5b9a\u65f6\u5668\u7684\u89e6\u53d1\u5ef6\u65f6\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] tmr \u5b9a\u65f6\u5668\u53e5\u67c4 [in] delay \u4fee\u6539\u540e\u7684\u89e6\u53d1\u5ef6\u65f6\u53c2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u4fee\u6539\u5b9a\u65f6\u5668\u89e6\u53d1\u5ef6\u65f6\u6210\u529f\u3002 K_ERR_TIMER_INACTIVE \u5b9a\u65f6\u5668\u5e76\u672a\u88ab\u521b\u5efa\u3002 K_ERR_TIMER_RUNNING \u5b9a\u65f6\u5668\u6b63\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\uff08\u4e0d\u5141\u8bb8\u4fee\u6539\u8fd0\u884c\u4e2d\u7684\u5b9a\u65f6\u5668\u7684\u89e6\u53d1\u5ef6\u65f6\u53c2\u6570\uff09\u3002 K_ERR_TIMER_INVALID_DELAY \u975e\u6cd5\u7684delay\u53c2\u6570\uff08\u8bd5\u56fe\u5c06\u4e00\u4e2a\u4e00\u6b21\u6027\u5b9a\u65f6\u5668\u7684delay\u53c2\u6570\u4fee\u6539\u4e3a0\uff09\u3002 tos_timer_period_change k_err_t tos_timer_period_change(k_timer_t *tmr, k_tick_t perio); \u529f\u80fd\u63cf\u8ff0 \u4fee\u6539\u4e00\u4e2a\u5b9a\u65f6\u5668\u7684\u89e6\u53d1\u5468\u671f\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] tmr \u5b9a\u65f6\u5668\u53e5\u67c4 [in] period \u4fee\u6539\u540e\u7684\u89e6\u53d1\u5468\u671f\u53c2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u4fee\u6539\u5b9a\u65f6\u5668\u89e6\u53d1\u5468\u671f\u6210\u529f\u3002 K_ERR_TIMER_INACTIVE \u5b9a\u65f6\u5668\u5e76\u672a\u88ab\u521b\u5efa\u3002 K_ERR_TIMER_RUNNING \u5b9a\u65f6\u5668\u6b63\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\uff08\u4e0d\u5141\u8bb8\u4fee\u6539\u8fd0\u884c\u4e2d\u7684\u5b9a\u65f6\u5668\u7684\u89e6\u53d1\u5ef6\u65f6\u53c2\u6570\uff09\u3002 K_ERR_TIMER_INVALID_PERIOD \u975e\u6cd5\u7684period\u53c2\u6570\uff08\u8bd5\u56fe\u5c06\u4e00\u4e2a\u5468\u671f\u6027\u5b9a\u65f6\u5668\u7684period\u53c2\u6570\u4fee\u6539\u4e3a0\uff09\u3002 \u8ba1\u65f6\u8868stopwatch tos_stopwatch_create k_err_t tos_stopwatch_create(k_stopwatch_t *stopwatch); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u8ba1\u65f6\u8868\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] stopwatch \u8ba1\u65f6\u8868\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u8ba1\u65f6\u8868\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL stopwatch\u662f\u7a7a\u6307\u9488\u3002 tos_stopwatch_destroy k_err_t tos_stopwatch_destroy(k_stopwatch_t *stopwatch); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u8ba1\u65f6\u8868\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] stopwatch \u8ba1\u65f6\u8868\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u8ba1\u65f6\u8868\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL stopwatch\u662f\u7a7a\u6307\u9488\u3002 K_ERR_OBJ_INVALID stopwatch\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u8ba1\u65f6\u8868\u3002 tos_stopwatch_countdown k_err_t tos_stopwatch_countdown(k_stopwatch_t *stopwatch, k_tick_t tick); \u529f\u80fd\u63cf\u8ff0 \u5f00\u59cb\u8ba1\u65f6\uff0c\u65f6\u95f4\u5355\u4f4d\u4e3a\u7cfb\u7edf\u6ef4\u7b54\u6570\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] stopwatch \u5b9a\u65f6\u5668\u53e5\u67c4 [in] tick \u8ba1\u65f6\u7684\u65f6\u95f4\u957f\u5ea6 \u8fd4\u56de\u503c K_ERR_NONE \u8ba1\u65f6\u8868\u542f\u52a8\u6210\u529f\u3002 tos_stopwatch_countdown_ms k_err_t tos_stopwatch_countdown_ms(k_stopwatch_t *stopwatch, k_time_t millisec); \u529f\u80fd\u63cf\u8ff0 \u5f00\u59cb\u8ba1\u65f6\uff0c\u65f6\u95f4\u5355\u4f4d\u4e3a\u6beb\u79d2\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] stopwatch \u5b9a\u65f6\u5668\u53e5\u67c4 [in] millisec \u8ba1\u65f6\u7684\u65f6\u95f4\u957f\u5ea6 \u8fd4\u56de\u503c K_ERR_NONE \u8ba1\u65f6\u8868\u542f\u52a8\u6210\u529f\u3002 tos_stopwatch_delay void tos_stopwatch_delay(k_tick_t tick); \u529f\u80fd\u63cf\u8ff0 \u5229\u7528\u8ba1\u65f6\u8868\u8fdb\u884c\u4e00\u6b21\u5ef6\u65f6\uff0c\u65f6\u95f4\u5355\u4f4d\u4e3a\u7cfb\u7edf\u6ef4\u7b54\u6570\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] stopwatch \u5b9a\u65f6\u5668\u53e5\u67c4 [in] tick \u5ef6\u8fdf\u7684\u65f6\u95f4\u957f\u5ea6 tos_stopwatch_delay_ms void tos_stopwatch_delay_ms(k_time_t millisec); \u529f\u80fd\u63cf\u8ff0 \u5229\u7528\u8ba1\u65f6\u8868\u8fdb\u884c\u4e00\u6b21\u5ef6\u65f6\uff0c\u65f6\u95f4\u5355\u4f4d\u4e3a\u6beb\u79d2\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] stopwatch \u5b9a\u65f6\u5668\u53e5\u67c4 [in] millisec \u5ef6\u8fdf\u7684\u65f6\u95f4\u957f\u5ea6 tos_stopwatch_remain k_tick_t tos_stopwatch_remain(k_stopwatch_t *stopwatch); \u529f\u80fd\u63cf\u8ff0 \u8fd4\u56de\u8ba1\u65f6\u8868\u5269\u4f59\u7684\u65f6\u95f4\uff0c\u65f6\u95f4\u5355\u4f4d\u4e3a\u7cfb\u7edf\u6ef4\u7b54\u6570\uff0c\u5982\u679c\u8ba1\u65f6\u5df2\u5230\u5219\u8fd4\u56de0\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] stopwatch \u5b9a\u65f6\u5668\u53e5\u67c4 \u8fd4\u56de\u503c \u8ba1\u65f6\u8868\u5269\u4f59\u65f6\u95f4\u3002 tos_stopwatch_remain_ms k_tick_t tos_stopwatch_remain_ms(k_stopwatch_t *stopwatch); \u529f\u80fd\u63cf\u8ff0 \u8fd4\u56de\u8ba1\u65f6\u8868\u5269\u4f59\u7684\u65f6\u95f4\uff0c\u65f6\u95f4\u5355\u4f4d\u4e3a\u6beb\u79d2\uff0c\u5982\u679c\u8ba1\u65f6\u5df2\u5230\u5219\u8fd4\u56de0\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] stopwatch \u5b9a\u65f6\u5668\u53e5\u67c4 \u8fd4\u56de\u503c \u8ba1\u65f6\u8868\u5269\u4f59\u65f6\u95f4\u3002 tos_stopwatch_is_expired int tos_stopwatch_is_expired(k_stopwatch_t *stopwatch); \u529f\u80fd\u63cf\u8ff0 \u8fd4\u56de\u8ba1\u65f6\u8868\u662f\u5426\u5df2\u8d85\u65f6\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] stopwatch \u5b9a\u65f6\u5668\u53e5\u67c4 \u8fd4\u56de\u503c K_TRUE \u8ba1\u65f6\u8868\u5df2\u8d85\u65f6\u3002 K_FALSE \u8ba1\u65f6\u8868\u672a\u8d85\u65f6\u3002 \u4f4d\u56febitmap tos_bitmap_create_empty __API__ k_err_t tos_bitmap_create_empty(k_bitmap_t *bitmap, k_bmtbl_t *bitmap_tbl, uint32_t bit_max); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u51680\u7684\u4f4d\u56fe\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bitmap \u4f4d\u56fe\u53e5\u67c4 [in] bitmap_tbl \u4f4d\u56fe\u6240\u9700\u7684\u5b58\u50a8\u8868\u3002 [in] bit_max \u4f4d\u56fe\u4e2d\u53ef\u8bb0\u5f55\u7684\u6700\u5927\u7684bit\u4f4d\u957f\u5ea6 \u6ce8\u610f bitmap_tbl\u662f\u7531\u7528\u6237\u4f20\u5165\u7684\u4e00\u7247\u5185\u5b58\u533a\u57df\uff0c\u5176\u957f\u5ea6\u7531TOS_BITMAP_SIZE\u8ba1\u7b97\uff0c\u5bf9\u4e8e\u6700\u5927\u7684bit\u4f4d\u957f\u5ea6\u4e3abit_max\u7684\u4f4d\u56fe\u5b58\u50a8\u8868\u6765\u8bf4\uff0c\u5176\u957f\u5ea6\u4e3aTOS_BITMAP_SIZE(bit_max)\uff0c\u90a3\u4e48\u7528\u6237\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2ak_bmtbl_t bitmap_tbl[TOS_BITMAP_SIZE(bit_max)]\uff0cbitmap_tbl\u4f5c\u4e3a\u6b64\u63a5\u53e3\u7684\u7b2c\u4e8c\u4e2a\u5165\u53c2\u3002 \u8fd4\u56de\u503c** K_ERR_NONE \u8ba1\u65f6\u8868\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL bitmap\u6216bitmap_tbl\u662f\u7a7a\u6307\u9488\u3002 tos_bitmap_create_full __API__ k_err_t tos_bitmap_create_full(k_bitmap_t *bitmap, k_bmtbl_t *bitmap_tbl, uint32_t bit_max); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u51681\u7684\u4f4d\u56fe\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bitmap \u4f4d\u56fe\u53e5\u67c4 [in] bitmap_tbl \u4f4d\u56fe\u6240\u9700\u7684\u5b58\u50a8\u8868\u3002 [in] bit_max \u4f4d\u56fe\u4e2d\u53ef\u8bb0\u5f55\u7684\u6700\u5927\u7684bit\u4f4d\u957f\u5ea6 \u6ce8\u610f bitmap_tbl\u662f\u7531\u7528\u6237\u4f20\u5165\u7684\u4e00\u7247\u5185\u5b58\u533a\u57df\uff0c\u5176\u957f\u5ea6\u7531TOS_BITMAP_SIZE\u8ba1\u7b97\uff0c\u5bf9\u4e8e\u6700\u5927\u7684bit\u4f4d\u957f\u5ea6\u4e3abit_max\u7684\u4f4d\u56fe\u5b58\u50a8\u8868\u6765\u8bf4\uff0c\u5176\u957f\u5ea6\u4e3aTOS_BITMAP_SIZE(bit_max)\uff0c\u90a3\u4e48\u7528\u6237\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2ak_bmtbl_t bitmap_tbl[TOS_BITMAP_SIZE(bit_max)]\uff0cbitmap_tbl\u4f5c\u4e3a\u6b64\u63a5\u53e3\u7684\u7b2c\u4e8c\u4e2a\u5165\u53c2\u3002 \u8fd4\u56de\u503c** K_ERR_NONE \u8ba1\u65f6\u8868\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL bitmap\u6216bitmap_tbl\u662f\u7a7a\u6307\u9488\u3002 tos_bitmap_destroy k_err_t tos_bitmap_destroy(k_bitmap_t *bitmap); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u4f4d\u56fe\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bitmap \u4f4d\u56fe\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4f4d\u56fe\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL bitmap\u662f\u7a7a\u6307\u9488\u3002 K_ERR_OBJ_INVALID bitmap\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4f4d\u56fe\u3002 tos_bitmap_set k_err_t tos_bitmap_set(k_bitmap_t *bitmap, uint32_t bit); \u529f\u80fd\u63cf\u8ff0 \u8bbe\u7f6e\u4e00\u4e2abit\u4f4d\uff0c\u5373\u5c06\u6b64bit\u4f4d\u6807\u8bb0\u4e3a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bitmap \u4f4d\u56fe\u53e5\u67c4 [in] bit \u8981\u8bbe\u7f6e\u7684bit\u4f4d \u8fd4\u56de\u503c K_ERR_NONE bit\u4f4d\u8bbe\u7f6e\u6210\u529f\u3002 K_ERR_BITMAP_EXCEED bit\u8d85\u51fa\u4e86bitmap\u53ef\u4ee5\u8bb0\u5f55\u7684\u8303\u56f4\u3002 tos_bitmap_reset k_err_t tos_bitmap_reset(k_bitmap_t *bitmap, uint32_t bit); \u529f\u80fd\u63cf\u8ff0 \u590d\u4f4d\u4e00\u4e2abit\u4f4d\uff0c\u5373\u5c06\u6b64bit\u4f4d\u6807\u8bb0\u4e3a0\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bitmap \u4f4d\u56fe\u53e5\u67c4 [in] bit \u8981\u8bbe\u7f6e\u7684bit\u4f4d \u8fd4\u56de\u503c K_ERR_NONE bit\u4f4d\u590d\u4f4d\u6210\u529f\u3002 K_ERR_BITMAP_EXCEED bit\u8d85\u51fa\u4e86bitmap\u53ef\u4ee5\u8bb0\u5f55\u7684\u8303\u56f4\u3002 tos_bitmap_is_set k_err_t tos_bitmap_is_set(k_bitmap_t *bitmap, uint32_t bit); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u67d0bit\u4f4d\u662f\u5426\u5904\u4e8e\u8bbe\u7f6e\u72b6\u6001\uff0c\u4e5f\u5373\u662f\u5426\u4e3a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bitmap \u4f4d\u56fe\u53e5\u67c4 [in] bit bit\u4f4d \u8fd4\u56de\u503c K_TRUE \u8be5\u4f4d\u88ab\u8bbe\u7f6e\uff0c\u5373\u4e3a1\u3002 K_FALSE \u8be5\u4f4d\u672a\u88ab\u8bbe\u7f6e\uff0c\u5373\u4e3a0\u3002 K_ERR_BITMAP_EXCEED bit\u8d85\u51fa\u4e86bitmap\u53ef\u4ee5\u8bb0\u5f55\u7684\u8303\u56f4\u3002 tos_bitmap_is_reset k_err_t tos_bitmap_is_reset(k_bitmap_t *bitmap, uint32_t bit); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u67d0bit\u4f4d\u662f\u5426\u5904\u4e8e\u590d\u4f4d\u72b6\u6001\uff0c\u4e5f\u5373\u662f\u5426\u4e3a0\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bitmap \u4f4d\u56fe\u53e5\u67c4 [in] bit bit\u4f4d \u8fd4\u56de\u503c K_TRUE \u8be5\u4f4d\u88ab\u590d\u4f4d\uff0c\u5373\u4e3a0\u3002 K_FALSE \u8be5\u4f4d\u672a\u88ab\u8bbe\u7f6e\uff0c\u5373\u4e3a1\u3002 tos_bitmap_lsb int tos_bitmap_lsb(k_bitmap_t *bitmap); \u529f\u80fd\u63cf\u8ff0 \u83b7\u53d6\u4f4d\u56fe\u7684\u6700\u4f4e\u6709\u6548\u4f4d\uff0c\u4e5f\u5373\u6700\u4f4e\u7684\u88ab\u8bbe\u7f6e\u4e3a1\u7684\u4f4d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bitmap \u5b9a\u65f6\u5668\u53e5\u67c4 \u8fd4\u56de\u503c \u4f4d\u56fe\u7684\u6700\u4f4e\u6709\u6548\u4f4d\u3002 \u65f6\u95f4\u7ba1\u7406 tos_systick_get k_tick_t tos_systick_get(void); \u529f\u80fd\u63cf\u8ff0 \u83b7\u53d6\u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570\u3002 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c \u7cfb\u7edf\u81ea\u542f\u52a8\u4e3a\u6b62\u5230\u76ee\u524d\u4e3a\u6b62\u7684\u65f6\u949f\u6ef4\u7b54\u6570\u3002 tos_systick_set void tos_systick_set(k_tick_t tick); \u529f\u80fd\u63cf\u8ff0 \u8bbe\u7f6e\u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] tick \u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570 \u8fd4\u56de\u503c \u65e0 tos_tick2millisec k_time_t tos_tick2millisec(k_tick_t tick); \u529f\u80fd\u63cf\u8ff0 \u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570\u8f6c\u5316\u4e3a\u6beb\u79d2\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] tick \u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570 \u8fd4\u56de\u503c \u6beb\u79d2\u6570\u3002 tos_millisec2tick k_tick_t tos_millisec2tick(k_time_t millisec); \u529f\u80fd\u63cf\u8ff0 \u6beb\u79d2\u8f6c\u5316\u4e3a\u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] millisec \u6beb\u79d2\u6570 \u8fd4\u56de\u503c \u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570\u3002 tos_sleep_ms k_err_t tos_sleep_ms(k_time_t millisec); \u529f\u80fd\u63cf\u8ff0 \u7761\u7720\u5f53\u524d\u4efb\u52a1\uff0c\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] millisec \u4efb\u52a1\u7761\u7720\u6beb\u79d2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u7761\u7720\u6210\u529f\u3002 K_ERR_DELAY_ZERO \u6beb\u79d2\u6570\u4e3a0\u3002 tos_sleep_hmsm k_err_t tos_sleep_hmsm(k_time_t hour, k_time_t minute, k_time_t second, k_time_t millisec); \u529f\u80fd\u63cf\u8ff0 \u7761\u7720\u5f53\u524d\u4efb\u52a1\uff0c\u7761\u7720\u65f6\u957f\u4ee5\u7279\u5b9a\u7684\u65f6\u5206\u79d2\u6beb\u79d2\u5ea6\u91cf\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] hour \u5c0f\u65f6\u6570 [in] minute \u5206\u949f\u6570 [in] second \u79d2\u6570 [in] millisec \u6beb\u79d2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u7761\u7720\u6210\u529f\u3002 K_ERR_DELAY_ZERO \u6beb\u79d2\u6570\u4e3a0\u3002 \u529f\u8017\u7ba1\u7406 tos_pm_cpu_lpwr_mode_set k_err_t tos_pm_cpu_lpwr_mode_set(k_cpu_lpwr_mode_t cpu_lpwr_mode); \u529f\u80fd\u63cf\u8ff0 \u8bbe\u7f6eCPU\u7684\u4f4e\u529f\u8017\u6a21\u5f0f\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] cpu_lpwr_mode CPU\u7684\u4f4e\u529f\u8017\u6a21\u5f0f \u8fd4\u56de\u503c K_ERR_PM_WKUP_SOURCE_NOT_INSTALL \u5bf9\u5e94\u4f4e\u529f\u8017\u6a21\u5f0f\u4e0b\u7684\u5524\u9192\u6e90\u6ca1\u6709\u5b89\u88c5\u3002 K_ERR_NONE \u4f4e\u529f\u8017\u6a21\u5f0f\u8bbe\u7f6e\u6210\u529f\u3002 tos_pm_device_register int tos_pm_device_register(k_pm_device_t *device); \u529f\u80fd\u63cf\u8ff0 \u6ce8\u518c\u4e00\u4e2a\u4f4e\u529f\u8017\u7ba1\u7406\u8bbe\u5907\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] device \u4f4e\u529f\u8017\u7ba1\u7406\u8bbe\u5907\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6ce8\u518c\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL device\u4e3a\u7a7a\u3002 K_ERR_PM_DEVICE_ALREADY_REG \u8bbe\u5907\u5df2\u6ce8\u518c\u8fc7\u3002 K_ERR_PM_DEVICE_OVERFLOW \u6ce8\u518c\u8bbe\u5907\u6570\u91cf\u592a\u591a\u3002 tos_tickless_wkup_alarm_install void tos_tickless_wkup_alarm_install(k_cpu_lpwr_mode_t mode, k_tickless_wkup_alarm_t *wkup_alarm); \u529f\u80fd\u63cf\u8ff0 \u5b89\u88c5\u4e00\u4e2a\u4f4e\u529f\u8017\u6a21\u5f0f\u4e0b\u7684\u5524\u9192\u65f6\u949f\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mode \u4f4e\u529f\u8017\u6a21\u5f0f [in] wkup_alarm \u5524\u9192\u65f6\u949f \u8fd4\u56de\u503c \u65e0 tos_tickless_wkup_alarm_init int tos_tickless_wkup_alarm_init(k_cpu_lpwr_mode_t mode); \u529f\u80fd\u63cf\u8ff0 \u521d\u59cb\u5316\u7279\u5b9a\u4f4e\u529f\u8017\u6a21\u5f0f\u4e0b\u7684\u5524\u9192\u65f6\u949f\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mode \u4f4e\u529f\u8017\u6a21\u5f0f \u8fd4\u56de\u503c K_ERR_TICKLESS_WKUP_ALARM_NOT_INSTALLED \u5bf9\u5e94\u4f4e\u529f\u8017\u6a21\u5f0f\u7684\u5524\u9192\u95f9\u949f\u6ca1\u6709\u88ab\u5b89\u88c5 K_ERR_TICKLESS_WKUP_ALARM_NO_INIT \u5bf9\u5e94\u4f4e\u529f\u8017\u6a21\u5f0f\u7684\u5524\u9192\u95f9\u949f\u6ca1\u6709\u521d\u59cb\u5316\u51fd\u6570 \u7ec4\u4ef6API MQTT\u7aef\u4e91\u5bf9\u63a5 tos_mqtt_connect int tos_mqtt_connect(char *host, const char *port, mqtt_con_param_t *param); \u529f\u80fd\u63cf\u8ff0 \u8fde\u63a5MQTT\u670d\u52a1\u5668\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] host \u670d\u52a1\u5668IP\u5730\u5740\u6216\u57df\u540d [in] port \u670d\u52a1\u5668\u7aef\u53e3 [in] param \u8fde\u63a5\u53c2\u6570 \u8fd4\u56de\u503c \u6210\u529f\uff0c\u8fd4\u56desocket fd\u3002 \u5931\u8d25\uff0c\u8fd4\u56de-1\u3002 tos_mqtt_publish int tos_mqtt_publish(int sock, mqtt_pub_param_t *param); \u529f\u80fd\u63cf\u8ff0 \u53d1\u5e03MQTT\u6d88\u606f \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sock socket fd\uff0c\u7531tos_mqtt_connect\u83b7\u53d6\u3002 [in] param \u6d88\u606f\u53d1\u5e03\u53c2\u6570 \u8fd4\u56de\u503c 0\uff0c\u53d1\u5e03\u6210\u529f\u3002 -1\uff0c\u53d1\u5e03\u5931\u8d25\u3002 tos_mqtt_subscribe int tos_mqtt_subscribe(int sock, mqtt_sub_param_t *param); \u529f\u80fd\u63cf\u8ff0 \u8ba2\u9605MQTT\u6d88\u606f \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sock socket fd\uff0c\u7531tos_mqtt_connect\u83b7\u53d6\u3002 [in] param \u6d88\u606f\u8ba2\u9605\u53c2\u6570 \u8fd4\u56de\u503c 0\uff0c\u8ba2\u9605\u6210\u529f\u3002 -1\uff0c\u8ba2\u9605\u5931\u8d25\u3002 tos_mqtt_receive int tos_mqtt_receive(char *topic, int topic_len, unsigned char *payload, int payload_len); \u529f\u80fd\u63cf\u8ff0 \u6536\u53d6MQTT\u6d88\u606f \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [out] topic \u6536\u53d6\u5230\u7684MQTT topic [in] topic_len MQTT topic buffer\u957f\u5ea6 [out] payload \u6536\u53d6\u5230\u7684payload [in] payload_len payload buffer\u957f\u5ea6 \u8fd4\u56de\u503c \u6210\u529f\uff0c\u8fd4\u56de\u6536\u53d6\u5230\u7684payload\u957f\u5ea6\u3002 \u5931\u8d25\uff0c\u8fd4\u56de-1\u3002 CMSIS\u9002\u914d\u5c42 osKernelStart osStatus osKernelStart(void); \u529f\u80fd\u63cf\u8ff0 \u542f\u52a8\u5185\u6838 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002 osKernelInitialize osStatus osKernelInitialize(void); \u529f\u80fd\u63cf\u8ff0 \u521d\u59cb\u5316\u5185\u6838 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002 osKernelRunning int32_t osKernelRunning(void); \u529f\u80fd\u63cf\u8ff0 \u8fd4\u56de\u5185\u6838\u662f\u5426\u6b63\u5728\u8fd0\u884c \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c 0\uff0c\u5185\u6838\u4e0d\u5728\u8fd0\u884c\u3002 \u975e0\uff0c\u5185\u6838\u6b63\u5728\u8fd0\u884c\u3002 osKernelSysTick uint32_t osKernelSysTick(void); \u529f\u80fd\u63cf\u8ff0 \u83b7\u53d6\u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c \u7cfb\u7edf\u81ea\u542f\u52a8\u5f00\u59cb\u5230\u76ee\u524d\u7684\u65f6\u949f\u6ef4\u7b54\u6570\u3002 osThreadCreate osThreadId osThreadCreate(const osThreadDef_t *thread_def, void *argument); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4efb\u52a1 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] thread_def \u4efb\u52a1\u521d\u59cb\u5316\u53c2\u6570 [in] argument \u4f20\u9012\u7ed9\u4efb\u52a1\u5165\u53c2 \u8fd4\u56de\u503c \u6210\u529f\uff0c\u5219\u8fd4\u56de\u521b\u5efa\u7684\u4efb\u52a1\u53e5\u67c4\u3002 \u5931\u8d25\uff0c\u8fd4\u56deNULL\u3002 osThreadGetId osThreadId osThreadGetId(void); \u529f\u80fd\u63cf\u8ff0 \u83b7\u53d6\u5f53\u524d\u4efb\u52a1\u53e5\u67c4 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c \u5f53\u524d\u4efb\u52a1\u53e5\u67c4\u3002 osThreadTerminate osStatus osThreadTerminate(osThreadId thread_id); \u529f\u80fd\u63cf\u8ff0 \u7ec8\u6b62\u4efb\u52a1\u8fd0\u884c\u5e76\u5220\u9664\u4efb\u52a1 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] thread_id \u4efb\u52a1\u53e5\u67c4 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002 osThreadSetPriority osStatus osThreadSetPriority(osThreadId thread_id, osPriority priority); \u529f\u80fd\u63cf\u8ff0 \u8bbe\u7f6e\u4efb\u52a1\u4f18\u5148\u7ea7 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] thread_id \u4efb\u52a1\u53e5\u67c4 [in] priority \u4f18\u5148\u7ea7 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002 osThreadGetPriority osPriority osThreadGetPriority(osThreadId thread_id); \u529f\u80fd\u63cf\u8ff0 \u83b7\u53d6\u4efb\u52a1\u4f18\u5148\u7ea7 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] thread_id \u4efb\u52a1\u53e5\u67c4 \u8fd4\u56de\u503c \u4efb\u52a1\u4f18\u5148\u7ea7\u3002 osDelay osStatus osDelay(uint32_t millisec); \u529f\u80fd\u63cf\u8ff0 \u7761\u7720\u5f53\u524d\u4efb\u52a1\uff0c\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] millisec \u7761\u7720\u65f6\u95f4\u6beb\u79d2\u6570 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002 osTimerCreate osTimerId osTimerCreate(const osTimerDef_t *timer_def, os_timer_type type, void *argument); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u5b9a\u65f6\u5668\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] timer_def \u5b9a\u65f6\u5668\u521d\u59cb\u5316\u53c2\u6570 [in] type \u5b9a\u65f6\u5668\u7c7b\u578b [in] argument \u5b9a\u65f6\u5668\u56de\u8c03\u5165\u53c2 \u8fd4\u56de\u503c \u6210\u529f\uff0c\u5219\u8fd4\u56de\u521b\u5efa\u7684\u5b9a\u65f6\u5668\u53e5\u67c4\u3002 \u5931\u8d25\uff0c\u8fd4\u56deNULL\u3002 osTimerStart osStatus osTimerStart(osTimerId timer_id, uint32_t millisec); \u529f\u80fd\u63cf\u8ff0 \u542f\u52a8\u5b9a\u65f6\u5668 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] timer_id \u5b9a\u65f6\u5668\u53e5\u67c4 [in] millisec \u6267\u884c\u5ef6\u8fdf\u53c2\u6570 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002 osTimerStop osStatus osTimerStop(osTimerId timer_id); \u529f\u80fd\u63cf\u8ff0 \u505c\u6b62\u5b9a\u65f6\u5668 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] timer_id \u5b9a\u65f6\u5668\u53e5\u67c4 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002 osTimerDelete osStatus osTimerDelete(osTimerId timer_id); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u5b9a\u65f6\u5668 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] timer_id \u5b9a\u65f6\u5668\u53e5\u67c4 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002 osMutexCreate osStatus osMutexCreate(const osMutexDef_t *mutex_def); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e92\u65a5\u91cf \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mutex_def \u4e92\u65a5\u91cf\u521d\u59cb\u5316\u53c2\u6570 \u8fd4\u56de\u503c \u6210\u529f\uff0c\u5219\u8fd4\u56de\u521b\u5efa\u7684\u4e92\u65a5\u91cf\u53e5\u67c4\u3002 \u5931\u8d25\uff0c\u8fd4\u56deNULL\u3002 osMutexWait osStatus osMutexWait(osMutexId mutex_id, uint32_t millisec); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u83b7\u53d6\u4e00\u4e2a\u4e92\u65a5\u91cf \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mutex_id \u4e92\u65a5\u91cf\u53e5\u67c4 [in] millisec \u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002 osMutexRelease osStatus osMutexRelease(osMutexId mutex_id); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4e92\u65a5\u91cf \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mutex_id \u4e92\u65a5\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002 osMutexDelete osStatus osMutexDelete(osMutexId mutex_id); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e92\u65a5\u91cf \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mutex_id \u4e92\u65a5\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002 osSemaphoreCreate osSemaphoreId osSemaphoreCreate(const osSemaphoreDef_t *semaphore_def, int32_t count); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u4fe1\u53f7\u91cf \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] semaphore_def \u4fe1\u53f7\u91cf\u521d\u59cb\u5316\u53c2\u6570 [in] count \u4fe1\u53f7\u91cf\u521d\u59cb\u503c \u8fd4\u56de\u503c \u6210\u529f\uff0c\u5219\u8fd4\u56de\u521b\u5efa\u7684\u4fe1\u53f7\u91cf\u53e5\u67c4\u3002 \u5931\u8d25\uff0c\u8fd4\u56deNULL\u3002 osSemaphoreWait int32_t osSemaphoreWait(osSemaphoreId semaphore_id, uint32_t millisec); \u529f\u80fd\u63cf\u8ff0 \u7b49\u5f85\u4e00\u4e2a\u4fe1\u53f7\u91cf \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] semaphore_id \u4fe1\u53f7\u91cf\u53e5\u67c4 [in] millisec \u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c \u6210\u529f\uff0c\u5219\u8fd4\u56de\u4fe1\u53f7\u91cf\u53ef\u7528\u7684\u8d44\u6e90\u6570\u3002 \u5931\u8d25\uff0c\u8fd4\u56de-1\u3002 osSemaphoreRelease osStatus osSemaphoreRelease(osSemaphoreId semaphore_id); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4fe1\u53f7\u91cf \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] semaphore_id \u4fe1\u53f7\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002 osSemaphoreDelete osStatus osSemaphoreDelete(osSemaphoreId semaphore_id); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4fe1\u53f7\u91cf \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] semaphore_id \u4fe1\u53f7\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002 osPoolCreate osPoolId osPoolCreate(const osPoolDef_t *pool_def); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u5185\u5b58\u6c60 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] pool_def \u5185\u5b58\u6c60\u521d\u59cb\u5316\u53c2\u6570 \u8fd4\u56de\u503c \u6210\u529f\uff0c\u5219\u8fd4\u56de\u521b\u5efa\u7684\u5185\u5b58\u6c60\u53e5\u67c4\u3002 \u5931\u8d25\uff0c\u8fd4\u56deNULL\u3002 osPoolAlloc void *osPoolAlloc(osPoolId pool_id); \u529f\u80fd\u63cf\u8ff0 \u4ece\u5185\u5b58\u6c60\u4e2d\u83b7\u53d6\u4e00\u4e2a\u5185\u5b58\u5757 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] pool_id \u5185\u5b58\u6c60\u53e5\u67c4 \u8fd4\u56de\u503c \u6210\u529f\uff0c\u5219\u8fd4\u56de\u5206\u914d\u5230\u7684\u5185\u5b58\u5757\u8d77\u59cb\u5730\u5740\u3002 \u5931\u8d25\uff0c\u8fd4\u56deNULL\u3002 osPoolCAlloc void *osPoolCAlloc(osPoolId pool_id); \u529f\u80fd\u63cf\u8ff0 \u4ece\u5185\u5b58\u6c60\u4e2d\u83b7\u53d6\u4e00\u4e2a\u5185\u5b58\u5757\uff0c\u5e76\u5c06\u6b64\u5185\u5b58\u5757\u6e05\u7a7a\u4e3a0\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] pool_id \u5185\u5b58\u6c60\u53e5\u67c4 \u8fd4\u56de\u503c \u6210\u529f\uff0c\u5219\u8fd4\u56de\u5206\u914d\u5230\u7684\u5185\u5b58\u5757\u8d77\u59cb\u5730\u5740\u3002 \u5931\u8d25\uff0c\u8fd4\u56deNULL\u3002 osPoolFree osStatus osPoolFree(osPoolId pool_id, void *block); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4e00\u4e2a\u5185\u5b58\u5757 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] pool_id \u5185\u5b58\u6c60\u53e5\u67c4 [in] block \u5185\u5b58\u5757\u8d77\u59cb\u5730\u5740 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002 osMessageCreate osMessageQId osMessageCreate(const osMessageQDef_t *queue_def, osThreadId thread_id); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u961f\u5217 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] queue_def \u961f\u5217\u521d\u59cb\u5316\u53c2\u6570 [in] thread_id \u4efb\u52a1\u53e5\u67c4 \u8fd4\u56de\u503c \u6210\u529f\uff0c\u5219\u8fd4\u56de\u521b\u5efa\u7684\u961f\u5217\u53e5\u67c4\u3002 \u5931\u8d25\uff0c\u8fd4\u56deNULL\u3002 osMessagePut osStatus osMessagePut(osMessageQId queue_id, uint32_t info, uint32_t millisec); \u529f\u80fd\u63cf\u8ff0 \u5411\u961f\u5217\u4e2d\u653e\u7f6e\u4e00\u4e2a\u6d88\u606f \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] queue_id \u961f\u5217\u53e5\u67c4 [in] info \u8981\u653e\u7f6e\u7684\u6d88\u606f\u4f53 [in] millisec \u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002 osMessageGet osEvent osMessageGet(osMessageQId queue_id, uint32_t millisec); \u529f\u80fd\u63cf\u8ff0 \u4ece\u5185\u5b58\u6c60\u4e2d\u83b7\u53d6\u4e00\u4e2a\u6d88\u606f \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] queue_id \u961f\u5217\u53e5\u67c4 [in] millisec \u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c \u4e00\u4e2a\u5305\u542b\u4e86\u8fd4\u56de\u72b6\u6001\u7684osEvent\u4fe1\u606f\u7ed3\u6784\u4f53\u3002 \u7f51\u7edcAPI sal\u6a21\u7ec4\u8054\u7f51\u63a5\u53e3 tos_sal_module_register int tos_sal_module_register(sal_module_t *module); \u529f\u80fd\u63cf\u8ff0 \u6ce8\u518c\u4e00\u4e2a\u8054\u7f51\u6a21\u7ec4 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] module \u8054\u7f51\u6a21\u7ec4\u53e5\u67c4 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 tos_sal_module_init int tos_sal_module_init(void); \u529f\u80fd\u63cf\u8ff0 \u521d\u59cb\u5316\u6a21\u7ec4 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 tos_sal_module_parse_domain int tos_sal_module_parse_domain(const char *host_name, char *host_ip); \u529f\u80fd\u63cf\u8ff0 \u57df\u540d\u89e3\u6790\uff0c\u5c06\u4e00\u4e2a\u57df\u540d\u8f6c\u6362\u4e3aIP\u5730\u5740\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] host_name \u5f85\u89e3\u6790\u7684\u57df\u540d [out] host_ip \u89e3\u6790\u540e\u7684IP\u5730\u5740 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 tos_sal_module_connect int tos_sal_module_connect(const char *ip, const char *port, sal_proto_t proto); \u529f\u80fd\u63cf\u8ff0 \u5411\u8fdc\u7aef\u53d1\u8d77\u8fde\u63a5 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ip IP\u5730\u5740 [in] port \u7aef\u53e3 [in] proto TCP/UDP\u534f\u8bae \u8fd4\u56de\u503c \u6210\u529f\uff0c\u5219\u8fd4\u56de\u8fde\u63a5\u7684socket id\u3002 \u5931\u8d25\uff0c\u8fd4\u56de-1\u3002 tos_sal_module_send int tos_sal_module_send(int sock, const void *buf, size_t len); \u529f\u80fd\u63cf\u8ff0 \u5411\u8fdc\u7aef\u53d1\u9001\u6570\u636e\uff08TCP\u534f\u8bae\u6808\uff09 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sock socket id(\u7531tos_sal_module_connect\u83b7\u53d6) [in] buf \u53d1\u9001\u7684\u6570\u636e\u8d77\u59cb\u5730\u5740 [in] len \u53d1\u9001\u7684\u6570\u636e\u957f\u5ea6 \u8fd4\u56de\u503c \u53d1\u9001\u7684\u6570\u636e\u957f\u5ea6\u3002 tos_sal_module_recv int tos_sal_module_recv(int sock, void *buf, size_t len); \u529f\u80fd\u63cf\u8ff0 \u4ece\u8fdc\u7aef\u8bfb\u53d6\u6570\u636e\uff08TCP\u534f\u8bae\u6808\uff09 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sock socket id\uff08\u7531tos_sal_module_connect\u83b7\u53d6\uff09 [out] buf \u63a5\u6536\u6570\u636ebuffer [in] len \u63a5\u6536\u6570\u636ebuffer\u957f\u5ea6 \u8fd4\u56de\u503c \u5b9e\u9645\u63a5\u6536\u5230\u7684\u6570\u636e\u957f\u5ea6\u3002 tos_sal_module_recv_timeout int tos_sal_module_recv_timeout(int sock, void *buf, size_t len, uint32_t timeout); \u529f\u80fd\u63cf\u8ff0 \u4ece\u8fdc\u7aef\u63a5\u6536\u6570\u636e\uff08TCP\u534f\u8bae\u6808\uff09 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sock socket id\uff08\u7531tos_sal_module_connect\u83b7\u53d6\uff09 [in] buf \u6570\u636e\u8d77\u59cb\u5730\u5740 [in] len \u6570\u636e\u957f\u5ea6 [in] timeout \u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c \u5b9e\u9645\u63a5\u6536\u5230\u7684\u6570\u636e\u957f\u5ea6\u3002 tos_sal_module_sendto int tos_sal_module_sendto(int sock, char *ip, char *port, void *buf, size_t len); \u529f\u80fd\u63cf\u8ff0 \u5411\u8fdc\u7aef\u53d1\u9001\u6570\u636e\uff08UDP\u534f\u8bae\u6808\uff09 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sock socket id\uff08\u7531tos_sal_module_connect\u83b7\u53d6\uff09 [in] ip IP\u5730\u5740 [in] port \u7aef\u53e3 [in] buf \u5f85\u53d1\u9001\u6570\u636e\u8d77\u59cb\u5730\u5740 [in] len \u5f85\u53d1\u9001\u6570\u636e\u957f\u5ea6 \u8fd4\u56de\u503c \u53d1\u9001\u7684\u6570\u636e\u957f\u5ea6\u3002 tos_sal_module_recvfrom int tos_sal_module_recvfrom(int sock, char *ip, char *port, void *buf, size_t len); \u529f\u80fd\u63cf\u8ff0 \u4ece\u8fdc\u7aef\u63a5\u6536\u6570\u636e\uff08UDP\u534f\u8bae\u6808\uff09 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sock socket id\uff08\u7531tos_sal_module_connect\u83b7\u53d6\uff09 [in] ip IP\u5730\u5740 [in] port \u7aef\u53e3 [in] buf \u63a5\u6536\u6570\u636ebuffer\u8d77\u59cb\u5730\u5740 [in] len \u63a5\u6536\u6570\u636ebuffer\u957f\u5ea6 \u8fd4\u56de\u503c \u5b9e\u9645\u63a5\u6536\u5230\u7684\u6570\u636e\u957f\u5ea6\u3002 tos_sal_module_close int tos_sal_module_close(int sock); \u529f\u80fd\u63cf\u8ff0 \u5173\u95ed\u4e0e\u8fdc\u7aef\u7684\u8fde\u63a5 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sock socket id\uff08\u7531tos_sal_module_connect\u83b7\u53d6\uff09 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 lora\u6a21\u7ec4\u8054\u7f51\u63a5\u53e3 tos_lora_module_register int tos_lora_module_register(lora_module_t *module); \u529f\u80fd\u63cf\u8ff0 \u6ce8\u518c\u4e00\u4e2alora\u6a21\u7ec4 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] module lora\u6a21\u7ec4\u53e5\u67c4 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 tos_lora_module_init int tos_lora_module_init(void); \u529f\u80fd\u63cf\u8ff0 \u521d\u59cb\u5316lora\u6a21\u7ec4 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 tos_lora_module_join int tos_lora_module_join(void); \u529f\u80fd\u63cf\u8ff0 \u52a0\u5165lora\u7f51\u5173 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 tos_lora_module_send int tos_lora_module_send(const void *buf, size_t len); \u529f\u80fd\u63cf\u8ff0 \u901a\u8fc7lora\u6a21\u7ec4\u53d1\u9001\u6570\u636e \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] buf \u8981\u53d1\u9001\u7684\u6570\u636e\u8d77\u59cb\u5730\u5740 [in] len \u8981\u53d1\u9001\u7684\u6570\u636e\u957f\u5ea6 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 tos_lora_module_recv int tos_lora_module_recv(void *buf, size_t len); \u529f\u80fd\u63cf\u8ff0 \u901a\u8fc7lora\u6a21\u7ec4\u63a5\u6536\u6570\u636e \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [out] buf \u63a5\u6536\u6570\u636e\u7684buffer\u5730\u5740 [in] len buffer\u957f\u5ea6 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 tos_lora_module_recv_timeout int tos_lora_module_recv_timeout(void *buf, size_t len, uint32_t timeout); \u529f\u80fd\u63cf\u8ff0 \u901a\u8fc7lora\u6a21\u7ec4\u63a5\u6536\u6570\u636e \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] buf \u63a5\u6536\u6570\u636e\u7684buffer\u5730\u5740 [in] len buffer\u957f\u5ea6 [in] timeout \u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 tos_lora_module_close int tos_lora_module_close(void); \u529f\u80fd\u63cf\u8ff0 \u5173\u95edlora\u6a21\u7ec4 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 \u817e\u8baf\u5b9a\u5236\u56fa\u4ef6\u6a21\u7ec4\u8054\u7f51\u63a5\u53e3 tos_tf_module_register int tos_tf_module_register(tencent_firmware_module_t *module); \u529f\u80fd\u63cf\u8ff0 \u6ce8\u518c\u4e00\u4e2a\u817e\u8baf\u5b9a\u5236\u56fa\u4ef6\u6a21\u7ec4 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] module \u817e\u8baf\u5b9a\u5236\u56fa\u4ef6\u6a21\u7ec4\u53e5\u67c4 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 tos_tf_module_init int tos_tf_module_init(void); \u529f\u80fd\u63cf\u8ff0 \u521d\u59cb\u5316\u817e\u8baf\u5b9a\u5236\u56fa\u4ef6\u6a21\u7ec4 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 tos_tf_module_info_set int tos_tf_module_info_set(device_info_t *info, tls_mode_t tls_mode); \u529f\u80fd\u63cf\u8ff0 \u8bbe\u7f6e\u817e\u8baf\u5b9a\u5236\u56fa\u4ef6\u6a21\u7ec4\u8bbe\u5907\u4fe1\u606f \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] device_info_t \u817e\u8baf\u5b9a\u5236\u56fa\u4ef6\u6a21\u7ec4\u8bbe\u5907\u4fe1\u606f\u63cf\u8ff0\u7ed3\u6784\u4f53 [in] tls_mode tls\u6821\u9a8c\u6a21\u5f0f \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 tos_tf_module_mqtt_conn int tos_tf_module_mqtt_conn(mqtt_param_t init_params); \u529f\u80fd\u63cf\u8ff0 \u901a\u8fc7\u817e\u8baf\u5b9a\u5236\u56fa\u4ef6\u6a21\u7ec4\u53d1\u8d77MQTT\u8fde\u63a5 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] init_params MQTT\u8fde\u63a5\u53c2\u6570 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 tos_tf_module_mqtt_discon int tos_tf_module_mqtt_discon(void); \u529f\u80fd\u63cf\u8ff0 \u65ad\u5f00\u817e\u8baf\u5b9a\u5236\u56fa\u4ef6\u6a21\u7ec4\u7684MQTT\u8fde\u63a5 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 tos_tf_module_mqtt_pub int tos_tf_module_mqtt_pub(const char *topic, qos_t qos, char *payload); \u529f\u80fd\u63cf\u8ff0 \u53d1\u5e03\u4e3b\u9898 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] topic \u4e3b\u9898 [in] qos qos [in] payload \u4e3b\u9898\u7684\u6d88\u606f\u8d1f\u8f7d \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 tos_tf_module_mqtt_publ int tos_tf_module_mqtt_publ(const char *topic, qos_t qos, char *payload); \u529f\u80fd\u63cf\u8ff0 \u53d1\u5e03\u957f\u6d88\u606f\u8d1f\u8f7d\uff08> 200\uff09\u4e3b\u9898 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] topic \u4e3b\u9898 [in] qos qos [in] payload \u4e3b\u9898\u7684\u6d88\u606f\u8d1f\u8f7d \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 tos_tf_module_mqtt_sub int tos_tf_module_mqtt_sub(char *topic, qos_t qos); \u529f\u80fd\u63cf\u8ff0 \u8ba2\u9605\u4e3b\u9898 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] topic \u4e3b\u9898 [in] qos qos \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 tos_tf_module_mqtt_unsub int tos_tf_module_mqtt_unsub(char *topic); \u529f\u80fd\u63cf\u8ff0 \u53d6\u6d88\u8ba2\u9605\u4e3b\u9898 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] topic \u4e3b\u9898 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 tos_tf_module_mqtt_state int tos_tf_module_mqtt_state(mqtt_state_t *state); \u529f\u80fd\u63cf\u8ff0 \u67e5\u8be2MQTT\u8fde\u63a5\u72b6\u6001 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [out] state \u8fde\u63a5\u72b6\u6001 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002 tos_tf_module_debug_level_set int tos_tf_module_debug_level_set(int log_level); \u529f\u80fd\u63cf\u8ff0 \u8bbe\u7f6e\u6a21\u7ec4\u8c03\u8bd5\u65e5\u5fd7\u7ea7\u522b \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] log_level \u8c03\u8bd5\u65e5\u5fd7\u7ea7\u522b \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"05.SDK_Manual"},{"location":"05.SDK_Manual/#tencentos-tiny-sdk","text":"*TencentOS Tiny SDK\u6587\u6863 \u5185\u6838API \u7cfb\u7edf\u7ba1\u7406 tos_knl_init tos_knl_start tos_knl_is_running tos_knl_irq_enter tos_knl_irq_leave tos_knl_sched_lock tos_knl_sched_unlock \u4efb\u52a1\u7ba1\u7406 tos_task_create tos_task_create_dyn tos_task_destroy tos_task_destroy_dyn tos_task_delay tos_task_delay_abort tos_task_suspend tos_task_resume tos_task_prio_change tos_task_yield tos_task_stack_draught_depth tos_task_curr_task_get tos_task_walkthru \u5806\u5185\u5b58\u7ba1\u7406 tos_mmheap_pool_add tos_mmheap_pool_rmv tos_mmheap_alloc tos_mmheap_aligned_alloc tos_mmheap_realloc tos_mmheap_free tos_mmheap_pool_check tos_mmheap_check \u5757\u5185\u5b58\u7ba1\u7406 tos_mmblk_pool_create tos_mmblk_alloc tos_mmblk_free \u4e92\u65a5\u91cfmutex tos_mutex_create tos_mutex_destroy tos_mutex_pend tos_mutex_pend_timed tos_mutex_post \u4fe1\u53f7\u91cfsemaphore tos_sem_create tos_sem_create_max tos_sem_destroy tos_sem_pend tos_sem_post tos_sem_post_all \u4e8b\u4ef6event tos_event_create tos_event_destroy tos_event_pend tos_event_post tos_event_post_keep \u5b8c\u6210\u91cfcompletion tos_completion_create tos_completion_destroy tos_completion_pend tos_completion_pend_timed tos_completion_post tos_completion_post_all tos_completion_reset tos_completion_is_done \u8ba1\u6570\u9501countdown latch tos_countdownlatch_create tos_countdownlatch_destroy tos_countdownlatch_pend tos_countdownlatch_pend_timed tos_countdownlatch_post tos_countdownlatch_reset \u6805\u680fbarrier tos_barrier_create tos_barrier_destroy tos_barrier_pend tos_barrier_reset \u8bfb\u5199\u9501rwlock tos_rwlock_create tos_rwlock_destroy tos_rwlock_rpend_timed tos_rwlock_rpend tos_rwlock_rpend_try tos_rwlock_wpend_timed tos_rwlock_wpend tos_rwlock_wpend_try tos_rwlock_rpost tos_rwlock_wpost tos_rwlock_post \u6d88\u606f\u961f\u5217message queue tos_msg_q_create tos_msg_q_create_dyn tos_msg_q_destroy tos_msg_q_destroy_dyn tos_msg_q_flush tos_msg_q_pend tos_msg_q_post tos_msg_q_post_all \u90ae\u7bb1\u961f\u5217mail queue tos_mail_q_create tos_mail_q_create_dyn tos_mail_q_destroy tos_mail_q_destroy_dyn tos_mail_q_flush tos_mail_q_pend tos_mail_q_post tos_mail_q_post_all \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217priority message queue tos_prio_msg_q_create tos_prio_msg_q_create_dyn tos_prio_msg_q_destroy tos_prio_msg_q_destroy_dyn tos_prio_msg_q_flush tos_prio_msg_q_pend tos_prio_msg_q_post tos_prio_msg_q_post_all \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217priority mail queue tos_prio_mail_q_create tos_prio_mail_q_create_dyn tos_prio_mail_q_destroy tos_prio_mail_q_destroy_dyn tos_prio_mail_q_flush tos_prio_mail_q_pend tos_prio_mail_q_post tos_prio_mail_q_post_all \u73af\u5f62\u961f\u5217ring queue tos_ring_q_create tos_ring_q_create_dyn tos_ring_q_destroy tos_ring_q_destroy_dyn tos_ring_q_enqueue tos_ring_q_dequeue tos_ring_q_flush tos_ring_q_is_empty tos_ring_q_is_full \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217fifo tos_chr_fifo_create tos_chr_fifo_create_dyn tos_chr_fifo_destroy tos_chr_fifo_destroy_dyn tos_chr_fifo_push tos_chr_fifo_push_stream tos_chr_fifo_pop tos_chr_fifo_pop_stream tos_chr_fifo_flush tos_chr_fifo_is_empty tos_chr_fifo_is_full \u4e8c\u9879\u5806binary heap tos_bin_heap_create tos_bin_heap_create_dyn tos_bin_heap_destroy tos_bin_heap_destroy_dyn tos_bin_heap_push tos_bin_heap_pop tos_bin_heap_flush tos_bin_heap_is_empty tos_bin_heap_is_full \u4f18\u5148\u7ea7\u961f\u5217priority queue tos_prio_q_create tos_prio_q_create_dyn tos_prio_q_destroy tos_prio_q_destroy_dyn tos_prio_q_enqueue tos_prio_q_dequeue tos_prio_q_flush tos_prio_q_is_empty tos_prio_q_is_full \u5b9a\u65f6\u5668timer tos_timer_create tos_timer_destroy tos_timer_start tos_timer_stop tos_timer_delay_change tos_timer_period_change \u8ba1\u65f6\u8868stopwatch tos_stopwatch_create tos_stopwatch_destroy tos_stopwatch_countdown tos_stopwatch_countdown_ms tos_stopwatch_delay tos_stopwatch_delay_ms tos_stopwatch_remain tos_stopwatch_remain_ms tos_stopwatch_is_expired \u4f4d\u56febitmap tos_bitmap_create_empty tos_bitmap_create_full tos_bitmap_destroy tos_bitmap_set tos_bitmap_reset tos_bitmap_is_set tos_bitmap_is_reset tos_bitmap_lsb \u65f6\u95f4\u7ba1\u7406 tos_systick_get tos_systick_set tos_tick2millisec tos_millisec2tick tos_sleep_ms tos_sleep_hmsm \u529f\u8017\u7ba1\u7406 tos_pm_cpu_lpwr_mode_set tos_pm_device_register tos_tickless_wkup_alarm_install tos_tickless_wkup_alarm_init \u7ec4\u4ef6API MQTT\u7aef\u4e91\u5bf9\u63a5 tos_mqtt_connect tos_mqtt_publish tos_mqtt_subscribe tos_mqtt_receive CMSIS\u9002\u914d\u5c42 osKernelStart osKernelInitialize osKernelRunning osKernelSysTick osThreadCreate osThreadGetId osThreadTerminate osThreadSetPriority osThreadGetPriority osDelay osTimerCreate osTimerStart osTimerStop osTimerDelete osMutexCreate osMutexWait osMutexRelease osMutexDelete osSemaphoreCreate osSemaphoreWait osSemaphoreRelease osSemaphoreDelete osPoolCreate osPoolAlloc osPoolCAlloc osPoolFree osMessageCreate osMessagePut osMessageGet \u7f51\u7edcAPI sal\u6a21\u7ec4\u8054\u7f51\u63a5\u53e3 tos_sal_module_register tos_sal_module_init tos_sal_module_parse_domain tos_sal_module_connect tos_sal_module_send tos_sal_module_recv tos_sal_module_recv_timeout tos_sal_module_sendto tos_sal_module_recvfrom tos_sal_module_close lora\u6a21\u7ec4\u8054\u7f51\u63a5\u53e3 tos_lora_module_register tos_lora_module_init tos_lora_module_join tos_lora_module_send tos_lora_module_recv tos_lora_module_recv_timeout tos_lora_module_close \u817e\u8baf\u5b9a\u5236\u56fa\u4ef6\u6a21\u7ec4\u8054\u7f51\u63a5\u53e3 tos_tf_module_register tos_tf_module_init tos_tf_module_info_set tos_tf_module_mqtt_conn tos_tf_module_mqtt_discon tos_tf_module_mqtt_pub tos_tf_module_mqtt_publ tos_tf_module_mqtt_sub tos_tf_module_mqtt_unsub tos_tf_module_mqtt_state tos_tf_module_debug_level_set","title":"*TencentOS Tiny SDK\u6587\u6863"},{"location":"05.SDK_Manual/#api","text":"","title":"\u5185\u6838API"},{"location":"05.SDK_Manual/#_1","text":"","title":"\u7cfb\u7edf\u7ba1\u7406"},{"location":"05.SDK_Manual/#tos_knl_init","text":"k_err_t tos_knl_init(void); \u529f\u80fd\u63cf\u8ff0 \u521d\u59cb\u5316\u5185\u6838\u3002 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c K_ERR_NONE \u5185\u6838\u521d\u59cb\u5316\u6210\u529f\u3002 \u975eK_ERR_NONE \u5185\u6838\u521d\u59cb\u5316\u5931\u8d25\u3002","title":"tos_knl_init"},{"location":"05.SDK_Manual/#tos_knl_start","text":"k_err_t tos_knl_start(void); \u529f\u80fd\u63cf\u8ff0 \u542f\u52a8\u5185\u6838\u3002 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c K_ERR_NONE \u5185\u6838\u542f\u52a8\u6210\u529f\u3002 \u975eK_ERR_NONE \u5185\u6838\u542f\u52a8\u5931\u8d25\u3002","title":"tos_knl_start"},{"location":"05.SDK_Manual/#tos_knl_is_running","text":"int tos_knl_is_running(void); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u5185\u6838\u662f\u5426\u6b63\u5728\u8fd0\u884c\u3002 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c 0 \u5185\u6838\u4e0d\u5728\u8fd0\u884c\u3002 \u975e0 \u5185\u6838\u6b63\u5728\u8fd0\u884c\u3002","title":"tos_knl_is_running"},{"location":"05.SDK_Manual/#tos_knl_irq_enter","text":"void tos_knl_irq_enter(void); \u529f\u80fd\u63cf\u8ff0 \u6b64\u51fd\u6570\u5e94\u8be5\u5728\u4e2d\u65ad\u670d\u52a1\u51fd\u6570\u5f00\u59cb\u4e4b\u524d\u88ab\u8c03\u7528\u3002 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c \u65e0","title":"tos_knl_irq_enter"},{"location":"05.SDK_Manual/#tos_knl_irq_leave","text":"void tos_knl_irq_leave(void); \u529f\u80fd\u63cf\u8ff0 \u6b64\u51fd\u6570\u5e94\u8be5\u5728\u4e2d\u65ad\u670d\u52a1\u51fd\u6570\u7ed3\u675f\u4e4b\u524d\u88ab\u8c03\u7528\u3002 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c \u65e0","title":"tos_knl_irq_leave"},{"location":"05.SDK_Manual/#tos_knl_sched_lock","text":"k_err_t tos_knl_sched_lock(void); \u529f\u80fd\u63cf\u8ff0 \u9501\u5185\u6838\u8c03\u5ea6\u3002 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c K_ERR_NONE \u5185\u6838\u8c03\u5ea6\u9501\u5b9a\u6210\u529f\u3002 K_ERR_KNL_NOT_RUNNING \u5185\u6838\u5e76\u672a\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\u3002 K_ERR_LOCK_NESTING_OVERFLOW \u8c03\u5ea6\u9501\u6ea2\u51fa\u3002","title":"tos_knl_sched_lock"},{"location":"05.SDK_Manual/#tos_knl_sched_unlock","text":"k_err_t tos_knl_sched_unlock(void); \u529f\u80fd\u63cf\u8ff0 \u89e3\u9501\u5185\u6838\u8c03\u5ea6\u3002 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c K_ERR_NONE \u5185\u6838\u8c03\u5ea6\u89e3\u9501\u6210\u529f\u3002 K_ERR_KNL_NOT_RUNNING \u5185\u6838\u5e76\u672a\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\u3002 K_ERR_SCHED_NOT_LOCKED \u5185\u6838\u8c03\u5ea6\u5e76\u672a\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002","title":"tos_knl_sched_unlock"},{"location":"05.SDK_Manual/#_2","text":"","title":"\u4efb\u52a1\u7ba1\u7406"},{"location":"05.SDK_Manual/#tos_task_create","text":"k_err_t tos_task_create(k_task_t *task, char *name, k_task_entry_t entry, void *arg, k_prio_t prio, k_stack_t *stk_base, size_t stk_size, k_timeslice_t timeslice); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] task \u4efb\u52a1\u7ed3\u6784\u4f53\u63cf\u8ff0\u7b26 [in] name \u4efb\u52a1\u540d\u79f0 [in] entry \u4efb\u52a1\u5165\u53e3\u51fd\u6570 [in] arg \u4efb\u52a1\u5165\u53e3\u51fd\u6570\u53c2\u6570 [in] prio \u4efb\u52a1\u4f18\u5148\u7ea7 [in] stk_base \u4efb\u52a1\u6808\u7a7a\u95f4\u9996\u5730\u5740 [in] stk_size \u4efb\u52a1\u6808\u7a7a\u95f4\u7684\u5927\u5c0f [in] timeslice \u65f6\u95f4\u7247\u8f6e\u8f6c\u8c03\u5ea6\u4fa7\u7b56\u7565\u4e2d\uff0c\u65f6\u95f4\u7247\u7684\u5927\u5c0f\u8bbe\u7f6e\uff0c0\u8868\u793a\u8bbe\u7f6e\u4e3a\u7cfb\u7edf\u9ed8\u8ba4\u503c \u8fd4\u56de\u503c K_ERR_NONE \u4efb\u52a1\u521b\u5efa\u6210\u529f\u3002 K_ERR_TASK_STK_SIZE_INVALID \u975e\u6cd5\u7684\u4efb\u52a1\u6808\u5927\u5c0f\u3002 K_ERR_TASK_PRIO_INVALID \u975e\u6cd5\u7684\u4efb\u52a1\u4f18\u5148\u7ea7\u3002","title":"tos_task_create"},{"location":"05.SDK_Manual/#tos_task_create_dyn","text":"k_err_t tos_task_create_dyn(k_task_t **task, char *name, k_task_entry_t entry, void *arg, k_prio_t prio, size_t stk_size, k_timeslice_t timeslice); \u529f\u80fd\u63cf\u8ff0 \u52a8\u6001\u521b\u5efa\u4efb\u52a1\uff0ctask\u53e5\u67c4\u53catask\u6240\u9700\u7684\u6808\u7686\u4e3a\u7cfb\u7edf\u52a8\u6001\u5206\u914d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [out] task \u4efb\u52a1\u7ed3\u6784\u4f53\u63cf\u8ff0\u7b26 [in] name \u4efb\u52a1\u540d\u79f0 [in] entry \u4efb\u52a1\u5165\u53e3\u51fd\u6570 [in] arg \u4efb\u52a1\u5165\u53e3\u51fd\u6570\u53c2\u6570 [in] prio \u4efb\u52a1\u4f18\u5148\u7ea7 [in] stk_size \u4efb\u52a1\u6808\u7a7a\u95f4\u7684\u5927\u5c0f [in] timeslice \u65f6\u95f4\u7247\u8f6e\u8f6c\u8c03\u5ea6\u4fa7\u7b56\u7565\u4e2d\uff0c\u65f6\u95f4\u7247\u7684\u5927\u5c0f\u8bbe\u7f6e\uff0c0\u8868\u793a\u8bbe\u7f6e\u4e3a\u7cfb\u7edf\u9ed8\u8ba4\u503c \u8fd4\u56de\u503c K_ERR_NONE \u4efb\u52a1\u521b\u5efa\u6210\u529f\u3002 K_ERR_TASK_STK_SIZE_INVALID \u975e\u6cd5\u7684\u4efb\u52a1\u6808\u5927\u5c0f\u3002 K_ERR_TASK_PRIO_INVALID \u975e\u6cd5\u7684\u4efb\u52a1\u4f18\u5148\u7ea7\u3002 K_ERR_TASK_OUT_OF_MEMORY \u7cfb\u7edf\u5806\u5185\u5b58\u4e0d\u8db3\u3002","title":"tos_task_create_dyn"},{"location":"05.SDK_Manual/#tos_task_destroy","text":"k_err_t tos_task_destroy(k_task_t *task) \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] task \u4efb\u52a1\u7ed3\u6784\u4f53\u63cf\u8ff0\u7b26 \u8fd4\u56de\u503c K_ERR_NONE \u4efb\u52a1\u9500\u6bc1\u6210\u529f\u3002 K_ERR_TASK_DESTROY_IDLE \u8bd5\u56fe\u9500\u6bc1idle\u4efb\u52a1\uff08\u975e\u6cd5\uff09\u3002","title":"tos_task_destroy"},{"location":"05.SDK_Manual/#tos_task_destroy_dyn","text":"k_err_t tos_task_destroy_dyn(k_task_t *task) \u529f\u80fd\u63cf\u8ff0 static\u51fd\u6570\uff0c\u975e\u5bf9\u5916\u63a5\u53e3\uff0c\u9500\u6bc1\u52a8\u6001\u521b\u5efa\uff08tos_task_create_dyn\uff09\u7684\u4efb\u52a1\uff0c\u9ed8\u8ba4\u7531tos_task_destroy()\u51fd\u6570\u8c03\u7528\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] task \u4efb\u52a1\u7ed3\u6784\u4f53\u63cf\u8ff0\u7b26 \u8fd4\u56de\u503c K_ERR_NONE \u4efb\u52a1\u9500\u6bc1\u6210\u529f\u3002 K_ERR_TASK_DESTROY_IDLE \u8bd5\u56fe\u9500\u6bc1idle\u4efb\u52a1\uff08\u975e\u6cd5\uff09\u3002","title":"tos_task_destroy_dyn"},{"location":"05.SDK_Manual/#tos_task_delay","text":"k_err_t tos_task_delay(k_tick_t delay); \u529f\u80fd\u63cf\u8ff0 \u7761\u7720\u5f53\u524d\u4efb\u52a1\uff0c\u4ee5\u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570\u4e3a\u5355\u4f4d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] delay \u4efb\u52a1\u7761\u7720\u65f6\u95f4 \u8fd4\u56de\u503c K_ERR_NONE \u4efb\u52a1\u5ef6\u8fdf\u6210\u529f\u3002 K_ERR_DELAY_ZERO delay\u503c\u4e3a\u96f6\uff08\u975e\u6cd5\uff09\u3002","title":"tos_task_delay"},{"location":"05.SDK_Manual/#tos_task_delay_abort","text":"k_err_t tos_task_delay_abort(k_task_t *task); \u529f\u80fd\u63cf\u8ff0 \u53d6\u6d88\u4e00\u4e2a\u4efb\u52a1\u7684delay\u72b6\u6001\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] task \u4efb\u52a1\u7ed3\u6784\u4f53\u63cf\u8ff0\u7b26 \u8fd4\u56de\u503c K_ERR_NONE \u53d6\u6d88delay\u6210\u529f\u3002 K_ERR_TASK_NOT_DELAY task\u5e76\u672a\u5904\u4e8edelay\u72b6\u6001\u3002 K_ERR_TASK_SUSPENDED task\u88ab\u6302\u8d77\uff08suspend\uff09\u3002","title":"tos_task_delay_abort"},{"location":"05.SDK_Manual/#tos_task_suspend","text":"k_err_t tos_task_suspend(k_task_t *task); \u529f\u80fd\u63cf\u8ff0 \u6302\u8d77\u4e00\u4e2a\u4efb\u52a1\uff08\u5265\u593a\u4e00\u4e2a\u4efb\u52a1\u7684\u8fd0\u884c\u8c03\u5ea6\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] task \u4efb\u52a1\u7ed3\u6784\u4f53\u63cf\u8ff0\u7b26 \u8fd4\u56de\u503c TOS_ERR_NONE \u6302\u8d77\u4efb\u52a1\u6210\u529f\u3002 K_ERR_TASK_SUSPEND_IDLE \u8bd5\u56fe\u6302\u8d77idle\u4efb\u52a1\uff08\u975e\u6cd5\uff09\u3002","title":"tos_task_suspend"},{"location":"05.SDK_Manual/#tos_task_resume","text":"k_err_t tos_task_resume(k_task_t *task); \u529f\u80fd\u63cf\u8ff0 \u6062\u590d\u4e00\u4e2a\u4efb\u52a1\u7684\u8c03\u5ea6\u8fd0\u884c\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] task \u4efb\u52a1\u7ed3\u6784\u4f53\u63cf\u8ff0\u7b26 \u8fd4\u56de\u503c TOS_ERR_NONE \u6062\u590d\u4efb\u52a1\u8fd0\u884c\u6210\u529f\u3002 K_ERR_TASK_RESUME_SELF \u8bd5\u56fe\u6062\u590d\u5f53\u524d\u4efb\u52a1\uff08\u975e\u6cd5\uff09\u3002","title":"tos_task_resume"},{"location":"05.SDK_Manual/#tos_task_prio_change","text":"k_err_t tos_task_prio_change(k_task_t *task, k_prio_t prio_new); \u529f\u80fd\u63cf\u8ff0 \u66f4\u6539\u4e00\u4e2a\u4efb\u52a1\u7684\u4f18\u5148\u7ea7\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] task \u4efb\u52a1\u7ed3\u6784\u4f53\u63cf\u8ff0\u7b26 [in] prio_new \u65b0\u7684\u4f18\u5148\u7ea7 \u8fd4\u56de\u503c K_ERR_NONE \u4efb\u52a1\u4f18\u5148\u7ea7\u66f4\u65b0\u6210\u529f\u3002 K_ERR_TASK_PRIO_INVALID \u4f18\u5148\u7ea7\u975e\u6cd5\u3002","title":"tos_task_prio_change"},{"location":"05.SDK_Manual/#tos_task_yield","text":"void tos_task_yield(void); \u529f\u80fd\u63cf\u8ff0 \u5f53\u524d\u4efb\u52a1\u4e3b\u52a8\u653e\u5f03cpu\u3002 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c \u65e0","title":"tos_task_yield"},{"location":"05.SDK_Manual/#tos_task_stack_draught_depth","text":"k_err_t tos_task_stack_draught_depth(k_task_t *task, int *depth); \u529f\u80fd\u63cf\u8ff0 \u83b7\u53d6\u4e00\u4e2a\u4efb\u52a1\u6808\u7684\u6700\u5927\u5403\u6c34\u6df1\u5ea6\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] task \u4efb\u52a1\u7ed3\u6784\u4f53\u63cf\u8ff0\u7b26 [out] depth \u4efb\u52a1\u6808\u7684\u5403\u6c34\u6df1\u5ea6 \u8fd4\u56de\u503c K_ERR_NONE \u4efb\u52a1\u6808\u72b6\u6001\u6b63\u5e38\u3002 K_ERR_TASK_STK_OVERFLOW \u4efb\u52a1\u6808\u6ea2\u51fa\u3002","title":"tos_task_stack_draught_depth"},{"location":"05.SDK_Manual/#tos_task_curr_task_get","text":"k_task_t *tos_task_curr_task_get(void); \u529f\u80fd\u63cf\u8ff0 \u83b7\u53d6\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684\u4efb\u52a1\u53e5\u67c4\u3002 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c K_NULL \u5f53\u524d\u65e0\u6b63\u5728\u8fd0\u884c\u4efb\u52a1\uff08\u5185\u6838\u5c1a\u672a\u542f\u52a8\uff09\u3002 \u975eK_NULL \u4efb\u52a1\u53e5\u67c4\u3002","title":"tos_task_curr_task_get"},{"location":"05.SDK_Manual/#tos_task_walkthru","text":"void tos_task_walkthru(k_task_walker walker); \u529f\u80fd\u63cf\u8ff0 \u904d\u5386\u5f53\u524d\u7cfb\u7edf\u5df2\u521b\u5efa\u7684\uff08\u4e0d\u5305\u62ec\u5df2\u5220\u9664\u7684\uff09\u4efb\u52a1\uff0c\u5e76\u5141\u8bb8\u7528\u6237\u4f20\u5165\u4e00\u4e2a\u56de\u8c03\uff0c\u5728\u904d\u5386\u6240\u6709\u4efb\u52a1\u65f6\uff0c\u5c06\u4efb\u52a1\u53e5\u67c4\u4f5c\u4e3a\u53c2\u6570\u8c03\u7528\u6b64\u56de\u8c03\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] walker \u904d\u5386\u6240\u6709\u4efb\u52a1\u65f6\u88ab\u8c03\u7528\u7684\u56de\u8c03\uff08walker\u4e3a\u4e00\u4e2a\u5165\u53c2\u4e3ak_task_t *\u7684\u51fd\u6570\uff09 \u8fd4\u56de\u503c \u65e0 \u975eK_NULL \u4efb\u52a1\u53e5\u67c4\u3002","title":"tos_task_walkthru"},{"location":"05.SDK_Manual/#_3","text":"","title":"\u5806\u5185\u5b58\u7ba1\u7406"},{"location":"05.SDK_Manual/#tos_mmheap_pool_add","text":"k_err_t tos_mmheap_pool_add(void *pool_start, size_t pool_size); \u529f\u80fd\u63cf\u8ff0 \u5411\u5806\u5185\u5b58\u4e2d\u6dfb\u52a0\u5185\u5b58\u6c60\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] pool_start \u5f85\u6dfb\u52a0\u5185\u5b58\u6c60\u8d77\u59cb\u5730\u5740 [in] pool_size \u5f85\u6dfb\u52a0\u5185\u5b58\u6c60\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u6dfb\u52a0\u6210\u529f\u3002 K_ERR_MMHEAP_INVALID_POOL_ADDR \u5185\u5b58\u6c60\u8d77\u59cb\u5730\u5740\u975e\u6cd5\u3002 K_ERR_MMHEAP_INVALID_POOL_SIZE \u5185\u5b58\u6c60\u5927\u5c0f\u975e\u6cd5\u3002","title":"tos_mmheap_pool_add"},{"location":"05.SDK_Manual/#tos_mmheap_pool_rmv","text":"k_err_t tos_mmheap_pool_rmv(void *pool_start); \u529f\u80fd\u63cf\u8ff0 \u4ece\u5806\u5185\u5b58\u4e2d\u5220\u9664\u5185\u5b58\u6c60\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] pool_start \u5f85\u5220\u9664\u7684\u5185\u5b58\u6c60\u8d77\u59cb\u5730\u5740 \u8fd4\u56de\u503c \u65e0","title":"tos_mmheap_pool_rmv"},{"location":"05.SDK_Manual/#tos_mmheap_alloc","text":"void *tos_mmheap_alloc(size_t size); \u529f\u80fd\u63cf\u8ff0 \u4ece\u5806\u5185\u5b58\u4e2d\u5206\u914d\u4e00\u5757\u5185\u5b58\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] size \u671f\u671b\u5206\u914d\u7684\u5185\u5b58\u5927\u5c0f \u8fd4\u56de\u503c \u5206\u914d\u5230\u7684\u5185\u5b58\u8d77\u59cb\u5730\u5740\uff08\u8fd4\u56deK_NULL\u8868\u793a\u5206\u914d\u5931\u8d25\uff09\u3002","title":"tos_mmheap_alloc"},{"location":"05.SDK_Manual/#tos_mmheap_aligned_alloc","text":"void *tos_mmheap_aligned_alloc(size_t size, size_t align); \u529f\u80fd\u63cf\u8ff0 \u4ece\u5806\u5185\u5b58\u4e2d\u5206\u914d\u4e00\u5757\u5185\u5b58\uff0c\u6b64\u5185\u5b58\u8d77\u59cb\u5730\u5740\u6309align\u53c2\u6570\u5bf9\u9f50\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] size \u671f\u671b\u5206\u914d\u7684\u5185\u5b58\u5927\u5c0f [in] align \u5bf9\u9f50\u53c2\u6570 \u8fd4\u56de\u503c \u5206\u914d\u5230\u7684\u5185\u5b58\u8d77\u59cb\u5730\u5740\uff08\u8fd4\u56deK_NULL\u8868\u793a\u5206\u914d\u5931\u8d25\uff09\u3002","title":"tos_mmheap_aligned_alloc"},{"location":"05.SDK_Manual/#tos_mmheap_realloc","text":"void *tos_mmheap_realloc(void *ptr, size_t size); \u529f\u80fd\u63cf\u8ff0 \u4ece\u5806\u5185\u5b58\u4e2d\u91cd\u65b0\u5206\u914d\u4e00\u5757\u5185\u5b58\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ptr \u539f\u5185\u5b58\u8d77\u59cb\u5730\u5740 [in] size \u671f\u671b\u91cd\u65b0\u5206\u914d\u7684\u5185\u5b58\u5927\u5c0f \u8fd4\u56de\u503c \u5206\u914d\u5230\u7684\u5185\u5b58\u8d77\u59cb\u5730\u5740\uff08\u8fd4\u56deK_NULL\u8868\u793a\u5206\u914d\u5931\u8d25\uff09\u3002","title":"tos_mmheap_realloc"},{"location":"05.SDK_Manual/#tos_mmheap_free","text":"void *tos_mmheap_free(void *ptr); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4e00\u7247\u4ece\u5806\u5185\u5b58\u4e2d\u5206\u914d\u5230\u7684\u5185\u5b58\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ptr \u5f85\u91ca\u653e\u7684\u5185\u5b58\u8d77\u59cb\u5730\u5740 \u8fd4\u56de\u503c \u65e0\u3002","title":"tos_mmheap_free"},{"location":"05.SDK_Manual/#tos_mmheap_pool_check","text":"k_err_t tos_mmheap_pool_check(void *pool_start, k_mmheap_info_t *info); \u529f\u80fd\u63cf\u8ff0 \u83b7\u53d6\u5806\u5185\u5b58\u4e2d\u67d0\u4e2a\u6c60\u7684\u4f7f\u7528\u60c5\u51b5\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] pool_start \u5806\u5185\u5b58\u4e2d\u67d0\u4e2a\u6c60\u7684\u8d77\u59cb\u5730\u5740 [out] info \u8be5\u6c60\u7684\u4f7f\u7528\u60c5\u51b5\uff08\u4f7f\u7528\u91cf\u548c\u5269\u4f59\u91cf\u4fe1\u606f\uff09 \u8fd4\u56de\u503c K_ERR_NONE \u51fd\u6570\u8fd4\u56de\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL pool_start\u6216info\u4e3a\u7a7a\u6307\u9488\u3002","title":"tos_mmheap_pool_check"},{"location":"05.SDK_Manual/#tos_mmheap_check","text":"k_err_t tos_mmheap_check(k_mmheap_info_t *info); \u529f\u80fd\u63cf\u8ff0 \u83b7\u53d6\u5806\u5185\u5b58\u7684\u6574\u4f53\u4f7f\u7528\u60c5\u51b5\uff08\u5305\u542b\u4e86\u6240\u6709\u7684\u6c60\u7684\u4fe1\u606f\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [out] info \u5806\u5185\u5b58\u7684\u6574\u4f53\u4f7f\u7528\u60c5\u51b5\uff08\u4f7f\u7528\u91cf\u548c\u5269\u4f59\u91cf\u4fe1\u606f\uff09 \u8fd4\u56de\u503c K_ERR_NONE \u51fd\u6570\u8fd4\u56de\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL info\u4e3a\u7a7a\u6307\u9488\u3002","title":"tos_mmheap_check"},{"location":"05.SDK_Manual/#_4","text":"","title":"\u5757\u5185\u5b58\u7ba1\u7406"},{"location":"05.SDK_Manual/#tos_mmblk_pool_create","text":"k_err_t tos_mmblk_pool_create(k_mmblk_pool_t *mbp, void *pool_start, size_t blk_num, size_t blk_size); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u5757\u5185\u5b58\u6c60\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mbp \u5f85\u521b\u5efa\u7684\u5757\u5185\u5b58\u53e5\u67c4 [in] pool_start \u5757\u5185\u5b58\u6c60\u8d77\u59cb\u5730\u5740 [in] blk_num \u5185\u5b58\u5757\u6570\u91cf [in] blk_size \u5355\u4e2a\u5185\u5b58\u5757\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u5757\u5185\u5b58\u521b\u5efa\u6210\u529f\u3002 K_ERR_MMBLK_INVALID_POOL_ADDR \u5757\u5185\u5b58\u6c60\u8d77\u59cb\u5730\u5740\u975e\u6cd5\u3002 K_ERR_MMBLK_INVALID_BLK_SIZE \u5757\u5185\u5b58\u5927\u5c0f\u975e\u6cd5\u3002","title":"tos_mmblk_pool_create"},{"location":"05.SDK_Manual/#tos_mmblk_alloc","text":"k_err_t tos_mmblk_alloc(k_mmblk_pool_t *mbp, void **blk); \u529f\u80fd\u63cf\u8ff0 \u4ece\u5185\u5b58\u6c60\u4e2d\u5206\u914d\u4e00\u4e2a\u5185\u5b58\u5757\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mbp \u5757\u5185\u5b58\u53e5\u67c4 [out] blk \u8fd4\u56de\u7684\u5757\u5185\u5b58\u8d77\u59cb\u5730\u5740 \u8fd4\u56de\u503c K_ERR_NONE \u5757\u5185\u5b58\u5206\u914d\u6210\u529f\uff0cblk\u6307\u5411\u5206\u914d\u5230\u7684\u5185\u5b58\u5757\u8d77\u59cb\u5730\u5740\u3002 K_ERR_MMBLK_POOL_EMPTY \u5185\u5b58\u6c60\u662f\u7a7a\u7684\uff0cblk\u4e3aK_NULL\u3002","title":"tos_mmblk_alloc"},{"location":"05.SDK_Manual/#tos_mmblk_free","text":"k_err_t tos_mmblk_free(k_mmblk_pool_t *mbp, void *blk); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4e00\u4e2a\u5185\u5b58\u5757\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mbp \u5757\u5185\u5b58\u53e5\u67c4 [in] blk \u5f85\u91ca\u653e\u7684\u5757\u5185\u5b58\u8d77\u59cb\u5730\u5740 \u8fd4\u56de\u503c K_ERR_NONE \u5757\u5185\u5b58\u91ca\u653e\u6210\u529f\u3002 K_ERR_MMBLK_POOL_FULL \u5185\u5b58\u6c60\u662f\u6ee1\u7684\u3002","title":"tos_mmblk_free"},{"location":"05.SDK_Manual/#mutex","text":"","title":"\u4e92\u65a5\u91cfmutex"},{"location":"05.SDK_Manual/#tos_mutex_create","text":"k_err_t tos_mutex_create(k_mutex_t *mutex); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u4e92\u65a5\u91cf\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mutex \u4e92\u65a5\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4e92\u65a5\u91cf\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL mutex\u4e3a\u7a7a\u6307\u9488\u3002","title":"tos_mutex_create"},{"location":"05.SDK_Manual/#tos_mutex_destroy","text":"k_err_t tos_mutex_destroy(k_mutex_t *mutex); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u4e92\u65a5\u91cf\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mutex \u4e92\u65a5\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4e92\u65a5\u91cf\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL mutex\u4e3a\u7a7a\u6307\u9488\u3002 K_ERR_OBJ_INVALID mutex\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4e92\u65a5\u91cf\u3002","title":"tos_mutex_destroy"},{"location":"05.SDK_Manual/#tos_mutex_pend","text":"k_err_t tos_mutex_pend(k_mutex_t *mutex); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u83b7\u53d6\u4e00\u4e2a\u4e92\u65a5\u91cf\uff08\u6c38\u4e45\u963b\u585e\u5f0f\u7b49\u5f85\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mutex \u4e92\u65a5\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u83b7\u53d6\u4e92\u65a5\u91cf\u6210\u529f\u3002 K_ERR_MUTEX_NESTING_OVERFLOW \u4e92\u65a5\u91cf\u62e5\u6709\u8005\u5d4c\u5957\u83b7\u53d6\u6ea2\u51fa\u3002 K_ERR_MUTEX_NESTING \u4e92\u65a5\u91cf\u62e5\u6709\u8005\u5d4c\u5957\u83b7\u53d6\u3002 K_ERR_PEND_SCHED_LOCKED \u6b64\u4e92\u65a5\u91cf\u88ab\u5176\u4ed6\u4efb\u52a1\u6301\u6709\uff0c\u4e14\u7cfb\u7edf\u8c03\u5ea6\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5f53\u524d\u4efb\u52a1\u8bd5\u56fe\u83b7\u53d6\u7684\u4e92\u65a5\u91cf\u88ab\u9500\u6bc1\uff08tos_mutex_destroy\uff09\u4e86\u3002","title":"tos_mutex_pend"},{"location":"05.SDK_Manual/#tos_mutex_pend_timed","text":"k_err_t tos_mutex_pend(k_mutex_t *mutex, k_tick_t timeout); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u83b7\u53d6\u4e00\u4e2a\u4e92\u65a5\u91cf\uff08\u6709\u9650\u65f6\u95f4\u5185\u7684\u963b\u585e\u7b49\u5f85\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mutex \u4e92\u65a5\u91cf\u53e5\u67c4 [in] timeout \u7b49\u5f85\u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u83b7\u53d6\u4e92\u65a5\u91cf\u6210\u529f\u3002 K_ERR_MUTEX_NESTING_OVERFLOW \u4e92\u65a5\u91cf\u62e5\u6709\u8005\u5d4c\u5957\u83b7\u53d6\u6ea2\u51fa\u3002 K_ERR_MUTEX_NESTING \u4e92\u65a5\u91cf\u62e5\u6709\u8005\u5d4c\u5957\u83b7\u53d6\u3002 K_ERR_PEND_NOWAIT \u6b64\u4e92\u65a5\u91cf\u88ab\u5176\u4ed6\u4efb\u52a1\u6301\u6709\uff0c\u540c\u65f6timeout\u53c2\u6570\u4e3aTOS_TIME_NOWAIT\uff08\u8868\u793a\u83b7\u53d6\u4e0d\u5230\u4e92\u65a5\u91cf\u65f6\u7acb\u5373\u8fd4\u56de\uff09 K_ERR_PEND_SCHED_LOCKED \u6b64\u4e92\u65a5\u91cf\u88ab\u5176\u4ed6\u4efb\u52a1\u6301\u6709\uff08\u83b7\u53d6\u5931\u8d25\uff09\uff0c\u4e14\u7cfb\u7edf\u8c03\u5ea6\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_TIMEOUT \u5728timeout\u65f6\u95f4\u8303\u56f4\u5185\u672a\u83b7\u53d6\u5230\u4e92\u65a5\u91cf\u3002 K_ERR_PEND_DESTROY \u5f53\u524d\u4efb\u52a1\u8bd5\u56fe\u83b7\u53d6\u7684\u4e92\u65a5\u91cf\u88ab\u9500\u6bc1\uff08tos_mutex_destroy\uff09\u4e86\u3002","title":"tos_mutex_pend_timed"},{"location":"05.SDK_Manual/#tos_mutex_post","text":"k_err_t tos_mutex_post(k_mutex_t *mutex); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4e92\u65a5\u91cf\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mutex \u4e92\u65a5\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4e92\u65a5\u91cf\u91ca\u653e\u6210\u529f\u3002 K_ERR_MUTEX_NOT_OWNER \u5f53\u524d\u4efb\u52a1\u5e76\u975e\u6b64\u4e92\u65a5\u91cf\u7684\u62e5\u6709\u8005\u3002 K_ERR_MUTEX_NESTING_OVERFLOW \u4e92\u65a5\u91cf\u62e5\u6709\u8005\u5d4c\u5957\u91ca\u653e\u6ea2\u51fa\u3002 K_ERR_MUTEX_NESTING \u4e92\u65a5\u91cf\u62e5\u6709\u8005\u5d4c\u5957\u91ca\u653e\u3002","title":"tos_mutex_post"},{"location":"05.SDK_Manual/#semaphore","text":"","title":"\u4fe1\u53f7\u91cfsemaphore"},{"location":"05.SDK_Manual/#tos_sem_create","text":"k_err_t tos_sem_create(k_sem_t *sem, k_sem_cnt_t init_count); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u4fe1\u53f7\u91cf\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sem \u4fe1\u53f7\u91cf\u53e5\u67c4 [in] init_count \u4fe1\u53f7\u91cf\u521d\u59cb\u91cf \u8fd4\u56de\u503c K_ERR_NONE \u4fe1\u53f7\u91cf\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL sem\u6307\u9488\u4e3a\u7a7a\u3002","title":"tos_sem_create"},{"location":"05.SDK_Manual/#tos_sem_create_max","text":"k_err_t tos_sem_create_max(k_sem_t *sem, k_sem_cnt_t init_count, k_sem_cnt_t max_count); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u4fe1\u53f7\u91cf\u5e76\u6307\u5b9a\u4fe1\u53f7\u91cf\u7684\u6700\u5927\u503c\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sem \u4fe1\u53f7\u91cf\u53e5\u67c4 [in] init_count \u4fe1\u53f7\u91cf\u521d\u59cb\u91cf [in] max_count \u4fe1\u53f7\u91cf\u7684\u6700\u5927\u503c \u8fd4\u56de\u503c K_ERR_NONE \u4fe1\u53f7\u91cf\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL sem\u6307\u9488\u4e3a\u7a7a\u3002","title":"tos_sem_create_max"},{"location":"05.SDK_Manual/#tos_sem_destroy","text":"k_err_t tos_sem_destroy(k_sem_t *sem); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u4fe1\u53f7\u91cf\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sem \u4fe1\u53f7\u91cf\u6570\u636e\u7ed3\u6784\u6307\u9488 \u8fd4\u56de\u503c K_ERR_NONE \u4fe1\u53f7\u91cf\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_INVALID sem\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4fe1\u53f7\u91cf\u3002 K_ERR_OBJ_PTR_NULL sem\u6307\u9488\u4e3a\u7a7a\u3002","title":"tos_sem_destroy"},{"location":"05.SDK_Manual/#tos_sem_pend","text":"k_err_t tos_sem_pend(k_sem_t *sem, k_tick_t timeout); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u83b7\u53d6\u4e00\u4e2a\u4fe1\u53f7\u91cf\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sem \u4fe1\u53f7\u91cf\u53e5\u67c4 [in] timeout \u7b49\u5f85\u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u83b7\u53d6\u4fe1\u53f7\u91cf\u6210\u529f\u3002 K_ERR_PEND_NOWAIT \u83b7\u53d6\u4fe1\u53f7\u91cf\u5931\u8d25\uff08\u4fe1\u53f7\u91cf\u8d44\u6e90\u4e0d\u8db3\uff09\uff0c\u540c\u65f6timeout\u53c2\u6570\u4e3aTOS_TIME_NOWAIT\uff08\u8868\u793a\u83b7\u53d6\u4e0d\u5230\u4fe1\u53f7\u91cf\u65f6\u7acb\u5373\u8fd4\u56de\uff09 K_ERR_PEND_SCHED_LOCKED \u83b7\u53d6\u4fe1\u53f7\u91cf\u5931\u8d25\uff0c\u540c\u65f6\u7cfb\u7edf\u8c03\u5ea6\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_TIMEOUT \u5728timeout\u8d85\u65f6\u8303\u56f4\u5185\u672a\u83b7\u53d6\u5230\u4fe1\u53f7\u91cf\u3002 K_ERR_PEND_DESTROY \u8bd5\u56fe\u83b7\u53d6\u7684\u4fe1\u53f7\u91cf\u88ab\u9500\u6bc1\u4e86\uff08tos_sem_destroy\uff09","title":"tos_sem_pend"},{"location":"05.SDK_Manual/#tos_sem_post","text":"k_err_t tos_sem_post(k_sem_t *sem); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4fe1\u53f7\u91cf\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u4e00\u4e2a\u4efb\u52a1\u3002\u5982\u679c\u6709\u591a\u4e2a\u4efb\u52a1\u5728\u6b64\u4fe1\u53f7\u91cf\u7684\u7b49\u5f85\u961f\u5217\u4e0a\uff0c\u5524\u9192\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sem \u4fe1\u53f7\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4fe1\u53f7\u91cf\u91ca\u653e\u6210\u529f\u3002 K_ERR_SEM_OVERFLOW \u4fe1\u53f7\u91cf\u503c\u6ea2\u51fa\u3002","title":"tos_sem_post"},{"location":"05.SDK_Manual/#tos_sem_post_all","text":"k_err_t tos_sem_post_all(k_sem_t *sem); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4fe1\u53f7\u91cf\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u6240\u6709\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sem \u4fe1\u53f7\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4fe1\u53f7\u91cf\u91ca\u653e\u6210\u529f\u3002 K_ERR_SEM_OVERFLOW \u4fe1\u53f7\u91cf\u503c\u6ea2\u51fa\u3002","title":"tos_sem_post_all"},{"location":"05.SDK_Manual/#event","text":"","title":"\u4e8b\u4ef6event"},{"location":"05.SDK_Manual/#tos_event_create","text":"k_err_t tos_event_create(k_event_t *event, k_event_flag_t init_flag); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u4e8b\u4ef6\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] event \u4e8b\u4ef6\u53e5\u67c4 [in] init_flag \u4e8b\u4ef6\u521d\u59cb\u65d7\u6807 \u8fd4\u56de\u503c K_ERR_NONE \u4e8b\u4ef6\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL event\u6307\u9488\u4e3a\u7a7a\u3002","title":"tos_event_create"},{"location":"05.SDK_Manual/#tos_event_destroy","text":"k_err_t tos_event_destroy(k_event_t *event); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u4e8b\u4ef6\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] event \u4e8b\u4ef6\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4e8b\u4ef6\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL event\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID event\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4e8b\u4ef6\u3002","title":"tos_event_destroy"},{"location":"05.SDK_Manual/#tos_event_pend","text":"k_err_t tos_event_pend(k_event_t *event, k_event_flag_t flag_expect, k_event_flag_t *flag_match, k_tick_t timeout, k_opt_t opt); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u83b7\u53d6\u4e00\u4e2a\u7279\u5b9a\u7684\u4e8b\u4ef6\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] event \u4e8b\u4ef6\u53e5\u67c4 [in] flag_expect \u671f\u671b\u83b7\u53d6\u5230\u7684\u4e8b\u4ef6\u65d7\u6807 [out] flag_match \u5b9e\u9645\u83b7\u53d6\u5230\u7684\u4e8b\u4ef6\u65d7\u6807 [in] timeout \u7b49\u5f85\u8d85\u65f6\u53c2\u6570 [in] opt \u9009\u9879 \u6ce8\u610f opt\u9009\u9879\u8bf4\u660e\uff1a 1\u3001TOS_OPT_EVENT_PEND_ANY \u200b \u5c1d\u8bd5\u4ece\u4e8b\u4ef6\u4e2d\u83b7\u53d6\u4e00\u7ec4\u65d7\u6807\uff0c\u5e76\u4e14\u8fd9\u4e00\u7ec4\u65d7\u6807\u5305\u542bflag_expect\u4e2d\u6807\u8bc6\u7684\u4efb\u610f\u4e00\u4e2a\u65d7\u6807\uff0c\u5982\u679c\u5728\u6b64\u573a\u666f\u4e0b\u89c6\u4f5cevent\u83b7\u53d6\u6210\u529f\uff0c\u5219opt\u4f20\u9012\u6b64\u53c2\u6570\u3002 \u200b \u4e3e\u4f8b\u6765\u8bf4\uff0c\u5982\u679c\u4f20\u5165\u7684flag_expect\u4e3a0x9\uff080x8 | 0x1\uff09\uff0c\u4e14opt\u4e3aTOS_OPT_EVENT_PEND_ANY\uff0c\u5219event\u5305\u542b\u7684\u65d7\u6807\u5305\u542b0x8\u6216\u80050x1\u5373\u89c6\u4e3a\u4e8b\u4ef6\u83b7\u53d6\u6210\u529f\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0cevent\u5305\u542b\u7684\u65d7\u6807\u4e3a(0x8 | X, X\u4e3a\u6574\u6570\uff0c\u4e14X\u2208(0, 0xFFFFFFFF])\uff0c\u6216\u8005(0x1 | X, X\u4e3a\u6574\u6570\uff0c\u4e14X\u2208(0, 0xFFFFFFFF])\u3002 2\u3001TOS_OPT_EVENT_PEND_ALL \u200b \u5c1d\u8bd5\u4ece\u4e8b\u4ef6\u4e2d\u83b7\u53d6\u4e00\u7ec4\u65d7\u6807\uff0c\u5e76\u4e14\u8fd9\u4e00\u7ec4\u65d7\u6807\u5fc5\u987b\u81f3\u5c11\u5305\u542bflag_expect\u4e2d\u6807\u8bc6\u7684\u6240\u6709\u65d7\u6807\uff0c\u5982\u679c\u53ea\u5728\u6b64\u79cd\u573a\u666f\u4e0b\u89c6\u4f5cevent\u83b7\u53d6\u6210\u529f\uff0c\u5219opt\u4f20\u9012\u6b64\u53c2\u6570\u3002 \u200b \u4e3e\u4f8b\u6765\u8bf4\uff0c\u5982\u679c\u4f20\u5165\u7684flag_expect\u4e3a0x9\uff080x8 | 0x1\uff09\uff0c\u4e14opt\u4e3aTOS_OPT_EVENT_PEND_ALL\uff0c\u5219event\u5305\u542b\u7684\u65d7\u6807\u81f3\u5c11\u4e3a0x9\u7684\u6700\u5c0f\u5168\u96c6\u624d\u89c6\u4e3a\u4e8b\u4ef6\u83b7\u53d6\u6210\u529f\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0cevent\u5305\u542b\u7684\u65d7\u6807\u5e94\u4e3a(0x9 | X, X\u4e3a\u6574\u6570\uff0c\u4e14X\u2208(0, 0xFFFFFFFF])\u3002 3\u3001TOS_OPT_EVENT_PEND_CLR \u200b \u5982\u679c\u5e0c\u671b\u8bfb\u53d6\u5b8c\u4e8b\u4ef6\u540e\uff0c\u76f4\u63a5\u590d\u4f4d\u6e05\u7a7aevent\u7684\u6240\u6709\u65d7\u6807\uff0c\u5219opt\u4f20\u9012\u6b64\u53c2\u6570\u3002 \u200b \u4e3e\u4f8b\u6765\u8bf4\uff0c\u539fevent\u5305\u542b\u65d7\u6807\u4e3a0x9\uff0c\u5728\u4f20\u9012TOS_OPT_EVENT_PEND_CLR\u53c2\u6570\u5e76\u6210\u529f\u83b7\u53d6event\u4e2d\u7684\u65d7\u6807\u540e\uff0cevent\u5305\u542b\u7684\u65d7\u6807\u4f1a\u590d\u4f4d\u4e3a0x0\u3002 \u200b \u5982\u679c\u5e0c\u671b\u4e00\u6b21\u4f20\u5165\u591a\u4e2a\u9009\u9879\uff0c\u53ef\u4ee5\u7528\u903b\u8f91\u201c\u6216\u201d\u5c06\u591a\u4e2a\u53c2\u6570\u8fde\u63a5\u4f20\u5165\uff0c\u8b6c\u5982\u540c\u65f6\u5e0c\u671b\u91c7\u7528TOS_OPT_EVENT_PEND_ANY \u8bed\u4e49\u53caTOS_OPT_EVENT_PEND_CLR\uff0c\u53ef\u4ee5\u4f20\u5165\uff08TOS_OPT_EVENT_PEND_ANY | TOS_OPT_EVENT_PEND_CLR\uff09\u3002 \u200b \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4e0d\u53ef\u4ee5\u540c\u65f6\u4f20\u5165TOS_OPT_EVENT_PEND_ANY\u4e0eTOS_OPT_EVENT_PEND_ALL\u3002 \u8fd4\u56de\u503c K_ERR_NONE \u8bfb\u53d6\u7279\u5b9a\u7684\u4e8b\u4ef6\u6210\u529f\u3002 K_ERR_EVENT_PEND_OPT_INVALID opt\u53c2\u6570\u975e\u6cd5\u3002 K_ERR_PEND_NOWAIT \u672a\u80fd\u4eceevent\u4e2d\u83b7\u53d6\u5230\u671f\u671b\u7684\u65d7\u6807\uff0c\u5e76\u4e14timeout\u53c2\u6570\u4e3aTOS_TIME_NOWAIT\uff08\u8868\u793a\u672a\u83b7\u53d6\u5230\u671f\u671b\u65d7\u6807\u65f6\u7acb\u5373\u8fd4\u56de\uff09\u3002 K_ERR_PEND_SCHED_LOCKED \u672a\u80fd\u4eceevent\u4e2d\u83b7\u53d6\u5230\u671f\u671b\u7684\u65d7\u6807\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u5904\u4e8e\u9501\u5b9a\u7684\u72b6\u6001\u3002 K_ERR_PEND_TIMEOUT \u5728\u8d85\u65f6\u8303\u56f4\u5185\u672a\u80fd\u4eceevent\u4e2d\u83b7\u53d6\u5230\u671f\u671b\u7684\u65d7\u6807\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u83b7\u53d6\u65d7\u6807\u7684\u4e8b\u4ef6\u88ab\u9500\u6bc1\u4e86\uff08tos_event_destroy\uff09\u3002","title":"tos_event_pend"},{"location":"05.SDK_Manual/#tos_event_post","text":"k_err_t tos_event_post(k_event_t *event, k_event_flag_t flag); \u529f\u80fd\u63cf\u8ff0 \u5411\u4e8b\u4ef6\u4e2d\u653e\u7f6e\u4e00\u7ec4\u65d7\u6807 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] event \u4e8b\u4ef6\u53e5\u67c4 [in] flag \u8981\u653e\u7f6e\u7684\u65d7\u6807 \u6ce8\u610f \u8c03\u7528\u6b64\u63a5\u53e3\u653e\u7f6e\u4e00\u7ec4\u65d7\u6807\u65f6\uff0c\u539fevent\u4e2d\u5305\u542b\u7684\u65d7\u6807\u5c06\u88ab\u8986\u76d6\u3002 \u4e3e\u4f8b\u6765\u8bf4\uff0c\u5982\u679c\u539f\u4e8b\u4ef6\u7684\u65d7\u6807\u4e3a0x1\uff0c\u5e76\u4e14\u8981\u653e\u7f6e\u7684\u65d7\u6807\u4e3a0x8\uff0c\u6b64\u63a5\u53e3\u8c03\u7528\u7ed3\u675f\u540e\uff0c\u4e8b\u4ef6\u7684\u65d7\u6807\u5c06\u88ab\u8986\u5199\u4e3a0x8\u3002 \u8fd4\u56de\u503c K_ERR_NONE \u65d7\u6807\u653e\u7f6e\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL event\u4e3a\u7a7a\u6307\u9488\u3002 K_ERR_OBJ_INVALID event\u6307\u5411\u7684\u5e76\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4e8b\u4ef6\u3002","title":"tos_event_post"},{"location":"05.SDK_Manual/#tos_event_post_keep","text":"k_err_t tos_event_post_keep(k_event_t *event, k_event_flag_t flag); \u529f\u80fd\u63cf\u8ff0 \u5411\u4e8b\u4ef6\u4e2d\u653e\u7f6e\u4e00\u7ec4\u65d7\u6807\uff0c\u539fevent\u4e2d\u5305\u542b\u7684\u65d7\u6807\u5c06\u88ab\u4fdd\u7559\u3002 \u4e3e\u4f8b\u6765\u8bf4\uff0c\u5982\u679c\u539f\u4e8b\u4ef6\u7684\u65d7\u6807\u4e3a0x1\uff0c\u5e76\u4e14\u8981\u653e\u7f6e\u7684\u65d7\u6807\u4e3a0x8\uff0c\u6b64\u63a5\u53e3\u8c03\u7528\u7ed3\u675f\u540e\uff0c\u4e8b\u4ef6\u7684\u65d7\u6807\u5c06\u88ab\u4fee\u6539\u4e3a0x9(0x8 | 0x1)\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u539f\u4e8b\u4ef6\u7684\u5305\u542b\u7684\u65d7\u6807\u88ab\u4fdd\u7559\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] event \u4e8b\u4ef6\u53e5\u67c4 [in] flag \u8981\u653e\u7f6e\u7684\u65d7\u6807 \u8fd4\u56de\u503c K_ERR_NONE \u65d7\u6807\u653e\u7f6e\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL event\u4e3a\u7a7a\u6307\u9488\u3002 K_ERR_OBJ_INVALID event\u6307\u5411\u7684\u5e76\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4e8b\u4ef6\u3002","title":"tos_event_post_keep"},{"location":"05.SDK_Manual/#completion","text":"","title":"\u5b8c\u6210\u91cfcompletion"},{"location":"05.SDK_Manual/#tos_completion_create","text":"k_err_t tos_completion_create(k_completion_t *completion); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u5b8c\u6210\u91cf\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] completion \u5b8c\u6210\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u5b8c\u6210\u91cf\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL completion\u6307\u9488\u4e3a\u7a7a\u3002","title":"tos_completion_create"},{"location":"05.SDK_Manual/#tos_completion_destroy","text":"k_err_t tos_completion_destroy(k_completion_t *completion); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u5b8c\u6210\u91cf\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] completion \u5b8c\u6210\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u5b8c\u6210\u91cf\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL completion\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID completion\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u5b8c\u6210\u91cf\u3002","title":"tos_completion_destroy"},{"location":"05.SDK_Manual/#tos_completion_pend","text":"k_err_t tos_completion_pend(k_completion_t *completion); \u529f\u80fd\u63cf\u8ff0 \u7b49\u5f85\u5b8c\u6210\u91cf\u5b8c\u6210\uff08\u6c38\u4e45\u963b\u585e\u7b49\u5f85\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] completion \u5b8c\u6210\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u5b8c\u6210\u91cf\u5df2\u5b8c\u6210\u3002 K_ERR_PEND_SCHED_LOCKED \u5b8c\u6210\u91cf\u6ca1\u6709\u5b8c\u6210\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u5b8c\u6210\u91cf\u88ab\u5220\u9664\u4e86\u3002","title":"tos_completion_pend"},{"location":"05.SDK_Manual/#tos_completion_pend_timed","text":"k_err_t tos_completion_pend_timed(k_completion_t *completion, k_tick_t timeout); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u7b49\u5f85\u5b8c\u6210\u91cf\u5b8c\u6210\uff08\u6709\u9650\u65f6\u95f4\u5185\u7684\u963b\u585e\u7b49\u5f85\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] completion \u5b8c\u6210\u91cf\u53e5\u67c4 [in] timeout \u7b49\u5f85\u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u5b8c\u6210\u91cf\u5df2\u5b8c\u6210\u3002 K_ERR_PEND_NOWAIT \u6b64\u5b8c\u6210\u91cf\u5c1a\u672a\u5b8c\u6210\uff0c\u540c\u65f6timeout\u53c2\u6570\u4e3aTOS_TIME_NOWAIT\uff08\u8868\u793a\u5b8c\u6210\u91cf\u672a\u5b8c\u6210\u65f6\u7acb\u5373\u8fd4\u56de\uff09 K_ERR_PEND_SCHED_LOCKED \u5b8c\u6210\u91cf\u6ca1\u6709\u5b8c\u6210\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u5b8c\u6210\u91cf\u88ab\u5220\u9664\u4e86\u3002 K_ERR_PEND_TIMEOUT \u5728timeout\u65f6\u95f4\u8303\u56f4\u5185\u5b8c\u6210\u91cf\u672a\u5b8c\u6210\u3002","title":"tos_completion_pend_timed"},{"location":"05.SDK_Manual/#tos_completion_post","text":"k_err_t tos_completion_post(k_completion_t *completion); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u5b8c\u6210\u91cf\uff08\u6b64\u5b8c\u6210\u91cf\u72b6\u6001\u53d8\u4e3a\u5df2\u5b8c\u6210\uff09\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u4e00\u4e2a\u4efb\u52a1\u3002\u5982\u679c\u6709\u591a\u4e2a\u4efb\u52a1\u5728\u6b64\u5b8c\u6210\u91cf\u7684\u7b49\u5f85\u961f\u5217\u4e0a\uff0c\u5524\u9192\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] completion \u5b8c\u6210\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u5b8c\u6210\u91cf\u91ca\u653e\u6210\u529f\u3002","title":"tos_completion_post"},{"location":"05.SDK_Manual/#tos_completion_post_all","text":"k_err_t tos_completion_post_all(k_completion_t *completion); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u5b8c\u6210\u91cf\uff08\u6b64\u5b8c\u6210\u91cf\u72b6\u6001\u53d8\u4e3a\u5df2\u5b8c\u6210\uff09\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u6240\u6709\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] completion \u5b8c\u6210\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u5b8c\u6210\u91cf\u91ca\u653e\u6210\u529f\u3002","title":"tos_completion_post_all"},{"location":"05.SDK_Manual/#tos_completion_reset","text":"k_err_t tos_completion_reset(k_completion_t *completion); \u529f\u80fd\u63cf\u8ff0 \u590d\u4f4d\u5b8c\u6210\u91cf\uff08\u5c06\u6b64\u5b8c\u6210\u91cf\u72b6\u6001\u66f4\u6539\u4e3a\u672a\u5b8c\u6210\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] completion \u5b8c\u6210\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u5b8c\u6210\u91cf\u590d\u4f4d\u6210\u529f\u3002","title":"tos_completion_reset"},{"location":"05.SDK_Manual/#tos_completion_is_done","text":"k_err_t tos_completion_is_done(k_completion_t *completion); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u6b64\u5b8c\u6210\u91cf\u662f\u5426\u5df2\u5b8c\u6210\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] completion \u5b8c\u6210\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_TRUE \u5b8c\u6210\u91cf\u5df2\u5b8c\u6210\u3002 K_FALSE \u5b8c\u6210\u91cf\u672a\u5b8c\u6210\u3002","title":"tos_completion_is_done"},{"location":"05.SDK_Manual/#countdown-latch","text":"","title":"\u8ba1\u6570\u9501countdown latch"},{"location":"05.SDK_Manual/#tos_countdownlatch_create","text":"k_err_t tos_countdownlatch_create(k_countdownlatch_t *countdownlatch, k_countdownlatch_cnt_t count); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u8ba1\u6570\u9501\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] countdownlatch \u8ba1\u6570\u9501\u53e5\u67c4 [in] count \u671f\u671b\u7b49\u5f85\u7684\u8ba1\u6570\u503c \u8fd4\u56de\u503c K_ERR_NONE \u8ba1\u6570\u9501\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL countdownlatch\u6307\u9488\u4e3a\u7a7a\u3002","title":"tos_countdownlatch_create"},{"location":"05.SDK_Manual/#tos_countdownlatch_destroy","text":"k_err_t tos_countdownlatch_destroy(k_countdownlatch_t *countdownlatch); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u8ba1\u6570\u9501\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] countdownlatch \u8ba1\u6570\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u8ba1\u6570\u9501\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL countdownlatch\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID countdownlatch\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u8ba1\u6570\u9501\u3002","title":"tos_countdownlatch_destroy"},{"location":"05.SDK_Manual/#tos_countdownlatch_pend","text":"k_err_t tos_countdownlatch_pend(k_countdownlatch_t *countdownlatch); \u529f\u80fd\u63cf\u8ff0 \u7b49\u5f85\u8ba1\u6570\u9501\u5b8c\u6210\uff08\u6c38\u4e45\u963b\u585e\u7b49\u5f85\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] countdownlatch \u8ba1\u6570\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u8ba1\u6570\u9501\u5df2\u5b8c\u6210\u3002 K_ERR_PEND_SCHED_LOCKED \u8ba1\u6570\u9501\u6ca1\u6709\u5b8c\u6210\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u8ba1\u6570\u9501\u88ab\u5220\u9664\u4e86\u3002","title":"tos_countdownlatch_pend"},{"location":"05.SDK_Manual/#tos_countdownlatch_pend_timed","text":"k_err_t tos_countdownlatch_pend_timed(k_countdownlatch_t *countdownlatch, k_tick_t timeout); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u7b49\u5f85\u8ba1\u6570\u9501\u5b8c\u6210\uff08\u6709\u9650\u65f6\u95f4\u5185\u7684\u963b\u585e\u7b49\u5f85\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] countdownlatch \u8ba1\u6570\u9501\u53e5\u67c4 [in] timeout \u7b49\u5f85\u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u8ba1\u6570\u9501\u5df2\u5b8c\u6210\u3002 K_ERR_PEND_NOWAIT \u6b64\u8ba1\u6570\u9501\u5c1a\u672a\u5b8c\u6210\uff0c\u540c\u65f6timeout\u53c2\u6570\u4e3aTOS_TIME_NOWAIT\uff08\u8868\u793a\u8ba1\u6570\u9501\u672a\u5b8c\u6210\u65f6\u7acb\u5373\u8fd4\u56de\uff09 K_ERR_PEND_SCHED_LOCKED \u8ba1\u6570\u9501\u6ca1\u6709\u5b8c\u6210\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u8ba1\u6570\u9501\u88ab\u5220\u9664\u4e86\u3002 K_ERR_PEND_TIMEOUT \u5728timeout\u65f6\u95f4\u8303\u56f4\u5185\u8ba1\u6570\u9501\u672a\u5b8c\u6210\u3002","title":"tos_countdownlatch_pend_timed"},{"location":"05.SDK_Manual/#tos_countdownlatch_post","text":"k_err_t tos_countdownlatch_post(k_countdownlatch_t *countdownlatch); \u529f\u80fd\u63cf\u8ff0 \u8ba1\u6570\u9501\uff08\u6b64\u8ba1\u6570\u9501\u7684\u8ba1\u6570\u503c\u51cf\u4e00\uff09\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u4e00\u4e2a\u4efb\u52a1\u3002\u5982\u679c\u6709\u591a\u4e2a\u4efb\u52a1\u5728\u6b64\u8ba1\u6570\u9501\u7684\u7b49\u5f85\u961f\u5217\u4e0a\uff0c\u5524\u9192\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] countdownlatch \u8ba1\u6570\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u8ba1\u6570\u9501\u91ca\u653e\u6210\u529f\u3002","title":"tos_countdownlatch_post"},{"location":"05.SDK_Manual/#tos_countdownlatch_reset","text":"k_err_t tos_countdownlatch_reset(k_countdownlatch_t *countdownlatch, k_countdownlatch_cnt_t count); \u529f\u80fd\u63cf\u8ff0 \u590d\u4f4d\u8ba1\u6570\u9501\uff08\u5c06\u6b64\u8ba1\u6570\u9501\u7684\u8ba1\u6570\u503c\u590d\u4f4d\u4e3a\u65b0\u7684\u671f\u671b\u503c\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] countdownlatch \u8ba1\u6570\u9501\u53e5\u67c4 [in] count \u671f\u671b\u590d\u4f4d\u7684\u65b0\u7684\u8ba1\u6570\u503c \u8fd4\u56de\u503c K_ERR_NONE \u8ba1\u6570\u9501\u590d\u4f4d\u6210\u529f\u3002","title":"tos_countdownlatch_reset"},{"location":"05.SDK_Manual/#barrier","text":"","title":"\u6805\u680fbarrier"},{"location":"05.SDK_Manual/#tos_barrier_create","text":"k_err_t tos_barrier_create(k_barrier_t *barrier, k_barrier_cnt_t count); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u6805\u680f\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] barrier \u6805\u680f\u53e5\u67c4 [in] count \u671f\u671b\u7b49\u5f85\u7684\u8ba1\u6570\u503c \u8fd4\u56de\u503c K_ERR_NONE \u6805\u680f\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL barrier\u6307\u9488\u4e3a\u7a7a\u3002","title":"tos_barrier_create"},{"location":"05.SDK_Manual/#tos_barrier_destroy","text":"k_err_t tos_barrier_destroy(k_barrier_t *barrier); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u6805\u680f\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] barrier \u6805\u680f\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6805\u680f\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL barrier\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID barrier\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u6805\u680f\u3002","title":"tos_barrier_destroy"},{"location":"05.SDK_Manual/#tos_barrier_pend","text":"k_err_t tos_barrier_pend(k_barrier_t *barrier); \u529f\u80fd\u63cf\u8ff0 \u7b49\u5f85\u6805\u680f\u5168\u90e8\u89e3\u9664\uff08\u6c38\u4e45\u963b\u585e\u7b49\u5f85\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] barrier \u6805\u680f\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6805\u680f\u5df2\u5b8c\u6210\u3002 K_ERR_PEND_SCHED_LOCKED \u6805\u680f\u6ca1\u6709\u5b8c\u6210\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u6805\u680f\u88ab\u5220\u9664\u4e86\u3002 K_ERR_BARRIER_OVERFLOW \u6805\u680f\u7684pend\u6b21\u6570\u8d85\u8fc7\u4e86\u521d\u59cb\u7684count\u6570\u91cf\u3002","title":"tos_barrier_pend"},{"location":"05.SDK_Manual/#tos_barrier_reset","text":"k_err_t tos_barrier_reset(k_barrier_t *barrier, k_barrier_cnt_t count); \u529f\u80fd\u63cf\u8ff0 \u590d\u4f4d\u6805\u680f\uff08\u5c06\u6805\u680f\u7684count\u8ba1\u6570\u590d\u4f4d\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] barrier \u6805\u680f\u53e5\u67c4 [in] count \u590d\u4f4d\u7684\u8ba1\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u6805\u680f\u590d\u4f4d\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL barrier\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID barrier\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u6805\u680f\u3002","title":"tos_barrier_reset"},{"location":"05.SDK_Manual/#rwlock","text":"","title":"\u8bfb\u5199\u9501rwlock"},{"location":"05.SDK_Manual/#tos_rwlock_create","text":"k_err_t tos_rwlock_create(k_rwlock_t *rwlock); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u8bfb\u5199\u9501\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u8bfb\u5199\u9501\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL rwlock\u6307\u9488\u4e3a\u7a7a\u3002","title":"tos_rwlock_create"},{"location":"05.SDK_Manual/#tos_rwlock_destroy","text":"k_err_t tos_rwlock_destroy(k_rwlock_t *rwlock); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u6805\u680f\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u8bfb\u5199\u9501\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL rwlock\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID rwlock\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u8bfb\u5199\u9501\u3002","title":"tos_rwlock_destroy"},{"location":"05.SDK_Manual/#tos_rwlock_rpend_timed","text":"k_err_t tos_rwlock_rpend_timed(k_rwlock_t *rwlock, k_tick_t timeout); \u529f\u80fd\u63cf\u8ff0 \u6709\u9650\u7684\u65f6\u95f4\u5185\u5c1d\u8bd5\u83b7\u53d6\u8bfb\u9501\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 [in] timeout \u8d85\u65f6\u65f6\u9650 \u8fd4\u56de\u503c K_ERR_NONE \u6210\u529f\u83b7\u53d6\u8bfb\u9501\u3002 K_ERR_PEND_SCHED_LOCKED \u672a\u6210\u529f\u83b7\u53d6\u5230\u8bfb\u9501\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u8bfb\u9501\u88ab\u5220\u9664\u4e86\u3002 K_ERR_PEND_TIMEOUT \u672a\u5728\u8d85\u65f6\u65f6\u9650\u5185\u6210\u529f\u83b7\u53d6\u5230\u8bfb\u9501\u3002 K_ERR_RWLOCK_READERS_TO_MANY \u5df2\u83b7\u53d6\u8bfb\u9501\u7684\u8bfb\u8005\u8fc7\u591a\u3002","title":"tos_rwlock_rpend_timed"},{"location":"05.SDK_Manual/#tos_rwlock_rpend","text":"k_err_t tos_rwlock_rpend(k_rwlock_t *rwlock); \u529f\u80fd\u63cf\u8ff0 \u6c38\u4e45\u6027\u963b\u585e\u5c1d\u8bd5\u83b7\u53d6\u8bfb\u9501\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6210\u529f\u83b7\u53d6\u8bfb\u9501\u3002 K_ERR_PEND_SCHED_LOCKED \u5728\u8d85\u65f6\u65f6\u9650\u5185\u672a\u6210\u529f\u83b7\u53d6\u5230\u8bfb\u9501\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u8bfb\u9501\u88ab\u5220\u9664\u4e86\u3002 K_ERR_RWLOCK_READERS_TO_MANY \u5df2\u83b7\u53d6\u8bfb\u9501\u7684\u8bfb\u8005\u8fc7\u591a\u3002","title":"tos_rwlock_rpend"},{"location":"05.SDK_Manual/#tos_rwlock_rpend_try","text":"k_err_t tos_rwlock_rpend_try(k_rwlock_t *rwlock); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u83b7\u53d6\u8bfb\u9501\uff0c\u4e14\u5e76\u4e0d\u963b\u585e\u7b49\u5f85\uff0c\u7acb\u5373\u8fd4\u56de\u9519\u8bef\u7801\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6210\u529f\u83b7\u53d6\u8bfb\u9501\u3002 K_ERR_PEND_SCHED_LOCKED \u5728\u8d85\u65f6\u65f6\u9650\u5185\u672a\u6210\u529f\u83b7\u53d6\u5230\u8bfb\u9501\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u8bfb\u9501\u88ab\u5220\u9664\u4e86\u3002 K_ERR_RWLOCK_READERS_TO_MANY \u5df2\u83b7\u53d6\u8bfb\u9501\u7684\u8bfb\u8005\u8fc7\u591a\u3002","title":"tos_rwlock_rpend_try"},{"location":"05.SDK_Manual/#tos_rwlock_wpend_timed","text":"k_err_t tos_rwlock_wpend_timed(k_rwlock_t *rwlock, k_tick_t timeout); \u529f\u80fd\u63cf\u8ff0 \u6709\u9650\u7684\u65f6\u95f4\u5185\u5c1d\u8bd5\u83b7\u53d6\u5199\u9501\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 [in] timeout \u8d85\u65f6\u65f6\u9650 \u8fd4\u56de\u503c K_ERR_NONE \u6210\u529f\u83b7\u53d6\u8bfb\u9501\u3002 K_ERR_PEND_SCHED_LOCKED \u672a\u6210\u529f\u83b7\u53d6\u5230\u5199\u9501\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u5199\u9501\u88ab\u5220\u9664\u4e86\u3002 K_ERR_PEND_TIMEOUT \u672a\u5728\u8d85\u65f6\u65f6\u9650\u5185\u6210\u529f\u83b7\u53d6\u5230\u5199\u9501\u3002 K_ERR_RWLOCK_WAITING_WRITERS_TO_MANY \u5c1d\u8bd5\u83b7\u53d6\u5199\u9501\u7684\u4efb\u52a1\u8fc7\u591a\u3002","title":"tos_rwlock_wpend_timed"},{"location":"05.SDK_Manual/#tos_rwlock_wpend","text":"k_err_t tos_rwlock_wpend(k_rwlock_t *rwlock); \u529f\u80fd\u63cf\u8ff0 \u6c38\u4e45\u6027\u963b\u585e\u5c1d\u8bd5\u83b7\u53d6\u5199\u9501\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6210\u529f\u83b7\u53d6\u5199\u9501\u3002 K_ERR_PEND_SCHED_LOCKED \u5728\u8d85\u65f6\u65f6\u9650\u5185\u672a\u6210\u529f\u83b7\u53d6\u5230\u5199\u9501\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u5199\u9501\u88ab\u5220\u9664\u4e86\u3002 K_ERR_RWLOCK_WAITING_WRITERS_TO_MANY \u5c1d\u8bd5\u83b7\u53d6\u5199\u9501\u7684\u4efb\u52a1\u8fc7\u591a\u3002","title":"tos_rwlock_wpend"},{"location":"05.SDK_Manual/#tos_rwlock_wpend_try","text":"k_err_t tos_rwlock_wpend_try(k_rwlock_t *rwlock); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u83b7\u53d6\u5199\u9501\uff0c\u4e14\u5e76\u4e0d\u963b\u585e\u7b49\u5f85\uff0c\u7acb\u5373\u8fd4\u56de\u9519\u8bef\u7801\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6210\u529f\u83b7\u53d6\u5199\u9501\u3002 K_ERR_PEND_SCHED_LOCKED \u5728\u8d85\u65f6\u65f6\u9650\u5185\u672a\u6210\u529f\u83b7\u53d6\u5230\u5199\u9501\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u9501\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u7b49\u5f85\u7684\u5199\u9501\u88ab\u5220\u9664\u4e86\u3002 K_ERR_RWLOCK_WAITING_WRITERS_TO_MANY \u5c1d\u8bd5\u83b7\u53d6\u5199\u9501\u7684\u4efb\u52a1\u8fc7\u591a\u3002","title":"tos_rwlock_wpend_try"},{"location":"05.SDK_Manual/#tos_rwlock_rpost","text":"k_err_t tos_rwlock_rpost(k_rwlock_t *rwlock); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4e00\u4e2a\u8bfb\u9501\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6210\u529f\u91ca\u653e\u8bfb\u9501\u3002 K_ERR_RWLOCK_NOT_READING \u5f53\u524d\u4efb\u52a1\u5e76\u975e\u6b64\u8bfb\u9501\u62e5\u6709\u8005\u3002","title":"tos_rwlock_rpost"},{"location":"05.SDK_Manual/#tos_rwlock_wpost","text":"k_err_t tos_rwlock_wpost(k_rwlock_t *rwlock); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4e00\u4e2a\u5199\u9501\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6210\u529f\u91ca\u653e\u5199\u9501\u3002 K_ERR_RWLOCK_NOT_WRITTING \u5f53\u524d\u4efb\u52a1\u5e76\u975e\u6b64\u5199\u9501\u62e5\u6709\u8005\u3002","title":"tos_rwlock_wpost"},{"location":"05.SDK_Manual/#tos_rwlock_post","text":"k_err_t tos_rwlock_post(k_rwlock_t *rwlock); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4e00\u4e2a\u8bfb\u5199\u9501\u3002 \u5982\u679c\u5f53\u524d\u8bfb\u5199\u9501\u88ab\u8bfb\u8005\u6301\u6709\uff0c\u5219\u91ca\u653e\u8bfb\u9501\uff1b\u5982\u679c\u662f\u88ab\u5199\u8005\u6301\u6709\uff0c\u5219\u91ca\u653e\u5199\u9501\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] rwlock \u8bfb\u5199\u9501\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6210\u529f\u91ca\u653e\u5199\u9501\u3002 K_ERR_RWLOCK_NOT_TAKEN \u6b64\u8bfb\u5199\u9501\u5e76\u672a\u88ab\u4efb\u4f55\u8bfb\u8005\u6216\u5199\u8005\u5360\u6709\u3002","title":"tos_rwlock_post"},{"location":"05.SDK_Manual/#message-queue","text":"","title":"\u6d88\u606f\u961f\u5217message queue"},{"location":"05.SDK_Manual/#tos_msg_q_create","text":"k_err_t tos_msg_q_create(k_msg_q_t *msg_q, void *pool, size_t msg_cnt); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u6d88\u606f\u961f\u5217\uff08\u6d88\u606f\u5c31\u662f\u6307\u9488\uff09\u3002\u6d88\u606f\u961f\u5217\u662f\u7528\u6765\u5728\u4efb\u52a1\u95f4\u4f20\u9012\u6307\u9488\u4fe1\u606f\u7684\u673a\u5236\u3002pool\u7531\u7528\u6237\u4f20\u5165\uff0cpool\u662f\u4e00\u7247\u5927\u5c0f\u4e3a(msg_cnt * sizeof(void *))\u7684\u5185\u5b58buffer\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] msg_q \u6d88\u606f\u961f\u5217\u53e5\u67c4 [in] pool \u6d88\u606f\u961f\u5217\u7684buffer\u6c60 [in] msg_cnt \u6d88\u606f\u961f\u5217\u7684\u6700\u5927\u6d88\u606f\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u6d88\u606f\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL msg_q\u6307\u9488\u4e3a\u7a7a\u3002","title":"tos_msg_q_create"},{"location":"05.SDK_Manual/#tos_msg_q_create_dyn","text":"k_err_t tos_msg_q_create_dyn(k_msg_q_t *msg_q, size_t msg_cnt); \u529f\u80fd\u63cf\u8ff0 \u52a8\u6001\u521b\u5efa\u4e00\u4e2a\u6d88\u606f\u961f\u5217\uff08\u6d88\u606f\u5c31\u662f\u6307\u9488\uff09\u3002\u6d88\u606f\u961f\u5217\u662f\u7528\u6765\u5728\u4efb\u52a1\u95f4\u4f20\u9012\u6307\u9488\u4fe1\u606f\u7684\u673a\u5236\u3002\u5185\u90e8buffer\u7531\u52a8\u6001\u5185\u5b58\u5206\u914d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] msg_q \u6d88\u606f\u961f\u5217\u53e5\u67c4 [in] msg_cnt \u6d88\u606f\u961f\u5217\u7684\u6700\u5927\u6d88\u606f\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u6d88\u606f\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL msg_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OUT_OF_MEMORY \u5806\u5185\u5b58\u4e0d\u8db3\u3002","title":"tos_msg_q_create_dyn"},{"location":"05.SDK_Manual/#tos_msg_q_destroy","text":"k_err_t tos_msg_q_destroy(k_msg_q_t *msg_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u6d88\u606f\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] msg_q \u6d88\u606f\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6d88\u606f\u961f\u5217\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL msg_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID msg_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u6d88\u606f\u961f\u5217\u3002","title":"tos_msg_q_destroy"},{"location":"05.SDK_Manual/#tos_msg_q_destroy_dyn","text":"k_err_t tos_msg_q_destroy_dyn(k_msg_q_t *msg_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u52a8\u6001\u521b\u5efa\u7684\uff08tos_msg_q_create_dyn\uff09\u6d88\u606f\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] msg_q \u6d88\u606f\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6d88\u606f\u961f\u5217\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL msg_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID msg_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u6d88\u606f\u961f\u5217\u3002","title":"tos_msg_q_destroy_dyn"},{"location":"05.SDK_Manual/#tos_msg_q_flush","text":"k_err_t tos_msg_q_flush(k_msg_q_t *msg_q); \u529f\u80fd\u63cf\u8ff0 \u51b2\u6d17\u6d88\u606f\u961f\u5217\uff08\u4e22\u5f03\u6d88\u606f\u961f\u5217\u4e2d\u7684\u6240\u6709\u6d88\u606f\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] msg_q \u6d88\u606f\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6d88\u606f\u961f\u5217\u51b2\u6d17\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL msg_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID msg_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u6d88\u606f\u961f\u5217\u3002","title":"tos_msg_q_flush"},{"location":"05.SDK_Manual/#tos_msg_q_pend","text":"k_err_t tos_msg_q_pend(k_msg_q_t *msg_q, void **msg_ptr, k_tick_t timeout); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u4ece\u6d88\u606f\u961f\u5217\u4e2d\u83b7\u53d6\u6d88\u606f\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] msg_q \u6d88\u606f\u961f\u5217\u53e5\u67c4 [out] msg_ptr \u83b7\u53d6\u5230\u7684\u6d88\u606f\u5730\u5740 [in] timeout \u7b49\u5f85\u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u4ece\u6d88\u606f\u961f\u5217\u83b7\u53d6\u6d88\u606f\u6210\u529f\uff0cmsg_addr\u548cmsg_size\u5206\u522b\u662f\u83b7\u53d6\u5230\u7684\u6d88\u606f\u5730\u5740\u548c\u6d88\u606f\u957f\u5ea6\u3002 K_ERR_PEND_NOWAIT \u672a\u80fd\u4ece\u6d88\u606f\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u6d88\u606f\uff0c\u5e76\u4e14timeout\u53c2\u6570\u4e3aTOS_TIME_NOWAIT\uff08\u8868\u793a\u83b7\u53d6\u4e0d\u5230\u6d88\u606f\u65f6\u7acb\u5373\u8fd4\u56de\uff09\u3002 K_ERR_PEND_SCHED_LOCKED \u672a\u80fd\u4ece\u6d88\u606f\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u6d88\u606f\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_TIMEOUT \u5728timeout\u8d85\u65f6\u8303\u56f4\u5185\u672a\u80fd\u4ece\u6d88\u606f\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u6d88\u606f\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u83b7\u53d6\u6d88\u606f\u7684\u961f\u5217\u88ab\u9500\u6bc1\u4e86\uff08tos_msg_q_destroy\uff09\u3002","title":"tos_msg_q_pend"},{"location":"05.SDK_Manual/#tos_msg_q_post","text":"k_err_t tos_msg_q_post(k_msg_q_t *msg_q, void *msg_ptr); \u529f\u80fd\u63cf\u8ff0 \u5411\u6d88\u606f\u961f\u5217\u4e2d\u653e\u5165\u4e00\u4e2a\u6d88\u606f\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u4e00\u4e2a\u4efb\u52a1\u3002\u5982\u679c\u6709\u591a\u4e2a\u4efb\u52a1\u5728\u6b64\u6d88\u606f\u961f\u5217\u7684\u7b49\u5f85\u961f\u5217\u4e0a\uff0c\u5524\u9192\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] msg_q \u6d88\u606f\u961f\u5217\u53e5\u67c4 [in] msg_ptr \u6d88\u606f\u5730\u5740 \u8fd4\u56de\u503c K_ERR_NONE \u5411\u6d88\u606f\u961f\u5217\u4e2d\u653e\u5165\u6d88\u606f\u6210\u529f\u3002 K_ERR_RING_Q_FULL \u6d88\u606f\u961f\u5217\u5df2\u6ee1\u3002","title":"tos_msg_q_post"},{"location":"05.SDK_Manual/#tos_msg_q_post_all","text":"k_err_t tos_msg_q_post_all(k_msg_q_t *msg_q, void *msg_ptr); \u529f\u80fd\u63cf\u8ff0 \u5411\u6d88\u606f\u961f\u5217\u4e2d\u653e\u5165\u4e00\u4e2a\u6d88\u606f\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u6240\u6709\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] msg_q \u6d88\u606f\u961f\u5217\u53e5\u67c4 [in] msg_ptr \u6d88\u606f\u5730\u5740 \u8fd4\u56de\u503c K_ERR_NONE \u5411\u6d88\u606f\u961f\u5217\u4e2d\u653e\u5165\u6d88\u606f\u6210\u529f\u3002 K_ERR_RING_Q_FULL \u6d88\u606f\u961f\u5217\u5df2\u6ee1\u3002","title":"tos_msg_q_post_all"},{"location":"05.SDK_Manual/#mail-queue","text":"","title":"\u90ae\u7bb1\u961f\u5217mail queue"},{"location":"05.SDK_Manual/#tos_mail_q_create","text":"k_err_t tos_mail_q_create(k_mail_q_t *mail_q, void *pool, size_t mail_cnt, size_t mail_size); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u90ae\u7bb1\u961f\u5217\uff08\u90ae\u4ef6\u662f\u4e00\u7247\u56fa\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\uff09\u3002\u90ae\u7bb1\u961f\u5217\u662f\u7528\u6765\u5728\u4efb\u52a1\u95f4\u4f20\u9012\u5177\u6709\u7279\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\u4fe1\u606f\u7684\u673a\u5236\u3002pool\u7531\u7528\u6237\u4f20\u5165\uff0cpool\u662f\u4e00\u7247\u5927\u5c0f\u4e3a(mail_cnt* mail_size)\u7684\u5185\u5b58buffer\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mail_q \u90ae\u7bb1\u961f\u5217\u53e5\u67c4 [in] pool \u90ae\u7bb1\u961f\u5217\u7684buffer\u6c60 [in] mail_cnt \u90ae\u4ef6\u7684\u6700\u5927\u6570\u91cf [in] mail_size \u90ae\u4ef6\u7684\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u90ae\u7bb1\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL mail_q\u6307\u9488\u4e3a\u7a7a\u3002","title":"tos_mail_q_create"},{"location":"05.SDK_Manual/#tos_mail_q_create_dyn","text":"k_err_t tos_mail_q_create_dyn(k_mail_q_t *mail_q, size_t mail_cnt, size_t mail_size); \u529f\u80fd\u63cf\u8ff0 \u52a8\u6001\u521b\u5efa\u4e00\u4e2a\u90ae\u7bb1\u961f\u5217\uff08\u90ae\u4ef6\u662f\u4e00\u7247\u56fa\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\uff09\u3002\u90ae\u7bb1\u961f\u5217\u662f\u7528\u6765\u5728\u4efb\u52a1\u95f4\u4f20\u9012\u5177\u6709\u7279\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\u4fe1\u606f\u7684\u673a\u5236\u3002\u5185\u90e8buffer\u7531\u52a8\u6001\u5185\u5b58\u5206\u914d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mail_q \u90ae\u7bb1\u961f\u5217\u53e5\u67c4 [in] mail_cnt \u90ae\u4ef6\u7684\u6700\u5927\u6570\u91cf [in] mail_size \u90ae\u4ef6\u7684\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u90ae\u7bb1\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL mail_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OUT_OF_MEMORY \u5806\u5185\u5b58\u4e0d\u8db3\u3002","title":"tos_mail_q_create_dyn"},{"location":"05.SDK_Manual/#tos_mail_q_destroy","text":"k_err_t tos_mail_q_destroy(k_mail_q_t *mail_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u90ae\u7bb1\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mail_q \u90ae\u7bb1\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u90ae\u7bb1\u961f\u5217\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL mail_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID mail_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u90ae\u7bb1\u961f\u5217\u3002","title":"tos_mail_q_destroy"},{"location":"05.SDK_Manual/#tos_mail_q_destroy_dyn","text":"k_err_t tos_mail_q_destroy_dyn(k_mail_q_t *mail_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u52a8\u6001\u521b\u5efa\u7684\uff08tos_mail_q_create_dyn\uff09\u90ae\u7bb1\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mail_q \u90ae\u7bb1\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u90ae\u7bb1\u961f\u5217\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL mail_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID mail_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u90ae\u7bb1\u961f\u5217\u3002","title":"tos_mail_q_destroy_dyn"},{"location":"05.SDK_Manual/#tos_mail_q_flush","text":"k_err_t tos_mail_q_flush(k_mail_q_t *mail_q); \u529f\u80fd\u63cf\u8ff0 \u51b2\u6d17\u90ae\u7bb1\u961f\u5217\uff08\u4e22\u5f03\u90ae\u7bb1\u961f\u5217\u4e2d\u7684\u6240\u6709\u90ae\u4ef6\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mail_q \u90ae\u7bb1\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u90ae\u7bb1\u961f\u5217\u51b2\u6d17\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL mail_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID mail_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u90ae\u7bb1\u961f\u5217\u3002","title":"tos_mail_q_flush"},{"location":"05.SDK_Manual/#tos_mail_q_pend","text":"k_err_t tos_mail_q_pend(k_mail_q_t *mail_q, void *mail_buf, size_t *mail_size, k_tick_t timeout); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u4ece\u90ae\u7bb1\u961f\u5217\u4e2d\u83b7\u53d6\u90ae\u4ef6\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mail_q \u90ae\u7bb1\u961f\u5217\u53e5\u67c4 [out] mail_buf \u7528\u6765\u627f\u8f7d\u90ae\u4ef6\u5185\u5bb9\u7684buffer\u5730\u5740 [in] mail_size \u83b7\u53d6\u5230\u7684\u90ae\u4ef6\u957f\u5ea6 [in] timeout \u7b49\u5f85\u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u4ece\u90ae\u7bb1\u961f\u5217\u83b7\u53d6\u90ae\u4ef6\u6210\u529f\uff0cmail_buf\u4e2d\u88ab\u5199\u5165\u90ae\u4ef6\u5185\u5bb9\uff0cmsg_size\u83b7\u53d6\u5230\u7684\u90ae\u4ef6\u957f\u5ea6\u3002 K_ERR_PEND_NOWAIT \u672a\u80fd\u4ece\u90ae\u7bb1\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u90ae\u4ef6\uff0c\u5e76\u4e14timeout\u53c2\u6570\u4e3aTOS_TIME_NOWAIT\uff08\u8868\u793a\u83b7\u53d6\u4e0d\u5230\u90ae\u4ef6\u65f6\u7acb\u5373\u8fd4\u56de\uff09\u3002 K_ERR_PEND_SCHED_LOCKED \u672a\u80fd\u4ece\u90ae\u7bb1\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u90ae\u4ef6\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_TIMEOUT \u5728timeout\u8d85\u65f6\u8303\u56f4\u5185\u672a\u80fd\u4ece\u90ae\u7bb1\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u90ae\u4ef6\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u83b7\u53d6\u90ae\u4ef6\u7684\u961f\u5217\u88ab\u9500\u6bc1\u4e86\uff08tos_mail_q_destroy\uff09\u3002","title":"tos_mail_q_pend"},{"location":"05.SDK_Manual/#tos_mail_q_post","text":"k_err_t tos_mail_q_post(k_mail_q_t *mail_q, void *mail_buf, size_t mail_size); \u529f\u80fd\u63cf\u8ff0 \u5411\u90ae\u7bb1\u961f\u5217\u4e2d\u653e\u5165\u4e00\u4e2a\u90ae\u4ef6\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u4e00\u4e2a\u4efb\u52a1\u3002\u5982\u679c\u6709\u591a\u4e2a\u4efb\u52a1\u5728\u6b64\u90ae\u7bb1\u961f\u5217\u7684\u7b49\u5f85\u961f\u5217\u4e0a\uff0c\u5524\u9192\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mail_q \u90ae\u7bb1\u961f\u5217\u53e5\u67c4 [in] mail_buf \u8981\u653e\u5165\u90ae\u7bb1\u961f\u5217\u7684\u90ae\u4ef6 [in] mail_size \u90ae\u4ef6\u957f\u5ea6 \u8fd4\u56de\u503c K_ERR_NONE \u5411\u90ae\u7bb1\u961f\u5217\u4e2d\u653e\u5165\u90ae\u4ef6\u6210\u529f\u3002 K_ERR_RING_Q_FULL \u90ae\u7bb1\u961f\u5217\u5df2\u6ee1\u3002","title":"tos_mail_q_post"},{"location":"05.SDK_Manual/#tos_mail_q_post_all","text":"k_err_t tos_mail_q_post_all(k_mail_q_t *mail_q, void *mail_buf, size_t mail_size); \u529f\u80fd\u63cf\u8ff0 \u5411\u90ae\u7bb1\u961f\u5217\u4e2d\u653e\u5165\u4e00\u4e2a\u90ae\u4ef6\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u6240\u6709\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mail_q \u90ae\u7bb1\u961f\u5217\u53e5\u67c4 [in] mail_buf \u8981\u653e\u5165\u90ae\u7bb1\u961f\u5217\u7684\u90ae\u4ef6 [in] mail_size \u90ae\u4ef6\u957f\u5ea6 \u8fd4\u56de\u503c K_ERR_NONE \u5411\u90ae\u7bb1\u961f\u5217\u4e2d\u653e\u5165\u90ae\u4ef6\u6210\u529f\u3002 K_ERR_RING_Q_FULL \u90ae\u7bb1\u961f\u5217\u5df2\u6ee1\u3002","title":"tos_mail_q_post_all"},{"location":"05.SDK_Manual/#priority-message-queue","text":"","title":"\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217priority message queue"},{"location":"05.SDK_Manual/#tos_prio_msg_q_create","text":"k_err_t tos_prio_msg_q_create(k_prio_msg_q_t *prio_msg_q, void *pool, size_t msg_cnt); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\uff08\u6d88\u606f\u5c31\u662f\u6307\u9488\uff09\u3002\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u662f\u7528\u6765\u5728\u4efb\u52a1\u95f4\u4f20\u9012\u6307\u9488\u4fe1\u606f\u7684\u673a\u5236\uff0c\u4e0e\u6d88\u606f\u961f\u5217\u4e0d\u540c\u7684\u5730\u65b9\u5728\u4e8e\uff0c\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u53ef\u4ee5\u7ed9\u6d88\u606f\u8d4b\u4e88\u4e00\u4e2a\u4f18\u5148\u7ea7\uff0c\u8f83\u9ad8\u4f18\u5148\u7ea7\uff08\u6570\u503c\u4e0a\u66f4\u5c0f\uff09\u7684\u6d88\u606f\u4f1a\u6bd4\u8f83\u4f4e\u4f18\u5148\u7ea7\u7684\u6d88\u606f\u66f4\u5feb\u4f20\u9012\u5230\u7b49\u5f85\u4efb\u52a1\u3002pool\u7531\u7528\u6237\u4f20\u5165\uff0cpool\u662f\u4e00\u7247\u5927\u5c0f\u4e3a(msg_cnt * sizeof(void *))\u7684\u5185\u5b58buffer\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_msg_q \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u53e5\u67c4 [in] pool \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u7684buffer\u6c60 [in] msg_cnt \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u7684\u6700\u5927\u6d88\u606f\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL prio_msg_q\u6307\u9488\u4e3a\u7a7a\u3002","title":"tos_prio_msg_q_create"},{"location":"05.SDK_Manual/#tos_prio_msg_q_create_dyn","text":"k_err_t tos_prio_msg_q_create_dyn(k_prio_msg_q_t *prio_msg_q, size_t msg_cnt); \u529f\u80fd\u63cf\u8ff0 \u52a8\u6001\u521b\u5efa\u4e00\u4e2a\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\uff08\u6d88\u606f\u5c31\u662f\u6307\u9488\uff09\u3002\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u662f\u7528\u6765\u5728\u4efb\u52a1\u95f4\u4f20\u9012\u6307\u9488\u4fe1\u606f\u7684\u673a\u5236\uff0c\u4e0e\u6d88\u606f\u961f\u5217\u4e0d\u540c\u7684\u5730\u65b9\u5728\u4e8e\uff0c\u4f18\u5148\u7ea7\u961f\u5217\u53ef\u4ee5\u7ed9\u6d88\u606f\u8d4b\u4e88\u4e00\u4e2a\u4f18\u5148\u7ea7\uff0c\u8f83\u9ad8\u4f18\u5148\u7ea7\uff08\u6570\u503c\u4e0a\u66f4\u5c0f\uff09\u7684\u6d88\u606f\u4f1a\u6bd4\u8f83\u4f4e\u4f18\u5148\u7ea7\u7684\u6d88\u606f\u66f4\u5feb\u4f20\u9012\u5230\u7b49\u5f85\u4efb\u52a1\u3002\u5185\u90e8buffer\u7531\u52a8\u6001\u5185\u5b58\u5206\u914d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_msg_q \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u53e5\u67c4 [in] msg_cnt \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u7684\u6700\u5927\u6d88\u606f\u6570 \u8fd4\u56de\u503c K_ERR_NONE\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL prio_msg_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OUT_OF_MEMORY \u5806\u5185\u5b58\u4e0d\u8db3\u3002","title":"tos_prio_msg_q_create_dyn"},{"location":"05.SDK_Manual/#tos_prio_msg_q_destroy","text":"k_err_t tos_prio_msg_q_destroy(k_prio_msg_q_t *prio_msg_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_msg_q \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL msg_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID prio_msg_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u3002","title":"tos_prio_msg_q_destroy"},{"location":"05.SDK_Manual/#tos_prio_msg_q_destroy_dyn","text":"k_err_t tos_prio_msg_q_destroy_dyn(k_prio_msg_q_t *prio_msg_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u52a8\u6001\u521b\u5efa\u7684\uff08tos_prio_msg_q_create_dyn\uff09\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_msg_q \u4f18\u5148\u7ea7\u606f\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL prio_msg_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID prio_msg_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u3002","title":"tos_prio_msg_q_destroy_dyn"},{"location":"05.SDK_Manual/#tos_prio_msg_q_flush","text":"k_err_t tos_prio_msg_q_flush(k_prio_msg_q_t *prio_msg_q); \u529f\u80fd\u63cf\u8ff0 \u51b2\u6d17 \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\uff08\u4e22\u5f03\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u4e2d\u7684\u6240\u6709\u6d88\u606f\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_msg_q \u4f18\u5148\u7ea7\u606f\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u51b2\u6d17\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL prio_msg_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID prio_msg_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u3002","title":"tos_prio_msg_q_flush"},{"location":"05.SDK_Manual/#tos_prio_msg_q_pend","text":"k_err_t tos_prio_msg_q_pend(k_prio_msg_q_t *prio_msg_q, void **msg_ptr, k_tick_t timeout); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u4ece\u6d88\u606f\u961f\u5217\u4e2d\u83b7\u53d6\u6d88\u606f\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_msg_q \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u53e5\u67c4 [out] msg_ptr \u83b7\u53d6\u5230\u7684\u6d88\u606f\u5730\u5740 [in] timeout \u7b49\u5f85\u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u4ece\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u83b7\u53d6\u6d88\u606f\u6210\u529f\uff0cmsg_addr\u548cmsg_size\u5206\u522b\u662f\u83b7\u53d6\u5230\u7684\u6d88\u606f\u5730\u5740\u548c\u6d88\u606f\u957f\u5ea6\u3002 K_ERR_PEND_NOWAIT \u672a\u80fd\u4ece\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u6d88\u606f\uff0c\u5e76\u4e14timeout\u53c2\u6570\u4e3aTOS_TIME_NOWAIT\uff08\u8868\u793a\u83b7\u53d6\u4e0d\u5230\u6d88\u606f\u65f6\u7acb\u5373\u8fd4\u56de\uff09\u3002 K_ERR_PEND_SCHED_LOCKED \u672a\u80fd\u4ece\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u6d88\u606f\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_TIMEOUT \u5728timeout\u8d85\u65f6\u8303\u56f4\u5185\u672a\u80fd\u4ece\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u6d88\u606f\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u83b7\u53d6\u6d88\u606f\u7684\u961f\u5217\u88ab\u9500\u6bc1\u4e86\uff08tos_prio_msg_q_destroy\uff09\u3002","title":"tos_prio_msg_q_pend"},{"location":"05.SDK_Manual/#tos_prio_msg_q_post","text":"k_err_t tos_prio_msg_q_post(k_prio_msg_q_t *prio_msg_q, void *msg_ptr, k_prio_t prio); \u529f\u80fd\u63cf\u8ff0 \u5411\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u4e2d\u653e\u5165\u4e00\u4e2a\u6d88\u606f\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u4e00\u4e2a\u4efb\u52a1\u3002\u5982\u679c\u6709\u591a\u4e2a\u4efb\u52a1\u5728\u6b64\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u7684\u7b49\u5f85\u961f\u5217\u4e0a\uff0c\u5524\u9192\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_msg_q \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u53e5\u67c4 [in] msg_ptr \u6d88\u606f\u5730\u5740 [in] prio \u6d88\u606f\u7684\u4f18\u5148\u7ea7 \u8fd4\u56de\u503c K_ERR_NONE \u5411\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u4e2d\u653e\u5165\u6d88\u606f\u6210\u529f\u3002 K_ERR_RING_Q_FULL \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u5df2\u6ee1\u3002","title":"tos_prio_msg_q_post"},{"location":"05.SDK_Manual/#tos_prio_msg_q_post_all","text":"k_err_t tos_prio_msg_q_post_all(k_prio_msg_q_t *prio_msg_q, void *msg_ptr, k_prio_t prio); \u529f\u80fd\u63cf\u8ff0 \u5411\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u4e2d\u653e\u5165\u4e00\u4e2a\u6d88\u606f\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u6240\u6709\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_msg_q \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u53e5\u67c4 [in] msg_ptr \u6d88\u606f\u5730\u5740 [in] prio \u6d88\u606f\u7684\u4f18\u5148\u7ea7 \u8fd4\u56de\u503c K_ERR_NONE \u5411\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u4e2d\u653e\u5165\u6d88\u606f\u6210\u529f\u3002 K_ERR_RING_Q_FULL \u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u5df2\u6ee1\u3002","title":"tos_prio_msg_q_post_all"},{"location":"05.SDK_Manual/#priority-mail-queue","text":"","title":"\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217priority mail queue"},{"location":"05.SDK_Manual/#tos_prio_mail_q_create","text":"k_err_t tos_prio_msg_q_create(k_prio_mail_q_t *prio_mail_q, void *pool, size_t mail_cnt, size_t mail_size); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\uff08\u90ae\u4ef6\u662f\u4e00\u7247\u56fa\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\uff09\u3002\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u662f\u7528\u6765\u5728\u4efb\u52a1\u95f4\u4f20\u9012\u5177\u6709\u7279\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\u4fe1\u606f\u7684\u673a\u5236\uff0c\u4e0e\u90ae\u7bb1\u961f\u5217\u4e0d\u540c\u7684\u5730\u65b9\u5728\u4e8e\uff0c\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u53ef\u4ee5\u7ed9\u90ae\u4ef6\u8d4b\u4e88\u4e00\u4e2a\u4f18\u5148\u7ea7\uff0c\u8f83\u9ad8\u4f18\u5148\u7ea7\uff08\u6570\u503c\u4e0a\u66f4\u5c0f\uff09\u7684\u90ae\u4ef6\u4f1a\u6bd4\u8f83\u4f4e\u4f18\u5148\u7ea7\u7684\u90ae\u4ef6\u66f4\u5feb\u4f20\u9012\u5230\u7b49\u5f85\u4efb\u52a1\u3002pool\u7531\u7528\u6237\u4f20\u5165\uff0cpool\u662f\u4e00\u7247\u5927\u5c0f\u4e3a(mail_cnt* mail_size)\u7684\u5185\u5b58buffer\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_mail_q \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u53e5\u67c4 [in] pool \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u7684buffer\u6c60 [in] mail_cnt \u90ae\u4ef6\u7684\u6700\u5927\u6570\u91cf [in] mail_size \u90ae\u4ef6\u7684\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL prio_mail_q\u6307\u9488\u4e3a\u7a7a\u3002","title":"tos_prio_mail_q_create"},{"location":"05.SDK_Manual/#tos_prio_mail_q_create_dyn","text":"k_err_t tos_prio_mail_q_create_dyn(k_prio_mail_q_t *prio_mail_q, size_t mail_cnt, size_t mail_size); \u529f\u80fd\u63cf\u8ff0 \u52a8\u6001\u521b\u5efa\u4e00\u4e2a\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\uff08\u90ae\u4ef6\u662f\u4e00\u7247\u56fa\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\uff09\u3002\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u662f\u7528\u6765\u5728\u4efb\u52a1\u95f4\u4f20\u9012\u5177\u6709\u7279\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\u4fe1\u606f\u7684\u673a\u5236\u3002\u5185\u90e8buffer\u7531\u52a8\u6001\u5185\u5b58\u5206\u914d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_mail_q \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u53e5\u67c4 [in] mail_cnt \u90ae\u4ef6\u7684\u6700\u5927\u6570\u91cf [in] mail_size \u90ae\u4ef6\u7684\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL prio_mail_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OUT_OF_MEMORY \u5806\u5185\u5b58\u4e0d\u8db3\u3002","title":"tos_prio_mail_q_create_dyn"},{"location":"05.SDK_Manual/#tos_prio_mail_q_destroy","text":"k_err_t tos_prio_mail_q_destroy(k_prio_mail_q_t *prio_mail_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u90ae\u7bb1\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_mail_q \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL prio_mail_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID prio_mail_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u90ae\u7bb1\u961f\u5217\u3002","title":"tos_prio_mail_q_destroy"},{"location":"05.SDK_Manual/#tos_prio_mail_q_destroy_dyn","text":"k_err_t tos_prio_mail_q_destroy_dyn(k_prio_mail_q_t *prio_mail_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u52a8\u6001\u521b\u5efa\u7684\uff08tos_mail_q_create_dyn\uff09\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_mail_q \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL prio_mail_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID prio_mail_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u3002","title":"tos_prio_mail_q_destroy_dyn"},{"location":"05.SDK_Manual/#tos_prio_mail_q_flush","text":"k_err_t tos_prio_mail_q_flush(k_prio_mail_q_t *prio_mail_q); \u529f\u80fd\u63cf\u8ff0 \u51b2\u6d17\u90ae\u7bb1\u961f\u5217\uff08\u4e22\u5f03\u90ae\u7bb1\u961f\u5217\u4e2d\u7684\u6240\u6709\u90ae\u4ef6\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_mail_q \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u51b2\u6d17\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL prio_mail_q\u6307\u9488\u4e3a\u7a7a\u3002 K_ERR_OBJ_INVALID prio_mail_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u90ae\u7bb1\u961f\u5217\u3002","title":"tos_prio_mail_q_flush"},{"location":"05.SDK_Manual/#tos_prio_mail_q_pend","text":"k_err_t tos_prio_mail_q_pend(k_prio_mail_q_t *prio_mail_q, void *mail_buf, size_t *mail_size, k_tick_t timeout); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u4ece\u90ae\u7bb1\u961f\u5217\u4e2d\u83b7\u53d6\u90ae\u4ef6\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_mail_q \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u53e5\u67c4 [out] mail_buf \u7528\u6765\u627f\u8f7d\u90ae\u4ef6\u5185\u5bb9\u7684buffer\u5730\u5740 [in] mail_size \u83b7\u53d6\u5230\u7684\u90ae\u4ef6\u957f\u5ea6 [in] timeout \u7b49\u5f85\u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u4ece\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u83b7\u53d6\u90ae\u4ef6\u6210\u529f\uff0cmail_buf\u4e2d\u88ab\u5199\u5165\u90ae\u4ef6\u5185\u5bb9\uff0cmsg_size\u83b7\u53d6\u5230\u7684\u90ae\u4ef6\u957f\u5ea6\u3002 K_ERR_PEND_NOWAIT \u672a\u80fd\u4ece\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u90ae\u4ef6\uff0c\u5e76\u4e14timeout\u53c2\u6570\u4e3aTOS_TIME_NOWAIT\uff08\u8868\u793a\u83b7\u53d6\u4e0d\u5230\u90ae\u4ef6\u65f6\u7acb\u5373\u8fd4\u56de\uff09\u3002 K_ERR_PEND_SCHED_LOCKED \u672a\u80fd\u4ece\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u90ae\u4ef6\uff0c\u5e76\u4e14\u7cfb\u7edf\u8c03\u5ea6\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u3002 K_ERR_PEND_TIMEOUT \u5728timeout\u8d85\u65f6\u8303\u56f4\u5185\u672a\u80fd\u4ece\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u4e2d\u83b7\u53d6\u5230\u90ae\u4ef6\u3002 K_ERR_PEND_DESTROY \u5c1d\u8bd5\u83b7\u53d6\u90ae\u4ef6\u7684\u961f\u5217\u88ab\u9500\u6bc1\u4e86\uff08tos_prio_mail_q_destroy\uff09\u3002","title":"tos_prio_mail_q_pend"},{"location":"05.SDK_Manual/#tos_prio_mail_q_post","text":"k_err_t tos_prio_mail_q_post(k_prio_mail_q_t *prio_mail_q, void *mail_buf, size_t mail_size, k_prio_t prio); \u529f\u80fd\u63cf\u8ff0 \u5411\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u4e2d\u653e\u5165\u4e00\u4e2a\u90ae\u4ef6\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u4e00\u4e2a\u4efb\u52a1\u3002\u5982\u679c\u6709\u591a\u4e2a\u4efb\u52a1\u5728\u6b64\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u7684\u7b49\u5f85\u961f\u5217\u4e0a\uff0c\u5524\u9192\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_mail_q \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u53e5\u67c4 [in] mail_buf \u8981\u653e\u5165\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u7684\u90ae\u4ef6 [in] mail_size \u90ae\u4ef6\u957f\u5ea6 [in] prio \u90ae\u4ef6\u7684\u4f18\u5148\u7ea7 \u8fd4\u56de\u503c K_ERR_NONE \u5411\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u4e2d\u653e\u5165\u90ae\u4ef6\u6210\u529f\u3002 K_ERR_RING_Q_FULL \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u5df2\u6ee1\u3002","title":"tos_prio_mail_q_post"},{"location":"05.SDK_Manual/#tos_prio_mail_q_post_all","text":"k_err_t tos_prio_mail_q_post_all(k_prio_mail_q_t *prio_mail_q, void *mail_buf, size_t mail_size, k_prio_t prio); \u529f\u80fd\u63cf\u8ff0 \u5411\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u4e2d\u653e\u5165\u4e00\u4e2a\u90ae\u4ef6\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e0a\u7684\u6240\u6709\u4efb\u52a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_mail_q \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u53e5\u67c4 [in] mail_buf \u8981\u653e\u5165\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u7684\u90ae\u4ef6 [in] mail_size \u90ae\u4ef6\u957f\u5ea6 [in] prio \u90ae\u4ef6\u7684\u4f18\u5148\u7ea7 \u8fd4\u56de\u503c K_ERR_NONE \u5411\u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u4e2d\u653e\u5165\u90ae\u4ef6\u6210\u529f\u3002 K_ERR_RING_Q_FULL \u4f18\u5148\u7ea7\u90ae\u7bb1\u961f\u5217\u5df2\u6ee1\u3002","title":"tos_prio_mail_q_post_all"},{"location":"05.SDK_Manual/#ring-queue","text":"","title":"\u73af\u5f62\u961f\u5217ring queue"},{"location":"05.SDK_Manual/#tos_ring_q_create","text":"k_err_t tos_ring_q_create(k_ring_q_t *ring_q, void *pool, size_t item_cnt, size_t item_size); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u73af\u5f62\u961f\u5217\u3002\u73af\u5f62\u961f\u5217\u63d0\u4f9b\u4e86\u4e00\u79cd\u5bf9\u6570\u636e\u8fdb\u884c\u5148\u5165\u5148\u51fa\u7ba1\u7406\u7684\u673a\u5236\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u4e0a\u5c42\u6570\u636e\u7ed3\u6784\u6216\u7b97\u6cd5\u7684\u5e95\u5c42\u6570\u636e\u5bb9\u5668\u3002pool\u7531\u7528\u6237\u4f20\u5165\uff0cpool\u662f\u4e00\u7247\u5927\u5c0f\u4e3a(item_cnt * item_size)\u7684\u5185\u5b58buffer\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ring_q \u73af\u5f62\u961f\u5217\u53e5\u67c4 [in] pool \u73af\u5f62\u961f\u5217\u7684buffer\u6c60 [in] item_cnt \u73af\u5f62\u961f\u5217\u7ba1\u7406\u7684\u5143\u7d20\u7684\u6570\u91cf [in] item_size \u73af\u5f62\u961f\u5217\u7ba1\u7406\u7684\u5143\u7d20\u7684\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u73af\u5f62\u961f\u5217\u521b\u5efa\u6210\u529f\u3002","title":"tos_ring_q_create"},{"location":"05.SDK_Manual/#tos_ring_q_create_dyn","text":"k_err_t tos_ring_q_create(k_ring_q_t *ring_q, size_t item_cnt, size_t item_size); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u52a8\u6001\u5206\u914d\u7684\u73af\u5f62\u961f\u5217\u3002\u73af\u5f62\u961f\u5217\u63d0\u4f9b\u4e86\u4e00\u79cd\u5bf9\u6570\u636e\u8fdb\u884c\u5148\u5165\u5148\u51fa\u7ba1\u7406\u7684\u673a\u5236\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u4e0a\u5c42\u6570\u636e\u7ed3\u6784\u6216\u7b97\u6cd5\u7684\u5e95\u5c42\u6570\u636e\u5bb9\u5668\u3002\u5185\u90e8\u7684pool\u6c60\u7531\u52a8\u6001\u5185\u5b58\u5206\u914d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ring_q \u73af\u5f62\u961f\u5217\u53e5\u67c4 [in] item_cnt \u73af\u5f62\u961f\u5217\u7ba1\u7406\u7684\u5143\u7d20\u7684\u6570\u91cf [in] item_size \u73af\u5f62\u961f\u5217\u7ba1\u7406\u7684\u5143\u7d20\u7684\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u73af\u5f62\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OUT_OF_MEMORY \u5806\u5185\u5b58\u4e0d\u8db3\u3002","title":"tos_ring_q_create_dyn"},{"location":"05.SDK_Manual/#tos_ring_q_destroy","text":"k_err_t tos_ring_q_destroy(k_ring_q_t *ring_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u73af\u5f62\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ring_q \u73af\u5f62\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u9500\u6bc1\u73af\u5f62\u961f\u5217\u6210\u529f\u3002 K_ERR_OBJ_INVALID ring_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u73af\u5f62\u961f\u5217\u3002","title":"tos_ring_q_destroy"},{"location":"05.SDK_Manual/#tos_ring_q_destroy_dyn","text":"k_err_t tos_ring_q_destroy_dyn(k_ring_q_t *ring_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u52a8\u6001\u521b\u5efa\u7684\u73af\u5f62\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ring_q \u73af\u5f62\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u9500\u6bc1\u73af\u5f62\u961f\u5217\u6210\u529f\u3002 K_ERR_OBJ_INVALID ring_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u73af\u5f62\u961f\u5217\u3002","title":"tos_ring_q_destroy_dyn"},{"location":"05.SDK_Manual/#tos_ring_q_enqueue","text":"k_err_t tos_ring_q_enqueue(k_ring_q_t *ring_q, void *item, size_t item_size); \u529f\u80fd\u63cf\u8ff0 \u5411\u73af\u5f62\u961f\u5217\u4e2d\u653e\u5165\u4e00\u4e2a\u5143\u7d20\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ring_q \u73af\u5f62\u961f\u5217\u53e5\u67c4 [in] item \u5f85\u5165\u961f\u7684\u5143\u7d20\u5730\u5740 [in] item_size \u5f85\u5165\u961f\u7684\u5143\u7d20\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u5143\u7d20\u5165\u961f\u6210\u529f\u3002 K_ERR_RING_Q_FULL \u73af\u5f62\u961f\u5217\u5df2\u6ee1\u3002","title":"tos_ring_q_enqueue"},{"location":"05.SDK_Manual/#tos_ring_q_dequeue","text":"k_err_t tos_ring_q_dequeue(k_ring_q_t *ring_q, void *item, size_t *item_size); \u529f\u80fd\u63cf\u8ff0 \u4ece\u73af\u5f62\u961f\u5217\u4e2d\u83b7\u53d6\u4e00\u4e2a\u5143\u7d20\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ring_q \u73af\u5f62\u961f\u5217\u53e5\u67c4 [out] item \u627f\u63a5\u51fa\u961f\u5143\u7d20\u7684\u5185\u5b58buffer [out] item_size \u51fa\u961f\u7684\u5143\u7d20\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u5143\u7d20\u51fa\u961f\u6210\u529f\u3002 K_ERR_RING_Q_EMPTY \u73af\u5f62\u961f\u5217\u5df2\u7a7a\u3002","title":"tos_ring_q_dequeue"},{"location":"05.SDK_Manual/#tos_ring_q_flush","text":"k_err_t tos_ring_q_flush(k_ring_q_t *ring_q); \u529f\u80fd\u63cf\u8ff0 \u51b2\u6d17\u73af\u5f62\u961f\u5217\uff08\u590d\u4f4d\u73af\u5f62\u961f\u5217\uff0c\u4e22\u5f03\u73af\u5f62\u961f\u5217\u4e2d\u7684\u6240\u6709\u5143\u7d20\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ring_q \u73af\u5f62\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u51b2\u6d17\u73af\u5f62\u961f\u5217\u6210\u529f\u3002","title":"tos_ring_q_flush"},{"location":"05.SDK_Manual/#tos_ring_q_is_empty","text":"k_err_t tos_ring_q_is_empty(k_ring_q_t *ring_q); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u4e00\u4e2a\u73af\u5f62\u961f\u5217\u662f\u5426\u4e3a\u7a7a\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ring_q \u73af\u5f62\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_TRUE \u73af\u5f62\u961f\u5217\u4e3a\u7a7a\u3002 K_FALSE \u73af\u5f62\u961f\u5217\u975e\u7a7a\u3002","title":"tos_ring_q_is_empty"},{"location":"05.SDK_Manual/#tos_ring_q_is_full","text":"k_err_t tos_ring_q_is_full(k_ring_q_t *ring_q); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u4e00\u4e2a\u73af\u5f62\u961f\u5217\u662f\u5426\u4e3a\u6ee1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ring_q \u73af\u5f62\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_TRUE \u73af\u5f62\u961f\u5217\u4e3a\u6ee1\u3002 K_FALSE \u73af\u5f62\u961f\u5217\u975e\u6ee1\u3002","title":"tos_ring_q_is_full"},{"location":"05.SDK_Manual/#fifo","text":"","title":"\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217fifo"},{"location":"05.SDK_Manual/#tos_chr_fifo_create","text":"k_err_t tos_chr_fifo_create(k_chr_fifo_t *chr_fifo, uint8_t *buffer, size_t size); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u3002\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u7684\u5e95\u5c42\u6570\u636e\u5bb9\u5668\u662f\u73af\u5f62\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 [in] buffer \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u5185\u5b58\u6c60 [in] size \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u5185\u5b58\u6c60\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL fifo\u662f\u7a7a\u6307\u9488\u3002","title":"tos_chr_fifo_create"},{"location":"05.SDK_Manual/#tos_chr_fifo_create_dyn","text":"k_err_t tos_chr_fifo_create(k_chr_fifo_t *chr_fifo, size_t fifo_size); \u529f\u80fd\u63cf\u8ff0 \u52a8\u6001\u521b\u5efa\u4e00\u4e2a\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\uff08\u5185\u90e8buffer\u52a8\u6001\u5206\u914d\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 [in] size \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u5185\u5b58\u6c60\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL chr_fifo\u662f\u7a7a\u6307\u9488\u3002 K_ERR_OUT_OF_MEMORY \u5806\u5185\u5b58\u4e0d\u8db3\u3002","title":"tos_chr_fifo_create_dyn"},{"location":"05.SDK_Manual/#tos_chr_fifo_destroy","text":"k_err_t tos_chr_fifo_destroy(k_chr_fifo_t *chr_fifo); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL chr_fifo\u662f\u7a7a\u6307\u9488\u3002 K_ERR_OBJ_INVALID chr_fifo\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u5148\u5165\u5148\u51fa\u961f\u5217\u3002","title":"tos_chr_fifo_destroy"},{"location":"05.SDK_Manual/#tos_chr_fifo_destroy_dyn","text":"k_err_t tos_chr_fifo_destroy_dyn(k_chr_fifo_t *chr_fifo); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u52a8\u6001\u521b\u5efa\uff08tos_chr_fifo_create_dyn\uff09\u7684\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL chr_fifo\u662f\u7a7a\u6307\u9488\u3002 K_ERR_OBJ_INVALID chr_fifo\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u5148\u5165\u5148\u51fa\u961f\u5217\u3002","title":"tos_chr_fifo_destroy_dyn"},{"location":"05.SDK_Manual/#tos_chr_fifo_push","text":"k_err_t tos_chr_fifo_push(k_chr_fifo_t *chr_fifo, uint8_t data); \u529f\u80fd\u63cf\u8ff0 \u5411\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u538b\u5165\u4e00\u4e2a\u5b57\u7b26\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 [in] data \u538b\u5165\u7684\u5b57\u7b26 \u8fd4\u56de\u503c K_ERR_NONE \u5b57\u7b26\u538b\u5165\u6210\u529f\u3002 K_ERR_FIFO_FULL \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u5df2\u6ee1\u3002","title":"tos_chr_fifo_push"},{"location":"05.SDK_Manual/#tos_chr_fifo_push_stream","text":"k_err_t tos_chr_fifo_push_stream(k_chr_fifo_t *chr_fifo, uint8_t *stream, size_t size); \u529f\u80fd\u63cf\u8ff0 \u5411\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u538b\u5165\u4e00\u4e2a\u5b57\u7b26\u6d41\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 [in] stream \u538b\u5165\u7684\u5b57\u7b26\u6d41 [in] size \u5b57\u7b26\u6d41\u957f\u5ea6 \u8fd4\u56de\u503c \u5b9e\u9645\u538b\u5165\u7684\u5b57\u7b26\u6d41\u957f\u5ea6\u3002","title":"tos_chr_fifo_push_stream"},{"location":"05.SDK_Manual/#tos_chr_fifo_pop","text":"k_err_t tos_chr_fifo_pop(k_chr_fifo_t *chr_fifo, uint8_t *out); \u529f\u80fd\u63cf\u8ff0 \u4ece\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u5f39\u51fa\u4e00\u4e2a\u5b57\u7b26\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 [out] out \u5f39\u51fa\u7684\u5b57\u7b26 \u8fd4\u56de\u503c K_ERR_NONE \u5b57\u7b26\u5f39\u51fa\u6210\u529f\u3002 K_ERR_FIFO_EMPTY \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u5185\u5b58\u6c60\u5df2\u7a7a\u3002","title":"tos_chr_fifo_pop"},{"location":"05.SDK_Manual/#tos_chr_fifo_pop_stream","text":"int tos_chr_fifo_pop_stream(k_chr_fifo_t *fifo, uint8_t *buffer, size_t size); \u529f\u80fd\u63cf\u8ff0 \u4ece\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u5f39\u51fa\u4e00\u4e2a\u5b57\u7b26\u6d41\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 [out] stream \u5f39\u51fa\u7684\u5b57\u7b26\u6d41 [in] size \u5b57\u7b26\u6d41\u957f\u5ea6 \u8fd4\u56de\u503c \u5b9e\u9645\u5f39\u51fa\u7684\u5b57\u7b26\u6d41\u957f\u5ea6\u3002","title":"tos_chr_fifo_pop_stream"},{"location":"05.SDK_Manual/#tos_chr_fifo_flush","text":"void tos_chr_fifo_flush(k_chr_fifo_t *chr_fifo); \u529f\u80fd\u63cf\u8ff0 \u51b2\u6d17\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c \u65e0","title":"tos_chr_fifo_flush"},{"location":"05.SDK_Manual/#tos_chr_fifo_is_empty","text":"int tos_chr_fifo_is_empty(k_chr_fifo_t *chr_fifo); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u662f\u5426\u4e3a\u7a7a\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c 0\uff0cfifo\u4e0d\u4e3a\u7a7a\u3002 \u975e0\u503c\uff0cfifo\u4e3a\u7a7a\u3002","title":"tos_chr_fifo_is_empty"},{"location":"05.SDK_Manual/#tos_chr_fifo_is_full","text":"int tos_chr_fifo_is_full(k_chr_fifo_t *chr_fifo); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u662f\u5426\u4e3a\u6ee1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] chr_fifo \u5b57\u7b26\u6d41\u5148\u5165\u5148\u51fa\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c 0\uff0cfifo\u4e0d\u4e3a\u6ee1\u3002 \u975e0\u503c\uff0cfifo\u4e3a\u6ee1\u3002","title":"tos_chr_fifo_is_full"},{"location":"05.SDK_Manual/#binary-heap","text":"","title":"\u4e8c\u9879\u5806binary heap"},{"location":"05.SDK_Manual/#tos_bin_heap_create","text":"k_err_t tos_bin_heap_create(k_bin_heap_t *bin_heap, void *pool, size_t item_cnt, size_t item_size, k_bin_heap_cmp cmp); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u4e8c\u9879\u5806\u3002\u4e8c\u9879\u5806\u662f\u5b9e\u73b0\u4f18\u5148\u7ea7\u961f\u5217\u7684\u5e95\u5c42\u6570\u636e\u7ed3\u6784\u3002pool\u7531\u7528\u6237\u4f20\u5165\uff0cpool\u662f\u4e00\u7247\u5927\u5c0f\u4e3a(item_cnt * item_size)\u7684\u5185\u5b58buffer\uff0ccmp\u662f\u6bd4\u8f83\u4e24\u4e2a\u5143\u7d20\u5927\u5c0f\u7684\u6bd4\u8f83\u51fd\u6570\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bin_heap \u4e8c\u9879\u5806\u53e5\u67c4 [in] pool \u4e8c\u9879\u5806\u7684buffer\u6c60 [in] item_cnt \u4e8c\u9879\u5806\u7ba1\u7406\u7684\u5143\u7d20\u7684\u6570\u91cf [in] item_size \u4e8c\u9879\u5806\u7ba1\u7406\u7684\u5143\u7d20\u7684\u5927\u5c0f [in] cmp \u6bd4\u8f83\u4e24\u4e2a\u4e8c\u9879\u5806\u5143\u7d20\u5927\u5c0f\u7684\u63a5\u53e3 \u8fd4\u56de\u503c K_ERR_NONE \u4e8c\u9879\u5806\u521b\u5efa\u6210\u529f\u3002","title":"tos_bin_heap_create"},{"location":"05.SDK_Manual/#tos_bin_heap_create_dyn","text":"k_err_t tos_bin_heap_create_dyn(k_bin_heap_t *bin_heap, size_t item_cnt, size_t item_size, k_bin_heap_cmp cmp); \u529f\u80fd\u63cf\u8ff0 \u52a8\u6001\u521b\u5efa\u4e00\u4e2a\u4e8c\u9879\u5806\u3002\u5185\u90e8\u7684pool\u6c60\u7531\u52a8\u6001\u5185\u5b58\u5206\u914d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bin_heap \u73af\u5f62\u961f\u5217\u53e5\u67c4 [in] item_cnt \u6b64\u73af\u5f62\u961f\u5217\u7ba1\u7406\u7684\u5143\u7d20\u7684\u6570\u91cf [in] item_size \u4ece\u73af\u5f62\u961f\u5217\u7ba1\u7406\u7684\u5143\u7d20\u7684\u5927\u5c0f [in] cmp \u6bd4\u8f83\u4e24\u4e2a\u4e8c\u9879\u5806\u5143\u7d20\u5927\u5c0f\u7684\u63a5\u53e3 \u8fd4\u56de\u503c K_ERR_NONE \u4e8c\u9879\u5806\u521b\u5efa\u6210\u529f\u3002 K_ERR_OUT_OF_MEMORY \u5806\u5185\u5b58\u4e0d\u8db3\u3002","title":"tos_bin_heap_create_dyn"},{"location":"05.SDK_Manual/#tos_bin_heap_destroy","text":"k_err_t tos_bin_heap_destroy(k_bin_heap_t *bin_heap); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u4e8c\u9879\u5806\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bin_heap \u4e8c\u9879\u5806\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u9500\u6bc1\u4e8c\u9879\u5806\u6210\u529f\u3002 K_ERR_OBJ_INVALID bin_heap\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4e8c\u9879\u5806\u3002","title":"tos_bin_heap_destroy"},{"location":"05.SDK_Manual/#tos_bin_heap_destroy_dyn","text":"k_err_t tos_bin_heap_destroy_dyn(k_bin_heap_t *bin_heap); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u52a8\u6001\u521b\u5efa\u7684\u4e8c\u9879\u5806\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bin_heap \u4e8c\u9879\u5806\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u9500\u6bc1\u4e8c\u9879\u5806\u6210\u529f\u3002 K_ERR_OBJ_INVALID bin_heap\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4e8c\u9879\u5806\u3002","title":"tos_bin_heap_destroy_dyn"},{"location":"05.SDK_Manual/#tos_bin_heap_push","text":"k_err_t tos_bin_heap_push(k_bin_heap_t *bin_heap, void *item, size_t item_size); \u529f\u80fd\u63cf\u8ff0 \u5411\u4e8c\u9879\u5806\u4e2d\u653e\u5165\u4e00\u4e2a\u5143\u7d20\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bin_heap \u4e8c\u9879\u5806\u53e5\u67c4 [out] item \u5f85\u5165\u5806\u7684\u5143\u7d20\u5730\u5740 [out] item_size \u5f85\u5165\u5806\u7684\u5143\u7d20\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u5143\u7d20\u5165\u5806\u6210\u529f\u3002 K_ERR_BIN_HEAP_FULL \u4e8c\u9879\u5806\u5df2\u6ee1\u3002","title":"tos_bin_heap_push"},{"location":"05.SDK_Manual/#tos_bin_heap_pop","text":"k_err_t tos_bin_heap_pop(k_bin_heap_t *bin_heap, void *item, size_t *item_size); \u529f\u80fd\u63cf\u8ff0 \u4ece\u4e8c\u9879\u5806\u4e2d\u83b7\u53d6\u4e00\u4e2a\u5143\u7d20\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bin_heap \u4e8c\u9879\u5806\u53e5\u67c4 [out] item \u627f\u63a5\u51fa\u5806\u5143\u7d20\u7684\u5185\u5b58buffer [out] item_size \u51fa\u5806\u7684\u5143\u7d20\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u5143\u7d20\u51fa\u5806\u6210\u529f\u3002 K_ERR_BIN_HEAP_EMPTY \u4e8c\u9879\u5806\u5df2\u7a7a\u3002","title":"tos_bin_heap_pop"},{"location":"05.SDK_Manual/#tos_bin_heap_flush","text":"k_err_t tos_bin_heap_flush(k_bin_heap_t *bin_heap); \u529f\u80fd\u63cf\u8ff0 \u51b2\u6d17\u4e8c\u9879\u5806\uff08\u590d\u4f4d\u4e8c\u9879\u5806\uff0c\u4e22\u5f03\u4e8c\u9879\u5806\u4e2d\u7684\u6240\u6709\u5143\u7d20\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bin_heap \u4e8c\u9879\u5806\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u51b2\u6d17\u4e8c\u9879\u5806\u6210\u529f\u3002","title":"tos_bin_heap_flush"},{"location":"05.SDK_Manual/#tos_bin_heap_is_empty","text":"int tos_bin_heap_is_empty(k_bin_heap_t *bin_heap); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u4e00\u4e2a\u4e8c\u9879\u5806\u662f\u5426\u4e3a\u7a7a\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bin_heap \u4e8c\u9879\u5806\u53e5\u67c4 \u8fd4\u56de\u503c K_TRUE \u4e8c\u9879\u5806\u4e3a\u7a7a\u3002 K_FALSE \u4e8c\u9879\u5806\u975e\u7a7a\u3002","title":"tos_bin_heap_is_empty"},{"location":"05.SDK_Manual/#tos_bin_heap_is_full","text":"int tos_bin_heap_is_full(k_bin_heap_t *bin_heap); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u4e00\u4e2a\u4e8c\u9879\u5806\u662f\u5426\u4e3a\u6ee1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bin_heap \u4e8c\u9879\u5806\u53e5\u67c4 \u8fd4\u56de\u503c K_TRUE \u4e8c\u9879\u5806\u4e3a\u6ee1\u3002 K_FALSE \u4e8c\u9879\u5806\u975e\u6ee1\u3002","title":"tos_bin_heap_is_full"},{"location":"05.SDK_Manual/#priority-queue","text":"","title":"\u4f18\u5148\u7ea7\u961f\u5217priority queue"},{"location":"05.SDK_Manual/#tos_prio_q_create","text":"k_err_t tos_prio_q_create(k_prio_q_t *prio_q, void *mgr_array, void *pool, size_t item_cnt, size_t item_size); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u4f18\u5148\u7ea7\u961f\u5217\u3002\u4f18\u5148\u7ea7\u63d0\u4f9b\u4e86\u4e00\u79cd\u5bf9\u6570\u636e\u8fdb\u884c\u57fa\u4e8e\u4f18\u5148\u7ea7\u7ba1\u7406\u7684\u673a\u5236\uff0c\u6bcf\u6b21\u51fa\u961f\u7684\u603b\u662f\u961f\u5217\u4e2d\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u5143\u7d20\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u4e0a\u5c42\u6570\u636e\u7ed3\u6784\u6216\u7b97\u6cd5\u7684\u5e95\u5c42\u6570\u636e\u5bb9\u5668\u3002pool\u7531\u7528\u6237\u4f20\u5165\uff0cpool\u662f\u4e00\u7247\u5927\u5c0f\u4e3a(item_cnt * item_size)\u7684\u5185\u5b58buffer\uff0cmgr_array\u4e5f\u662f\u7531\u7528\u6237\u4f20\u5165\uff0c\u662f\u4e00\u7247\u5927\u5c0f\u4e3aTOS_PRIO_Q_MGR_ARRAY_SIZE(item_cnt)\u7684\u5185\u5b58buffer\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_q \u4f18\u5148\u7ea7\u961f\u5217\u53e5\u67c4 [in] mgr_array \u4f18\u5148\u7ea7\u961f\u5217\u7684\u5185\u90e8\u7ba1\u7406\u6570\u636e\u6c60 [in] pool \u4f18\u5148\u7ea7\u961f\u5217\u7684buffer\u6c60 [in] item_cnt \u4f18\u5148\u7ea7\u961f\u5217\u7ba1\u7406\u7684\u5143\u7d20\u7684\u6570\u91cf [in] item_size \u4f18\u5148\u7ea7\u961f\u5217\u7ba1\u7406\u7684\u5143\u7d20\u7684\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u961f\u5217\u521b\u5efa\u6210\u529f\u3002","title":"tos_prio_q_create"},{"location":"05.SDK_Manual/#tos_prio_q_create_dyn","text":"k_err_t tos_prio_q_create_dyn(k_prio_q_t *prio_q, size_t item_cnt, size_t item_size); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u52a8\u6001\u5206\u914d\u7684\u4f18\u5148\u7ea7\u961f\u5217\u3002\u4f18\u5148\u7ea7\u63d0\u4f9b\u4e86\u4e00\u79cd\u5bf9\u6570\u636e\u8fdb\u884c\u57fa\u4e8e\u4f18\u5148\u7ea7\u7ba1\u7406\u7684\u673a\u5236\uff0c\u6bcf\u6b21\u51fa\u961f\u7684\u603b\u662f\u961f\u5217\u4e2d\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u5143\u7d20\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u4e0a\u5c42\u6570\u636e\u7ed3\u6784\u6216\u7b97\u6cd5\u7684\u5e95\u5c42\u6570\u636e\u5bb9\u5668\u3002\u5185\u90e8\u7684pool\u6c60\u53ca\u7ba1\u7406\u6570\u636e\u6c60\u7531\u52a8\u6001\u5185\u5b58\u5206\u914d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_q \u4f18\u5148\u7ea7\u961f\u5217\u53e5\u67c4 [in] item_cnt \u4f18\u5148\u7ea7\u961f\u5217\u7ba1\u7406\u7684\u5143\u7d20\u7684\u6570\u91cf [in] item_size \u4f18\u5148\u7ea7\u961f\u5217\u7ba1\u7406\u7684\u5143\u7d20\u7684\u5927\u5c0f \u8fd4\u56de\u503c K_ERR_NONE \u4f18\u5148\u7ea7\u961f\u5217\u521b\u5efa\u6210\u529f\u3002 K_ERR_OUT_OF_MEMORY \u5806\u5185\u5b58\u4e0d\u8db3\u3002","title":"tos_prio_q_create_dyn"},{"location":"05.SDK_Manual/#tos_prio_q_destroy","text":"k_err_t tos_prio_q_destroy(k_prio_q_t *prio_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u4f18\u5148\u7ea7\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_q \u4f18\u5148\u7ea7\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u9500\u6bc1\u4f18\u5148\u7ea7\u961f\u5217\u6210\u529f\u3002 K_ERR_OBJ_INVALID prio_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4f18\u5148\u7ea7\u961f\u5217\u3002","title":"tos_prio_q_destroy"},{"location":"05.SDK_Manual/#tos_prio_q_destroy_dyn","text":"k_err_t tos_prio_q_destroy_dyn(k_prio_q_t *prio_q); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u52a8\u6001\u521b\u5efa\u7684\u4f18\u5148\u7ea7\u961f\u5217\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_q \u4f18\u5148\u7ea7\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u9500\u6bc1\u4f18\u5148\u7ea7\u961f\u5217\u6210\u529f\u3002 K_ERR_OBJ_INVALID prio_q\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4f18\u5148\u7ea7\u961f\u5217\u3002","title":"tos_prio_q_destroy_dyn"},{"location":"05.SDK_Manual/#tos_prio_q_enqueue","text":"k_err_t tos_prio_q_enqueue(k_prio_q_t *prio_q, void *item, size_t item_size, k_prio_t prio); \u529f\u80fd\u63cf\u8ff0 \u5411\u4f18\u5148\u7ea7\u961f\u5217\u4e2d\u653e\u5165\u4e00\u4e2a\u5143\u7d20\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_q \u4f18\u5148\u7ea7\u961f\u5217\u53e5\u67c4 [in] item \u5f85\u5165\u961f\u7684\u5143\u7d20\u5730\u5740 [in] item_size \u5f85\u5165\u961f\u7684\u5143\u7d20\u5927\u5c0f [in] prio \u5165\u961f\u5143\u7d20\u7684\u4f18\u5148\u7ea7 \u8fd4\u56de\u503c K_ERR_NONE \u5143\u7d20\u5165\u961f\u6210\u529f\u3002 K_ERR_PRIO_Q_FULL \u4f18\u5148\u7ea7\u961f\u5217\u5df2\u6ee1\u3002","title":"tos_prio_q_enqueue"},{"location":"05.SDK_Manual/#tos_prio_q_dequeue","text":"k_err_t tos_prio_q_dequeue(k_prio_q_t *prio_q, void *item, size_t *item_size, k_prio_t *prio); \u529f\u80fd\u63cf\u8ff0 \u4ece\u4f18\u5148\u7ea7\u961f\u5217\u4e2d\u83b7\u53d6\u4e00\u4e2a\u5143\u7d20\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_q \u4f18\u5148\u7ea7\u961f\u5217\u53e5\u67c4 [out] item \u627f\u63a5\u51fa\u961f\u5143\u7d20\u7684\u5185\u5b58buffer [out] item_size \u51fa\u961f\u7684\u5143\u7d20\u5927\u5c0f [out] prio \u51fa\u961f\u7684\u5143\u7d20\u7684\u4f18\u5148\u7ea7 \u8fd4\u56de\u503c K_ERR_NONE \u5143\u7d20\u51fa\u961f\u6210\u529f\u3002 K_ERR_PRIO_Q_EMPTY \u4f18\u5148\u7ea7\u961f\u5217\u5df2\u7a7a\u3002","title":"tos_prio_q_dequeue"},{"location":"05.SDK_Manual/#tos_prio_q_flush","text":"k_err_t tos_prio_q_flush(k_prio_q_t *prio_q); \u529f\u80fd\u63cf\u8ff0 \u51b2\u6d17\u4f18\u5148\u7ea7\u961f\u5217\uff08\u590d\u4f4d\u4f18\u5148\u7ea7\u961f\u5217\uff0c\u4e22\u5f03\u4f18\u5148\u7ea7\u961f\u5217\u4e2d\u7684\u6240\u6709\u5143\u7d20\uff09\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_q \u4f18\u5148\u7ea7\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u51b2\u6d17\u4f18\u5148\u7ea7\u961f\u5217\u6210\u529f\u3002","title":"tos_prio_q_flush"},{"location":"05.SDK_Manual/#tos_prio_q_is_empty","text":"int tos_prio_q_is_empty(k_prio_q_t *prio_q); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u4e00\u4e2a\u4f18\u5148\u7ea7\u961f\u5217\u662f\u5426\u4e3a\u7a7a\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_q \u4f18\u5148\u7ea7\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_TRUE \u4f18\u5148\u7ea7\u961f\u5217\u4e3a\u7a7a\u3002 K_FALSE \u4f18\u5148\u7ea7\u961f\u5217\u975e\u7a7a\u3002","title":"tos_prio_q_is_empty"},{"location":"05.SDK_Manual/#tos_prio_q_is_full","text":"int tos_prio_q_is_full(k_prio_q_t *prio_q); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u4e00\u4e2a\u4f18\u5148\u7ea7\u961f\u5217\u662f\u5426\u4e3a\u6ee1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] prio_q \u4f18\u5148\u7ea7\u961f\u5217\u53e5\u67c4 \u8fd4\u56de\u503c K_TRUE \u4f18\u5148\u7ea7\u961f\u5217\u4e3a\u6ee1\u3002 K_FALSE \u4f18\u5148\u7ea7\u961f\u5217\u975e\u6ee1\u3002","title":"tos_prio_q_is_full"},{"location":"05.SDK_Manual/#timer","text":"","title":"\u5b9a\u65f6\u5668timer"},{"location":"05.SDK_Manual/#tos_timer_create","text":"k_err_t tos_timer_create(k_timer_t *tmr, k_tick_t delay, k_tick_t period, k_timer_callback_t callback, void *cb_arg, k_opt_t opt); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u5b9a\u65f6\u5668\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] tmr \u5b9a\u65f6\u5668\u53e5\u67c4 [in] delay \u5b9a\u65f6\u5668\u5ef6\u8fdf\u591a\u4e45\u540e\u6267\u884c [in] period \u5468\u671f\u6027timer\u7684\u5468\u671f [in] callback \u5b9a\u65f6\u5668\u56de\u8c03 [in] cb_arg \u5b9a\u65f6\u5668\u56de\u8c03\u53c2\u6570 [in] opt \u9009\u9879 \u6ce8\u610f opt\u9009\u9879\u8bf4\u660e\uff1a 1\u3001TOS_OPT_TIMER_ONESHOT \u200b \u4e00\u6b21\u6027\u5b9a\u65f6\u5668\uff0c\u521b\u5efa\u5b9a\u65f6\u5668\u65f6\u4f20\u5165\u6b64\u53c2\u6570\uff0c\u8868\u793a\u8be5\u5b9a\u65f6\u5668\u662f\u4e00\u6b21\u6027\u7684\uff0c\u53ea\u4f1a\u6267\u884c\u4e00\u6b21\u3002 2\u3001TOS_OPT_TIMER_PERIODIC \u200b \u5468\u671f\u6027\u5b9a\u65f6\u5668\uff0c\u521b\u5efa\u5b9a\u65f6\u5668\u65f6\u4f20\u5165\u6b64\u53c2\u6570\uff0c\u8868\u793a\u8be5\u5b9a\u65f6\u5668\u662f\u5468\u671f\u6027\u7684\uff0c\u5b9a\u65f6\u5668\u5230\u671f\u540e\uff0c\u4f1a\u6309period\u53c2\u6570\u5f00\u542f\u4e0b\u4e00\u4e2a\u5468\u671f\u3002 \u8fd4\u56de\u503c K_ERR_NONE \u5b9a\u65f6\u5668\u521b\u5efa\u6210\u529f\u3002 K_ERR_TIMER_INVALID_PERIOD \u975e\u6cd5\u7684period\u53c2\u6570\u3002 K_ERR_TIMER_INVALID_DELAY \u975e\u6cd5\u7684delay\u53c2\u6570\u3002","title":"tos_timer_create"},{"location":"05.SDK_Manual/#tos_timer_destroy","text":"k_err_t tos_timer_destroy(k_timer_t *tmr); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u5b9a\u65f6\u5668\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] tmr \u5b9a\u65f6\u5668\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u5b9a\u65f6\u5668\u542f\u52a8\u6210\u529f\u3002 K_ERR_TIMER_INACTIVE \u5b9a\u65f6\u5668\u5e76\u672a\u88ab\u521b\u5efa\u3002","title":"tos_timer_destroy"},{"location":"05.SDK_Manual/#tos_timer_start","text":"k_err_t tos_timer_start(k_timer_t *tmr); \u529f\u80fd\u63cf\u8ff0 \u542f\u52a8\u4e00\u4e2a\u5b9a\u65f6\u5668\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] tmr \u5b9a\u65f6\u5668\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u5b9a\u65f6\u5668\u542f\u52a8\u6210\u529f\u3002 K_ERR_TIMER_INACTIVE \u5b9a\u65f6\u5668\u5e76\u672a\u88ab\u521b\u5efa\u3002 K_ERR_TIMER_INVALID_STATE \u5b9a\u65f6\u5668\u72b6\u6001\u975e\u6cd5\u3002","title":"tos_timer_start"},{"location":"05.SDK_Manual/#tos_timer_stop","text":"k_err_t tos_timer_stop(k_timer_t *tmr); \u529f\u80fd\u63cf\u8ff0 \u505c\u6b62\u4e00\u4e2a\u5b9a\u65f6\u5668\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] tmr \u5b9a\u65f6\u5668\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u505c\u6b62\u5b9a\u65f6\u5668\u6210\u529f\u3002 K_ERR_TIMER_INACTIVE \u5b9a\u65f6\u5668\u5e76\u672a\u88ab\u521b\u5efa\u3002 K_ERR_TIMER_STOPPED \u5b9a\u65f6\u5668\u5df2\u7ecf\u5904\u4e8e\u505c\u6b62\u72b6\u6001\u3002","title":"tos_timer_stop"},{"location":"05.SDK_Manual/#tos_timer_delay_change","text":"k_err_t tos_timer_delay_change(k_timer_t *tmr, k_tick_t delay); \u529f\u80fd\u63cf\u8ff0 \u4fee\u6539\u4e00\u4e2a\u5b9a\u65f6\u5668\u7684\u89e6\u53d1\u5ef6\u65f6\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] tmr \u5b9a\u65f6\u5668\u53e5\u67c4 [in] delay \u4fee\u6539\u540e\u7684\u89e6\u53d1\u5ef6\u65f6\u53c2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u4fee\u6539\u5b9a\u65f6\u5668\u89e6\u53d1\u5ef6\u65f6\u6210\u529f\u3002 K_ERR_TIMER_INACTIVE \u5b9a\u65f6\u5668\u5e76\u672a\u88ab\u521b\u5efa\u3002 K_ERR_TIMER_RUNNING \u5b9a\u65f6\u5668\u6b63\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\uff08\u4e0d\u5141\u8bb8\u4fee\u6539\u8fd0\u884c\u4e2d\u7684\u5b9a\u65f6\u5668\u7684\u89e6\u53d1\u5ef6\u65f6\u53c2\u6570\uff09\u3002 K_ERR_TIMER_INVALID_DELAY \u975e\u6cd5\u7684delay\u53c2\u6570\uff08\u8bd5\u56fe\u5c06\u4e00\u4e2a\u4e00\u6b21\u6027\u5b9a\u65f6\u5668\u7684delay\u53c2\u6570\u4fee\u6539\u4e3a0\uff09\u3002","title":"tos_timer_delay_change"},{"location":"05.SDK_Manual/#tos_timer_period_change","text":"k_err_t tos_timer_period_change(k_timer_t *tmr, k_tick_t perio); \u529f\u80fd\u63cf\u8ff0 \u4fee\u6539\u4e00\u4e2a\u5b9a\u65f6\u5668\u7684\u89e6\u53d1\u5468\u671f\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] tmr \u5b9a\u65f6\u5668\u53e5\u67c4 [in] period \u4fee\u6539\u540e\u7684\u89e6\u53d1\u5468\u671f\u53c2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u4fee\u6539\u5b9a\u65f6\u5668\u89e6\u53d1\u5468\u671f\u6210\u529f\u3002 K_ERR_TIMER_INACTIVE \u5b9a\u65f6\u5668\u5e76\u672a\u88ab\u521b\u5efa\u3002 K_ERR_TIMER_RUNNING \u5b9a\u65f6\u5668\u6b63\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\uff08\u4e0d\u5141\u8bb8\u4fee\u6539\u8fd0\u884c\u4e2d\u7684\u5b9a\u65f6\u5668\u7684\u89e6\u53d1\u5ef6\u65f6\u53c2\u6570\uff09\u3002 K_ERR_TIMER_INVALID_PERIOD \u975e\u6cd5\u7684period\u53c2\u6570\uff08\u8bd5\u56fe\u5c06\u4e00\u4e2a\u5468\u671f\u6027\u5b9a\u65f6\u5668\u7684period\u53c2\u6570\u4fee\u6539\u4e3a0\uff09\u3002","title":"tos_timer_period_change"},{"location":"05.SDK_Manual/#stopwatch","text":"","title":"\u8ba1\u65f6\u8868stopwatch"},{"location":"05.SDK_Manual/#tos_stopwatch_create","text":"k_err_t tos_stopwatch_create(k_stopwatch_t *stopwatch); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u8ba1\u65f6\u8868\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] stopwatch \u8ba1\u65f6\u8868\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u8ba1\u65f6\u8868\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL stopwatch\u662f\u7a7a\u6307\u9488\u3002","title":"tos_stopwatch_create"},{"location":"05.SDK_Manual/#tos_stopwatch_destroy","text":"k_err_t tos_stopwatch_destroy(k_stopwatch_t *stopwatch); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u8ba1\u65f6\u8868\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] stopwatch \u8ba1\u65f6\u8868\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u8ba1\u65f6\u8868\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL stopwatch\u662f\u7a7a\u6307\u9488\u3002 K_ERR_OBJ_INVALID stopwatch\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u8ba1\u65f6\u8868\u3002","title":"tos_stopwatch_destroy"},{"location":"05.SDK_Manual/#tos_stopwatch_countdown","text":"k_err_t tos_stopwatch_countdown(k_stopwatch_t *stopwatch, k_tick_t tick); \u529f\u80fd\u63cf\u8ff0 \u5f00\u59cb\u8ba1\u65f6\uff0c\u65f6\u95f4\u5355\u4f4d\u4e3a\u7cfb\u7edf\u6ef4\u7b54\u6570\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] stopwatch \u5b9a\u65f6\u5668\u53e5\u67c4 [in] tick \u8ba1\u65f6\u7684\u65f6\u95f4\u957f\u5ea6 \u8fd4\u56de\u503c K_ERR_NONE \u8ba1\u65f6\u8868\u542f\u52a8\u6210\u529f\u3002","title":"tos_stopwatch_countdown"},{"location":"05.SDK_Manual/#tos_stopwatch_countdown_ms","text":"k_err_t tos_stopwatch_countdown_ms(k_stopwatch_t *stopwatch, k_time_t millisec); \u529f\u80fd\u63cf\u8ff0 \u5f00\u59cb\u8ba1\u65f6\uff0c\u65f6\u95f4\u5355\u4f4d\u4e3a\u6beb\u79d2\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] stopwatch \u5b9a\u65f6\u5668\u53e5\u67c4 [in] millisec \u8ba1\u65f6\u7684\u65f6\u95f4\u957f\u5ea6 \u8fd4\u56de\u503c K_ERR_NONE \u8ba1\u65f6\u8868\u542f\u52a8\u6210\u529f\u3002","title":"tos_stopwatch_countdown_ms"},{"location":"05.SDK_Manual/#tos_stopwatch_delay","text":"void tos_stopwatch_delay(k_tick_t tick); \u529f\u80fd\u63cf\u8ff0 \u5229\u7528\u8ba1\u65f6\u8868\u8fdb\u884c\u4e00\u6b21\u5ef6\u65f6\uff0c\u65f6\u95f4\u5355\u4f4d\u4e3a\u7cfb\u7edf\u6ef4\u7b54\u6570\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] stopwatch \u5b9a\u65f6\u5668\u53e5\u67c4 [in] tick \u5ef6\u8fdf\u7684\u65f6\u95f4\u957f\u5ea6","title":"tos_stopwatch_delay"},{"location":"05.SDK_Manual/#tos_stopwatch_delay_ms","text":"void tos_stopwatch_delay_ms(k_time_t millisec); \u529f\u80fd\u63cf\u8ff0 \u5229\u7528\u8ba1\u65f6\u8868\u8fdb\u884c\u4e00\u6b21\u5ef6\u65f6\uff0c\u65f6\u95f4\u5355\u4f4d\u4e3a\u6beb\u79d2\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] stopwatch \u5b9a\u65f6\u5668\u53e5\u67c4 [in] millisec \u5ef6\u8fdf\u7684\u65f6\u95f4\u957f\u5ea6","title":"tos_stopwatch_delay_ms"},{"location":"05.SDK_Manual/#tos_stopwatch_remain","text":"k_tick_t tos_stopwatch_remain(k_stopwatch_t *stopwatch); \u529f\u80fd\u63cf\u8ff0 \u8fd4\u56de\u8ba1\u65f6\u8868\u5269\u4f59\u7684\u65f6\u95f4\uff0c\u65f6\u95f4\u5355\u4f4d\u4e3a\u7cfb\u7edf\u6ef4\u7b54\u6570\uff0c\u5982\u679c\u8ba1\u65f6\u5df2\u5230\u5219\u8fd4\u56de0\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] stopwatch \u5b9a\u65f6\u5668\u53e5\u67c4 \u8fd4\u56de\u503c \u8ba1\u65f6\u8868\u5269\u4f59\u65f6\u95f4\u3002","title":"tos_stopwatch_remain"},{"location":"05.SDK_Manual/#tos_stopwatch_remain_ms","text":"k_tick_t tos_stopwatch_remain_ms(k_stopwatch_t *stopwatch); \u529f\u80fd\u63cf\u8ff0 \u8fd4\u56de\u8ba1\u65f6\u8868\u5269\u4f59\u7684\u65f6\u95f4\uff0c\u65f6\u95f4\u5355\u4f4d\u4e3a\u6beb\u79d2\uff0c\u5982\u679c\u8ba1\u65f6\u5df2\u5230\u5219\u8fd4\u56de0\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] stopwatch \u5b9a\u65f6\u5668\u53e5\u67c4 \u8fd4\u56de\u503c \u8ba1\u65f6\u8868\u5269\u4f59\u65f6\u95f4\u3002","title":"tos_stopwatch_remain_ms"},{"location":"05.SDK_Manual/#tos_stopwatch_is_expired","text":"int tos_stopwatch_is_expired(k_stopwatch_t *stopwatch); \u529f\u80fd\u63cf\u8ff0 \u8fd4\u56de\u8ba1\u65f6\u8868\u662f\u5426\u5df2\u8d85\u65f6\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] stopwatch \u5b9a\u65f6\u5668\u53e5\u67c4 \u8fd4\u56de\u503c K_TRUE \u8ba1\u65f6\u8868\u5df2\u8d85\u65f6\u3002 K_FALSE \u8ba1\u65f6\u8868\u672a\u8d85\u65f6\u3002","title":"tos_stopwatch_is_expired"},{"location":"05.SDK_Manual/#bitmap","text":"","title":"\u4f4d\u56febitmap"},{"location":"05.SDK_Manual/#tos_bitmap_create_empty","text":"__API__ k_err_t tos_bitmap_create_empty(k_bitmap_t *bitmap, k_bmtbl_t *bitmap_tbl, uint32_t bit_max); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u51680\u7684\u4f4d\u56fe\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bitmap \u4f4d\u56fe\u53e5\u67c4 [in] bitmap_tbl \u4f4d\u56fe\u6240\u9700\u7684\u5b58\u50a8\u8868\u3002 [in] bit_max \u4f4d\u56fe\u4e2d\u53ef\u8bb0\u5f55\u7684\u6700\u5927\u7684bit\u4f4d\u957f\u5ea6 \u6ce8\u610f bitmap_tbl\u662f\u7531\u7528\u6237\u4f20\u5165\u7684\u4e00\u7247\u5185\u5b58\u533a\u57df\uff0c\u5176\u957f\u5ea6\u7531TOS_BITMAP_SIZE\u8ba1\u7b97\uff0c\u5bf9\u4e8e\u6700\u5927\u7684bit\u4f4d\u957f\u5ea6\u4e3abit_max\u7684\u4f4d\u56fe\u5b58\u50a8\u8868\u6765\u8bf4\uff0c\u5176\u957f\u5ea6\u4e3aTOS_BITMAP_SIZE(bit_max)\uff0c\u90a3\u4e48\u7528\u6237\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2ak_bmtbl_t bitmap_tbl[TOS_BITMAP_SIZE(bit_max)]\uff0cbitmap_tbl\u4f5c\u4e3a\u6b64\u63a5\u53e3\u7684\u7b2c\u4e8c\u4e2a\u5165\u53c2\u3002 \u8fd4\u56de\u503c** K_ERR_NONE \u8ba1\u65f6\u8868\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL bitmap\u6216bitmap_tbl\u662f\u7a7a\u6307\u9488\u3002","title":"tos_bitmap_create_empty"},{"location":"05.SDK_Manual/#tos_bitmap_create_full","text":"__API__ k_err_t tos_bitmap_create_full(k_bitmap_t *bitmap, k_bmtbl_t *bitmap_tbl, uint32_t bit_max); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u51681\u7684\u4f4d\u56fe\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bitmap \u4f4d\u56fe\u53e5\u67c4 [in] bitmap_tbl \u4f4d\u56fe\u6240\u9700\u7684\u5b58\u50a8\u8868\u3002 [in] bit_max \u4f4d\u56fe\u4e2d\u53ef\u8bb0\u5f55\u7684\u6700\u5927\u7684bit\u4f4d\u957f\u5ea6 \u6ce8\u610f bitmap_tbl\u662f\u7531\u7528\u6237\u4f20\u5165\u7684\u4e00\u7247\u5185\u5b58\u533a\u57df\uff0c\u5176\u957f\u5ea6\u7531TOS_BITMAP_SIZE\u8ba1\u7b97\uff0c\u5bf9\u4e8e\u6700\u5927\u7684bit\u4f4d\u957f\u5ea6\u4e3abit_max\u7684\u4f4d\u56fe\u5b58\u50a8\u8868\u6765\u8bf4\uff0c\u5176\u957f\u5ea6\u4e3aTOS_BITMAP_SIZE(bit_max)\uff0c\u90a3\u4e48\u7528\u6237\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2ak_bmtbl_t bitmap_tbl[TOS_BITMAP_SIZE(bit_max)]\uff0cbitmap_tbl\u4f5c\u4e3a\u6b64\u63a5\u53e3\u7684\u7b2c\u4e8c\u4e2a\u5165\u53c2\u3002 \u8fd4\u56de\u503c** K_ERR_NONE \u8ba1\u65f6\u8868\u521b\u5efa\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL bitmap\u6216bitmap_tbl\u662f\u7a7a\u6307\u9488\u3002","title":"tos_bitmap_create_full"},{"location":"05.SDK_Manual/#tos_bitmap_destroy","text":"k_err_t tos_bitmap_destroy(k_bitmap_t *bitmap); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e00\u4e2a\u4f4d\u56fe\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bitmap \u4f4d\u56fe\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u4f4d\u56fe\u9500\u6bc1\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL bitmap\u662f\u7a7a\u6307\u9488\u3002 K_ERR_OBJ_INVALID bitmap\u6307\u5411\u7684\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u4f4d\u56fe\u3002","title":"tos_bitmap_destroy"},{"location":"05.SDK_Manual/#tos_bitmap_set","text":"k_err_t tos_bitmap_set(k_bitmap_t *bitmap, uint32_t bit); \u529f\u80fd\u63cf\u8ff0 \u8bbe\u7f6e\u4e00\u4e2abit\u4f4d\uff0c\u5373\u5c06\u6b64bit\u4f4d\u6807\u8bb0\u4e3a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bitmap \u4f4d\u56fe\u53e5\u67c4 [in] bit \u8981\u8bbe\u7f6e\u7684bit\u4f4d \u8fd4\u56de\u503c K_ERR_NONE bit\u4f4d\u8bbe\u7f6e\u6210\u529f\u3002 K_ERR_BITMAP_EXCEED bit\u8d85\u51fa\u4e86bitmap\u53ef\u4ee5\u8bb0\u5f55\u7684\u8303\u56f4\u3002","title":"tos_bitmap_set"},{"location":"05.SDK_Manual/#tos_bitmap_reset","text":"k_err_t tos_bitmap_reset(k_bitmap_t *bitmap, uint32_t bit); \u529f\u80fd\u63cf\u8ff0 \u590d\u4f4d\u4e00\u4e2abit\u4f4d\uff0c\u5373\u5c06\u6b64bit\u4f4d\u6807\u8bb0\u4e3a0\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bitmap \u4f4d\u56fe\u53e5\u67c4 [in] bit \u8981\u8bbe\u7f6e\u7684bit\u4f4d \u8fd4\u56de\u503c K_ERR_NONE bit\u4f4d\u590d\u4f4d\u6210\u529f\u3002 K_ERR_BITMAP_EXCEED bit\u8d85\u51fa\u4e86bitmap\u53ef\u4ee5\u8bb0\u5f55\u7684\u8303\u56f4\u3002","title":"tos_bitmap_reset"},{"location":"05.SDK_Manual/#tos_bitmap_is_set","text":"k_err_t tos_bitmap_is_set(k_bitmap_t *bitmap, uint32_t bit); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u67d0bit\u4f4d\u662f\u5426\u5904\u4e8e\u8bbe\u7f6e\u72b6\u6001\uff0c\u4e5f\u5373\u662f\u5426\u4e3a1\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bitmap \u4f4d\u56fe\u53e5\u67c4 [in] bit bit\u4f4d \u8fd4\u56de\u503c K_TRUE \u8be5\u4f4d\u88ab\u8bbe\u7f6e\uff0c\u5373\u4e3a1\u3002 K_FALSE \u8be5\u4f4d\u672a\u88ab\u8bbe\u7f6e\uff0c\u5373\u4e3a0\u3002 K_ERR_BITMAP_EXCEED bit\u8d85\u51fa\u4e86bitmap\u53ef\u4ee5\u8bb0\u5f55\u7684\u8303\u56f4\u3002","title":"tos_bitmap_is_set"},{"location":"05.SDK_Manual/#tos_bitmap_is_reset","text":"k_err_t tos_bitmap_is_reset(k_bitmap_t *bitmap, uint32_t bit); \u529f\u80fd\u63cf\u8ff0 \u5224\u65ad\u67d0bit\u4f4d\u662f\u5426\u5904\u4e8e\u590d\u4f4d\u72b6\u6001\uff0c\u4e5f\u5373\u662f\u5426\u4e3a0\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bitmap \u4f4d\u56fe\u53e5\u67c4 [in] bit bit\u4f4d \u8fd4\u56de\u503c K_TRUE \u8be5\u4f4d\u88ab\u590d\u4f4d\uff0c\u5373\u4e3a0\u3002 K_FALSE \u8be5\u4f4d\u672a\u88ab\u8bbe\u7f6e\uff0c\u5373\u4e3a1\u3002","title":"tos_bitmap_is_reset"},{"location":"05.SDK_Manual/#tos_bitmap_lsb","text":"int tos_bitmap_lsb(k_bitmap_t *bitmap); \u529f\u80fd\u63cf\u8ff0 \u83b7\u53d6\u4f4d\u56fe\u7684\u6700\u4f4e\u6709\u6548\u4f4d\uff0c\u4e5f\u5373\u6700\u4f4e\u7684\u88ab\u8bbe\u7f6e\u4e3a1\u7684\u4f4d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] bitmap \u5b9a\u65f6\u5668\u53e5\u67c4 \u8fd4\u56de\u503c \u4f4d\u56fe\u7684\u6700\u4f4e\u6709\u6548\u4f4d\u3002","title":"tos_bitmap_lsb"},{"location":"05.SDK_Manual/#_5","text":"","title":"\u65f6\u95f4\u7ba1\u7406"},{"location":"05.SDK_Manual/#tos_systick_get","text":"k_tick_t tos_systick_get(void); \u529f\u80fd\u63cf\u8ff0 \u83b7\u53d6\u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570\u3002 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c \u7cfb\u7edf\u81ea\u542f\u52a8\u4e3a\u6b62\u5230\u76ee\u524d\u4e3a\u6b62\u7684\u65f6\u949f\u6ef4\u7b54\u6570\u3002","title":"tos_systick_get"},{"location":"05.SDK_Manual/#tos_systick_set","text":"void tos_systick_set(k_tick_t tick); \u529f\u80fd\u63cf\u8ff0 \u8bbe\u7f6e\u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] tick \u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570 \u8fd4\u56de\u503c \u65e0","title":"tos_systick_set"},{"location":"05.SDK_Manual/#tos_tick2millisec","text":"k_time_t tos_tick2millisec(k_tick_t tick); \u529f\u80fd\u63cf\u8ff0 \u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570\u8f6c\u5316\u4e3a\u6beb\u79d2\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] tick \u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570 \u8fd4\u56de\u503c \u6beb\u79d2\u6570\u3002","title":"tos_tick2millisec"},{"location":"05.SDK_Manual/#tos_millisec2tick","text":"k_tick_t tos_millisec2tick(k_time_t millisec); \u529f\u80fd\u63cf\u8ff0 \u6beb\u79d2\u8f6c\u5316\u4e3a\u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] millisec \u6beb\u79d2\u6570 \u8fd4\u56de\u503c \u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570\u3002","title":"tos_millisec2tick"},{"location":"05.SDK_Manual/#tos_sleep_ms","text":"k_err_t tos_sleep_ms(k_time_t millisec); \u529f\u80fd\u63cf\u8ff0 \u7761\u7720\u5f53\u524d\u4efb\u52a1\uff0c\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] millisec \u4efb\u52a1\u7761\u7720\u6beb\u79d2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u7761\u7720\u6210\u529f\u3002 K_ERR_DELAY_ZERO \u6beb\u79d2\u6570\u4e3a0\u3002","title":"tos_sleep_ms"},{"location":"05.SDK_Manual/#tos_sleep_hmsm","text":"k_err_t tos_sleep_hmsm(k_time_t hour, k_time_t minute, k_time_t second, k_time_t millisec); \u529f\u80fd\u63cf\u8ff0 \u7761\u7720\u5f53\u524d\u4efb\u52a1\uff0c\u7761\u7720\u65f6\u957f\u4ee5\u7279\u5b9a\u7684\u65f6\u5206\u79d2\u6beb\u79d2\u5ea6\u91cf\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] hour \u5c0f\u65f6\u6570 [in] minute \u5206\u949f\u6570 [in] second \u79d2\u6570 [in] millisec \u6beb\u79d2\u6570 \u8fd4\u56de\u503c K_ERR_NONE \u7761\u7720\u6210\u529f\u3002 K_ERR_DELAY_ZERO \u6beb\u79d2\u6570\u4e3a0\u3002","title":"tos_sleep_hmsm"},{"location":"05.SDK_Manual/#_6","text":"","title":"\u529f\u8017\u7ba1\u7406"},{"location":"05.SDK_Manual/#tos_pm_cpu_lpwr_mode_set","text":"k_err_t tos_pm_cpu_lpwr_mode_set(k_cpu_lpwr_mode_t cpu_lpwr_mode); \u529f\u80fd\u63cf\u8ff0 \u8bbe\u7f6eCPU\u7684\u4f4e\u529f\u8017\u6a21\u5f0f\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] cpu_lpwr_mode CPU\u7684\u4f4e\u529f\u8017\u6a21\u5f0f \u8fd4\u56de\u503c K_ERR_PM_WKUP_SOURCE_NOT_INSTALL \u5bf9\u5e94\u4f4e\u529f\u8017\u6a21\u5f0f\u4e0b\u7684\u5524\u9192\u6e90\u6ca1\u6709\u5b89\u88c5\u3002 K_ERR_NONE \u4f4e\u529f\u8017\u6a21\u5f0f\u8bbe\u7f6e\u6210\u529f\u3002","title":"tos_pm_cpu_lpwr_mode_set"},{"location":"05.SDK_Manual/#tos_pm_device_register","text":"int tos_pm_device_register(k_pm_device_t *device); \u529f\u80fd\u63cf\u8ff0 \u6ce8\u518c\u4e00\u4e2a\u4f4e\u529f\u8017\u7ba1\u7406\u8bbe\u5907\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] device \u4f4e\u529f\u8017\u7ba1\u7406\u8bbe\u5907\u53e5\u67c4 \u8fd4\u56de\u503c K_ERR_NONE \u6ce8\u518c\u6210\u529f\u3002 K_ERR_OBJ_PTR_NULL device\u4e3a\u7a7a\u3002 K_ERR_PM_DEVICE_ALREADY_REG \u8bbe\u5907\u5df2\u6ce8\u518c\u8fc7\u3002 K_ERR_PM_DEVICE_OVERFLOW \u6ce8\u518c\u8bbe\u5907\u6570\u91cf\u592a\u591a\u3002","title":"tos_pm_device_register"},{"location":"05.SDK_Manual/#tos_tickless_wkup_alarm_install","text":"void tos_tickless_wkup_alarm_install(k_cpu_lpwr_mode_t mode, k_tickless_wkup_alarm_t *wkup_alarm); \u529f\u80fd\u63cf\u8ff0 \u5b89\u88c5\u4e00\u4e2a\u4f4e\u529f\u8017\u6a21\u5f0f\u4e0b\u7684\u5524\u9192\u65f6\u949f\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mode \u4f4e\u529f\u8017\u6a21\u5f0f [in] wkup_alarm \u5524\u9192\u65f6\u949f \u8fd4\u56de\u503c \u65e0","title":"tos_tickless_wkup_alarm_install"},{"location":"05.SDK_Manual/#tos_tickless_wkup_alarm_init","text":"int tos_tickless_wkup_alarm_init(k_cpu_lpwr_mode_t mode); \u529f\u80fd\u63cf\u8ff0 \u521d\u59cb\u5316\u7279\u5b9a\u4f4e\u529f\u8017\u6a21\u5f0f\u4e0b\u7684\u5524\u9192\u65f6\u949f\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mode \u4f4e\u529f\u8017\u6a21\u5f0f \u8fd4\u56de\u503c K_ERR_TICKLESS_WKUP_ALARM_NOT_INSTALLED \u5bf9\u5e94\u4f4e\u529f\u8017\u6a21\u5f0f\u7684\u5524\u9192\u95f9\u949f\u6ca1\u6709\u88ab\u5b89\u88c5 K_ERR_TICKLESS_WKUP_ALARM_NO_INIT \u5bf9\u5e94\u4f4e\u529f\u8017\u6a21\u5f0f\u7684\u5524\u9192\u95f9\u949f\u6ca1\u6709\u521d\u59cb\u5316\u51fd\u6570","title":"tos_tickless_wkup_alarm_init"},{"location":"05.SDK_Manual/#api_1","text":"","title":"\u7ec4\u4ef6API"},{"location":"05.SDK_Manual/#mqtt","text":"","title":"MQTT\u7aef\u4e91\u5bf9\u63a5"},{"location":"05.SDK_Manual/#tos_mqtt_connect","text":"int tos_mqtt_connect(char *host, const char *port, mqtt_con_param_t *param); \u529f\u80fd\u63cf\u8ff0 \u8fde\u63a5MQTT\u670d\u52a1\u5668\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] host \u670d\u52a1\u5668IP\u5730\u5740\u6216\u57df\u540d [in] port \u670d\u52a1\u5668\u7aef\u53e3 [in] param \u8fde\u63a5\u53c2\u6570 \u8fd4\u56de\u503c \u6210\u529f\uff0c\u8fd4\u56desocket fd\u3002 \u5931\u8d25\uff0c\u8fd4\u56de-1\u3002","title":"tos_mqtt_connect"},{"location":"05.SDK_Manual/#tos_mqtt_publish","text":"int tos_mqtt_publish(int sock, mqtt_pub_param_t *param); \u529f\u80fd\u63cf\u8ff0 \u53d1\u5e03MQTT\u6d88\u606f \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sock socket fd\uff0c\u7531tos_mqtt_connect\u83b7\u53d6\u3002 [in] param \u6d88\u606f\u53d1\u5e03\u53c2\u6570 \u8fd4\u56de\u503c 0\uff0c\u53d1\u5e03\u6210\u529f\u3002 -1\uff0c\u53d1\u5e03\u5931\u8d25\u3002","title":"tos_mqtt_publish"},{"location":"05.SDK_Manual/#tos_mqtt_subscribe","text":"int tos_mqtt_subscribe(int sock, mqtt_sub_param_t *param); \u529f\u80fd\u63cf\u8ff0 \u8ba2\u9605MQTT\u6d88\u606f \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sock socket fd\uff0c\u7531tos_mqtt_connect\u83b7\u53d6\u3002 [in] param \u6d88\u606f\u8ba2\u9605\u53c2\u6570 \u8fd4\u56de\u503c 0\uff0c\u8ba2\u9605\u6210\u529f\u3002 -1\uff0c\u8ba2\u9605\u5931\u8d25\u3002","title":"tos_mqtt_subscribe"},{"location":"05.SDK_Manual/#tos_mqtt_receive","text":"int tos_mqtt_receive(char *topic, int topic_len, unsigned char *payload, int payload_len); \u529f\u80fd\u63cf\u8ff0 \u6536\u53d6MQTT\u6d88\u606f \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [out] topic \u6536\u53d6\u5230\u7684MQTT topic [in] topic_len MQTT topic buffer\u957f\u5ea6 [out] payload \u6536\u53d6\u5230\u7684payload [in] payload_len payload buffer\u957f\u5ea6 \u8fd4\u56de\u503c \u6210\u529f\uff0c\u8fd4\u56de\u6536\u53d6\u5230\u7684payload\u957f\u5ea6\u3002 \u5931\u8d25\uff0c\u8fd4\u56de-1\u3002","title":"tos_mqtt_receive"},{"location":"05.SDK_Manual/#cmsis","text":"","title":"CMSIS\u9002\u914d\u5c42"},{"location":"05.SDK_Manual/#oskernelstart","text":"osStatus osKernelStart(void); \u529f\u80fd\u63cf\u8ff0 \u542f\u52a8\u5185\u6838 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"osKernelStart"},{"location":"05.SDK_Manual/#oskernelinitialize","text":"osStatus osKernelInitialize(void); \u529f\u80fd\u63cf\u8ff0 \u521d\u59cb\u5316\u5185\u6838 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"osKernelInitialize"},{"location":"05.SDK_Manual/#oskernelrunning","text":"int32_t osKernelRunning(void); \u529f\u80fd\u63cf\u8ff0 \u8fd4\u56de\u5185\u6838\u662f\u5426\u6b63\u5728\u8fd0\u884c \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c 0\uff0c\u5185\u6838\u4e0d\u5728\u8fd0\u884c\u3002 \u975e0\uff0c\u5185\u6838\u6b63\u5728\u8fd0\u884c\u3002","title":"osKernelRunning"},{"location":"05.SDK_Manual/#oskernelsystick","text":"uint32_t osKernelSysTick(void); \u529f\u80fd\u63cf\u8ff0 \u83b7\u53d6\u7cfb\u7edf\u65f6\u949f\u6ef4\u7b54\u6570 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c \u7cfb\u7edf\u81ea\u542f\u52a8\u5f00\u59cb\u5230\u76ee\u524d\u7684\u65f6\u949f\u6ef4\u7b54\u6570\u3002","title":"osKernelSysTick"},{"location":"05.SDK_Manual/#osthreadcreate","text":"osThreadId osThreadCreate(const osThreadDef_t *thread_def, void *argument); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4efb\u52a1 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] thread_def \u4efb\u52a1\u521d\u59cb\u5316\u53c2\u6570 [in] argument \u4f20\u9012\u7ed9\u4efb\u52a1\u5165\u53c2 \u8fd4\u56de\u503c \u6210\u529f\uff0c\u5219\u8fd4\u56de\u521b\u5efa\u7684\u4efb\u52a1\u53e5\u67c4\u3002 \u5931\u8d25\uff0c\u8fd4\u56deNULL\u3002","title":"osThreadCreate"},{"location":"05.SDK_Manual/#osthreadgetid","text":"osThreadId osThreadGetId(void); \u529f\u80fd\u63cf\u8ff0 \u83b7\u53d6\u5f53\u524d\u4efb\u52a1\u53e5\u67c4 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c \u5f53\u524d\u4efb\u52a1\u53e5\u67c4\u3002","title":"osThreadGetId"},{"location":"05.SDK_Manual/#osthreadterminate","text":"osStatus osThreadTerminate(osThreadId thread_id); \u529f\u80fd\u63cf\u8ff0 \u7ec8\u6b62\u4efb\u52a1\u8fd0\u884c\u5e76\u5220\u9664\u4efb\u52a1 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] thread_id \u4efb\u52a1\u53e5\u67c4 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"osThreadTerminate"},{"location":"05.SDK_Manual/#osthreadsetpriority","text":"osStatus osThreadSetPriority(osThreadId thread_id, osPriority priority); \u529f\u80fd\u63cf\u8ff0 \u8bbe\u7f6e\u4efb\u52a1\u4f18\u5148\u7ea7 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] thread_id \u4efb\u52a1\u53e5\u67c4 [in] priority \u4f18\u5148\u7ea7 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"osThreadSetPriority"},{"location":"05.SDK_Manual/#osthreadgetpriority","text":"osPriority osThreadGetPriority(osThreadId thread_id); \u529f\u80fd\u63cf\u8ff0 \u83b7\u53d6\u4efb\u52a1\u4f18\u5148\u7ea7 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] thread_id \u4efb\u52a1\u53e5\u67c4 \u8fd4\u56de\u503c \u4efb\u52a1\u4f18\u5148\u7ea7\u3002","title":"osThreadGetPriority"},{"location":"05.SDK_Manual/#osdelay","text":"osStatus osDelay(uint32_t millisec); \u529f\u80fd\u63cf\u8ff0 \u7761\u7720\u5f53\u524d\u4efb\u52a1\uff0c\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] millisec \u7761\u7720\u65f6\u95f4\u6beb\u79d2\u6570 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"osDelay"},{"location":"05.SDK_Manual/#ostimercreate","text":"osTimerId osTimerCreate(const osTimerDef_t *timer_def, os_timer_type type, void *argument); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u5b9a\u65f6\u5668\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] timer_def \u5b9a\u65f6\u5668\u521d\u59cb\u5316\u53c2\u6570 [in] type \u5b9a\u65f6\u5668\u7c7b\u578b [in] argument \u5b9a\u65f6\u5668\u56de\u8c03\u5165\u53c2 \u8fd4\u56de\u503c \u6210\u529f\uff0c\u5219\u8fd4\u56de\u521b\u5efa\u7684\u5b9a\u65f6\u5668\u53e5\u67c4\u3002 \u5931\u8d25\uff0c\u8fd4\u56deNULL\u3002","title":"osTimerCreate"},{"location":"05.SDK_Manual/#ostimerstart","text":"osStatus osTimerStart(osTimerId timer_id, uint32_t millisec); \u529f\u80fd\u63cf\u8ff0 \u542f\u52a8\u5b9a\u65f6\u5668 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] timer_id \u5b9a\u65f6\u5668\u53e5\u67c4 [in] millisec \u6267\u884c\u5ef6\u8fdf\u53c2\u6570 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"osTimerStart"},{"location":"05.SDK_Manual/#ostimerstop","text":"osStatus osTimerStop(osTimerId timer_id); \u529f\u80fd\u63cf\u8ff0 \u505c\u6b62\u5b9a\u65f6\u5668 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] timer_id \u5b9a\u65f6\u5668\u53e5\u67c4 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"osTimerStop"},{"location":"05.SDK_Manual/#ostimerdelete","text":"osStatus osTimerDelete(osTimerId timer_id); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u5b9a\u65f6\u5668 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] timer_id \u5b9a\u65f6\u5668\u53e5\u67c4 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"osTimerDelete"},{"location":"05.SDK_Manual/#osmutexcreate","text":"osStatus osMutexCreate(const osMutexDef_t *mutex_def); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e92\u65a5\u91cf \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mutex_def \u4e92\u65a5\u91cf\u521d\u59cb\u5316\u53c2\u6570 \u8fd4\u56de\u503c \u6210\u529f\uff0c\u5219\u8fd4\u56de\u521b\u5efa\u7684\u4e92\u65a5\u91cf\u53e5\u67c4\u3002 \u5931\u8d25\uff0c\u8fd4\u56deNULL\u3002","title":"osMutexCreate"},{"location":"05.SDK_Manual/#osmutexwait","text":"osStatus osMutexWait(osMutexId mutex_id, uint32_t millisec); \u529f\u80fd\u63cf\u8ff0 \u5c1d\u8bd5\u83b7\u53d6\u4e00\u4e2a\u4e92\u65a5\u91cf \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mutex_id \u4e92\u65a5\u91cf\u53e5\u67c4 [in] millisec \u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"osMutexWait"},{"location":"05.SDK_Manual/#osmutexrelease","text":"osStatus osMutexRelease(osMutexId mutex_id); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4e92\u65a5\u91cf \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mutex_id \u4e92\u65a5\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"osMutexRelease"},{"location":"05.SDK_Manual/#osmutexdelete","text":"osStatus osMutexDelete(osMutexId mutex_id); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4e92\u65a5\u91cf \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] mutex_id \u4e92\u65a5\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"osMutexDelete"},{"location":"05.SDK_Manual/#ossemaphorecreate","text":"osSemaphoreId osSemaphoreCreate(const osSemaphoreDef_t *semaphore_def, int32_t count); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u4fe1\u53f7\u91cf \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] semaphore_def \u4fe1\u53f7\u91cf\u521d\u59cb\u5316\u53c2\u6570 [in] count \u4fe1\u53f7\u91cf\u521d\u59cb\u503c \u8fd4\u56de\u503c \u6210\u529f\uff0c\u5219\u8fd4\u56de\u521b\u5efa\u7684\u4fe1\u53f7\u91cf\u53e5\u67c4\u3002 \u5931\u8d25\uff0c\u8fd4\u56deNULL\u3002","title":"osSemaphoreCreate"},{"location":"05.SDK_Manual/#ossemaphorewait","text":"int32_t osSemaphoreWait(osSemaphoreId semaphore_id, uint32_t millisec); \u529f\u80fd\u63cf\u8ff0 \u7b49\u5f85\u4e00\u4e2a\u4fe1\u53f7\u91cf \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] semaphore_id \u4fe1\u53f7\u91cf\u53e5\u67c4 [in] millisec \u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c \u6210\u529f\uff0c\u5219\u8fd4\u56de\u4fe1\u53f7\u91cf\u53ef\u7528\u7684\u8d44\u6e90\u6570\u3002 \u5931\u8d25\uff0c\u8fd4\u56de-1\u3002","title":"osSemaphoreWait"},{"location":"05.SDK_Manual/#ossemaphorerelease","text":"osStatus osSemaphoreRelease(osSemaphoreId semaphore_id); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4fe1\u53f7\u91cf \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] semaphore_id \u4fe1\u53f7\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"osSemaphoreRelease"},{"location":"05.SDK_Manual/#ossemaphoredelete","text":"osStatus osSemaphoreDelete(osSemaphoreId semaphore_id); \u529f\u80fd\u63cf\u8ff0 \u9500\u6bc1\u4fe1\u53f7\u91cf \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] semaphore_id \u4fe1\u53f7\u91cf\u53e5\u67c4 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"osSemaphoreDelete"},{"location":"05.SDK_Manual/#ospoolcreate","text":"osPoolId osPoolCreate(const osPoolDef_t *pool_def); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u5185\u5b58\u6c60 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] pool_def \u5185\u5b58\u6c60\u521d\u59cb\u5316\u53c2\u6570 \u8fd4\u56de\u503c \u6210\u529f\uff0c\u5219\u8fd4\u56de\u521b\u5efa\u7684\u5185\u5b58\u6c60\u53e5\u67c4\u3002 \u5931\u8d25\uff0c\u8fd4\u56deNULL\u3002","title":"osPoolCreate"},{"location":"05.SDK_Manual/#ospoolalloc","text":"void *osPoolAlloc(osPoolId pool_id); \u529f\u80fd\u63cf\u8ff0 \u4ece\u5185\u5b58\u6c60\u4e2d\u83b7\u53d6\u4e00\u4e2a\u5185\u5b58\u5757 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] pool_id \u5185\u5b58\u6c60\u53e5\u67c4 \u8fd4\u56de\u503c \u6210\u529f\uff0c\u5219\u8fd4\u56de\u5206\u914d\u5230\u7684\u5185\u5b58\u5757\u8d77\u59cb\u5730\u5740\u3002 \u5931\u8d25\uff0c\u8fd4\u56deNULL\u3002","title":"osPoolAlloc"},{"location":"05.SDK_Manual/#ospoolcalloc","text":"void *osPoolCAlloc(osPoolId pool_id); \u529f\u80fd\u63cf\u8ff0 \u4ece\u5185\u5b58\u6c60\u4e2d\u83b7\u53d6\u4e00\u4e2a\u5185\u5b58\u5757\uff0c\u5e76\u5c06\u6b64\u5185\u5b58\u5757\u6e05\u7a7a\u4e3a0\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] pool_id \u5185\u5b58\u6c60\u53e5\u67c4 \u8fd4\u56de\u503c \u6210\u529f\uff0c\u5219\u8fd4\u56de\u5206\u914d\u5230\u7684\u5185\u5b58\u5757\u8d77\u59cb\u5730\u5740\u3002 \u5931\u8d25\uff0c\u8fd4\u56deNULL\u3002","title":"osPoolCAlloc"},{"location":"05.SDK_Manual/#ospoolfree","text":"osStatus osPoolFree(osPoolId pool_id, void *block); \u529f\u80fd\u63cf\u8ff0 \u91ca\u653e\u4e00\u4e2a\u5185\u5b58\u5757 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] pool_id \u5185\u5b58\u6c60\u53e5\u67c4 [in] block \u5185\u5b58\u5757\u8d77\u59cb\u5730\u5740 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"osPoolFree"},{"location":"05.SDK_Manual/#osmessagecreate","text":"osMessageQId osMessageCreate(const osMessageQDef_t *queue_def, osThreadId thread_id); \u529f\u80fd\u63cf\u8ff0 \u521b\u5efa\u4e00\u4e2a\u961f\u5217 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] queue_def \u961f\u5217\u521d\u59cb\u5316\u53c2\u6570 [in] thread_id \u4efb\u52a1\u53e5\u67c4 \u8fd4\u56de\u503c \u6210\u529f\uff0c\u5219\u8fd4\u56de\u521b\u5efa\u7684\u961f\u5217\u53e5\u67c4\u3002 \u5931\u8d25\uff0c\u8fd4\u56deNULL\u3002","title":"osMessageCreate"},{"location":"05.SDK_Manual/#osmessageput","text":"osStatus osMessagePut(osMessageQId queue_id, uint32_t info, uint32_t millisec); \u529f\u80fd\u63cf\u8ff0 \u5411\u961f\u5217\u4e2d\u653e\u7f6e\u4e00\u4e2a\u6d88\u606f \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] queue_id \u961f\u5217\u53e5\u67c4 [in] info \u8981\u653e\u7f6e\u7684\u6d88\u606f\u4f53 [in] millisec \u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c osOK\uff0c\u8fd4\u56de\u6210\u529f\u3002 osErrorOS\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"osMessagePut"},{"location":"05.SDK_Manual/#osmessageget","text":"osEvent osMessageGet(osMessageQId queue_id, uint32_t millisec); \u529f\u80fd\u63cf\u8ff0 \u4ece\u5185\u5b58\u6c60\u4e2d\u83b7\u53d6\u4e00\u4e2a\u6d88\u606f \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] queue_id \u961f\u5217\u53e5\u67c4 [in] millisec \u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c \u4e00\u4e2a\u5305\u542b\u4e86\u8fd4\u56de\u72b6\u6001\u7684osEvent\u4fe1\u606f\u7ed3\u6784\u4f53\u3002","title":"osMessageGet"},{"location":"05.SDK_Manual/#api_2","text":"","title":"\u7f51\u7edcAPI"},{"location":"05.SDK_Manual/#sal","text":"","title":"sal\u6a21\u7ec4\u8054\u7f51\u63a5\u53e3"},{"location":"05.SDK_Manual/#tos_sal_module_register","text":"int tos_sal_module_register(sal_module_t *module); \u529f\u80fd\u63cf\u8ff0 \u6ce8\u518c\u4e00\u4e2a\u8054\u7f51\u6a21\u7ec4 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] module \u8054\u7f51\u6a21\u7ec4\u53e5\u67c4 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_sal_module_register"},{"location":"05.SDK_Manual/#tos_sal_module_init","text":"int tos_sal_module_init(void); \u529f\u80fd\u63cf\u8ff0 \u521d\u59cb\u5316\u6a21\u7ec4 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_sal_module_init"},{"location":"05.SDK_Manual/#tos_sal_module_parse_domain","text":"int tos_sal_module_parse_domain(const char *host_name, char *host_ip); \u529f\u80fd\u63cf\u8ff0 \u57df\u540d\u89e3\u6790\uff0c\u5c06\u4e00\u4e2a\u57df\u540d\u8f6c\u6362\u4e3aIP\u5730\u5740\u3002 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] host_name \u5f85\u89e3\u6790\u7684\u57df\u540d [out] host_ip \u89e3\u6790\u540e\u7684IP\u5730\u5740 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_sal_module_parse_domain"},{"location":"05.SDK_Manual/#tos_sal_module_connect","text":"int tos_sal_module_connect(const char *ip, const char *port, sal_proto_t proto); \u529f\u80fd\u63cf\u8ff0 \u5411\u8fdc\u7aef\u53d1\u8d77\u8fde\u63a5 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] ip IP\u5730\u5740 [in] port \u7aef\u53e3 [in] proto TCP/UDP\u534f\u8bae \u8fd4\u56de\u503c \u6210\u529f\uff0c\u5219\u8fd4\u56de\u8fde\u63a5\u7684socket id\u3002 \u5931\u8d25\uff0c\u8fd4\u56de-1\u3002","title":"tos_sal_module_connect"},{"location":"05.SDK_Manual/#tos_sal_module_send","text":"int tos_sal_module_send(int sock, const void *buf, size_t len); \u529f\u80fd\u63cf\u8ff0 \u5411\u8fdc\u7aef\u53d1\u9001\u6570\u636e\uff08TCP\u534f\u8bae\u6808\uff09 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sock socket id(\u7531tos_sal_module_connect\u83b7\u53d6) [in] buf \u53d1\u9001\u7684\u6570\u636e\u8d77\u59cb\u5730\u5740 [in] len \u53d1\u9001\u7684\u6570\u636e\u957f\u5ea6 \u8fd4\u56de\u503c \u53d1\u9001\u7684\u6570\u636e\u957f\u5ea6\u3002","title":"tos_sal_module_send"},{"location":"05.SDK_Manual/#tos_sal_module_recv","text":"int tos_sal_module_recv(int sock, void *buf, size_t len); \u529f\u80fd\u63cf\u8ff0 \u4ece\u8fdc\u7aef\u8bfb\u53d6\u6570\u636e\uff08TCP\u534f\u8bae\u6808\uff09 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sock socket id\uff08\u7531tos_sal_module_connect\u83b7\u53d6\uff09 [out] buf \u63a5\u6536\u6570\u636ebuffer [in] len \u63a5\u6536\u6570\u636ebuffer\u957f\u5ea6 \u8fd4\u56de\u503c \u5b9e\u9645\u63a5\u6536\u5230\u7684\u6570\u636e\u957f\u5ea6\u3002","title":"tos_sal_module_recv"},{"location":"05.SDK_Manual/#tos_sal_module_recv_timeout","text":"int tos_sal_module_recv_timeout(int sock, void *buf, size_t len, uint32_t timeout); \u529f\u80fd\u63cf\u8ff0 \u4ece\u8fdc\u7aef\u63a5\u6536\u6570\u636e\uff08TCP\u534f\u8bae\u6808\uff09 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sock socket id\uff08\u7531tos_sal_module_connect\u83b7\u53d6\uff09 [in] buf \u6570\u636e\u8d77\u59cb\u5730\u5740 [in] len \u6570\u636e\u957f\u5ea6 [in] timeout \u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c \u5b9e\u9645\u63a5\u6536\u5230\u7684\u6570\u636e\u957f\u5ea6\u3002","title":"tos_sal_module_recv_timeout"},{"location":"05.SDK_Manual/#tos_sal_module_sendto","text":"int tos_sal_module_sendto(int sock, char *ip, char *port, void *buf, size_t len); \u529f\u80fd\u63cf\u8ff0 \u5411\u8fdc\u7aef\u53d1\u9001\u6570\u636e\uff08UDP\u534f\u8bae\u6808\uff09 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sock socket id\uff08\u7531tos_sal_module_connect\u83b7\u53d6\uff09 [in] ip IP\u5730\u5740 [in] port \u7aef\u53e3 [in] buf \u5f85\u53d1\u9001\u6570\u636e\u8d77\u59cb\u5730\u5740 [in] len \u5f85\u53d1\u9001\u6570\u636e\u957f\u5ea6 \u8fd4\u56de\u503c \u53d1\u9001\u7684\u6570\u636e\u957f\u5ea6\u3002","title":"tos_sal_module_sendto"},{"location":"05.SDK_Manual/#tos_sal_module_recvfrom","text":"int tos_sal_module_recvfrom(int sock, char *ip, char *port, void *buf, size_t len); \u529f\u80fd\u63cf\u8ff0 \u4ece\u8fdc\u7aef\u63a5\u6536\u6570\u636e\uff08UDP\u534f\u8bae\u6808\uff09 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sock socket id\uff08\u7531tos_sal_module_connect\u83b7\u53d6\uff09 [in] ip IP\u5730\u5740 [in] port \u7aef\u53e3 [in] buf \u63a5\u6536\u6570\u636ebuffer\u8d77\u59cb\u5730\u5740 [in] len \u63a5\u6536\u6570\u636ebuffer\u957f\u5ea6 \u8fd4\u56de\u503c \u5b9e\u9645\u63a5\u6536\u5230\u7684\u6570\u636e\u957f\u5ea6\u3002","title":"tos_sal_module_recvfrom"},{"location":"05.SDK_Manual/#tos_sal_module_close","text":"int tos_sal_module_close(int sock); \u529f\u80fd\u63cf\u8ff0 \u5173\u95ed\u4e0e\u8fdc\u7aef\u7684\u8fde\u63a5 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] sock socket id\uff08\u7531tos_sal_module_connect\u83b7\u53d6\uff09 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_sal_module_close"},{"location":"05.SDK_Manual/#lora","text":"","title":"lora\u6a21\u7ec4\u8054\u7f51\u63a5\u53e3"},{"location":"05.SDK_Manual/#tos_lora_module_register","text":"int tos_lora_module_register(lora_module_t *module); \u529f\u80fd\u63cf\u8ff0 \u6ce8\u518c\u4e00\u4e2alora\u6a21\u7ec4 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] module lora\u6a21\u7ec4\u53e5\u67c4 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_lora_module_register"},{"location":"05.SDK_Manual/#tos_lora_module_init","text":"int tos_lora_module_init(void); \u529f\u80fd\u63cf\u8ff0 \u521d\u59cb\u5316lora\u6a21\u7ec4 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_lora_module_init"},{"location":"05.SDK_Manual/#tos_lora_module_join","text":"int tos_lora_module_join(void); \u529f\u80fd\u63cf\u8ff0 \u52a0\u5165lora\u7f51\u5173 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_lora_module_join"},{"location":"05.SDK_Manual/#tos_lora_module_send","text":"int tos_lora_module_send(const void *buf, size_t len); \u529f\u80fd\u63cf\u8ff0 \u901a\u8fc7lora\u6a21\u7ec4\u53d1\u9001\u6570\u636e \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] buf \u8981\u53d1\u9001\u7684\u6570\u636e\u8d77\u59cb\u5730\u5740 [in] len \u8981\u53d1\u9001\u7684\u6570\u636e\u957f\u5ea6 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_lora_module_send"},{"location":"05.SDK_Manual/#tos_lora_module_recv","text":"int tos_lora_module_recv(void *buf, size_t len); \u529f\u80fd\u63cf\u8ff0 \u901a\u8fc7lora\u6a21\u7ec4\u63a5\u6536\u6570\u636e \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [out] buf \u63a5\u6536\u6570\u636e\u7684buffer\u5730\u5740 [in] len buffer\u957f\u5ea6 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_lora_module_recv"},{"location":"05.SDK_Manual/#tos_lora_module_recv_timeout","text":"int tos_lora_module_recv_timeout(void *buf, size_t len, uint32_t timeout); \u529f\u80fd\u63cf\u8ff0 \u901a\u8fc7lora\u6a21\u7ec4\u63a5\u6536\u6570\u636e \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] buf \u63a5\u6536\u6570\u636e\u7684buffer\u5730\u5740 [in] len buffer\u957f\u5ea6 [in] timeout \u8d85\u65f6\u53c2\u6570 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_lora_module_recv_timeout"},{"location":"05.SDK_Manual/#tos_lora_module_close","text":"int tos_lora_module_close(void); \u529f\u80fd\u63cf\u8ff0 \u5173\u95edlora\u6a21\u7ec4 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_lora_module_close"},{"location":"05.SDK_Manual/#_7","text":"","title":"\u817e\u8baf\u5b9a\u5236\u56fa\u4ef6\u6a21\u7ec4\u8054\u7f51\u63a5\u53e3"},{"location":"05.SDK_Manual/#tos_tf_module_register","text":"int tos_tf_module_register(tencent_firmware_module_t *module); \u529f\u80fd\u63cf\u8ff0 \u6ce8\u518c\u4e00\u4e2a\u817e\u8baf\u5b9a\u5236\u56fa\u4ef6\u6a21\u7ec4 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] module \u817e\u8baf\u5b9a\u5236\u56fa\u4ef6\u6a21\u7ec4\u53e5\u67c4 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_tf_module_register"},{"location":"05.SDK_Manual/#tos_tf_module_init","text":"int tos_tf_module_init(void); \u529f\u80fd\u63cf\u8ff0 \u521d\u59cb\u5316\u817e\u8baf\u5b9a\u5236\u56fa\u4ef6\u6a21\u7ec4 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_tf_module_init"},{"location":"05.SDK_Manual/#tos_tf_module_info_set","text":"int tos_tf_module_info_set(device_info_t *info, tls_mode_t tls_mode); \u529f\u80fd\u63cf\u8ff0 \u8bbe\u7f6e\u817e\u8baf\u5b9a\u5236\u56fa\u4ef6\u6a21\u7ec4\u8bbe\u5907\u4fe1\u606f \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] device_info_t \u817e\u8baf\u5b9a\u5236\u56fa\u4ef6\u6a21\u7ec4\u8bbe\u5907\u4fe1\u606f\u63cf\u8ff0\u7ed3\u6784\u4f53 [in] tls_mode tls\u6821\u9a8c\u6a21\u5f0f \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_tf_module_info_set"},{"location":"05.SDK_Manual/#tos_tf_module_mqtt_conn","text":"int tos_tf_module_mqtt_conn(mqtt_param_t init_params); \u529f\u80fd\u63cf\u8ff0 \u901a\u8fc7\u817e\u8baf\u5b9a\u5236\u56fa\u4ef6\u6a21\u7ec4\u53d1\u8d77MQTT\u8fde\u63a5 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] init_params MQTT\u8fde\u63a5\u53c2\u6570 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_tf_module_mqtt_conn"},{"location":"05.SDK_Manual/#tos_tf_module_mqtt_discon","text":"int tos_tf_module_mqtt_discon(void); \u529f\u80fd\u63cf\u8ff0 \u65ad\u5f00\u817e\u8baf\u5b9a\u5236\u56fa\u4ef6\u6a21\u7ec4\u7684MQTT\u8fde\u63a5 \u53c2\u6570\u89e3\u91ca \u65e0 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_tf_module_mqtt_discon"},{"location":"05.SDK_Manual/#tos_tf_module_mqtt_pub","text":"int tos_tf_module_mqtt_pub(const char *topic, qos_t qos, char *payload); \u529f\u80fd\u63cf\u8ff0 \u53d1\u5e03\u4e3b\u9898 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] topic \u4e3b\u9898 [in] qos qos [in] payload \u4e3b\u9898\u7684\u6d88\u606f\u8d1f\u8f7d \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_tf_module_mqtt_pub"},{"location":"05.SDK_Manual/#tos_tf_module_mqtt_publ","text":"int tos_tf_module_mqtt_publ(const char *topic, qos_t qos, char *payload); \u529f\u80fd\u63cf\u8ff0 \u53d1\u5e03\u957f\u6d88\u606f\u8d1f\u8f7d\uff08> 200\uff09\u4e3b\u9898 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] topic \u4e3b\u9898 [in] qos qos [in] payload \u4e3b\u9898\u7684\u6d88\u606f\u8d1f\u8f7d \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_tf_module_mqtt_publ"},{"location":"05.SDK_Manual/#tos_tf_module_mqtt_sub","text":"int tos_tf_module_mqtt_sub(char *topic, qos_t qos); \u529f\u80fd\u63cf\u8ff0 \u8ba2\u9605\u4e3b\u9898 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] topic \u4e3b\u9898 [in] qos qos \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_tf_module_mqtt_sub"},{"location":"05.SDK_Manual/#tos_tf_module_mqtt_unsub","text":"int tos_tf_module_mqtt_unsub(char *topic); \u529f\u80fd\u63cf\u8ff0 \u53d6\u6d88\u8ba2\u9605\u4e3b\u9898 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] topic \u4e3b\u9898 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_tf_module_mqtt_unsub"},{"location":"05.SDK_Manual/#tos_tf_module_mqtt_state","text":"int tos_tf_module_mqtt_state(mqtt_state_t *state); \u529f\u80fd\u63cf\u8ff0 \u67e5\u8be2MQTT\u8fde\u63a5\u72b6\u6001 \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [out] state \u8fde\u63a5\u72b6\u6001 \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_tf_module_mqtt_state"},{"location":"05.SDK_Manual/#tos_tf_module_debug_level_set","text":"int tos_tf_module_debug_level_set(int log_level); \u529f\u80fd\u63cf\u8ff0 \u8bbe\u7f6e\u6a21\u7ec4\u8c03\u8bd5\u65e5\u5fd7\u7ea7\u522b \u53c2\u6570\u89e3\u91ca IN/OUT \u53c2\u6570\u540d \u63cf\u8ff0 [in] log_level \u8c03\u8bd5\u65e5\u5fd7\u7ea7\u522b \u8fd4\u56de\u503c 0\uff0c\u8fd4\u56de\u6210\u529f\u3002 -1\uff0c\u8fd4\u56de\u5931\u8d25\u3002","title":"tos_tf_module_debug_level_set"},{"location":"06.FAQ/","text":"1\u3001\u7269\u8054\u7f51\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u54ea\u4e9b\u529f\u80fd\uff1f TencentOS tiny\u63d0\u4f9b\u4e86\u57fa\u7840RTOS\u5185\u6838\u3001OS\u9002\u914d\u5c42\u3001\u7f51\u7edc\u9002\u914d\u6846\u67b6\u3001\u9a71\u52a8\u9002\u914d\u6846\u67b6\u3001IoT\u7aef\u4e91SDK\uff0cOTA\u5347\u7ea7\u3001\u6587\u4ef6\u7cfb\u7edf\u3001\u5f02\u5e38\u5904\u7406\u3001\u5f00\u53d1API\u7b49\u529f\u80fd\uff1b 2\u3001\u7269\u8054\u7f51\u64cd\u4f5c\u7cfb\u7edf\u652f\u6301\u54ea\u4e9b\u5e94\u7528\u573a\u666f\uff1f TencentOS tiny\u53ef\u652f\u6491\u667a\u6167\u57ce\u5e02\u3001\u667a\u80fd\u6c34\u8868\u3001\u667a\u80fd\u5bb6\u5c45\u3001\u667a\u80fd\u7a7f\u6234\u3001\u8f66\u8054\u7f51\u7b49\u591a\u79cd\u7269\u8054\u7f51\u884c\u4e1a\u5e94\u7528\uff0c\u80fd\u4e3a\u4e3a\u7269\u8054\u7f51\u7ec8\u7aef\u5382\u5bb6\u548c\u7ec8\u7aef\u8bbe\u5907\u63d0\u4f9b\u4e00\u7ad9\u5f0f\u8f6f\u4ef6\u89e3\u51b3\u65b9\u6848\u3002 3\u3001\u7269\u8054\u7f51\u64cd\u4f5c\u7cfb\u7edf\u652f\u6301\u54ea\u4e9b\u82af\u7247\u6a21\u7ec4\uff1f TencentOS tiny \u652f\u6301\u4e3b\u6d41\u7684\u82af\u7247\u548c\u901a\u4fe1\u6a21\u7ec4\uff0c\u5982STM32\u3001NXP\u3001\u56fd\u6c11\u6280\u672f\u3001\u534e\u5927\u534a\u5bfc\u4f53\u3001\u745e\u5174\u6052\u65b9\u7b49\uff0c\u672a\u6765\u5c06\u8fdb\u4e00\u6b65\u6269\u5c55\u751f\u6001\uff0c\u652f\u6301\u66f4\u591a\u4e0d\u540c\u67b6\u6784\u7684\u82af\u7247\u548c\u6a21\u7ec4\u3002 4\u3001\u7269\u8054\u7f51\u64cd\u4f5c\u7cfb\u7edf\u5982\u4f55\u79fb\u690d\uff1f TencentOS tiny\u63d0\u4f9b\u5e38\u89c1MCU\u7684\u79fb\u690d\u6307\u5357\uff0c\u7528\u6237\u6839\u636e\u6587\u6863\u6307\u5357\u8fdb\u884c\u64cd\u4f5c\u5373\u53ef\uff0c\u4e3b\u8981\u662f\u9002\u914d\u4e0d\u540c\u82af\u7247\u7684\u4efb\u52a1\u8c03\u5ea6\u6c47\u7f16\u548c\u90e8\u5206\u786c\u4ef6\u8d44\u6e90\uff1b 5\u3001\u7269\u8054\u7f51\u64cd\u4f5c\u7cfb\u7edf\u5982\u4f55\u6536\u8d39\uff1f TencentOS tiny\u7269\u8054\u7f51\u64cd\u4f5c\u7cfb\u7edf\u662f\u817e\u8baf\u7269\u8054\u7f51\u751f\u6001\u94fe\u5e95\u5c42\u5173\u952e\u4e00\u73af\uff0c\u662f\u4e00\u4e2a\u514d\u8d39\u5f00\u6e90\u7684\u7ec8\u7aef\u8f6f\u4ef6\u6808\uff0c\u6a21\u7ec4\u548c\u7ec8\u7aef\u5382\u5bb6\u53ef\u4ee5\u514d\u8d39\u79fb\u690d\u5230\u81ea\u5df1\u7684\u4ea7\u54c1\u4e2d\uff0c\u652f\u6301\u4ea7\u54c1\u4e1a\u52a1\u5feb\u901f\u63a5\u5165\u817e\u8baf\u4e91IoTHub\u3002 6\u3001\u7269\u8054\u7f51\u64cd\u4f5c\u7cfb\u7edf\u5982\u4f55\u5b9e\u73b0\u4e0e\u817e\u8baf\u4e91\u7269\u8054\u7f51\u5e73\u53f0\u7684\u5bf9\u63a5\uff1f TencentOS tiny \u63d0\u4f9b\u591a\u79cd\u901a\u4fe1\u7f51\u7edc\u652f\u6301\uff0c\u7528\u6237\u53ef\u4ee5\u4f7f\u7528TencentOS tiny \u63d0\u4f9b\u7684SDK\u7ec4\u4ef6\u63a5\u5165\u5230\u817e\u8baf\u4e91\u7269\u8054\u7f51\u5e73\u53f0\uff0c\u76ee\u524dSDK\u96c6\u6210\u4e86wifi\u30012G\u3001NB-IoT\u3001LoRa\u7b49\u65b9\u5f0f\u7684\u94fe\u8def\u5c42\u534f\u8bae\u3001\u4e5f\u96c6\u6210\u4e86MQTT\u3001LoRaWAN\u7b49\u5e94\u7528\u5c42\u534f\u8bae\uff0c\u7528\u6237\u53ef\u4ee5\u6839\u636e\u4e1a\u52a1\u7684\u9700\u6c42\u9009\u62e9\u5408\u9002\u7684\u65b9\u5f0f\u8fdb\u884c\u5bf9\u63a5\u3002","title":"06.FAQ"},{"location":"07.Glossary/","text":"TencentOS tiny \u8bcd\u6c47\u672f\u8bed\u8868 \u8bcd\u6c47ID \u7f29\u7565\u8bed \u4e2d\u6587\u8bcd\u6c47 \u4e2d\u6587\u5b9a\u4e49 \u82f1\u6587\u8bcd\u6c47 \u82f1\u6587\u5b9a\u4e49 RTOS_001 RTOS \u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf \u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf\uff08RTOS\uff09\u662f\u6307\u5f53\u5916\u754c\u4e8b\u4ef6\u6216\u6570\u636e\u4ea7\u751f\u65f6\uff0c\u80fd\u591f\u63a5\u53d7\u5e76\u4ee5\u8db3\u591f\u5feb\u7684\u901f\u5ea6\u4e88\u4ee5\u5904\u7406\uff0c\u5176\u5904\u7406\u7684\u7ed3\u679c\u53c8\u80fd\u5728\u89c4\u5b9a\u7684\u65f6\u95f4\u4e4b\u5185\u6765\u63a7\u5236\u751f\u4ea7\u8fc7\u7a0b\u6216\u5bf9\u5904\u7406\u7cfb\u7edf\u505a\u51fa\u5feb\u901f\u54cd\u5e94\uff0c\u8c03\u5ea6\u4e00\u5207\u53ef\u5229\u7528\u7684\u8d44\u6e90\u5b8c\u6210\u5b9e\u65f6\u4efb\u52a1\uff0c\u5e76\u63a7\u5236\u6240\u6709\u5b9e\u65f6\u4efb\u52a1\u534f\u8c03\u4e00\u81f4\u8fd0\u884c\u7684\u64cd\u4f5c\u7cfb\u7edf\u3002 Real Time Operating System Real-time operating system (RTOS) means that when external events or data are generated, it can be accepted and processed at a fast enough speed. The result of the processing can control the production process or make a quick response to the processing system within a specified time. In response, schedule all available resources to complete real-time tasks and control the operating system in which all real-time tasks run in unison. MQTT001 MQTT \u6d88\u606f\u961f\u5217\u9065\u6d4b\u4f20\u8f93 \u6d88\u606f\u961f\u5217\u9065\u6d4b\u4f20\u8f93\u662fISO \u6807\u51c6\u4e0b\u57fa\u4e8e\u53d1\u5e03/\u8ba2\u9605\u8303\u5f0f\u7684\u6d88\u606f\u534f\u8bae Message Queuing Telemetry Transport Message Queuing Telemetry Transport is an ISO standard publish-subscribe-based messaging protocol. CoAP001 CoAP \u53d7\u9650\u5236\u7684\u5e94\u7528\u534f\u8bae \u53d7\u9650\u5236\u7684\u5e94\u7528\u534f\u8bae\u662f\u4e00\u79cd\u4e13\u7528\u7684Web\u4f20\u8f93\u534f\u8bae\uff0c\u7528\u4e8e\u7269\u8054\u7f51\u4e2d\u7684\u53d7\u7ea6\u675f\u8282\u70b9\u548c\u53d7\u7ea6\u675f\u7684\u7f51\u7edc\u3002 Constrained Application Protocol Constrained Application Protocol is a specialized Internet Application Protocol for constrained devices, as defined in RFC 7252. NB-IoT001 NB-IoT \u7a84\u5e26\u7269\u8054\u7f51 \u7a84\u5e26\u7269\u8054\u7f51, \u662f\u53ef\u4e0e\u8702\u7a9d\u7f51\u878d\u5408\u6f14\u8fdb\u7684\u4f4e\u6210\u672c\u7535\u4fe1\u7ea7\u9ad8\u53ef\u9760\u6027\u3001\u9ad8\u5b89\u5168\u6027\u5e7f\u57df\u7269\u8054\u7f51\u6280\u672f\u3002 Narrow Band Internet of Things The narrowband Internet of Things is a low-cost carrier-class, high-reliability, high-security wide-area Internet of Things technology that can evolve with cellular networks. LORa001 LoRa \u8fdc\u8ddd\u79bb\u65e0\u7ebf\u7535 \u8fdc\u8ddd\u79bb\u65e0\u7ebf\u7535, \u662fsemtech\u516c\u53f8\u521b\u5efa\u7684\u4f4e\u529f\u8017\u5c40\u57df\u7f51\u65e0\u7ebf\u6807\u51c6\u3002 Long Range Radio Long-range radio is a low-power LAN wireless standard created by Semtech. LPWA001 LPWA \u4f4e\u529f\u8017\u5e7f\u57df\u7f51\u7edc \u4f4e\u529f\u8017\u5e7f\u57df\u7f51\u7edc\uff0c\u662f\u9762\u5411\u7269\u8054\u7f51\u4e2d\u8fdc\u8ddd\u79bb\u548c\u4f4e\u529f\u8017\u7684\u901a\u4fe1\u9700\u6c42\uff0c\u51fa\u73b0\u7684\u4e00\u79cd\u7269\u8054\u7f51\u65e0\u7ebf\u8fde\u63a5\u6280\u672f\uff0c\u5177\u6709\u4f20\u8f93\u8ddd\u79bb\u8fdc\u3001\u8282\u70b9\u529f\u8017\u4f4e\u3001\u7f51\u7edc\u7ed3\u6784\u7b80\u5355\u3001\u8fd0\u884c\u7ef4\u62a4\u6210\u672c\u4f4e\u7684\u6280\u672f\u7279\u70b9\u3002 Low Power Wide Area Low-power wide-area network is a kind of communication technology for long-distance and low-power communication in the Internet of Things. An Internet of Things wireless connection technology has the technology of long transmission distance, low node power consumption, simple network structure and low operation and maintenance cost. Features. SAL001 SAL \u5957\u63a5\u5b57\u62bd\u8c61\u5c42 Socket Abstraction Layer DTLS001 DTLS \u6570\u636e\u5305\u4f20\u8f93\u5c42\u5b89\u5168\u6027\u534f\u8bae \u6570\u636e\u5305\u4f20\u8f93\u5c42\u5b89\u5168\u6027\u534f\u8bae\uff0c\u5b89\u5168\u4f20\u8f93\u5c42\u534f\u8bae\u4e0d\u80fd\u7528\u6765\u4fdd\u8bc1UDP\u4e0a\u4f20\u8f93\u7684\u6570\u636e\u7684\u5b89\u5168\uff0c\u56e0\u6b64Datagram TLS\u662f\u5728\u73b0\u5b58\u7684TLS\u534f\u8bae\u67b6\u6784\u4e0a\u63d0\u51fa\u6269\u5c55\uff0c\u4f7f\u4e4b\u652f\u6301UDP\uff0c\u5373\u6210\u4e3aTLS\u7684\u4e00\u4e2a\u652f\u6301\u6570\u636e\u62a5\u4f20\u8f93\u7684\u7248\u672c\u3002 Datagram Transport Layer Security Datagram transport layer security protocol, the secure transport layer protocol can not be used to ensure the security of data transmitted over UDP. Therefore, Datagram TLS is extended on the existing TLS protocol architecture to support UDP, which is a supporting data of TLS. The version of the transmission. TLS001 TLS \u5b89\u5168\u4f20\u8f93\u5c42\u534f\u8bae \u5b89\u5168\u4f20\u8f93\u5c42\u534f\u8bae\u7528\u4e8e\u5728\u4e24\u4e2a\u901a\u4fe1\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u63d0\u4f9b\u4fdd\u5bc6\u6027\u548c\u6570\u636e\u5b8c\u6574\u6027\u3002 Transport Layer Security The secure transport layer protocol is used to provide confidentiality and data integrity between two communication applications. OTA001 OTA \u7a7a\u4e2d\u4e0b\u8f7d\u6280\u672f \u7a7a\u4e2d\u4e0b\u8f7d\u6280\u672f\uff0c\u7269\u8054\u7f51\u9886\u57df\u4e3b\u8981\u7528\u4e8e\u4ece\u4e91\u7aef\u89e6\u53d1\u5347\u7ea7\uff0c\u66f4\u65b0\u7ec8\u7aef\u8bbe\u5907\u7684\u56fa\u4ef6\u3002 Over\uff0dthe\uff0dAir Technology Over\uff0dthe\uff0dAir Technology, the Internet of Things field is mainly used to trigger upgrades from the cloud and update the firmware of the terminal device.","title":"07.Glossary"},{"location":"07.Glossary/#tencentos-tiny","text":"\u8bcd\u6c47ID \u7f29\u7565\u8bed \u4e2d\u6587\u8bcd\u6c47 \u4e2d\u6587\u5b9a\u4e49 \u82f1\u6587\u8bcd\u6c47 \u82f1\u6587\u5b9a\u4e49 RTOS_001 RTOS \u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf \u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf\uff08RTOS\uff09\u662f\u6307\u5f53\u5916\u754c\u4e8b\u4ef6\u6216\u6570\u636e\u4ea7\u751f\u65f6\uff0c\u80fd\u591f\u63a5\u53d7\u5e76\u4ee5\u8db3\u591f\u5feb\u7684\u901f\u5ea6\u4e88\u4ee5\u5904\u7406\uff0c\u5176\u5904\u7406\u7684\u7ed3\u679c\u53c8\u80fd\u5728\u89c4\u5b9a\u7684\u65f6\u95f4\u4e4b\u5185\u6765\u63a7\u5236\u751f\u4ea7\u8fc7\u7a0b\u6216\u5bf9\u5904\u7406\u7cfb\u7edf\u505a\u51fa\u5feb\u901f\u54cd\u5e94\uff0c\u8c03\u5ea6\u4e00\u5207\u53ef\u5229\u7528\u7684\u8d44\u6e90\u5b8c\u6210\u5b9e\u65f6\u4efb\u52a1\uff0c\u5e76\u63a7\u5236\u6240\u6709\u5b9e\u65f6\u4efb\u52a1\u534f\u8c03\u4e00\u81f4\u8fd0\u884c\u7684\u64cd\u4f5c\u7cfb\u7edf\u3002 Real Time Operating System Real-time operating system (RTOS) means that when external events or data are generated, it can be accepted and processed at a fast enough speed. The result of the processing can control the production process or make a quick response to the processing system within a specified time. In response, schedule all available resources to complete real-time tasks and control the operating system in which all real-time tasks run in unison. MQTT001 MQTT \u6d88\u606f\u961f\u5217\u9065\u6d4b\u4f20\u8f93 \u6d88\u606f\u961f\u5217\u9065\u6d4b\u4f20\u8f93\u662fISO \u6807\u51c6\u4e0b\u57fa\u4e8e\u53d1\u5e03/\u8ba2\u9605\u8303\u5f0f\u7684\u6d88\u606f\u534f\u8bae Message Queuing Telemetry Transport Message Queuing Telemetry Transport is an ISO standard publish-subscribe-based messaging protocol. CoAP001 CoAP \u53d7\u9650\u5236\u7684\u5e94\u7528\u534f\u8bae \u53d7\u9650\u5236\u7684\u5e94\u7528\u534f\u8bae\u662f\u4e00\u79cd\u4e13\u7528\u7684Web\u4f20\u8f93\u534f\u8bae\uff0c\u7528\u4e8e\u7269\u8054\u7f51\u4e2d\u7684\u53d7\u7ea6\u675f\u8282\u70b9\u548c\u53d7\u7ea6\u675f\u7684\u7f51\u7edc\u3002 Constrained Application Protocol Constrained Application Protocol is a specialized Internet Application Protocol for constrained devices, as defined in RFC 7252. NB-IoT001 NB-IoT \u7a84\u5e26\u7269\u8054\u7f51 \u7a84\u5e26\u7269\u8054\u7f51, \u662f\u53ef\u4e0e\u8702\u7a9d\u7f51\u878d\u5408\u6f14\u8fdb\u7684\u4f4e\u6210\u672c\u7535\u4fe1\u7ea7\u9ad8\u53ef\u9760\u6027\u3001\u9ad8\u5b89\u5168\u6027\u5e7f\u57df\u7269\u8054\u7f51\u6280\u672f\u3002 Narrow Band Internet of Things The narrowband Internet of Things is a low-cost carrier-class, high-reliability, high-security wide-area Internet of Things technology that can evolve with cellular networks. LORa001 LoRa \u8fdc\u8ddd\u79bb\u65e0\u7ebf\u7535 \u8fdc\u8ddd\u79bb\u65e0\u7ebf\u7535, \u662fsemtech\u516c\u53f8\u521b\u5efa\u7684\u4f4e\u529f\u8017\u5c40\u57df\u7f51\u65e0\u7ebf\u6807\u51c6\u3002 Long Range Radio Long-range radio is a low-power LAN wireless standard created by Semtech. LPWA001 LPWA \u4f4e\u529f\u8017\u5e7f\u57df\u7f51\u7edc \u4f4e\u529f\u8017\u5e7f\u57df\u7f51\u7edc\uff0c\u662f\u9762\u5411\u7269\u8054\u7f51\u4e2d\u8fdc\u8ddd\u79bb\u548c\u4f4e\u529f\u8017\u7684\u901a\u4fe1\u9700\u6c42\uff0c\u51fa\u73b0\u7684\u4e00\u79cd\u7269\u8054\u7f51\u65e0\u7ebf\u8fde\u63a5\u6280\u672f\uff0c\u5177\u6709\u4f20\u8f93\u8ddd\u79bb\u8fdc\u3001\u8282\u70b9\u529f\u8017\u4f4e\u3001\u7f51\u7edc\u7ed3\u6784\u7b80\u5355\u3001\u8fd0\u884c\u7ef4\u62a4\u6210\u672c\u4f4e\u7684\u6280\u672f\u7279\u70b9\u3002 Low Power Wide Area Low-power wide-area network is a kind of communication technology for long-distance and low-power communication in the Internet of Things. An Internet of Things wireless connection technology has the technology of long transmission distance, low node power consumption, simple network structure and low operation and maintenance cost. Features. SAL001 SAL \u5957\u63a5\u5b57\u62bd\u8c61\u5c42 Socket Abstraction Layer DTLS001 DTLS \u6570\u636e\u5305\u4f20\u8f93\u5c42\u5b89\u5168\u6027\u534f\u8bae \u6570\u636e\u5305\u4f20\u8f93\u5c42\u5b89\u5168\u6027\u534f\u8bae\uff0c\u5b89\u5168\u4f20\u8f93\u5c42\u534f\u8bae\u4e0d\u80fd\u7528\u6765\u4fdd\u8bc1UDP\u4e0a\u4f20\u8f93\u7684\u6570\u636e\u7684\u5b89\u5168\uff0c\u56e0\u6b64Datagram TLS\u662f\u5728\u73b0\u5b58\u7684TLS\u534f\u8bae\u67b6\u6784\u4e0a\u63d0\u51fa\u6269\u5c55\uff0c\u4f7f\u4e4b\u652f\u6301UDP\uff0c\u5373\u6210\u4e3aTLS\u7684\u4e00\u4e2a\u652f\u6301\u6570\u636e\u62a5\u4f20\u8f93\u7684\u7248\u672c\u3002 Datagram Transport Layer Security Datagram transport layer security protocol, the secure transport layer protocol can not be used to ensure the security of data transmitted over UDP. Therefore, Datagram TLS is extended on the existing TLS protocol architecture to support UDP, which is a supporting data of TLS. The version of the transmission. TLS001 TLS \u5b89\u5168\u4f20\u8f93\u5c42\u534f\u8bae \u5b89\u5168\u4f20\u8f93\u5c42\u534f\u8bae\u7528\u4e8e\u5728\u4e24\u4e2a\u901a\u4fe1\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u63d0\u4f9b\u4fdd\u5bc6\u6027\u548c\u6570\u636e\u5b8c\u6574\u6027\u3002 Transport Layer Security The secure transport layer protocol is used to provide confidentiality and data integrity between two communication applications. OTA001 OTA \u7a7a\u4e2d\u4e0b\u8f7d\u6280\u672f \u7a7a\u4e2d\u4e0b\u8f7d\u6280\u672f\uff0c\u7269\u8054\u7f51\u9886\u57df\u4e3b\u8981\u7528\u4e8e\u4ece\u4e91\u7aef\u89e6\u53d1\u5347\u7ea7\uff0c\u66f4\u65b0\u7ec8\u7aef\u8bbe\u5907\u7684\u56fa\u4ef6\u3002 Over\uff0dthe\uff0dAir Technology Over\uff0dthe\uff0dAir Technology, the Internet of Things field is mainly used to trigger upgrades from the cloud and update the firmware of the terminal device.","title":"TencentOS tiny \u8bcd\u6c47\u672f\u8bed\u8868"},{"location":"08.QCloud_IoTHub_Quick_Start/","text":"TencentOS tiny\u7aef\u4e91\u5bf9\u63a5\u5f00\u53d1\u6307\u5357\uff08IoTHub\uff09 Revision Date Description 1.0 2019-1-15 \u6587\u6863\u521d\u7248 2.0 2019-8-13 \u6587\u6863V2.0 3.0 2020-02-26 \u6587\u6863V3.0 \u6982\u89c8 \u817e\u8baf\u7269\u8054\u7f51\u901a\u4fe1\uff08IoT Hub\uff09\u670d\u52a1\uff0c\u65e8\u5728\u63d0\u4f9b\u4e00\u4e2a\u5b89\u5168\u3001\u7a33\u5b9a\u3001\u9ad8\u6548\u7684\u8fde\u63a5\u5e73\u53f0\uff0c\u5e2e\u52a9\u5f00\u53d1\u8005\u4f4e\u6210\u672c\u3001\u5feb\u901f\u5730\u5b9e\u73b0\u201c\u8bbe\u5907-\u8bbe\u5907\u201d\u3001\u201c\u8bbe\u5907-\u7528\u6237\u5e94\u7528\u201d\u3001\u201c\u8bbe\u5907-\u4e91\u670d\u52a1\u201d\u4e4b\u95f4\u53ef\u9760\u3001\u9ad8\u5e76\u53d1\u7684\u6570\u636e\u901a\u4fe1\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u817e\u8baf\u7269\u8054\u7f51\u901a\u4fe1\u53ef\u4ee5\u5b9e\u73b0\u8bbe\u5907\u4e4b\u95f4\u7684\u4e92\u52a8\u3001\u8bbe\u5907\u7684\u6570\u636e\u4e0a\u62a5\u548c\u914d\u7f6e\u4e0b\u53d1\uff0c\u8fd8\u53ef\u4ee5\u57fa\u4e8e\u89c4\u5219\u5f15\u64ce\u548c\u817e\u8baf\u4e91\u4ea7\u54c1\u6253\u901a\uff0c\u65b9\u4fbf\u5feb\u6377\u7684\u5b9e\u73b0\u6d77\u91cf\u8bbe\u5907\u6570\u636e\u7684\u5b58\u50a8\u3001\u8ba1\u7b97\u4ee5\u53ca\u667a\u80fd\u5206\u6790\u3002\u603b\u4e4b\uff0c\u57fa\u4e8e\u817e\u8baf\u7269\u8054\u7f51\u901a\u4fe1\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u4f4e\u6210\u672c\u5b9e\u73b0\u201c\u8bbe\u5907-\u6570\u636e-\u5e94\u7528-\u4e91\u670d\u52a1\u201d\u7684\u8fde\u63a5\uff0c\u5feb\u901f\u642d\u5efa\u7269\u8054\u7f51\u5e94\u7528\u5e73\u53f0\u3002 \u817e\u8baf\u4e91\u7269\u8054\u7f51\u901a\u4fe1\u4ea7\u54c1\u67b6\u6784 \u5728\u4e0a\u56fe\u6240\u793a\u7684\u67b6\u6784\u4e2d, \u672c\u6587\u53ea\u8ba8\u8bba\"\u7528\u6237\u8bbe\u5907\"\u548c\u817e\u8baf\u4e91\u7684\u5bf9\u63a5. \u8fd9\u4e0a\u56fe\u4e2d\u53ef\u4ee5\u770b\u5230, \"\u7528\u6237\u8bbe\u5907\"\u548c\u817e\u8baf\u4e91\u4e4b\u95f4\u662f\u57fa\u4e8e MQTT \u534f\u8bae\u6216\u662f CoAP \u534f\u8bae\u8fdb\u884c\u901a\u4fe1\u7684. \u56e0\u6b64, \u5728\"\u7528\u6237\u8bbe\u5907\"\u4e0a, \u9700\u8981\u5305\u542b\u8fde\u63a5SDK\u6216\u662f\u5b9e\u73b0\u4e86MQTT\u6216CoAP\u534f\u8bae\u7684\u4ee3\u7801. \u672c\u6587\u8bb2\u8ff0MQTT\u8fde\u63a5\u65b9\u6cd5, CoAP\u534f\u8bae\u7c7b\u4f3c. MQTT\u7b80\u4ecb \u7269\u8054\u7f51 (IoT) \u8bbe\u5907\u5fc5\u987b\u8fde\u63a5\u4e92\u8054\u7f51. \u901a\u8fc7\u8fde\u63a5\u5230\u4e92\u8054\u7f51, \u8bbe\u5907\u5c31\u80fd\u76f8\u4e92\u534f\u4f5c, \u4ee5\u53ca\u4e0e\u540e\u7aef\u670d\u52a1\u534f\u540c\u5de5\u4f5c. \u4e92\u8054\u7f51\u7684\u57fa\u7840\u7f51\u7edc\u534f\u8bae\u662f TCP/IP. MQTT(\u6d88\u606f\u961f\u5217\u9065\u6d4b\u4f20\u8f93)\u662f\u57fa\u4e8e TCP/IP \u534f\u8bae\u6808\u800c\u6784\u5efa\u7684, \u5df2\u6210\u4e3a IoT \u901a\u4fe1\u7684\u6807\u51c6. MQTT\u672c\u8eab\u662f\u4e2a\u8f7b\u91cf\u7ea7\u7684\u534f\u8bae, \u53ef\u4ee5\u5728\u786c\u4ef6\u53d7\u9650\u8bbe\u5907\u4e0a\u5b9e\u73b0. \u540c\u65f6, MQTT\u534f\u8bae\u652f\u6301\u5728\u5404\u65b9\u4e4b\u95f4\u5f02\u6b65\u901a\u4fe1\u7684\u6d88\u606f\u534f\u8bae, \u5f02\u6b65\u6d88\u606f\u534f\u8bae\u5728\u7a7a\u95f4\u548c\u65f6\u95f4\u4e0a\u5c06\u6d88\u606f\u53d1\u9001\u8005\u4e0e\u63a5\u6536\u8005\u5206\u79bb, \u56e0\u6b64\u53ef\u4ee5\u5728\u4e0d\u53ef\u9760\u7684\u7f51\u7edc\u73af\u5883\u4e2d\u8fdb\u884c\u6269\u5c55. MQTT\u7684\u7075\u6d3b\u6027\u4f7f\u5f97\u4e3a IoT \u8bbe\u5907\u548c\u670d\u52a1\u7684\u591a\u6837\u5316\u5e94\u7528\u573a\u666f\u63d0\u4f9b\u652f\u6301\u6210\u4e3a\u53ef\u80fd. MQTT\u534f\u8bae\u57fa\u4e8e\u53d1\u5e03(Publish)\u548c\u8ba2\u9605(Subscribe)\u6a21\u578b. \u5728\u7f51\u7edc\u4e2d\u5b9a\u4e49\u4e86\u4e24\u79cd\u5b9e\u4f53\u7c7b\u578b: \u6d88\u606f\u4ee3\u7406\u7aef(Broker) \u548c \u5ba2\u6237\u7aef(Client) , \u4ee3\u7406\u662f\u4e00\u4e2a\u670d\u52a1\u5668, \u5b83\u4ece\u5ba2\u6237\u7aef\u63a5\u6536\u6240\u6709\u6d88\u606f, \u7136\u540e\u5c06\u8fd9\u4e9b\u6d88\u606f\u8def\u7531\u5230\u76f8\u5173\u7684\u76ee\u6807\u5ba2\u6237\u7aef. \u5ba2\u6237\u7aef\u662f\u80fd\u591f\u4e0e\u4ee3\u7406\u4ea4\u4e92\u6765\u53d1\u9001\u548c\u63a5\u6536\u6d88\u606f\u7684\u4efb\u4f55\u4e8b\u7269. \u5ba2\u6237\u7aef\u53ef\u4ee5\u662f\u73b0\u573a\u7684 IoT \u4f20\u611f\u5668, \u6216\u8005\u662f\u6570\u636e\u4e2d\u5fc3\u5185\u5904\u7406 IoT \u6570\u636e\u7684\u5e94\u7528\u7a0b\u5e8f. Client\u548cBroker\u4e4b\u95f4\u7684\u53d1\u5e03\u548c\u8ba2\u9605\u662f\u6839\u636e\u4e3b\u9898(Topic)\u6765\u8fdb\u884c\u7684, \u4e0d\u540c\u7684\u5ba2\u6237\u7aef\u53ef\u4ee5\u5411\u4e0d\u540c\u7684\u4e3b\u9898\u53d1\u5e03\u6d88\u606f, \u8bbe\u5907\u53ea\u6709\u5728\u8ba2\u9605\u4e86\u67d0\u4e2a\u4e3b\u9898\u540e, \u624d\u80fd\u6536\u5230\u76f8\u5e94\u4e3b\u9898\u7684\u6d88\u606f. \u4e91\u7aef\u8bbe\u7f6e \u4e91\u7aef\u8bbe\u7f6e\u4e3b\u8981\u5305\u542b\u4e86, \u521b\u5efa\u65b0\u4ea7\u54c1, \u521b\u5efa\u65b0\u8bbe\u5907 \u767b\u5f55\u817e\u8baf\u4e91, \u641c\u7d22\"\u4e91\u4ea7\u54c1\"\u4e0b\u7684\"\u7269\u8054\u7f51\u901a\u4fe1\"\u4ea7\u54c1, \u6216\u76f4\u63a5\u8bbf\u95ee https://console.cloud.tencent.com/iotcloud \u521b\u5efa\u65b0\u4ea7\u54c1 \u5728\"\u6dfb\u52a0\u65b0\u4ea7\u54c1\"\u7684\u65f6\u5019, \u6ce8\u610f\u9009\u62e9. \u4ea7\u54c1\u7c7b\u578b\u9009\u62e9 \u666e\u901a\u4ea7\u54c1 , \u4ea7\u54c1\u540d\u79f0\u968f\u610f, \u8ba4\u8bc1\u65b9\u5f0f\u9009\u62e9 \u5bc6\u94a5\u8ba4\u8bc1 , \u6570\u636e\u683c\u5f0f\u9009\u62e9 \u81ea\u5b9a\u4e49 . \u5173\u4e8e\u8ba4\u8bc1\u65b9\u5f0f\u548c\u6570\u636e\u683c\u5f0f\u7684\u9009\u62e9\u89e3\u91ca \u8ba4\u8bc1\u65b9\u5f0f\u9ed8\u8ba4\u7684\u662f\u8bc1\u4e66\u8ba4\u8bc1, \u6570\u636e\u683c\u5f0f\u9ed8\u8ba4\u7684\u662fjson\u683c\u5f0f. \u5bf9\u4e8e\u8ba4\u8bc1\u65b9\u5f0f, \u6307\u5b9a\u4e86\u8bbe\u5907\u901a\u8fc7\u4f55\u79cd\u65b9\u5f0f\u548c\u4e91\u7aef\u8fdb\u884c\u53cc\u5411\u8ba4\u8bc1. \u9ed8\u8ba4\u7684\u8bc1\u4e66\u65b9\u5f0f\u76f8\u5bf9\u4e8e\u5bc6\u94a5\u8ba4\u8bc1\u5b89\u5168\u6027\u9ad8\u4e00\u70b9, \u4f46\u662f\u95ee\u9898\u5728\u4e8e\u8bc1\u4e66\u65b9\u5f0f\u9700\u8981\u5728\u5d4c\u5165\u5f0f\u8bbe\u5907\u7aef\u5b58\u50a8\u8bc1\u4e66\u540c\u65f6\u5b9e\u73b0\u8bc1\u4e66\u7684\u76f8\u5173\u5904\u7406, \u5bf9\u8bbe\u5907\u7684RAM\u548cROM\u8981\u6c42\u8f83\u9ad8, \u76f8\u5bf9\u800c\u8a00, \u5bc6\u94a5\u8ba4\u8bc1\u7684\u65b9\u5f0f\u8d44\u6e90\u5360\u7528\u91cf\u5c31\u5c0f\u70b9, \u7531\u4e8e\u6211\u4eec\u4e3b\u8981\u652f\u6301\u7684\u8bbe\u5907\u90fd\u662f\u5c0f\u578b\u5d4c\u5165\u5f0f\u8bbe\u5907, \u56e0\u6b64\u9009\u7528\u5bc6\u94a5\u8ba4\u8bc1. \u6570\u636e\u683c\u5f0f\u6307\u7684\u662f\u8bbe\u5907\u548c\u4e91\u7aef\u8fdb\u884c\u6570\u636e\u4ea4\u4e92\u65f6\u5019\u4f7f\u7528\u7684\u683c\u5f0f, json\u683c\u5f0f\u4e3a\u6587\u672c\u5b57\u7b26\u4e32, \u53ef\u8bfb\u6027\u9ad8, \u5e76\u4e14\u4fbf\u4e8e\u89e3\u6790, \u5bf9\u4e8e\u529f\u80fd\u590d\u6742\u7684\u8bbe\u5907\u4ea4\u4e92\u800c\u5df2\u6bd4\u8f83\u7406\u60f3, \u4f46\u662f\u5bf9\u4e8e\u5c0f\u578b\u8bbe\u5907\u6216\u662f\u5b9a\u5236\u8bbe\u5907, \u6570\u636e\u5355\u4e00, \u6216\u662f\u6709\u81ea\u5b9a\u4e49\u7684\u683c\u5f0f(\u4e8c\u8fdb\u5236\u6216\u662f\u6587\u672c), \u8fd9\u79cd\u65f6\u5019, \u7528\u81ea\u5b9a\u4e49\u7684\u6570\u636e\u683c\u5f0f, \u4e00\u65b9\u9762\u8282\u7ea6\u6d41\u91cf, \u53e6\u4e00\u65b9\u9762\u6bd4\u8f83\u7075\u6d3b. \u6ce8: \u8fd9\u91cc\u7684\u6570\u636e\u683c\u5f0f\u9009\u62e9\u4f1a\u5f71\u54cd\u4e4b\u540e\u817e\u8baf\u4e91\"\u89c4\u5219\u5f15\u64ce\"\u7ec4\u4ef6\u7684\u8bbe\u7f6e. \u65b0\u5efa\u5b8c\u4ea7\u54c1\u540e, \u4f1a\u83b7\u5f97\u4e00\u4e2a\u5e73\u53f0\u5206\u914d\u7684 productID . \u521b\u5efa\u65b0\u8bbe\u5907 \u8bbe\u7f6e\u7684\u65f6\u5019\u53ea\u9700\u8981\u8bbe\u7f6e\u8bbe\u5907\u540d\u79f0\u5373\u53ef, \u7531\u4e8e\u6211\u4eec\u5728\u521b\u5efa\u4ea7\u54c1\u7684\u65f6\u5019, \u8ba4\u8bc1\u65b9\u5f0f\u9009\u62e9\u4e86\u5bc6\u94a5\u8ba4\u8bc1, \u56e0\u6b64\u5728\u521b\u5efa\u8bbe\u5907\u7684\u65f6\u5019\u5c06\u4f1a\u63d0\u4f9b\u8bbe\u5907\u5bf9\u5e94\u7684\u5bc6\u94a5, \u8fd9\u91cc\u9009\u62e9\u9ed8\u8ba4\u7684\"\u4f7f\u7528\u7269\u8054\u901a\u901a\u4fe1\u63d0\u4f9b\u7684\u5bc6\u94a5\"\u5373\u53ef. \u6dfb\u52a0\u5b8c\u8bbe\u5907\u540e, \u4f1a\u544a\u77e5\u8bbe\u5907\u5bf9\u5e94\u7684\u5bc6\u94a5. \u8be5\u5bc6\u94a5\u5c06\u4f1a\u7528\u4e8e\u4e4b\u540e\u8bbe\u5907\u4e0e\u5e73\u53f0\u901a\u4fe1\u65f6\u7684\u8ba4\u8bc1. \u4e3a\u4e86\u5b9e\u73b0\u8bbe\u5907\u95f4\u7684\u901a\u4fe1, \u6211\u4eec\u8fd8\u9700\u8981\u521b\u5efa\u7b2c\u4e8c\u4e2a\u8bbe\u5907, \u64cd\u4f5c\u540c\u4e0a, \u4e0d\u59a8\u5c06\u5176\u547d\u540d\u4e3a\"dev2\". \u6b64\u65f6, \u5728\u4ea7\u54c1\"my_product\"\u4e0b\u9762, \u67092\u4e2a\u6211\u4eec\u6dfb\u52a0\u7684\u8bbe\u5907, \u5206\u522b\u4e3a\"dev1\"\u548c\"dev2\". Topic\u8bbe\u7f6e \u6211\u4eec\u77e5\u9053, \u8bbe\u5907\u901a\u8fc7MQTT\u534f\u8bae\u8fdb\u884c\u901a\u4fe1, \u662f\u57fa\u4e8e\u53d1\u5e03(publish)\u548c\u8ba2\u9605(subscribe)\u76f8\u5173\u7684\u8bdd\u9898(topic)\u6765\u8fdb\u884c\u7684, \u56e0\u6b64, \u8fd8\u9700\u8981\u5728\u4e91\u7aef\u5bf9\u8bdd\u9898\u8fdb\u884c\u8bbe\u7f6e. \u6211\u4eec\u53ef\u4ee5\u5728\"\u6743\u9650\u5217\u8868\"\u4e2d\u770b\u5230Topic\u5bf9\u5e94\u7684\u64cd\u4f5c\u6743\u9650, \u6b64\u5904\u8fd8\u53ef\u4ee5\u6dfb\u52a0\u65b0\u7684Topic. \u5728\u8fd9\u91cc, \u6211\u4eec\u53ef\u4ee5\u770b\u5230, \u5e73\u53f0\u9ed8\u8ba4\u914d\u7f6e\u4e86\u4e09\u7c7b\u7684Topic, \u7528\u4e8e\u6267\u884c\u53d1\u5e03\u548c\u8ba2\u9605. \u8fd9\u91cc\u4e4b\u6240\u4ee5\u662f\u4e09\u7c7b\u800c\u4e0d\u662f\u4e09\u4e2a, \u662f\u56e0\u4e3aTopic\u91cc\u4f7f\u7528\u4e86\u53d8\u91cf. \u8fd9\u91cc\u7684 25KCIUIR1G \u5b9e\u9645\u4e0a\u662fproductID; ${deviceName} \u4e3a\u5e73\u53f0\u8bbe\u7f6e\u7684\u53d8\u91cf, \u5373\u8bbe\u5907\u540d; control \u548c data \u4ee5\u53ca event \u4e3aTopic\u540d\u5b57. \u6240\u4ee5, \u5728\u6211\u4eec\u521b\u5efa\u4e862\u4e2a\u8bbe\u5907dev1\u548cdev2\u7684\u60c5\u51b5\u4e0b, \u5728my_product\u4ea7\u54c1\u4e0b, \u5373\u5b58\u57286\u4e2aTopic, \u5206\u522b\u4e3a: 25KCIUIR1G/dev1/control \u8ba2\u9605\u6743\u9650 25KCIUIR1G/dev1/data \u53d1\u5e03\u548c\u8ba2\u9605\u6743\u9650 25KCIUIR1G/dev1/event \u53d1\u5e03\u6743\u9650 25KCIUIR1G/dev2/control \u8ba2\u9605\u6743\u9650 25KCIUIR1G/dev2/data \u53d1\u5e03\u548c\u8ba2\u9605\u6743\u9650 25KCIUIR1G/dev2/event \u53d1\u5e03\u6743\u9650 \u8fd9\u91cc\u9ed8\u8ba4\u7684Topic\u5df2\u7ecf\u8db3\u591f\u6211\u4eec\u4f7f\u7528, \u4e0d\u9700\u8981\u989d\u5916\u6dfb\u52a0Topic\u548c\u6743\u9650\u4e86. MQTT\u7684Topic\u672c\u8eab\u662f\u4e00\u4e2a\u666e\u901a\u7684\u5b57\u7b26\u4e32, \u4f46\u662f\u53ef\u4ee5\u7531\u591a\u4e2a\u5c42\u7ea7\u7ec4\u6210, \u6839\u636e / \u6765\u5212\u5206. \u8fd9\u79cd\u5206\u5c42\u7684Topic\u7ed3\u6784\u4f7f\u5f97\u4e3b\u9898\u7684\u8fc7\u6ee4\u548c\u5339\u914d\u53d8\u5f97\u76f8\u5bf9\u7075\u6d3b. \u591a\u5c42\u901a\u914d\u7b26\"#\" \u5fc5\u987b\u4f4d\u4e8e\u6700\u540e\u4e00\u4e2a\u5b57\u7b26, \u5339\u914d\u591a\u5c42\u7ea7. \u4f8b\u5982\u5bf9\u4e8e 25KCIUIR1G/# , \u5c06\u4f1a\u5339\u914d 25KCIUIR1G/dev1 , 25KCIUIR1G/dev2 , 25KCIUIR1G/dev1/control , 25KCIUIR1G/dev1/event , 25KCIUIR1G/dev2/control \u548c 25KCIUIR1G/dev2/event \u4e3b\u9898. \u5355\u5c42\u901a\u914d\u7b26\"+\" \u5339\u914d\u5355\u4e2a\u5c42\u7ea7, \u5728\u4e3b\u9898\u7684\u4efb\u4f55\u5c42\u7ea7\u90fd\u53ef\u4ee5\u4f7f\u7528, \u5305\u62ec\u7b2c\u4e00\u4e2a\u5c42\u7ea7\u548c\u6700\u540e\u4e00\u4e2a\u5c42\u7ea7. \u4f8b\u5982, \u5bf9\u4e8e 25KCIUIR1G/+/event , \u5c06\u4f1a\u5339\u914d 25KCIUIR1G/dev1/event \u548c 25KCIUIR1G/dev2/event . \u8bbe\u7f6e\u89c4\u5219\u5f15\u64ce \u89c4\u5219\u5f15\u64ce\u672c\u8eab\u4e0d\u5c5e\u4e8eMQTT\u534f\u8bae\u7684\u8303\u7574, \u4f46\u662f\u5e73\u53f0\u4fa7\u51fa\u4e8e\u5b89\u5168\u89d2\u5ea6\u8003\u8651\u6dfb\u52a0\u4e86\u89c4\u5219\u5f15\u64ce, \u5b9e\u73b0\u4e86Topic\u4e4b\u95f4\u7684\u8f6c\u53d1\u64cd\u4f5c, \u6211\u4eec\u9700\u8981\u5408\u7406\u7684\u8bbe\u7f6e\u89c4\u5219\u5f15\u64ce\u624d\u80fd\u5b9e\u73b0\u591a\u4e2a\u8bbe\u5907\u4e4b\u95f4\u7684\u6570\u636e\u6536\u53d1, \u7531\u4e8e\u7406\u89e3\u8d77\u6765\u6bd4\u8f83\u590d\u6742, \u6211\u4eec\u8fd9\u91cc\u7b80\u8981\u8bb2\u89e3\u4e0b\u4e3a\u4ec0\u4e48\u9700\u8981\u89c4\u5219\u5f15\u64ce, \u89c4\u5219\u5f15\u64ce\u7684\u4f5c\u7528, \u5982\u4f55\u8bbe\u7f6e\u89c4\u5219\u5f15\u64ce. \u4e3a\u4ec0\u4e48\u9700\u8981\u89c4\u5219\u5f15\u64ce \u5728\u4e0a\u8282\u7684Topic\u4e2d, \u6211\u4eec\u77e5\u9053, \u5728\u5e73\u53f0\u4fa7, \u5bf9\u4e8e\u4e0d\u540c\u7684Topic, \u89c4\u5b9a\u4e86\u4e0d\u540c\u7684\u6743\u9650, \u4f8b\u5982, \u5bf9\u4e8e 25KCIUIR1G/dev1/event \u8fd9\u4e2aTopic, \u53ea\u5177\u6709\u53d1\u5e03\u6743\u9650, \u800c\u5bf9\u4e8e 25KCIUIR1G/dev1/control \u8fd9\u4e2aTopic, \u53ea\u5177\u6709\u8ba2\u9605\u6743\u9650. \u5bf9\u4e8e\u8bbe\u5907dev1, \u5f88\u81ea\u7136\u7684, \u4f1a\u671d 25KCIUIR1G/dev1/event \u8fd9\u4e2aTopic\u53d1\u9001\u6570\u636e, \u5e76\u4e14\u8ba2\u9605 25KCIUIR1G/dev1/control \u8fd9\u4e2aTopic\u7684\u6d88\u606f. \u4f46\u662f\u8fd9\u91cc\u5c31\u4f1a\u6d89\u53ca\u5230, event\u7684\u6570\u636e\u6700\u540e\u5230\u54ea\u53bb, control\u7684\u6570\u636e\u4ece\u54ea\u91cc\u6765\u7684\u95ee\u9898. \u5728\u672c\u6587\u7684\u4f8b\u5b50\u4e2d, \u6211\u4eec\u5e0c\u671bdev1\u548cdev2\u53d1\u751f\u4ea4\u4e92, \u5373\u76f8\u4e92\u6536\u53d1\u6d88\u606f. \u7531\u4e8eMQTT\u662f\u57fa\u4e8eTopic\u7684\u53d1\u5e03\u8ba2\u9605\u673a\u5236, \u56e0\u6b64, dev1\u60f3\u8981\u83b7\u5f97dev2\u7684\u6570\u636e, \u76f4\u89c9\u4e0a, \u9700\u8981\u8ba2\u9605dev2\u53d1\u5e03\u6d88\u606f\u7684\u90a3\u4e2aTopic. \u5047\u5b9adev2\u671d 25KCIUIR1G/dev2/event Topic\u4e0a\u53d1\u9001\u6570\u636e, \u90a3\u4e48dev1\u60f3\u8981\u83b7\u5f97dev2\u53d1\u5e03\u7684\u6d88\u606f, \u6700\u76f4\u63a5\u7684\u529e\u6cd5\u662f\u8ba2\u9605\u540c\u6837\u7684Topic, \u5373 25KCIUIR1G/dev2/event , \u4f46\u662f\u8fd9\u91cc\u5b58\u5728\u51e0\u4e2a\u95ee\u9898, \u9996\u5148, event Topic\u53ea\u5177\u6709\u53d1\u5e03\u6743\u9650, \u6ca1\u6709\u8ba2\u9605\u6743\u9650, \u5176\u6b21, \u5728\u5e73\u53f0\u4fa7, \u89c4\u5b9a\u4e86, \u4e0d\u5141\u8bb8\u8de8\u8bbe\u5907\u53d1\u5e03\u6216\u662f\u8ba2\u9605Topic , \u4e5f\u5c31\u662f\u8bf4, \u5bf9\u4e8edev1, \u53ea\u80fd\u770b\u5230\u6216\u53ea\u5141\u8bb8\u8bbf\u95ee 25KCIUIR1G/dev1 \u8fd9\u4e2aTopic\u4ee5\u53ca\u5176\u4e0b\u5c5e\u7684Topic, \u4e0d\u80fd\u8bbf\u95ee 25KCIUIR1G/dev2 \u53ca\u5176\u4e0b\u5c5eTopic. \u5e73\u53f0\u4fa7\u6dfb\u52a0\u4e0d\u5141\u8bb8\u8de8\u8bbe\u5907\u8bbf\u95eeTopic\u7684\u89c4\u5219\u867d\u7136\u4e0d\u76f4\u89c2, \u4f46\u5374\u662f\u5408\u7406\u7684. \u5982\u679c\u4e0d\u6dfb\u52a0\u8fd9\u6761\u9650\u5236, \u90a3\u4e48\u4e00\u4e2a\u8bbe\u5907\u53ef\u4ee5\u4e0d\u52a0\u9650\u5236\u7684\u8ba2\u9605\u540c\u4e00\u4e2a\u4ea7\u54c1\u4e0b\u6240\u6709\u5176\u4ed6\u8bbe\u5907\u7684Topic, \u83b7\u53d6\u5176\u4e0a\u62a5\u7684\u6d88\u606f, \u8fd9\u5b58\u5728\u6f5c\u5728\u7684\u5b89\u5168\u6f0f\u6d1e. \u89c4\u5219\u5f15\u64ce\u7684\u4f5c\u7528 \u56e0\u4e3a\u4e0d\u5141\u8bb8\u76f4\u63a5\u8de8\u8bbe\u5907\u8bbf\u95eeTopic, \u6240\u4ee5\u9700\u8981\u4f9d\u9760\"\u89c4\u5219\u5f15\u64ce\"\u6765\u624b\u52a8\u6dfb\u52a0\u89c4\u5219, \u5c06\u6307\u5b9a\u7684Topic\u6d88\u606f\u8f6c\u53d1\u5230\u53e6\u4e00\u4e2aTopic\u4e0a, \u5b9e\u73b0\u4e0d\u540c\u8bbe\u5907\u4e4b\u95f4\u7684\u901a\u4fe1. \u4e0a\u56fe\u4ecb\u7ecd\u4e86\u89c4\u5219\u5f15\u64ce\u7684\u4e3b\u8981\u4f5c\u7528\"republish\", \u5373\u5c06\u4e00\u4e2aTopic\u4e0b\u7684\u6d88\u606frepublish\u5230\u53e6\u4e00\u4e2aTopic\u4e0b. \u4ece\u56fe\u4e2d\u6211\u4eec\u53ef\u4ee5\u770b\u5230, \uff08\u4ea7\u54c1ID\u4ee5\u60a8\u5b9e\u9645\u7684ID\u4e3a\u51c6\uff09\u89c4\u5219\u5f15\u64ce\u5c06 25KCIUIR1G/dev2/event \u7684\u6d88\u606frepublish\u5230\u4e86 25KCIUIR1G/dev1/control \u4e0b. \u5c06 25KCIUIR1G/dev1/event \u7684\u6d88\u606frepublish\u5230\u4e86 25KCIUIR1G/dev2/control \u4e0b. \u8fd9\u6837, \u5bf9\u4e8edev1\u800c\u8a00, \u53ea\u9700\u8981\u8ba2\u9605 25KCIUIR1G/dev1/control \u5c31\u53ef\u4ee5\u63a5\u6536\u6765\u81ea 25KCIUIR1G/dev2/event \u7684\u6d88\u606f\u4e86. dev2\u540c\u7406. \u8bbe\u7f6e\u89c4\u5219\u5f15\u64ce \u5728\u7269\u8054\u7f51\u901a\u4fe1\u754c\u9762\u9009\u62e9\"\u89c4\u5219\u5f15\u64ce\"--\"\u65b0\u5efa\u89c4\u5219\", \u968f\u610f\u6307\u5b9a\u4e00\u4e2a\u89c4\u5219\u540d\u79f0, \u6211\u4eec\u8fd9\u91cc\u4e0d\u59a8\u8bbe\u7f6e\u4e3a\"1to2\". \u8fd9\u91cc, \u6211\u4eec\u770b\u5230\u89c4\u5219\u7684\u8be6\u7ec6\u8bbe\u7f6e\u4fe1\u606f, \u4e3b\u8981\u5305\u62ec\"\u7b5b\u9009\u6570\u636e\"\u548c\"\u884c\u4e3a\u64cd\u4f5c\". \"\u7b5b\u9009\u6570\u636e\"\u9488\u5bf9\u6307\u5b9aTopic\u63a5\u6536\u5230\u7684\u6d88\u606f\u5185\u5bb9\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u7b5b\u9009, \u6bd4\u5982\u5339\u914d\u6d88\u606f\u4e2d\u7684\u5b57\u6bb5\u6765\u51b3\u5b9a\u662f\u5426\u6267\u884c\u4e4b\u540e\u7684\u8bbe\u7f6e\u7684\"\u884c\u4e3a\u64cd\u4f5c\". \u800c\"\u884c\u4e3a\u64cd\u4f5c\"\u5219\u662f\u6307\u5b9a\u5bf9\u901a\u8fc7\u5339\u914d\u7684\u6d88\u606f\u8fdb\u884c\u4f55\u79cd\u64cd\u4f5c, \u4e3b\u8981\u7684\u64cd\u4f5c\u6709\"\u6570\u636e\u8f6c\u53d1\u5230\u53e6\u4e00\u4e2aTopic(Republish)\", \"\u8f6c\u53d1\u5230\u7b2c\u4e09\u65b9\u670d\u52a1(Forward)\"\u4ee5\u53ca\u8f6c\u53d1\u5230\u817e\u8baf\u4e91\u5404\u4e2a\u5bf9\u5e94\u7ec4\u4ef6\u4e2d. \u4e0a\u56fe\u662f\u8bbe\u7f6e\u597d\u7684\u89c4\u5219, \u8fd9\u91cc, \u6211\u4eec\u5c06\"\u7b5b\u9009\u6570\u636e\"\u90e8\u5206\u7684\u7b5b\u9009\u5b57\u6bb5\u8bbe\u7f6e\u4e3a * , \u7b5b\u9009\u7684Topic\u4e3a 25KCIUIR1G/dev1/event , \u6761\u4ef6\u8bbe\u7f6e\u4e3a\u7a7a, \u5373\u4e0d\u7b5b\u9009\u6570\u636e, \u5168\u90e8\u5339\u914d. \u7136\u540e, \u6267\u884c\u7684\u64cd\u4f5c\u662f\u5c06\u6570\u636e\u8f6c\u53d1\u5230 25KCIUIR1G/dev2/control , \u8bbe\u7f6e\u5b8c\u8fd9\u6761\u89c4\u5219, \u5c31\u5b9e\u73b0\u4e86dev2\u901a\u8fc7\u8ba2\u9605control\u5c31\u80fd\u6536\u5230dev1\u53d1\u9001\u5230event\u7684\u6570\u636e. \u5173\u4e8e\"\u7b5b\u9009\u6570\u636e\"\u7684\u8bbe\u5b9a \u7531\u4e8e\u6211\u4eec\u5728\u65b0\u5efa\u4ea7\u54c1, \u8bbe\u7f6e\u6570\u636e\u683c\u5f0f\u7684\u65f6\u5019\u9009\u62e9\u4e86\u81ea\u5b9a\u4e49\u6570\u636e\u683c\u5f0f, \u5728\u81ea\u5b9a\u4e49\u6570\u636e\u683c\u5f0f\u7684\u60c5\u51b5\u4e0b, \u5f53\u524d\u5e73\u53f0\u5c06\u5176\u5f53\u505a\u4e8c\u8fdb\u5236\u6d41\u6765\u5904\u7406, \u4e5f\u5c31\u65e0\u6cd5\u901a\u8fc7\u5339\u914d\u5b57\u6bb5\u8fdb\u884c\u6570\u636e\u7b5b\u9009. \u5982\u679c\u5728\u8fdb\u884c\u4ea7\u54c1\u7684\u65f6\u5019, \u4f7f\u7528\u6570\u636e\u683c\u5f0f\u662fjson, \u90a3\u4e48\u6b64\u5904\u5c31\u53ef\u4ee5\u6839\u636ejson\u4e2d\u7684\u5b57\u6bb5\u8fdb\u884cSQL\u7684\u5339\u914d\u548c\u7b5b\u9009. \u540c\u7406, \u6211\u4eec\u518d\u8bbe\u7f6e\u65b0\u7684\u4e00\u4e2a\u89c4\u5219\"2to1\", \u5b9e\u73b0 25KCIUIR1G/dev2/event \u5230 25KCIUIR1G/dev1/control \u7684\u8f6c\u53d1. \u89c4\u5219\u5f15\u64ce\u90fd\u8bbe\u7f6e\u597d\u540e\uff0c\u8bb0\u5f97\u70b9\u542f\u7528\u6309\u94ae\uff0c\u8fd9\u6837, \u5728\u5e73\u53f0\u4fa7dev1\u5230dev2\u7684\u53cc\u5411\u6570\u636e\u901a\u8def\u5c31\u6253\u901a\u4e86. \u4e91\u65e5\u5fd7\u548c\u6d88\u606f\u961f\u5217CMQ \u5728\u5e73\u53f0\u4fa7\u90fd\u8bbe\u7f6e\u597d\u540e, \u6211\u4eec\u5728\u4e4b\u540e\u7684\u6d4b\u8bd5\u8fc7\u7a0b\u6216\u662f\u901a\u4fe1\u8fc7\u7a0b\u4e2d, \u5f80\u5f80\u8fd8\u9700\u8981\u67e5\u770b\u5e73\u53f0\u662f\u5426\u6536\u5230\u4e86\u8bbe\u5907\u53d1\u9001\u4e0a\u6765\u7684\u6d88\u606f, \u5bf9\u6d88\u606f\u6267\u884c\u4e86\u54ea\u4e9b\u64cd\u4f5c, \u6d88\u606f\u7684\u5177\u4f53\u5185\u5bb9(payload)\u662f\u4ec0\u4e48. \u817e\u8baf\u4e91\u63d0\u4f9b\u4e86\u7269\u8054\u7f51\u901a\u4fe1\u4ea7\u54c1\u7684\"\u4e91\u65e5\u5fd7\"\u529f\u80fd\u548c\u817e\u8baf\u4e91\u7ec4\u4ef6\"\u6d88\u606f\u961f\u5217CMQ\". \u4e91\u65e5\u5fd7 \u53ef\u4ee5\u5728\u4ea7\u54c1\u5217\u8868\u4e0b\u627e\u5230\"\u4e91\u65e5\u5fd7\", \u70b9\u51fb\u641c\u7d22\u5373\u53ef\u663e\u793a\u5bf9\u5e94\u7684\u884c\u4e3a\u65e5\u5fd7 \u53c2\u8003\u65e5\u5fd7\u5982\u4e0b, \u53ef\u4ee5\u770b\u5230\u65e5\u5fd7\u8bb0\u5f55\u4e86\u8bbe\u5907\u7684\u8fde\u63a5, \u8fde\u63a5\u65ad\u5f00, \u53d1\u5e03, \u8ba2\u9605\u7b49\u884c\u4e3a, \u4e5f\u8bb0\u5f55\u4e86\u89c4\u5219\u5f15\u64ce\u7684\u64cd\u4f5c, \u8fd8\u6709CMQ\u961f\u5217\u7684\u4e00\u4e9b\u884c\u4e3a\u65e5\u5fd7. \u4f46\u662f\u5173\u4e8e\u8bbe\u5907\u53d1\u5e03\u7684\u6d88\u606f\u5185\u5bb9, \u5728\u4e91\u65e5\u5fd7\u4e2d\u65e0\u6cd5\u67e5\u770b, \u9700\u8981\u501f\u52a9\u6d88\u606f\u961f\u5217CMQ. \u6d88\u606f\u961f\u5217CMQ \u53ef\u4ee5\u5728\u4ea7\u54c1\u5217\u8868\u4e2d\u627e\u5230\"\u6d88\u606f\u961f\u5217\"\u9009\u9879, \u8bbe\u7f6e\u961f\u5217\u6240\u60f3\u8981\u63a5\u6536\u7684\u6d88\u606f\u7c7b\u578b\u540e\u4fdd\u5b58\u914d\u7f6e, \u5373\u53ef\u5c06\u5e73\u53f0\u4fa7\u6536\u5230\u7684\u8bbe\u5907\u6d88\u606f\u989d\u5916\u53d1\u9001\u5230\u817e\u8baf\u4e91\u6d88\u606f\u961f\u5217CMQ\u7ec4\u4ef6\u4e2d. \u8bbe\u7f6e\u5b8c\u6d88\u606f\u961f\u5217\u540e\u53ef\u4ee5\u5728\"\u4e91\u4ea7\u54c1\"\u4e2d\u641c\u7d22CMQ, \u5373\u53ef\u627e\u5230\u5bf9\u5e94\u7684\u6d88\u606f\u961f\u5217, \u70b9\u51fb\"\u5f00\u59cb\u63a5\u6536\u6d88\u606f\" \u63a5\u6536\u6d88\u606f\u961f\u5217\u4e2d\u7684\u5185\u5bb9, \u53c2\u8003\u5982\u4e0b \u5176\u4e2d\u53ef\u4ee5\u770b\u5230\u6709\u4e9b\u6d88\u606f\u5e26\u6709\"PayloadLen\"\u548c\"Playload\"\u5b57\u6bb5, \u5373\u4e3a\u5177\u4f53\u7684\u6d88\u606f\u5185\u5bb9. \u5728\u5bc6\u94a5\u8ba4\u8bc1\u4e0b, \u6d88\u606f\u7684\u5185\u5bb9(payload)\u662f\u7ecf\u8fc7base64\u7f16\u7801\u7684, \u6240\u4ee5\u5728\u5e73\u53f0\u4fa7\u770b\u5230\u7684\u6570\u636e\u7c7b\u4f3c\u4e71\u7801\u5b9e\u9645\u4e0a\u662f\u7ecf\u8fc7\u7f16\u7801\u540e\u7684\u7ed3\u679c, \u60f3\u8981\u67e5\u770b\u5177\u4f53\u7684\u5185\u5bb9, \u53ef\u4ee5\u5728linux\u4e0b, echo <payload> | base64 --decode . \u8bbe\u5907\u7ec8\u7aef\u8bbe\u7f6e \u5728\u524d\u6587\u4e2d\u6211\u4eec\u63d0\u5230, \u8bbe\u5907\u7ec8\u7aef\u8ddf\u817e\u8baf\u4e91\u4e4b\u95f4\u7684\u901a\u4fe1\u91c7\u7528\u7684\u662fMQTT\u534f\u8bae, \u800cMQTT\u534f\u8bae\u9700\u8981\u6d88\u606f\u4ee3\u7406\u7aef\u548c\u5ba2\u6237\u7aef\u76f8\u4e92\u914d\u5408, \u56e0\u6b64, \u6211\u4eec\u5728\u7ec8\u7aef\u8bbe\u5907\u4e0a, \u9700\u8981 \u5b9e\u73b0\u4e00\u4e2aMQTT Client . \u817e\u8baf\u4e91\u4e0a\u652f\u6301\u7684MQTT\u534f\u8bae\u548c\u6807\u51c6\u534f\u8bae\u533a\u522b\u4e0d\u5927, \u53ef\u4ee5\u5728 MQTT\u534f\u8bae\u8bf4\u660e \u67e5\u770b\u5177\u4f53\u533a\u522b. \u56e0\u6b64, \u6280\u672f\u4e0a\u6765\u8bf4, \u8bbe\u5907\u7ec8\u7aef\u53ea\u8981\u5b9e\u73b0\u4e86\u6807\u51c6\u7684MQTT\u5ba2\u6237\u7aef, \u5747\u53ef\u4ee5\u8ddf\u817e\u8baf\u4e91\u6b63\u5e38\u901a\u4fe1. \u5728\u672c\u8282\u4e2d, \u6211\u4eec\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528\u817e\u8bafTencentOS tiny\u4e0e\u817e\u8baf\u4e91\u901a\u8fc7MQTT\u8fdb\u884c\u901a\u4fe1. TencentOS Tiny \u96c6\u6210\u4e86\u5bf9MQTT\u548c\u817e\u8baf\u4e91\u7684\u652f\u6301, \u5f00\u53d1\u8005\u53ea\u9700\u8981\u901a\u8fc7\u7b80\u5355\u7684\u8bbe\u7f6e\u5373\u53ef\u5b9e\u73b0\u4e0e\u817e\u8baf\u4e91\u7684\u901a\u4fe1, \u6574\u4f53\u6b65\u9aa4\u4e3b\u8981\u5305\u542b: \u9879\u76ee\u5de5\u7a0b\u4e2d\u6dfb\u52a0MQTT\u7ec4\u4ef6\u76f8\u5173\u6587\u4ef6 \u9002\u914dAT HAL\u5c42\u4e32\u53e3\u53ca\u7f51\u7edc\u63a5\u53e3\u51fd\u6570 \u6267\u884c\u811a\u672c\u751f\u6210MQTT\u914d\u7f6e\u5934\u6587\u4ef6 \u8c03\u7528OS\u63d0\u4f9b\u7684\u63a5\u53e3\u5b8c\u6210\u548c\u817e\u8baf\u4e91\u7684\u5bf9\u63a5 \u9879\u76ee\u5de5\u7a0b\u4e2d\u6dfb\u52a0MQTT\u7ec4\u4ef6\u76f8\u5173\u6587\u4ef6 \u5728\u5de5\u7a0b\u6dfb\u52a0hal\u3001at\u3001devices\u3001\u548cmqtt client\u6e90\u7801, \u53ef\u4ee5\u53c2\u8003TencentOS-tiny\\board\\TencentOS_tiny_EVB_MX_Plus\\KEIL\\mqttclient\u5de5\u7a0b \u9002\u914dAT HAL\u5c42\u4e32\u53e3\u53ca\u7f51\u7edc\u63a5\u53e3\u51fd\u6570 \u4e0a\u5c42MQTT\u7684\u64cd\u4f5c\u6700\u7ec8\u90fd\u4f1a\u8f6c\u4e3a\u4e3a\u5bf9\u5e95\u5c42\u901a\u4fe1\u8bbe\u5907\u7684socket\u64cd\u4f5c, OS\u96c6\u6210\u4e86sal_module_wrapper\u5c42, \u4f46\u662f\u7531\u4e8e\u5404\u4e2a\u5f00\u53d1\u677f\u786c\u4ef6\u4e0d\u540c, \u56e0\u6b64\u9700\u8981\u5bf9sal_module_wrapper\u8fdb\u884c\u9002\u914d. \u9002\u914d\u8fc7\u7a0b\u7684\u6838\u5fc3\u6570\u636e\u7ed3\u6784\u4e3a sal_module_t , \u5728 TencentOS_tiny\\net\\sal_module_wrapper\\sal_module_wrapper.h \u6587\u4ef6\u4e2d\u5b9a\u4e49: typedef struct sal_module_st{ int (*init)(void); int (*get_local_mac)(char *mac); int (*get_local_ip)(char *ip, char *gw, char *mask); int (*parse_domain)(const char *host_name, char *host_ip, size_t host_ip_len); int (*connect)(const char *ip, const char *port, sal_proto_t proto); int (*send)(int sock, const void *buf, size_t len); int (*recv_timeout)(int sock, void *buf, size_t len, uint32_t timeout); int (*recv)(int sock, void *buf, size_t len); int (*sendto)(int sock, char *ip, char *port, const void *buf, size_t len); int (*recvfrom)(int sock, char *ip, char *port, void *buf, size_t len); int (*recvfrom_timeout)(int sock, char *ip, char *port, void *buf, size_t len, uint32_t timeout); int (*close)(int sock); }sal_module_t; \u5728\u4f7f\u7528\u7684\u65f6\u5019, \u5e76\u4e0d\u9700\u8981\u5168\u90e8\u5b9e\u73b0, \u53ea\u9700\u5b9e\u73b0\u4e0b\u5217\u51e0\u4e2a\u6838\u5fc3\u7684\u63a5\u53e3\u5373\u53ef: sal_module_t sal_module_esp8266 = { .init = esp8266_init, .connect = esp8266_connect, .send = esp8266_send, .recv_timeout = esp8266_recv_timeout, .recv = esp8266_recv, .sendto = esp8266_sendto, .recvfrom = esp8266_recvfrom, .recvfrom_timeout = esp8266_recvfrom_timeout, .close = esp8266_close, .parse_domain = esp8266_parse_domain, }; \u8fd9\u91cc\u63a5\u53e3\u5bf9\u5e94\u7684 esp8266_xxx \u51fd\u6570\u9700\u8981\u5f00\u53d1\u8005\u6839\u636e\u786c\u4ef6\u4e0a\u5177\u6709\u7684\u901a\u4fe1\u6a21\u7ec4\u8fdb\u884c\u76f8\u5e94\u7684\u9002\u914d. \u8be5\u7ed3\u6784\u586b\u5145\u5b8c\u540e, \u9700\u8981\u5728\u4f7f\u7528MQTT\u4e4b\u524d, \u8c03\u7528\u4e00\u4e0b\u521d\u59cb\u5316\u63a5\u53e3\u6ce8\u518c\u4e32\u53e3\u548c\u7f51\u7edcAPI\u51fd\u6570: esp8266_sal_init(hal_uart_port_t uart_port); \u4fee\u6539MQTT\u914d\u7f6e\u5934\u6587\u4ef6 \u4ece\u4e4b\u524d\u4ecb\u7ecd\u817e\u8baf\u4e91\u7aef\u914d\u7f6e\u7684\u7ae0\u8282\u4e2d\u53ef\u4ee5\u77e5\u9053, \u5728MQTT\u5ba2\u6237\u7aef, \u6240\u9700\u8981\u7684\u6838\u5fc3\u4fe1\u606f\u53ea\u5305\u542b: Product ID Device Name Device Password Client id mqtt username mqtt password \u5f00\u53d1\u8005\u5728\u7ec8\u7aef\u8282\u70b9\u5f00\u53d1\u8fc7\u7a0b\u4e2d, \u53ef\u4ee5\u81ea\u884c\u4fee\u6539MQTT\u914d\u7f6e\u53c2\u6570 #define IOTHUB_MQTT_IP \"111.230.189.156\" #define IOTHUB_MQTT_PORT \"1883\" #define IOTHUB_MQTT_CLIENT_ID \"KHHIXM0JJ5dev001\" #define IOTHUB_MQTT_USERNAME \"KHHIXM0JJ5dev001;12010126;9K3WO;1647628324\" #define IOTHUB_MQTT_PASSWD \"53696f22a061ed2524b1de185815ad2fcae7739afd3f395cb6131521da7f0bb7;hmacsha256\" #define IOTHUB_MQTT_PUB_TOPIC \"KHHIXM0JJ5/dev001/data\" #define IOTHUB_MQTT_SUB_TOPIC \"KHHIXM0JJ5/dev001/control\" \u5982\u4e0a\u6240\u793a, \u9700\u8981\u817e\u8baf\u4e91\u8bbe\u5907\u4fe1\u606f\u81ea\u884c\u4fee\u6539 Product ID , Device Name \u548c Password \uff0c MQTT_USR_NAME \uff0c MQTT_PASSWORD \uff0c MQTT_SUBSCRIBE_TOPIC \uff0c MQTT_PUBLISH_TOPIC \uff0c\u8ba2\u9605/\u53d1\u5e03\u7684topic, \u5982\u679c\u91c7\u7528\u9ed8\u8ba4\u7684control\u548cevent\u5982\u56fe\u5373\u53ef, \u4e5f\u53ef\u81ea\u884c\u8bbe\u7f6e. \u5f00\u53d1\u8005\u5c06\u5176\u653e\u7f6e\u5230\u81ea\u5df1\u7684\u5de5\u7a0b\u76ee\u5f55\u4e0b\u4efb\u610f\u4f4d\u7f6e\u5e76\u5728\u5de5\u7a0b\u4e2d\u6dfb\u52a0\u5934\u6587\u4ef6\u5f15\u7528\u5373\u53ef. \u8c03\u7528TencentOS tiny\u63d0\u4f9b\u7684\u63a5\u53e3\u5b8c\u6210\u548c\u817e\u8baf\u4e91\u7684\u5bf9\u63a5 \u4ee5\u4e0b\u662f\u4e0e\u817e\u8baf\u4e91\u5bf9\u63a5\u5e76\u6536\u53d1\u4fe1\u606f\u7684\u4f8b\u7a0b: /* Tencent IoThub Device Info */ #define IOTHUB_MQTT_IP \"111.230.189.156\" #define IOTHUB_MQTT_PORT \"1883\" #define IOTHUB_MQTT_CLIENT_ID \"KHHIXM0JJ5dev001\" #define IOTHUB_MQTT_USERNAME \"KHHIXM0JJ5dev001;12010126;9K3WO;1647628324\" #define IOTHUB_MQTT_PASSWD \"53696f22a061ed2524b1de185815ad2fcae7739afd3f395cb6131521da7f0bb7;hmacsha256\" #define IOTHUB_MQTT_PUB_TOPIC \"KHHIXM0JJ5/dev001/data\" #define IOTHUB_MQTT_SUB_TOPIC \"KHHIXM0JJ5/dev001/control\" static void tos_topic_handler(void* client, message_data_t* msg) { (void) client; MQTT_LOG_I(\"-----------------------------------------------------------------------------------\"); MQTT_LOG_I(\"%s:%d %s()...\\ntopic: %s, qos: %d. \\nmessage:\\n\\t%s\\n\", __FILE__, __LINE__, __FUNCTION__, msg->topic_name, msg->message->qos, (char*)msg->message->payload); MQTT_LOG_I(\"-----------------------------------------------------------------------------------\\n\"); } void mqttclient_task(void) { int error; char buf[100] = { 0 }; mqtt_client_t *client = NULL; mqtt_message_t msg; memset(&msg, 0, sizeof(msg)); #ifdef USE_ESP8266 esp8266_sal_init(HAL_UART_PORT_0); esp8266_join_ap(\"Mculover666\", \"mculover666\"); #endif #ifdef USE_NB_BC35 int bc35_28_95_sal_init(hal_uart_port_t uart_port); bc35_28_95_sal_init(HAL_UART_PORT_0); #endif #ifdef USE_EC600S ec600s_sal_init(HAL_UART_PORT_0); #endif mqtt_log_init(); client = mqtt_lease(); mqtt_set_port(client, IOTHUB_MQTT_PORT); mqtt_set_host(client, IOTHUB_MQTT_IP); mqtt_set_client_id(client, IOTHUB_MQTT_CLIENT_ID); mqtt_set_user_name(client, IOTHUB_MQTT_USERNAME); mqtt_set_password(client, IOTHUB_MQTT_PASSWD); mqtt_set_clean_session(client, 1); error = mqtt_connect(client); MQTT_LOG_D(\"mqtt connect error is %#x\", error); mqtt_subscribe(client, IOTHUB_MQTT_SUB_TOPIC, QOS0, tos_topic_handler); MQTT_LOG_D(\"mqtt subscribe error is %#x\", error); memset(&msg, 0, sizeof(msg)); for (;;) { sprintf(buf, \"welcome to mqttclient, this is a publish test, a rand number: %d ...\", random_number()); msg.qos = QOS0; msg.payload = (void *) buf; error = mqtt_publish(client, IOTHUB_MQTT_PUB_TOPIC, &msg); tos_task_delay(4000); } } void application_entry(void *arg) { mqttclient_task(); while (1) { printf(\"This is a mqtt demo!\\r\\n\"); tos_task_delay(1000); } }","title":"08.QCloud_IoTHub_Quick_Start"},{"location":"08.QCloud_IoTHub_Quick_Start/#tencentos-tinyiothub","text":"Revision Date Description 1.0 2019-1-15 \u6587\u6863\u521d\u7248 2.0 2019-8-13 \u6587\u6863V2.0 3.0 2020-02-26 \u6587\u6863V3.0","title":"TencentOS tiny\u7aef\u4e91\u5bf9\u63a5\u5f00\u53d1\u6307\u5357\uff08IoTHub\uff09"},{"location":"08.QCloud_IoTHub_Quick_Start/#_1","text":"\u817e\u8baf\u7269\u8054\u7f51\u901a\u4fe1\uff08IoT Hub\uff09\u670d\u52a1\uff0c\u65e8\u5728\u63d0\u4f9b\u4e00\u4e2a\u5b89\u5168\u3001\u7a33\u5b9a\u3001\u9ad8\u6548\u7684\u8fde\u63a5\u5e73\u53f0\uff0c\u5e2e\u52a9\u5f00\u53d1\u8005\u4f4e\u6210\u672c\u3001\u5feb\u901f\u5730\u5b9e\u73b0\u201c\u8bbe\u5907-\u8bbe\u5907\u201d\u3001\u201c\u8bbe\u5907-\u7528\u6237\u5e94\u7528\u201d\u3001\u201c\u8bbe\u5907-\u4e91\u670d\u52a1\u201d\u4e4b\u95f4\u53ef\u9760\u3001\u9ad8\u5e76\u53d1\u7684\u6570\u636e\u901a\u4fe1\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u817e\u8baf\u7269\u8054\u7f51\u901a\u4fe1\u53ef\u4ee5\u5b9e\u73b0\u8bbe\u5907\u4e4b\u95f4\u7684\u4e92\u52a8\u3001\u8bbe\u5907\u7684\u6570\u636e\u4e0a\u62a5\u548c\u914d\u7f6e\u4e0b\u53d1\uff0c\u8fd8\u53ef\u4ee5\u57fa\u4e8e\u89c4\u5219\u5f15\u64ce\u548c\u817e\u8baf\u4e91\u4ea7\u54c1\u6253\u901a\uff0c\u65b9\u4fbf\u5feb\u6377\u7684\u5b9e\u73b0\u6d77\u91cf\u8bbe\u5907\u6570\u636e\u7684\u5b58\u50a8\u3001\u8ba1\u7b97\u4ee5\u53ca\u667a\u80fd\u5206\u6790\u3002\u603b\u4e4b\uff0c\u57fa\u4e8e\u817e\u8baf\u7269\u8054\u7f51\u901a\u4fe1\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u4f4e\u6210\u672c\u5b9e\u73b0\u201c\u8bbe\u5907-\u6570\u636e-\u5e94\u7528-\u4e91\u670d\u52a1\u201d\u7684\u8fde\u63a5\uff0c\u5feb\u901f\u642d\u5efa\u7269\u8054\u7f51\u5e94\u7528\u5e73\u53f0\u3002 \u817e\u8baf\u4e91\u7269\u8054\u7f51\u901a\u4fe1\u4ea7\u54c1\u67b6\u6784 \u5728\u4e0a\u56fe\u6240\u793a\u7684\u67b6\u6784\u4e2d, \u672c\u6587\u53ea\u8ba8\u8bba\"\u7528\u6237\u8bbe\u5907\"\u548c\u817e\u8baf\u4e91\u7684\u5bf9\u63a5. \u8fd9\u4e0a\u56fe\u4e2d\u53ef\u4ee5\u770b\u5230, \"\u7528\u6237\u8bbe\u5907\"\u548c\u817e\u8baf\u4e91\u4e4b\u95f4\u662f\u57fa\u4e8e MQTT \u534f\u8bae\u6216\u662f CoAP \u534f\u8bae\u8fdb\u884c\u901a\u4fe1\u7684. \u56e0\u6b64, \u5728\"\u7528\u6237\u8bbe\u5907\"\u4e0a, \u9700\u8981\u5305\u542b\u8fde\u63a5SDK\u6216\u662f\u5b9e\u73b0\u4e86MQTT\u6216CoAP\u534f\u8bae\u7684\u4ee3\u7801. \u672c\u6587\u8bb2\u8ff0MQTT\u8fde\u63a5\u65b9\u6cd5, CoAP\u534f\u8bae\u7c7b\u4f3c. MQTT\u7b80\u4ecb \u7269\u8054\u7f51 (IoT) \u8bbe\u5907\u5fc5\u987b\u8fde\u63a5\u4e92\u8054\u7f51. \u901a\u8fc7\u8fde\u63a5\u5230\u4e92\u8054\u7f51, \u8bbe\u5907\u5c31\u80fd\u76f8\u4e92\u534f\u4f5c, \u4ee5\u53ca\u4e0e\u540e\u7aef\u670d\u52a1\u534f\u540c\u5de5\u4f5c. \u4e92\u8054\u7f51\u7684\u57fa\u7840\u7f51\u7edc\u534f\u8bae\u662f TCP/IP. MQTT(\u6d88\u606f\u961f\u5217\u9065\u6d4b\u4f20\u8f93)\u662f\u57fa\u4e8e TCP/IP \u534f\u8bae\u6808\u800c\u6784\u5efa\u7684, \u5df2\u6210\u4e3a IoT \u901a\u4fe1\u7684\u6807\u51c6. MQTT\u672c\u8eab\u662f\u4e2a\u8f7b\u91cf\u7ea7\u7684\u534f\u8bae, \u53ef\u4ee5\u5728\u786c\u4ef6\u53d7\u9650\u8bbe\u5907\u4e0a\u5b9e\u73b0. \u540c\u65f6, MQTT\u534f\u8bae\u652f\u6301\u5728\u5404\u65b9\u4e4b\u95f4\u5f02\u6b65\u901a\u4fe1\u7684\u6d88\u606f\u534f\u8bae, \u5f02\u6b65\u6d88\u606f\u534f\u8bae\u5728\u7a7a\u95f4\u548c\u65f6\u95f4\u4e0a\u5c06\u6d88\u606f\u53d1\u9001\u8005\u4e0e\u63a5\u6536\u8005\u5206\u79bb, \u56e0\u6b64\u53ef\u4ee5\u5728\u4e0d\u53ef\u9760\u7684\u7f51\u7edc\u73af\u5883\u4e2d\u8fdb\u884c\u6269\u5c55. MQTT\u7684\u7075\u6d3b\u6027\u4f7f\u5f97\u4e3a IoT \u8bbe\u5907\u548c\u670d\u52a1\u7684\u591a\u6837\u5316\u5e94\u7528\u573a\u666f\u63d0\u4f9b\u652f\u6301\u6210\u4e3a\u53ef\u80fd. MQTT\u534f\u8bae\u57fa\u4e8e\u53d1\u5e03(Publish)\u548c\u8ba2\u9605(Subscribe)\u6a21\u578b. \u5728\u7f51\u7edc\u4e2d\u5b9a\u4e49\u4e86\u4e24\u79cd\u5b9e\u4f53\u7c7b\u578b: \u6d88\u606f\u4ee3\u7406\u7aef(Broker) \u548c \u5ba2\u6237\u7aef(Client) , \u4ee3\u7406\u662f\u4e00\u4e2a\u670d\u52a1\u5668, \u5b83\u4ece\u5ba2\u6237\u7aef\u63a5\u6536\u6240\u6709\u6d88\u606f, \u7136\u540e\u5c06\u8fd9\u4e9b\u6d88\u606f\u8def\u7531\u5230\u76f8\u5173\u7684\u76ee\u6807\u5ba2\u6237\u7aef. \u5ba2\u6237\u7aef\u662f\u80fd\u591f\u4e0e\u4ee3\u7406\u4ea4\u4e92\u6765\u53d1\u9001\u548c\u63a5\u6536\u6d88\u606f\u7684\u4efb\u4f55\u4e8b\u7269. \u5ba2\u6237\u7aef\u53ef\u4ee5\u662f\u73b0\u573a\u7684 IoT \u4f20\u611f\u5668, \u6216\u8005\u662f\u6570\u636e\u4e2d\u5fc3\u5185\u5904\u7406 IoT \u6570\u636e\u7684\u5e94\u7528\u7a0b\u5e8f. Client\u548cBroker\u4e4b\u95f4\u7684\u53d1\u5e03\u548c\u8ba2\u9605\u662f\u6839\u636e\u4e3b\u9898(Topic)\u6765\u8fdb\u884c\u7684, \u4e0d\u540c\u7684\u5ba2\u6237\u7aef\u53ef\u4ee5\u5411\u4e0d\u540c\u7684\u4e3b\u9898\u53d1\u5e03\u6d88\u606f, \u8bbe\u5907\u53ea\u6709\u5728\u8ba2\u9605\u4e86\u67d0\u4e2a\u4e3b\u9898\u540e, \u624d\u80fd\u6536\u5230\u76f8\u5e94\u4e3b\u9898\u7684\u6d88\u606f.","title":"\u6982\u89c8"},{"location":"08.QCloud_IoTHub_Quick_Start/#_2","text":"\u4e91\u7aef\u8bbe\u7f6e\u4e3b\u8981\u5305\u542b\u4e86, \u521b\u5efa\u65b0\u4ea7\u54c1, \u521b\u5efa\u65b0\u8bbe\u5907 \u767b\u5f55\u817e\u8baf\u4e91, \u641c\u7d22\"\u4e91\u4ea7\u54c1\"\u4e0b\u7684\"\u7269\u8054\u7f51\u901a\u4fe1\"\u4ea7\u54c1, \u6216\u76f4\u63a5\u8bbf\u95ee https://console.cloud.tencent.com/iotcloud \u521b\u5efa\u65b0\u4ea7\u54c1 \u5728\"\u6dfb\u52a0\u65b0\u4ea7\u54c1\"\u7684\u65f6\u5019, \u6ce8\u610f\u9009\u62e9. \u4ea7\u54c1\u7c7b\u578b\u9009\u62e9 \u666e\u901a\u4ea7\u54c1 , \u4ea7\u54c1\u540d\u79f0\u968f\u610f, \u8ba4\u8bc1\u65b9\u5f0f\u9009\u62e9 \u5bc6\u94a5\u8ba4\u8bc1 , \u6570\u636e\u683c\u5f0f\u9009\u62e9 \u81ea\u5b9a\u4e49 . \u5173\u4e8e\u8ba4\u8bc1\u65b9\u5f0f\u548c\u6570\u636e\u683c\u5f0f\u7684\u9009\u62e9\u89e3\u91ca \u8ba4\u8bc1\u65b9\u5f0f\u9ed8\u8ba4\u7684\u662f\u8bc1\u4e66\u8ba4\u8bc1, \u6570\u636e\u683c\u5f0f\u9ed8\u8ba4\u7684\u662fjson\u683c\u5f0f. \u5bf9\u4e8e\u8ba4\u8bc1\u65b9\u5f0f, \u6307\u5b9a\u4e86\u8bbe\u5907\u901a\u8fc7\u4f55\u79cd\u65b9\u5f0f\u548c\u4e91\u7aef\u8fdb\u884c\u53cc\u5411\u8ba4\u8bc1. \u9ed8\u8ba4\u7684\u8bc1\u4e66\u65b9\u5f0f\u76f8\u5bf9\u4e8e\u5bc6\u94a5\u8ba4\u8bc1\u5b89\u5168\u6027\u9ad8\u4e00\u70b9, \u4f46\u662f\u95ee\u9898\u5728\u4e8e\u8bc1\u4e66\u65b9\u5f0f\u9700\u8981\u5728\u5d4c\u5165\u5f0f\u8bbe\u5907\u7aef\u5b58\u50a8\u8bc1\u4e66\u540c\u65f6\u5b9e\u73b0\u8bc1\u4e66\u7684\u76f8\u5173\u5904\u7406, \u5bf9\u8bbe\u5907\u7684RAM\u548cROM\u8981\u6c42\u8f83\u9ad8, \u76f8\u5bf9\u800c\u8a00, \u5bc6\u94a5\u8ba4\u8bc1\u7684\u65b9\u5f0f\u8d44\u6e90\u5360\u7528\u91cf\u5c31\u5c0f\u70b9, \u7531\u4e8e\u6211\u4eec\u4e3b\u8981\u652f\u6301\u7684\u8bbe\u5907\u90fd\u662f\u5c0f\u578b\u5d4c\u5165\u5f0f\u8bbe\u5907, \u56e0\u6b64\u9009\u7528\u5bc6\u94a5\u8ba4\u8bc1. \u6570\u636e\u683c\u5f0f\u6307\u7684\u662f\u8bbe\u5907\u548c\u4e91\u7aef\u8fdb\u884c\u6570\u636e\u4ea4\u4e92\u65f6\u5019\u4f7f\u7528\u7684\u683c\u5f0f, json\u683c\u5f0f\u4e3a\u6587\u672c\u5b57\u7b26\u4e32, \u53ef\u8bfb\u6027\u9ad8, \u5e76\u4e14\u4fbf\u4e8e\u89e3\u6790, \u5bf9\u4e8e\u529f\u80fd\u590d\u6742\u7684\u8bbe\u5907\u4ea4\u4e92\u800c\u5df2\u6bd4\u8f83\u7406\u60f3, \u4f46\u662f\u5bf9\u4e8e\u5c0f\u578b\u8bbe\u5907\u6216\u662f\u5b9a\u5236\u8bbe\u5907, \u6570\u636e\u5355\u4e00, \u6216\u662f\u6709\u81ea\u5b9a\u4e49\u7684\u683c\u5f0f(\u4e8c\u8fdb\u5236\u6216\u662f\u6587\u672c), \u8fd9\u79cd\u65f6\u5019, \u7528\u81ea\u5b9a\u4e49\u7684\u6570\u636e\u683c\u5f0f, \u4e00\u65b9\u9762\u8282\u7ea6\u6d41\u91cf, \u53e6\u4e00\u65b9\u9762\u6bd4\u8f83\u7075\u6d3b. \u6ce8: \u8fd9\u91cc\u7684\u6570\u636e\u683c\u5f0f\u9009\u62e9\u4f1a\u5f71\u54cd\u4e4b\u540e\u817e\u8baf\u4e91\"\u89c4\u5219\u5f15\u64ce\"\u7ec4\u4ef6\u7684\u8bbe\u7f6e. \u65b0\u5efa\u5b8c\u4ea7\u54c1\u540e, \u4f1a\u83b7\u5f97\u4e00\u4e2a\u5e73\u53f0\u5206\u914d\u7684 productID . \u521b\u5efa\u65b0\u8bbe\u5907 \u8bbe\u7f6e\u7684\u65f6\u5019\u53ea\u9700\u8981\u8bbe\u7f6e\u8bbe\u5907\u540d\u79f0\u5373\u53ef, \u7531\u4e8e\u6211\u4eec\u5728\u521b\u5efa\u4ea7\u54c1\u7684\u65f6\u5019, \u8ba4\u8bc1\u65b9\u5f0f\u9009\u62e9\u4e86\u5bc6\u94a5\u8ba4\u8bc1, \u56e0\u6b64\u5728\u521b\u5efa\u8bbe\u5907\u7684\u65f6\u5019\u5c06\u4f1a\u63d0\u4f9b\u8bbe\u5907\u5bf9\u5e94\u7684\u5bc6\u94a5, \u8fd9\u91cc\u9009\u62e9\u9ed8\u8ba4\u7684\"\u4f7f\u7528\u7269\u8054\u901a\u901a\u4fe1\u63d0\u4f9b\u7684\u5bc6\u94a5\"\u5373\u53ef. \u6dfb\u52a0\u5b8c\u8bbe\u5907\u540e, \u4f1a\u544a\u77e5\u8bbe\u5907\u5bf9\u5e94\u7684\u5bc6\u94a5. \u8be5\u5bc6\u94a5\u5c06\u4f1a\u7528\u4e8e\u4e4b\u540e\u8bbe\u5907\u4e0e\u5e73\u53f0\u901a\u4fe1\u65f6\u7684\u8ba4\u8bc1. \u4e3a\u4e86\u5b9e\u73b0\u8bbe\u5907\u95f4\u7684\u901a\u4fe1, \u6211\u4eec\u8fd8\u9700\u8981\u521b\u5efa\u7b2c\u4e8c\u4e2a\u8bbe\u5907, \u64cd\u4f5c\u540c\u4e0a, \u4e0d\u59a8\u5c06\u5176\u547d\u540d\u4e3a\"dev2\". \u6b64\u65f6, \u5728\u4ea7\u54c1\"my_product\"\u4e0b\u9762, \u67092\u4e2a\u6211\u4eec\u6dfb\u52a0\u7684\u8bbe\u5907, \u5206\u522b\u4e3a\"dev1\"\u548c\"dev2\". Topic\u8bbe\u7f6e \u6211\u4eec\u77e5\u9053, \u8bbe\u5907\u901a\u8fc7MQTT\u534f\u8bae\u8fdb\u884c\u901a\u4fe1, \u662f\u57fa\u4e8e\u53d1\u5e03(publish)\u548c\u8ba2\u9605(subscribe)\u76f8\u5173\u7684\u8bdd\u9898(topic)\u6765\u8fdb\u884c\u7684, \u56e0\u6b64, \u8fd8\u9700\u8981\u5728\u4e91\u7aef\u5bf9\u8bdd\u9898\u8fdb\u884c\u8bbe\u7f6e. \u6211\u4eec\u53ef\u4ee5\u5728\"\u6743\u9650\u5217\u8868\"\u4e2d\u770b\u5230Topic\u5bf9\u5e94\u7684\u64cd\u4f5c\u6743\u9650, \u6b64\u5904\u8fd8\u53ef\u4ee5\u6dfb\u52a0\u65b0\u7684Topic. \u5728\u8fd9\u91cc, \u6211\u4eec\u53ef\u4ee5\u770b\u5230, \u5e73\u53f0\u9ed8\u8ba4\u914d\u7f6e\u4e86\u4e09\u7c7b\u7684Topic, \u7528\u4e8e\u6267\u884c\u53d1\u5e03\u548c\u8ba2\u9605. \u8fd9\u91cc\u4e4b\u6240\u4ee5\u662f\u4e09\u7c7b\u800c\u4e0d\u662f\u4e09\u4e2a, \u662f\u56e0\u4e3aTopic\u91cc\u4f7f\u7528\u4e86\u53d8\u91cf. \u8fd9\u91cc\u7684 25KCIUIR1G \u5b9e\u9645\u4e0a\u662fproductID; ${deviceName} \u4e3a\u5e73\u53f0\u8bbe\u7f6e\u7684\u53d8\u91cf, \u5373\u8bbe\u5907\u540d; control \u548c data \u4ee5\u53ca event \u4e3aTopic\u540d\u5b57. \u6240\u4ee5, \u5728\u6211\u4eec\u521b\u5efa\u4e862\u4e2a\u8bbe\u5907dev1\u548cdev2\u7684\u60c5\u51b5\u4e0b, \u5728my_product\u4ea7\u54c1\u4e0b, \u5373\u5b58\u57286\u4e2aTopic, \u5206\u522b\u4e3a: 25KCIUIR1G/dev1/control \u8ba2\u9605\u6743\u9650 25KCIUIR1G/dev1/data \u53d1\u5e03\u548c\u8ba2\u9605\u6743\u9650 25KCIUIR1G/dev1/event \u53d1\u5e03\u6743\u9650 25KCIUIR1G/dev2/control \u8ba2\u9605\u6743\u9650 25KCIUIR1G/dev2/data \u53d1\u5e03\u548c\u8ba2\u9605\u6743\u9650 25KCIUIR1G/dev2/event \u53d1\u5e03\u6743\u9650 \u8fd9\u91cc\u9ed8\u8ba4\u7684Topic\u5df2\u7ecf\u8db3\u591f\u6211\u4eec\u4f7f\u7528, \u4e0d\u9700\u8981\u989d\u5916\u6dfb\u52a0Topic\u548c\u6743\u9650\u4e86. MQTT\u7684Topic\u672c\u8eab\u662f\u4e00\u4e2a\u666e\u901a\u7684\u5b57\u7b26\u4e32, \u4f46\u662f\u53ef\u4ee5\u7531\u591a\u4e2a\u5c42\u7ea7\u7ec4\u6210, \u6839\u636e / \u6765\u5212\u5206. \u8fd9\u79cd\u5206\u5c42\u7684Topic\u7ed3\u6784\u4f7f\u5f97\u4e3b\u9898\u7684\u8fc7\u6ee4\u548c\u5339\u914d\u53d8\u5f97\u76f8\u5bf9\u7075\u6d3b. \u591a\u5c42\u901a\u914d\u7b26\"#\" \u5fc5\u987b\u4f4d\u4e8e\u6700\u540e\u4e00\u4e2a\u5b57\u7b26, \u5339\u914d\u591a\u5c42\u7ea7. \u4f8b\u5982\u5bf9\u4e8e 25KCIUIR1G/# , \u5c06\u4f1a\u5339\u914d 25KCIUIR1G/dev1 , 25KCIUIR1G/dev2 , 25KCIUIR1G/dev1/control , 25KCIUIR1G/dev1/event , 25KCIUIR1G/dev2/control \u548c 25KCIUIR1G/dev2/event \u4e3b\u9898. \u5355\u5c42\u901a\u914d\u7b26\"+\" \u5339\u914d\u5355\u4e2a\u5c42\u7ea7, \u5728\u4e3b\u9898\u7684\u4efb\u4f55\u5c42\u7ea7\u90fd\u53ef\u4ee5\u4f7f\u7528, \u5305\u62ec\u7b2c\u4e00\u4e2a\u5c42\u7ea7\u548c\u6700\u540e\u4e00\u4e2a\u5c42\u7ea7. \u4f8b\u5982, \u5bf9\u4e8e 25KCIUIR1G/+/event , \u5c06\u4f1a\u5339\u914d 25KCIUIR1G/dev1/event \u548c 25KCIUIR1G/dev2/event . \u8bbe\u7f6e\u89c4\u5219\u5f15\u64ce \u89c4\u5219\u5f15\u64ce\u672c\u8eab\u4e0d\u5c5e\u4e8eMQTT\u534f\u8bae\u7684\u8303\u7574, \u4f46\u662f\u5e73\u53f0\u4fa7\u51fa\u4e8e\u5b89\u5168\u89d2\u5ea6\u8003\u8651\u6dfb\u52a0\u4e86\u89c4\u5219\u5f15\u64ce, \u5b9e\u73b0\u4e86Topic\u4e4b\u95f4\u7684\u8f6c\u53d1\u64cd\u4f5c, \u6211\u4eec\u9700\u8981\u5408\u7406\u7684\u8bbe\u7f6e\u89c4\u5219\u5f15\u64ce\u624d\u80fd\u5b9e\u73b0\u591a\u4e2a\u8bbe\u5907\u4e4b\u95f4\u7684\u6570\u636e\u6536\u53d1, \u7531\u4e8e\u7406\u89e3\u8d77\u6765\u6bd4\u8f83\u590d\u6742, \u6211\u4eec\u8fd9\u91cc\u7b80\u8981\u8bb2\u89e3\u4e0b\u4e3a\u4ec0\u4e48\u9700\u8981\u89c4\u5219\u5f15\u64ce, \u89c4\u5219\u5f15\u64ce\u7684\u4f5c\u7528, \u5982\u4f55\u8bbe\u7f6e\u89c4\u5219\u5f15\u64ce. \u4e3a\u4ec0\u4e48\u9700\u8981\u89c4\u5219\u5f15\u64ce \u5728\u4e0a\u8282\u7684Topic\u4e2d, \u6211\u4eec\u77e5\u9053, \u5728\u5e73\u53f0\u4fa7, \u5bf9\u4e8e\u4e0d\u540c\u7684Topic, \u89c4\u5b9a\u4e86\u4e0d\u540c\u7684\u6743\u9650, \u4f8b\u5982, \u5bf9\u4e8e 25KCIUIR1G/dev1/event \u8fd9\u4e2aTopic, \u53ea\u5177\u6709\u53d1\u5e03\u6743\u9650, \u800c\u5bf9\u4e8e 25KCIUIR1G/dev1/control \u8fd9\u4e2aTopic, \u53ea\u5177\u6709\u8ba2\u9605\u6743\u9650. \u5bf9\u4e8e\u8bbe\u5907dev1, \u5f88\u81ea\u7136\u7684, \u4f1a\u671d 25KCIUIR1G/dev1/event \u8fd9\u4e2aTopic\u53d1\u9001\u6570\u636e, \u5e76\u4e14\u8ba2\u9605 25KCIUIR1G/dev1/control \u8fd9\u4e2aTopic\u7684\u6d88\u606f. \u4f46\u662f\u8fd9\u91cc\u5c31\u4f1a\u6d89\u53ca\u5230, event\u7684\u6570\u636e\u6700\u540e\u5230\u54ea\u53bb, control\u7684\u6570\u636e\u4ece\u54ea\u91cc\u6765\u7684\u95ee\u9898. \u5728\u672c\u6587\u7684\u4f8b\u5b50\u4e2d, \u6211\u4eec\u5e0c\u671bdev1\u548cdev2\u53d1\u751f\u4ea4\u4e92, \u5373\u76f8\u4e92\u6536\u53d1\u6d88\u606f. \u7531\u4e8eMQTT\u662f\u57fa\u4e8eTopic\u7684\u53d1\u5e03\u8ba2\u9605\u673a\u5236, \u56e0\u6b64, dev1\u60f3\u8981\u83b7\u5f97dev2\u7684\u6570\u636e, \u76f4\u89c9\u4e0a, \u9700\u8981\u8ba2\u9605dev2\u53d1\u5e03\u6d88\u606f\u7684\u90a3\u4e2aTopic. \u5047\u5b9adev2\u671d 25KCIUIR1G/dev2/event Topic\u4e0a\u53d1\u9001\u6570\u636e, \u90a3\u4e48dev1\u60f3\u8981\u83b7\u5f97dev2\u53d1\u5e03\u7684\u6d88\u606f, \u6700\u76f4\u63a5\u7684\u529e\u6cd5\u662f\u8ba2\u9605\u540c\u6837\u7684Topic, \u5373 25KCIUIR1G/dev2/event , \u4f46\u662f\u8fd9\u91cc\u5b58\u5728\u51e0\u4e2a\u95ee\u9898, \u9996\u5148, event Topic\u53ea\u5177\u6709\u53d1\u5e03\u6743\u9650, \u6ca1\u6709\u8ba2\u9605\u6743\u9650, \u5176\u6b21, \u5728\u5e73\u53f0\u4fa7, \u89c4\u5b9a\u4e86, \u4e0d\u5141\u8bb8\u8de8\u8bbe\u5907\u53d1\u5e03\u6216\u662f\u8ba2\u9605Topic , \u4e5f\u5c31\u662f\u8bf4, \u5bf9\u4e8edev1, \u53ea\u80fd\u770b\u5230\u6216\u53ea\u5141\u8bb8\u8bbf\u95ee 25KCIUIR1G/dev1 \u8fd9\u4e2aTopic\u4ee5\u53ca\u5176\u4e0b\u5c5e\u7684Topic, \u4e0d\u80fd\u8bbf\u95ee 25KCIUIR1G/dev2 \u53ca\u5176\u4e0b\u5c5eTopic. \u5e73\u53f0\u4fa7\u6dfb\u52a0\u4e0d\u5141\u8bb8\u8de8\u8bbe\u5907\u8bbf\u95eeTopic\u7684\u89c4\u5219\u867d\u7136\u4e0d\u76f4\u89c2, \u4f46\u5374\u662f\u5408\u7406\u7684. \u5982\u679c\u4e0d\u6dfb\u52a0\u8fd9\u6761\u9650\u5236, \u90a3\u4e48\u4e00\u4e2a\u8bbe\u5907\u53ef\u4ee5\u4e0d\u52a0\u9650\u5236\u7684\u8ba2\u9605\u540c\u4e00\u4e2a\u4ea7\u54c1\u4e0b\u6240\u6709\u5176\u4ed6\u8bbe\u5907\u7684Topic, \u83b7\u53d6\u5176\u4e0a\u62a5\u7684\u6d88\u606f, \u8fd9\u5b58\u5728\u6f5c\u5728\u7684\u5b89\u5168\u6f0f\u6d1e. \u89c4\u5219\u5f15\u64ce\u7684\u4f5c\u7528 \u56e0\u4e3a\u4e0d\u5141\u8bb8\u76f4\u63a5\u8de8\u8bbe\u5907\u8bbf\u95eeTopic, \u6240\u4ee5\u9700\u8981\u4f9d\u9760\"\u89c4\u5219\u5f15\u64ce\"\u6765\u624b\u52a8\u6dfb\u52a0\u89c4\u5219, \u5c06\u6307\u5b9a\u7684Topic\u6d88\u606f\u8f6c\u53d1\u5230\u53e6\u4e00\u4e2aTopic\u4e0a, \u5b9e\u73b0\u4e0d\u540c\u8bbe\u5907\u4e4b\u95f4\u7684\u901a\u4fe1. \u4e0a\u56fe\u4ecb\u7ecd\u4e86\u89c4\u5219\u5f15\u64ce\u7684\u4e3b\u8981\u4f5c\u7528\"republish\", \u5373\u5c06\u4e00\u4e2aTopic\u4e0b\u7684\u6d88\u606frepublish\u5230\u53e6\u4e00\u4e2aTopic\u4e0b. \u4ece\u56fe\u4e2d\u6211\u4eec\u53ef\u4ee5\u770b\u5230, \uff08\u4ea7\u54c1ID\u4ee5\u60a8\u5b9e\u9645\u7684ID\u4e3a\u51c6\uff09\u89c4\u5219\u5f15\u64ce\u5c06 25KCIUIR1G/dev2/event \u7684\u6d88\u606frepublish\u5230\u4e86 25KCIUIR1G/dev1/control \u4e0b. \u5c06 25KCIUIR1G/dev1/event \u7684\u6d88\u606frepublish\u5230\u4e86 25KCIUIR1G/dev2/control \u4e0b. \u8fd9\u6837, \u5bf9\u4e8edev1\u800c\u8a00, \u53ea\u9700\u8981\u8ba2\u9605 25KCIUIR1G/dev1/control \u5c31\u53ef\u4ee5\u63a5\u6536\u6765\u81ea 25KCIUIR1G/dev2/event \u7684\u6d88\u606f\u4e86. dev2\u540c\u7406. \u8bbe\u7f6e\u89c4\u5219\u5f15\u64ce \u5728\u7269\u8054\u7f51\u901a\u4fe1\u754c\u9762\u9009\u62e9\"\u89c4\u5219\u5f15\u64ce\"--\"\u65b0\u5efa\u89c4\u5219\", \u968f\u610f\u6307\u5b9a\u4e00\u4e2a\u89c4\u5219\u540d\u79f0, \u6211\u4eec\u8fd9\u91cc\u4e0d\u59a8\u8bbe\u7f6e\u4e3a\"1to2\". \u8fd9\u91cc, \u6211\u4eec\u770b\u5230\u89c4\u5219\u7684\u8be6\u7ec6\u8bbe\u7f6e\u4fe1\u606f, \u4e3b\u8981\u5305\u62ec\"\u7b5b\u9009\u6570\u636e\"\u548c\"\u884c\u4e3a\u64cd\u4f5c\". \"\u7b5b\u9009\u6570\u636e\"\u9488\u5bf9\u6307\u5b9aTopic\u63a5\u6536\u5230\u7684\u6d88\u606f\u5185\u5bb9\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u7b5b\u9009, \u6bd4\u5982\u5339\u914d\u6d88\u606f\u4e2d\u7684\u5b57\u6bb5\u6765\u51b3\u5b9a\u662f\u5426\u6267\u884c\u4e4b\u540e\u7684\u8bbe\u7f6e\u7684\"\u884c\u4e3a\u64cd\u4f5c\". \u800c\"\u884c\u4e3a\u64cd\u4f5c\"\u5219\u662f\u6307\u5b9a\u5bf9\u901a\u8fc7\u5339\u914d\u7684\u6d88\u606f\u8fdb\u884c\u4f55\u79cd\u64cd\u4f5c, \u4e3b\u8981\u7684\u64cd\u4f5c\u6709\"\u6570\u636e\u8f6c\u53d1\u5230\u53e6\u4e00\u4e2aTopic(Republish)\", \"\u8f6c\u53d1\u5230\u7b2c\u4e09\u65b9\u670d\u52a1(Forward)\"\u4ee5\u53ca\u8f6c\u53d1\u5230\u817e\u8baf\u4e91\u5404\u4e2a\u5bf9\u5e94\u7ec4\u4ef6\u4e2d. \u4e0a\u56fe\u662f\u8bbe\u7f6e\u597d\u7684\u89c4\u5219, \u8fd9\u91cc, \u6211\u4eec\u5c06\"\u7b5b\u9009\u6570\u636e\"\u90e8\u5206\u7684\u7b5b\u9009\u5b57\u6bb5\u8bbe\u7f6e\u4e3a * , \u7b5b\u9009\u7684Topic\u4e3a 25KCIUIR1G/dev1/event , \u6761\u4ef6\u8bbe\u7f6e\u4e3a\u7a7a, \u5373\u4e0d\u7b5b\u9009\u6570\u636e, \u5168\u90e8\u5339\u914d. \u7136\u540e, \u6267\u884c\u7684\u64cd\u4f5c\u662f\u5c06\u6570\u636e\u8f6c\u53d1\u5230 25KCIUIR1G/dev2/control , \u8bbe\u7f6e\u5b8c\u8fd9\u6761\u89c4\u5219, \u5c31\u5b9e\u73b0\u4e86dev2\u901a\u8fc7\u8ba2\u9605control\u5c31\u80fd\u6536\u5230dev1\u53d1\u9001\u5230event\u7684\u6570\u636e. \u5173\u4e8e\"\u7b5b\u9009\u6570\u636e\"\u7684\u8bbe\u5b9a \u7531\u4e8e\u6211\u4eec\u5728\u65b0\u5efa\u4ea7\u54c1, \u8bbe\u7f6e\u6570\u636e\u683c\u5f0f\u7684\u65f6\u5019\u9009\u62e9\u4e86\u81ea\u5b9a\u4e49\u6570\u636e\u683c\u5f0f, \u5728\u81ea\u5b9a\u4e49\u6570\u636e\u683c\u5f0f\u7684\u60c5\u51b5\u4e0b, \u5f53\u524d\u5e73\u53f0\u5c06\u5176\u5f53\u505a\u4e8c\u8fdb\u5236\u6d41\u6765\u5904\u7406, \u4e5f\u5c31\u65e0\u6cd5\u901a\u8fc7\u5339\u914d\u5b57\u6bb5\u8fdb\u884c\u6570\u636e\u7b5b\u9009. \u5982\u679c\u5728\u8fdb\u884c\u4ea7\u54c1\u7684\u65f6\u5019, \u4f7f\u7528\u6570\u636e\u683c\u5f0f\u662fjson, \u90a3\u4e48\u6b64\u5904\u5c31\u53ef\u4ee5\u6839\u636ejson\u4e2d\u7684\u5b57\u6bb5\u8fdb\u884cSQL\u7684\u5339\u914d\u548c\u7b5b\u9009. \u540c\u7406, \u6211\u4eec\u518d\u8bbe\u7f6e\u65b0\u7684\u4e00\u4e2a\u89c4\u5219\"2to1\", \u5b9e\u73b0 25KCIUIR1G/dev2/event \u5230 25KCIUIR1G/dev1/control \u7684\u8f6c\u53d1. \u89c4\u5219\u5f15\u64ce\u90fd\u8bbe\u7f6e\u597d\u540e\uff0c\u8bb0\u5f97\u70b9\u542f\u7528\u6309\u94ae\uff0c\u8fd9\u6837, \u5728\u5e73\u53f0\u4fa7dev1\u5230dev2\u7684\u53cc\u5411\u6570\u636e\u901a\u8def\u5c31\u6253\u901a\u4e86. \u4e91\u65e5\u5fd7\u548c\u6d88\u606f\u961f\u5217CMQ \u5728\u5e73\u53f0\u4fa7\u90fd\u8bbe\u7f6e\u597d\u540e, \u6211\u4eec\u5728\u4e4b\u540e\u7684\u6d4b\u8bd5\u8fc7\u7a0b\u6216\u662f\u901a\u4fe1\u8fc7\u7a0b\u4e2d, \u5f80\u5f80\u8fd8\u9700\u8981\u67e5\u770b\u5e73\u53f0\u662f\u5426\u6536\u5230\u4e86\u8bbe\u5907\u53d1\u9001\u4e0a\u6765\u7684\u6d88\u606f, \u5bf9\u6d88\u606f\u6267\u884c\u4e86\u54ea\u4e9b\u64cd\u4f5c, \u6d88\u606f\u7684\u5177\u4f53\u5185\u5bb9(payload)\u662f\u4ec0\u4e48. \u817e\u8baf\u4e91\u63d0\u4f9b\u4e86\u7269\u8054\u7f51\u901a\u4fe1\u4ea7\u54c1\u7684\"\u4e91\u65e5\u5fd7\"\u529f\u80fd\u548c\u817e\u8baf\u4e91\u7ec4\u4ef6\"\u6d88\u606f\u961f\u5217CMQ\". \u4e91\u65e5\u5fd7 \u53ef\u4ee5\u5728\u4ea7\u54c1\u5217\u8868\u4e0b\u627e\u5230\"\u4e91\u65e5\u5fd7\", \u70b9\u51fb\u641c\u7d22\u5373\u53ef\u663e\u793a\u5bf9\u5e94\u7684\u884c\u4e3a\u65e5\u5fd7 \u53c2\u8003\u65e5\u5fd7\u5982\u4e0b, \u53ef\u4ee5\u770b\u5230\u65e5\u5fd7\u8bb0\u5f55\u4e86\u8bbe\u5907\u7684\u8fde\u63a5, \u8fde\u63a5\u65ad\u5f00, \u53d1\u5e03, \u8ba2\u9605\u7b49\u884c\u4e3a, \u4e5f\u8bb0\u5f55\u4e86\u89c4\u5219\u5f15\u64ce\u7684\u64cd\u4f5c, \u8fd8\u6709CMQ\u961f\u5217\u7684\u4e00\u4e9b\u884c\u4e3a\u65e5\u5fd7. \u4f46\u662f\u5173\u4e8e\u8bbe\u5907\u53d1\u5e03\u7684\u6d88\u606f\u5185\u5bb9, \u5728\u4e91\u65e5\u5fd7\u4e2d\u65e0\u6cd5\u67e5\u770b, \u9700\u8981\u501f\u52a9\u6d88\u606f\u961f\u5217CMQ. \u6d88\u606f\u961f\u5217CMQ \u53ef\u4ee5\u5728\u4ea7\u54c1\u5217\u8868\u4e2d\u627e\u5230\"\u6d88\u606f\u961f\u5217\"\u9009\u9879, \u8bbe\u7f6e\u961f\u5217\u6240\u60f3\u8981\u63a5\u6536\u7684\u6d88\u606f\u7c7b\u578b\u540e\u4fdd\u5b58\u914d\u7f6e, \u5373\u53ef\u5c06\u5e73\u53f0\u4fa7\u6536\u5230\u7684\u8bbe\u5907\u6d88\u606f\u989d\u5916\u53d1\u9001\u5230\u817e\u8baf\u4e91\u6d88\u606f\u961f\u5217CMQ\u7ec4\u4ef6\u4e2d. \u8bbe\u7f6e\u5b8c\u6d88\u606f\u961f\u5217\u540e\u53ef\u4ee5\u5728\"\u4e91\u4ea7\u54c1\"\u4e2d\u641c\u7d22CMQ, \u5373\u53ef\u627e\u5230\u5bf9\u5e94\u7684\u6d88\u606f\u961f\u5217, \u70b9\u51fb\"\u5f00\u59cb\u63a5\u6536\u6d88\u606f\" \u63a5\u6536\u6d88\u606f\u961f\u5217\u4e2d\u7684\u5185\u5bb9, \u53c2\u8003\u5982\u4e0b \u5176\u4e2d\u53ef\u4ee5\u770b\u5230\u6709\u4e9b\u6d88\u606f\u5e26\u6709\"PayloadLen\"\u548c\"Playload\"\u5b57\u6bb5, \u5373\u4e3a\u5177\u4f53\u7684\u6d88\u606f\u5185\u5bb9. \u5728\u5bc6\u94a5\u8ba4\u8bc1\u4e0b, \u6d88\u606f\u7684\u5185\u5bb9(payload)\u662f\u7ecf\u8fc7base64\u7f16\u7801\u7684, \u6240\u4ee5\u5728\u5e73\u53f0\u4fa7\u770b\u5230\u7684\u6570\u636e\u7c7b\u4f3c\u4e71\u7801\u5b9e\u9645\u4e0a\u662f\u7ecf\u8fc7\u7f16\u7801\u540e\u7684\u7ed3\u679c, \u60f3\u8981\u67e5\u770b\u5177\u4f53\u7684\u5185\u5bb9, \u53ef\u4ee5\u5728linux\u4e0b, echo <payload> | base64 --decode .","title":"\u4e91\u7aef\u8bbe\u7f6e"},{"location":"08.QCloud_IoTHub_Quick_Start/#_3","text":"\u5728\u524d\u6587\u4e2d\u6211\u4eec\u63d0\u5230, \u8bbe\u5907\u7ec8\u7aef\u8ddf\u817e\u8baf\u4e91\u4e4b\u95f4\u7684\u901a\u4fe1\u91c7\u7528\u7684\u662fMQTT\u534f\u8bae, \u800cMQTT\u534f\u8bae\u9700\u8981\u6d88\u606f\u4ee3\u7406\u7aef\u548c\u5ba2\u6237\u7aef\u76f8\u4e92\u914d\u5408, \u56e0\u6b64, \u6211\u4eec\u5728\u7ec8\u7aef\u8bbe\u5907\u4e0a, \u9700\u8981 \u5b9e\u73b0\u4e00\u4e2aMQTT Client . \u817e\u8baf\u4e91\u4e0a\u652f\u6301\u7684MQTT\u534f\u8bae\u548c\u6807\u51c6\u534f\u8bae\u533a\u522b\u4e0d\u5927, \u53ef\u4ee5\u5728 MQTT\u534f\u8bae\u8bf4\u660e \u67e5\u770b\u5177\u4f53\u533a\u522b. \u56e0\u6b64, \u6280\u672f\u4e0a\u6765\u8bf4, \u8bbe\u5907\u7ec8\u7aef\u53ea\u8981\u5b9e\u73b0\u4e86\u6807\u51c6\u7684MQTT\u5ba2\u6237\u7aef, \u5747\u53ef\u4ee5\u8ddf\u817e\u8baf\u4e91\u6b63\u5e38\u901a\u4fe1. \u5728\u672c\u8282\u4e2d, \u6211\u4eec\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528\u817e\u8bafTencentOS tiny\u4e0e\u817e\u8baf\u4e91\u901a\u8fc7MQTT\u8fdb\u884c\u901a\u4fe1. TencentOS Tiny \u96c6\u6210\u4e86\u5bf9MQTT\u548c\u817e\u8baf\u4e91\u7684\u652f\u6301, \u5f00\u53d1\u8005\u53ea\u9700\u8981\u901a\u8fc7\u7b80\u5355\u7684\u8bbe\u7f6e\u5373\u53ef\u5b9e\u73b0\u4e0e\u817e\u8baf\u4e91\u7684\u901a\u4fe1, \u6574\u4f53\u6b65\u9aa4\u4e3b\u8981\u5305\u542b: \u9879\u76ee\u5de5\u7a0b\u4e2d\u6dfb\u52a0MQTT\u7ec4\u4ef6\u76f8\u5173\u6587\u4ef6 \u9002\u914dAT HAL\u5c42\u4e32\u53e3\u53ca\u7f51\u7edc\u63a5\u53e3\u51fd\u6570 \u6267\u884c\u811a\u672c\u751f\u6210MQTT\u914d\u7f6e\u5934\u6587\u4ef6 \u8c03\u7528OS\u63d0\u4f9b\u7684\u63a5\u53e3\u5b8c\u6210\u548c\u817e\u8baf\u4e91\u7684\u5bf9\u63a5 \u9879\u76ee\u5de5\u7a0b\u4e2d\u6dfb\u52a0MQTT\u7ec4\u4ef6\u76f8\u5173\u6587\u4ef6 \u5728\u5de5\u7a0b\u6dfb\u52a0hal\u3001at\u3001devices\u3001\u548cmqtt client\u6e90\u7801, \u53ef\u4ee5\u53c2\u8003TencentOS-tiny\\board\\TencentOS_tiny_EVB_MX_Plus\\KEIL\\mqttclient\u5de5\u7a0b \u9002\u914dAT HAL\u5c42\u4e32\u53e3\u53ca\u7f51\u7edc\u63a5\u53e3\u51fd\u6570 \u4e0a\u5c42MQTT\u7684\u64cd\u4f5c\u6700\u7ec8\u90fd\u4f1a\u8f6c\u4e3a\u4e3a\u5bf9\u5e95\u5c42\u901a\u4fe1\u8bbe\u5907\u7684socket\u64cd\u4f5c, OS\u96c6\u6210\u4e86sal_module_wrapper\u5c42, \u4f46\u662f\u7531\u4e8e\u5404\u4e2a\u5f00\u53d1\u677f\u786c\u4ef6\u4e0d\u540c, \u56e0\u6b64\u9700\u8981\u5bf9sal_module_wrapper\u8fdb\u884c\u9002\u914d. \u9002\u914d\u8fc7\u7a0b\u7684\u6838\u5fc3\u6570\u636e\u7ed3\u6784\u4e3a sal_module_t , \u5728 TencentOS_tiny\\net\\sal_module_wrapper\\sal_module_wrapper.h \u6587\u4ef6\u4e2d\u5b9a\u4e49: typedef struct sal_module_st{ int (*init)(void); int (*get_local_mac)(char *mac); int (*get_local_ip)(char *ip, char *gw, char *mask); int (*parse_domain)(const char *host_name, char *host_ip, size_t host_ip_len); int (*connect)(const char *ip, const char *port, sal_proto_t proto); int (*send)(int sock, const void *buf, size_t len); int (*recv_timeout)(int sock, void *buf, size_t len, uint32_t timeout); int (*recv)(int sock, void *buf, size_t len); int (*sendto)(int sock, char *ip, char *port, const void *buf, size_t len); int (*recvfrom)(int sock, char *ip, char *port, void *buf, size_t len); int (*recvfrom_timeout)(int sock, char *ip, char *port, void *buf, size_t len, uint32_t timeout); int (*close)(int sock); }sal_module_t; \u5728\u4f7f\u7528\u7684\u65f6\u5019, \u5e76\u4e0d\u9700\u8981\u5168\u90e8\u5b9e\u73b0, \u53ea\u9700\u5b9e\u73b0\u4e0b\u5217\u51e0\u4e2a\u6838\u5fc3\u7684\u63a5\u53e3\u5373\u53ef: sal_module_t sal_module_esp8266 = { .init = esp8266_init, .connect = esp8266_connect, .send = esp8266_send, .recv_timeout = esp8266_recv_timeout, .recv = esp8266_recv, .sendto = esp8266_sendto, .recvfrom = esp8266_recvfrom, .recvfrom_timeout = esp8266_recvfrom_timeout, .close = esp8266_close, .parse_domain = esp8266_parse_domain, }; \u8fd9\u91cc\u63a5\u53e3\u5bf9\u5e94\u7684 esp8266_xxx \u51fd\u6570\u9700\u8981\u5f00\u53d1\u8005\u6839\u636e\u786c\u4ef6\u4e0a\u5177\u6709\u7684\u901a\u4fe1\u6a21\u7ec4\u8fdb\u884c\u76f8\u5e94\u7684\u9002\u914d. \u8be5\u7ed3\u6784\u586b\u5145\u5b8c\u540e, \u9700\u8981\u5728\u4f7f\u7528MQTT\u4e4b\u524d, \u8c03\u7528\u4e00\u4e0b\u521d\u59cb\u5316\u63a5\u53e3\u6ce8\u518c\u4e32\u53e3\u548c\u7f51\u7edcAPI\u51fd\u6570: esp8266_sal_init(hal_uart_port_t uart_port); \u4fee\u6539MQTT\u914d\u7f6e\u5934\u6587\u4ef6 \u4ece\u4e4b\u524d\u4ecb\u7ecd\u817e\u8baf\u4e91\u7aef\u914d\u7f6e\u7684\u7ae0\u8282\u4e2d\u53ef\u4ee5\u77e5\u9053, \u5728MQTT\u5ba2\u6237\u7aef, \u6240\u9700\u8981\u7684\u6838\u5fc3\u4fe1\u606f\u53ea\u5305\u542b: Product ID Device Name Device Password Client id mqtt username mqtt password \u5f00\u53d1\u8005\u5728\u7ec8\u7aef\u8282\u70b9\u5f00\u53d1\u8fc7\u7a0b\u4e2d, \u53ef\u4ee5\u81ea\u884c\u4fee\u6539MQTT\u914d\u7f6e\u53c2\u6570 #define IOTHUB_MQTT_IP \"111.230.189.156\" #define IOTHUB_MQTT_PORT \"1883\" #define IOTHUB_MQTT_CLIENT_ID \"KHHIXM0JJ5dev001\" #define IOTHUB_MQTT_USERNAME \"KHHIXM0JJ5dev001;12010126;9K3WO;1647628324\" #define IOTHUB_MQTT_PASSWD \"53696f22a061ed2524b1de185815ad2fcae7739afd3f395cb6131521da7f0bb7;hmacsha256\" #define IOTHUB_MQTT_PUB_TOPIC \"KHHIXM0JJ5/dev001/data\" #define IOTHUB_MQTT_SUB_TOPIC \"KHHIXM0JJ5/dev001/control\" \u5982\u4e0a\u6240\u793a, \u9700\u8981\u817e\u8baf\u4e91\u8bbe\u5907\u4fe1\u606f\u81ea\u884c\u4fee\u6539 Product ID , Device Name \u548c Password \uff0c MQTT_USR_NAME \uff0c MQTT_PASSWORD \uff0c MQTT_SUBSCRIBE_TOPIC \uff0c MQTT_PUBLISH_TOPIC \uff0c\u8ba2\u9605/\u53d1\u5e03\u7684topic, \u5982\u679c\u91c7\u7528\u9ed8\u8ba4\u7684control\u548cevent\u5982\u56fe\u5373\u53ef, \u4e5f\u53ef\u81ea\u884c\u8bbe\u7f6e. \u5f00\u53d1\u8005\u5c06\u5176\u653e\u7f6e\u5230\u81ea\u5df1\u7684\u5de5\u7a0b\u76ee\u5f55\u4e0b\u4efb\u610f\u4f4d\u7f6e\u5e76\u5728\u5de5\u7a0b\u4e2d\u6dfb\u52a0\u5934\u6587\u4ef6\u5f15\u7528\u5373\u53ef. \u8c03\u7528TencentOS tiny\u63d0\u4f9b\u7684\u63a5\u53e3\u5b8c\u6210\u548c\u817e\u8baf\u4e91\u7684\u5bf9\u63a5 \u4ee5\u4e0b\u662f\u4e0e\u817e\u8baf\u4e91\u5bf9\u63a5\u5e76\u6536\u53d1\u4fe1\u606f\u7684\u4f8b\u7a0b: /* Tencent IoThub Device Info */ #define IOTHUB_MQTT_IP \"111.230.189.156\" #define IOTHUB_MQTT_PORT \"1883\" #define IOTHUB_MQTT_CLIENT_ID \"KHHIXM0JJ5dev001\" #define IOTHUB_MQTT_USERNAME \"KHHIXM0JJ5dev001;12010126;9K3WO;1647628324\" #define IOTHUB_MQTT_PASSWD \"53696f22a061ed2524b1de185815ad2fcae7739afd3f395cb6131521da7f0bb7;hmacsha256\" #define IOTHUB_MQTT_PUB_TOPIC \"KHHIXM0JJ5/dev001/data\" #define IOTHUB_MQTT_SUB_TOPIC \"KHHIXM0JJ5/dev001/control\" static void tos_topic_handler(void* client, message_data_t* msg) { (void) client; MQTT_LOG_I(\"-----------------------------------------------------------------------------------\"); MQTT_LOG_I(\"%s:%d %s()...\\ntopic: %s, qos: %d. \\nmessage:\\n\\t%s\\n\", __FILE__, __LINE__, __FUNCTION__, msg->topic_name, msg->message->qos, (char*)msg->message->payload); MQTT_LOG_I(\"-----------------------------------------------------------------------------------\\n\"); } void mqttclient_task(void) { int error; char buf[100] = { 0 }; mqtt_client_t *client = NULL; mqtt_message_t msg; memset(&msg, 0, sizeof(msg)); #ifdef USE_ESP8266 esp8266_sal_init(HAL_UART_PORT_0); esp8266_join_ap(\"Mculover666\", \"mculover666\"); #endif #ifdef USE_NB_BC35 int bc35_28_95_sal_init(hal_uart_port_t uart_port); bc35_28_95_sal_init(HAL_UART_PORT_0); #endif #ifdef USE_EC600S ec600s_sal_init(HAL_UART_PORT_0); #endif mqtt_log_init(); client = mqtt_lease(); mqtt_set_port(client, IOTHUB_MQTT_PORT); mqtt_set_host(client, IOTHUB_MQTT_IP); mqtt_set_client_id(client, IOTHUB_MQTT_CLIENT_ID); mqtt_set_user_name(client, IOTHUB_MQTT_USERNAME); mqtt_set_password(client, IOTHUB_MQTT_PASSWD); mqtt_set_clean_session(client, 1); error = mqtt_connect(client); MQTT_LOG_D(\"mqtt connect error is %#x\", error); mqtt_subscribe(client, IOTHUB_MQTT_SUB_TOPIC, QOS0, tos_topic_handler); MQTT_LOG_D(\"mqtt subscribe error is %#x\", error); memset(&msg, 0, sizeof(msg)); for (;;) { sprintf(buf, \"welcome to mqttclient, this is a publish test, a rand number: %d ...\", random_number()); msg.qos = QOS0; msg.payload = (void *) buf; error = mqtt_publish(client, IOTHUB_MQTT_PUB_TOPIC, &msg); tos_task_delay(4000); } } void application_entry(void *arg) { mqttclient_task(); while (1) { printf(\"This is a mqtt demo!\\r\\n\"); tos_task_delay(1000); } }","title":"\u8bbe\u5907\u7ec8\u7aef\u8bbe\u7f6e"},{"location":"09.Code_Directories/","text":"TencentOS tiny \u4ee3\u7801\u76ee\u5f55\u8bf4\u660e \u4e00\u7ea7\u76ee\u5f55 \u4e8c\u7ea7\u76ee\u5f55 \u4e09\u7ea7\u76ee\u5f55 \u8bf4\u660e arch arm TencentOS tiny\u9002\u914d\u7684IP\u6838\u67b6\u6784\uff08\u542bM\u6838\u4e2d\u65ad\u3001\u8c03\u5ea6\u3001tick\u76f8\u5173\u4ee3\u7801\uff09 board TencentOS_tiny_EVB_MX TencentOS tiny \u5b9a\u5236\u5f00\u53d1\u677fdemo\uff0c\u5305\u542bAT\u9002\u914d\u6846\u67b6\u3001MQTT\u534f\u8bae\u3001\u5b89\u5168\u7ec4\u4ef6\u7b49 component connectivity loraWAN loRaWAN\u534f\u8bae\u6808\u5b9e\u73b0\u6e90\u7801\u53ca\u9002\u914d\u5c42 Eclipse-Paho-MQTT MQTT\u534f\u8bae\u6808\u5b9e\u73b0\u6e90\u7801\u53ca\u9002\u914d\u5c42 TencentCloud_SDK \u817e\u8baf\u4e91C-SDK\u5b9e\u73b0\u6e90\u7801\u53ca\u9002\u914d\u5c42 fs \u6587\u4ef6\u7cfb\u7edf\u5b9e\u73b0\u6e90\u7801 security mbedtls \u5b89\u5168\u534f\u8bae\u6e90\u7801 devices TencentOS tiny\u9002\u914d\u7684\u4e00\u4e9b\u5916\u8bbe\u9a71\u52a8\uff08\u5982\u4e32\u53e3wifi gprs \u9a71\u52a8\u7b49\uff09 doc TencentOS tiny\u76f8\u5173\u6280\u672f\u6587\u6863\u53ca\u5f00\u53d1\u6307\u5357 examples TencentOS tiny\u63d0\u4f9b\u7684\u529f\u80fd\u793a\u4f8b kernel core TencentOS tiny\u5185\u6838\u6e90\u7801 hal TencentOS tiny\u9a71\u52a8\u62bd\u8c61\u5c42 pm TencentOS tiny\u4f4e\u529f\u8017\u6a21\u5757\u6e90\u7801 net at TencentOS tiny\u4e3a\u4e32\u53e3\u7c7b\u901a\u4fe1\u6a21\u7ec4\u63d0\u4f9b\u7684AT\u6846\u67b6\u5b9e\u73b0\u5c42 lora_module_wrapper TencentOS tiny\u4e3a\u4e32\u53e3\u7c7bLoraWAN\u6a21\u5757\u63d0\u4f9b\u7684\u79fb\u690d\u6846\u67b6 lwip Lwip\u534f\u8bae\u5b9e\u73b0\u6e90\u7801\u53ca\u9002\u914d\u5c42 sal_module_wrapper TencentOS tiny\u4e3a\u4e32\u53e3\u7c7b\u7f51\u7edc\u6a21\u5757\uff08wifi gprs\uff09\u63d0\u4f9b\u7684socket\u79fb\u690d\u6846\u67b6 tencent_firmware_module_wrapper TencentOS tiny\u63d0\u4f9b\u7684\u817e\u8baf\u5b9a\u5236\u6a21\u7ec4\u79fb\u690d\u6846\u67b6 osal cmsis_os TencentOS tiny\u63d0\u4f9b\u7684cmsis os \u9002\u914d platform hal TencentOS tiny\u9002\u914d\u7684\u90e8\u5206\u82af\u7247\u7684\u9a71\u52a8\u5b9e\u73b0\u6e90\u7801 vendor_bsp \u82af\u7247\u5382\u5bb6\u63d0\u4f9b\u7684\u539f\u5382bsp\u56fa\u4ef6\u5e93\uff0c\u5982STM32\u7684HAL\u5e93 test \u5b58\u653eTencentOS tiny\u63d0\u4f9b\u7684\u4e00\u4e9b\u6d4b\u8bd5\u4ee3\u7801\uff0c\u542b\u5185\u6838\u53ca\u4e0a\u5c42\u6a21\u5757\u793a\u4f8b\u53ca\u6d4b\u8bd5\u4ee3\u7801 tools \u5b58\u653eTencentOS tiny\u63d0\u4f9b\u7684\u5de5\u5177\uff0c\u5c0f\u7a0b\u5e8f\uff0c\u914d\u7f6e\u5de5\u5177\u7b49","title":"09.Code_Directories"},{"location":"09.Code_Directories/#tencentos-tiny","text":"\u4e00\u7ea7\u76ee\u5f55 \u4e8c\u7ea7\u76ee\u5f55 \u4e09\u7ea7\u76ee\u5f55 \u8bf4\u660e arch arm TencentOS tiny\u9002\u914d\u7684IP\u6838\u67b6\u6784\uff08\u542bM\u6838\u4e2d\u65ad\u3001\u8c03\u5ea6\u3001tick\u76f8\u5173\u4ee3\u7801\uff09 board TencentOS_tiny_EVB_MX TencentOS tiny \u5b9a\u5236\u5f00\u53d1\u677fdemo\uff0c\u5305\u542bAT\u9002\u914d\u6846\u67b6\u3001MQTT\u534f\u8bae\u3001\u5b89\u5168\u7ec4\u4ef6\u7b49 component connectivity loraWAN loRaWAN\u534f\u8bae\u6808\u5b9e\u73b0\u6e90\u7801\u53ca\u9002\u914d\u5c42 Eclipse-Paho-MQTT MQTT\u534f\u8bae\u6808\u5b9e\u73b0\u6e90\u7801\u53ca\u9002\u914d\u5c42 TencentCloud_SDK \u817e\u8baf\u4e91C-SDK\u5b9e\u73b0\u6e90\u7801\u53ca\u9002\u914d\u5c42 fs \u6587\u4ef6\u7cfb\u7edf\u5b9e\u73b0\u6e90\u7801 security mbedtls \u5b89\u5168\u534f\u8bae\u6e90\u7801 devices TencentOS tiny\u9002\u914d\u7684\u4e00\u4e9b\u5916\u8bbe\u9a71\u52a8\uff08\u5982\u4e32\u53e3wifi gprs \u9a71\u52a8\u7b49\uff09 doc TencentOS tiny\u76f8\u5173\u6280\u672f\u6587\u6863\u53ca\u5f00\u53d1\u6307\u5357 examples TencentOS tiny\u63d0\u4f9b\u7684\u529f\u80fd\u793a\u4f8b kernel core TencentOS tiny\u5185\u6838\u6e90\u7801 hal TencentOS tiny\u9a71\u52a8\u62bd\u8c61\u5c42 pm TencentOS tiny\u4f4e\u529f\u8017\u6a21\u5757\u6e90\u7801 net at TencentOS tiny\u4e3a\u4e32\u53e3\u7c7b\u901a\u4fe1\u6a21\u7ec4\u63d0\u4f9b\u7684AT\u6846\u67b6\u5b9e\u73b0\u5c42 lora_module_wrapper TencentOS tiny\u4e3a\u4e32\u53e3\u7c7bLoraWAN\u6a21\u5757\u63d0\u4f9b\u7684\u79fb\u690d\u6846\u67b6 lwip Lwip\u534f\u8bae\u5b9e\u73b0\u6e90\u7801\u53ca\u9002\u914d\u5c42 sal_module_wrapper TencentOS tiny\u4e3a\u4e32\u53e3\u7c7b\u7f51\u7edc\u6a21\u5757\uff08wifi gprs\uff09\u63d0\u4f9b\u7684socket\u79fb\u690d\u6846\u67b6 tencent_firmware_module_wrapper TencentOS tiny\u63d0\u4f9b\u7684\u817e\u8baf\u5b9a\u5236\u6a21\u7ec4\u79fb\u690d\u6846\u67b6 osal cmsis_os TencentOS tiny\u63d0\u4f9b\u7684cmsis os \u9002\u914d platform hal TencentOS tiny\u9002\u914d\u7684\u90e8\u5206\u82af\u7247\u7684\u9a71\u52a8\u5b9e\u73b0\u6e90\u7801 vendor_bsp \u82af\u7247\u5382\u5bb6\u63d0\u4f9b\u7684\u539f\u5382bsp\u56fa\u4ef6\u5e93\uff0c\u5982STM32\u7684HAL\u5e93 test \u5b58\u653eTencentOS tiny\u63d0\u4f9b\u7684\u4e00\u4e9b\u6d4b\u8bd5\u4ee3\u7801\uff0c\u542b\u5185\u6838\u53ca\u4e0a\u5c42\u6a21\u5757\u793a\u4f8b\u53ca\u6d4b\u8bd5\u4ee3\u7801 tools \u5b58\u653eTencentOS tiny\u63d0\u4f9b\u7684\u5de5\u5177\uff0c\u5c0f\u7a0b\u5e8f\uff0c\u914d\u7f6e\u5de5\u5177\u7b49","title":"TencentOS tiny \u4ee3\u7801\u76ee\u5f55\u8bf4\u660e"},{"location":"10.Porting_Manual_for_KEIL/","text":"TencentOS tiny \u5185\u6838\u79fb\u690d\u53c2\u8003\u6307\u5357\uff08Keil\u7248\uff09 \u4e00\u3001\u79fb\u690d\u524d\u7684\u51c6\u5907 1. \u51c6\u5907\u76ee\u6807\u786c\u4ef6\uff08\u5f00\u53d1\u677f/\u82af\u7247/\u6a21\u7ec4\uff09 TencentOS tiny\u76ee\u524d\u4e3b\u8981\u652f\u6301ARM Cortex M\u6838\u82af\u7247\u7684\u79fb\u690d\uff0c\u6bd4\u5982STM32 \u57fa\u4e8eCortex M\u6838\u5168\u7cfb\u5217\u3001NXP \u57fa\u4e8eCortex M\u6838\u5168\u7cfb\u5217\u7b49\u3002\u672c\u6559\u7a0b\u5c06\u4f7f\u7528STM32\u5b98\u65b9Demo\u5f00\u53d1\u677f NUCLEO-L073RZ\u8fdb\u884c\u793a\u4f8b\u79fb\u690d\uff0c\u5176\u4ed6 ARM Cortex M\u7cfb\u5217\u5f00\u53d1\u677f\u548c\u82af\u7247\u79fb\u690d\u65b9\u6cd5\u7c7b\u4f3c\u3002 \u8c03\u8bd5ARM Cortex M\u6838\u8fd8\u9700\u8981\u4eff\u771f\u5668\uff0c NUCLEO-L073RZ\u81ea\u5e26ST-Link\u8c03\u8bd5\u5668\uff0c\u5982\u679c\u60a8\u7684\u5f00\u53d1\u677f\u6216\u8005\u82af\u7247\u6a21\u7ec4\u6ca1\u6709\u677f\u8f7d\u4eff\u771f\u5668\uff0c\u5c31\u9700\u8981\u8fde\u63a5\u5916\u7f6e\u7684\u4eff\u771f\u5668\uff0c\u5982J-Link\u3001U-Link\u4e4b\u7c7b\u7684\u3002 2.\u51c6\u5907\u7f16\u8bd1\u5668\u73af\u5883 \u672c\u79fb\u690d\u6307\u5357\u9488\u5bf9\u7684\u662fKeil\u7f16\u8bd1\u5668\uff0c\u6240\u4ee5\u6211\u4eec\u79fb\u690d\u5185\u6838\u524d\u9700\u8981\u5148\u5b89\u88c5Keil\u7f16\u8bd1\u5668\uff0c\u80fd\u7f16\u8bd1ARM Cortex M\u6838\u7684Keil\u7f16\u8bd1\u5668\u73b0\u5728\u4e5f\u53ebMDK\uff0c\u6700\u65b0\u7248\u672c5.28a,\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://www.keil.com/demo/eval/arm.htm \u586b\u5199\u6ce8\u518c\u4fe1\u606f\u5373\u53ef\u4e0b\u8f7d\uff0c\u4e0b\u8f7d\u5b8c\u6210\u5728windows\u73af\u5883\u4e0b\u6309\u7167\u63d0\u793a\u5b89\u88c5\u5373\u53ef\uff0c\u5b89\u88c5\u5b8c\u6210\u540e\u9700\u8981\u81ea\u884c\u8d2d\u4e70\u8f6f\u4ef6License\uff0c\u907f\u514d32K Flash\u4e0b\u8f7d\u9650\u5236\u3002 \u7531\u4e8e\u65b0\u7248\u672c\u7684MDK\u7f16\u8bd1\u5668\u548c\u82af\u7247\u652f\u6301\u5305\u662f\u5206\u79bb\u7684\uff0c\u6240\u4ee5MDK\uff08Keil\uff09\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u8fd8\u9700\u8981\u5b89\u88c5\u5bf9\u5e94\u82af\u7247\u7684\u5668\u4ef6\u652f\u6301\u5305\uff08PACK\u5305\uff09\uff0c\u6bd4\u5982\u672c\u6559\u7a0b\u793a\u4f8b\u7684NUCLEO-L037RZ\u5f00\u53d1\u677f\u7684\u82af\u7247\u662fSTM32L073RZ\uff0c\u5c31\u9700\u8981\u5b89\u88c5 Keil.STM32L0xx_DFP.2.0.1.pack \u7cfb\u5217\u5668\u4ef6\u652f\u6301\u5305\uff0cMDK\u6240\u6709\u652f\u6301\u82af\u7247\u7684PACK\u5305\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a http://www.keil.com/dd2/Pack/#/eula-container \uff0c\u60a8\u53ea\u9700\u8981\u6839\u636e\u60a8\u7684\u82af\u7247\u578b\u53f7\u4e0b\u8f7d\u5bf9\u5e94\u7684PACK\u5305\u5373\u53ef\uff0c\u5f53\u7136\u60a8\u4e5f\u53ef\u4ee5\u5728MDK\u96c6\u6210\u5f00\u53d1\u73af\u5883\u4e2d\u5728\u7ebf\u4e0b\u8f7d\u5b89\u88c5\u3002 3. \u51c6\u5907\u82af\u7247\u5bf9\u5e94\u7684\u88f8\u673a\u5de5\u7a0b \u79fb\u690dTencentOS tiny\u57fa\u7840\u5185\u6838\u9700\u8981\u60a8\u63d0\u524d\u51c6\u5907\u4e00\u4e2a\u82af\u7247\u5bf9\u5e94\u7684\u88f8\u673a\u5de5\u7a0b\uff0c\u88f8\u673a\u5de5\u7a0b\u5305\u542b\u57fa\u672c\u7684\u82af\u7247\u542f\u52a8\u6587\u4ef6\u3001\u57fa\u7840\u914d\u7f6e\uff08\u65f6\u949f\u3001\u4e3b\u9891\u7b49\uff09\u3001\u4ee5\u53ca\u4e32\u53e3\u3001\u57fa\u672cGPIO\u9a71\u52a8\u7528\u4e8eRTOS\u6d4b\u8bd5\u3002 \u672c\u6559\u7a0b\u4f7f\u7528ST\u5b98\u65b9\u7684STM32CubeMX\u8f6f\u4ef6\u6765\u81ea\u52a8\u5316\u751f\u6210MDK\u88f8\u673a\u5de5\u7a0b\uff0cSTM32CubeMX\u7684\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://www.st.com/content/st_com/zh/products/development-tools/software-development-tools/stm32-software-development-tools/stm32-configurators-and-code-generators/stm32cubemx.html \u5b89\u88c5STM32CubeMx\u8fd8\u9700\u8981\u4e8b\u5148\u5b89\u88c5\u597dJDK\u73af\u5883\uff0c\u60a8\u53ef\u4ee5\u5728\u4e92\u8054\u7f51\u4e0a\u67e5\u627e\u5982\u4f55\u5b89\u88c5\u548c\u914d\u7f6eJDK\u73af\u5883\uff0c\u6b64\u5904\u4e0d\u518d\u8d58\u8ff0\u3002 CubeMX\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528CubeMX\u6765\u7ed9NUCLEO-L073RZ\u5f00\u53d1\u677f\u751f\u6210\u88f8\u673a\u5de5\u7a0b\u4e86\uff0c\u5982\u679c\u60a8\u7684\u82af\u7247\u4e0d\u662fSTM32\uff0c\u800c\u662f\u5176\u4ed6\u5382\u5546\u7684ARM Cortex M\u7cfb\u5217\uff0c\u60a8\u53ef\u4ee5\u6839\u636e\u4ea7\u5546\u7684\u6307\u5bfc\u51c6\u5907\u88f8\u673a\u5de5\u7a0b\uff0c\u540e\u7eed\u7684\u5185\u6838\u79fb\u690d\u6b65\u9aa4\u662f\u4e00\u81f4\u7684\u3002 3.1 \u9996\u5148\u542f\u52a8STM32CubeMX\uff0c\u65b0\u5efa\u5de5\u7a0b 3.2 \u9009\u62e9MCU\u578b\u53f7 \u5982\u4e0a\u56fe\u6240\u793a\uff1a\u901a\u8fc7MCU\u7b5b\u9009\u6765\u627e\u5230\u81ea\u5df1\u5f00\u53d1\u677f\u5bf9\u5e94\u7684\u82af\u7247\u578b\u53f7\uff0c\u53cc\u51fb\u540e\u5f39\u51fa\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\uff0c\u5982\u4e0b\u56fe\uff1a 3.3 Pin\u8bbe\u7f6e\u754c\u9762\u914d\u7f6e\u65f6\u949f\u6e90 3.4 Pin\u8bbe\u7f6e\u754c\u9762\u914d\u7f6e\u4e32\u53e3 3.5 Pin\u8bbe\u7f6e\u754c\u9762\u914d\u7f6eGPIO 3.6 \u914d\u7f6e\u603b\u7ebf\u65f6\u949f 3.7 \u5de5\u7a0b\u751f\u6210\u53c2\u6570\u914d\u7f6e 3.8 \u4ee3\u7801\u751f\u6210\u65b9\u5f0f\u914d\u7f6e 3.9 \u751f\u6210\u5de5\u7a0b 3.10 keil\u4e0b\u7684\u88f8\u673a\u5de5\u7a0b \u70b9\u51fb\u751f\u6210\u4ee3\u7801\u540e\uff0c\u751f\u6210\u7684\u88f8\u673a\u5de5\u7a0b\u6548\u679c\u5982\u4e0b\uff1a \u8fd9\u6837NUCLEO-L073RZ\u88f8\u673a\u5de5\u7a0b\u751f\u6210\u5b8c\u6210\uff0c\u8be5\u5de5\u7a0b\u53ef\u76f4\u63a5\u7f16\u8bd1\u5e76\u70e7\u5199\u5728\u677f\u5b50\u4e0a\u8fd0\u884c\u3002 4. \u51c6\u5907TencentOS tiny\u7684\u6e90\u7801 TencentOS tiny\u7684\u6e90\u7801\u5df2\u7ecf\u5f00\u6e90\uff0cgithub\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://github.com/Tencent/TencentOS-tiny.git \u4e00\u7ea7\u76ee\u5f55 \u4e8c\u7ea7\u76ee\u5f55 \u8bf4\u660e arch arm TencentOS tiny\u9002\u914d\u7684IP\u6838\u67b6\u6784\uff08\u542bM\u6838\u4e2d\u65ad\u3001\u8c03\u5ea6\u3001tick\u76f8\u5173\u4ee3\u7801\uff09 board NUCLEO_L073RZ \u79fb\u690d\u76ee\u6807\u82af\u7247\u7684\u5de5\u7a0b\u6587\u4ef6 kernel core TencentOS tiny\u5185\u6838\u6e90\u7801 pm TencentOS tiny\u4f4e\u529f\u8017\u6a21\u5757\u6e90\u7801 osal cmsis_os TencentOS tiny\u63d0\u4f9b\u7684cmsis os \u9002\u914d \u7531\u4e8e\u672c\u6559\u7a0b\u53ea\u4ecb\u7ecdTencentOS tiny\u7684\u5185\u6838\u79fb\u690d\uff0c\u6240\u4ee5\u8fd9\u91cc\u53ea\u9700\u8981\u7528\u5230 arch\u3001board\u3001kernel\u3001osal\u56db\u4e2a\u76ee\u5f55\u4e0b\u7684\u6e90\u7801\u3002 \u4e8c\u3001\u5185\u6838\u79fb\u690d 1. \u4ee3\u7801\u76ee\u5f55\u89c4\u5212 \u5982\u56fe\u6240\u793a\uff0c\u65b0\u5efaTencentOS_tiny\u4e3b\u76ee\u5f55\uff0c\u5e76\u5728\u4e3b\u76ee\u5f55\u4e0b\u6dfb\u52a0\u56db\u4e2a\u5b50\u76ee\u5f55\uff0c\u5176\u4e2darch\u3001kernel\u3001osal\u4ece\u4ee3\u7801\u4ed3\u76f4\u63a5\u62f7\u8d1d\u8fc7\u6765\u5373\u53ef\uff0c\u800cboard\u76ee\u5f55\u4e0b\u5219\u653e\u5165\u6211\u4eec\u524d\u9762\u751f\u6210\u7684\u88f8\u673a\u5de5\u7a0b\u4ee3\u7801\uff0c\u6211\u4eec\u79fb\u690d\u7684\u5f00\u53d1\u677f\u53d6\u540d\u53ebNUCLEO_L073RZ,\u88f8\u673a\u4ee3\u7801\u5168\u90e8\u62f7\u8d1d\u5230\u4e0b\u9762\u5373\u53ef\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u63a5\u4e0b\u6765\u8fdb\u5165TencentOS_tiny\\board\\NUCLEO_L073RZ\\MDK-ARM\u76ee\u5f55\uff0c\u6253\u5f00keil\u5de5\u7a0b\uff0c\u6211\u4eec\u5f00\u59cb\u6dfb\u52a0TencentOS tiny\u7684\u5185\u6838\u4ee3\u7801\u3002 2. \u6dfb\u52a0arch\u5e73\u53f0\u4ee3\u7801 tos_cpu.c\u662fTencentOS tiny \u7684CPU\u9002\u914d\u6587\u4ef6\uff0c\u5305\u62ec\u5806\u6808\u521d\u59cb\u5316\uff0c\u4e2d\u65ad\u9002\u914d\u7b49\uff0c\u5982\u679c\u60a8\u7684\u82af\u7247\u662fARM Cortex M\u6838\uff0c\u8be5\u6587\u4ef6\u53ef\u4ee5\u4e0d\u505a\u6539\u52a8\uff0cM0\u3001M3 \u3001M4\u3001M7\u662f\u901a\u7528\u7684\uff0c\u5176\u4ed6IP\u6838\u9700\u8981\u91cd\u65b0\u9002\u914d\uff1b port_s.S \u6587\u4ef6\u662fTencentOS tiny\u7684\u4efb\u52a1\u8c03\u5ea6\u6c47\u7f16\u4ee3\u7801\uff0c\u4e3b\u8981\u505a\u5f39\u6808\u538b\u6808\u7b49\u5904\u7406\u7684\uff0cport_c.c\u9002\u914dsystick\u7b49\uff0c\u8fd9\u4e24\u4e2a\u6587\u4ef6 \u6bcf\u4e2aIP\u6838\u548c\u7f16\u8bd1\u5668\u90fd\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u5982\u679c\u60a8\u7684\u82af\u7247\u662fARM Cortex M\u6838\uff0c\u6211\u4eec\u90fd\u5df2\u7ecf\u9002\u914d\u597d\uff0c\u6bd4\u5982\u73b0\u5728\u6211\u4eec\u79fb\u690d\u7684\u82af\u7247\u662fSTM32L073RZ\uff0c\u662fARM Cortex M0+\u6838\uff0c\u4f7f\u7528\u7684\u7f16\u8bd1\u5668\u662fKEIL\uff0c\u6240\u4ee5\u6211\u4eec\u9009\u62e9arch\\arm\\arm-v7m\\cortex-m0+\\armcc\u4e0b\u7684\u9002\u914d\u4ee3\u7801\uff0c\u5982\u679c\u4f60\u7684\u5f00\u53d1\u677f\u662fSTM32F429IG\uff0cM4\u6838\uff0c\u7f16\u8bd1\u5668\u662fGCC\uff0c\u5219\u53ef\u4ee5\u9009\u62e9arch\\arm\\arm-v7m\\cortex-m4\\gcc\u76ee\u5f55\u4e0b\u7684\u9002\u914d\u6587\u4ef6\u3002 3. \u6dfb\u52a0\u5185\u6838\u6e90\u7801 \u5185\u6838\u6e90\u7801kerne\u76ee\u5f55\u4e0b\u5305\u542bcore\u548cpm\u4e24\u4e2a\u76ee\u5f55\uff0c\u5176\u4e2dcore\u4e0b\u4e3a\u57fa\u7840\u5185\u6838\uff0cpm\u662f\u5185\u6838\u4e2d\u7684\u4f4e\u529f\u8017\u7ec4\u4ef6\uff1b\u57fa\u7840\u79fb\u690d\u7684\u65f6\u5019\u53ef\u4ee5\u4e0d\u6dfb\u52a0pm\u76ee\u5f55\u4e0b\u7684\u4ee3\u7801\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u6dfb\u52a0\u5168\u90e8\u57fa\u672c\u5185\u6838\u6e90\u7801\uff1a 4. \u6dfb\u52a0cmsis os\u6e90\u7801 cmsis os\u662fTencentOS tiny\u4e3a\u4e86\u517c\u5bb9cmsis\u6807\u51c6\u800c\u9002\u914d\u7684OS\u62bd\u8c61\u5c42\uff0c\u53ef\u4ee5\u7b80\u5316\u5927\u5bb6\u5c06\u4e1a\u52a1\u4ece\u5176\u4ed6RTOS\u8fc1\u79fb\u5230TencentOS tiny\u7684\u5de5\u4f5c\u91cf\u3002 5. \u6dfb\u52a0TencentOS tiny\u5934\u6587\u4ef6\u76ee\u5f55 \u6dfb\u52a0\u5934\u6587\u4ef6\u76ee\u5f55\u524d\uff0c\u6211\u4eec\u5728\u8981\u79fb\u690d\u7684\u5de5\u7a0b\u76ee\u5f55\u4e0b\u65b0\u589e\u4e00\u4e2a TOS_CONFIG\u6587\u4ef6\u5939\uff0c\u7528\u4e8e\u5b58\u653eTencentOS tiny\u7684\u914d\u7f6e\u5934\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f\u63a5\u4e0b\u6765\u8981\u65b0\u5efa\u7684tos_config.h\u6587\u4ef6\uff1b TencentOS tiny\u6240\u6709\u8981\u6dfb\u52a0\u7684\u5934\u6587\u4ef6\u76ee\u5f55\u5982\u4e0b\uff1a 6. \u65b0\u5efaTencentOS tiny\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6 tos_config.h #ifndef _TOS_CONFIG_H_ #define _TOS_CONFIG_H_ #include \"stm32l0xx.h\" // \u76ee\u6807\u82af\u7247\u5934\u6587\u4ef6\uff0c\u7528\u6237\u9700\u8981\u6839\u636e\u60c5\u51b5\u66f4\u6539 #define TOS_CFG_TASK_PRIO_MAX 10u // \u914d\u7f6eTencentOS tiny\u9ed8\u8ba4\u652f\u6301\u7684\u6700\u5927\u4f18\u5148\u7ea7\u6570\u91cf #define TOS_CFG_ROUND_ROBIN_EN 0u // \u914d\u7f6eTencentOS tiny\u7684\u5185\u6838\u662f\u5426\u5f00\u542f\u65f6\u95f4\u7247\u8f6e\u8f6c #define TOS_CFG_OBJECT_VERIFY_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u6821\u9a8c\u6307\u9488\u5408\u6cd5 #define TOS_CFG_TASK_DYNAMIC_CREATE_EN 1u // TencentOS tiny \u52a8\u6001\u4efb\u52a1\u521b\u5efa\u529f\u80fd\u5b8f #define TOS_CFG_EVENT_EN 1u // TencentOS tiny \u4e8b\u4ef6\u6a21\u5757\u529f\u80fd\u5b8f #define TOS_CFG_MMBLK_EN 1u //\u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u5185\u5b58\u5757\u7ba1\u7406\u6a21\u5757 #define TOS_CFG_MMHEAP_EN 1u //\u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u52a8\u6001\u5185\u5b58\u6a21\u5757 #define TOS_CFG_MMHEAP_DEFAULT_POOL_EN 1u // TencentOS tiny \u9ed8\u8ba4\u52a8\u6001\u5185\u5b58\u6c60\u529f\u80fd\u5b8f #define TOS_CFG_MMHEAP_DEFAULT_POOL_SIZE 0x100 // \u914d\u7f6eTencentOS tiny\u9ed8\u8ba4\u52a8\u6001\u5185\u5b58\u6c60\u5927\u5c0f #define TOS_CFG_MUTEX_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4e92\u65a5\u9501\u6a21\u5757 #define TOS_CFG_MESSAGE_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u6d88\u606f\u961f\u5217\u6a21\u5757 #define TOS_CFG_MAIL_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u6d88\u606f\u90ae\u7bb1\u6a21\u5757 #define TOS_CFG_PRIORITY_MESSAGE_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u6a21\u5757 #define TOS_CFG_PRIORITY_MAIL_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4f18\u5148\u7ea7\u6d88\u606f\u90ae\u7bb1\u6a21\u5757 #define TOS_CFG_TIMER_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u8f6f\u4ef6\u5b9a\u65f6\u5668\u6a21\u5757 #define TOS_CFG_PWR_MGR_EN 0u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u5916\u8bbe\u7535\u6e90\u7ba1\u7406\u6a21\u5757 #define TOS_CFG_TICKLESS_EN 0u // \u914d\u7f6eTickless \u4f4e\u529f\u8017\u6a21\u5757\u5f00\u5173 #define TOS_CFG_SEM_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4fe1\u53f7\u91cf\u6a21\u5757 #define TOS_CFG_TASK_STACK_DRAUGHT_DEPTH_DETACT_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4efb\u52a1\u6808\u6df1\u5ea6\u68c0\u6d4b #define TOS_CFG_FAULT_BACKTRACE_EN 0u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u5f02\u5e38\u6808\u56de\u6eaf\u529f\u80fd #define TOS_CFG_IDLE_TASK_STK_SIZE 128u // \u914d\u7f6eTencentOS tiny\u7a7a\u95f2\u4efb\u52a1\u6808\u5927\u5c0f #define TOS_CFG_CPU_TICK_PER_SECOND 1000u // \u914d\u7f6eTencentOS tiny\u7684tick\u9891\u7387 #define TOS_CFG_CPU_CLOCK (SystemCoreClock) // \u914d\u7f6eTencentOS tiny CPU\u9891\u7387 #define TOS_CFG_TIMER_AS_PROC 1u // \u914d\u7f6e\u662f\u5426\u5c06TIMER\u914d\u7f6e\u6210\u51fd\u6570\u6a21\u5f0f #endif \u6309\u7167\u4e0a\u9762\u7684\u6a21\u677f\u914d\u7f6e\u597dTencentOS tiny\u7684\u5404\u9879\u529f\u80fd\u540e\uff0c\u5c06tos_config.h \u6587\u4ef6\u653e\u5165\u8981\u79fb\u690d\u7684board\u5de5\u7a0b\u76ee\u5f55\u4e0b\u5373\u53ef\uff0c\u4f8b\u5982\u672c\u6559\u7a0b\u662f\u653e\u5230board\\NUCLEO_L073RZ\\TOS_CONFIG\u76ee\u5f55\u4e0b\u3002 \u8fd9\u6837\uff0cTencentOS tiny\u7684\u6e90\u7801\u5c31\u5168\u90e8\u6dfb\u52a0\u5b8c\u6bd5\u4e86\u3002 \u4e09\u3001\u521b\u5efaTencentOS tiny\u4efb\u52a1\uff0c\u6d4b\u8bd5\u79fb\u690d\u7ed3\u679c 1. \u4fee\u6539\u90e8\u5206\u4ee3\u7801 \u4fee\u6539stm32l0xx_it.c\u7684\u4e2d\u65ad\u51fd\u6570,\u5728stm32l0xx_it.c\u6587\u4ef6\u4e2d\u5305\u542b tos_k.h \u5934\u6587\u4ef6 \u5728stm32l0xx_it.c\u6587\u4ef6\u4e2d\u7684PendSV_Handler\u51fd\u6570\u524d\u6dfb\u52a0___weak\u5173\u952e\u5b57\uff0c\u56e0\u4e3a\u8be5\u51fd\u6570\u5728TencentOS tiny\u7684\u8c03\u5ea6\u6c47\u7f16\u4e2d\u5df2\u7ecf\u91cd\u65b0\u5b9e\u73b0\uff1b\u540c\u65f6\u5728SysTick_Handler\u51fd\u6570\u4e2d\u6dfb\u52a0TencentOS tiny\u7684\u8c03\u5ea6\u5904\u7406\u51fd\u6570\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a 2. \u7f16\u5199TencentOS tiny \u6d4b\u8bd5\u4efb\u52a1 \u5728mian.c \u4e2d\u6dfb\u52a0TencentOS tiny \u5934\u6587\u4ef6\uff0c\u7f16\u5199\u4efb\u52a1\u51fd\u6570 #include \"cmsis_os.h\" //task1 #define TASK1_STK_SIZE 256 void task1(void *pdata); osThreadDef(task1, osPriorityNormal, 1, TASK1_STK_SIZE); //task2 #define TASK2_STK_SIZE 256 void task2(void *pdata); osThreadDef(task2, osPriorityNormal, 1, TASK2_STK_SIZE); void task1(void *pdata) { int count = 1; while(1) { printf(\"\\r\\nHello world!\\r\\n###This is task1 ,count is %d \\r\\n\", count++); HAL_GPIO_TogglePin(LED_GPIO_Port,LED_Pin); osDelay(2000); } } void task2(void *pdata) { int count = 1; while(1) { printf(\"\\r\\nHello TencentOS !\\r\\n***This is task2 ,count is %d \\r\\n\", count++); osDelay(1000); } } int fputc(int ch, FILE *f) { if (ch == '\\n') { HAL_UART_Transmit(&huart2, (void *)\"\\r\", 1,30000); } HAL_UART_Transmit(&huart2, (uint8_t *)&ch, 1, 0xFFFF); return ch; } \u5982\u56fe\uff1a \u7ee7\u7eed\u5728main.c \u7684mian\u51fd\u6570\u4e2d\u786c\u4ef6\u5916\u8bbe\u521d\u59cb\u5316\u4ee3\u7801\u540e\u6dfb\u52a0TencentOS tiny\u7684\u521d\u59cb\u5316\u4ee3\u7801\uff1a osKernelInitialize(); //TOS Tiny kernel initialize osThreadCreate(osThread(task1), NULL);// Create task1 osThreadCreate(osThread(task2), NULL);// Create task2 osKernelStart();//Start TOS Tiny \u5982\u56fe\uff1a 3. \u7f16\u8bd1\u4e0b\u8f7d\u6d4b\u8bd5TencentOS tiny\u79fb\u690d\u7ed3\u679c \u6309\u7167\u4e0a\u56fe\u6307\u793a\uff0c\u8fdb\u884c\u7f16\u8bd1\u4e0b\u8f7d\u5230\u5f00\u53d1\u677f\u5373\u53ef\u5b8c\u6210TencentOS tiny\u7684\u6d4b\u8bd5\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u53ef\u4ee5\u770b\u5230\u4e32\u53e3\u4ea4\u66ff\u6253\u5370\u4fe1\u606f\uff0c\u8868\u793a\u4e24\u4e2a\u4efb\u52a1\u6b63\u5728\u8fdb\u884c\u8c03\u5ea6\uff0c\u5207\u6362\u8fd0\u884c\uff1a","title":"10.Porting_Manual_for_KEIL"},{"location":"10.Porting_Manual_for_KEIL/#tencentos-tiny-keil","text":"","title":"TencentOS tiny \u5185\u6838\u79fb\u690d\u53c2\u8003\u6307\u5357\uff08Keil\u7248\uff09"},{"location":"10.Porting_Manual_for_KEIL/#_1","text":"","title":"\u4e00\u3001\u79fb\u690d\u524d\u7684\u51c6\u5907"},{"location":"10.Porting_Manual_for_KEIL/#1","text":"TencentOS tiny\u76ee\u524d\u4e3b\u8981\u652f\u6301ARM Cortex M\u6838\u82af\u7247\u7684\u79fb\u690d\uff0c\u6bd4\u5982STM32 \u57fa\u4e8eCortex M\u6838\u5168\u7cfb\u5217\u3001NXP \u57fa\u4e8eCortex M\u6838\u5168\u7cfb\u5217\u7b49\u3002\u672c\u6559\u7a0b\u5c06\u4f7f\u7528STM32\u5b98\u65b9Demo\u5f00\u53d1\u677f NUCLEO-L073RZ\u8fdb\u884c\u793a\u4f8b\u79fb\u690d\uff0c\u5176\u4ed6 ARM Cortex M\u7cfb\u5217\u5f00\u53d1\u677f\u548c\u82af\u7247\u79fb\u690d\u65b9\u6cd5\u7c7b\u4f3c\u3002 \u8c03\u8bd5ARM Cortex M\u6838\u8fd8\u9700\u8981\u4eff\u771f\u5668\uff0c NUCLEO-L073RZ\u81ea\u5e26ST-Link\u8c03\u8bd5\u5668\uff0c\u5982\u679c\u60a8\u7684\u5f00\u53d1\u677f\u6216\u8005\u82af\u7247\u6a21\u7ec4\u6ca1\u6709\u677f\u8f7d\u4eff\u771f\u5668\uff0c\u5c31\u9700\u8981\u8fde\u63a5\u5916\u7f6e\u7684\u4eff\u771f\u5668\uff0c\u5982J-Link\u3001U-Link\u4e4b\u7c7b\u7684\u3002","title":"1. \u51c6\u5907\u76ee\u6807\u786c\u4ef6\uff08\u5f00\u53d1\u677f/\u82af\u7247/\u6a21\u7ec4\uff09"},{"location":"10.Porting_Manual_for_KEIL/#2","text":"\u672c\u79fb\u690d\u6307\u5357\u9488\u5bf9\u7684\u662fKeil\u7f16\u8bd1\u5668\uff0c\u6240\u4ee5\u6211\u4eec\u79fb\u690d\u5185\u6838\u524d\u9700\u8981\u5148\u5b89\u88c5Keil\u7f16\u8bd1\u5668\uff0c\u80fd\u7f16\u8bd1ARM Cortex M\u6838\u7684Keil\u7f16\u8bd1\u5668\u73b0\u5728\u4e5f\u53ebMDK\uff0c\u6700\u65b0\u7248\u672c5.28a,\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://www.keil.com/demo/eval/arm.htm \u586b\u5199\u6ce8\u518c\u4fe1\u606f\u5373\u53ef\u4e0b\u8f7d\uff0c\u4e0b\u8f7d\u5b8c\u6210\u5728windows\u73af\u5883\u4e0b\u6309\u7167\u63d0\u793a\u5b89\u88c5\u5373\u53ef\uff0c\u5b89\u88c5\u5b8c\u6210\u540e\u9700\u8981\u81ea\u884c\u8d2d\u4e70\u8f6f\u4ef6License\uff0c\u907f\u514d32K Flash\u4e0b\u8f7d\u9650\u5236\u3002 \u7531\u4e8e\u65b0\u7248\u672c\u7684MDK\u7f16\u8bd1\u5668\u548c\u82af\u7247\u652f\u6301\u5305\u662f\u5206\u79bb\u7684\uff0c\u6240\u4ee5MDK\uff08Keil\uff09\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u8fd8\u9700\u8981\u5b89\u88c5\u5bf9\u5e94\u82af\u7247\u7684\u5668\u4ef6\u652f\u6301\u5305\uff08PACK\u5305\uff09\uff0c\u6bd4\u5982\u672c\u6559\u7a0b\u793a\u4f8b\u7684NUCLEO-L037RZ\u5f00\u53d1\u677f\u7684\u82af\u7247\u662fSTM32L073RZ\uff0c\u5c31\u9700\u8981\u5b89\u88c5 Keil.STM32L0xx_DFP.2.0.1.pack \u7cfb\u5217\u5668\u4ef6\u652f\u6301\u5305\uff0cMDK\u6240\u6709\u652f\u6301\u82af\u7247\u7684PACK\u5305\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a http://www.keil.com/dd2/Pack/#/eula-container \uff0c\u60a8\u53ea\u9700\u8981\u6839\u636e\u60a8\u7684\u82af\u7247\u578b\u53f7\u4e0b\u8f7d\u5bf9\u5e94\u7684PACK\u5305\u5373\u53ef\uff0c\u5f53\u7136\u60a8\u4e5f\u53ef\u4ee5\u5728MDK\u96c6\u6210\u5f00\u53d1\u73af\u5883\u4e2d\u5728\u7ebf\u4e0b\u8f7d\u5b89\u88c5\u3002","title":"2.\u51c6\u5907\u7f16\u8bd1\u5668\u73af\u5883"},{"location":"10.Porting_Manual_for_KEIL/#3","text":"\u79fb\u690dTencentOS tiny\u57fa\u7840\u5185\u6838\u9700\u8981\u60a8\u63d0\u524d\u51c6\u5907\u4e00\u4e2a\u82af\u7247\u5bf9\u5e94\u7684\u88f8\u673a\u5de5\u7a0b\uff0c\u88f8\u673a\u5de5\u7a0b\u5305\u542b\u57fa\u672c\u7684\u82af\u7247\u542f\u52a8\u6587\u4ef6\u3001\u57fa\u7840\u914d\u7f6e\uff08\u65f6\u949f\u3001\u4e3b\u9891\u7b49\uff09\u3001\u4ee5\u53ca\u4e32\u53e3\u3001\u57fa\u672cGPIO\u9a71\u52a8\u7528\u4e8eRTOS\u6d4b\u8bd5\u3002 \u672c\u6559\u7a0b\u4f7f\u7528ST\u5b98\u65b9\u7684STM32CubeMX\u8f6f\u4ef6\u6765\u81ea\u52a8\u5316\u751f\u6210MDK\u88f8\u673a\u5de5\u7a0b\uff0cSTM32CubeMX\u7684\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://www.st.com/content/st_com/zh/products/development-tools/software-development-tools/stm32-software-development-tools/stm32-configurators-and-code-generators/stm32cubemx.html \u5b89\u88c5STM32CubeMx\u8fd8\u9700\u8981\u4e8b\u5148\u5b89\u88c5\u597dJDK\u73af\u5883\uff0c\u60a8\u53ef\u4ee5\u5728\u4e92\u8054\u7f51\u4e0a\u67e5\u627e\u5982\u4f55\u5b89\u88c5\u548c\u914d\u7f6eJDK\u73af\u5883\uff0c\u6b64\u5904\u4e0d\u518d\u8d58\u8ff0\u3002 CubeMX\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528CubeMX\u6765\u7ed9NUCLEO-L073RZ\u5f00\u53d1\u677f\u751f\u6210\u88f8\u673a\u5de5\u7a0b\u4e86\uff0c\u5982\u679c\u60a8\u7684\u82af\u7247\u4e0d\u662fSTM32\uff0c\u800c\u662f\u5176\u4ed6\u5382\u5546\u7684ARM Cortex M\u7cfb\u5217\uff0c\u60a8\u53ef\u4ee5\u6839\u636e\u4ea7\u5546\u7684\u6307\u5bfc\u51c6\u5907\u88f8\u673a\u5de5\u7a0b\uff0c\u540e\u7eed\u7684\u5185\u6838\u79fb\u690d\u6b65\u9aa4\u662f\u4e00\u81f4\u7684\u3002","title":"3. \u51c6\u5907\u82af\u7247\u5bf9\u5e94\u7684\u88f8\u673a\u5de5\u7a0b"},{"location":"10.Porting_Manual_for_KEIL/#31-stm32cubemx","text":"","title":"3.1 \u9996\u5148\u542f\u52a8STM32CubeMX\uff0c\u65b0\u5efa\u5de5\u7a0b"},{"location":"10.Porting_Manual_for_KEIL/#32-mcu","text":"\u5982\u4e0a\u56fe\u6240\u793a\uff1a\u901a\u8fc7MCU\u7b5b\u9009\u6765\u627e\u5230\u81ea\u5df1\u5f00\u53d1\u677f\u5bf9\u5e94\u7684\u82af\u7247\u578b\u53f7\uff0c\u53cc\u51fb\u540e\u5f39\u51fa\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\uff0c\u5982\u4e0b\u56fe\uff1a","title":"3.2 \u9009\u62e9MCU\u578b\u53f7"},{"location":"10.Porting_Manual_for_KEIL/#33-pin","text":"","title":"3.3 Pin\u8bbe\u7f6e\u754c\u9762\u914d\u7f6e\u65f6\u949f\u6e90"},{"location":"10.Porting_Manual_for_KEIL/#34-pin","text":"","title":"3.4 Pin\u8bbe\u7f6e\u754c\u9762\u914d\u7f6e\u4e32\u53e3"},{"location":"10.Porting_Manual_for_KEIL/#35-pingpio","text":"","title":"3.5 Pin\u8bbe\u7f6e\u754c\u9762\u914d\u7f6eGPIO"},{"location":"10.Porting_Manual_for_KEIL/#36","text":"","title":"3.6 \u914d\u7f6e\u603b\u7ebf\u65f6\u949f"},{"location":"10.Porting_Manual_for_KEIL/#37","text":"","title":"3.7 \u5de5\u7a0b\u751f\u6210\u53c2\u6570\u914d\u7f6e"},{"location":"10.Porting_Manual_for_KEIL/#38","text":"","title":"3.8 \u4ee3\u7801\u751f\u6210\u65b9\u5f0f\u914d\u7f6e"},{"location":"10.Porting_Manual_for_KEIL/#39","text":"","title":"3.9 \u751f\u6210\u5de5\u7a0b"},{"location":"10.Porting_Manual_for_KEIL/#310-keil","text":"\u70b9\u51fb\u751f\u6210\u4ee3\u7801\u540e\uff0c\u751f\u6210\u7684\u88f8\u673a\u5de5\u7a0b\u6548\u679c\u5982\u4e0b\uff1a \u8fd9\u6837NUCLEO-L073RZ\u88f8\u673a\u5de5\u7a0b\u751f\u6210\u5b8c\u6210\uff0c\u8be5\u5de5\u7a0b\u53ef\u76f4\u63a5\u7f16\u8bd1\u5e76\u70e7\u5199\u5728\u677f\u5b50\u4e0a\u8fd0\u884c\u3002","title":"3.10  keil\u4e0b\u7684\u88f8\u673a\u5de5\u7a0b"},{"location":"10.Porting_Manual_for_KEIL/#4-tencentos-tiny","text":"TencentOS tiny\u7684\u6e90\u7801\u5df2\u7ecf\u5f00\u6e90\uff0cgithub\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://github.com/Tencent/TencentOS-tiny.git \u4e00\u7ea7\u76ee\u5f55 \u4e8c\u7ea7\u76ee\u5f55 \u8bf4\u660e arch arm TencentOS tiny\u9002\u914d\u7684IP\u6838\u67b6\u6784\uff08\u542bM\u6838\u4e2d\u65ad\u3001\u8c03\u5ea6\u3001tick\u76f8\u5173\u4ee3\u7801\uff09 board NUCLEO_L073RZ \u79fb\u690d\u76ee\u6807\u82af\u7247\u7684\u5de5\u7a0b\u6587\u4ef6 kernel core TencentOS tiny\u5185\u6838\u6e90\u7801 pm TencentOS tiny\u4f4e\u529f\u8017\u6a21\u5757\u6e90\u7801 osal cmsis_os TencentOS tiny\u63d0\u4f9b\u7684cmsis os \u9002\u914d \u7531\u4e8e\u672c\u6559\u7a0b\u53ea\u4ecb\u7ecdTencentOS tiny\u7684\u5185\u6838\u79fb\u690d\uff0c\u6240\u4ee5\u8fd9\u91cc\u53ea\u9700\u8981\u7528\u5230 arch\u3001board\u3001kernel\u3001osal\u56db\u4e2a\u76ee\u5f55\u4e0b\u7684\u6e90\u7801\u3002","title":"4. \u51c6\u5907TencentOS tiny\u7684\u6e90\u7801"},{"location":"10.Porting_Manual_for_KEIL/#_2","text":"","title":"\u4e8c\u3001\u5185\u6838\u79fb\u690d"},{"location":"10.Porting_Manual_for_KEIL/#1_1","text":"\u5982\u56fe\u6240\u793a\uff0c\u65b0\u5efaTencentOS_tiny\u4e3b\u76ee\u5f55\uff0c\u5e76\u5728\u4e3b\u76ee\u5f55\u4e0b\u6dfb\u52a0\u56db\u4e2a\u5b50\u76ee\u5f55\uff0c\u5176\u4e2darch\u3001kernel\u3001osal\u4ece\u4ee3\u7801\u4ed3\u76f4\u63a5\u62f7\u8d1d\u8fc7\u6765\u5373\u53ef\uff0c\u800cboard\u76ee\u5f55\u4e0b\u5219\u653e\u5165\u6211\u4eec\u524d\u9762\u751f\u6210\u7684\u88f8\u673a\u5de5\u7a0b\u4ee3\u7801\uff0c\u6211\u4eec\u79fb\u690d\u7684\u5f00\u53d1\u677f\u53d6\u540d\u53ebNUCLEO_L073RZ,\u88f8\u673a\u4ee3\u7801\u5168\u90e8\u62f7\u8d1d\u5230\u4e0b\u9762\u5373\u53ef\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u63a5\u4e0b\u6765\u8fdb\u5165TencentOS_tiny\\board\\NUCLEO_L073RZ\\MDK-ARM\u76ee\u5f55\uff0c\u6253\u5f00keil\u5de5\u7a0b\uff0c\u6211\u4eec\u5f00\u59cb\u6dfb\u52a0TencentOS tiny\u7684\u5185\u6838\u4ee3\u7801\u3002","title":"1. \u4ee3\u7801\u76ee\u5f55\u89c4\u5212"},{"location":"10.Porting_Manual_for_KEIL/#2-arch","text":"tos_cpu.c\u662fTencentOS tiny \u7684CPU\u9002\u914d\u6587\u4ef6\uff0c\u5305\u62ec\u5806\u6808\u521d\u59cb\u5316\uff0c\u4e2d\u65ad\u9002\u914d\u7b49\uff0c\u5982\u679c\u60a8\u7684\u82af\u7247\u662fARM Cortex M\u6838\uff0c\u8be5\u6587\u4ef6\u53ef\u4ee5\u4e0d\u505a\u6539\u52a8\uff0cM0\u3001M3 \u3001M4\u3001M7\u662f\u901a\u7528\u7684\uff0c\u5176\u4ed6IP\u6838\u9700\u8981\u91cd\u65b0\u9002\u914d\uff1b port_s.S \u6587\u4ef6\u662fTencentOS tiny\u7684\u4efb\u52a1\u8c03\u5ea6\u6c47\u7f16\u4ee3\u7801\uff0c\u4e3b\u8981\u505a\u5f39\u6808\u538b\u6808\u7b49\u5904\u7406\u7684\uff0cport_c.c\u9002\u914dsystick\u7b49\uff0c\u8fd9\u4e24\u4e2a\u6587\u4ef6 \u6bcf\u4e2aIP\u6838\u548c\u7f16\u8bd1\u5668\u90fd\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u5982\u679c\u60a8\u7684\u82af\u7247\u662fARM Cortex M\u6838\uff0c\u6211\u4eec\u90fd\u5df2\u7ecf\u9002\u914d\u597d\uff0c\u6bd4\u5982\u73b0\u5728\u6211\u4eec\u79fb\u690d\u7684\u82af\u7247\u662fSTM32L073RZ\uff0c\u662fARM Cortex M0+\u6838\uff0c\u4f7f\u7528\u7684\u7f16\u8bd1\u5668\u662fKEIL\uff0c\u6240\u4ee5\u6211\u4eec\u9009\u62e9arch\\arm\\arm-v7m\\cortex-m0+\\armcc\u4e0b\u7684\u9002\u914d\u4ee3\u7801\uff0c\u5982\u679c\u4f60\u7684\u5f00\u53d1\u677f\u662fSTM32F429IG\uff0cM4\u6838\uff0c\u7f16\u8bd1\u5668\u662fGCC\uff0c\u5219\u53ef\u4ee5\u9009\u62e9arch\\arm\\arm-v7m\\cortex-m4\\gcc\u76ee\u5f55\u4e0b\u7684\u9002\u914d\u6587\u4ef6\u3002","title":"2. \u6dfb\u52a0arch\u5e73\u53f0\u4ee3\u7801"},{"location":"10.Porting_Manual_for_KEIL/#3_1","text":"\u5185\u6838\u6e90\u7801kerne\u76ee\u5f55\u4e0b\u5305\u542bcore\u548cpm\u4e24\u4e2a\u76ee\u5f55\uff0c\u5176\u4e2dcore\u4e0b\u4e3a\u57fa\u7840\u5185\u6838\uff0cpm\u662f\u5185\u6838\u4e2d\u7684\u4f4e\u529f\u8017\u7ec4\u4ef6\uff1b\u57fa\u7840\u79fb\u690d\u7684\u65f6\u5019\u53ef\u4ee5\u4e0d\u6dfb\u52a0pm\u76ee\u5f55\u4e0b\u7684\u4ee3\u7801\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u6dfb\u52a0\u5168\u90e8\u57fa\u672c\u5185\u6838\u6e90\u7801\uff1a","title":"3. \u6dfb\u52a0\u5185\u6838\u6e90\u7801"},{"location":"10.Porting_Manual_for_KEIL/#4-cmsis-os","text":"cmsis os\u662fTencentOS tiny\u4e3a\u4e86\u517c\u5bb9cmsis\u6807\u51c6\u800c\u9002\u914d\u7684OS\u62bd\u8c61\u5c42\uff0c\u53ef\u4ee5\u7b80\u5316\u5927\u5bb6\u5c06\u4e1a\u52a1\u4ece\u5176\u4ed6RTOS\u8fc1\u79fb\u5230TencentOS tiny\u7684\u5de5\u4f5c\u91cf\u3002","title":"4. \u6dfb\u52a0cmsis os\u6e90\u7801"},{"location":"10.Porting_Manual_for_KEIL/#5-tencentos-tiny","text":"\u6dfb\u52a0\u5934\u6587\u4ef6\u76ee\u5f55\u524d\uff0c\u6211\u4eec\u5728\u8981\u79fb\u690d\u7684\u5de5\u7a0b\u76ee\u5f55\u4e0b\u65b0\u589e\u4e00\u4e2a TOS_CONFIG\u6587\u4ef6\u5939\uff0c\u7528\u4e8e\u5b58\u653eTencentOS tiny\u7684\u914d\u7f6e\u5934\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f\u63a5\u4e0b\u6765\u8981\u65b0\u5efa\u7684tos_config.h\u6587\u4ef6\uff1b TencentOS tiny\u6240\u6709\u8981\u6dfb\u52a0\u7684\u5934\u6587\u4ef6\u76ee\u5f55\u5982\u4e0b\uff1a","title":"5. \u6dfb\u52a0TencentOS tiny\u5934\u6587\u4ef6\u76ee\u5f55"},{"location":"10.Porting_Manual_for_KEIL/#6-tencentos-tiny-tos_configh","text":"#ifndef _TOS_CONFIG_H_ #define _TOS_CONFIG_H_ #include \"stm32l0xx.h\" // \u76ee\u6807\u82af\u7247\u5934\u6587\u4ef6\uff0c\u7528\u6237\u9700\u8981\u6839\u636e\u60c5\u51b5\u66f4\u6539 #define TOS_CFG_TASK_PRIO_MAX 10u // \u914d\u7f6eTencentOS tiny\u9ed8\u8ba4\u652f\u6301\u7684\u6700\u5927\u4f18\u5148\u7ea7\u6570\u91cf #define TOS_CFG_ROUND_ROBIN_EN 0u // \u914d\u7f6eTencentOS tiny\u7684\u5185\u6838\u662f\u5426\u5f00\u542f\u65f6\u95f4\u7247\u8f6e\u8f6c #define TOS_CFG_OBJECT_VERIFY_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u6821\u9a8c\u6307\u9488\u5408\u6cd5 #define TOS_CFG_TASK_DYNAMIC_CREATE_EN 1u // TencentOS tiny \u52a8\u6001\u4efb\u52a1\u521b\u5efa\u529f\u80fd\u5b8f #define TOS_CFG_EVENT_EN 1u // TencentOS tiny \u4e8b\u4ef6\u6a21\u5757\u529f\u80fd\u5b8f #define TOS_CFG_MMBLK_EN 1u //\u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u5185\u5b58\u5757\u7ba1\u7406\u6a21\u5757 #define TOS_CFG_MMHEAP_EN 1u //\u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u52a8\u6001\u5185\u5b58\u6a21\u5757 #define TOS_CFG_MMHEAP_DEFAULT_POOL_EN 1u // TencentOS tiny \u9ed8\u8ba4\u52a8\u6001\u5185\u5b58\u6c60\u529f\u80fd\u5b8f #define TOS_CFG_MMHEAP_DEFAULT_POOL_SIZE 0x100 // \u914d\u7f6eTencentOS tiny\u9ed8\u8ba4\u52a8\u6001\u5185\u5b58\u6c60\u5927\u5c0f #define TOS_CFG_MUTEX_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4e92\u65a5\u9501\u6a21\u5757 #define TOS_CFG_MESSAGE_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u6d88\u606f\u961f\u5217\u6a21\u5757 #define TOS_CFG_MAIL_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u6d88\u606f\u90ae\u7bb1\u6a21\u5757 #define TOS_CFG_PRIORITY_MESSAGE_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u6a21\u5757 #define TOS_CFG_PRIORITY_MAIL_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4f18\u5148\u7ea7\u6d88\u606f\u90ae\u7bb1\u6a21\u5757 #define TOS_CFG_TIMER_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u8f6f\u4ef6\u5b9a\u65f6\u5668\u6a21\u5757 #define TOS_CFG_PWR_MGR_EN 0u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u5916\u8bbe\u7535\u6e90\u7ba1\u7406\u6a21\u5757 #define TOS_CFG_TICKLESS_EN 0u // \u914d\u7f6eTickless \u4f4e\u529f\u8017\u6a21\u5757\u5f00\u5173 #define TOS_CFG_SEM_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4fe1\u53f7\u91cf\u6a21\u5757 #define TOS_CFG_TASK_STACK_DRAUGHT_DEPTH_DETACT_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4efb\u52a1\u6808\u6df1\u5ea6\u68c0\u6d4b #define TOS_CFG_FAULT_BACKTRACE_EN 0u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u5f02\u5e38\u6808\u56de\u6eaf\u529f\u80fd #define TOS_CFG_IDLE_TASK_STK_SIZE 128u // \u914d\u7f6eTencentOS tiny\u7a7a\u95f2\u4efb\u52a1\u6808\u5927\u5c0f #define TOS_CFG_CPU_TICK_PER_SECOND 1000u // \u914d\u7f6eTencentOS tiny\u7684tick\u9891\u7387 #define TOS_CFG_CPU_CLOCK (SystemCoreClock) // \u914d\u7f6eTencentOS tiny CPU\u9891\u7387 #define TOS_CFG_TIMER_AS_PROC 1u // \u914d\u7f6e\u662f\u5426\u5c06TIMER\u914d\u7f6e\u6210\u51fd\u6570\u6a21\u5f0f #endif \u6309\u7167\u4e0a\u9762\u7684\u6a21\u677f\u914d\u7f6e\u597dTencentOS tiny\u7684\u5404\u9879\u529f\u80fd\u540e\uff0c\u5c06tos_config.h \u6587\u4ef6\u653e\u5165\u8981\u79fb\u690d\u7684board\u5de5\u7a0b\u76ee\u5f55\u4e0b\u5373\u53ef\uff0c\u4f8b\u5982\u672c\u6559\u7a0b\u662f\u653e\u5230board\\NUCLEO_L073RZ\\TOS_CONFIG\u76ee\u5f55\u4e0b\u3002 \u8fd9\u6837\uff0cTencentOS tiny\u7684\u6e90\u7801\u5c31\u5168\u90e8\u6dfb\u52a0\u5b8c\u6bd5\u4e86\u3002","title":"6. \u65b0\u5efaTencentOS tiny\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6 tos_config.h"},{"location":"10.Porting_Manual_for_KEIL/#tencentos-tiny","text":"","title":"\u4e09\u3001\u521b\u5efaTencentOS tiny\u4efb\u52a1\uff0c\u6d4b\u8bd5\u79fb\u690d\u7ed3\u679c"},{"location":"10.Porting_Manual_for_KEIL/#1_2","text":"","title":"1. \u4fee\u6539\u90e8\u5206\u4ee3\u7801"},{"location":"10.Porting_Manual_for_KEIL/#stm32l0xx_itcstm32l0xx_itc-tos_kh","text":"\u5728stm32l0xx_it.c\u6587\u4ef6\u4e2d\u7684PendSV_Handler\u51fd\u6570\u524d\u6dfb\u52a0___weak\u5173\u952e\u5b57\uff0c\u56e0\u4e3a\u8be5\u51fd\u6570\u5728TencentOS tiny\u7684\u8c03\u5ea6\u6c47\u7f16\u4e2d\u5df2\u7ecf\u91cd\u65b0\u5b9e\u73b0\uff1b\u540c\u65f6\u5728SysTick_Handler\u51fd\u6570\u4e2d\u6dfb\u52a0TencentOS tiny\u7684\u8c03\u5ea6\u5904\u7406\u51fd\u6570\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a","title":"\u4fee\u6539stm32l0xx_it.c\u7684\u4e2d\u65ad\u51fd\u6570,\u5728stm32l0xx_it.c\u6587\u4ef6\u4e2d\u5305\u542b tos_k.h \u5934\u6587\u4ef6"},{"location":"10.Porting_Manual_for_KEIL/#2-tencentos-tiny","text":"","title":"2.  \u7f16\u5199TencentOS tiny \u6d4b\u8bd5\u4efb\u52a1"},{"location":"10.Porting_Manual_for_KEIL/#mianc-tencentos-tiny","text":"#include \"cmsis_os.h\" //task1 #define TASK1_STK_SIZE 256 void task1(void *pdata); osThreadDef(task1, osPriorityNormal, 1, TASK1_STK_SIZE); //task2 #define TASK2_STK_SIZE 256 void task2(void *pdata); osThreadDef(task2, osPriorityNormal, 1, TASK2_STK_SIZE); void task1(void *pdata) { int count = 1; while(1) { printf(\"\\r\\nHello world!\\r\\n###This is task1 ,count is %d \\r\\n\", count++); HAL_GPIO_TogglePin(LED_GPIO_Port,LED_Pin); osDelay(2000); } } void task2(void *pdata) { int count = 1; while(1) { printf(\"\\r\\nHello TencentOS !\\r\\n***This is task2 ,count is %d \\r\\n\", count++); osDelay(1000); } } int fputc(int ch, FILE *f) { if (ch == '\\n') { HAL_UART_Transmit(&huart2, (void *)\"\\r\", 1,30000); } HAL_UART_Transmit(&huart2, (uint8_t *)&ch, 1, 0xFFFF); return ch; } \u5982\u56fe\uff1a \u7ee7\u7eed\u5728main.c \u7684mian\u51fd\u6570\u4e2d\u786c\u4ef6\u5916\u8bbe\u521d\u59cb\u5316\u4ee3\u7801\u540e\u6dfb\u52a0TencentOS tiny\u7684\u521d\u59cb\u5316\u4ee3\u7801\uff1a osKernelInitialize(); //TOS Tiny kernel initialize osThreadCreate(osThread(task1), NULL);// Create task1 osThreadCreate(osThread(task2), NULL);// Create task2 osKernelStart();//Start TOS Tiny \u5982\u56fe\uff1a","title":"\u5728mian.c \u4e2d\u6dfb\u52a0TencentOS tiny \u5934\u6587\u4ef6\uff0c\u7f16\u5199\u4efb\u52a1\u51fd\u6570"},{"location":"10.Porting_Manual_for_KEIL/#3-tencentos-tiny","text":"\u6309\u7167\u4e0a\u56fe\u6307\u793a\uff0c\u8fdb\u884c\u7f16\u8bd1\u4e0b\u8f7d\u5230\u5f00\u53d1\u677f\u5373\u53ef\u5b8c\u6210TencentOS tiny\u7684\u6d4b\u8bd5\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u53ef\u4ee5\u770b\u5230\u4e32\u53e3\u4ea4\u66ff\u6253\u5370\u4fe1\u606f\uff0c\u8868\u793a\u4e24\u4e2a\u4efb\u52a1\u6b63\u5728\u8fdb\u884c\u8c03\u5ea6\uff0c\u5207\u6362\u8fd0\u884c\uff1a","title":"3. \u7f16\u8bd1\u4e0b\u8f7d\u6d4b\u8bd5TencentOS tiny\u79fb\u690d\u7ed3\u679c"},{"location":"11.Porting_Manual_for_IAR/","text":"TencentOS tiny \u5185\u6838\u79fb\u690d\u53c2\u8003\u6307\u5357\uff08IAR\u7248\uff09 \u4e00\u3001\u79fb\u690d\u524d\u7684\u51c6\u5907 1. \u51c6\u5907\u76ee\u6807\u786c\u4ef6\uff08\u5f00\u53d1\u677f/\u82af\u7247/\u6a21\u7ec4\uff09 TencentOS tiny\u76ee\u524d\u4e3b\u8981\u652f\u6301ARM Cortex M\u6838\u82af\u7247\u7684\u79fb\u690d\uff0c\u6bd4\u5982STM32 \u57fa\u4e8eCortex M\u6838\u5168\u7cfb\u5217\u3001NXP \u57fa\u4e8eCortex M\u6838\u5168\u7cfb\u5217\u7b49\u3002\u672c\u6559\u7a0b\u5c06\u4f7f\u7528STM32\u5b98\u65b9Demo\u5f00\u53d1\u677f NUCLEO-L073RZ\u8fdb\u884c\u793a\u4f8b\u79fb\u690d\uff0c\u5176\u4ed6 ARM Cortex M\u7cfb\u5217\u5f00\u53d1\u677f\u548c\u82af\u7247\u79fb\u690d\u65b9\u6cd5\u7c7b\u4f3c\u3002 \u8c03\u8bd5ARM Cortex M\u6838\u8fd8\u9700\u8981\u4eff\u771f\u5668\uff0c NUCLEO-L073RZ\u81ea\u5e26ST-Link\u8c03\u8bd5\u5668\uff0c\u5982\u679c\u60a8\u7684\u5f00\u53d1\u677f\u6216\u8005\u82af\u7247\u6a21\u7ec4\u6ca1\u6709\u677f\u8f7d\u4eff\u771f\u5668\uff0c\u5c31\u9700\u8981\u8fde\u63a5\u5916\u7f6e\u7684\u4eff\u771f\u5668\uff0c\u5982J-Link\u3001U-Link\u4e4b\u7c7b\u7684\u3002 2. \u51c6\u5907\u7f16\u8bd1\u5668\u73af\u5883 \u672c\u79fb\u690d\u6307\u5357\u9488\u5bf9\u7684\u662fIAR\u7f16\u8bd1\u5668\uff0c\u6240\u4ee5\u6211\u4eec\u79fb\u690d\u5185\u6838\u524d\u9700\u8981\u5148\u5b89\u88c5IAR\u7f16\u8bd1\u5668\uff0cIAR\u6700\u65b0\u7248\u672c8.40,\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://www.iar.com/iar-embedded-workbench/#!?currentTab=free-trials \u4e0b\u8f7d\u5b8c\u6210\u5728windows\u73af\u5883\u4e0b\u6309\u7167\u63d0\u793a\u5b89\u88c5\u5373\u53ef\uff0c\u5b89\u88c5\u5b8c\u6210\u540e\u53ef\u4ee5\u514d\u8d39\u8bd5\u752830\u5929\uff0c30\u540e\u9700\u8981\u81ea\u884c\u8d2d\u4e70\u8f6f\u4ef6License\u3002 3.\u51c6\u5907\u82af\u7247\u5bf9\u5e94\u7684\u88f8\u673a\u5de5\u7a0b \u79fb\u690dTencentOS tiny\u57fa\u7840\u5185\u6838\u9700\u8981\u60a8\u63d0\u524d\u51c6\u5907\u4e00\u4e2a\u82af\u7247\u5bf9\u5e94\u7684\u88f8\u673a\u5de5\u7a0b\uff0c\u88f8\u673a\u5de5\u7a0b\u5305\u542b\u57fa\u672c\u7684\u82af\u7247\u542f\u52a8\u6587\u4ef6\u3001\u57fa\u7840\u914d\u7f6e\uff08\u65f6\u949f\u3001\u4e3b\u9891\u7b49\uff09\u3001\u4ee5\u53ca\u4e32\u53e3\u3001\u57fa\u672cGPIO\u9a71\u52a8\u7528\u4e8eRTOS\u6d4b\u8bd5\u3002 \u672c\u6559\u7a0b\u4f7f\u7528ST\u5b98\u65b9\u7684STM32CubeMX\u8f6f\u4ef6\u6765\u81ea\u52a8\u5316\u751f\u6210IAR\u88f8\u673a\u5de5\u7a0b\uff0cSTM32CubeMX\u7684\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://www.st.com/content/st_com/zh/products/development-tools/software-development-tools/stm32-software-development-tools/stm32-configurators-and-code-generators/stm32cubemx.html \u5b89\u88c5STM32CubeMx\u8fd8\u9700\u8981\u4e8b\u5148\u5b89\u88c5\u597dJDK\u73af\u5883\uff0c\u60a8\u53ef\u4ee5\u5728\u4e92\u8054\u7f51\u4e0a\u67e5\u627e\u5982\u4f55\u5b89\u88c5\u548c\u914d\u7f6eJDK\u73af\u5883\uff0c\u6b64\u5904\u4e0d\u518d\u8d58\u8ff0\u3002 CubeMX\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528CubeMX\u6765\u7ed9NUCLEO-L073RZ\u5f00\u53d1\u677f\u751f\u6210\u88f8\u673a\u5de5\u7a0b\u4e86\uff0c\u5982\u679c\u60a8\u7684\u82af\u7247\u4e0d\u662fSTM32\uff0c\u800c\u662f\u5176\u4ed6\u5382\u5546\u7684ARM Cortex M\u7cfb\u5217\uff0c\u60a8\u53ef\u4ee5\u6839\u636e\u4ea7\u5546\u7684\u6307\u5bfc\u51c6\u5907\u88f8\u673a\u5de5\u7a0b\uff0c\u540e\u7eed\u7684\u5185\u6838\u79fb\u690d\u6b65\u9aa4\u662f\u4e00\u81f4\u7684\u3002 3.1 \u9996\u5148\u542f\u52a8STM32CubeMX\uff0c\u65b0\u5efa\u5de5\u7a0b 3.2 \u9009\u62e9MCU\u578b\u53f7 \u5982\u4e0a\u56fe\u6240\u793a\uff1a\u901a\u8fc7MCU\u7b5b\u9009\u6765\u627e\u5230\u81ea\u5df1\u5f00\u53d1\u677f\u5bf9\u5e94\u7684\u82af\u7247\u578b\u53f7\uff0c\u53cc\u51fb\u540e\u5f39\u51fa\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\uff0c\u5982\u4e0b\u56fe\uff1a 3.3 Pin\u8bbe\u7f6e\u754c\u9762\u914d\u7f6e\u65f6\u949f\u6e90 3.4 Pin\u8bbe\u7f6e\u754c\u9762\u914d\u7f6e\u4e32\u53e3 3.5 Pin\u8bbe\u7f6e\u754c\u9762\u914d\u7f6eGPIO 3.6 \u914d\u7f6e\u603b\u7ebf\u65f6\u949f 3.7 \u5de5\u7a0b\u751f\u6210\u53c2\u6570\u914d\u7f6e 3.8 \u4ee3\u7801\u751f\u6210\u65b9\u5f0f\u914d\u7f6e 3.9 \u751f\u6210\u5de5\u7a0b 3.10 IAR\u4e0b\u7684\u88f8\u673a\u5de5\u7a0b \u70b9\u51fb\u751f\u6210\u4ee3\u7801\u540e\uff0c\u751f\u6210\u7684\u88f8\u673a\u5de5\u7a0b\u6548\u679c\u5982\u4e0b\uff1a \u8fd9\u6837NUCLEO-L073RZ\u88f8\u673a\u5de5\u7a0b\u751f\u6210\u5b8c\u6210\uff0c\u8be5\u5de5\u7a0b\u53ef\u76f4\u63a5\u7f16\u8bd1\u5e76\u70e7\u5199\u5728\u677f\u5b50\u4e0a\u8fd0\u884c\u3002 4. \u51c6\u5907TencentOS tiny\u7684\u6e90\u7801 TencentOS tiny\u7684\u6e90\u7801\u5df2\u7ecf\u5f00\u6e90\uff0cgithub\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://github.com/Tencent/TencentOS-tiny.git \u4e00\u7ea7\u76ee\u5f55 \u4e8c\u7ea7\u76ee\u5f55 \u8bf4\u660e arch arm TencentOS tiny\u9002\u914d\u7684IP\u6838\u67b6\u6784\uff08\u542bM\u6838\u4e2d\u65ad\u3001\u8c03\u5ea6\u3001tick\u76f8\u5173\u4ee3\u7801\uff09 board NUCLEO_L073RZ \u79fb\u690d\u76ee\u6807\u82af\u7247\u7684\u5de5\u7a0b\u6587\u4ef6 kernel core TencentOS tiny\u5185\u6838\u6e90\u7801 pm TencentOS tiny\u4f4e\u529f\u8017\u6a21\u5757\u6e90\u7801 osal cmsis_os TencentOS tiny\u63d0\u4f9b\u7684cmsis os \u9002\u914d \u7531\u4e8e\u672c\u6559\u7a0b\u53ea\u4ecb\u7ecdTencentOS tiny\u7684\u5185\u6838\u79fb\u690d\uff0c\u6240\u4ee5\u8fd9\u91cc\u53ea\u9700\u8981\u7528\u5230 arch\u3001board\u3001kernel\u3001osal\u56db\u4e2a\u76ee\u5f55\u4e0b\u7684\u6e90\u7801\u3002 \u4e8c\u3001\u5185\u6838\u79fb\u690d 1. \u4ee3\u7801\u76ee\u5f55\u89c4\u5212 \u5982\u56fe\u6240\u793a\uff0c\u65b0\u5efaTencentOS_tiny\u4e3b\u76ee\u5f55\uff0c\u5e76\u5728\u4e3b\u76ee\u5f55\u4e0b\u6dfb\u52a0\u56db\u4e2a\u5b50\u76ee\u5f55\uff0c\u5176\u4e2darch\u3001kernel\u3001osal\u4ece\u4ee3\u7801\u4ed3\u76f4\u63a5\u62f7\u8d1d\u8fc7\u6765\u5373\u53ef\uff0c\u800cboard\u76ee\u5f55\u4e0b\u5219\u653e\u5165\u6211\u4eec\u524d\u9762\u751f\u6210\u7684\u88f8\u673a\u5de5\u7a0b\u4ee3\u7801\uff0c\u6211\u4eec\u79fb\u690d\u7684\u5f00\u53d1\u677f\u53d6\u540d\u53ebNUCLEO_L073RZ,\u88f8\u673a\u4ee3\u7801\u5168\u90e8\u62f7\u8d1d\u5230\u4e0b\u9762\u5373\u53ef\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u63a5\u4e0b\u6765\u8fdb\u5165TencentOS_tiny\\board\\NUCLEO_L073RZ\\EWARM\u76ee\u5f55\uff0c\u6253\u5f00IAR\u5de5\u7a0b\uff0c\u6211\u4eec\u5f00\u59cb\u6dfb\u52a0TencentOS tiny\u7684\u5185\u6838\u4ee3\u7801\u3002 2. \u6dfb\u52a0arch\u5e73\u53f0\u4ee3\u7801 \u6211\u4eec\u5728IAR\u7684\u4ee3\u7801\u5bfc\u822a\u9875\u9762\u6dfb\u52a0 tos/arch\u5206\u7ec4\uff0c\u7528\u6765\u6dfb\u52a0TencentOS tiny\u7684arch\u6e90\u7801\u3002 tos_cpu.c\u662fTencentOS tiny \u7684CPU\u9002\u914d\u6587\u4ef6\uff0c\u5305\u62ec\u5806\u6808\u521d\u59cb\u5316\uff0c\u4e2d\u65ad\u9002\u914d\u7b49\uff0c\u5982\u679c\u60a8\u7684\u82af\u7247\u662fARM Cortex M\u6838\uff0c\u8be5\u6587\u4ef6\u53ef\u4ee5\u4e0d\u505a\u6539\u52a8\uff0cM0\u3001M3 \u3001M4\u3001M7\u662f\u901a\u7528\u7684\uff0c\u5176\u4ed6IP\u6838\u9700\u8981\u91cd\u65b0\u9002\u914d\uff1b port_s.S \u6587\u4ef6\u662fTencentOS tiny\u7684\u4efb\u52a1\u8c03\u5ea6\u6c47\u7f16\u4ee3\u7801\uff0c\u4e3b\u8981\u505a\u5f39\u6808\u538b\u6808\u7b49\u5904\u7406\u7684\uff0cport_c.c\u9002\u914dsystick\u7b49\uff0c\u8fd9\u4e24\u4e2a\u6587\u4ef6 \u6bcf\u4e2aIP\u6838\u548c\u7f16\u8bd1\u5668\u90fd\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u5982\u679c\u60a8\u7684\u82af\u7247\u662fARM Cortex M\u6838\uff0c\u6211\u4eec\u90fd\u5df2\u7ecf\u9002\u914d\u597d\uff0c\u6bd4\u5982\u73b0\u5728\u6211\u4eec\u79fb\u690d\u7684\u82af\u7247\u662fSTM32L073RZ\uff0c\u662fARM Cortex M0+\u6838\uff0c\u4f7f\u7528\u7684\u7f16\u8bd1\u5668\u662fIAR\uff0c\u6240\u4ee5\u6211\u4eec\u9009\u62e9arch\\arm\\arm-v7m\\cortex-m0+\\iccarm\u4e0b\u7684\u9002\u914d\u4ee3\u7801\uff0c\u5982\u679c\u4f60\u7684\u5f00\u53d1\u677f\u662fSTM32F429IG\uff0cM4\u6838\uff0c\u7f16\u8bd1\u5668\u662fGCC\uff0c\u5219\u53ef\u4ee5\u9009\u62e9arch\\arm\\arm-v7m\\cortex-m4\\gcc\u76ee\u5f55\u4e0b\u7684\u9002\u914d\u6587\u4ef6\u3002 3. \u6dfb\u52a0\u5185\u6838\u6e90\u7801 \u5185\u6838\u6e90\u7801kerne\u76ee\u5f55\u4e0b\u5305\u542bcore\u548cpm\u4e24\u4e2a\u76ee\u5f55\uff0c\u5176\u4e2dcore\u4e0b\u4e3a\u57fa\u7840\u5185\u6838\uff0cpm\u662f\u5185\u6838\u4e2d\u7684\u4f4e\u529f\u8017\u7ec4\u4ef6\uff1b\u57fa\u7840\u79fb\u690d\u7684\u65f6\u5019\u53ef\u4ee5\u4e0d\u6dfb\u52a0pm\u76ee\u5f55\u4e0b\u7684\u4ee3\u7801\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u6211\u4eec\u5728IAR\u4ee3\u7801\u5bfc\u822a\u9875\u6dfb\u52a0tos/kernel\u5206\u7ec4\uff0c\u7528\u6765\u6dfb\u52a0\u57fa\u7840\u5185\u6838\u6e90\u7801\uff1a 4. \u6dfb\u52a0cmsis os\u6e90\u7801 cmsis os\u662fTencentOS tiny\u4e3a\u4e86\u517c\u5bb9cmsis\u6807\u51c6\u800c\u9002\u914d\u7684OS\u62bd\u8c61\u5c42\uff0c\u53ef\u4ee5\u7b80\u5316\u5927\u5bb6\u5c06\u4e1a\u52a1\u4ece\u5176\u4ed6RTOS\u8fc1\u79fb\u5230TencentOS tiny\u7684\u5de5\u4f5c\u91cf,\u6211\u4eec\u5728IAR\u7684\u4ee3\u7801\u5bfc\u822a\u9875\u9762\u6dfb\u52a0 tos/cmsis-os\u5206\u7ec4\uff0c\u6765\u6dfb\u52a0cmsis-os\u7684\u6e90\u4ee3\u7801\u3002 5. \u6dfb\u52a0TencentOS tiny\u5934\u6587\u4ef6\u76ee\u5f55 \u6dfb\u52a0\u5934\u6587\u4ef6\u76ee\u5f55\u524d\uff0c\u6211\u4eec\u5728\u8981\u79fb\u690d\u7684\u5de5\u7a0b\u76ee\u5f55\u4e0b\u65b0\u589e\u4e00\u4e2a TOS_CONFIG\u6587\u4ef6\u5939\uff0c\u7528\u4e8e\u5b58\u653eTencentOS tiny\u7684\u914d\u7f6e\u5934\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f\u63a5\u4e0b\u6765\u8981\u65b0\u5efa\u7684tos_config.h\u6587\u4ef6\uff1b TencentOS tiny\u6240\u6709\u8981\u6dfb\u52a0\u7684\u5934\u6587\u4ef6\u76ee\u5f55\u5982\u4e0b\uff1a 6. \u65b0\u5efaTencentOS tiny\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6 tos_config.h #ifndef _TOS_CONFIG_H_ #define _TOS_CONFIG_H_ #include \"stm32l0xx.h\" // \u76ee\u6807\u82af\u7247\u5934\u6587\u4ef6\uff0c\u7528\u6237\u9700\u8981\u6839\u636e\u60c5\u51b5\u66f4\u6539 #define TOS_CFG_TASK_PRIO_MAX 10u // \u914d\u7f6eTencentOS tiny\u9ed8\u8ba4\u652f\u6301\u7684\u6700\u5927\u4f18\u5148\u7ea7\u6570\u91cf #define TOS_CFG_ROUND_ROBIN_EN 0u // \u914d\u7f6eTencentOS tiny\u7684\u5185\u6838\u662f\u5426\u5f00\u542f\u65f6\u95f4\u7247\u8f6e\u8f6c #define TOS_CFG_OBJECT_VERIFY_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u6821\u9a8c\u6307\u9488\u5408\u6cd5 #define TOS_CFG_TASK_DYNAMIC_CREATE_EN 1u // TencentOS tiny \u52a8\u6001\u4efb\u52a1\u521b\u5efa\u529f\u80fd\u5b8f #define TOS_CFG_EVENT_EN 1u // TencentOS tiny \u4e8b\u4ef6\u6a21\u5757\u529f\u80fd\u5b8f #define TOS_CFG_MMBLK_EN 1u //\u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u5185\u5b58\u5757\u7ba1\u7406\u6a21\u5757 #define TOS_CFG_MMHEAP_EN 1u //\u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u52a8\u6001\u5185\u5b58\u6a21\u5757 #define TOS_CFG_MMHEAP_DEFAULT_POOL_EN 1u // TencentOS tiny \u9ed8\u8ba4\u52a8\u6001\u5185\u5b58\u6c60\u529f\u80fd\u5b8f #define TOS_CFG_MMHEAP_DEFAULT_POOL_SIZE 0x100 // \u914d\u7f6eTencentOS tiny\u9ed8\u8ba4\u52a8\u6001\u5185\u5b58\u6c60\u5927\u5c0f #define TOS_CFG_MUTEX_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4e92\u65a5\u9501\u6a21\u5757 #define TOS_CFG_MESSAGE_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u6d88\u606f\u961f\u5217\u6a21\u5757 #define TOS_CFG_MAIL_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u6d88\u606f\u90ae\u7bb1\u6a21\u5757 #define TOS_CFG_PRIORITY_MESSAGE_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u6a21\u5757 #define TOS_CFG_PRIORITY_MAIL_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4f18\u5148\u7ea7\u6d88\u606f\u90ae\u7bb1\u6a21\u5757 #define TOS_CFG_TIMER_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u8f6f\u4ef6\u5b9a\u65f6\u5668\u6a21\u5757 #define TOS_CFG_PWR_MGR_EN 0u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u5916\u8bbe\u7535\u6e90\u7ba1\u7406\u6a21\u5757 #define TOS_CFG_TICKLESS_EN 0u // \u914d\u7f6eTickless \u4f4e\u529f\u8017\u6a21\u5757\u5f00\u5173 #define TOS_CFG_SEM_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4fe1\u53f7\u91cf\u6a21\u5757 #define TOS_CFG_TASK_STACK_DRAUGHT_DEPTH_DETACT_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4efb\u52a1\u6808\u6df1\u5ea6\u68c0\u6d4b #define TOS_CFG_FAULT_BACKTRACE_EN 0u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u5f02\u5e38\u6808\u56de\u6eaf\u529f\u80fd #define TOS_CFG_IDLE_TASK_STK_SIZE 128u // \u914d\u7f6eTencentOS tiny\u7a7a\u95f2\u4efb\u52a1\u6808\u5927\u5c0f #define TOS_CFG_CPU_TICK_PER_SECOND 1000u // \u914d\u7f6eTencentOS tiny\u7684tick\u9891\u7387 #define TOS_CFG_CPU_CLOCK (SystemCoreClock) // \u914d\u7f6eTencentOS tiny CPU\u9891\u7387 #define TOS_CFG_TIMER_AS_PROC 1u // \u914d\u7f6e\u662f\u5426\u5c06TIMER\u914d\u7f6e\u6210\u51fd\u6570\u6a21\u5f0f #endif \u6309\u7167\u4e0a\u9762\u7684\u6a21\u677f\u914d\u7f6e\u597dTencentOS tiny\u7684\u5404\u9879\u529f\u80fd\u540e\uff0c\u5c06tos_config.h \u6587\u4ef6\u653e\u5165\u8981\u79fb\u690d\u7684board\u5de5\u7a0b\u76ee\u5f55\u4e0b\u5373\u53ef\uff0c\u4f8b\u5982\u672c\u6559\u7a0b\u662f\u653e\u5230board\\NUCLEO_L073RZ\\TOS_CONFIG\u76ee\u5f55\u4e0b\u3002 \u8fd9\u6837\uff0cTencentOS tiny\u7684\u6e90\u7801\u5c31\u5168\u90e8\u6dfb\u52a0\u5b8c\u6bd5\u4e86\u3002 \u4e09\u3001\u521b\u5efaTencentOS tiny\u4efb\u52a1\uff0c\u6d4b\u8bd5\u79fb\u690d\u7ed3\u679c 1. \u4fee\u6539\u90e8\u5206\u4ee3\u7801 \u4fee\u6539stm32l0xx_it.c\u7684\u4e2d\u65ad\u51fd\u6570,\u5728stm32l0xx_it.c\u6587\u4ef6\u4e2d\u5305\u542b tos_k.h \u5934\u6587\u4ef6 \u5728stm32l0xx_it.c\u6587\u4ef6\u4e2d\u7684PendSV_Handler\u51fd\u6570\u524d\u6dfb\u52a0___weak\u5173\u952e\u5b57\uff0c\u56e0\u4e3a\u8be5\u51fd\u6570\u5728TencentOS tiny\u7684\u8c03\u5ea6\u6c47\u7f16\u4e2d\u5df2\u7ecf\u91cd\u65b0\u5b9e\u73b0\uff1b\u540c\u65f6\u5728SysTick_Handler\u51fd\u6570\u4e2d\u6dfb\u52a0TencentOS tiny\u7684\u8c03\u5ea6\u5904\u7406\u51fd\u6570\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a 2. \u7f16\u5199TencentOS tiny \u6d4b\u8bd5\u4efb\u52a1 \u5728mian.c \u4e2d\u6dfb\u52a0TencentOS tiny \u5934\u6587\u4ef6\uff0c\u7f16\u5199\u4efb\u52a1\u51fd\u6570 #include \"cmsis_os.h\" //task1 #define TASK1_STK_SIZE 256 void task1(void *pdata); osThreadDef(task1, osPriorityNormal, 1, TASK1_STK_SIZE); //task2 #define TASK2_STK_SIZE 256 void task2(void *pdata); osThreadDef(task2, osPriorityNormal, 1, TASK2_STK_SIZE); void task1(void *pdata) { int count = 1; while(1) { printf(\"\\r\\nHello world!\\r\\n###This is task1 ,count is %d \\r\\n\", count++); HAL_GPIO_TogglePin(LED_GPIO_Port,LED_Pin); osDelay(2000); } } void task2(void *pdata) { int count = 1; while(1) { printf(\"\\r\\nHello TencentOS !\\r\\n***This is task2 ,count is %d \\r\\n\", count++); osDelay(1000); } } int fputc(int ch, FILE *f) { if (ch == '\\n') { HAL_UART_Transmit(&huart2, (void *)\"\\r\", 1,30000); } HAL_UART_Transmit(&huart2, (uint8_t *)&ch, 1, 0xFFFF); return ch; } \u5982\u56fe\uff1a \u7ee7\u7eed\u5728main.c \u7684mian\u51fd\u6570\u4e2d\u786c\u4ef6\u5916\u8bbe\u521d\u59cb\u5316\u4ee3\u7801\u540e\u6dfb\u52a0TencentOS tiny\u7684\u521d\u59cb\u5316\u4ee3\u7801\uff1a osKernelInitialize(); //TOS Tiny kernel initialize osThreadCreate(osThread(task1), NULL);// Create task1 osThreadCreate(osThread(task2), NULL);// Create task2 osKernelStart();//Start TOS Tiny \u5982\u56fe\uff1a 3. \u7f16\u8bd1\u4e0b\u8f7d\u6d4b\u8bd5TencentOS tiny\u79fb\u690d\u7ed3\u679c \u6309\u7167\u4e0a\u56fe\u6307\u793a\uff0c\u8fdb\u884c\u7f16\u8bd1\u4e0b\u8f7d\u5230\u5f00\u53d1\u677f\u5373\u53ef\u5b8c\u6210TencentOS tiny\u7684\u6d4b\u8bd5\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u53ef\u4ee5\u770b\u5230\u4e32\u53e3\u4ea4\u66ff\u6253\u5370\u4fe1\u606f\uff0c\u8868\u793a\u4e24\u4e2a\u4efb\u52a1\u6b63\u5728\u8fdb\u884c\u8c03\u5ea6\uff0c\u5207\u6362\u8fd0\u884c\uff1a","title":"11.Porting_Manual_for_IAR"},{"location":"11.Porting_Manual_for_IAR/#tencentos-tiny-iar","text":"","title":"TencentOS tiny \u5185\u6838\u79fb\u690d\u53c2\u8003\u6307\u5357\uff08IAR\u7248\uff09"},{"location":"11.Porting_Manual_for_IAR/#_1","text":"","title":"\u4e00\u3001\u79fb\u690d\u524d\u7684\u51c6\u5907"},{"location":"11.Porting_Manual_for_IAR/#1","text":"TencentOS tiny\u76ee\u524d\u4e3b\u8981\u652f\u6301ARM Cortex M\u6838\u82af\u7247\u7684\u79fb\u690d\uff0c\u6bd4\u5982STM32 \u57fa\u4e8eCortex M\u6838\u5168\u7cfb\u5217\u3001NXP \u57fa\u4e8eCortex M\u6838\u5168\u7cfb\u5217\u7b49\u3002\u672c\u6559\u7a0b\u5c06\u4f7f\u7528STM32\u5b98\u65b9Demo\u5f00\u53d1\u677f NUCLEO-L073RZ\u8fdb\u884c\u793a\u4f8b\u79fb\u690d\uff0c\u5176\u4ed6 ARM Cortex M\u7cfb\u5217\u5f00\u53d1\u677f\u548c\u82af\u7247\u79fb\u690d\u65b9\u6cd5\u7c7b\u4f3c\u3002 \u8c03\u8bd5ARM Cortex M\u6838\u8fd8\u9700\u8981\u4eff\u771f\u5668\uff0c NUCLEO-L073RZ\u81ea\u5e26ST-Link\u8c03\u8bd5\u5668\uff0c\u5982\u679c\u60a8\u7684\u5f00\u53d1\u677f\u6216\u8005\u82af\u7247\u6a21\u7ec4\u6ca1\u6709\u677f\u8f7d\u4eff\u771f\u5668\uff0c\u5c31\u9700\u8981\u8fde\u63a5\u5916\u7f6e\u7684\u4eff\u771f\u5668\uff0c\u5982J-Link\u3001U-Link\u4e4b\u7c7b\u7684\u3002","title":"1. \u51c6\u5907\u76ee\u6807\u786c\u4ef6\uff08\u5f00\u53d1\u677f/\u82af\u7247/\u6a21\u7ec4\uff09"},{"location":"11.Porting_Manual_for_IAR/#2","text":"\u672c\u79fb\u690d\u6307\u5357\u9488\u5bf9\u7684\u662fIAR\u7f16\u8bd1\u5668\uff0c\u6240\u4ee5\u6211\u4eec\u79fb\u690d\u5185\u6838\u524d\u9700\u8981\u5148\u5b89\u88c5IAR\u7f16\u8bd1\u5668\uff0cIAR\u6700\u65b0\u7248\u672c8.40,\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://www.iar.com/iar-embedded-workbench/#!?currentTab=free-trials \u4e0b\u8f7d\u5b8c\u6210\u5728windows\u73af\u5883\u4e0b\u6309\u7167\u63d0\u793a\u5b89\u88c5\u5373\u53ef\uff0c\u5b89\u88c5\u5b8c\u6210\u540e\u53ef\u4ee5\u514d\u8d39\u8bd5\u752830\u5929\uff0c30\u540e\u9700\u8981\u81ea\u884c\u8d2d\u4e70\u8f6f\u4ef6License\u3002","title":"2. \u51c6\u5907\u7f16\u8bd1\u5668\u73af\u5883"},{"location":"11.Porting_Manual_for_IAR/#3","text":"\u79fb\u690dTencentOS tiny\u57fa\u7840\u5185\u6838\u9700\u8981\u60a8\u63d0\u524d\u51c6\u5907\u4e00\u4e2a\u82af\u7247\u5bf9\u5e94\u7684\u88f8\u673a\u5de5\u7a0b\uff0c\u88f8\u673a\u5de5\u7a0b\u5305\u542b\u57fa\u672c\u7684\u82af\u7247\u542f\u52a8\u6587\u4ef6\u3001\u57fa\u7840\u914d\u7f6e\uff08\u65f6\u949f\u3001\u4e3b\u9891\u7b49\uff09\u3001\u4ee5\u53ca\u4e32\u53e3\u3001\u57fa\u672cGPIO\u9a71\u52a8\u7528\u4e8eRTOS\u6d4b\u8bd5\u3002 \u672c\u6559\u7a0b\u4f7f\u7528ST\u5b98\u65b9\u7684STM32CubeMX\u8f6f\u4ef6\u6765\u81ea\u52a8\u5316\u751f\u6210IAR\u88f8\u673a\u5de5\u7a0b\uff0cSTM32CubeMX\u7684\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://www.st.com/content/st_com/zh/products/development-tools/software-development-tools/stm32-software-development-tools/stm32-configurators-and-code-generators/stm32cubemx.html \u5b89\u88c5STM32CubeMx\u8fd8\u9700\u8981\u4e8b\u5148\u5b89\u88c5\u597dJDK\u73af\u5883\uff0c\u60a8\u53ef\u4ee5\u5728\u4e92\u8054\u7f51\u4e0a\u67e5\u627e\u5982\u4f55\u5b89\u88c5\u548c\u914d\u7f6eJDK\u73af\u5883\uff0c\u6b64\u5904\u4e0d\u518d\u8d58\u8ff0\u3002 CubeMX\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528CubeMX\u6765\u7ed9NUCLEO-L073RZ\u5f00\u53d1\u677f\u751f\u6210\u88f8\u673a\u5de5\u7a0b\u4e86\uff0c\u5982\u679c\u60a8\u7684\u82af\u7247\u4e0d\u662fSTM32\uff0c\u800c\u662f\u5176\u4ed6\u5382\u5546\u7684ARM Cortex M\u7cfb\u5217\uff0c\u60a8\u53ef\u4ee5\u6839\u636e\u4ea7\u5546\u7684\u6307\u5bfc\u51c6\u5907\u88f8\u673a\u5de5\u7a0b\uff0c\u540e\u7eed\u7684\u5185\u6838\u79fb\u690d\u6b65\u9aa4\u662f\u4e00\u81f4\u7684\u3002","title":"3.\u51c6\u5907\u82af\u7247\u5bf9\u5e94\u7684\u88f8\u673a\u5de5\u7a0b"},{"location":"11.Porting_Manual_for_IAR/#31-stm32cubemx","text":"","title":"3.1 \u9996\u5148\u542f\u52a8STM32CubeMX\uff0c\u65b0\u5efa\u5de5\u7a0b"},{"location":"11.Porting_Manual_for_IAR/#32-mcu","text":"\u5982\u4e0a\u56fe\u6240\u793a\uff1a\u901a\u8fc7MCU\u7b5b\u9009\u6765\u627e\u5230\u81ea\u5df1\u5f00\u53d1\u677f\u5bf9\u5e94\u7684\u82af\u7247\u578b\u53f7\uff0c\u53cc\u51fb\u540e\u5f39\u51fa\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\uff0c\u5982\u4e0b\u56fe\uff1a","title":"3.2 \u9009\u62e9MCU\u578b\u53f7"},{"location":"11.Porting_Manual_for_IAR/#33-pin","text":"","title":"3.3 Pin\u8bbe\u7f6e\u754c\u9762\u914d\u7f6e\u65f6\u949f\u6e90"},{"location":"11.Porting_Manual_for_IAR/#34-pin","text":"","title":"3.4 Pin\u8bbe\u7f6e\u754c\u9762\u914d\u7f6e\u4e32\u53e3"},{"location":"11.Porting_Manual_for_IAR/#35-pingpio","text":"","title":"3.5 Pin\u8bbe\u7f6e\u754c\u9762\u914d\u7f6eGPIO"},{"location":"11.Porting_Manual_for_IAR/#36","text":"","title":"3.6 \u914d\u7f6e\u603b\u7ebf\u65f6\u949f"},{"location":"11.Porting_Manual_for_IAR/#37","text":"","title":"3.7 \u5de5\u7a0b\u751f\u6210\u53c2\u6570\u914d\u7f6e"},{"location":"11.Porting_Manual_for_IAR/#38","text":"","title":"3.8 \u4ee3\u7801\u751f\u6210\u65b9\u5f0f\u914d\u7f6e"},{"location":"11.Porting_Manual_for_IAR/#39","text":"","title":"3.9 \u751f\u6210\u5de5\u7a0b"},{"location":"11.Porting_Manual_for_IAR/#310-iar","text":"\u70b9\u51fb\u751f\u6210\u4ee3\u7801\u540e\uff0c\u751f\u6210\u7684\u88f8\u673a\u5de5\u7a0b\u6548\u679c\u5982\u4e0b\uff1a \u8fd9\u6837NUCLEO-L073RZ\u88f8\u673a\u5de5\u7a0b\u751f\u6210\u5b8c\u6210\uff0c\u8be5\u5de5\u7a0b\u53ef\u76f4\u63a5\u7f16\u8bd1\u5e76\u70e7\u5199\u5728\u677f\u5b50\u4e0a\u8fd0\u884c\u3002","title":"3.10  IAR\u4e0b\u7684\u88f8\u673a\u5de5\u7a0b"},{"location":"11.Porting_Manual_for_IAR/#4-tencentos-tiny","text":"TencentOS tiny\u7684\u6e90\u7801\u5df2\u7ecf\u5f00\u6e90\uff0cgithub\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://github.com/Tencent/TencentOS-tiny.git \u4e00\u7ea7\u76ee\u5f55 \u4e8c\u7ea7\u76ee\u5f55 \u8bf4\u660e arch arm TencentOS tiny\u9002\u914d\u7684IP\u6838\u67b6\u6784\uff08\u542bM\u6838\u4e2d\u65ad\u3001\u8c03\u5ea6\u3001tick\u76f8\u5173\u4ee3\u7801\uff09 board NUCLEO_L073RZ \u79fb\u690d\u76ee\u6807\u82af\u7247\u7684\u5de5\u7a0b\u6587\u4ef6 kernel core TencentOS tiny\u5185\u6838\u6e90\u7801 pm TencentOS tiny\u4f4e\u529f\u8017\u6a21\u5757\u6e90\u7801 osal cmsis_os TencentOS tiny\u63d0\u4f9b\u7684cmsis os \u9002\u914d \u7531\u4e8e\u672c\u6559\u7a0b\u53ea\u4ecb\u7ecdTencentOS tiny\u7684\u5185\u6838\u79fb\u690d\uff0c\u6240\u4ee5\u8fd9\u91cc\u53ea\u9700\u8981\u7528\u5230 arch\u3001board\u3001kernel\u3001osal\u56db\u4e2a\u76ee\u5f55\u4e0b\u7684\u6e90\u7801\u3002","title":"4. \u51c6\u5907TencentOS tiny\u7684\u6e90\u7801"},{"location":"11.Porting_Manual_for_IAR/#_2","text":"","title":"\u4e8c\u3001\u5185\u6838\u79fb\u690d"},{"location":"11.Porting_Manual_for_IAR/#1_1","text":"\u5982\u56fe\u6240\u793a\uff0c\u65b0\u5efaTencentOS_tiny\u4e3b\u76ee\u5f55\uff0c\u5e76\u5728\u4e3b\u76ee\u5f55\u4e0b\u6dfb\u52a0\u56db\u4e2a\u5b50\u76ee\u5f55\uff0c\u5176\u4e2darch\u3001kernel\u3001osal\u4ece\u4ee3\u7801\u4ed3\u76f4\u63a5\u62f7\u8d1d\u8fc7\u6765\u5373\u53ef\uff0c\u800cboard\u76ee\u5f55\u4e0b\u5219\u653e\u5165\u6211\u4eec\u524d\u9762\u751f\u6210\u7684\u88f8\u673a\u5de5\u7a0b\u4ee3\u7801\uff0c\u6211\u4eec\u79fb\u690d\u7684\u5f00\u53d1\u677f\u53d6\u540d\u53ebNUCLEO_L073RZ,\u88f8\u673a\u4ee3\u7801\u5168\u90e8\u62f7\u8d1d\u5230\u4e0b\u9762\u5373\u53ef\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u63a5\u4e0b\u6765\u8fdb\u5165TencentOS_tiny\\board\\NUCLEO_L073RZ\\EWARM\u76ee\u5f55\uff0c\u6253\u5f00IAR\u5de5\u7a0b\uff0c\u6211\u4eec\u5f00\u59cb\u6dfb\u52a0TencentOS tiny\u7684\u5185\u6838\u4ee3\u7801\u3002","title":"1. \u4ee3\u7801\u76ee\u5f55\u89c4\u5212"},{"location":"11.Porting_Manual_for_IAR/#2-arch","text":"\u6211\u4eec\u5728IAR\u7684\u4ee3\u7801\u5bfc\u822a\u9875\u9762\u6dfb\u52a0 tos/arch\u5206\u7ec4\uff0c\u7528\u6765\u6dfb\u52a0TencentOS tiny\u7684arch\u6e90\u7801\u3002 tos_cpu.c\u662fTencentOS tiny \u7684CPU\u9002\u914d\u6587\u4ef6\uff0c\u5305\u62ec\u5806\u6808\u521d\u59cb\u5316\uff0c\u4e2d\u65ad\u9002\u914d\u7b49\uff0c\u5982\u679c\u60a8\u7684\u82af\u7247\u662fARM Cortex M\u6838\uff0c\u8be5\u6587\u4ef6\u53ef\u4ee5\u4e0d\u505a\u6539\u52a8\uff0cM0\u3001M3 \u3001M4\u3001M7\u662f\u901a\u7528\u7684\uff0c\u5176\u4ed6IP\u6838\u9700\u8981\u91cd\u65b0\u9002\u914d\uff1b port_s.S \u6587\u4ef6\u662fTencentOS tiny\u7684\u4efb\u52a1\u8c03\u5ea6\u6c47\u7f16\u4ee3\u7801\uff0c\u4e3b\u8981\u505a\u5f39\u6808\u538b\u6808\u7b49\u5904\u7406\u7684\uff0cport_c.c\u9002\u914dsystick\u7b49\uff0c\u8fd9\u4e24\u4e2a\u6587\u4ef6 \u6bcf\u4e2aIP\u6838\u548c\u7f16\u8bd1\u5668\u90fd\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u5982\u679c\u60a8\u7684\u82af\u7247\u662fARM Cortex M\u6838\uff0c\u6211\u4eec\u90fd\u5df2\u7ecf\u9002\u914d\u597d\uff0c\u6bd4\u5982\u73b0\u5728\u6211\u4eec\u79fb\u690d\u7684\u82af\u7247\u662fSTM32L073RZ\uff0c\u662fARM Cortex M0+\u6838\uff0c\u4f7f\u7528\u7684\u7f16\u8bd1\u5668\u662fIAR\uff0c\u6240\u4ee5\u6211\u4eec\u9009\u62e9arch\\arm\\arm-v7m\\cortex-m0+\\iccarm\u4e0b\u7684\u9002\u914d\u4ee3\u7801\uff0c\u5982\u679c\u4f60\u7684\u5f00\u53d1\u677f\u662fSTM32F429IG\uff0cM4\u6838\uff0c\u7f16\u8bd1\u5668\u662fGCC\uff0c\u5219\u53ef\u4ee5\u9009\u62e9arch\\arm\\arm-v7m\\cortex-m4\\gcc\u76ee\u5f55\u4e0b\u7684\u9002\u914d\u6587\u4ef6\u3002","title":"2.  \u6dfb\u52a0arch\u5e73\u53f0\u4ee3\u7801"},{"location":"11.Porting_Manual_for_IAR/#3_1","text":"\u5185\u6838\u6e90\u7801kerne\u76ee\u5f55\u4e0b\u5305\u542bcore\u548cpm\u4e24\u4e2a\u76ee\u5f55\uff0c\u5176\u4e2dcore\u4e0b\u4e3a\u57fa\u7840\u5185\u6838\uff0cpm\u662f\u5185\u6838\u4e2d\u7684\u4f4e\u529f\u8017\u7ec4\u4ef6\uff1b\u57fa\u7840\u79fb\u690d\u7684\u65f6\u5019\u53ef\u4ee5\u4e0d\u6dfb\u52a0pm\u76ee\u5f55\u4e0b\u7684\u4ee3\u7801\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u6211\u4eec\u5728IAR\u4ee3\u7801\u5bfc\u822a\u9875\u6dfb\u52a0tos/kernel\u5206\u7ec4\uff0c\u7528\u6765\u6dfb\u52a0\u57fa\u7840\u5185\u6838\u6e90\u7801\uff1a","title":"3. \u6dfb\u52a0\u5185\u6838\u6e90\u7801"},{"location":"11.Porting_Manual_for_IAR/#4-cmsis-os","text":"cmsis os\u662fTencentOS tiny\u4e3a\u4e86\u517c\u5bb9cmsis\u6807\u51c6\u800c\u9002\u914d\u7684OS\u62bd\u8c61\u5c42\uff0c\u53ef\u4ee5\u7b80\u5316\u5927\u5bb6\u5c06\u4e1a\u52a1\u4ece\u5176\u4ed6RTOS\u8fc1\u79fb\u5230TencentOS tiny\u7684\u5de5\u4f5c\u91cf,\u6211\u4eec\u5728IAR\u7684\u4ee3\u7801\u5bfc\u822a\u9875\u9762\u6dfb\u52a0 tos/cmsis-os\u5206\u7ec4\uff0c\u6765\u6dfb\u52a0cmsis-os\u7684\u6e90\u4ee3\u7801\u3002","title":"4. \u6dfb\u52a0cmsis os\u6e90\u7801"},{"location":"11.Porting_Manual_for_IAR/#5-tencentos-tiny","text":"\u6dfb\u52a0\u5934\u6587\u4ef6\u76ee\u5f55\u524d\uff0c\u6211\u4eec\u5728\u8981\u79fb\u690d\u7684\u5de5\u7a0b\u76ee\u5f55\u4e0b\u65b0\u589e\u4e00\u4e2a TOS_CONFIG\u6587\u4ef6\u5939\uff0c\u7528\u4e8e\u5b58\u653eTencentOS tiny\u7684\u914d\u7f6e\u5934\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f\u63a5\u4e0b\u6765\u8981\u65b0\u5efa\u7684tos_config.h\u6587\u4ef6\uff1b TencentOS tiny\u6240\u6709\u8981\u6dfb\u52a0\u7684\u5934\u6587\u4ef6\u76ee\u5f55\u5982\u4e0b\uff1a","title":"5. \u6dfb\u52a0TencentOS tiny\u5934\u6587\u4ef6\u76ee\u5f55"},{"location":"11.Porting_Manual_for_IAR/#6-tencentos-tiny-tos_configh","text":"#ifndef _TOS_CONFIG_H_ #define _TOS_CONFIG_H_ #include \"stm32l0xx.h\" // \u76ee\u6807\u82af\u7247\u5934\u6587\u4ef6\uff0c\u7528\u6237\u9700\u8981\u6839\u636e\u60c5\u51b5\u66f4\u6539 #define TOS_CFG_TASK_PRIO_MAX 10u // \u914d\u7f6eTencentOS tiny\u9ed8\u8ba4\u652f\u6301\u7684\u6700\u5927\u4f18\u5148\u7ea7\u6570\u91cf #define TOS_CFG_ROUND_ROBIN_EN 0u // \u914d\u7f6eTencentOS tiny\u7684\u5185\u6838\u662f\u5426\u5f00\u542f\u65f6\u95f4\u7247\u8f6e\u8f6c #define TOS_CFG_OBJECT_VERIFY_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u6821\u9a8c\u6307\u9488\u5408\u6cd5 #define TOS_CFG_TASK_DYNAMIC_CREATE_EN 1u // TencentOS tiny \u52a8\u6001\u4efb\u52a1\u521b\u5efa\u529f\u80fd\u5b8f #define TOS_CFG_EVENT_EN 1u // TencentOS tiny \u4e8b\u4ef6\u6a21\u5757\u529f\u80fd\u5b8f #define TOS_CFG_MMBLK_EN 1u //\u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u5185\u5b58\u5757\u7ba1\u7406\u6a21\u5757 #define TOS_CFG_MMHEAP_EN 1u //\u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u52a8\u6001\u5185\u5b58\u6a21\u5757 #define TOS_CFG_MMHEAP_DEFAULT_POOL_EN 1u // TencentOS tiny \u9ed8\u8ba4\u52a8\u6001\u5185\u5b58\u6c60\u529f\u80fd\u5b8f #define TOS_CFG_MMHEAP_DEFAULT_POOL_SIZE 0x100 // \u914d\u7f6eTencentOS tiny\u9ed8\u8ba4\u52a8\u6001\u5185\u5b58\u6c60\u5927\u5c0f #define TOS_CFG_MUTEX_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4e92\u65a5\u9501\u6a21\u5757 #define TOS_CFG_MESSAGE_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u6d88\u606f\u961f\u5217\u6a21\u5757 #define TOS_CFG_MAIL_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u6d88\u606f\u90ae\u7bb1\u6a21\u5757 #define TOS_CFG_PRIORITY_MESSAGE_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u6a21\u5757 #define TOS_CFG_PRIORITY_MAIL_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4f18\u5148\u7ea7\u6d88\u606f\u90ae\u7bb1\u6a21\u5757 #define TOS_CFG_TIMER_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u8f6f\u4ef6\u5b9a\u65f6\u5668\u6a21\u5757 #define TOS_CFG_PWR_MGR_EN 0u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u5916\u8bbe\u7535\u6e90\u7ba1\u7406\u6a21\u5757 #define TOS_CFG_TICKLESS_EN 0u // \u914d\u7f6eTickless \u4f4e\u529f\u8017\u6a21\u5757\u5f00\u5173 #define TOS_CFG_SEM_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4fe1\u53f7\u91cf\u6a21\u5757 #define TOS_CFG_TASK_STACK_DRAUGHT_DEPTH_DETACT_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4efb\u52a1\u6808\u6df1\u5ea6\u68c0\u6d4b #define TOS_CFG_FAULT_BACKTRACE_EN 0u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u5f02\u5e38\u6808\u56de\u6eaf\u529f\u80fd #define TOS_CFG_IDLE_TASK_STK_SIZE 128u // \u914d\u7f6eTencentOS tiny\u7a7a\u95f2\u4efb\u52a1\u6808\u5927\u5c0f #define TOS_CFG_CPU_TICK_PER_SECOND 1000u // \u914d\u7f6eTencentOS tiny\u7684tick\u9891\u7387 #define TOS_CFG_CPU_CLOCK (SystemCoreClock) // \u914d\u7f6eTencentOS tiny CPU\u9891\u7387 #define TOS_CFG_TIMER_AS_PROC 1u // \u914d\u7f6e\u662f\u5426\u5c06TIMER\u914d\u7f6e\u6210\u51fd\u6570\u6a21\u5f0f #endif \u6309\u7167\u4e0a\u9762\u7684\u6a21\u677f\u914d\u7f6e\u597dTencentOS tiny\u7684\u5404\u9879\u529f\u80fd\u540e\uff0c\u5c06tos_config.h \u6587\u4ef6\u653e\u5165\u8981\u79fb\u690d\u7684board\u5de5\u7a0b\u76ee\u5f55\u4e0b\u5373\u53ef\uff0c\u4f8b\u5982\u672c\u6559\u7a0b\u662f\u653e\u5230board\\NUCLEO_L073RZ\\TOS_CONFIG\u76ee\u5f55\u4e0b\u3002 \u8fd9\u6837\uff0cTencentOS tiny\u7684\u6e90\u7801\u5c31\u5168\u90e8\u6dfb\u52a0\u5b8c\u6bd5\u4e86\u3002","title":"6. \u65b0\u5efaTencentOS tiny\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6 tos_config.h"},{"location":"11.Porting_Manual_for_IAR/#tencentos-tiny","text":"","title":"\u4e09\u3001\u521b\u5efaTencentOS tiny\u4efb\u52a1\uff0c\u6d4b\u8bd5\u79fb\u690d\u7ed3\u679c"},{"location":"11.Porting_Manual_for_IAR/#1_2","text":"","title":"1. \u4fee\u6539\u90e8\u5206\u4ee3\u7801"},{"location":"11.Porting_Manual_for_IAR/#stm32l0xx_itcstm32l0xx_itc-tos_kh","text":"\u5728stm32l0xx_it.c\u6587\u4ef6\u4e2d\u7684PendSV_Handler\u51fd\u6570\u524d\u6dfb\u52a0___weak\u5173\u952e\u5b57\uff0c\u56e0\u4e3a\u8be5\u51fd\u6570\u5728TencentOS tiny\u7684\u8c03\u5ea6\u6c47\u7f16\u4e2d\u5df2\u7ecf\u91cd\u65b0\u5b9e\u73b0\uff1b\u540c\u65f6\u5728SysTick_Handler\u51fd\u6570\u4e2d\u6dfb\u52a0TencentOS tiny\u7684\u8c03\u5ea6\u5904\u7406\u51fd\u6570\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a","title":"\u4fee\u6539stm32l0xx_it.c\u7684\u4e2d\u65ad\u51fd\u6570,\u5728stm32l0xx_it.c\u6587\u4ef6\u4e2d\u5305\u542b tos_k.h \u5934\u6587\u4ef6"},{"location":"11.Porting_Manual_for_IAR/#2-tencentos-tiny","text":"","title":"2.  \u7f16\u5199TencentOS tiny \u6d4b\u8bd5\u4efb\u52a1"},{"location":"11.Porting_Manual_for_IAR/#mianc-tencentos-tiny","text":"#include \"cmsis_os.h\" //task1 #define TASK1_STK_SIZE 256 void task1(void *pdata); osThreadDef(task1, osPriorityNormal, 1, TASK1_STK_SIZE); //task2 #define TASK2_STK_SIZE 256 void task2(void *pdata); osThreadDef(task2, osPriorityNormal, 1, TASK2_STK_SIZE); void task1(void *pdata) { int count = 1; while(1) { printf(\"\\r\\nHello world!\\r\\n###This is task1 ,count is %d \\r\\n\", count++); HAL_GPIO_TogglePin(LED_GPIO_Port,LED_Pin); osDelay(2000); } } void task2(void *pdata) { int count = 1; while(1) { printf(\"\\r\\nHello TencentOS !\\r\\n***This is task2 ,count is %d \\r\\n\", count++); osDelay(1000); } } int fputc(int ch, FILE *f) { if (ch == '\\n') { HAL_UART_Transmit(&huart2, (void *)\"\\r\", 1,30000); } HAL_UART_Transmit(&huart2, (uint8_t *)&ch, 1, 0xFFFF); return ch; } \u5982\u56fe\uff1a \u7ee7\u7eed\u5728main.c \u7684mian\u51fd\u6570\u4e2d\u786c\u4ef6\u5916\u8bbe\u521d\u59cb\u5316\u4ee3\u7801\u540e\u6dfb\u52a0TencentOS tiny\u7684\u521d\u59cb\u5316\u4ee3\u7801\uff1a osKernelInitialize(); //TOS Tiny kernel initialize osThreadCreate(osThread(task1), NULL);// Create task1 osThreadCreate(osThread(task2), NULL);// Create task2 osKernelStart();//Start TOS Tiny \u5982\u56fe\uff1a","title":"\u5728mian.c \u4e2d\u6dfb\u52a0TencentOS tiny \u5934\u6587\u4ef6\uff0c\u7f16\u5199\u4efb\u52a1\u51fd\u6570"},{"location":"11.Porting_Manual_for_IAR/#3-tencentos-tiny","text":"\u6309\u7167\u4e0a\u56fe\u6307\u793a\uff0c\u8fdb\u884c\u7f16\u8bd1\u4e0b\u8f7d\u5230\u5f00\u53d1\u677f\u5373\u53ef\u5b8c\u6210TencentOS tiny\u7684\u6d4b\u8bd5\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u53ef\u4ee5\u770b\u5230\u4e32\u53e3\u4ea4\u66ff\u6253\u5370\u4fe1\u606f\uff0c\u8868\u793a\u4e24\u4e2a\u4efb\u52a1\u6b63\u5728\u8fdb\u884c\u8c03\u5ea6\uff0c\u5207\u6362\u8fd0\u884c\uff1a","title":"3. \u7f16\u8bd1\u4e0b\u8f7d\u6d4b\u8bd5TencentOS tiny\u79fb\u690d\u7ed3\u679c"},{"location":"12.Porting_Manual_for_GCC/","text":"TencentOS tiny \u5185\u6838\u79fb\u690d\u53c2\u8003\u6307\u5357\uff08GCC\u7248\uff09 \u4e00\u3001\u79fb\u690d\u524d\u7684\u51c6\u5907 1. \u51c6\u5907\u76ee\u6807\u786c\u4ef6\uff08\u5f00\u53d1\u677f/\u82af\u7247/\u6a21\u7ec4\uff09 TencentOS tiny\u76ee\u524d\u4e3b\u8981\u652f\u6301ARM Cortex M\u6838\u82af\u7247\u7684\u79fb\u690d\uff0c\u6bd4\u5982STM32 \u57fa\u4e8eCortex M\u6838\u5168\u7cfb\u5217\u3001NXP \u57fa\u4e8eCortex M\u6838\u5168\u7cfb\u5217\u7b49\u3002\u672c\u6559\u7a0b\u5c06\u4f7f\u7528STM32\u5b98\u65b9Demo\u5f00\u53d1\u677f NUCLEO-L073RZ\u8fdb\u884c\u793a\u4f8b\u79fb\u690d\uff0c\u5176\u4ed6 ARM Cortex M\u7cfb\u5217\u5f00\u53d1\u677f\u548c\u82af\u7247\u79fb\u690d\u65b9\u6cd5\u7c7b\u4f3c\u3002 \u8c03\u8bd5ARM Cortex M\u6838\u8fd8\u9700\u8981\u4eff\u771f\u5668\uff0c NUCLEO-L073RZ\u81ea\u5e26ST-Link\u8c03\u8bd5\u5668\uff0c\u5982\u679c\u60a8\u7684\u5f00\u53d1\u677f\u6216\u8005\u82af\u7247\u6a21\u7ec4\u6ca1\u6709\u677f\u8f7d\u4eff\u771f\u5668\uff0c\u5c31\u9700\u8981\u8fde\u63a5\u5916\u7f6e\u7684\u4eff\u771f\u5668\uff0c\u5982J-Link\u3001U-Link\u4e4b\u7c7b\u7684\u3002 2.\u51c6\u5907\u7f16\u8bd1\u5668\u73af\u5883 \u672c\u79fb\u690d\u6307\u5357\u9488\u5bf9\u7684\u662fGCC\u7f16\u8bd1\u5668\uff0c\u6240\u4ee5\u6211\u4eec\u79fb\u690d\u5185\u6838\u524d\u9700\u8981\u5148\u5b89\u88c5GCC\u7f16\u8bd1\u5668\uff0c\u80fd\u7f16\u8bd1ARM Cortex M\u6838\u7684GCC\u7f16\u8bd1\u5668\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://developer.arm.com/tools-and-software/open-source-software/developer-tools/gnu-toolchain/gnu-rm/downloads \u5982\u4e0a\u56fe\u6240\u793a\uff0c\u4e0b\u8f7dwindows exe\u7248\u672c\u7684gcc\u7f16\u8bd1\u5668\uff08Linux\u4e0b\u4e5f\u53ef\u4ee5\u4e0b\u8f7dlinux\u7248\u672c\u7684\u7f16\u8bd1\u5668\uff09\uff0c\u4e0b\u8f7d\u5b8c\u6210\u5728windows\u73af\u5883\u4e0b\u6309\u7167\u63d0\u793a\u5b89\u88c5\uff0c\u5982\u4e0b\u56fe\uff0c \u6ce8\u610f\uff1a\u5b89\u88c5\u5b8c\u6bd5\u540e\u9700\u8981\u5c06\u201cAdd path to environment variable\u201d\u52fe\u9009\u4e0a\u3002 \u7531\u4e8ewindows\u73af\u5883\u4e0b\u6ca1\u6709make\u73af\u5883\uff0c\u6240\u4ee5\u6211\u4eec\u8fd8\u9700\u8981\u5b89\u88c5\u4e00\u4e2amake\u5de5\u5177\uff0cMake \u5de5\u5177\u7528\u4e8e build \u5de5\u7a0b\uff0c \u4f7f\u7528 Makefile \u7f16\u8bd1\u5de5\u7a0b\u3002 \u7248\u672c\uff1agnu-mcu-eclipse-build-tools-2.9-20170629-1013-win64-setup.exe \u4e0b\u8f7d\u5730\u5740: https://github.com/gnu-mcu-eclipse/windows-build-tools/releases/tag/v2.9-20170629-1013 \u76f4\u63a5\u53cc\u51fb\u5b89\u88c5\uff0c\u5b8c\u6210\u540e\u5c06\u5b89\u88c5\u540e\u7684make\u547d\u4ee4\u76ee\u5f55\u6dfb\u52a0\u5230windows\u7684path\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u9ed8\u8ba4\u5b89\u88c5\u76ee\u5f55\u4e3a\uff1a C:\\Program Files\\GNU MCU Eclipse\\Build Tools\\2.9-20170629-1013\\bin\\bin\uff0c\u5728\u73af\u5883\u53d8\u91cf\u4e2d\u6dfb\u52a0\u5b89\u88c5\u76ee\u5f55\u5373\u53ef\u3002 3. \u51c6\u5907\u82af\u7247\u5bf9\u5e94\u7684\u88f8\u673a\u5de5\u7a0b \u79fb\u690dTencentOS tiny\u57fa\u7840\u5185\u6838\u9700\u8981\u60a8\u63d0\u524d\u51c6\u5907\u4e00\u4e2a\u82af\u7247\u5bf9\u5e94\u7684\u88f8\u673a\u5de5\u7a0b\uff0c\u88f8\u673a\u5de5\u7a0b\u5305\u542b\u57fa\u672c\u7684\u82af\u7247\u542f\u52a8\u6587\u4ef6\u3001\u57fa\u7840\u914d\u7f6e\uff08\u65f6\u949f\u3001\u4e3b\u9891\u7b49\uff09\u3001\u4ee5\u53ca\u4e32\u53e3\u3001\u57fa\u672cGPIO\u9a71\u52a8\u7528\u4e8eRTOS\u6d4b\u8bd5\u3002 \u672c\u6559\u7a0b\u4f7f\u7528ST\u5b98\u65b9\u7684STM32CubeMX\u8f6f\u4ef6\u6765\u81ea\u52a8\u5316\u751f\u6210GCC\u88f8\u673a\u5de5\u7a0b\uff0cSTM32CubeMX\u7684\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://www.st.com/content/st_com/zh/products/development-tools/software-development-tools/stm32-software-development-tools/stm32-configurators-and-code-generators/stm32cubemx.html \u5b89\u88c5STM32CubeMx\u8fd8\u9700\u8981\u4e8b\u5148\u5b89\u88c5\u597dJDK\u73af\u5883\uff0c\u60a8\u53ef\u4ee5\u5728\u4e92\u8054\u7f51\u4e0a\u67e5\u627e\u5982\u4f55\u5b89\u88c5\u548c\u914d\u7f6eJDK\u73af\u5883\uff0c\u6b64\u5904\u4e0d\u518d\u8d58\u8ff0\u3002 CubeMX\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528CubeMX\u6765\u7ed9NUCLEO-L073RZ\u5f00\u53d1\u677f\u751f\u6210\u88f8\u673a\u5de5\u7a0b\u4e86\uff0c\u5982\u679c\u60a8\u7684\u82af\u7247\u4e0d\u662fSTM32\uff0c\u800c\u662f\u5176\u4ed6\u5382\u5546\u7684ARM Cortex M\u7cfb\u5217\uff0c\u60a8\u53ef\u4ee5\u6839\u636e\u4ea7\u5546\u7684\u6307\u5bfc\u51c6\u5907\u88f8\u673a\u5de5\u7a0b\uff0c\u540e\u7eed\u7684\u5185\u6838\u79fb\u690d\u6b65\u9aa4\u662f\u4e00\u81f4\u7684\u3002 3.1 \u9996\u5148\u542f\u52a8STM32CubeMX\uff0c\u65b0\u5efa\u5de5\u7a0b 3.2 \u9009\u62e9MCU\u578b\u53f7 \u5982\u4e0a\u56fe\u6240\u793a\uff1a\u901a\u8fc7MCU\u7b5b\u9009\u6765\u627e\u5230\u81ea\u5df1\u5f00\u53d1\u677f\u5bf9\u5e94\u7684\u82af\u7247\u578b\u53f7\uff0c\u53cc\u51fb\u540e\u5f39\u51fa\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\uff0c\u5982\u4e0b\u56fe\uff1a 3.3 Pin\u8bbe\u7f6e\u754c\u9762\u914d\u7f6e\u65f6\u949f\u6e90 3.4 Pin\u8bbe\u7f6e\u754c\u9762\u914d\u7f6e\u4e32\u53e3 3.5 Pin\u8bbe\u7f6e\u754c\u9762\u914d\u7f6eGPIO 3.6 \u914d\u7f6e\u603b\u7ebf\u65f6\u949f 3.7 \u5de5\u7a0b\u751f\u6210\u53c2\u6570\u914d\u7f6e 3.9 \u751f\u6210\u5de5\u7a0b 3.10 \u7f16\u8bd1GCC\u4e0b\u7684\u88f8\u673a\u5de5\u7a0b \u70b9\u51fb\u751f\u6210\u4ee3\u7801\u540e\uff0c\u751f\u6210\u7684\u88f8\u673a\u5de5\u7a0b\u6548\u679c\u5982\u4e0b\uff0c\u5728makefile\u540c\u7ea7\u76ee\u5f55\u4e0b\u6253\u5f00windows\u7684cmd\u547d\u4ee4\u7a97\u53e3\uff08\u76ee\u5f55\u4e0b\u6309shift+\u9f20\u6807\u53f3\u952e\uff0c\u70b9\u51fb\u5728\u6b64\u5904\u6253\u5f00\u547d\u4ee4\u7a97\u53e3\uff09\uff0c\u8f93\u5165make\u547d\u4ee4\uff0c\u5c31\u53ef\u4ee5\u7f16\u8bd1gcc\u88f8\u673a\u5de5\u7a0b\u4e86\uff0c\u7f16\u8bd1\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5\u770b\u5230\u751f\u6210\u4e86elf\u548cbin\u6587\u4ef6\uff0c\u901a\u8fc7\u5de5\u5177\u5c31\u53ef\u4ee5\u4e0b\u8f7dbin\u6587\u4ef6\u5230\u5f00\u53d1\u677f\u8fd0\u884c\u4e86\u3002 4. \u51c6\u5907TencentOS tiny\u7684\u6e90\u7801 TencentOS tiny\u7684\u6e90\u7801\u5df2\u7ecf\u5f00\u6e90\uff0cgithub\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://github.com/Tencent/TencentOS-tiny.git \u4e00\u7ea7\u76ee\u5f55 \u4e8c\u7ea7\u76ee\u5f55 \u8bf4\u660e arch arm TencentOS tiny\u9002\u914d\u7684IP\u6838\u67b6\u6784\uff08\u542bM\u6838\u4e2d\u65ad\u3001\u8c03\u5ea6\u3001tick\u76f8\u5173\u4ee3\u7801\uff09 board NUCLEO_L073RZ \u79fb\u690d\u76ee\u6807\u82af\u7247\u7684\u5de5\u7a0b\u6587\u4ef6 kernel core TencentOS tiny\u5185\u6838\u6e90\u7801 pm TencentOS tiny\u4f4e\u529f\u8017\u6a21\u5757\u6e90\u7801 osal cmsis_os TencentOS tiny\u63d0\u4f9b\u7684cmsis os \u9002\u914d \u7531\u4e8e\u672c\u6559\u7a0b\u53ea\u4ecb\u7ecdTencentOS tiny\u7684\u5185\u6838\u79fb\u690d\uff0c\u6240\u4ee5\u8fd9\u91cc\u53ea\u9700\u8981\u7528\u5230 arch\u3001board\u3001kernel\u3001osal\u56db\u4e2a\u76ee\u5f55\u4e0b\u7684\u6e90\u7801\u3002 \u4e8c\u3001\u5185\u6838\u79fb\u690d 1. \u4ee3\u7801\u76ee\u5f55\u89c4\u5212 \u5982\u56fe\u6240\u793a\uff0c\u65b0\u5efaTencentOS_tiny\u4e3b\u76ee\u5f55\uff0c\u5e76\u5728\u4e3b\u76ee\u5f55\u4e0b\u6dfb\u52a0\u56db\u4e2a\u5b50\u76ee\u5f55\uff0c\u5176\u4e2darch\u3001kernel\u3001osal\u4ece\u4ee3\u7801\u4ed3\u76f4\u63a5\u62f7\u8d1d\u8fc7\u6765\u5373\u53ef\uff0c\u800cboard\u76ee\u5f55\u4e0b\u5219\u653e\u5165\u6211\u4eec\u524d\u9762\u751f\u6210\u7684\u88f8\u673a\u5de5\u7a0b\u4ee3\u7801\uff0c\u6211\u4eec\u79fb\u690d\u7684\u5f00\u53d1\u677f\u53d6\u540d\u53ebNUCLEO_L073RZ,\u88f8\u673a\u4ee3\u7801\u5168\u90e8\u62f7\u8d1d\u5230\u4e0b\u9762\u5373\u53ef\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u63a5\u4e0b\u6765\u8fdb\u5165TencentOS_tiny\\board\\NUCLEO_L073RZ\u76ee\u5f55\uff0c\u6253\u5f00Makefile\uff0c\u6211\u4eec\u5f00\u59cb\u6dfb\u52a0TencentOS tiny\u7684\u5185\u6838\u4ee3\u7801\u3002 2. \u6dfb\u52a0arch\u5e73\u53f0\u4ee3\u7801 \u6dfb\u52a0\u4ee3\u7801\u524d\u5148\u5728makefile\u6587\u4ef6\u4e0b\u5b9a\u4e49\u4e00\u4e2aTOP_DIR\u8def\u5f84\uff0c\u4f5c\u4e3aTencentOS tiny\u7684\u9876\u7ea7\u76ee\u5f55\uff0c\u5f53\u524dmakefile\u6587\u4ef6\u5728\u4e8c\u7ea7\u5b50\u76ee\u5f55\u4e0b\u9762\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u76f8\u5bf9\u9876\u7ea7\u76ee\u5f55\u4e3aTOP_DIR = ../../\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u7136\u540e\u5728makefile\u4e2d C_SOURCES\u540e\u9762\u6dfb\u52a0 arch C\u4ee3\u7801\uff0c\u5728ASM_SOURCES\u540e\u9762\u6dfb\u52a0\u4e00\u4e2aASM_SOURCES_S \u5206\u7ec4\uff0c\u52a0\u5165\u8c03\u5ea6\u6c47\u7f16\u4ee3\u7801.S. tos_cpu.c\u662fTencentOS tiny \u7684CPU\u9002\u914d\u6587\u4ef6\uff0c\u5305\u62ec\u5806\u6808\u521d\u59cb\u5316\uff0c\u4e2d\u65ad\u9002\u914d\u7b49\uff0c\u5982\u679c\u60a8\u7684\u82af\u7247\u662fARM Cortex M\u6838\uff0c\u8be5\u6587\u4ef6\u53ef\u4ee5\u4e0d\u505a\u6539\u52a8\uff0cM0\u3001M3 \u3001M4\u3001M7\u662f\u901a\u7528\u7684\uff0c\u5176\u4ed6IP\u6838\u9700\u8981\u91cd\u65b0\u9002\u914d\uff1b port_s.S \u6587\u4ef6\u662fTencentOS tiny\u7684\u4efb\u52a1\u8c03\u5ea6\u6c47\u7f16\u4ee3\u7801\uff0c\u4e3b\u8981\u505a\u5f39\u6808\u538b\u6808\u7b49\u5904\u7406\u7684\uff0cport_c.c\u9002\u914dsystick\u7b49\uff0c\u8fd9\u4e24\u4e2a\u6587\u4ef6 \u6bcf\u4e2aIP\u6838\u548c\u7f16\u8bd1\u5668\u90fd\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u5982\u679c\u60a8\u7684\u82af\u7247\u662fARM Cortex M\u6838\uff0c\u6211\u4eec\u90fd\u5df2\u7ecf\u9002\u914d\u597d\uff0c\u6bd4\u5982\u73b0\u5728\u6211\u4eec\u79fb\u690d\u7684\u82af\u7247\u662fSTM32L073RZ\uff0c\u662fARM Cortex M0+\u6838\uff0c\u4f7f\u7528\u7684\u7f16\u8bd1\u5668\u662fGCC\uff0c\u6240\u4ee5\u6211\u4eec\u9009\u62e9arch\\arm\\arm-v7m\\cortex-m0+\\gcc\u4e0b\u7684\u9002\u914d\u4ee3\u7801\uff0c\u5982\u679c\u4f60\u7684\u5f00\u53d1\u677f\u662fSTM32F429IG\uff0cM4\u6838\uff0c\u7f16\u8bd1\u5668\u662fkeil\uff0c\u5219\u53ef\u4ee5\u9009\u62e9arch\\arm\\arm-v7m\\cortex-m4\\armcc\u76ee\u5f55\u4e0b\u7684\u9002\u914d\u6587\u4ef6\u3002 3. \u6dfb\u52a0\u5185\u6838\u6e90\u7801 \u5185\u6838\u6e90\u7801kerne\u76ee\u5f55\u4e0b\u5305\u542bcore\u548cpm\u4e24\u4e2a\u76ee\u5f55\uff0c\u5176\u4e2dcore\u4e0b\u4e3a\u57fa\u7840\u5185\u6838\uff0cpm\u662f\u5185\u6838\u4e2d\u7684\u4f4e\u529f\u8017\u7ec4\u4ef6\uff1b\u57fa\u7840\u79fb\u690d\u7684\u65f6\u5019\u53ef\u4ee5\u4e0d\u6dfb\u52a0pm\u76ee\u5f55\u4e0b\u7684\u4ee3\u7801\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u6dfb\u52a0\u57fa\u672c\u5185\u6838\u6e90\u7801\uff1a 4. \u6dfb\u52a0cmsis os\u6e90\u7801 cmsis os\u662fTencentOS tiny\u4e3a\u4e86\u517c\u5bb9cmsis\u6807\u51c6\u800c\u9002\u914d\u7684OS\u62bd\u8c61\u5c42\uff0c\u53ef\u4ee5\u7b80\u5316\u5927\u5bb6\u5c06\u4e1a\u52a1\u4ece\u5176\u4ed6RTOS\u8fc1\u79fb\u5230TencentOS tiny\u7684\u5de5\u4f5c\u91cf\u3002 5. \u6dfb\u52a0TencentOS tiny\u5934\u6587\u4ef6\u76ee\u5f55 \u6dfb\u52a0\u5934\u6587\u4ef6\u76ee\u5f55\u524d\uff0c\u6211\u4eec\u5728\u8981\u79fb\u690d\u7684\u5de5\u7a0b\u76ee\u5f55\u4e0b\u65b0\u589e\u4e00\u4e2a TOS_CONFIG\u6587\u4ef6\u5939\uff0c\u7528\u4e8e\u5b58\u653eTencentOS tiny\u7684\u914d\u7f6e\u5934\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f\u63a5\u4e0b\u6765\u8981\u65b0\u5efa\u7684tos_config.h\u6587\u4ef6\uff1b TencentOS tiny\u6240\u6709\u8981\u6dfb\u52a0\u7684\u5934\u6587\u4ef6\u76ee\u5f55\u5982\u4e0b\uff1a 6. \u4fee\u6539makefile\u7f16\u8bd1\u89c4\u5219 \u7531\u4e8e\u6211\u4eecTencentOS tiny\u7684\u8c03\u5ea6\u6c47\u7f16port_s.S\u6587\u4ef6\u7528\u7684\u540e\u7f00\u662f.S \u800c\u4e0d\u662f.s,\u6240\u4ee5\u6211\u4eec\u8981\u5728makefile\u4e2d\u6dfb\u52a0\u7f16\u8bd1.S\u7684\u89c4\u5219\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a 7. \u65b0\u5efaTencentOS tiny\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6 tos_config.h #ifndef _TOS_CONFIG_H_ #define _TOS_CONFIG_H_ #include \"stm32l0xx.h\" // \u76ee\u6807\u82af\u7247\u5934\u6587\u4ef6\uff0c\u7528\u6237\u9700\u8981\u6839\u636e\u60c5\u51b5\u66f4\u6539 #define TOS_CFG_TASK_PRIO_MAX 10u // \u914d\u7f6eTencentOS tiny\u9ed8\u8ba4\u652f\u6301\u7684\u6700\u5927\u4f18\u5148\u7ea7\u6570\u91cf #define TOS_CFG_ROUND_ROBIN_EN 0u // \u914d\u7f6eTencentOS tiny\u7684\u5185\u6838\u662f\u5426\u5f00\u542f\u65f6\u95f4\u7247\u8f6e\u8f6c #define TOS_CFG_OBJECT_VERIFY_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u6821\u9a8c\u6307\u9488\u5408\u6cd5 #define TOS_CFG_TASK_DYNAMIC_CREATE_EN 1u // TencentOS tiny \u52a8\u6001\u4efb\u52a1\u521b\u5efa\u529f\u80fd\u5b8f #define TOS_CFG_EVENT_EN 1u // TencentOS tiny \u4e8b\u4ef6\u6a21\u5757\u529f\u80fd\u5b8f #define TOS_CFG_MMBLK_EN 1u //\u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u5185\u5b58\u5757\u7ba1\u7406\u6a21\u5757 #define TOS_CFG_MMHEAP_EN 1u //\u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u52a8\u6001\u5185\u5b58\u6a21\u5757 #define TOS_CFG_MMHEAP_DEFAULT_POOL_EN 1u // TencentOS tiny \u9ed8\u8ba4\u52a8\u6001\u5185\u5b58\u6c60\u529f\u80fd\u5b8f #define TOS_CFG_MMHEAP_DEFAULT_POOL_SIZE 0x100 // \u914d\u7f6eTencentOS tiny\u9ed8\u8ba4\u52a8\u6001\u5185\u5b58\u6c60\u5927\u5c0f #define TOS_CFG_MUTEX_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4e92\u65a5\u9501\u6a21\u5757 #define TOS_CFG_MESSAGE_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u6d88\u606f\u961f\u5217\u6a21\u5757 #define TOS_CFG_MAIL_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u6d88\u606f\u90ae\u7bb1\u6a21\u5757 #define TOS_CFG_PRIORITY_MESSAGE_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u6a21\u5757 #define TOS_CFG_PRIORITY_MAIL_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4f18\u5148\u7ea7\u6d88\u606f\u90ae\u7bb1\u6a21\u5757 #define TOS_CFG_TIMER_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u8f6f\u4ef6\u5b9a\u65f6\u5668\u6a21\u5757 #define TOS_CFG_PWR_MGR_EN 0u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u5916\u8bbe\u7535\u6e90\u7ba1\u7406\u6a21\u5757 #define TOS_CFG_TICKLESS_EN 0u // \u914d\u7f6eTickless \u4f4e\u529f\u8017\u6a21\u5757\u5f00\u5173 #define TOS_CFG_SEM_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4fe1\u53f7\u91cf\u6a21\u5757 #define TOS_CFG_TASK_STACK_DRAUGHT_DEPTH_DETACT_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4efb\u52a1\u6808\u6df1\u5ea6\u68c0\u6d4b #define TOS_CFG_FAULT_BACKTRACE_EN 0u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u5f02\u5e38\u6808\u56de\u6eaf\u529f\u80fd #define TOS_CFG_IDLE_TASK_STK_SIZE 128u // \u914d\u7f6eTencentOS tiny\u7a7a\u95f2\u4efb\u52a1\u6808\u5927\u5c0f #define TOS_CFG_CPU_TICK_PER_SECOND 1000u // \u914d\u7f6eTencentOS tiny\u7684tick\u9891\u7387 #define TOS_CFG_CPU_CLOCK (SystemCoreClock) // \u914d\u7f6eTencentOS tiny CPU\u9891\u7387 #define TOS_CFG_TIMER_AS_PROC 1u // \u914d\u7f6e\u662f\u5426\u5c06TIMER\u914d\u7f6e\u6210\u51fd\u6570\u6a21\u5f0f #endif \u6309\u7167\u4e0a\u9762\u7684\u6a21\u677f\u914d\u7f6e\u597dTencentOS tiny\u7684\u5404\u9879\u529f\u80fd\u540e\uff0c\u5c06tos_config.h \u6587\u4ef6\u653e\u5165\u8981\u79fb\u690d\u7684board\u5de5\u7a0b\u76ee\u5f55\u4e0b\u5373\u53ef\uff0c\u4f8b\u5982\u672c\u6559\u7a0b\u662f\u653e\u5230board\\NUCLEO_L073RZ\\TOS_CONFIG\u76ee\u5f55\u4e0b\u3002 \u8fd9\u6837\uff0cTencentOS tiny\u7684\u6e90\u7801\u5c31\u5168\u90e8\u6dfb\u52a0\u5b8c\u6bd5\u4e86\u3002 \u4e09\u3001\u521b\u5efaTencentOS tiny\u4efb\u52a1\uff0c\u6d4b\u8bd5\u79fb\u690d\u7ed3\u679c 1. \u4fee\u6539\u90e8\u5206\u4ee3\u7801 \u4fee\u6539stm32l0xx_it.c\u7684\u4e2d\u65ad\u51fd\u6570 \u5728stm32l0xx_it.c\uff08board\\NUCLEO_L073RZ\\Src\u76ee\u5f55\u4e0b\uff09\u6587\u4ef6\u4e2d\u5305\u542b tos_k.h \u5934\u6587\u4ef6 \u5728stm32l0xx_it.c\u6587\u4ef6\u4e2d\u7684PendSV_Handler\u51fd\u6570\u524d\u6dfb\u52a0__weak\u5173\u952e\u5b57\uff0c\u56e0\u4e3a\u8be5\u51fd\u6570\u5728TencentOS tiny\u7684\u8c03\u5ea6\u6c47\u7f16\u4e2d\u5df2\u7ecf\u91cd\u65b0\u5b9e\u73b0\uff1b\u540c\u65f6\u5728SysTick_Handler\u51fd\u6570\u4e2d\u6dfb\u52a0TencentOS tiny\u7684\u8c03\u5ea6\u5904\u7406\u51fd\u6570\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a 2. \u7f16\u5199TencentOS tiny \u6d4b\u8bd5\u4efb\u52a1 \u5728mian.c \u4e2d\u6dfb\u52a0TencentOS tiny \u5934\u6587\u4ef6\uff0c\u7f16\u5199\u4efb\u52a1\u51fd\u6570 #include \"cmsis_os.h\" //task1 #define TASK1_STK_SIZE 512 void task1(void *pdata); osThreadDef(task1, osPriorityNormal, 1, TASK1_STK_SIZE); //task2 #define TASK2_STK_SIZE 512 void task2(void *pdata); osThreadDef(task2, osPriorityNormal, 1, TASK2_STK_SIZE); void task1(void *pdata) { int count = 1; while(1) { printf(\"\\r\\nHello world!\\r\\n###This is task1 ,count is %d \\r\\n\", count++); HAL_GPIO_TogglePin(LED_GPIO_Port,LED_Pin); osDelay(2000); } } void task2(void *pdata) { int count = 1; while(1) { printf(\"\\r\\nHello TencentOS !\\r\\n***This is task2 ,count is %d \\r\\n\", count++); osDelay(1000); } } int _write(int fd, char *ptr, int len) { (void)HAL_UART_Transmit(&huart2, (uint8_t *)ptr, len, 0xFFFF); return len; } \u5982\u56fe\uff1a \u7ee7\u7eed\u5728main.c \u7684mian\u51fd\u6570\u4e2d\u786c\u4ef6\u5916\u8bbe\u521d\u59cb\u5316\u4ee3\u7801\u540e\u6dfb\u52a0TencentOS tiny\u7684\u521d\u59cb\u5316\u4ee3\u7801\uff1a osKernelInitialize(); //TOS Tiny kernel initialize osThreadCreate(osThread(task1), NULL);// Create task1 osThreadCreate(osThread(task2), NULL);// Create task2 osKernelStart();//Start TOS Tiny \u5982\u56fe\uff1a 3. \u7f16\u8bd1\u4e0b\u8f7d\u6d4b\u8bd5TencentOS tiny\u79fb\u690d\u7ed3\u679c \u5b8c\u6210\u4ee3\u7801\u7f16\u8f91\u540e\u56de\u5230TencentOS_tiny\\board\\NUCLEO_L073RZ\u76ee\u5f55\u4e0b\uff0c\u627e\u5230makefile\u6587\u4ef6\uff0c\u8be5\u76ee\u5f55\u4e0b\u6253\u5f00cmd\u547d\u4ee4\u7a97\u53e3\uff0c\u8f93\u5165make\u547d\u4ee4\u8fdb\u884c\u7f16\u8bd1\uff0c\u5f97\u5230bin\u6587\u4ef6\uff0c\u7136\u540e\u5c06bin\u6587\u4ef6\u901a\u8fc7\u4e0b\u8f7d\u5de5\u5177\u4e0b\u8f7d\u5230\u5f00\u53d1\u677f\u5373\u53ef\u5b8c\u6210TencentOS tiny\u7684\u6d4b\u8bd5\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u53ef\u4ee5\u770b\u5230\u4e32\u53e3\u4ea4\u66ff\u6253\u5370\u4fe1\u606f\uff0c\u8868\u793a\u4e24\u4e2a\u4efb\u52a1\u6b63\u5728\u8fdb\u884c\u8c03\u5ea6\uff0c\u5207\u6362\u8fd0\u884c\uff1a","title":"12.Porting_Manual_for_GCC"},{"location":"12.Porting_Manual_for_GCC/#tencentos-tiny-gcc","text":"","title":"TencentOS tiny \u5185\u6838\u79fb\u690d\u53c2\u8003\u6307\u5357\uff08GCC\u7248\uff09"},{"location":"12.Porting_Manual_for_GCC/#_1","text":"","title":"\u4e00\u3001\u79fb\u690d\u524d\u7684\u51c6\u5907"},{"location":"12.Porting_Manual_for_GCC/#1","text":"TencentOS tiny\u76ee\u524d\u4e3b\u8981\u652f\u6301ARM Cortex M\u6838\u82af\u7247\u7684\u79fb\u690d\uff0c\u6bd4\u5982STM32 \u57fa\u4e8eCortex M\u6838\u5168\u7cfb\u5217\u3001NXP \u57fa\u4e8eCortex M\u6838\u5168\u7cfb\u5217\u7b49\u3002\u672c\u6559\u7a0b\u5c06\u4f7f\u7528STM32\u5b98\u65b9Demo\u5f00\u53d1\u677f NUCLEO-L073RZ\u8fdb\u884c\u793a\u4f8b\u79fb\u690d\uff0c\u5176\u4ed6 ARM Cortex M\u7cfb\u5217\u5f00\u53d1\u677f\u548c\u82af\u7247\u79fb\u690d\u65b9\u6cd5\u7c7b\u4f3c\u3002 \u8c03\u8bd5ARM Cortex M\u6838\u8fd8\u9700\u8981\u4eff\u771f\u5668\uff0c NUCLEO-L073RZ\u81ea\u5e26ST-Link\u8c03\u8bd5\u5668\uff0c\u5982\u679c\u60a8\u7684\u5f00\u53d1\u677f\u6216\u8005\u82af\u7247\u6a21\u7ec4\u6ca1\u6709\u677f\u8f7d\u4eff\u771f\u5668\uff0c\u5c31\u9700\u8981\u8fde\u63a5\u5916\u7f6e\u7684\u4eff\u771f\u5668\uff0c\u5982J-Link\u3001U-Link\u4e4b\u7c7b\u7684\u3002","title":"1. \u51c6\u5907\u76ee\u6807\u786c\u4ef6\uff08\u5f00\u53d1\u677f/\u82af\u7247/\u6a21\u7ec4\uff09"},{"location":"12.Porting_Manual_for_GCC/#2","text":"\u672c\u79fb\u690d\u6307\u5357\u9488\u5bf9\u7684\u662fGCC\u7f16\u8bd1\u5668\uff0c\u6240\u4ee5\u6211\u4eec\u79fb\u690d\u5185\u6838\u524d\u9700\u8981\u5148\u5b89\u88c5GCC\u7f16\u8bd1\u5668\uff0c\u80fd\u7f16\u8bd1ARM Cortex M\u6838\u7684GCC\u7f16\u8bd1\u5668\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://developer.arm.com/tools-and-software/open-source-software/developer-tools/gnu-toolchain/gnu-rm/downloads \u5982\u4e0a\u56fe\u6240\u793a\uff0c\u4e0b\u8f7dwindows exe\u7248\u672c\u7684gcc\u7f16\u8bd1\u5668\uff08Linux\u4e0b\u4e5f\u53ef\u4ee5\u4e0b\u8f7dlinux\u7248\u672c\u7684\u7f16\u8bd1\u5668\uff09\uff0c\u4e0b\u8f7d\u5b8c\u6210\u5728windows\u73af\u5883\u4e0b\u6309\u7167\u63d0\u793a\u5b89\u88c5\uff0c\u5982\u4e0b\u56fe\uff0c \u6ce8\u610f\uff1a\u5b89\u88c5\u5b8c\u6bd5\u540e\u9700\u8981\u5c06\u201cAdd path to environment variable\u201d\u52fe\u9009\u4e0a\u3002 \u7531\u4e8ewindows\u73af\u5883\u4e0b\u6ca1\u6709make\u73af\u5883\uff0c\u6240\u4ee5\u6211\u4eec\u8fd8\u9700\u8981\u5b89\u88c5\u4e00\u4e2amake\u5de5\u5177\uff0cMake \u5de5\u5177\u7528\u4e8e build \u5de5\u7a0b\uff0c \u4f7f\u7528 Makefile \u7f16\u8bd1\u5de5\u7a0b\u3002 \u7248\u672c\uff1agnu-mcu-eclipse-build-tools-2.9-20170629-1013-win64-setup.exe \u4e0b\u8f7d\u5730\u5740: https://github.com/gnu-mcu-eclipse/windows-build-tools/releases/tag/v2.9-20170629-1013 \u76f4\u63a5\u53cc\u51fb\u5b89\u88c5\uff0c\u5b8c\u6210\u540e\u5c06\u5b89\u88c5\u540e\u7684make\u547d\u4ee4\u76ee\u5f55\u6dfb\u52a0\u5230windows\u7684path\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u9ed8\u8ba4\u5b89\u88c5\u76ee\u5f55\u4e3a\uff1a C:\\Program Files\\GNU MCU Eclipse\\Build Tools\\2.9-20170629-1013\\bin\\bin\uff0c\u5728\u73af\u5883\u53d8\u91cf\u4e2d\u6dfb\u52a0\u5b89\u88c5\u76ee\u5f55\u5373\u53ef\u3002","title":"2.\u51c6\u5907\u7f16\u8bd1\u5668\u73af\u5883"},{"location":"12.Porting_Manual_for_GCC/#3","text":"\u79fb\u690dTencentOS tiny\u57fa\u7840\u5185\u6838\u9700\u8981\u60a8\u63d0\u524d\u51c6\u5907\u4e00\u4e2a\u82af\u7247\u5bf9\u5e94\u7684\u88f8\u673a\u5de5\u7a0b\uff0c\u88f8\u673a\u5de5\u7a0b\u5305\u542b\u57fa\u672c\u7684\u82af\u7247\u542f\u52a8\u6587\u4ef6\u3001\u57fa\u7840\u914d\u7f6e\uff08\u65f6\u949f\u3001\u4e3b\u9891\u7b49\uff09\u3001\u4ee5\u53ca\u4e32\u53e3\u3001\u57fa\u672cGPIO\u9a71\u52a8\u7528\u4e8eRTOS\u6d4b\u8bd5\u3002 \u672c\u6559\u7a0b\u4f7f\u7528ST\u5b98\u65b9\u7684STM32CubeMX\u8f6f\u4ef6\u6765\u81ea\u52a8\u5316\u751f\u6210GCC\u88f8\u673a\u5de5\u7a0b\uff0cSTM32CubeMX\u7684\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://www.st.com/content/st_com/zh/products/development-tools/software-development-tools/stm32-software-development-tools/stm32-configurators-and-code-generators/stm32cubemx.html \u5b89\u88c5STM32CubeMx\u8fd8\u9700\u8981\u4e8b\u5148\u5b89\u88c5\u597dJDK\u73af\u5883\uff0c\u60a8\u53ef\u4ee5\u5728\u4e92\u8054\u7f51\u4e0a\u67e5\u627e\u5982\u4f55\u5b89\u88c5\u548c\u914d\u7f6eJDK\u73af\u5883\uff0c\u6b64\u5904\u4e0d\u518d\u8d58\u8ff0\u3002 CubeMX\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528CubeMX\u6765\u7ed9NUCLEO-L073RZ\u5f00\u53d1\u677f\u751f\u6210\u88f8\u673a\u5de5\u7a0b\u4e86\uff0c\u5982\u679c\u60a8\u7684\u82af\u7247\u4e0d\u662fSTM32\uff0c\u800c\u662f\u5176\u4ed6\u5382\u5546\u7684ARM Cortex M\u7cfb\u5217\uff0c\u60a8\u53ef\u4ee5\u6839\u636e\u4ea7\u5546\u7684\u6307\u5bfc\u51c6\u5907\u88f8\u673a\u5de5\u7a0b\uff0c\u540e\u7eed\u7684\u5185\u6838\u79fb\u690d\u6b65\u9aa4\u662f\u4e00\u81f4\u7684\u3002","title":"3. \u51c6\u5907\u82af\u7247\u5bf9\u5e94\u7684\u88f8\u673a\u5de5\u7a0b"},{"location":"12.Porting_Manual_for_GCC/#31-stm32cubemx","text":"","title":"3.1 \u9996\u5148\u542f\u52a8STM32CubeMX\uff0c\u65b0\u5efa\u5de5\u7a0b"},{"location":"12.Porting_Manual_for_GCC/#32-mcu","text":"\u5982\u4e0a\u56fe\u6240\u793a\uff1a\u901a\u8fc7MCU\u7b5b\u9009\u6765\u627e\u5230\u81ea\u5df1\u5f00\u53d1\u677f\u5bf9\u5e94\u7684\u82af\u7247\u578b\u53f7\uff0c\u53cc\u51fb\u540e\u5f39\u51fa\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\uff0c\u5982\u4e0b\u56fe\uff1a","title":"3.2 \u9009\u62e9MCU\u578b\u53f7"},{"location":"12.Porting_Manual_for_GCC/#33-pin","text":"","title":"3.3 Pin\u8bbe\u7f6e\u754c\u9762\u914d\u7f6e\u65f6\u949f\u6e90"},{"location":"12.Porting_Manual_for_GCC/#34-pin","text":"","title":"3.4 Pin\u8bbe\u7f6e\u754c\u9762\u914d\u7f6e\u4e32\u53e3"},{"location":"12.Porting_Manual_for_GCC/#35-pingpio","text":"","title":"3.5 Pin\u8bbe\u7f6e\u754c\u9762\u914d\u7f6eGPIO"},{"location":"12.Porting_Manual_for_GCC/#36","text":"","title":"3.6 \u914d\u7f6e\u603b\u7ebf\u65f6\u949f"},{"location":"12.Porting_Manual_for_GCC/#37","text":"","title":"3.7 \u5de5\u7a0b\u751f\u6210\u53c2\u6570\u914d\u7f6e"},{"location":"12.Porting_Manual_for_GCC/#39","text":"","title":"3.9 \u751f\u6210\u5de5\u7a0b"},{"location":"12.Porting_Manual_for_GCC/#310-gcc","text":"\u70b9\u51fb\u751f\u6210\u4ee3\u7801\u540e\uff0c\u751f\u6210\u7684\u88f8\u673a\u5de5\u7a0b\u6548\u679c\u5982\u4e0b\uff0c\u5728makefile\u540c\u7ea7\u76ee\u5f55\u4e0b\u6253\u5f00windows\u7684cmd\u547d\u4ee4\u7a97\u53e3\uff08\u76ee\u5f55\u4e0b\u6309shift+\u9f20\u6807\u53f3\u952e\uff0c\u70b9\u51fb\u5728\u6b64\u5904\u6253\u5f00\u547d\u4ee4\u7a97\u53e3\uff09\uff0c\u8f93\u5165make\u547d\u4ee4\uff0c\u5c31\u53ef\u4ee5\u7f16\u8bd1gcc\u88f8\u673a\u5de5\u7a0b\u4e86\uff0c\u7f16\u8bd1\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5\u770b\u5230\u751f\u6210\u4e86elf\u548cbin\u6587\u4ef6\uff0c\u901a\u8fc7\u5de5\u5177\u5c31\u53ef\u4ee5\u4e0b\u8f7dbin\u6587\u4ef6\u5230\u5f00\u53d1\u677f\u8fd0\u884c\u4e86\u3002","title":"3.10 \u7f16\u8bd1GCC\u4e0b\u7684\u88f8\u673a\u5de5\u7a0b"},{"location":"12.Porting_Manual_for_GCC/#4-tencentos-tiny","text":"TencentOS tiny\u7684\u6e90\u7801\u5df2\u7ecf\u5f00\u6e90\uff0cgithub\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://github.com/Tencent/TencentOS-tiny.git \u4e00\u7ea7\u76ee\u5f55 \u4e8c\u7ea7\u76ee\u5f55 \u8bf4\u660e arch arm TencentOS tiny\u9002\u914d\u7684IP\u6838\u67b6\u6784\uff08\u542bM\u6838\u4e2d\u65ad\u3001\u8c03\u5ea6\u3001tick\u76f8\u5173\u4ee3\u7801\uff09 board NUCLEO_L073RZ \u79fb\u690d\u76ee\u6807\u82af\u7247\u7684\u5de5\u7a0b\u6587\u4ef6 kernel core TencentOS tiny\u5185\u6838\u6e90\u7801 pm TencentOS tiny\u4f4e\u529f\u8017\u6a21\u5757\u6e90\u7801 osal cmsis_os TencentOS tiny\u63d0\u4f9b\u7684cmsis os \u9002\u914d \u7531\u4e8e\u672c\u6559\u7a0b\u53ea\u4ecb\u7ecdTencentOS tiny\u7684\u5185\u6838\u79fb\u690d\uff0c\u6240\u4ee5\u8fd9\u91cc\u53ea\u9700\u8981\u7528\u5230 arch\u3001board\u3001kernel\u3001osal\u56db\u4e2a\u76ee\u5f55\u4e0b\u7684\u6e90\u7801\u3002","title":"4. \u51c6\u5907TencentOS tiny\u7684\u6e90\u7801"},{"location":"12.Porting_Manual_for_GCC/#_2","text":"","title":"\u4e8c\u3001\u5185\u6838\u79fb\u690d"},{"location":"12.Porting_Manual_for_GCC/#1_1","text":"\u5982\u56fe\u6240\u793a\uff0c\u65b0\u5efaTencentOS_tiny\u4e3b\u76ee\u5f55\uff0c\u5e76\u5728\u4e3b\u76ee\u5f55\u4e0b\u6dfb\u52a0\u56db\u4e2a\u5b50\u76ee\u5f55\uff0c\u5176\u4e2darch\u3001kernel\u3001osal\u4ece\u4ee3\u7801\u4ed3\u76f4\u63a5\u62f7\u8d1d\u8fc7\u6765\u5373\u53ef\uff0c\u800cboard\u76ee\u5f55\u4e0b\u5219\u653e\u5165\u6211\u4eec\u524d\u9762\u751f\u6210\u7684\u88f8\u673a\u5de5\u7a0b\u4ee3\u7801\uff0c\u6211\u4eec\u79fb\u690d\u7684\u5f00\u53d1\u677f\u53d6\u540d\u53ebNUCLEO_L073RZ,\u88f8\u673a\u4ee3\u7801\u5168\u90e8\u62f7\u8d1d\u5230\u4e0b\u9762\u5373\u53ef\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u63a5\u4e0b\u6765\u8fdb\u5165TencentOS_tiny\\board\\NUCLEO_L073RZ\u76ee\u5f55\uff0c\u6253\u5f00Makefile\uff0c\u6211\u4eec\u5f00\u59cb\u6dfb\u52a0TencentOS tiny\u7684\u5185\u6838\u4ee3\u7801\u3002","title":"1. \u4ee3\u7801\u76ee\u5f55\u89c4\u5212"},{"location":"12.Porting_Manual_for_GCC/#2-arch","text":"\u6dfb\u52a0\u4ee3\u7801\u524d\u5148\u5728makefile\u6587\u4ef6\u4e0b\u5b9a\u4e49\u4e00\u4e2aTOP_DIR\u8def\u5f84\uff0c\u4f5c\u4e3aTencentOS tiny\u7684\u9876\u7ea7\u76ee\u5f55\uff0c\u5f53\u524dmakefile\u6587\u4ef6\u5728\u4e8c\u7ea7\u5b50\u76ee\u5f55\u4e0b\u9762\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u76f8\u5bf9\u9876\u7ea7\u76ee\u5f55\u4e3aTOP_DIR = ../../\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u7136\u540e\u5728makefile\u4e2d C_SOURCES\u540e\u9762\u6dfb\u52a0 arch C\u4ee3\u7801\uff0c\u5728ASM_SOURCES\u540e\u9762\u6dfb\u52a0\u4e00\u4e2aASM_SOURCES_S \u5206\u7ec4\uff0c\u52a0\u5165\u8c03\u5ea6\u6c47\u7f16\u4ee3\u7801.S. tos_cpu.c\u662fTencentOS tiny \u7684CPU\u9002\u914d\u6587\u4ef6\uff0c\u5305\u62ec\u5806\u6808\u521d\u59cb\u5316\uff0c\u4e2d\u65ad\u9002\u914d\u7b49\uff0c\u5982\u679c\u60a8\u7684\u82af\u7247\u662fARM Cortex M\u6838\uff0c\u8be5\u6587\u4ef6\u53ef\u4ee5\u4e0d\u505a\u6539\u52a8\uff0cM0\u3001M3 \u3001M4\u3001M7\u662f\u901a\u7528\u7684\uff0c\u5176\u4ed6IP\u6838\u9700\u8981\u91cd\u65b0\u9002\u914d\uff1b port_s.S \u6587\u4ef6\u662fTencentOS tiny\u7684\u4efb\u52a1\u8c03\u5ea6\u6c47\u7f16\u4ee3\u7801\uff0c\u4e3b\u8981\u505a\u5f39\u6808\u538b\u6808\u7b49\u5904\u7406\u7684\uff0cport_c.c\u9002\u914dsystick\u7b49\uff0c\u8fd9\u4e24\u4e2a\u6587\u4ef6 \u6bcf\u4e2aIP\u6838\u548c\u7f16\u8bd1\u5668\u90fd\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u5982\u679c\u60a8\u7684\u82af\u7247\u662fARM Cortex M\u6838\uff0c\u6211\u4eec\u90fd\u5df2\u7ecf\u9002\u914d\u597d\uff0c\u6bd4\u5982\u73b0\u5728\u6211\u4eec\u79fb\u690d\u7684\u82af\u7247\u662fSTM32L073RZ\uff0c\u662fARM Cortex M0+\u6838\uff0c\u4f7f\u7528\u7684\u7f16\u8bd1\u5668\u662fGCC\uff0c\u6240\u4ee5\u6211\u4eec\u9009\u62e9arch\\arm\\arm-v7m\\cortex-m0+\\gcc\u4e0b\u7684\u9002\u914d\u4ee3\u7801\uff0c\u5982\u679c\u4f60\u7684\u5f00\u53d1\u677f\u662fSTM32F429IG\uff0cM4\u6838\uff0c\u7f16\u8bd1\u5668\u662fkeil\uff0c\u5219\u53ef\u4ee5\u9009\u62e9arch\\arm\\arm-v7m\\cortex-m4\\armcc\u76ee\u5f55\u4e0b\u7684\u9002\u914d\u6587\u4ef6\u3002","title":"2. \u6dfb\u52a0arch\u5e73\u53f0\u4ee3\u7801"},{"location":"12.Porting_Manual_for_GCC/#3_1","text":"\u5185\u6838\u6e90\u7801kerne\u76ee\u5f55\u4e0b\u5305\u542bcore\u548cpm\u4e24\u4e2a\u76ee\u5f55\uff0c\u5176\u4e2dcore\u4e0b\u4e3a\u57fa\u7840\u5185\u6838\uff0cpm\u662f\u5185\u6838\u4e2d\u7684\u4f4e\u529f\u8017\u7ec4\u4ef6\uff1b\u57fa\u7840\u79fb\u690d\u7684\u65f6\u5019\u53ef\u4ee5\u4e0d\u6dfb\u52a0pm\u76ee\u5f55\u4e0b\u7684\u4ee3\u7801\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u6dfb\u52a0\u57fa\u672c\u5185\u6838\u6e90\u7801\uff1a","title":"3. \u6dfb\u52a0\u5185\u6838\u6e90\u7801"},{"location":"12.Porting_Manual_for_GCC/#4-cmsis-os","text":"cmsis os\u662fTencentOS tiny\u4e3a\u4e86\u517c\u5bb9cmsis\u6807\u51c6\u800c\u9002\u914d\u7684OS\u62bd\u8c61\u5c42\uff0c\u53ef\u4ee5\u7b80\u5316\u5927\u5bb6\u5c06\u4e1a\u52a1\u4ece\u5176\u4ed6RTOS\u8fc1\u79fb\u5230TencentOS tiny\u7684\u5de5\u4f5c\u91cf\u3002","title":"4. \u6dfb\u52a0cmsis os\u6e90\u7801"},{"location":"12.Porting_Manual_for_GCC/#5-tencentos-tiny","text":"\u6dfb\u52a0\u5934\u6587\u4ef6\u76ee\u5f55\u524d\uff0c\u6211\u4eec\u5728\u8981\u79fb\u690d\u7684\u5de5\u7a0b\u76ee\u5f55\u4e0b\u65b0\u589e\u4e00\u4e2a TOS_CONFIG\u6587\u4ef6\u5939\uff0c\u7528\u4e8e\u5b58\u653eTencentOS tiny\u7684\u914d\u7f6e\u5934\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f\u63a5\u4e0b\u6765\u8981\u65b0\u5efa\u7684tos_config.h\u6587\u4ef6\uff1b TencentOS tiny\u6240\u6709\u8981\u6dfb\u52a0\u7684\u5934\u6587\u4ef6\u76ee\u5f55\u5982\u4e0b\uff1a","title":"5. \u6dfb\u52a0TencentOS tiny\u5934\u6587\u4ef6\u76ee\u5f55"},{"location":"12.Porting_Manual_for_GCC/#6-makefile","text":"\u7531\u4e8e\u6211\u4eecTencentOS tiny\u7684\u8c03\u5ea6\u6c47\u7f16port_s.S\u6587\u4ef6\u7528\u7684\u540e\u7f00\u662f.S \u800c\u4e0d\u662f.s,\u6240\u4ee5\u6211\u4eec\u8981\u5728makefile\u4e2d\u6dfb\u52a0\u7f16\u8bd1.S\u7684\u89c4\u5219\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a","title":"6. \u4fee\u6539makefile\u7f16\u8bd1\u89c4\u5219"},{"location":"12.Porting_Manual_for_GCC/#7-tencentos-tiny-tos_configh","text":"#ifndef _TOS_CONFIG_H_ #define _TOS_CONFIG_H_ #include \"stm32l0xx.h\" // \u76ee\u6807\u82af\u7247\u5934\u6587\u4ef6\uff0c\u7528\u6237\u9700\u8981\u6839\u636e\u60c5\u51b5\u66f4\u6539 #define TOS_CFG_TASK_PRIO_MAX 10u // \u914d\u7f6eTencentOS tiny\u9ed8\u8ba4\u652f\u6301\u7684\u6700\u5927\u4f18\u5148\u7ea7\u6570\u91cf #define TOS_CFG_ROUND_ROBIN_EN 0u // \u914d\u7f6eTencentOS tiny\u7684\u5185\u6838\u662f\u5426\u5f00\u542f\u65f6\u95f4\u7247\u8f6e\u8f6c #define TOS_CFG_OBJECT_VERIFY_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u6821\u9a8c\u6307\u9488\u5408\u6cd5 #define TOS_CFG_TASK_DYNAMIC_CREATE_EN 1u // TencentOS tiny \u52a8\u6001\u4efb\u52a1\u521b\u5efa\u529f\u80fd\u5b8f #define TOS_CFG_EVENT_EN 1u // TencentOS tiny \u4e8b\u4ef6\u6a21\u5757\u529f\u80fd\u5b8f #define TOS_CFG_MMBLK_EN 1u //\u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u5185\u5b58\u5757\u7ba1\u7406\u6a21\u5757 #define TOS_CFG_MMHEAP_EN 1u //\u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u52a8\u6001\u5185\u5b58\u6a21\u5757 #define TOS_CFG_MMHEAP_DEFAULT_POOL_EN 1u // TencentOS tiny \u9ed8\u8ba4\u52a8\u6001\u5185\u5b58\u6c60\u529f\u80fd\u5b8f #define TOS_CFG_MMHEAP_DEFAULT_POOL_SIZE 0x100 // \u914d\u7f6eTencentOS tiny\u9ed8\u8ba4\u52a8\u6001\u5185\u5b58\u6c60\u5927\u5c0f #define TOS_CFG_MUTEX_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4e92\u65a5\u9501\u6a21\u5757 #define TOS_CFG_MESSAGE_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u6d88\u606f\u961f\u5217\u6a21\u5757 #define TOS_CFG_MAIL_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u6d88\u606f\u90ae\u7bb1\u6a21\u5757 #define TOS_CFG_PRIORITY_MESSAGE_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4f18\u5148\u7ea7\u6d88\u606f\u961f\u5217\u6a21\u5757 #define TOS_CFG_PRIORITY_MAIL_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4f18\u5148\u7ea7\u6d88\u606f\u90ae\u7bb1\u6a21\u5757 #define TOS_CFG_TIMER_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u8f6f\u4ef6\u5b9a\u65f6\u5668\u6a21\u5757 #define TOS_CFG_PWR_MGR_EN 0u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u5916\u8bbe\u7535\u6e90\u7ba1\u7406\u6a21\u5757 #define TOS_CFG_TICKLESS_EN 0u // \u914d\u7f6eTickless \u4f4e\u529f\u8017\u6a21\u5757\u5f00\u5173 #define TOS_CFG_SEM_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4fe1\u53f7\u91cf\u6a21\u5757 #define TOS_CFG_TASK_STACK_DRAUGHT_DEPTH_DETACT_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4efb\u52a1\u6808\u6df1\u5ea6\u68c0\u6d4b #define TOS_CFG_FAULT_BACKTRACE_EN 0u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u5f02\u5e38\u6808\u56de\u6eaf\u529f\u80fd #define TOS_CFG_IDLE_TASK_STK_SIZE 128u // \u914d\u7f6eTencentOS tiny\u7a7a\u95f2\u4efb\u52a1\u6808\u5927\u5c0f #define TOS_CFG_CPU_TICK_PER_SECOND 1000u // \u914d\u7f6eTencentOS tiny\u7684tick\u9891\u7387 #define TOS_CFG_CPU_CLOCK (SystemCoreClock) // \u914d\u7f6eTencentOS tiny CPU\u9891\u7387 #define TOS_CFG_TIMER_AS_PROC 1u // \u914d\u7f6e\u662f\u5426\u5c06TIMER\u914d\u7f6e\u6210\u51fd\u6570\u6a21\u5f0f #endif \u6309\u7167\u4e0a\u9762\u7684\u6a21\u677f\u914d\u7f6e\u597dTencentOS tiny\u7684\u5404\u9879\u529f\u80fd\u540e\uff0c\u5c06tos_config.h \u6587\u4ef6\u653e\u5165\u8981\u79fb\u690d\u7684board\u5de5\u7a0b\u76ee\u5f55\u4e0b\u5373\u53ef\uff0c\u4f8b\u5982\u672c\u6559\u7a0b\u662f\u653e\u5230board\\NUCLEO_L073RZ\\TOS_CONFIG\u76ee\u5f55\u4e0b\u3002 \u8fd9\u6837\uff0cTencentOS tiny\u7684\u6e90\u7801\u5c31\u5168\u90e8\u6dfb\u52a0\u5b8c\u6bd5\u4e86\u3002","title":"7. \u65b0\u5efaTencentOS tiny\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6 tos_config.h"},{"location":"12.Porting_Manual_for_GCC/#tencentos-tiny","text":"","title":"\u4e09\u3001\u521b\u5efaTencentOS tiny\u4efb\u52a1\uff0c\u6d4b\u8bd5\u79fb\u690d\u7ed3\u679c"},{"location":"12.Porting_Manual_for_GCC/#1_2","text":"","title":"1. \u4fee\u6539\u90e8\u5206\u4ee3\u7801"},{"location":"12.Porting_Manual_for_GCC/#stm32l0xx_itc","text":"\u5728stm32l0xx_it.c\uff08board\\NUCLEO_L073RZ\\Src\u76ee\u5f55\u4e0b\uff09\u6587\u4ef6\u4e2d\u5305\u542b tos_k.h \u5934\u6587\u4ef6 \u5728stm32l0xx_it.c\u6587\u4ef6\u4e2d\u7684PendSV_Handler\u51fd\u6570\u524d\u6dfb\u52a0__weak\u5173\u952e\u5b57\uff0c\u56e0\u4e3a\u8be5\u51fd\u6570\u5728TencentOS tiny\u7684\u8c03\u5ea6\u6c47\u7f16\u4e2d\u5df2\u7ecf\u91cd\u65b0\u5b9e\u73b0\uff1b\u540c\u65f6\u5728SysTick_Handler\u51fd\u6570\u4e2d\u6dfb\u52a0TencentOS tiny\u7684\u8c03\u5ea6\u5904\u7406\u51fd\u6570\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a","title":"\u4fee\u6539stm32l0xx_it.c\u7684\u4e2d\u65ad\u51fd\u6570"},{"location":"12.Porting_Manual_for_GCC/#2-tencentos-tiny","text":"","title":"2.  \u7f16\u5199TencentOS tiny \u6d4b\u8bd5\u4efb\u52a1"},{"location":"12.Porting_Manual_for_GCC/#mianc-tencentos-tiny","text":"#include \"cmsis_os.h\" //task1 #define TASK1_STK_SIZE 512 void task1(void *pdata); osThreadDef(task1, osPriorityNormal, 1, TASK1_STK_SIZE); //task2 #define TASK2_STK_SIZE 512 void task2(void *pdata); osThreadDef(task2, osPriorityNormal, 1, TASK2_STK_SIZE); void task1(void *pdata) { int count = 1; while(1) { printf(\"\\r\\nHello world!\\r\\n###This is task1 ,count is %d \\r\\n\", count++); HAL_GPIO_TogglePin(LED_GPIO_Port,LED_Pin); osDelay(2000); } } void task2(void *pdata) { int count = 1; while(1) { printf(\"\\r\\nHello TencentOS !\\r\\n***This is task2 ,count is %d \\r\\n\", count++); osDelay(1000); } } int _write(int fd, char *ptr, int len) { (void)HAL_UART_Transmit(&huart2, (uint8_t *)ptr, len, 0xFFFF); return len; } \u5982\u56fe\uff1a \u7ee7\u7eed\u5728main.c \u7684mian\u51fd\u6570\u4e2d\u786c\u4ef6\u5916\u8bbe\u521d\u59cb\u5316\u4ee3\u7801\u540e\u6dfb\u52a0TencentOS tiny\u7684\u521d\u59cb\u5316\u4ee3\u7801\uff1a osKernelInitialize(); //TOS Tiny kernel initialize osThreadCreate(osThread(task1), NULL);// Create task1 osThreadCreate(osThread(task2), NULL);// Create task2 osKernelStart();//Start TOS Tiny \u5982\u56fe\uff1a","title":"\u5728mian.c \u4e2d\u6dfb\u52a0TencentOS tiny \u5934\u6587\u4ef6\uff0c\u7f16\u5199\u4efb\u52a1\u51fd\u6570"},{"location":"12.Porting_Manual_for_GCC/#3-tencentos-tiny","text":"\u5b8c\u6210\u4ee3\u7801\u7f16\u8f91\u540e\u56de\u5230TencentOS_tiny\\board\\NUCLEO_L073RZ\u76ee\u5f55\u4e0b\uff0c\u627e\u5230makefile\u6587\u4ef6\uff0c\u8be5\u76ee\u5f55\u4e0b\u6253\u5f00cmd\u547d\u4ee4\u7a97\u53e3\uff0c\u8f93\u5165make\u547d\u4ee4\u8fdb\u884c\u7f16\u8bd1\uff0c\u5f97\u5230bin\u6587\u4ef6\uff0c\u7136\u540e\u5c06bin\u6587\u4ef6\u901a\u8fc7\u4e0b\u8f7d\u5de5\u5177\u4e0b\u8f7d\u5230\u5f00\u53d1\u677f\u5373\u53ef\u5b8c\u6210TencentOS tiny\u7684\u6d4b\u8bd5\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u53ef\u4ee5\u770b\u5230\u4e32\u53e3\u4ea4\u66ff\u6253\u5370\u4fe1\u606f\uff0c\u8868\u793a\u4e24\u4e2a\u4efb\u52a1\u6b63\u5728\u8fdb\u884c\u8c03\u5ea6\uff0c\u5207\u6362\u8fd0\u884c\uff1a","title":"3. \u7f16\u8bd1\u4e0b\u8f7d\u6d4b\u8bd5TencentOS tiny\u79fb\u690d\u7ed3\u679c"},{"location":"13.Porting_Manual_for_MacOS_STM32CubeIDE/","text":"TencentOS tiny\u5185\u6838\u79fb\u690d\u6307\u5357(MacOS+STM32CubeIDE\u7248) \u4e00\u3001\u5de5\u7a0b\u521b\u5efa \u5177\u4f53\u7684\u5de5\u7a0b\u521b\u5efa\u65b9\u6cd5\u548c\u521d\u59cb\u53c2\u6570\u8bbe\u7f6e\u65b9\u6cd5\u7565\u53bb\u3002 \u9700\u8981\u5f3a\u8c03\u7684\u662f\u672c\u6587\u662f\u4ee5 STM32L431 \u82af\u7247\u4e3a\u57fa\u7840\u7684\uff0c\u5982\u679c\u662f\u5176\u5b83\u82af\u7247\uff0c\u540e\u9762\u7684\u6b65\u9aa4\u8bf7\u505a\u76f8\u5e94\u7684\u8c03\u6574\u3002 \u6700\u540e\u751f\u6210\u7684\u5de5\u7a0b\u76ee\u5f55\u5982\u4e0b: \u4e8c\u3001TencentOS tiny\u4ee3\u7801\u51c6\u5907 \u53ea\u9700\u8981\u4fdd\u7559TencentOS\u8fd9\u4e9b\u76ee\u5f55\u4e0b\u7684\u4ee3\u7801\uff0c\u5176\u5b83\u76ee\u5f55\u7686\u53ef\u5220\u9664\u3002 \u5728 arch \u76ee\u5f55\u91cc\u9700\u8981\u5220\u9664\u7684\u6240\u6709\u4ee3\u7801\u76ee\u5f55\u5217\u8868 arch/arm/arm-v7m/cortex-m0+/ arch/arm/arm-v7m/cortex-m3/ arch/arm/arm-v7m/cortex-m4/armcc/ arch/arm/arm-v7m/cortex-m4/iccarm/ arch/arm/arm-v7m/cortex-m7/ \u6ce8: STM32L431\u662fCortex-M4\u5185\u6838\uff0c\u6240\u4ee5\u5982\u679c\u662f\u5176\u5b83\u82af\u7247\uff0c\u4f8b\u5982STM32F103\u5c31\u5e94\u8be5\u5220\u9664 arch/arm/arm-v7m/cortex-m4/ \u76ee\u5f55\uff0c\u4fdd\u7559 arch/arm/arm-v7m/cortex-m3/gcc \u76ee\u5f55\u3002 \u91cd\u547d\u540d\u4ee3\u7801\u9876\u5c42\u76ee\u5f55 $ mv TencentOS_tiny tiny \u4e09\u3001\u79fb\u690d\u5de5\u4f5c \u628a\u4ee3\u7801 tiny \u62f7\u8d1d\u5230\u7b2c\u4e00\u6b65\u521b\u5efa\u7684\u5de5\u7a0b\u76ee\u5f55\u91cc \u5237\u65b0\u5de5\u7a0b \u628a\u4ee3\u7801\u6dfb\u52a0\u5230\u5de5\u7a0b\u91cc \u628a\u4e0b\u5217\u5934\u6587\u4ef6\u76ee\u5f55\u6dfb\u52a0\u5230\u5de5\u7a0b\u91cc tiny/arch/arm/arm-v7m/common/include/ tiny/arch/arm/arm-v7m/cortex-m4/gcc/ # \u5982\u4e0a\u6240\u8ff0\uff0c\u8fd9\u4e2a\u76ee\u5f55\u89c6\u7279\u5b9a\u82af\u7247\u800c\u5b9a tiny/kernel/core/include/ tiny/kernel/pm/include/ tiny/osal/cmsis_os/ \u5728Inc\u76ee\u5f55\u4e0b\u65b0\u5efa\u4e00\u4e2a\u5934\u6587\u4ef6 tos_config.h ``` #ifndef TOS_CONFIG_H #define TOS_CONFIG_H #include \"stm32l431xx.h\" // \u76ee\u6807\u82af\u7247\u5934\u6587\u4ef6\uff0c\u89c6\u7279\u5b9a\u82af\u7247\u800c\u5b9a #include \"stddef.h\" #define TOS_CFG_TASK_PRIO_MAX 10u // \u914d\u7f6eTencentOS tiny\u9ed8\u8ba4\u652f\u6301\u7684\u6700\u5927\u4f18\u5148\u7ea7\u6570\u91cf #define TOS_CFG_ROUND_ROBIN_EN 1u // \u914d\u7f6eTencentOS tiny\u7684\u5185\u6838\u662f\u5426\u5f00\u542f\u65f6\u95f4\u7247\u8f6e\u8f6c #define TOS_CFG_OBJECT_VERIFY 0u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u6821\u9a8c\u6307\u9488\u5408\u6cd5 #define TOS_CFG_EVENT_EN 1u // TencentOS tiny \u4e8b\u4ef6\u6a21\u5757\u529f\u80fd\u5b8f #define TOS_CFG_MMHEAP_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u52a8\u6001\u5185\u5b58\u6a21\u5757 #define TOS_CFG_MMHEAP_POOL_SIZE 0x100 // \u914d\u7f6eTencentOS tiny\u52a8\u6001\u5185\u5b58\u6c60\u5927\u5c0f #define TOS_CFG_MUTEX_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4e92\u65a5\u9501\u6a21\u5757 #define TOS_CFG_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u961f\u5217\u6a21\u5757 #define TOS_CFG_TIMER_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u8f6f\u4ef6\u5b9a\u65f6\u5668\u6a21\u5757 #define TOS_CFG_SEM_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4fe1\u53f7\u91cf\u6a21\u5757 #if (TOS_CFG_QUEUE_EN > 0u) #define TOS_CFG_MSG_EN 1u #else #define TOS_CFG_MSG_EN 0u #endif #define TOS_CFG_MSG_POOL_SIZE 10u // \u914d\u7f6eTencentOS tiny\u6d88\u606f\u961f\u5217\u5927\u5c0f #define TOS_CFG_IDLE_TASK_STK_SIZE 256u // \u914d\u7f6eTencentOS tiny\u7a7a\u95f2\u4efb\u52a1\u6808\u5927\u5c0f #define TOS_CFG_CPU_TICK_PER_SECOND 1000u // \u914d\u7f6eTencentOS tiny\u7684tick\u9891\u7387 #define TOS_CFG_CPU_CLOCK (SystemCoreClock) // \u914d\u7f6eTencentOS tiny CPU\u9891\u7387 #define TOS_CFG_TIMER_AS_PROC 1u // \u914d\u7f6e\u662f\u5426\u5c06TIMER\u914d\u7f6e\u6210\u51fd\u6570\u6a21\u5f0f #endif ``` \u4fee\u6539 Src/stm32l4xx_it.c \u91cc\u7684\u4ee3\u7801: \u5c06 void PendSV_Handler(void) \u4fee\u6539\u4e3a __weak void PendSV_Handler(void) \u5728 SysTick_Handler \u51fd\u6570\u4e2d HAL_IncTick(); \u4e4b\u540e\u6dfb\u52a0\u4ee3\u7801 if(tos_knl_is_running()) { tos_knl_irq_enter(); tos_tick_handler(); tos_knl_irq_leave(); } \u4fee\u6539 Src/main.c \u6dfb\u52a0\u4ee3\u7801 ``` #include \"cmsis_os.h\" //task1 #define TASK1_STK_SIZE 512 void task1(void *pdata); osThreadDef(task1, osPriorityNormal, 1, TASK1_STK_SIZE); //task2 #define TASK2_STK_SIZE 512 void task2(void *pdata); osThreadDef(task2, osPriorityNormal, 1, TASK2_STK_SIZE); void task1(void *pdata) { while(1) { HAL_GPIO_TogglePin(LED_GPIO_Port, LED_Pin); osDelay(200); } } void task2(void *pdata) { while(1) { osDelay(1000); } } ``` \u6ce8\uff1a\u4ee3\u7801\u4e2d\u7684LED\u662f\u5728\u521b\u5efa\u5de5\u7a0b\u7684GPIO\u9009\u9879\u91cc\u6307\u5b9a\u7684\uff0c\u662f PC13 \u5f15\u811a\uff0c\u8fd9\u4e2a\u662f\u4f9d\u636eTencentOS tiny EVB_MX\u5f00\u53d1\u677f\u800c\u51b3\u5b9a\u7684\uff0c\u76f8\u5e94\u7684\u5f00\u53d1\u677f\u8bf7\u505a\u76f8\u5e94\u8c03\u6574\u3002 \u4e3b\u51fd\u6570\u4ee3\u7801 ``` int main(void) { / USER CODE BEGIN 1 / /* USER CODE END 1 */ /* MCU Configuration--------------------------------------------------------*/ /* Reset of all peripherals, Initializes the Flash interface and the Systick. */ HAL_Init(); /* USER CODE BEGIN Init */ /* USER CODE END Init */ /* Configure the system clock */ SystemClock_Config(); /* USER CODE BEGIN SysInit */ /* USER CODE END SysInit */ /* Initialize all configured peripherals */ MX_GPIO_Init(); /* USER CODE BEGIN 2 */ osKernelInitialize(); //TOS Tiny kernel initialize osThreadCreate(osThread(task1), NULL); // Create task1 osThreadCreate(osThread(task2), NULL); // Create task2 osKernelStart(); //Start TOS Tiny /* USER CODE END 2 */ /* Infinite loop */ /* USER CODE BEGIN WHILE */ while (1) { /* USER CODE END WHILE */ /* USER CODE BEGIN 3 */ } /* USER CODE END 3 */ } ``` \u96441 \u6e05\u7406\u4ee3\u7801\u76ee\u5f55\u547d\u4ee4 ls | egrep -v \"arch|kernel|osal\" | xargs rm -rf rm -rf arch/arm/arm-v7m/cortex-m0+/ rm -rf arch/arm/arm-v7m/cortex-m3/ rm -rf arch/arm/arm-v7m/cortex-m4/armcc/ rm -rf arch/arm/arm-v7m/cortex-m4/iccarm/ rm -rf arch/arm/arm-v7m/cortex-m7/","title":"13.Porting_Manual_for_MacOS_STM32CubeIDE"},{"location":"13.Porting_Manual_for_MacOS_STM32CubeIDE/#tencentos-tinymacosstm32cubeide","text":"","title":"TencentOS tiny\u5185\u6838\u79fb\u690d\u6307\u5357(MacOS+STM32CubeIDE\u7248)"},{"location":"13.Porting_Manual_for_MacOS_STM32CubeIDE/#_1","text":"\u5177\u4f53\u7684\u5de5\u7a0b\u521b\u5efa\u65b9\u6cd5\u548c\u521d\u59cb\u53c2\u6570\u8bbe\u7f6e\u65b9\u6cd5\u7565\u53bb\u3002 \u9700\u8981\u5f3a\u8c03\u7684\u662f\u672c\u6587\u662f\u4ee5 STM32L431 \u82af\u7247\u4e3a\u57fa\u7840\u7684\uff0c\u5982\u679c\u662f\u5176\u5b83\u82af\u7247\uff0c\u540e\u9762\u7684\u6b65\u9aa4\u8bf7\u505a\u76f8\u5e94\u7684\u8c03\u6574\u3002 \u6700\u540e\u751f\u6210\u7684\u5de5\u7a0b\u76ee\u5f55\u5982\u4e0b:","title":"\u4e00\u3001\u5de5\u7a0b\u521b\u5efa"},{"location":"13.Porting_Manual_for_MacOS_STM32CubeIDE/#tencentos-tiny","text":"\u53ea\u9700\u8981\u4fdd\u7559TencentOS\u8fd9\u4e9b\u76ee\u5f55\u4e0b\u7684\u4ee3\u7801\uff0c\u5176\u5b83\u76ee\u5f55\u7686\u53ef\u5220\u9664\u3002 \u5728 arch \u76ee\u5f55\u91cc\u9700\u8981\u5220\u9664\u7684\u6240\u6709\u4ee3\u7801\u76ee\u5f55\u5217\u8868 arch/arm/arm-v7m/cortex-m0+/ arch/arm/arm-v7m/cortex-m3/ arch/arm/arm-v7m/cortex-m4/armcc/ arch/arm/arm-v7m/cortex-m4/iccarm/ arch/arm/arm-v7m/cortex-m7/ \u6ce8: STM32L431\u662fCortex-M4\u5185\u6838\uff0c\u6240\u4ee5\u5982\u679c\u662f\u5176\u5b83\u82af\u7247\uff0c\u4f8b\u5982STM32F103\u5c31\u5e94\u8be5\u5220\u9664 arch/arm/arm-v7m/cortex-m4/ \u76ee\u5f55\uff0c\u4fdd\u7559 arch/arm/arm-v7m/cortex-m3/gcc \u76ee\u5f55\u3002 \u91cd\u547d\u540d\u4ee3\u7801\u9876\u5c42\u76ee\u5f55 $ mv TencentOS_tiny tiny","title":"\u4e8c\u3001TencentOS tiny\u4ee3\u7801\u51c6\u5907"},{"location":"13.Porting_Manual_for_MacOS_STM32CubeIDE/#_2","text":"\u628a\u4ee3\u7801 tiny \u62f7\u8d1d\u5230\u7b2c\u4e00\u6b65\u521b\u5efa\u7684\u5de5\u7a0b\u76ee\u5f55\u91cc \u5237\u65b0\u5de5\u7a0b \u628a\u4ee3\u7801\u6dfb\u52a0\u5230\u5de5\u7a0b\u91cc \u628a\u4e0b\u5217\u5934\u6587\u4ef6\u76ee\u5f55\u6dfb\u52a0\u5230\u5de5\u7a0b\u91cc tiny/arch/arm/arm-v7m/common/include/ tiny/arch/arm/arm-v7m/cortex-m4/gcc/ # \u5982\u4e0a\u6240\u8ff0\uff0c\u8fd9\u4e2a\u76ee\u5f55\u89c6\u7279\u5b9a\u82af\u7247\u800c\u5b9a tiny/kernel/core/include/ tiny/kernel/pm/include/ tiny/osal/cmsis_os/ \u5728Inc\u76ee\u5f55\u4e0b\u65b0\u5efa\u4e00\u4e2a\u5934\u6587\u4ef6 tos_config.h ``` #ifndef TOS_CONFIG_H #define TOS_CONFIG_H #include \"stm32l431xx.h\" // \u76ee\u6807\u82af\u7247\u5934\u6587\u4ef6\uff0c\u89c6\u7279\u5b9a\u82af\u7247\u800c\u5b9a #include \"stddef.h\" #define TOS_CFG_TASK_PRIO_MAX 10u // \u914d\u7f6eTencentOS tiny\u9ed8\u8ba4\u652f\u6301\u7684\u6700\u5927\u4f18\u5148\u7ea7\u6570\u91cf #define TOS_CFG_ROUND_ROBIN_EN 1u // \u914d\u7f6eTencentOS tiny\u7684\u5185\u6838\u662f\u5426\u5f00\u542f\u65f6\u95f4\u7247\u8f6e\u8f6c #define TOS_CFG_OBJECT_VERIFY 0u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u6821\u9a8c\u6307\u9488\u5408\u6cd5 #define TOS_CFG_EVENT_EN 1u // TencentOS tiny \u4e8b\u4ef6\u6a21\u5757\u529f\u80fd\u5b8f #define TOS_CFG_MMHEAP_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u52a8\u6001\u5185\u5b58\u6a21\u5757 #define TOS_CFG_MMHEAP_POOL_SIZE 0x100 // \u914d\u7f6eTencentOS tiny\u52a8\u6001\u5185\u5b58\u6c60\u5927\u5c0f #define TOS_CFG_MUTEX_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4e92\u65a5\u9501\u6a21\u5757 #define TOS_CFG_QUEUE_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u961f\u5217\u6a21\u5757 #define TOS_CFG_TIMER_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u8f6f\u4ef6\u5b9a\u65f6\u5668\u6a21\u5757 #define TOS_CFG_SEM_EN 1u // \u914d\u7f6eTencentOS tiny\u662f\u5426\u5f00\u542f\u4fe1\u53f7\u91cf\u6a21\u5757 #if (TOS_CFG_QUEUE_EN > 0u) #define TOS_CFG_MSG_EN 1u #else #define TOS_CFG_MSG_EN 0u #endif #define TOS_CFG_MSG_POOL_SIZE 10u // \u914d\u7f6eTencentOS tiny\u6d88\u606f\u961f\u5217\u5927\u5c0f #define TOS_CFG_IDLE_TASK_STK_SIZE 256u // \u914d\u7f6eTencentOS tiny\u7a7a\u95f2\u4efb\u52a1\u6808\u5927\u5c0f #define TOS_CFG_CPU_TICK_PER_SECOND 1000u // \u914d\u7f6eTencentOS tiny\u7684tick\u9891\u7387 #define TOS_CFG_CPU_CLOCK (SystemCoreClock) // \u914d\u7f6eTencentOS tiny CPU\u9891\u7387 #define TOS_CFG_TIMER_AS_PROC 1u // \u914d\u7f6e\u662f\u5426\u5c06TIMER\u914d\u7f6e\u6210\u51fd\u6570\u6a21\u5f0f #endif ``` \u4fee\u6539 Src/stm32l4xx_it.c \u91cc\u7684\u4ee3\u7801: \u5c06 void PendSV_Handler(void) \u4fee\u6539\u4e3a __weak void PendSV_Handler(void) \u5728 SysTick_Handler \u51fd\u6570\u4e2d HAL_IncTick(); \u4e4b\u540e\u6dfb\u52a0\u4ee3\u7801 if(tos_knl_is_running()) { tos_knl_irq_enter(); tos_tick_handler(); tos_knl_irq_leave(); } \u4fee\u6539 Src/main.c \u6dfb\u52a0\u4ee3\u7801 ``` #include \"cmsis_os.h\" //task1 #define TASK1_STK_SIZE 512 void task1(void *pdata); osThreadDef(task1, osPriorityNormal, 1, TASK1_STK_SIZE); //task2 #define TASK2_STK_SIZE 512 void task2(void *pdata); osThreadDef(task2, osPriorityNormal, 1, TASK2_STK_SIZE); void task1(void *pdata) { while(1) { HAL_GPIO_TogglePin(LED_GPIO_Port, LED_Pin); osDelay(200); } } void task2(void *pdata) { while(1) { osDelay(1000); } } ``` \u6ce8\uff1a\u4ee3\u7801\u4e2d\u7684LED\u662f\u5728\u521b\u5efa\u5de5\u7a0b\u7684GPIO\u9009\u9879\u91cc\u6307\u5b9a\u7684\uff0c\u662f PC13 \u5f15\u811a\uff0c\u8fd9\u4e2a\u662f\u4f9d\u636eTencentOS tiny EVB_MX\u5f00\u53d1\u677f\u800c\u51b3\u5b9a\u7684\uff0c\u76f8\u5e94\u7684\u5f00\u53d1\u677f\u8bf7\u505a\u76f8\u5e94\u8c03\u6574\u3002 \u4e3b\u51fd\u6570\u4ee3\u7801 ``` int main(void) { / USER CODE BEGIN 1 / /* USER CODE END 1 */ /* MCU Configuration--------------------------------------------------------*/ /* Reset of all peripherals, Initializes the Flash interface and the Systick. */ HAL_Init(); /* USER CODE BEGIN Init */ /* USER CODE END Init */ /* Configure the system clock */ SystemClock_Config(); /* USER CODE BEGIN SysInit */ /* USER CODE END SysInit */ /* Initialize all configured peripherals */ MX_GPIO_Init(); /* USER CODE BEGIN 2 */ osKernelInitialize(); //TOS Tiny kernel initialize osThreadCreate(osThread(task1), NULL); // Create task1 osThreadCreate(osThread(task2), NULL); // Create task2 osKernelStart(); //Start TOS Tiny /* USER CODE END 2 */ /* Infinite loop */ /* USER CODE BEGIN WHILE */ while (1) { /* USER CODE END WHILE */ /* USER CODE BEGIN 3 */ } /* USER CODE END 3 */ } ```","title":"\u4e09\u3001\u79fb\u690d\u5de5\u4f5c"},{"location":"13.Porting_Manual_for_MacOS_STM32CubeIDE/#1","text":"ls | egrep -v \"arch|kernel|osal\" | xargs rm -rf rm -rf arch/arm/arm-v7m/cortex-m0+/ rm -rf arch/arm/arm-v7m/cortex-m3/ rm -rf arch/arm/arm-v7m/cortex-m4/armcc/ rm -rf arch/arm/arm-v7m/cortex-m4/iccarm/ rm -rf arch/arm/arm-v7m/cortex-m7/","title":"\u96441 \u6e05\u7406\u4ee3\u7801\u76ee\u5f55\u547d\u4ee4"},{"location":"14.RISC-V_Eclipse_Environment_Quick_Start/","text":"RISC-V eclipse \u5f00\u53d1\u73af\u5883\u642d\u5efa \u8f6f\u4ef6\u5217\u8868 eclipse riscv toolchain riscv openocd eclipse \u4e0b\u8f7d\u5b89\u88c5\u8fc7\u7a0b\u7565 riscv toolchain \u5728\u4e0b\u8f7d\u9875 https://github.com/gnu-mcu-eclipse/riscv-none-gcc/releases \u9009\u62e9\u76f8\u5e94\u5e73\u53f0\u4e0b\u8f7d\u3002\u5e76\u89e3\u538b\uff0c\u653e\u5230\u5408\u9002\u7684\u76ee\u5f55\u3002 riscv openocd \u7b7e\u51fa\u4ee3\u7801 git clone https://github.com/riscv-mcu/riscv-openocd \u7f16\u8bd1 ./configure --enable-cmsis-dap --enable-ftdi --prefix=\u5b89\u88c5\u76ee\u5f55\u8def\u5f84 make make install \u914d\u7f6eeclipse \u914d\u7f6etoolchain\u8def\u5f84 \u914d\u7f6eopenocd\u8def\u5f84 \u8c03\u8bd5\u8bbe\u7f6e \u6dfb\u52a0\u5982\u4e0b\u4e24\u884c set arch riscv:rv32 set remotetimeout 250 \u5982\u679c\u7528gd-link\u8c03\u8bd5 \u914d\u7f6e\u6587\u4ef6 adapter_khz 1000 reset_config srst_only adapter_nsrst_assert_width 100 interface cmsis-dap transport select jtag #autoexit true set _CHIPNAME riscv jtag newtap $_CHIPNAME cpu -irlen 5 -expected-id 0x1000563d set _TARGETNAME $_CHIPNAME.cpu target create $_TARGETNAME riscv -chain-position $_TARGETNAME $_TARGETNAME configure -work-area-phys 0x20000000 -work-area-size 20480 -work-area-backup 0 # Work-area is a space in RAM used for flash programming if { [info exists WORKAREASIZE] } { set _WORKAREASIZE $WORKAREASIZE } else { set _WORKAREASIZE 0x5000 } # Allow overriding the Flash bank size if { [info exists FLASH_SIZE] } { set _FLASH_SIZE $FLASH_SIZE } else { # autodetect size set _FLASH_SIZE 0 } # flash size will be probed set _FLASHNAME $_CHIPNAME.flash flash bank $_FLASHNAME gd32vf103 0x08000000 0 0 0 $_TARGETNAME riscv set_reset_timeout_sec 1 init halt \u5982\u679c\u7528sipeed riscv debugger\u8c03\u8bd5 \u914d\u7f6e\u6587\u4ef6 adapter_khz 1000 interface ftdi ftdi_device_desc \"Dual RS232\" ftdi_vid_pid 0x0403 0x6010 transport select jtag ftdi_layout_init 0x0008 0x001b ftdi_layout_signal nSRST -oe 0x0020 -data 0x0020 set _CHIPNAME riscv jtag newtap $_CHIPNAME cpu -irlen 5 -expected-id 0x1e200a6d set _TARGETNAME $_CHIPNAME.cpu target create $_TARGETNAME riscv -chain-position $_TARGETNAME $_TARGETNAME configure -work-area-phys 0x20000000 -work-area-size 10000 -work-area-backup 1 set _FLASHNAME $_CHIPNAME.flash flash bank $_FLASHNAME gd32vf103 0x08000000 0 0 0 $_TARGETNAME riscv expose_csrs 3040-3071 init halt # We must turn on this because otherwise the IDE version debug cannot download the program into flash #flash protect 0 0 last off","title":"14.RISC-V_Eclipse_Environment_Quick_Start"},{"location":"14.RISC-V_Eclipse_Environment_Quick_Start/#risc-v-eclipse","text":"","title":"RISC-V eclipse \u5f00\u53d1\u73af\u5883\u642d\u5efa"},{"location":"14.RISC-V_Eclipse_Environment_Quick_Start/#_1","text":"eclipse riscv toolchain riscv openocd","title":"\u8f6f\u4ef6\u5217\u8868"},{"location":"14.RISC-V_Eclipse_Environment_Quick_Start/#eclipse","text":"\u4e0b\u8f7d\u5b89\u88c5\u8fc7\u7a0b\u7565","title":"eclipse"},{"location":"14.RISC-V_Eclipse_Environment_Quick_Start/#riscv-toolchain","text":"\u5728\u4e0b\u8f7d\u9875 https://github.com/gnu-mcu-eclipse/riscv-none-gcc/releases \u9009\u62e9\u76f8\u5e94\u5e73\u53f0\u4e0b\u8f7d\u3002\u5e76\u89e3\u538b\uff0c\u653e\u5230\u5408\u9002\u7684\u76ee\u5f55\u3002","title":"riscv toolchain"},{"location":"14.RISC-V_Eclipse_Environment_Quick_Start/#riscv-openocd","text":"\u7b7e\u51fa\u4ee3\u7801 git clone https://github.com/riscv-mcu/riscv-openocd \u7f16\u8bd1 ./configure --enable-cmsis-dap --enable-ftdi --prefix=\u5b89\u88c5\u76ee\u5f55\u8def\u5f84 make make install","title":"riscv openocd"},{"location":"14.RISC-V_Eclipse_Environment_Quick_Start/#eclipse_1","text":"\u914d\u7f6etoolchain\u8def\u5f84 \u914d\u7f6eopenocd\u8def\u5f84","title":"\u914d\u7f6eeclipse"},{"location":"14.RISC-V_Eclipse_Environment_Quick_Start/#_2","text":"\u6dfb\u52a0\u5982\u4e0b\u4e24\u884c set arch riscv:rv32 set remotetimeout 250","title":"\u8c03\u8bd5\u8bbe\u7f6e"},{"location":"14.RISC-V_Eclipse_Environment_Quick_Start/#gd-link","text":"\u914d\u7f6e\u6587\u4ef6 adapter_khz 1000 reset_config srst_only adapter_nsrst_assert_width 100 interface cmsis-dap transport select jtag #autoexit true set _CHIPNAME riscv jtag newtap $_CHIPNAME cpu -irlen 5 -expected-id 0x1000563d set _TARGETNAME $_CHIPNAME.cpu target create $_TARGETNAME riscv -chain-position $_TARGETNAME $_TARGETNAME configure -work-area-phys 0x20000000 -work-area-size 20480 -work-area-backup 0 # Work-area is a space in RAM used for flash programming if { [info exists WORKAREASIZE] } { set _WORKAREASIZE $WORKAREASIZE } else { set _WORKAREASIZE 0x5000 } # Allow overriding the Flash bank size if { [info exists FLASH_SIZE] } { set _FLASH_SIZE $FLASH_SIZE } else { # autodetect size set _FLASH_SIZE 0 } # flash size will be probed set _FLASHNAME $_CHIPNAME.flash flash bank $_FLASHNAME gd32vf103 0x08000000 0 0 0 $_TARGETNAME riscv set_reset_timeout_sec 1 init halt","title":"\u5982\u679c\u7528gd-link\u8c03\u8bd5"},{"location":"14.RISC-V_Eclipse_Environment_Quick_Start/#sipeed-riscv-debugger","text":"\u914d\u7f6e\u6587\u4ef6 adapter_khz 1000 interface ftdi ftdi_device_desc \"Dual RS232\" ftdi_vid_pid 0x0403 0x6010 transport select jtag ftdi_layout_init 0x0008 0x001b ftdi_layout_signal nSRST -oe 0x0020 -data 0x0020 set _CHIPNAME riscv jtag newtap $_CHIPNAME cpu -irlen 5 -expected-id 0x1e200a6d set _TARGETNAME $_CHIPNAME.cpu target create $_TARGETNAME riscv -chain-position $_TARGETNAME $_TARGETNAME configure -work-area-phys 0x20000000 -work-area-size 10000 -work-area-backup 1 set _FLASHNAME $_CHIPNAME.flash flash bank $_FLASHNAME gd32vf103 0x08000000 0 0 0 $_TARGETNAME riscv expose_csrs 3040-3071 init halt # We must turn on this because otherwise the IDE version debug cannot download the program into flash #flash protect 0 0 last off","title":"\u5982\u679c\u7528sipeed riscv debugger\u8c03\u8bd5"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/","text":"TencentOS tiny\u5b9a\u5236\u5f00\u53d1\u677fEVB_MX+\u5feb\u901f\u5165\u95e8\u6307\u5357 Revision Date Description 1.0 2019-9-15 \u6587\u6863\u521d\u7248 2.0 2020-2-12 \u6587\u6863V2.0 1. \u5b9a\u5236\u5f00\u53d1\u677fEVB_MX+\u786c\u4ef6\u7b80\u4ecb 1.1 \u5f00\u53d1\u677f\u7b80\u4ecb EVB_MX+\u662f\u817e\u8baf\u7269\u8054\u7f51\u64cd\u4f5c\u7cfb\u7edfTencentOS tiny \u56e2\u961f\u8054\u5408\u5357\u4eac\u539a\u5fb7\u7269\u8054\u7f51\u6709\u9650\u516c\u53f8\u8bbe\u8ba1\u7684\u4e00\u6b3e\u7269\u8054\u7f51\u8bc4\u4f30\u677f\uff0c\u7528\u4e8eTencentOS tiny \u57fa\u7840\u5185\u6838\u548cIoT\u7ec4\u4ef6\u529f\u80fd\u4f53\u9a8c\u548c\u8bc4\u4f30\u3002 \u5f00\u53d1\u677f\u529f\u80fd\u56fe\u5982\u4e0b\u6240\u793a\uff1a 1.2 \u5f00\u53d1\u677f\u7279\u6027 CPU \uff1aSTM32L431RCT6, 80MHz\uff0c256K Flash\uff0c64KB SRAM \u663e\u793a\u5c4f \uff1aOLED\uff0c128*32\u5206\u8fa8\u7387 \u7535\u6e90\u7279\u6027 \uff1aMicro USB\u63a5\u53e3\uff0c5V\u4f9b\u7535\uff0c\u5185\u90e8\u67095V\u8f6c3.3V\u7684DCDC\uff0cMCU\u4f9b\u7535\u7535\u538b\u4e3a3.3V\uff0c\u7cfb\u7edfIO\u7535\u538b\u4e5f\u4e3a3.3V \u6309\u952e \uff1a\u4e00\u4e2a\u590d\u4f4d\u6309\u952e\uff0c\u56db\u4e2a\u529f\u80fd\u6309\u952e \u5916\u90e8\u6269\u5c55\u5b58\u50a8 \uff1aSPI FLASH\uff0cTF\u5361 LED\u6307\u793a\u706f \uff1a\u4e0a\u7535\u6307\u793a LED\uff0c\u7ea2\u8272\uff1b\u5145\u7535\u6307\u793a LED\uff0c\u7ea2\u8272\uff1b\u4e00\u4e2a\u7528\u6237\u5b9a\u4e49LED\uff0c\u84dd\u8272 \u8c03\u8bd5\u63a5\u53e3 \uff1aSWD\u5916\u63a5ST-Link\uff0cUART2\u4e32\u53e3\u8fde\u63a5PC XTAL \uff1a8MHz\uff0c32.768KHz \u4f20\u611f\u5668\u6269\u5c55\u63a5\u53e3E53 Interface \uff1a\u652f\u6301E53\u4f20\u611f\u5668\u6848\u4f8b\u6269\u5c55\u677f\uff08\u652f\u6301UART\u3001SPI\u3001IIC\u3001GPIO\u3001ADC\u3001DAC\u7b49\uff09 \u7f51\u7edc\u6a21\u5757\u6269\u5c55\u63a5\u53e3WAN Interface \uff1a\u652f\u6301\u591a\u79cd\u65e0\u7ebf\u901a\u4fe1\u6a21\u7ec4\u6269\u5c55\uff08UART&SPI&GPIO\uff09 \u64cd\u4f5c\u7cfb\u7edf\u652f\u6301 \uff1aTencentOS tiny 1.3 \u5f00\u53d1\u677f\u786c\u4ef6\u8be6\u89e3 1.3.1 \u7535\u6e90\u7535\u8def 1\uff09\u9502\u7535\u6c60\u5145\u653e\u7535\u7535\u6e90\u7ba1\u7406 \u4e3a\u9002\u5e94\u5e7f\u5927\u5f00\u53d1\u8005\u5bf9\u4e8e\u7269\u8054\u7f51\u4f4e\u529f\u8017\u5e94\u7528\u7684\u9700\u6c42\uff0cEVB_MX+\u5f00\u53d1\u677f\u52a0\u5165\u4e86\u9502\u7535\u6c60\u4f9b\u7535\u6a21\u5757\uff0c\u672c\u9502\u7535\u6c60\u4f9b\u7535\u6a21\u5757\u91c7\u7528\u7684\u662fTP5410\u82af\u7247\uff0c\u8be5\u82af\u7247\u662f\u4e00\u6b3e\u5355\u8282\u9502\u7535\u6c60\u4e13\u7528\u7684\u7535\u6c60\u5145\u7535\u53ca5V\u6052\u538b\u5347\u538b\u63a7\u5236\u5668\uff0c\u5145\u7535\u90e8\u5206\u96c6\u9ad8\u7cbe\u5ea6\u7535\u538b\u548c\u5145\u7535\u7535\u6d41\u8c03\u8282\u5668\u3001\u9884\u5145\u3001\u5145\u7535\u72b6\u6001\u6307\u793a\u548c\u5145\u7535\u622a\u6b62\u7b49\u529f\u80fd\u4e8e\u4e00\u4f53\uff0c\u53ef\u4ee5\u8f93\u51fa\u6700\u59271A\u7684\u5145\u7535\u7535\u6d41\u3002\u5347\u538b\u7535\u8def\u91c7\u7528CMOS\u5de5\u827a\u5236\u9020\u7684\u7a7a\u8f7d\u7535\u6d41\u6781\u4f4e\u7684VFM\u5f00\u5173\u578bDC/DC\u5347\u538b\u8f6c\u6362\u5668\uff0c\u5177\u5907\u6781\u4f4e\u7684\u7a7a\u8f7d\u529f\u8017\uff08\u5c0f\u4e8e10uA\uff09\uff0c\u4e14\u5347\u538b\u8f93\u51fa\u9a71\u52a8\u7535\u6d41\u80fd\u529b\u8fbe\u52301A\u3002 \u5728\u4e0b\u56fe\u7684TP5410\u7535\u8def\u4e2d\uff0cVBUS\u4e3aUSB\u63a5\u53e3\u63d0\u4f9b\u7684\u7535\u538b\uff0c\u4e3a\u603b\u7535\u538b\u3002BAT_VCC\u662f\u9502\u7535\u6c60\u5145\u7535\u7535\u538b\uff0c\u8be5\u5f15\u811a\u63a5\u9502\u7535\u6c60\u3002VOUT\u5f15\u811a\u8f93\u51fa+5V\u7535\u538b\uff0c\u8be5\u7535\u538b\u53ef\u7531\u9502\u7535\u6c60\u5347\u538b\u4ea7\u751f\uff0c\u4f9b\u7ed9\u540e\u7eed\u7535\u8def\u4f7f\u7528\u3002 2\uff09\u7535\u6e90\u7a33\u538b\u7535\u8def \u9502\u7535\u6c60\u7535\u6e90\u7ba1\u7406\u7535\u8def\u53ef\u4ee5\u5c063.7V\u9502\u7535\u6c60\u5347\u538b\u81f35V\uff0c\u4f46\u8fd9\u5e76\u4e0d\u80fd\u76f4\u63a5\u4f5c\u4e3a\u7535\u6e90\u7ed9EVB_MX+\u76f4\u63a5\u4f9b\u7535\uff0cEVB_MX+\u4e0a\u7684\u5143\u5668\u4ef6\u4f9b\u7535\u7535\u538b\u8303\u56f4\u666e\u904d\u57281.8V-3.6V\uff0c\u63a8\u8350\u7535\u538b\u5747\u4e3a3.3V\uff0c\uff08BC35\u4f9b\u7535\u8303\u56f4\u662f\uff1a3.1V-4.2V\uff0c\u63a8\u8350\u7535\u538b3.8V\uff0c\u4f7f\u75283.3V\u4e5f\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\uff09\uff0c\u56e0\u6b64\u9700\u8981\u5c065V\u7684\u7535\u5e73\u8f6c\u6362\u62103.3V\u4f9b\u7ed9EVB_MX+\u5f00\u53d1\u677f\u4f7f\u7528\uff0c\u8fd9\u91cc\u4f7f\u7528RT8059\u4f5c\u4e3a3.3V\u7a33\u538b\u5668\u82af\u7247\u3002 RT8059\u662f\u4e00\u6b3e\u9ad8\u6548\u7387\u8109\u51b2\u5bbd\u5ea6\u964d\u538b\u578bDC/DC\u8f6c\u6362\u5668\u3002\u8f93\u5165\u7535\u538b2.8V-5.5V\uff0c\u8f93\u51fa\u7535\u538b\u53ef\u8c03\u8303\u56f4\u4e3a\uff1a0.6V-Vin\uff0c\u8f93\u51fa\u7535\u6d41\u53ef\u4ee5\u8fbe\u52301A\u3002\u5728\u6211\u4eec\u63d0\u4f9b\u7684\u7535\u8def\u4e2d\u5c06\u8f93\u51fa\u8c03\u8282\u81f33.3V\uff0c\u8ba9\u5f00\u53d1\u677f\u6b63\u5e38\u5de5\u4f5c\u3002 1.3.2 STM32\u6700\u5c0f\u7cfb\u7edf\u7535\u8def \u5355\u7247\u673a\u6700\u5c0f\u7cfb\u7edf\u6216\u8005\u53eb\u6700\u5c0f\u786c\u4ef6\u5355\u5143\u7535\u8def\uff0c\u6307\u7528\u6700\u5c11\u5143\u5668\u4ef6\u7ec4\u6210\u7684\u5355\u7247\u673a\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u7684\u7cfb\u7edf\u3002\u6700\u5c0f\u7cfb\u7edf\u57fa\u672c\u7531\u7535\u6e90\u3001\u5355\u7247\u673a\u3001\u6676\u632f\u3001\u590d\u4f4d\u7535\u8def\u3001\u7a0b\u5e8f\u70e7\u5f55\u63a5\u53e3\u7ec4\u6210\uff0c\u7535\u6e90\u4f7f\u75283.3V\u76f4\u63a5\u4f9b\u7535\uff0c\u5176\u4ed6\u90e8\u5206\u539f\u7406\u56fe\u5982\u4e0b\uff1a 1.3.3 USB\u7535\u5e73\u8f6c\u6362\u7535\u8def USB\u7535\u5e73\u8f6c\u6362\u7535\u8def\u662f\u7528\u4e8eMCU\u548cPC\u901a\u4fe1\u7684\u573a\u666f\u4e2d\u3002PC\u673a\u4e0a\u7684\u901a\u4fe1\u63a5\u53e3\u4f7f\u7528USB\u63a5\u53e3\uff0c\u76f8\u5e94\u7684\u7535\u5e73\u903b\u8f91\u9700\u8981\u9075\u7167USB\u7535\u5e73\u89c4\u5219\uff0c\u800cMCU\u7684\u4e32\u884c\u901a\u4fe1\u63a5\u53e3\u662f\u4e32\u53e3\uff0c\u76f8\u5e94\u7535\u5e73\u9700\u8981\u9075\u5faaTTL\u539f\u5219\u3002\u4e3a\u4e86\u4f7f\u4e24\u8005\u53ef\u4ee5\u4e92\u76f8\u901a\u4fe1\uff0c\u5c31\u9700\u8981\u4e00\u4e2a\u7535\u5e73\u8f6c\u6362\u5668\uff0cEVB_MX+\u4e0a\u4f7f\u7528\u4e86CH340\u82af\u7247\u4f5c\u4e3a\u8f6c\u6362\u5668\uff0cCH340\u5916\u56f4\u53ea\u9700\u8981\u63a5\u5f88\u5c11\u7684\u5143\u5668\u4ef6\u5373\u53ef\u4ee5\u5b9e\u73b0USB\u603b\u7ebf\u8f6c\u63a5\uff0c\u4f7f\u7528\u975e\u5e38\u65b9\u4fbf\u4e5f\u5e7f\u6cdb\u8fd0\u7528\u5728USB\u8f6cTTL\u5de5\u5177\u4e0a\uff0c\u7535\u8def\u5982\u4e0b\uff1a 1.3.4 OLED\u663e\u793a\u7535\u8def OLED\u6db2\u6676\u663e\u793a\u6a21\u5757\u7528\u6765\u5411\u7528\u6237\u663e\u793a\u7cfb\u7edf\u72b6\u6001\u3001\u53c2\u6570\u6216\u8005\u8981\u8f93\u5165\u7cfb\u7edf\u7684\u529f\u80fd\u3002\u4e3a\u4e86\u5c55\u793a\u826f\u597d\u7684\u89c6\u89c9\u6548\u679c\uff0c\u6a21\u5757\u4f7f\u7528SSD1306\u9a71\u52a8\u7684OLED\u663e\u793a\u5c4f\uff0c\u5206\u8fa8\u7387\u4e3a128*32\u3002SSD1306\u82af\u7247\u4e13\u4e3a\u5171\u9634\u6781OLED\u9762\u677f\u8bbe\u8ba1\uff0c\u5d4c\u5165\u4e86\u5bf9\u6bd4\u63a7\u5236\u5668\u3001\u663e\u793aRAM\u548c\u6676\u632f\uff0c\u5e76\u51cf\u5c11\u4e86\u5916\u90e8\u5668\u4ef6\u548c\u529f\u8017\uff0c\u6709256\u7ea7\u4eae\u5ea6\u63a7\u5236\u3002 \u8be5\u6b3eOLED\u4f7f\u7528IIC\u63a5\u53e3\uff0c\u7531\u4e8eIIC\u63a5\u53e3\u7a7a\u95f2\u65f6\u5f15\u811a\u8981\u4e0a\u62c9\uff0c\u56e0\u6b64\u4e0b\u9762\u7684\u539f\u7406\u56fe\u4e2d\u63a5\u4e8610k\u7535\u963b\u4e0a\u62c9\uff0c\u7136\u540e\u624d\u63a5\u5165MCU\u5f15\u811a\u3002 1.3.5 \u7528\u6237\u6309\u952e \u5f00\u53d1\u677f\u5e26\u6709\u4e00\u4e2a\u7cfb\u7edfReset\u6309\u952e\uff0c\u548c\u56db\u4e2a\u529f\u80fd\u6309\u952e\u3002\u590d\u4f4d\u6309\u952e\u662f\u76f4\u63a5\u63a5\u5165STM32L431\u548cMCU\u7684\u786c\u4ef6\u590d\u4f4dPin\uff0c\u6309\u4e0b\u590d\u4f4d\u6309\u952e\uff0c\u7cfb\u7edf\u81ea\u52a8\u91cd\u542f\u590d\u4f4d\u3002\u529f\u80fd\u6309\u952e\u53ef\u4ee5\u63d0\u4f9b\u7ed9\u5f00\u53d1\u8005\u505a\u529f\u80fd\u5b9a\u4e49\u5f00\u53d1\uff0c\u90fd\u662f\u4f7f\u7528GPIO\u53e3\uff0c\u65b9\u5411\u4e3a\u8f93\u5165\uff0c\u4f4e\u7535\u5e73\u6709\u6548\u3002\u5176\u539f\u7406\u56fe\u5982\u4e0b\u56fe\u6240\u793a\u3002 1.3.6 LED\u7a0b\u5e8f\u6307\u793a\u706f \u4e3a\u4e86\u65b9\u4fbf\u9879\u76ee\u5f00\u53d1\u8c03\u8bd5\uff0cEVB_MX\u5f00\u53d1\u677f\u63a5\u51fa\u6765\u4e00\u4e2aLED\u706f\uff0c\u4f9b\u7528\u6237\u81ea\u5df1\u8bbe\u7f6e\u72b6\u6001\u4f7f\u7528\uff0c\u8be5LED\u706f\u63a5MCU\u7684PC13\u5f15\u811a\uff0c\u5f53PC13\u5f15\u811a\u8f93\u51fa\u9ad8\u7535\u5e73\u65f6\uff0c\u4f1a\u70b9\u4eaeLED\u706f\u3002 1.3.7 Flash\u5b58\u50a8\u7535\u8def\u6269\u5c55 \u5f00\u53d1\u677f\u5e26\u6709\u4e00\u4e2aSPI Nor Flash\u82af\u7247\u6269\u5c55\uff0c\u7528\u6237\u5b58\u50a8\u4e00\u90e8\u5206\u7528\u6237\u6570\u636e\u548c\u5b58\u50a8\u7a7a\u95f4\u6269\u5c55\uff0c\u7535\u8def\u56fe\u5982\u4e0b\uff1a 1.3.8 Flash\u5b58\u50a8\u7535\u8def\u6269\u5c55 \u5f00\u53d1\u677f\u5e26\u6709\u4e00\u4e2amicro tf\u5361\u6269\u5c55\uff0c\u53ef\u7528\u4e8e\u5b58\u50a8\u7a7a\u95f4\u6269\u5c55\uff0c\u6587\u4ef6\u7cfb\u7edf\u7ec4\u4ef6\u6d4b\u8bd5\u7b49\uff0c\u7535\u8def\u56fe\u5982\u4e0b\uff1a 1.3.9 E53 \u4f20\u611f\u5668\u6269\u5c55\u63a5\u53e3 \u5f00\u53d1\u677f\u8bbe\u8ba1\u6709E53\u63a5\u53e3\u7684\u4f20\u611f\u5668\u6269\u5c55\u677f\u63a5\u53e3\uff0c\u8be5\u63a5\u53e3\u53ef\u517c\u5bb9\u6240\u6709E53\u63a5\u53e3\u7684\u4f20\u611f\u5668\u6269\u5c55\u677f\uff0c\u5b9e\u73b0\u4e0d\u540c\u7269\u8054\u7f51\u6848\u4f8b\u573a\u666f\u7684\u5feb\u901f\u642d\u5efa\u3002\u8be5\u63a5\u53e3\u53ef\u63a5\u5165UART\u3001SPI\u3001I2C\u3001ADC\u7b49\u901a\u4fe1\u534f\u8bae\u7684\u4f20\u611f\u5668\uff0c\u5176\u539f\u7406\u56fe\u5982\u4e0b\u56fe\u6240\u793a\u3002 1.3.10 WAN\u901a\u4fe1\u6a21\u5757\u6269\u5c55\u63a5\u53e3 \u5f00\u53d1\u677f\u8bbe\u8ba1\u6709\u901a\u4fe1\u6269\u5c55\u677f\u7684\u6269\u5c55\u63a5\u53e3\uff0c\u8be5\u63a5\u53e3\u53ef\u63a5\u5165WIFI\u3001NB-IoT\u30012G\u3001\u817e\u8baf\u5b9a\u5236IoT\u6a21\u7ec4\u3001LoRaWAN\u7b49\u4e0d\u540c\u901a\u4fe1\u65b9\u5f0f\u7684\u901a\u4fe1\u6269\u5c55\u677f\uff0c\u4ee5\u6ee1\u8db3\u4e0d\u540c\u573a\u666f\u4e0a\u4e91\u7684\u9700\u6c42\uff0c\u5176\u539f\u7406\u56fe\u5982\u4e0b\u56fe\u6240\u793a\u3002 1.3.11\u5f00\u53d1\u677f\u90e8\u5206\u5f15\u811a\u548c\u6a21\u5757\u6620\u5c04\u5173\u7cfb 1.4 \u5f00\u53d1\u677f\u5f00\u7bb1\u5b89\u88c5\u6307\u5357 1.4.1 \u68c0\u67e5\u914d\u5957\u8bbe\u5907 \u6253\u5f00\u5f00\u53d1\u5957\u4ef6\u7bb1\u5b50\u540e\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u5728\u7bb1\u5b50\u5de6\u4fa7\u627e\u5230\u5f00\u53d1\u677f\u4e3b\u677f\uff0c\u53f3\u4fa7\u653e\u4e86\u4e00\u4e2aWAN\u53e3wifi\u6269\u5c55\u677fESP8266\u3001STlink\u4e0b\u8f7d\u5668\u3001\u548c\u4e00\u4e2a\u4f20\u611f\u5668\u6269\u5c55\u677f\uff0c\u53ef\u80fd\u662f\uff08E53_SC1\u667a\u6167\u57ce\u5e02\u706f\u5149\u6a21\u5757\u3001E53_SF1\u667a\u6167\u6d88\u9632\u70df\u611f\u6a21\u5757\u3001E53_IA1\u667a\u6167\u519c\u4e1a\u6a21\u5757\uff09\u5176\u4e2d\u4e00\u4e2a\uff08\u6807\u914d\u4ec5\u4e00\u4e2a\u4f20\u611f\u6269\u5c55\u677f\uff0c\u5982\u9700\u8981\u66f4\u591a\u4f20\u611f\u6269\u5c55\u677f\u53ef\u81ea\u884c\u627e\u5408\u4f5c\u4f9b\u5e94\u5546\uff08\u7269\u8054\u7f51\u4ff1\u4e50\u90e8\uff09\u8d2d\u4e70\uff09\uff0c\u5982\u4e0a\u56fe\u6240\u793a\u3002 1.4.2 \u5b89\u88c5WAN\u53e3WiFi\u6a21\u5757 1.4.3 \u5b89\u88c5\u4f20\u611f\u5668\u6269\u5c55\u677f \u6839\u636e\u60a8\u5f00\u53d1\u5957\u4ef6\u914d\u5957\u7684\u4f20\u611f\u6269\u5c55\u677f\u5b89\u88c5\u5176\u4e2d\u4e00\u4e2a\u5373\u53ef\u3002 1.4.4 \u8fde\u63a5Micor USB\u7ebf Micro USB\u7ebf\u7684\u529f\u80fd\u662f\u4f9b\u7535\u53ca\u8c03\u8bd5\uff0c\u5c06\u7ebf\u4e00\u5934\u4e0e\u5f00\u53d1\u677f\u7684Micro\u63a5\u53e3\u8fde\u63a5\uff0c\u53e6\u4e00\u5934\u63a5\u5230\u7535\u8111\u7684USB\u53e3\u4e0a\u3002 1.4.5 \u8fde\u63a5ST-Link\u7a0b\u5e8f\u4e0b\u8f7d\u5668 \u628a\u5f00\u53d1\u677f\u5185\u63d0\u4f9b\u7684\u914d\u5957\u4e0b\u8f7d\u7ebf\u63a5\u5728\u5f00\u53d1\u677f\u7684\u7a0b\u5e8f\u4e0b\u8f7d\u63a5\u53e3\uff08SWD\u53e3\uff09\uff0c\u53e6\u4e00\u7aef\u4e0eST-Link\u7a0b\u5e8f\u4e0b\u8f7d\u5668\u5bf9\u5e94\u5f15\u811a\u76f8\u8fde\uff0c\u6ce8\u610f\u8fde\u63a5\u7d27\u5bc6\uff0c\u9632\u6b62\u63a5\u89e6\u4e0d\u826f\uff0c\u7ea2\u8272\u4e3aVCC\uff0c\u4e00\u5b9a\u53c2\u8003\u4e0b\u56fe\u8fdb\u884c\u8fde\u63a5\uff0c\u4e0d\u8981\u63a5\u9519\u3002 2. \u5b9a\u5236\u5f00\u53d1\u677fEVB_MX+\u8f6f\u4ef6\u5f00\u53d1\u73af\u5883\u51c6\u5907 2.1 MDK\u8f6f\u4ef6\u4ecb\u7ecd MDK \u5373RealView MDK \u6216MDK-ARM\uff08Microcontroller Development kit\uff09\uff0c\u662f ARM \u516c\u53f8\u6536\u8d2dKeil\u516c\u53f8\u4ee5\u540e\uff0c\u57fa\u4e8euVision\u754c\u9762\u63a8\u51fa\u7684\u9488\u5bf9ARM7\u3001ARM9\u3001Cortex-M0\u3001Cortex-M1\u3001Cortex-M2\u3001Cortex-M3\u3001Cortex-R4\u7b49ARM\u5904\u7406\u5668\u7684\u5d4c\u5165\u5f0f\u8f6f\u4ef6\u5f00\u53d1\u5de5\u5177\u3002MDK-ARM \u96c6\u6210\u4e86\u4e1a\u5185\u6700\u9886\u5148\u7684\u6280\u672f\uff0c\u5305\u62ec uVision4 \u96c6\u6210\u5f00\u53d1\u73af\u5883\u4e0e RealView \u7f16\u8bd1\u5668RVCT\u3002\u652f\u6301 ARM7\u3001ARM9 \u548c\u6700\u65b0\u7684Cortex-M3/M1/M0 \u6838\u5904\u7406\u5668\uff0c\u81ea\u52a8\u914d\u7f6e\u542f\u52a8\u4ee3\u7801\uff0c\u96c6\u6210 Flash \u70e7\u5199\u6a21\u5757\uff0c\u5f3a\u5927\u7684 Simulation \u8bbe\u5907\u6a21\u62df\uff0c\u6027\u80fd\u5206\u6790\u7b49\u529f\u80fd\uff0c\u4e0e ARM \u4e4b\u524d\u7684\u5de5\u5177\u5305 ADS \u7b49\u76f8\u6bd4\uff0cRealView \u7f16\u8bd1\u5668\u7684\u6700\u65b0\u7248\u672c\u53ef\u5c06\u6027\u80fd\u6539\u5584\u8d85\u8fc7 20%\u3002 Keil\u516c\u53f8\u5f00\u53d1\u7684ARM\u5f00\u53d1\u5de5\u5177MDK\uff0c\u662f\u7528\u6765\u5f00\u53d1\u57fa\u4e8eARM\u6838\u7684\u7cfb\u5217\u5fae\u63a7\u5236\u5668\u7684\u5d4c\u5165\u5f0f\u5e94\u7528\u7a0b\u5e8f\u3002\u5b83\u9002\u5408\u4e0d\u540c\u5c42\u6b21\u7684\u5f00\u53d1\u8005\u4f7f\u7528\uff0c\u5305\u62ec\u4e13\u4e1a\u7684\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u5de5\u7a0b\u5e08\u548c\u5d4c\u5165\u5f0f\u8f6f\u4ef6\u5f00\u53d1\u7684\u5165\u95e8\u8005\u3002MDK\u5305\u542b\u4e86\u5de5\u4e1a\u6807\u51c6\u7684Keil C\u7f16\u8bd1\u5668\u3001\u5b8f\u6c47\u7f16\u5668\u3001\u8c03\u8bd5\u5668\u3001\u5b9e\u65f6\u5185\u6838\u7b49\u7ec4\u4ef6\uff0c\u652f\u6301\u6240\u6709\u57fa\u4e8eARM\u7684\u8bbe\u5907\uff0c\u80fd\u5e2e\u52a9\u5de5\u7a0b\u5e08\u6309\u7167\u8ba1\u5212\u5b8c\u6210\u9879\u76ee\u3002 2.2 MDK\u5b89\u88c5 \u767b\u5f55MDK\u5b98\u7f51\uff0c\u4e0b\u8f7dMDK5\u8f6f\u4ef6\uff0c\u4e0b\u8f7d\u5730\u5740\uff1a http://www2.keil.com/mdk5 \u6216\u8005 https://www.keil.com/download/product/ \u4e0b\u8f7d\u7684\u7248\u672c\u6700\u597d\u57285.24\u4ee5\u4e0a\uff0c\u672c\u5f00\u53d1\u6559\u7a0b\u4ee55.24\u7248\u672c\u4e3a\u4f8b\uff0c\u53cc\u51fbMDK524\u5e94\u7528\u7a0b\u5e8f\u6587\u4ef6\uff0c\u70b9\u51fbnext>>\u3002 \u6253\u4e0a I agree\u524d\u9762\u7684\u52fe\u52fe\uff0c\u5373\u662f\u540c\u610f\u4e00\u4e9b\u5b89\u88c5\u534f\u8bae\u3002\u70b9\u51fbnext>>\u3002 \u9009\u62e9\u5b89\u88c5\u8def\u5f84\uff0c\u53ef\u4ee5\u9ed8\u8ba4\u4e5f\u53ef\u4ee5\u5b89\u88c5\u5728\u6211\u4eec\u81ea\u5df1\u5efa\u7acb\u7684\u6587\u4ef6\u5939\u4e0b\u3002\u70b9\u51fbnext>>\u3002 \u8fd9\u91cc\u586b\u5199\u7684\u662f\u6211\u4eec\u7684\u4e00\u4e9b\u4fe1\u606f\uff0c\u586b\u5199\u5b8c\u6574\u540e\uff0c\u7ee7\u7eednext>>\u3002 \u7136\u540e\u7b49\u5f85\u5b89\u88c5\u5b8c\u6210\u5373\u53ef\u3002 \u5b89\u88c5\u5b8c\u6210\uff0c\u70b9\u51fbFinish\u3002 \u7136\u540e\u4f1a\u8df3\u51fa\u6765\u8fd9\u4e2a\u754c\u9762\uff0c\u8fd9\u4e2a\u6211\u4eec\u540e\u9762\u518d\u8bb2\uff0c\u5148\u70b9OK\uff0c\u628a\u5f39\u6846\u90fd\u53c9\u6389\u3002 \u6fc0\u6d3bMDK\uff0c\u5bfc\u5165License,\u6fc0\u6d3bMDK\u540e\u4fbf\u53ef\u4f7f\u7528\u4e86\u3002 \u7279\u522b\u63d0\u793a\uff1a\u4e00\u5b9a\u8981\u8f93\u5165License\u6fc0\u6d3bMDK\u8f6f\u4ef6\uff0c\u5efa\u8bae\u8d2d\u4e70\u6b63\u7248License\u3002 2.3 MDK\u5b89\u88c5 \u5b89\u88c5\u5b8cMDK\u540e\uff0c\u6211\u4eec\u9700\u8981\u5b89\u88c5\u5f00\u53d1\u5957\u4ef6\u4e2d\u5355\u7247\u673a\u578b\u53f7\u5bf9\u5e94\u7684Pack\u3002 \u5b89\u88c5\u65b9\u5f0f\u4e00 \u767b\u5f55\u5b98\u7f51\uff1ahttp://www.keil.com/dd2/pack/ \u4e0b\u8f7dKeil.STM32L4xx_DFP.2.0.0.pack \u540e\u5b89\u88c5\uff0c\u5982\u4e0b\u56fe \u5b89\u88c5\u65b9\u5f0f\u4e8c MDK\u8f6f\u4ef6\u4e0a\u5728\u7ebf\u5b89\u88c5 \u6253\u5f00\u8f6f\u4ef6\uff0c\u5728\u5bfc\u822a\u680f\u6253\u5f00Pack\u5b89\u88c5\u754c\u9762\uff0c\u7136\u540e\u9009\u62e9ok\u9009\u9879\u3002 \u8fdb\u5165\u5728\u7ebf\u5b89\u88c5\u754c\u9762\uff0c\u9009\u7740STM32L4XX Pack,\u70b9\u51fbInstall\u8fdb\u884c\u5b89\u88c5\u3002 \u81f3\u6b64\uff0c\u6211\u4eec\u5f00\u53d1\u677f\u7684\u5355\u7247\u673a\u7a0b\u5e8f\u5f00\u53d1\u73af\u5883\u5df2\u7ecf\u642d\u5efa\u5b8c\u6bd5\uff0c\u91cd\u542fMDK\u8f6f\u4ef6\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002 2.4 ST-Link\u9a71\u52a8\u5b89\u88c5 \u524d\u9762\u8bb2\u4e86\u5f00\u53d1\u677f\u5355\u7247\u673a\u7a0b\u5e8f\u7684\u5f00\u53d1\u73af\u5883\u7684\u642d\u5efa\uff0c\u4f46\u662f\u4e3a\u4e86\u5c06\u7a0b\u5e8f\u70e7\u5f55\u5230\u5f00\u53d1\u677f\u4e2d\u6211\u4eec\u8fd8\u9700\u8981\u4f7f\u7528\u4eff\u771f\u5668\u3002\u6211\u4eec\u8fd9\u5957\u5f00\u53d1\u677f\u9009\u7528ST\u516c\u53f8\u7684ST-Link V2\u4eff\u771f\u5668\u8fdb\u884c\u5f00\u53d1\u677f\u7a0b\u5e8f\u7684\u70e7\u5199\u548c\u4eff\u771f\uff0c\u4e0b\u9762\u4ecb\u7ecdST-Link\u9a71\u52a8\u7684\u5b89\u88c5\u53ca\u73af\u5883\u642d\u5efa\u3002 \u5728ST\u5b98\u7f51\u4e0b\u8f7dST-Link\u9a71\u52a8\uff0c https://www.st.com/content/st_com/zh/products/development-tools/software-development-tools/stm32-software-development-tools/stm32-utilities/stsw-link009.html \uff08\u9a71\u52a8\u67092\u79cd\uff1a 32\u4f4d\u7535\u8111\u7cfb\u7edf\u5b89\u88c5\u201cdpinst_x86\u201d\u300164\u4f4d\u7535\u8111\u7cfb\u7edf\u5b89\u88c5\u201cdpinst_amd64\u201d\uff09\u3002 \u8fd0\u884c\u5bf9\u5e94\u7684\u9a71\u52a8\uff0c\u5b89\u88c5ST-Link V2\u9a71\u52a8\u7a0b\u5e8f\u3002\u5b89\u88c5\u8def\u5f84\u5c3d\u91cf\u4fdd\u6301\u9ed8\u8ba4\u8def\u5f84\u3002 \u5b89\u88c5\u5b8c\u6210\u540e, \u5c06ST-Link\u901a\u8fc7USB\u63a5\u53e3\u8fde\u5165\u7535\u8111\u3002\u6253\u5f00\u201c\u8bbe\u5907\u7ba1\u7406\u5668\u201d\u3002\u82e5\u770b\u5230\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u8868\u793a\u9a71\u52a8\u5b89\u88c5\u6210\u529f\u3002 \u8fd9\u91cc\u63d0\u9192 2 \u70b9: 1\uff0c \u5404\u79cd windows \u7248\u672c\u8bbe\u5907\u540d\u79f0\u548c\u6240\u5728\u8bbe\u5907\u7ba1\u7406\u5668\u680f\u76ee\u53ef\u80fd\u4e0d\u4e00\u6837\uff0c\u4f8b\u5982 WIN10 \u63d2\u4e0aSTLINK \u540e\u663e\u793a\u7684\u662f STM32 STLINK\u3002 2\uff0c \u5982\u679c\u8bbe\u5907\u540d\u79f0\u65c1\u8fb9\u663e\u793a\u7684\u662f\u9ec4\u8272\u7684\u53f9\u53f7\uff0c\u8bf7\u76f4\u63a5\u70b9\u51fb\u8bbe\u5907\u540d\u79f0\uff0c\u7136\u540e\u5728\u5f39\u51fa\u7684\u754c\u9762\u70b9\u51fb\u66f4\u65b0\u8bbe\u5907\u9a71\u52a8 \u81f3\u6b64\uff0c ST-Link \u9a71\u52a8\u5df2\u7ecf\u5b89\u88c5\u5b8c\u6210\u3002\u63a5\u4e0b\u6765\u5927\u5bb6\u53ea\u9700\u8981\u5728 MDK\u5de5\u7a0b\u91cc\u9762\u914d\u7f6e\u4e00\u4e0b ST-Link\u5373\u53ef\u3002 2.5 \u7f16\u7a0b\u8f6f\u4ef6(MDK)\u914d\u7f6e \u5b89\u88c5\u9a71\u52a8\u6210\u529f\u540e\uff0c\u6253\u5f00MDK\u8f6f\u4ef6\uff0c\u914d\u7f6e\u7a0b\u5e8f\u70e7\u5199\u548c\u4eff\u771f\u7684\u73af\u5883\u3002 \u70b9\u51fb\u8fdb\u5165\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\u6309\u7ebd\uff0c\u8fdb\u5165\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\u3002 \u9009\u62e9Debug\u9009\u9879\uff0c\u8fdb\u5165\u4eff\u771f\u5668\u8bbe\u7f6e\u754c\u9762\u3002 \u4e0b\u62c9\u4eff\u771f\u5668\u9009\u62e9\u5217\u8868\uff0c\u9009\u7740ST-Link Debugger\u5e76\u52fe\u9009\u53f3\u4fa7Use,\u70b9\u51fbSettings\u8fdb\u5165ST-Link V2\u4eff\u771f\u5668\u914d\u7f6e\u754c\u9762\u3002 \u5f00\u53d1\u677f\u8bbe\u8ba1\u7684\u7a0b\u5e8f\u70e7\u5f55\u65b9\u5f0f\u4e3aSW\uff0c\u6b64\u5904Unit\u9009\u62e9ST-Link/V2,\u4e14Port\u9009\u62e9SW,\u5e76\u786e\u8ba4\u53f3\u4fa7\u6846\u5185\u662f\u5426\u68c0\u6d4b\u51faSW\u8bbe\u5907\uff0c\u70b9\u51fb<\u786e\u8ba4>\u4fdd\u5b58\u914d\u7f6e\u3002 2.6 CH340\u4e32\u53e3\u9a71\u52a8\u5b89\u88c5 \u4e92\u8054\u7f51\u641c\u7d22\u4e0b\u8f7dCH340 \u4e32\u53e3\u82af\u7247\u7684\u9a71\u52a8 \u5b89\u88c5\u65b9\u6cd5\uff1a\u6253\u5f00\u9a71\u52a8\u5b89\u88c5\u7a0b\u5e8f\u70b9\u51fb\u5b89\u88c5\u5373\u53ef\u3002 \u6ce8\uff1a\u82e5\u5b89\u88c5\u5931\u8d25\uff0c\u8bf7\u5148\u70b9\u51fb\u5378\u8f7d\uff0c\u540e\u70b9\u51fb\u5b89\u88c5\u3002 2.7 \u4e32\u53e3\u8c03\u8bd5\u52a9\u624b\u7684\u5b89\u88c5\u4e0e\u4f7f\u7528 \u5de5\u5177\u4e0b\u8f7d\uff1a http://www.daxia.com/download/sscom.rar \u5b89\u88c5\u65b9\u6cd5\uff1a\u4e32\u53e3\u8c03\u8bd5\u52a9\u624bsscom5.13.1\u662f\u514d\u5b89\u88c5\u7684\uff0c\u89e3\u538b\u51fa\u538b\u7f29\u5305\u5373\u53ef\u76f4\u63a5\u4f7f\u7528\u3002 \u6839\u636ePC\u548c\u7ec8\u7aef\u4e4b\u95f4\u7684\u8fde\u63a5\uff0c\u9009\u62e9\u6b63\u786e\u7684\u4e32\u884c\u7aef\u53e3\u3002 \u6253\u5f00\u7535\u8111\u7684\u8bbe\u5907\u7ba1\u7406\u5668\uff0c\u5728\u7aef\u53e3\u5217\u8868\u53ef\u4ee5\u770b\u5230PC\u4e0e\u5f00\u53d1\u677f\u8fde\u63a5\u7684\u7aef\u53e3\u53f7\u3002 \u6211\u8fd9\u91cc\u663e\u793a\u7684\u662fCOM6\uff0c\u6240\u4ee5\u8981\u5728sscom\u5de5\u5177\u4e2d\u9009\u62e9COM6\uff0c\u5f00\u53d1\u677f\u7a0b\u5e8f\u6ce2\u7279\u7387\u8bbe\u7f6e\u4e3a115200\uff0c\u6240\u4ee5\u6211\u5728sscom\u4e32\u53e3\u5de5\u5177\u4e2d\u9009\u62e9115200\u6ce2\u7279\u7387\u3002 3. TencentOS tiny \u57fa\u7840\u5185\u6838\u5b9e\u9a8c 3.1 \u6253\u5f00 TencentOS tiny\u63d0\u4f9b\u7684 Hello_world \u5de5\u7a0b TencentOS tiny\u5b98\u65b9\u5f00\u6e90\u4ed3\u4e0b\u8f7d\u6e90\u7801\uff0c\u5730\u5740\u4e3a\uff1a https://github.com/Tencent/TencentOS-tiny \u8fdb\u5165 < TencentOS-tiny/board/TencentOS_tiny_EVB_MX_Plus/KEIL/hello_world> \u76ee\u5f55\uff0c\u6253\u5f00TencentOS_tiny.uvprojx\u5de5\u7a0b\uff1a 3.2 \u7f16\u8bd1HelloWorld\u5de5\u7a0b \u6253\u5f00\u5de5\u7a0b\u540e\uff0c\u6211\u4eec\u5728\u5de6\u4fa7\u7684\u5de5\u7a0b\u6587\u4ef6\u5bfc\u822a\u9875\u9762\u5c55\u5f00examples\u76ee\u5f55\uff0c\u53ef\u4ee5\u770b\u5230helloworld.c\u6e90\u7801\uff0c\u8fd9\u91cc\u521b\u5efa\u4e86\u4e24\u4e2aTencentOS tiny\u7684\u4efb\u52a1\uff0c\u4ea4\u66ff\u8fd0\u884c\u6253\u5370\u4efb\u52a1\u3002\u5f00\u53d1\u8005\u5b89\u88c5\u4e0b\u56fe\u6307\u793a\uff0c\u70b9\u51fb\u7f16\u8bd1\u6309\u94ae\u5373\u53ef\u7f16\u8bd1\u5de5\u7a0b\uff0c\u5982\u56fe\uff1a 3.3 \u4e0b\u8f7d\u8fd0\u884c \u9996\u5148\u9700\u8981\u914d\u7f6e\u4e0b\u8f7d\u73af\u5883 \u6309\u4e0b\u56fe\u6240\u793a\u914d\u7f6e\u4e0b\u8f7d\u53c2\u6570 \u7f16\u8bd1\u5b8c\u6210\u540e\u70b9\u51fb\u5982\u56fe\u6240\u793a\u201dLOAD\u201d\u6309\u94ae\u4e0b\u8f7d\u7a0b\u5e8f\u5373\u53ef\u3002 3.4 \u67e5\u770b\u8fd0\u884c\u7ed3\u679c \u8fde\u63a5\u597d\u4e32\u53e3\uff0c\u5728PC\u7684\u4e32\u53e3\u52a9\u624b\u4e2d\u53ef\u4ee5\u770b\u5230TencentOS tiny\u7684\u4e24\u4e2a\u4efb\u52a1\u4ea4\u66ff\u8fd0\u884c\uff0c\u6253\u5370\u6d88\u606f\u5e76\u5b8c\u6210\u4efb\u52a1\u8ba1\u6570\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u66f4\u591aTencentOS tiny\u57fa\u7840\u5185\u6838\u7684\u4f7f\u7528\uff0c\u8bf7\u53c2\u8003\u5185\u6838\u5f00\u53d1\u6307\u5357\u6587\u6863\uff1a - TencentOS tiny\u5185\u6838\u5f00\u53d1\u6307\u5357 - TencentOS tiny API\u53c2\u8003 4. \u4f7f\u7528TencentOS tiny\u5b9a\u5236\u5f00\u53d1\u677f\u5bf9\u63a5\u817e\u8baf\u4e91IoT Explorer 4.1 \u5165\u95e8\u6982\u8ff0 \u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u7684\u7528\u6237\uff0c\u53ef\u4ee5\u901a\u8fc7\u5feb\u901f\u5165\u95e8\u7684 Demo \u793a\u4f8b\u52a0\u5feb\u5bf9\u5f00\u53d1\u5e73\u53f0\u7684\u4e86\u89e3\u3002 \u5feb\u901f\u5165\u95e8\u51c6\u5907\u4e86\u4e00\u4e2a\u667a\u80fd\u706f\u63a5\u5165\u5f00\u53d1\u5e73\u53f0\u7684\u5e94\u7528\u573a\u666f\uff0c\u8be5\u573a\u666f\u6a21\u62df\u4e00\u6b3e\u706f\u63a5\u5165\u5f00\u53d1\u5e73\u53f0\u8fdb\u884c\u6570\u636e\u4e0a\u62a5\uff0c\u5e76\u80fd\u63a5\u6536\u63a7\u5236\u6307\u4ee4\uff0c\u4e0a\u62a5\u4e8b\u4ef6\uff0c\u6b64\u4e1a\u52a1\u573a\u666f\u53ef\u4ee5\u5e2e\u52a9\u7528\u6237\u7406\u89e3\u5982\u4f55\u5c06\u4e00\u6b3e\u8bbe\u5907\u63a5\u5165\u5230\u5f00\u53d1\u5e73\u53f0\u3002 \u2022 \u5982\u4f55\u901a\u8fc7\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u63d0\u4f9b\u7684\u8bbe\u5907 SDK \u63a5\u5165\u4e91\u7aef\u3002 \u2022 \u5982\u4f55\u901a\u8fc7\u63a7\u5236\u53f0\u5728\u7ebf\u8c03\u8bd5\u8bbe\u5907\u3002 \u2022 \u5982\u4f55\u901a\u8fc7\u63a7\u5236\u53f0\u5b9a\u4e49\u6570\u636e\u6a21\u677f\uff0c\u67e5\u770b\u8bbe\u5907\u4e0a\u62a5\u6570\u636e\u3001\u901a\u4fe1\u65e5\u5fd7\u3001\u4e8b\u4ef6\u7b49\u4fe1\u606f\u3002 4.2 \u667a\u80fd\u706f\u63a5\u5165\u6307\u5f15 4.2.1 \u64cd\u4f5c\u573a\u666f \u5047\u8bbe\u4e00\u6b3e\u667a\u80fd\u706f\u63a5\u5165\u5230\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\uff0c\u901a\u8fc7\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u53ef\u4ee5\u8fdc\u7a0b\u63a7\u5236\u706f\u7684\u4eae\u5ea6\u3001\u989c\u8272\u3001\u5f00\u5173\uff0c\u5e76\u5b9e\u65f6\u83b7\u53d6\u667a\u80fd\u706f\u4e0a\u62a5\u5230\u5f00\u53d1\u5e73\u53f0\u7684\u6570\u636e\u3002\u672c\u6587\u6863\u4e3b\u8981\u6307\u5bfc\u60a8\u5982\u4f55\u5728\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u63a7\u5236\u53f0\u63a5\u5165\u667a\u80fd\u706f\u3002 4.2.2 \u524d\u63d0\u6761\u4ef6 \u4e3a\u4e86\u901a\u8fc7\u4e0b\u9762\u7684\u6b65\u9aa4\u5feb\u901f\u7406\u89e3\u8be5\u4e1a\u52a1\u573a\u666f\uff0c\u9700\u8981\u505a\u597d\u4ee5\u4e0b\u51c6\u5907\u5de5\u4f5c\uff1a \u2022 \u7533\u8bf7\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u670d\u52a1\u3002 4.2.3 \u64cd\u4f5c\u6b65\u9aa4 \u521b\u5efa\u9879\u76ee\u548c\u4ea7\u54c1 \u767b\u5f55 \u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u63a7\u5236\u53f0 \uff0c\u3010\u9879\u76ee\u7ba1\u7406\u3011\uff0c\u9009\u62e9\u3010\u65b0\u5efa\u9879\u76ee\u3011\u3002 \u5728\u65b0\u5efa\u9879\u76ee\u9875\u9762\uff0c\u586b\u5199\u9879\u76ee\u57fa\u672c\u4fe1\u606f\u3002 \u9879\u76ee\u540d\u79f0\uff1a\u8f93\u5165\u201c\u667a\u80fd\u706f\u6f14\u793a\u201d\u6216\u5176\u4ed6\u540d\u79f0\u3002 \u9879\u76ee\u63cf\u8ff0\uff1a\u6309\u7167\u5b9e\u9645\u9700\u6c42\u586b\u5199\u9879\u76ee\u63cf\u8ff0\u3002 \u9879\u76ee\u65b0\u5efa\u6210\u529f\u540e\uff0c\u8fdb\u5165\u8be5\u9879\u76ee\u7684\u4ea7\u54c1\u5217\u8868\u9875\u3002\u5355\u51fb\u3010\u65b0\u5efa\u4ea7\u54c1\u3011\u3002 \u5728\u65b0\u5efa\u4ea7\u54c1\u9875\u9762\uff0c\u586b\u5199\u4ea7\u54c1\u57fa\u672c\u4fe1\u606f\u3002 \u4ea7\u54c1\u540d\u79f0\u8f93\u5165\u201c\u667a\u80fd\u706f\u201d\u6216\u5176\u4ed6\u4ea7\u54c1\u540d\u79f0\u3002 \u4ea7\u54c1\u7c7b\u578b\u9009\u62e9\u201c\u8def\u706f\u7167\u660e\u201d\u3002 \u8ba4\u8bc1\u65b9\u5f0f\u9009\u62e9\u201c\u5bc6\u94a5\u8ba4\u8bc1\u201d\u3002 \u901a\u4fe1\u65b9\u5f0f\u968f\u610f\u9009\u62e9\u3002 \u5176\u4ed6\u90fd\u4e3a\u9ed8\u8ba4\u9009\u9879\u3002 \u4ea7\u54c1\u65b0\u5efa\u6210\u529f\u540e\uff0c\u60a8\u53ef\u5728\u4ea7\u54c1\u5217\u8868\u9875\u67e5\u770b\u5230\u201c\u667a\u80fd\u706f\u201d\u3002 \u521b\u5efa\u6570\u636e\u6a21\u677f \u9009\u62e9\u201c\u667a\u80fd\u706f\u201d\u7c7b\u578b\u540e\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u751f\u6210\u6807\u51c6\u529f\u80fd\u3002 \u521b\u5efa\u6d4b\u8bd5\u8bbe\u5907 \u5728\u3010\u8bbe\u5907\u8c03\u8bd5\u3011\u9875\u9762\u4e2d\uff0c\u5355\u51fb\u3010\u65b0\u5efa\u8bbe\u5907\u3011\uff0c\u8bbe\u5907\u540d\u4e3a dev001\u3002 \u8fd0\u884cDemo\u7a0b\u5e8f 1. \u6253\u5f00 lightdemo \u4f8b\u7a0b TencentOS tiny\u9879\u76ee\u5de5\u7a0b\u4e2d\u5305\u542b\u4e86explorer\u7684demo\u5de5\u7a0b\uff1a \u8fdb\u5165TencentOS-tiny\\board\\TencentOS_tiny_EVB_MX_plus\\KEIL\\qcloud_iot_explorer_sdk_data_template\u76ee\u5f55\uff0c\u53cc\u51fbTencentOS_tiny.uvprojx\uff0c\u7528mdk\u6253\u5f00\u3002 Demo\u5de5\u7a0b\u4e2dexample\u5206\u7ec4\u4e0b\u7684\u914d\u7f6e\u6587\u4ef6\u8bf4\u660e\uff1a data_config.c \uff1a\u8bbe\u5907\u5c5e\u6027\u529f\u80fd\u76f8\u5173\u53c2\u6570\u914d\u7f6e action_config.c \uff1a\u884c\u4e3a\u8c03\u7528\u76f8\u5173\u53c2\u6570\u914d\u7f6e events_config.c \uff1a\u4e8b\u4ef6\u8c03\u7528\u76f8\u5173\u53c2\u6570\u914d\u7f6e \u586b\u5199\u914d\u7f6e\u4fe1\u606f \u8fdb\u5165TencentOS-tiny\\components\\connectivity\\qcloud-iot-explorer-sdk\\port\\TencentOS_tiny\u76ee\u5f55\uff0c\u4fee\u6539HAL_Device_tencentos_tiny.c\u6587\u4ef6\uff1a \u5c06\u4e0a\u56fe\u7ea2\u8272\u7ebf\u6846\u4e2d\u7684\u6570\u636e\u5206\u522b\u66ff\u6362\u4e3a\u63a7\u5236\u53f0\u201c\u8bbe\u5907\u8be6\u60c5\u9875\u201c\u4e2d\u7684\u53c2\u6570\u5e76\u4fdd\u5b58\u3002 \u4ea7\u54c1 ID\uff1a \u5c06\u63a7\u5236\u53f0\u7684\u4ea7\u54c1 ID \uff0c\u590d\u5236\u5230\u4e0a\u56fe sg_product_id\u3002 \u8bbe\u5907\u540d\u79f0\uff1a \u5c06\u63a7\u5236\u53f0\u7684\u8bbe\u5907\u540d\u79f0\uff0c\u590d\u5236\u5230\u4e0a\u56fe sg_device_name\u3002 \u8bbe\u5907\u5bc6\u94a5\uff1a\u5c06\u63a7\u5236\u53f0\u7684\u8bbe\u5907\u5bc6\u94a5\uff0c\u590d\u5236\u5230\u4e0a\u56fesg_device_secret\u3002 \u6ce8\uff1ademo\u5de5\u7a0b\u4e2d\u5df2\u6dfb\u52a0\u4e86\u4e00\u4e2a\u7528\u4e8e\u8c03\u8bd5\u7684explorer\u8bbe\u5907\u4fe1\u606f\uff0c\u53ef\u4ee5\u76f4\u63a5\u4e0eexplorer\u5e73\u53f0\u5bf9\u63a5\u3002 \u8fdb\u5165TencentOS-tiny\\examples\\qcloud_iot_explorer_sdk_data_template\u76ee\u5f55\uff0c\u4fee\u6539entry.c\uff1a \u8fd9\u91ccesp8266_join_ap\u51fd\u6570\u7684\u5165\u53c2\uff0c\u586b\u5199\u7528\u6237\u81ea\u5df1\u7684wifi\u70ed\u70b9\u540d\u5b57\u53ca\u5bc6\u7801\u3002 \u5c06esp8266\u6a21\u7ec4\u63d2\u5165\u5230\u5f00\u53d1\u677f\u6a21\u7ec4\u63a5\u53e3\u4e0a\u3002\uff08\u5982\u679c\u9009\u62e9BC35\u6a21\u7ec4\uff0c\u8bf7\u6253\u5f00BC35\u7684\u5b8f\u5e76\u63d2\u4e0aBC35\u6a21\u7ec4\u5373\u53ef\uff09 \u7f16\u8bd1 \u9009\u62e9project\u83dc\u5355\uff0c\u70b9\u51fbBuild Project\u7f16\u8bd1\u5de5\u7a0b\u3002 \u5982\u679c\u5de5\u5177\u680f\u4e0a\u6709\u7f16\u8bd1\u6309\u94ae\u5feb\u6377\u952e\uff0c\u53ef\u4ee5\u76f4\u63a5\u70b9\u51fb\u5de5\u5177\u680f\u4e0a\u7684\u7f16\u8bd1\u6309\u94ae\uff1a \u8fd0\u884cDemo\u7a0b\u5e8f \u9009\u62e9Flash\u83dc\u5355\uff0c\u70b9\u51fbDownload\u4e0b\u8f7d\u7a0b\u5e8f\u5230\u5f00\u53d1\u677f\u4e0a\u5e76\u8fd0\u884c\u3002 \u5982\u679c\u5de5\u5177\u680f\u4e0a\u6709\u4e0b\u8f7d\u6309\u94ae\u5feb\u6377\u952e\uff0c\u53ef\u4ee5\u76f4\u63a5\u70b9\u51fb\u5de5\u5177\u680f\u4e0a\u7684\u4e0b\u8f7d\u6309\u94ae\uff1a \u5f00\u53d1\u677f\u4e0a\u7a0b\u5e8f\u8fd0\u884c\u540e\uff0c\u524d\u5f80\u63a7\u5236\u53f0\u67e5\u770b\u8be5\u8bbe\u5907\u7684\u6570\u636e\u3002 4.2.4 \u67e5\u770b\u8bbe\u5907\u72b6\u6001 \u4fdd\u6301 light Demo \u7a0b\u5e8f\u4e3a\u8fd0\u884c\u72b6\u6001\u3002 \u8fdb\u5165\u3010\u63a7\u5236\u53f0\u3011>\u3010\u4ea7\u54c1\u5f00\u53d1\u3011>\u3010\u8bbe\u5907\u8c03\u8bd5\u3011\uff0c\u53ef\u67e5\u770b\u5230\u8bbe\u5907 \"dev001\" \u7684\u72b6\u6001\u4e3a\u201c\u4e0a\u7ebf\u201d\u72b6\u6001\uff0c\u8868\u793a Demo \u7a0b\u5e8f\u5df2\u6210\u529f\u8fde\u63a5\u4e0a\u5f00\u53d1\u5e73\u53f0\u3002 \u5355\u51fb\u3010\u67e5\u770b\u3011\uff0c\u53ef\u8fdb\u5165\u8bbe\u5907\u8be6\u60c5\u9875\u3002 \u5355\u51fb\u3010\u5f53\u524d\u4e0a\u62a5\u72b6\u6001\u3011\uff0c\u53ef\u67e5\u8be2\u8bbe\u5907\u4e0a\u62a5\u5230\u5f00\u53d1\u5e73\u53f0\u7684\u6700\u65b0\u6570\u636e\u53ca\u5386\u53f2\u6570\u636e\u3002 \u5f53\u524d\u4e0a\u62a5\u6570\u636e\u7684\u6700\u65b0\u503c\uff1a\u4f1a\u663e\u793a\u8bbe\u5907\u4e0a\u62a5\u7684\u6700\u65b0\u6570\u636e \u5f53\u524d\u4e0a\u62a5\u6570\u636e\u7684\u66f4\u65b0\u65f6\u95f4\uff1a\u663e\u793a\u6570\u636e\u7684\u66f4\u65b0\u65f6\u95f4 \u5355\u51fb\u3010\u67e5\u770b\u3011\uff0c\u53ef\u67e5\u770b\u67d0\u4e2a\u5c5e\u6027\u7684\u5386\u53f2\u4e0a\u62a5\u6570\u636e\u3002 4.2.5 \u67e5\u770b\u8bbe\u5907\u901a\u4fe1\u65e5\u5fd7 \u5355\u51fb\u3010\u8bbe\u5907\u901a\u4fe1\u65e5\u5fd7\u3011\uff0c\u53ef\u67e5\u8be2\u8be5\u8bbe\u5907\u67d0\u6bb5\u65f6\u95f4\u8303\u56f4\u7684\u6240\u6709\u4e0a\u4e0b\u884c\u6570\u636e\u3002 \u4e0a\u884c\uff1a\u4e0a\u884c\u6307\u8bbe\u5907\u7aef\u4e0a\u62a5\u5230\u5f00\u53d1\u5e73\u53f0\u7684\u6570\u636e\u3002 \u4e0b\u884c\uff1a\u4e0b\u884c\u6307\u4ece\u5f00\u53d1\u5e73\u53f0\u4e0b\u53d1\u5230\u8bbe\u5907\u7684\u6570\u636e\u3002 4.2.6 \u5728\u7ebf\u8c03\u8bd5 \u5f53 Light Demo \u6210\u529f\u8fde\u63a5\u5230\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u540e\uff0c\u60a8\u53ef\u5728\u63a7\u5236\u53f0\u3010\u8bbe\u5907\u8c03\u8bd5\u3011\u5217\u8868\uff0c\u5355\u51fb\u3010\u8c03\u8bd5\u3011\uff0c\u8fdb\u5165\u5728\u7ebf\u8c03\u8bd5\u3002 \u5c06\u4eae\u5ea6\u8bbe\u7f6e\u4e3a68\uff0c\u989c\u8272\u8bbe\u7f6e\u4e3a\u201cRed\u201d\uff0c\u5355\u51fb\u3010\u53d1\u9001\u3011\u3002 \u67e5\u770b Light Demo \u7a0b\u5e8f\uff0c\u53ef\u67e5\u770b\u5230\u6210\u529f\u63a5\u6536\u5230\u4e0b\u53d1\u7684\u6570\u636e\u3002 \u901a\u4fe1\u65e5\u5fd7\u4f1a\u663e\u793a\u5982\u4e0b\u65e5\u5fd7\uff0c\u8868\u793a\u6210\u529f\u4e0b\u53d1\u4e86\u6307\u4ee4\u5230\u8bbe\u5907\u7aef\u3002 { \"Payload\": { \"type\": \"update\", \"state\": { \"desired\": { \"color\": 0, \"brightness\": 68 } }, \"version\": 312, \"clientToken\": \"API-ControlDeviceData-1557240385\" } } \u67e5\u770b\u901a\u4fe1\u65e5\u5fd7\uff0c\u5373\u53ef\u67e5\u770b\u5230\u8bbe\u5907\u6210\u529f\u63a5\u6536\u5230\u4e0b\u884c\u6307\u4ee4\uff0c\u5e76\u4e0a\u62a5\u6700\u65b0\u6570\u636e\u5230\u5f00\u53d1\u5e73\u53f0\u7684\u8be6\u7ec6\u65e5\u5fd7\u3002 4.2.7 \u8bbe\u5907\u4e8b\u4ef6\u4e0a\u62a5 \u4fee\u6539\u5de5\u7a0b\u4e2d\u7684 config.h \u6587\u4ef6\uff0c\u5f00\u542f\u4e8b\u4ef6\u652f\u6301\uff1a \u4fee\u6539 data_template_sample.c \u6587\u4ef6\uff0c\u5f00\u542f\u4e8b\u4ef6\u4e0a\u62a5\u793a\u4f8b\uff1a \u7f16\u8bd1\u7a0b\u5e8f\uff0c\u4e0b\u8f7d\u5230\u5f00\u53d1\u677f\u4e2d\uff0c\u590d\u4f4d\u5f00\u53d1\u677f\uff0c\u7a0b\u5e8f\u5f00\u59cb\u8fd0\u884c\u3002 \u5728\u5e73\u53f0\u7aef\u53ef\u4ee5\u770b\u5230\u8bbe\u5907\u4e0a\u62a5\u4e8b\u4ef6\u7684\u65e5\u5fd7\uff1a 4.2.8 \u8bbe\u5907\u884c\u4e3a\u8c03\u7528 \u5728\u4e91\u7aef\u7684\u6570\u636e\u6a21\u677f\u4e2d\uff0c\u9009\u62e9\u81ea\u5b9a\u4e49\u529f\u80fd\u7248\u5757\uff0c\u624b\u52a8\u65b0\u5efa\u4e00\u4e2a\u8bbe\u5907\u884c\u4e3a\u529f\u80fd\uff1a \u5728 data_template_sample.c \u6587\u4ef6\u4e2d\u4f7f\u80fdAction\u793a\u4f8b\uff1a \u7f16\u8bd1\u7a0b\u5e8f\uff0c\u4e0b\u8f7d\u5230\u5f00\u53d1\u677f\u4e2d\uff0c\u590d\u4f4d\u5f00\u53d1\u677f\uff0c\u7a0b\u5e8f\u5f00\u59cb\u8fd0\u884c\u3002 \u5728\u4e91\u7aef\u4e0b\u53d1\u8bbe\u5907\u884c\u4e3a\u8c03\u7528\uff1a \u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u53ef\u4ee5\u770b\u5230\u8bbe\u5907\u884c\u4e3a\u88ab\u8c03\u7528\uff1a","title":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#tencentos-tinyevb_mx","text":"Revision Date Description 1.0 2019-9-15 \u6587\u6863\u521d\u7248 2.0 2020-2-12 \u6587\u6863V2.0","title":"TencentOS tiny\u5b9a\u5236\u5f00\u53d1\u677fEVB_MX+\u5feb\u901f\u5165\u95e8\u6307\u5357"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#1-evb_mx","text":"","title":"1. \u5b9a\u5236\u5f00\u53d1\u677fEVB_MX+\u786c\u4ef6\u7b80\u4ecb"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#11","text":"EVB_MX+\u662f\u817e\u8baf\u7269\u8054\u7f51\u64cd\u4f5c\u7cfb\u7edfTencentOS tiny \u56e2\u961f\u8054\u5408\u5357\u4eac\u539a\u5fb7\u7269\u8054\u7f51\u6709\u9650\u516c\u53f8\u8bbe\u8ba1\u7684\u4e00\u6b3e\u7269\u8054\u7f51\u8bc4\u4f30\u677f\uff0c\u7528\u4e8eTencentOS tiny \u57fa\u7840\u5185\u6838\u548cIoT\u7ec4\u4ef6\u529f\u80fd\u4f53\u9a8c\u548c\u8bc4\u4f30\u3002 \u5f00\u53d1\u677f\u529f\u80fd\u56fe\u5982\u4e0b\u6240\u793a\uff1a","title":"1.1 \u5f00\u53d1\u677f\u7b80\u4ecb"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#12","text":"CPU \uff1aSTM32L431RCT6, 80MHz\uff0c256K Flash\uff0c64KB SRAM \u663e\u793a\u5c4f \uff1aOLED\uff0c128*32\u5206\u8fa8\u7387 \u7535\u6e90\u7279\u6027 \uff1aMicro USB\u63a5\u53e3\uff0c5V\u4f9b\u7535\uff0c\u5185\u90e8\u67095V\u8f6c3.3V\u7684DCDC\uff0cMCU\u4f9b\u7535\u7535\u538b\u4e3a3.3V\uff0c\u7cfb\u7edfIO\u7535\u538b\u4e5f\u4e3a3.3V \u6309\u952e \uff1a\u4e00\u4e2a\u590d\u4f4d\u6309\u952e\uff0c\u56db\u4e2a\u529f\u80fd\u6309\u952e \u5916\u90e8\u6269\u5c55\u5b58\u50a8 \uff1aSPI FLASH\uff0cTF\u5361 LED\u6307\u793a\u706f \uff1a\u4e0a\u7535\u6307\u793a LED\uff0c\u7ea2\u8272\uff1b\u5145\u7535\u6307\u793a LED\uff0c\u7ea2\u8272\uff1b\u4e00\u4e2a\u7528\u6237\u5b9a\u4e49LED\uff0c\u84dd\u8272 \u8c03\u8bd5\u63a5\u53e3 \uff1aSWD\u5916\u63a5ST-Link\uff0cUART2\u4e32\u53e3\u8fde\u63a5PC XTAL \uff1a8MHz\uff0c32.768KHz \u4f20\u611f\u5668\u6269\u5c55\u63a5\u53e3E53 Interface \uff1a\u652f\u6301E53\u4f20\u611f\u5668\u6848\u4f8b\u6269\u5c55\u677f\uff08\u652f\u6301UART\u3001SPI\u3001IIC\u3001GPIO\u3001ADC\u3001DAC\u7b49\uff09 \u7f51\u7edc\u6a21\u5757\u6269\u5c55\u63a5\u53e3WAN Interface \uff1a\u652f\u6301\u591a\u79cd\u65e0\u7ebf\u901a\u4fe1\u6a21\u7ec4\u6269\u5c55\uff08UART&SPI&GPIO\uff09 \u64cd\u4f5c\u7cfb\u7edf\u652f\u6301 \uff1aTencentOS tiny","title":"1.2 \u5f00\u53d1\u677f\u7279\u6027"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#13","text":"","title":"1.3 \u5f00\u53d1\u677f\u786c\u4ef6\u8be6\u89e3"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#131","text":"1\uff09\u9502\u7535\u6c60\u5145\u653e\u7535\u7535\u6e90\u7ba1\u7406 \u4e3a\u9002\u5e94\u5e7f\u5927\u5f00\u53d1\u8005\u5bf9\u4e8e\u7269\u8054\u7f51\u4f4e\u529f\u8017\u5e94\u7528\u7684\u9700\u6c42\uff0cEVB_MX+\u5f00\u53d1\u677f\u52a0\u5165\u4e86\u9502\u7535\u6c60\u4f9b\u7535\u6a21\u5757\uff0c\u672c\u9502\u7535\u6c60\u4f9b\u7535\u6a21\u5757\u91c7\u7528\u7684\u662fTP5410\u82af\u7247\uff0c\u8be5\u82af\u7247\u662f\u4e00\u6b3e\u5355\u8282\u9502\u7535\u6c60\u4e13\u7528\u7684\u7535\u6c60\u5145\u7535\u53ca5V\u6052\u538b\u5347\u538b\u63a7\u5236\u5668\uff0c\u5145\u7535\u90e8\u5206\u96c6\u9ad8\u7cbe\u5ea6\u7535\u538b\u548c\u5145\u7535\u7535\u6d41\u8c03\u8282\u5668\u3001\u9884\u5145\u3001\u5145\u7535\u72b6\u6001\u6307\u793a\u548c\u5145\u7535\u622a\u6b62\u7b49\u529f\u80fd\u4e8e\u4e00\u4f53\uff0c\u53ef\u4ee5\u8f93\u51fa\u6700\u59271A\u7684\u5145\u7535\u7535\u6d41\u3002\u5347\u538b\u7535\u8def\u91c7\u7528CMOS\u5de5\u827a\u5236\u9020\u7684\u7a7a\u8f7d\u7535\u6d41\u6781\u4f4e\u7684VFM\u5f00\u5173\u578bDC/DC\u5347\u538b\u8f6c\u6362\u5668\uff0c\u5177\u5907\u6781\u4f4e\u7684\u7a7a\u8f7d\u529f\u8017\uff08\u5c0f\u4e8e10uA\uff09\uff0c\u4e14\u5347\u538b\u8f93\u51fa\u9a71\u52a8\u7535\u6d41\u80fd\u529b\u8fbe\u52301A\u3002 \u5728\u4e0b\u56fe\u7684TP5410\u7535\u8def\u4e2d\uff0cVBUS\u4e3aUSB\u63a5\u53e3\u63d0\u4f9b\u7684\u7535\u538b\uff0c\u4e3a\u603b\u7535\u538b\u3002BAT_VCC\u662f\u9502\u7535\u6c60\u5145\u7535\u7535\u538b\uff0c\u8be5\u5f15\u811a\u63a5\u9502\u7535\u6c60\u3002VOUT\u5f15\u811a\u8f93\u51fa+5V\u7535\u538b\uff0c\u8be5\u7535\u538b\u53ef\u7531\u9502\u7535\u6c60\u5347\u538b\u4ea7\u751f\uff0c\u4f9b\u7ed9\u540e\u7eed\u7535\u8def\u4f7f\u7528\u3002 2\uff09\u7535\u6e90\u7a33\u538b\u7535\u8def \u9502\u7535\u6c60\u7535\u6e90\u7ba1\u7406\u7535\u8def\u53ef\u4ee5\u5c063.7V\u9502\u7535\u6c60\u5347\u538b\u81f35V\uff0c\u4f46\u8fd9\u5e76\u4e0d\u80fd\u76f4\u63a5\u4f5c\u4e3a\u7535\u6e90\u7ed9EVB_MX+\u76f4\u63a5\u4f9b\u7535\uff0cEVB_MX+\u4e0a\u7684\u5143\u5668\u4ef6\u4f9b\u7535\u7535\u538b\u8303\u56f4\u666e\u904d\u57281.8V-3.6V\uff0c\u63a8\u8350\u7535\u538b\u5747\u4e3a3.3V\uff0c\uff08BC35\u4f9b\u7535\u8303\u56f4\u662f\uff1a3.1V-4.2V\uff0c\u63a8\u8350\u7535\u538b3.8V\uff0c\u4f7f\u75283.3V\u4e5f\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\uff09\uff0c\u56e0\u6b64\u9700\u8981\u5c065V\u7684\u7535\u5e73\u8f6c\u6362\u62103.3V\u4f9b\u7ed9EVB_MX+\u5f00\u53d1\u677f\u4f7f\u7528\uff0c\u8fd9\u91cc\u4f7f\u7528RT8059\u4f5c\u4e3a3.3V\u7a33\u538b\u5668\u82af\u7247\u3002 RT8059\u662f\u4e00\u6b3e\u9ad8\u6548\u7387\u8109\u51b2\u5bbd\u5ea6\u964d\u538b\u578bDC/DC\u8f6c\u6362\u5668\u3002\u8f93\u5165\u7535\u538b2.8V-5.5V\uff0c\u8f93\u51fa\u7535\u538b\u53ef\u8c03\u8303\u56f4\u4e3a\uff1a0.6V-Vin\uff0c\u8f93\u51fa\u7535\u6d41\u53ef\u4ee5\u8fbe\u52301A\u3002\u5728\u6211\u4eec\u63d0\u4f9b\u7684\u7535\u8def\u4e2d\u5c06\u8f93\u51fa\u8c03\u8282\u81f33.3V\uff0c\u8ba9\u5f00\u53d1\u677f\u6b63\u5e38\u5de5\u4f5c\u3002","title":"1.3.1 \u7535\u6e90\u7535\u8def"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#132-stm32","text":"\u5355\u7247\u673a\u6700\u5c0f\u7cfb\u7edf\u6216\u8005\u53eb\u6700\u5c0f\u786c\u4ef6\u5355\u5143\u7535\u8def\uff0c\u6307\u7528\u6700\u5c11\u5143\u5668\u4ef6\u7ec4\u6210\u7684\u5355\u7247\u673a\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u7684\u7cfb\u7edf\u3002\u6700\u5c0f\u7cfb\u7edf\u57fa\u672c\u7531\u7535\u6e90\u3001\u5355\u7247\u673a\u3001\u6676\u632f\u3001\u590d\u4f4d\u7535\u8def\u3001\u7a0b\u5e8f\u70e7\u5f55\u63a5\u53e3\u7ec4\u6210\uff0c\u7535\u6e90\u4f7f\u75283.3V\u76f4\u63a5\u4f9b\u7535\uff0c\u5176\u4ed6\u90e8\u5206\u539f\u7406\u56fe\u5982\u4e0b\uff1a","title":"1.3.2  STM32\u6700\u5c0f\u7cfb\u7edf\u7535\u8def"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#133-usb","text":"USB\u7535\u5e73\u8f6c\u6362\u7535\u8def\u662f\u7528\u4e8eMCU\u548cPC\u901a\u4fe1\u7684\u573a\u666f\u4e2d\u3002PC\u673a\u4e0a\u7684\u901a\u4fe1\u63a5\u53e3\u4f7f\u7528USB\u63a5\u53e3\uff0c\u76f8\u5e94\u7684\u7535\u5e73\u903b\u8f91\u9700\u8981\u9075\u7167USB\u7535\u5e73\u89c4\u5219\uff0c\u800cMCU\u7684\u4e32\u884c\u901a\u4fe1\u63a5\u53e3\u662f\u4e32\u53e3\uff0c\u76f8\u5e94\u7535\u5e73\u9700\u8981\u9075\u5faaTTL\u539f\u5219\u3002\u4e3a\u4e86\u4f7f\u4e24\u8005\u53ef\u4ee5\u4e92\u76f8\u901a\u4fe1\uff0c\u5c31\u9700\u8981\u4e00\u4e2a\u7535\u5e73\u8f6c\u6362\u5668\uff0cEVB_MX+\u4e0a\u4f7f\u7528\u4e86CH340\u82af\u7247\u4f5c\u4e3a\u8f6c\u6362\u5668\uff0cCH340\u5916\u56f4\u53ea\u9700\u8981\u63a5\u5f88\u5c11\u7684\u5143\u5668\u4ef6\u5373\u53ef\u4ee5\u5b9e\u73b0USB\u603b\u7ebf\u8f6c\u63a5\uff0c\u4f7f\u7528\u975e\u5e38\u65b9\u4fbf\u4e5f\u5e7f\u6cdb\u8fd0\u7528\u5728USB\u8f6cTTL\u5de5\u5177\u4e0a\uff0c\u7535\u8def\u5982\u4e0b\uff1a","title":"1.3.3  USB\u7535\u5e73\u8f6c\u6362\u7535\u8def"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#134-oled","text":"OLED\u6db2\u6676\u663e\u793a\u6a21\u5757\u7528\u6765\u5411\u7528\u6237\u663e\u793a\u7cfb\u7edf\u72b6\u6001\u3001\u53c2\u6570\u6216\u8005\u8981\u8f93\u5165\u7cfb\u7edf\u7684\u529f\u80fd\u3002\u4e3a\u4e86\u5c55\u793a\u826f\u597d\u7684\u89c6\u89c9\u6548\u679c\uff0c\u6a21\u5757\u4f7f\u7528SSD1306\u9a71\u52a8\u7684OLED\u663e\u793a\u5c4f\uff0c\u5206\u8fa8\u7387\u4e3a128*32\u3002SSD1306\u82af\u7247\u4e13\u4e3a\u5171\u9634\u6781OLED\u9762\u677f\u8bbe\u8ba1\uff0c\u5d4c\u5165\u4e86\u5bf9\u6bd4\u63a7\u5236\u5668\u3001\u663e\u793aRAM\u548c\u6676\u632f\uff0c\u5e76\u51cf\u5c11\u4e86\u5916\u90e8\u5668\u4ef6\u548c\u529f\u8017\uff0c\u6709256\u7ea7\u4eae\u5ea6\u63a7\u5236\u3002 \u8be5\u6b3eOLED\u4f7f\u7528IIC\u63a5\u53e3\uff0c\u7531\u4e8eIIC\u63a5\u53e3\u7a7a\u95f2\u65f6\u5f15\u811a\u8981\u4e0a\u62c9\uff0c\u56e0\u6b64\u4e0b\u9762\u7684\u539f\u7406\u56fe\u4e2d\u63a5\u4e8610k\u7535\u963b\u4e0a\u62c9\uff0c\u7136\u540e\u624d\u63a5\u5165MCU\u5f15\u811a\u3002","title":"1.3.4  OLED\u663e\u793a\u7535\u8def"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#135","text":"\u5f00\u53d1\u677f\u5e26\u6709\u4e00\u4e2a\u7cfb\u7edfReset\u6309\u952e\uff0c\u548c\u56db\u4e2a\u529f\u80fd\u6309\u952e\u3002\u590d\u4f4d\u6309\u952e\u662f\u76f4\u63a5\u63a5\u5165STM32L431\u548cMCU\u7684\u786c\u4ef6\u590d\u4f4dPin\uff0c\u6309\u4e0b\u590d\u4f4d\u6309\u952e\uff0c\u7cfb\u7edf\u81ea\u52a8\u91cd\u542f\u590d\u4f4d\u3002\u529f\u80fd\u6309\u952e\u53ef\u4ee5\u63d0\u4f9b\u7ed9\u5f00\u53d1\u8005\u505a\u529f\u80fd\u5b9a\u4e49\u5f00\u53d1\uff0c\u90fd\u662f\u4f7f\u7528GPIO\u53e3\uff0c\u65b9\u5411\u4e3a\u8f93\u5165\uff0c\u4f4e\u7535\u5e73\u6709\u6548\u3002\u5176\u539f\u7406\u56fe\u5982\u4e0b\u56fe\u6240\u793a\u3002","title":"1.3.5 \u7528\u6237\u6309\u952e"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#136-led","text":"\u4e3a\u4e86\u65b9\u4fbf\u9879\u76ee\u5f00\u53d1\u8c03\u8bd5\uff0cEVB_MX\u5f00\u53d1\u677f\u63a5\u51fa\u6765\u4e00\u4e2aLED\u706f\uff0c\u4f9b\u7528\u6237\u81ea\u5df1\u8bbe\u7f6e\u72b6\u6001\u4f7f\u7528\uff0c\u8be5LED\u706f\u63a5MCU\u7684PC13\u5f15\u811a\uff0c\u5f53PC13\u5f15\u811a\u8f93\u51fa\u9ad8\u7535\u5e73\u65f6\uff0c\u4f1a\u70b9\u4eaeLED\u706f\u3002","title":"1.3.6 LED\u7a0b\u5e8f\u6307\u793a\u706f"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#137-flash","text":"\u5f00\u53d1\u677f\u5e26\u6709\u4e00\u4e2aSPI Nor Flash\u82af\u7247\u6269\u5c55\uff0c\u7528\u6237\u5b58\u50a8\u4e00\u90e8\u5206\u7528\u6237\u6570\u636e\u548c\u5b58\u50a8\u7a7a\u95f4\u6269\u5c55\uff0c\u7535\u8def\u56fe\u5982\u4e0b\uff1a","title":"1.3.7  Flash\u5b58\u50a8\u7535\u8def\u6269\u5c55"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#138-flash","text":"\u5f00\u53d1\u677f\u5e26\u6709\u4e00\u4e2amicro tf\u5361\u6269\u5c55\uff0c\u53ef\u7528\u4e8e\u5b58\u50a8\u7a7a\u95f4\u6269\u5c55\uff0c\u6587\u4ef6\u7cfb\u7edf\u7ec4\u4ef6\u6d4b\u8bd5\u7b49\uff0c\u7535\u8def\u56fe\u5982\u4e0b\uff1a","title":"1.3.8  Flash\u5b58\u50a8\u7535\u8def\u6269\u5c55"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#139-e53","text":"\u5f00\u53d1\u677f\u8bbe\u8ba1\u6709E53\u63a5\u53e3\u7684\u4f20\u611f\u5668\u6269\u5c55\u677f\u63a5\u53e3\uff0c\u8be5\u63a5\u53e3\u53ef\u517c\u5bb9\u6240\u6709E53\u63a5\u53e3\u7684\u4f20\u611f\u5668\u6269\u5c55\u677f\uff0c\u5b9e\u73b0\u4e0d\u540c\u7269\u8054\u7f51\u6848\u4f8b\u573a\u666f\u7684\u5feb\u901f\u642d\u5efa\u3002\u8be5\u63a5\u53e3\u53ef\u63a5\u5165UART\u3001SPI\u3001I2C\u3001ADC\u7b49\u901a\u4fe1\u534f\u8bae\u7684\u4f20\u611f\u5668\uff0c\u5176\u539f\u7406\u56fe\u5982\u4e0b\u56fe\u6240\u793a\u3002","title":"1.3.9 E53 \u4f20\u611f\u5668\u6269\u5c55\u63a5\u53e3"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#1310-wan","text":"\u5f00\u53d1\u677f\u8bbe\u8ba1\u6709\u901a\u4fe1\u6269\u5c55\u677f\u7684\u6269\u5c55\u63a5\u53e3\uff0c\u8be5\u63a5\u53e3\u53ef\u63a5\u5165WIFI\u3001NB-IoT\u30012G\u3001\u817e\u8baf\u5b9a\u5236IoT\u6a21\u7ec4\u3001LoRaWAN\u7b49\u4e0d\u540c\u901a\u4fe1\u65b9\u5f0f\u7684\u901a\u4fe1\u6269\u5c55\u677f\uff0c\u4ee5\u6ee1\u8db3\u4e0d\u540c\u573a\u666f\u4e0a\u4e91\u7684\u9700\u6c42\uff0c\u5176\u539f\u7406\u56fe\u5982\u4e0b\u56fe\u6240\u793a\u3002","title":"1.3.10 WAN\u901a\u4fe1\u6a21\u5757\u6269\u5c55\u63a5\u53e3"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#1311","text":"","title":"1.3.11\u5f00\u53d1\u677f\u90e8\u5206\u5f15\u811a\u548c\u6a21\u5757\u6620\u5c04\u5173\u7cfb"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#14","text":"","title":"1.4 \u5f00\u53d1\u677f\u5f00\u7bb1\u5b89\u88c5\u6307\u5357"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#141","text":"\u6253\u5f00\u5f00\u53d1\u5957\u4ef6\u7bb1\u5b50\u540e\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u5728\u7bb1\u5b50\u5de6\u4fa7\u627e\u5230\u5f00\u53d1\u677f\u4e3b\u677f\uff0c\u53f3\u4fa7\u653e\u4e86\u4e00\u4e2aWAN\u53e3wifi\u6269\u5c55\u677fESP8266\u3001STlink\u4e0b\u8f7d\u5668\u3001\u548c\u4e00\u4e2a\u4f20\u611f\u5668\u6269\u5c55\u677f\uff0c\u53ef\u80fd\u662f\uff08E53_SC1\u667a\u6167\u57ce\u5e02\u706f\u5149\u6a21\u5757\u3001E53_SF1\u667a\u6167\u6d88\u9632\u70df\u611f\u6a21\u5757\u3001E53_IA1\u667a\u6167\u519c\u4e1a\u6a21\u5757\uff09\u5176\u4e2d\u4e00\u4e2a\uff08\u6807\u914d\u4ec5\u4e00\u4e2a\u4f20\u611f\u6269\u5c55\u677f\uff0c\u5982\u9700\u8981\u66f4\u591a\u4f20\u611f\u6269\u5c55\u677f\u53ef\u81ea\u884c\u627e\u5408\u4f5c\u4f9b\u5e94\u5546\uff08\u7269\u8054\u7f51\u4ff1\u4e50\u90e8\uff09\u8d2d\u4e70\uff09\uff0c\u5982\u4e0a\u56fe\u6240\u793a\u3002","title":"1.4.1  \u68c0\u67e5\u914d\u5957\u8bbe\u5907"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#142-wanwifi","text":"","title":"1.4.2 \u5b89\u88c5WAN\u53e3WiFi\u6a21\u5757"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#143","text":"\u6839\u636e\u60a8\u5f00\u53d1\u5957\u4ef6\u914d\u5957\u7684\u4f20\u611f\u6269\u5c55\u677f\u5b89\u88c5\u5176\u4e2d\u4e00\u4e2a\u5373\u53ef\u3002","title":"1.4.3 \u5b89\u88c5\u4f20\u611f\u5668\u6269\u5c55\u677f"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#144-micor-usb","text":"Micro USB\u7ebf\u7684\u529f\u80fd\u662f\u4f9b\u7535\u53ca\u8c03\u8bd5\uff0c\u5c06\u7ebf\u4e00\u5934\u4e0e\u5f00\u53d1\u677f\u7684Micro\u63a5\u53e3\u8fde\u63a5\uff0c\u53e6\u4e00\u5934\u63a5\u5230\u7535\u8111\u7684USB\u53e3\u4e0a\u3002","title":"1.4.4  \u8fde\u63a5Micor USB\u7ebf"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#145-st-link","text":"\u628a\u5f00\u53d1\u677f\u5185\u63d0\u4f9b\u7684\u914d\u5957\u4e0b\u8f7d\u7ebf\u63a5\u5728\u5f00\u53d1\u677f\u7684\u7a0b\u5e8f\u4e0b\u8f7d\u63a5\u53e3\uff08SWD\u53e3\uff09\uff0c\u53e6\u4e00\u7aef\u4e0eST-Link\u7a0b\u5e8f\u4e0b\u8f7d\u5668\u5bf9\u5e94\u5f15\u811a\u76f8\u8fde\uff0c\u6ce8\u610f\u8fde\u63a5\u7d27\u5bc6\uff0c\u9632\u6b62\u63a5\u89e6\u4e0d\u826f\uff0c\u7ea2\u8272\u4e3aVCC\uff0c\u4e00\u5b9a\u53c2\u8003\u4e0b\u56fe\u8fdb\u884c\u8fde\u63a5\uff0c\u4e0d\u8981\u63a5\u9519\u3002","title":"1.4.5  \u8fde\u63a5ST-Link\u7a0b\u5e8f\u4e0b\u8f7d\u5668"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#2-evb_mx","text":"","title":"2. \u5b9a\u5236\u5f00\u53d1\u677fEVB_MX+\u8f6f\u4ef6\u5f00\u53d1\u73af\u5883\u51c6\u5907"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#21-mdk","text":"MDK \u5373RealView MDK \u6216MDK-ARM\uff08Microcontroller Development kit\uff09\uff0c\u662f ARM \u516c\u53f8\u6536\u8d2dKeil\u516c\u53f8\u4ee5\u540e\uff0c\u57fa\u4e8euVision\u754c\u9762\u63a8\u51fa\u7684\u9488\u5bf9ARM7\u3001ARM9\u3001Cortex-M0\u3001Cortex-M1\u3001Cortex-M2\u3001Cortex-M3\u3001Cortex-R4\u7b49ARM\u5904\u7406\u5668\u7684\u5d4c\u5165\u5f0f\u8f6f\u4ef6\u5f00\u53d1\u5de5\u5177\u3002MDK-ARM \u96c6\u6210\u4e86\u4e1a\u5185\u6700\u9886\u5148\u7684\u6280\u672f\uff0c\u5305\u62ec uVision4 \u96c6\u6210\u5f00\u53d1\u73af\u5883\u4e0e RealView \u7f16\u8bd1\u5668RVCT\u3002\u652f\u6301 ARM7\u3001ARM9 \u548c\u6700\u65b0\u7684Cortex-M3/M1/M0 \u6838\u5904\u7406\u5668\uff0c\u81ea\u52a8\u914d\u7f6e\u542f\u52a8\u4ee3\u7801\uff0c\u96c6\u6210 Flash \u70e7\u5199\u6a21\u5757\uff0c\u5f3a\u5927\u7684 Simulation \u8bbe\u5907\u6a21\u62df\uff0c\u6027\u80fd\u5206\u6790\u7b49\u529f\u80fd\uff0c\u4e0e ARM \u4e4b\u524d\u7684\u5de5\u5177\u5305 ADS \u7b49\u76f8\u6bd4\uff0cRealView \u7f16\u8bd1\u5668\u7684\u6700\u65b0\u7248\u672c\u53ef\u5c06\u6027\u80fd\u6539\u5584\u8d85\u8fc7 20%\u3002 Keil\u516c\u53f8\u5f00\u53d1\u7684ARM\u5f00\u53d1\u5de5\u5177MDK\uff0c\u662f\u7528\u6765\u5f00\u53d1\u57fa\u4e8eARM\u6838\u7684\u7cfb\u5217\u5fae\u63a7\u5236\u5668\u7684\u5d4c\u5165\u5f0f\u5e94\u7528\u7a0b\u5e8f\u3002\u5b83\u9002\u5408\u4e0d\u540c\u5c42\u6b21\u7684\u5f00\u53d1\u8005\u4f7f\u7528\uff0c\u5305\u62ec\u4e13\u4e1a\u7684\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u5de5\u7a0b\u5e08\u548c\u5d4c\u5165\u5f0f\u8f6f\u4ef6\u5f00\u53d1\u7684\u5165\u95e8\u8005\u3002MDK\u5305\u542b\u4e86\u5de5\u4e1a\u6807\u51c6\u7684Keil C\u7f16\u8bd1\u5668\u3001\u5b8f\u6c47\u7f16\u5668\u3001\u8c03\u8bd5\u5668\u3001\u5b9e\u65f6\u5185\u6838\u7b49\u7ec4\u4ef6\uff0c\u652f\u6301\u6240\u6709\u57fa\u4e8eARM\u7684\u8bbe\u5907\uff0c\u80fd\u5e2e\u52a9\u5de5\u7a0b\u5e08\u6309\u7167\u8ba1\u5212\u5b8c\u6210\u9879\u76ee\u3002","title":"2.1 MDK\u8f6f\u4ef6\u4ecb\u7ecd"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#22-mdk","text":"\u767b\u5f55MDK\u5b98\u7f51\uff0c\u4e0b\u8f7dMDK5\u8f6f\u4ef6\uff0c\u4e0b\u8f7d\u5730\u5740\uff1a http://www2.keil.com/mdk5 \u6216\u8005 https://www.keil.com/download/product/ \u4e0b\u8f7d\u7684\u7248\u672c\u6700\u597d\u57285.24\u4ee5\u4e0a\uff0c\u672c\u5f00\u53d1\u6559\u7a0b\u4ee55.24\u7248\u672c\u4e3a\u4f8b\uff0c\u53cc\u51fbMDK524\u5e94\u7528\u7a0b\u5e8f\u6587\u4ef6\uff0c\u70b9\u51fbnext>>\u3002 \u6253\u4e0a I agree\u524d\u9762\u7684\u52fe\u52fe\uff0c\u5373\u662f\u540c\u610f\u4e00\u4e9b\u5b89\u88c5\u534f\u8bae\u3002\u70b9\u51fbnext>>\u3002 \u9009\u62e9\u5b89\u88c5\u8def\u5f84\uff0c\u53ef\u4ee5\u9ed8\u8ba4\u4e5f\u53ef\u4ee5\u5b89\u88c5\u5728\u6211\u4eec\u81ea\u5df1\u5efa\u7acb\u7684\u6587\u4ef6\u5939\u4e0b\u3002\u70b9\u51fbnext>>\u3002 \u8fd9\u91cc\u586b\u5199\u7684\u662f\u6211\u4eec\u7684\u4e00\u4e9b\u4fe1\u606f\uff0c\u586b\u5199\u5b8c\u6574\u540e\uff0c\u7ee7\u7eednext>>\u3002 \u7136\u540e\u7b49\u5f85\u5b89\u88c5\u5b8c\u6210\u5373\u53ef\u3002 \u5b89\u88c5\u5b8c\u6210\uff0c\u70b9\u51fbFinish\u3002 \u7136\u540e\u4f1a\u8df3\u51fa\u6765\u8fd9\u4e2a\u754c\u9762\uff0c\u8fd9\u4e2a\u6211\u4eec\u540e\u9762\u518d\u8bb2\uff0c\u5148\u70b9OK\uff0c\u628a\u5f39\u6846\u90fd\u53c9\u6389\u3002 \u6fc0\u6d3bMDK\uff0c\u5bfc\u5165License,\u6fc0\u6d3bMDK\u540e\u4fbf\u53ef\u4f7f\u7528\u4e86\u3002 \u7279\u522b\u63d0\u793a\uff1a\u4e00\u5b9a\u8981\u8f93\u5165License\u6fc0\u6d3bMDK\u8f6f\u4ef6\uff0c\u5efa\u8bae\u8d2d\u4e70\u6b63\u7248License\u3002","title":"2.2 MDK\u5b89\u88c5"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#23-mdk","text":"\u5b89\u88c5\u5b8cMDK\u540e\uff0c\u6211\u4eec\u9700\u8981\u5b89\u88c5\u5f00\u53d1\u5957\u4ef6\u4e2d\u5355\u7247\u673a\u578b\u53f7\u5bf9\u5e94\u7684Pack\u3002 \u5b89\u88c5\u65b9\u5f0f\u4e00 \u767b\u5f55\u5b98\u7f51\uff1ahttp://www.keil.com/dd2/pack/ \u4e0b\u8f7dKeil.STM32L4xx_DFP.2.0.0.pack \u540e\u5b89\u88c5\uff0c\u5982\u4e0b\u56fe \u5b89\u88c5\u65b9\u5f0f\u4e8c MDK\u8f6f\u4ef6\u4e0a\u5728\u7ebf\u5b89\u88c5 \u6253\u5f00\u8f6f\u4ef6\uff0c\u5728\u5bfc\u822a\u680f\u6253\u5f00Pack\u5b89\u88c5\u754c\u9762\uff0c\u7136\u540e\u9009\u62e9ok\u9009\u9879\u3002 \u8fdb\u5165\u5728\u7ebf\u5b89\u88c5\u754c\u9762\uff0c\u9009\u7740STM32L4XX Pack,\u70b9\u51fbInstall\u8fdb\u884c\u5b89\u88c5\u3002 \u81f3\u6b64\uff0c\u6211\u4eec\u5f00\u53d1\u677f\u7684\u5355\u7247\u673a\u7a0b\u5e8f\u5f00\u53d1\u73af\u5883\u5df2\u7ecf\u642d\u5efa\u5b8c\u6bd5\uff0c\u91cd\u542fMDK\u8f6f\u4ef6\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002","title":"2.3 MDK\u5b89\u88c5"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#24-st-link","text":"\u524d\u9762\u8bb2\u4e86\u5f00\u53d1\u677f\u5355\u7247\u673a\u7a0b\u5e8f\u7684\u5f00\u53d1\u73af\u5883\u7684\u642d\u5efa\uff0c\u4f46\u662f\u4e3a\u4e86\u5c06\u7a0b\u5e8f\u70e7\u5f55\u5230\u5f00\u53d1\u677f\u4e2d\u6211\u4eec\u8fd8\u9700\u8981\u4f7f\u7528\u4eff\u771f\u5668\u3002\u6211\u4eec\u8fd9\u5957\u5f00\u53d1\u677f\u9009\u7528ST\u516c\u53f8\u7684ST-Link V2\u4eff\u771f\u5668\u8fdb\u884c\u5f00\u53d1\u677f\u7a0b\u5e8f\u7684\u70e7\u5199\u548c\u4eff\u771f\uff0c\u4e0b\u9762\u4ecb\u7ecdST-Link\u9a71\u52a8\u7684\u5b89\u88c5\u53ca\u73af\u5883\u642d\u5efa\u3002 \u5728ST\u5b98\u7f51\u4e0b\u8f7dST-Link\u9a71\u52a8\uff0c https://www.st.com/content/st_com/zh/products/development-tools/software-development-tools/stm32-software-development-tools/stm32-utilities/stsw-link009.html \uff08\u9a71\u52a8\u67092\u79cd\uff1a 32\u4f4d\u7535\u8111\u7cfb\u7edf\u5b89\u88c5\u201cdpinst_x86\u201d\u300164\u4f4d\u7535\u8111\u7cfb\u7edf\u5b89\u88c5\u201cdpinst_amd64\u201d\uff09\u3002 \u8fd0\u884c\u5bf9\u5e94\u7684\u9a71\u52a8\uff0c\u5b89\u88c5ST-Link V2\u9a71\u52a8\u7a0b\u5e8f\u3002\u5b89\u88c5\u8def\u5f84\u5c3d\u91cf\u4fdd\u6301\u9ed8\u8ba4\u8def\u5f84\u3002 \u5b89\u88c5\u5b8c\u6210\u540e, \u5c06ST-Link\u901a\u8fc7USB\u63a5\u53e3\u8fde\u5165\u7535\u8111\u3002\u6253\u5f00\u201c\u8bbe\u5907\u7ba1\u7406\u5668\u201d\u3002\u82e5\u770b\u5230\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u8868\u793a\u9a71\u52a8\u5b89\u88c5\u6210\u529f\u3002 \u8fd9\u91cc\u63d0\u9192 2 \u70b9: 1\uff0c \u5404\u79cd windows \u7248\u672c\u8bbe\u5907\u540d\u79f0\u548c\u6240\u5728\u8bbe\u5907\u7ba1\u7406\u5668\u680f\u76ee\u53ef\u80fd\u4e0d\u4e00\u6837\uff0c\u4f8b\u5982 WIN10 \u63d2\u4e0aSTLINK \u540e\u663e\u793a\u7684\u662f STM32 STLINK\u3002 2\uff0c \u5982\u679c\u8bbe\u5907\u540d\u79f0\u65c1\u8fb9\u663e\u793a\u7684\u662f\u9ec4\u8272\u7684\u53f9\u53f7\uff0c\u8bf7\u76f4\u63a5\u70b9\u51fb\u8bbe\u5907\u540d\u79f0\uff0c\u7136\u540e\u5728\u5f39\u51fa\u7684\u754c\u9762\u70b9\u51fb\u66f4\u65b0\u8bbe\u5907\u9a71\u52a8 \u81f3\u6b64\uff0c ST-Link \u9a71\u52a8\u5df2\u7ecf\u5b89\u88c5\u5b8c\u6210\u3002\u63a5\u4e0b\u6765\u5927\u5bb6\u53ea\u9700\u8981\u5728 MDK\u5de5\u7a0b\u91cc\u9762\u914d\u7f6e\u4e00\u4e0b ST-Link\u5373\u53ef\u3002","title":"2.4 ST-Link\u9a71\u52a8\u5b89\u88c5"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#25-mdk","text":"\u5b89\u88c5\u9a71\u52a8\u6210\u529f\u540e\uff0c\u6253\u5f00MDK\u8f6f\u4ef6\uff0c\u914d\u7f6e\u7a0b\u5e8f\u70e7\u5199\u548c\u4eff\u771f\u7684\u73af\u5883\u3002 \u70b9\u51fb\u8fdb\u5165\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\u6309\u7ebd\uff0c\u8fdb\u5165\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\u3002 \u9009\u62e9Debug\u9009\u9879\uff0c\u8fdb\u5165\u4eff\u771f\u5668\u8bbe\u7f6e\u754c\u9762\u3002 \u4e0b\u62c9\u4eff\u771f\u5668\u9009\u62e9\u5217\u8868\uff0c\u9009\u7740ST-Link Debugger\u5e76\u52fe\u9009\u53f3\u4fa7Use,\u70b9\u51fbSettings\u8fdb\u5165ST-Link V2\u4eff\u771f\u5668\u914d\u7f6e\u754c\u9762\u3002 \u5f00\u53d1\u677f\u8bbe\u8ba1\u7684\u7a0b\u5e8f\u70e7\u5f55\u65b9\u5f0f\u4e3aSW\uff0c\u6b64\u5904Unit\u9009\u62e9ST-Link/V2,\u4e14Port\u9009\u62e9SW,\u5e76\u786e\u8ba4\u53f3\u4fa7\u6846\u5185\u662f\u5426\u68c0\u6d4b\u51faSW\u8bbe\u5907\uff0c\u70b9\u51fb<\u786e\u8ba4>\u4fdd\u5b58\u914d\u7f6e\u3002","title":"2.5  \u7f16\u7a0b\u8f6f\u4ef6(MDK)\u914d\u7f6e"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#26-ch340","text":"\u4e92\u8054\u7f51\u641c\u7d22\u4e0b\u8f7dCH340 \u4e32\u53e3\u82af\u7247\u7684\u9a71\u52a8 \u5b89\u88c5\u65b9\u6cd5\uff1a\u6253\u5f00\u9a71\u52a8\u5b89\u88c5\u7a0b\u5e8f\u70b9\u51fb\u5b89\u88c5\u5373\u53ef\u3002 \u6ce8\uff1a\u82e5\u5b89\u88c5\u5931\u8d25\uff0c\u8bf7\u5148\u70b9\u51fb\u5378\u8f7d\uff0c\u540e\u70b9\u51fb\u5b89\u88c5\u3002","title":"2.6  CH340\u4e32\u53e3\u9a71\u52a8\u5b89\u88c5"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#27","text":"\u5de5\u5177\u4e0b\u8f7d\uff1a http://www.daxia.com/download/sscom.rar \u5b89\u88c5\u65b9\u6cd5\uff1a\u4e32\u53e3\u8c03\u8bd5\u52a9\u624bsscom5.13.1\u662f\u514d\u5b89\u88c5\u7684\uff0c\u89e3\u538b\u51fa\u538b\u7f29\u5305\u5373\u53ef\u76f4\u63a5\u4f7f\u7528\u3002 \u6839\u636ePC\u548c\u7ec8\u7aef\u4e4b\u95f4\u7684\u8fde\u63a5\uff0c\u9009\u62e9\u6b63\u786e\u7684\u4e32\u884c\u7aef\u53e3\u3002 \u6253\u5f00\u7535\u8111\u7684\u8bbe\u5907\u7ba1\u7406\u5668\uff0c\u5728\u7aef\u53e3\u5217\u8868\u53ef\u4ee5\u770b\u5230PC\u4e0e\u5f00\u53d1\u677f\u8fde\u63a5\u7684\u7aef\u53e3\u53f7\u3002 \u6211\u8fd9\u91cc\u663e\u793a\u7684\u662fCOM6\uff0c\u6240\u4ee5\u8981\u5728sscom\u5de5\u5177\u4e2d\u9009\u62e9COM6\uff0c\u5f00\u53d1\u677f\u7a0b\u5e8f\u6ce2\u7279\u7387\u8bbe\u7f6e\u4e3a115200\uff0c\u6240\u4ee5\u6211\u5728sscom\u4e32\u53e3\u5de5\u5177\u4e2d\u9009\u62e9115200\u6ce2\u7279\u7387\u3002","title":"2.7 \u4e32\u53e3\u8c03\u8bd5\u52a9\u624b\u7684\u5b89\u88c5\u4e0e\u4f7f\u7528"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#3-tencentos-tiny","text":"","title":"3. TencentOS tiny \u57fa\u7840\u5185\u6838\u5b9e\u9a8c"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#31-tencentos-tiny-hello_world","text":"TencentOS tiny\u5b98\u65b9\u5f00\u6e90\u4ed3\u4e0b\u8f7d\u6e90\u7801\uff0c\u5730\u5740\u4e3a\uff1a https://github.com/Tencent/TencentOS-tiny \u8fdb\u5165 < TencentOS-tiny/board/TencentOS_tiny_EVB_MX_Plus/KEIL/hello_world> \u76ee\u5f55\uff0c\u6253\u5f00TencentOS_tiny.uvprojx\u5de5\u7a0b\uff1a","title":"3.1 \u6253\u5f00 TencentOS tiny\u63d0\u4f9b\u7684 Hello_world \u5de5\u7a0b"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#32-helloworld","text":"\u6253\u5f00\u5de5\u7a0b\u540e\uff0c\u6211\u4eec\u5728\u5de6\u4fa7\u7684\u5de5\u7a0b\u6587\u4ef6\u5bfc\u822a\u9875\u9762\u5c55\u5f00examples\u76ee\u5f55\uff0c\u53ef\u4ee5\u770b\u5230helloworld.c\u6e90\u7801\uff0c\u8fd9\u91cc\u521b\u5efa\u4e86\u4e24\u4e2aTencentOS tiny\u7684\u4efb\u52a1\uff0c\u4ea4\u66ff\u8fd0\u884c\u6253\u5370\u4efb\u52a1\u3002\u5f00\u53d1\u8005\u5b89\u88c5\u4e0b\u56fe\u6307\u793a\uff0c\u70b9\u51fb\u7f16\u8bd1\u6309\u94ae\u5373\u53ef\u7f16\u8bd1\u5de5\u7a0b\uff0c\u5982\u56fe\uff1a","title":"3.2 \u7f16\u8bd1HelloWorld\u5de5\u7a0b"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#33","text":"\u9996\u5148\u9700\u8981\u914d\u7f6e\u4e0b\u8f7d\u73af\u5883 \u6309\u4e0b\u56fe\u6240\u793a\u914d\u7f6e\u4e0b\u8f7d\u53c2\u6570 \u7f16\u8bd1\u5b8c\u6210\u540e\u70b9\u51fb\u5982\u56fe\u6240\u793a\u201dLOAD\u201d\u6309\u94ae\u4e0b\u8f7d\u7a0b\u5e8f\u5373\u53ef\u3002","title":"3.3 \u4e0b\u8f7d\u8fd0\u884c"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#34","text":"\u8fde\u63a5\u597d\u4e32\u53e3\uff0c\u5728PC\u7684\u4e32\u53e3\u52a9\u624b\u4e2d\u53ef\u4ee5\u770b\u5230TencentOS tiny\u7684\u4e24\u4e2a\u4efb\u52a1\u4ea4\u66ff\u8fd0\u884c\uff0c\u6253\u5370\u6d88\u606f\u5e76\u5b8c\u6210\u4efb\u52a1\u8ba1\u6570\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u66f4\u591aTencentOS tiny\u57fa\u7840\u5185\u6838\u7684\u4f7f\u7528\uff0c\u8bf7\u53c2\u8003\u5185\u6838\u5f00\u53d1\u6307\u5357\u6587\u6863\uff1a - TencentOS tiny\u5185\u6838\u5f00\u53d1\u6307\u5357 - TencentOS tiny API\u53c2\u8003","title":"3.4 \u67e5\u770b\u8fd0\u884c\u7ed3\u679c"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#4-tencentos-tinyiot-explorer","text":"","title":"4. \u4f7f\u7528TencentOS tiny\u5b9a\u5236\u5f00\u53d1\u677f\u5bf9\u63a5\u817e\u8baf\u4e91IoT Explorer"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#41","text":"\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u7684\u7528\u6237\uff0c\u53ef\u4ee5\u901a\u8fc7\u5feb\u901f\u5165\u95e8\u7684 Demo \u793a\u4f8b\u52a0\u5feb\u5bf9\u5f00\u53d1\u5e73\u53f0\u7684\u4e86\u89e3\u3002 \u5feb\u901f\u5165\u95e8\u51c6\u5907\u4e86\u4e00\u4e2a\u667a\u80fd\u706f\u63a5\u5165\u5f00\u53d1\u5e73\u53f0\u7684\u5e94\u7528\u573a\u666f\uff0c\u8be5\u573a\u666f\u6a21\u62df\u4e00\u6b3e\u706f\u63a5\u5165\u5f00\u53d1\u5e73\u53f0\u8fdb\u884c\u6570\u636e\u4e0a\u62a5\uff0c\u5e76\u80fd\u63a5\u6536\u63a7\u5236\u6307\u4ee4\uff0c\u4e0a\u62a5\u4e8b\u4ef6\uff0c\u6b64\u4e1a\u52a1\u573a\u666f\u53ef\u4ee5\u5e2e\u52a9\u7528\u6237\u7406\u89e3\u5982\u4f55\u5c06\u4e00\u6b3e\u8bbe\u5907\u63a5\u5165\u5230\u5f00\u53d1\u5e73\u53f0\u3002 \u2022 \u5982\u4f55\u901a\u8fc7\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u63d0\u4f9b\u7684\u8bbe\u5907 SDK \u63a5\u5165\u4e91\u7aef\u3002 \u2022 \u5982\u4f55\u901a\u8fc7\u63a7\u5236\u53f0\u5728\u7ebf\u8c03\u8bd5\u8bbe\u5907\u3002 \u2022 \u5982\u4f55\u901a\u8fc7\u63a7\u5236\u53f0\u5b9a\u4e49\u6570\u636e\u6a21\u677f\uff0c\u67e5\u770b\u8bbe\u5907\u4e0a\u62a5\u6570\u636e\u3001\u901a\u4fe1\u65e5\u5fd7\u3001\u4e8b\u4ef6\u7b49\u4fe1\u606f\u3002","title":"4.1 \u5165\u95e8\u6982\u8ff0"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#42","text":"","title":"4.2 \u667a\u80fd\u706f\u63a5\u5165\u6307\u5f15"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#421","text":"\u5047\u8bbe\u4e00\u6b3e\u667a\u80fd\u706f\u63a5\u5165\u5230\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\uff0c\u901a\u8fc7\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u53ef\u4ee5\u8fdc\u7a0b\u63a7\u5236\u706f\u7684\u4eae\u5ea6\u3001\u989c\u8272\u3001\u5f00\u5173\uff0c\u5e76\u5b9e\u65f6\u83b7\u53d6\u667a\u80fd\u706f\u4e0a\u62a5\u5230\u5f00\u53d1\u5e73\u53f0\u7684\u6570\u636e\u3002\u672c\u6587\u6863\u4e3b\u8981\u6307\u5bfc\u60a8\u5982\u4f55\u5728\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u63a7\u5236\u53f0\u63a5\u5165\u667a\u80fd\u706f\u3002","title":"4.2.1 \u64cd\u4f5c\u573a\u666f"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#422","text":"\u4e3a\u4e86\u901a\u8fc7\u4e0b\u9762\u7684\u6b65\u9aa4\u5feb\u901f\u7406\u89e3\u8be5\u4e1a\u52a1\u573a\u666f\uff0c\u9700\u8981\u505a\u597d\u4ee5\u4e0b\u51c6\u5907\u5de5\u4f5c\uff1a \u2022 \u7533\u8bf7\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u670d\u52a1\u3002","title":"4.2.2 \u524d\u63d0\u6761\u4ef6"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#423","text":"\u521b\u5efa\u9879\u76ee\u548c\u4ea7\u54c1 \u767b\u5f55 \u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u63a7\u5236\u53f0 \uff0c\u3010\u9879\u76ee\u7ba1\u7406\u3011\uff0c\u9009\u62e9\u3010\u65b0\u5efa\u9879\u76ee\u3011\u3002 \u5728\u65b0\u5efa\u9879\u76ee\u9875\u9762\uff0c\u586b\u5199\u9879\u76ee\u57fa\u672c\u4fe1\u606f\u3002 \u9879\u76ee\u540d\u79f0\uff1a\u8f93\u5165\u201c\u667a\u80fd\u706f\u6f14\u793a\u201d\u6216\u5176\u4ed6\u540d\u79f0\u3002 \u9879\u76ee\u63cf\u8ff0\uff1a\u6309\u7167\u5b9e\u9645\u9700\u6c42\u586b\u5199\u9879\u76ee\u63cf\u8ff0\u3002 \u9879\u76ee\u65b0\u5efa\u6210\u529f\u540e\uff0c\u8fdb\u5165\u8be5\u9879\u76ee\u7684\u4ea7\u54c1\u5217\u8868\u9875\u3002\u5355\u51fb\u3010\u65b0\u5efa\u4ea7\u54c1\u3011\u3002 \u5728\u65b0\u5efa\u4ea7\u54c1\u9875\u9762\uff0c\u586b\u5199\u4ea7\u54c1\u57fa\u672c\u4fe1\u606f\u3002 \u4ea7\u54c1\u540d\u79f0\u8f93\u5165\u201c\u667a\u80fd\u706f\u201d\u6216\u5176\u4ed6\u4ea7\u54c1\u540d\u79f0\u3002 \u4ea7\u54c1\u7c7b\u578b\u9009\u62e9\u201c\u8def\u706f\u7167\u660e\u201d\u3002 \u8ba4\u8bc1\u65b9\u5f0f\u9009\u62e9\u201c\u5bc6\u94a5\u8ba4\u8bc1\u201d\u3002 \u901a\u4fe1\u65b9\u5f0f\u968f\u610f\u9009\u62e9\u3002 \u5176\u4ed6\u90fd\u4e3a\u9ed8\u8ba4\u9009\u9879\u3002 \u4ea7\u54c1\u65b0\u5efa\u6210\u529f\u540e\uff0c\u60a8\u53ef\u5728\u4ea7\u54c1\u5217\u8868\u9875\u67e5\u770b\u5230\u201c\u667a\u80fd\u706f\u201d\u3002 \u521b\u5efa\u6570\u636e\u6a21\u677f \u9009\u62e9\u201c\u667a\u80fd\u706f\u201d\u7c7b\u578b\u540e\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u751f\u6210\u6807\u51c6\u529f\u80fd\u3002 \u521b\u5efa\u6d4b\u8bd5\u8bbe\u5907 \u5728\u3010\u8bbe\u5907\u8c03\u8bd5\u3011\u9875\u9762\u4e2d\uff0c\u5355\u51fb\u3010\u65b0\u5efa\u8bbe\u5907\u3011\uff0c\u8bbe\u5907\u540d\u4e3a dev001\u3002 \u8fd0\u884cDemo\u7a0b\u5e8f 1. \u6253\u5f00 lightdemo \u4f8b\u7a0b TencentOS tiny\u9879\u76ee\u5de5\u7a0b\u4e2d\u5305\u542b\u4e86explorer\u7684demo\u5de5\u7a0b\uff1a \u8fdb\u5165TencentOS-tiny\\board\\TencentOS_tiny_EVB_MX_plus\\KEIL\\qcloud_iot_explorer_sdk_data_template\u76ee\u5f55\uff0c\u53cc\u51fbTencentOS_tiny.uvprojx\uff0c\u7528mdk\u6253\u5f00\u3002 Demo\u5de5\u7a0b\u4e2dexample\u5206\u7ec4\u4e0b\u7684\u914d\u7f6e\u6587\u4ef6\u8bf4\u660e\uff1a data_config.c \uff1a\u8bbe\u5907\u5c5e\u6027\u529f\u80fd\u76f8\u5173\u53c2\u6570\u914d\u7f6e action_config.c \uff1a\u884c\u4e3a\u8c03\u7528\u76f8\u5173\u53c2\u6570\u914d\u7f6e events_config.c \uff1a\u4e8b\u4ef6\u8c03\u7528\u76f8\u5173\u53c2\u6570\u914d\u7f6e \u586b\u5199\u914d\u7f6e\u4fe1\u606f \u8fdb\u5165TencentOS-tiny\\components\\connectivity\\qcloud-iot-explorer-sdk\\port\\TencentOS_tiny\u76ee\u5f55\uff0c\u4fee\u6539HAL_Device_tencentos_tiny.c\u6587\u4ef6\uff1a \u5c06\u4e0a\u56fe\u7ea2\u8272\u7ebf\u6846\u4e2d\u7684\u6570\u636e\u5206\u522b\u66ff\u6362\u4e3a\u63a7\u5236\u53f0\u201c\u8bbe\u5907\u8be6\u60c5\u9875\u201c\u4e2d\u7684\u53c2\u6570\u5e76\u4fdd\u5b58\u3002 \u4ea7\u54c1 ID\uff1a \u5c06\u63a7\u5236\u53f0\u7684\u4ea7\u54c1 ID \uff0c\u590d\u5236\u5230\u4e0a\u56fe sg_product_id\u3002 \u8bbe\u5907\u540d\u79f0\uff1a \u5c06\u63a7\u5236\u53f0\u7684\u8bbe\u5907\u540d\u79f0\uff0c\u590d\u5236\u5230\u4e0a\u56fe sg_device_name\u3002 \u8bbe\u5907\u5bc6\u94a5\uff1a\u5c06\u63a7\u5236\u53f0\u7684\u8bbe\u5907\u5bc6\u94a5\uff0c\u590d\u5236\u5230\u4e0a\u56fesg_device_secret\u3002 \u6ce8\uff1ademo\u5de5\u7a0b\u4e2d\u5df2\u6dfb\u52a0\u4e86\u4e00\u4e2a\u7528\u4e8e\u8c03\u8bd5\u7684explorer\u8bbe\u5907\u4fe1\u606f\uff0c\u53ef\u4ee5\u76f4\u63a5\u4e0eexplorer\u5e73\u53f0\u5bf9\u63a5\u3002 \u8fdb\u5165TencentOS-tiny\\examples\\qcloud_iot_explorer_sdk_data_template\u76ee\u5f55\uff0c\u4fee\u6539entry.c\uff1a \u8fd9\u91ccesp8266_join_ap\u51fd\u6570\u7684\u5165\u53c2\uff0c\u586b\u5199\u7528\u6237\u81ea\u5df1\u7684wifi\u70ed\u70b9\u540d\u5b57\u53ca\u5bc6\u7801\u3002 \u5c06esp8266\u6a21\u7ec4\u63d2\u5165\u5230\u5f00\u53d1\u677f\u6a21\u7ec4\u63a5\u53e3\u4e0a\u3002\uff08\u5982\u679c\u9009\u62e9BC35\u6a21\u7ec4\uff0c\u8bf7\u6253\u5f00BC35\u7684\u5b8f\u5e76\u63d2\u4e0aBC35\u6a21\u7ec4\u5373\u53ef\uff09 \u7f16\u8bd1 \u9009\u62e9project\u83dc\u5355\uff0c\u70b9\u51fbBuild Project\u7f16\u8bd1\u5de5\u7a0b\u3002 \u5982\u679c\u5de5\u5177\u680f\u4e0a\u6709\u7f16\u8bd1\u6309\u94ae\u5feb\u6377\u952e\uff0c\u53ef\u4ee5\u76f4\u63a5\u70b9\u51fb\u5de5\u5177\u680f\u4e0a\u7684\u7f16\u8bd1\u6309\u94ae\uff1a \u8fd0\u884cDemo\u7a0b\u5e8f \u9009\u62e9Flash\u83dc\u5355\uff0c\u70b9\u51fbDownload\u4e0b\u8f7d\u7a0b\u5e8f\u5230\u5f00\u53d1\u677f\u4e0a\u5e76\u8fd0\u884c\u3002 \u5982\u679c\u5de5\u5177\u680f\u4e0a\u6709\u4e0b\u8f7d\u6309\u94ae\u5feb\u6377\u952e\uff0c\u53ef\u4ee5\u76f4\u63a5\u70b9\u51fb\u5de5\u5177\u680f\u4e0a\u7684\u4e0b\u8f7d\u6309\u94ae\uff1a \u5f00\u53d1\u677f\u4e0a\u7a0b\u5e8f\u8fd0\u884c\u540e\uff0c\u524d\u5f80\u63a7\u5236\u53f0\u67e5\u770b\u8be5\u8bbe\u5907\u7684\u6570\u636e\u3002","title":"4.2.3 \u64cd\u4f5c\u6b65\u9aa4"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#424","text":"\u4fdd\u6301 light Demo \u7a0b\u5e8f\u4e3a\u8fd0\u884c\u72b6\u6001\u3002 \u8fdb\u5165\u3010\u63a7\u5236\u53f0\u3011>\u3010\u4ea7\u54c1\u5f00\u53d1\u3011>\u3010\u8bbe\u5907\u8c03\u8bd5\u3011\uff0c\u53ef\u67e5\u770b\u5230\u8bbe\u5907 \"dev001\" \u7684\u72b6\u6001\u4e3a\u201c\u4e0a\u7ebf\u201d\u72b6\u6001\uff0c\u8868\u793a Demo \u7a0b\u5e8f\u5df2\u6210\u529f\u8fde\u63a5\u4e0a\u5f00\u53d1\u5e73\u53f0\u3002 \u5355\u51fb\u3010\u67e5\u770b\u3011\uff0c\u53ef\u8fdb\u5165\u8bbe\u5907\u8be6\u60c5\u9875\u3002 \u5355\u51fb\u3010\u5f53\u524d\u4e0a\u62a5\u72b6\u6001\u3011\uff0c\u53ef\u67e5\u8be2\u8bbe\u5907\u4e0a\u62a5\u5230\u5f00\u53d1\u5e73\u53f0\u7684\u6700\u65b0\u6570\u636e\u53ca\u5386\u53f2\u6570\u636e\u3002 \u5f53\u524d\u4e0a\u62a5\u6570\u636e\u7684\u6700\u65b0\u503c\uff1a\u4f1a\u663e\u793a\u8bbe\u5907\u4e0a\u62a5\u7684\u6700\u65b0\u6570\u636e \u5f53\u524d\u4e0a\u62a5\u6570\u636e\u7684\u66f4\u65b0\u65f6\u95f4\uff1a\u663e\u793a\u6570\u636e\u7684\u66f4\u65b0\u65f6\u95f4 \u5355\u51fb\u3010\u67e5\u770b\u3011\uff0c\u53ef\u67e5\u770b\u67d0\u4e2a\u5c5e\u6027\u7684\u5386\u53f2\u4e0a\u62a5\u6570\u636e\u3002","title":"4.2.4 \u67e5\u770b\u8bbe\u5907\u72b6\u6001"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#425","text":"\u5355\u51fb\u3010\u8bbe\u5907\u901a\u4fe1\u65e5\u5fd7\u3011\uff0c\u53ef\u67e5\u8be2\u8be5\u8bbe\u5907\u67d0\u6bb5\u65f6\u95f4\u8303\u56f4\u7684\u6240\u6709\u4e0a\u4e0b\u884c\u6570\u636e\u3002 \u4e0a\u884c\uff1a\u4e0a\u884c\u6307\u8bbe\u5907\u7aef\u4e0a\u62a5\u5230\u5f00\u53d1\u5e73\u53f0\u7684\u6570\u636e\u3002 \u4e0b\u884c\uff1a\u4e0b\u884c\u6307\u4ece\u5f00\u53d1\u5e73\u53f0\u4e0b\u53d1\u5230\u8bbe\u5907\u7684\u6570\u636e\u3002","title":"4.2.5 \u67e5\u770b\u8bbe\u5907\u901a\u4fe1\u65e5\u5fd7"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#426","text":"\u5f53 Light Demo \u6210\u529f\u8fde\u63a5\u5230\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u540e\uff0c\u60a8\u53ef\u5728\u63a7\u5236\u53f0\u3010\u8bbe\u5907\u8c03\u8bd5\u3011\u5217\u8868\uff0c\u5355\u51fb\u3010\u8c03\u8bd5\u3011\uff0c\u8fdb\u5165\u5728\u7ebf\u8c03\u8bd5\u3002 \u5c06\u4eae\u5ea6\u8bbe\u7f6e\u4e3a68\uff0c\u989c\u8272\u8bbe\u7f6e\u4e3a\u201cRed\u201d\uff0c\u5355\u51fb\u3010\u53d1\u9001\u3011\u3002 \u67e5\u770b Light Demo \u7a0b\u5e8f\uff0c\u53ef\u67e5\u770b\u5230\u6210\u529f\u63a5\u6536\u5230\u4e0b\u53d1\u7684\u6570\u636e\u3002 \u901a\u4fe1\u65e5\u5fd7\u4f1a\u663e\u793a\u5982\u4e0b\u65e5\u5fd7\uff0c\u8868\u793a\u6210\u529f\u4e0b\u53d1\u4e86\u6307\u4ee4\u5230\u8bbe\u5907\u7aef\u3002 { \"Payload\": { \"type\": \"update\", \"state\": { \"desired\": { \"color\": 0, \"brightness\": 68 } }, \"version\": 312, \"clientToken\": \"API-ControlDeviceData-1557240385\" } } \u67e5\u770b\u901a\u4fe1\u65e5\u5fd7\uff0c\u5373\u53ef\u67e5\u770b\u5230\u8bbe\u5907\u6210\u529f\u63a5\u6536\u5230\u4e0b\u884c\u6307\u4ee4\uff0c\u5e76\u4e0a\u62a5\u6700\u65b0\u6570\u636e\u5230\u5f00\u53d1\u5e73\u53f0\u7684\u8be6\u7ec6\u65e5\u5fd7\u3002","title":"4.2.6 \u5728\u7ebf\u8c03\u8bd5"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#427","text":"\u4fee\u6539\u5de5\u7a0b\u4e2d\u7684 config.h \u6587\u4ef6\uff0c\u5f00\u542f\u4e8b\u4ef6\u652f\u6301\uff1a \u4fee\u6539 data_template_sample.c \u6587\u4ef6\uff0c\u5f00\u542f\u4e8b\u4ef6\u4e0a\u62a5\u793a\u4f8b\uff1a \u7f16\u8bd1\u7a0b\u5e8f\uff0c\u4e0b\u8f7d\u5230\u5f00\u53d1\u677f\u4e2d\uff0c\u590d\u4f4d\u5f00\u53d1\u677f\uff0c\u7a0b\u5e8f\u5f00\u59cb\u8fd0\u884c\u3002 \u5728\u5e73\u53f0\u7aef\u53ef\u4ee5\u770b\u5230\u8bbe\u5907\u4e0a\u62a5\u4e8b\u4ef6\u7684\u65e5\u5fd7\uff1a","title":"4.2.7 \u8bbe\u5907\u4e8b\u4ef6\u4e0a\u62a5"},{"location":"15.TencentOS_tiny_EVB_MX_Plus_Quick_Start/#428","text":"\u5728\u4e91\u7aef\u7684\u6570\u636e\u6a21\u677f\u4e2d\uff0c\u9009\u62e9\u81ea\u5b9a\u4e49\u529f\u80fd\u7248\u5757\uff0c\u624b\u52a8\u65b0\u5efa\u4e00\u4e2a\u8bbe\u5907\u884c\u4e3a\u529f\u80fd\uff1a \u5728 data_template_sample.c \u6587\u4ef6\u4e2d\u4f7f\u80fdAction\u793a\u4f8b\uff1a \u7f16\u8bd1\u7a0b\u5e8f\uff0c\u4e0b\u8f7d\u5230\u5f00\u53d1\u677f\u4e2d\uff0c\u590d\u4f4d\u5f00\u53d1\u677f\uff0c\u7a0b\u5e8f\u5f00\u59cb\u8fd0\u884c\u3002 \u5728\u4e91\u7aef\u4e0b\u53d1\u8bbe\u5907\u884c\u4e3a\u8c03\u7528\uff1a \u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u53ef\u4ee5\u770b\u5230\u8bbe\u5907\u884c\u4e3a\u88ab\u8c03\u7528\uff1a","title":"4.2.8 \u8bbe\u5907\u884c\u4e3a\u8c03\u7528"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/","text":"\u57fa\u4e8e TencentOS tiny \u7684 LoRaWAN \u5f00\u53d1\u5165\u95e8\u6307\u5357 1. ST P-NUCLEO-LRWAN3\u5957\u4ef6\u7b80\u4ecb 1.1 \u5f00\u53d1\u5957\u4ef6\u7b80\u4ecb P-NUCLEO-LRWAN3\u662f\u5b8c\u6574\u7684\u5957\u4ef6\uff0c\u5305\u62ec\u7f51\u5173\u548c\u8282\u70b9\uff0c\u53ef\u7528\u4e8e\u8bc4\u4f30LoRaWAN\u7f51\u7edc\u3002\u4f7f\u7528\u8be5\u5957\u4ef6\uff0c\u7528\u6237\u53ef\u4ee5\u8f7b\u677e\u8bbe\u7f6eLPWAN\u7f51\u7edc\uff0c\u5e2e\u52a9\u7528\u6237\u5b66\u4e60LoRaWAN\u6280\u672f\uff0c\u4e86\u89e3\u5982\u4f55\u5728\u81ea\u5df1\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f7f\u7528LoRaWAN\u6280\u672f\u3002 LoRa\u7f51\u5173\u5957\u4ef6\u7531ST Nucleo-F746ZG\u5e95\u677f\u548c\u745e\u5174\u6052\u65b9\u57fa\u4e8eSX1301\u7684LRWAN_GS\u6a21\u5757\u7ec4\u6210\u3002 ST Nucleo LoRa\u8282\u70b9\u5957\u4ef6\u7531LRWAN_NS1\u6269\u5c55\u677f\u548cST Nucleo-L073\u5e95\u677f\u7ec4\u6210\u3002\u5176\u4e2d LRWAN_NS1\u6269\u5c55\u677f\u96c6\u6210\u745e\u5174\u6052\u65b9\u7684RHF0M003 LoRaWAN\u6a21\u7ec4\uff0c\u5e76\u96c6\u6210\u4e86\u6e29\u6e7f\u5ea6\u4f20\u611f\u5668HTS221\u3001\u6c14\u538b\u4f20\u611f\u5668LPS22HB\u30013\u8f74\u78c1\u529b\u4f20\u611f\u5668LIS3MDL\u30016\u8f74\u59ff\u6001\u4f20\u611f\u5668LSM6DS3\u51714\u4e2aI2C\u4f20\u611f\u5668\u4ef6\u3002 \u5f00\u53d1\u5957\u4ef6\u5b9e\u7269\u56fe\u5982\u4e0b\uff1a 1.2 LoRaWAN\u8282\u70b9\u786c\u4ef6\u8be6\u89e3 1.2.1 NUCLEO-L073RZ \u57fa\u4e8eCORTEX-M0+\u7684\u8bc4\u4f30\u677f NUCLEO-L073RZ\u57fa\u4e8eNUCLEO 64\u516c\u7248PCB\u8bbe\u8ba1\uff0c\u53ef\u4ee5\u65b9\u4fbf\u7684\u66f4\u6362ST\u7684\u5176\u5b8364PIN MCU\u3002\u4e3b\u8981\u7279\u6027\u5305\u62ec\uff1a LQFP64 STM32-L073RZT6 MCU 20KB SRAM 192KB Flash 6KB data EEPROM \u4e24\u79cd\u7c7b\u578b\u6269\u5c55\u63a5\u53e3\uff1aArduino UNO\u6269\u5c55\u63a5\u53e3\uff1bSTM32 MORPHO\u6269\u5c55\u63a5\u53e3 \u677f\u8f7dST-LINK/V2-1\u8c03\u8bd5/\u7f16\u7a0b\u5668 \u7075\u6d3b\u7684\u4f9b\u7535\u65b9\u5f0f\u9009\u62e9 \u677f\u8f7d3\u4e2aLED\u706f\uff0cLD1\u3001LD3\u6307\u793a\u5de5\u4f5c\u72b6\u6001\uff0cLD2\u4e3a\u7528\u6237\u53ef\u7f16\u7a0bLED\u706f \u4e24\u4e2a\u6309\u94ae\uff0c\u590d\u4f4d\u53ca\u7528\u6237\u53ef\u7f16\u7a0b\u6309\u94ae USB\u91cd\u679a\u4e3e\u80fd\u529b\uff0c\u652f\u6301VCP\uff0cMSD\uff0cDEBUG\u529f\u80fd \u5927\u91cfIDE\u5f00\u53d1\u73af\u5883\u652f\u6301 \u6269\u5c55\u63a5\u53e3\u5982\u4e0b\u56fe\u6240\u793a\uff1a 1.2.2 LRWAN_NS1 \u6269\u5c55\u677f\u786c\u4ef6 1\uff09\u6269\u5c55\u677f\u63a5\u53e3\u517c\u5bb9Arduino UNO\u63a5\u53e3\uff0c\u539f\u7406\u56fe\u5982\u4e0b\uff1a 2\uff09 \u6269\u5c55\u677f\u4e0a\u540c\u4e00\u4e2aI2C\u7aef\u53e3\uff0c\u6302\u8f7d\u4e864\u4e2aI2C\u63a5\u53e3\u7684\u4f20\u611f\u5668\uff0c\u5206\u522b\u662f\u6e29\u6e7f\u5ea6\u4f20\u611f\u5668HTS221\u3001\u6c14\u538b\u4f20\u611f\u5668LPS22HB\u30013\u8f74\u78c1\u529b\u4f20\u611f\u5668LIS3MDL\u30016\u8f74\u59ff\u6001\u4f20\u611f\u5668LSM6DS3\uff0c\u539f\u7406\u56fe\u5982\u4e0b\uff1a 3\uff09LoRaWAN\u901a\u4fe1\u6a21\u7ec4\u7535\u8def\u539f\u7406\u56fe 2. LoRaWAN\u8282\u70b9\u8f6f\u4ef6\u5f00\u53d1\u73af\u5883\u51c6\u5907 2.1 MDK\u8f6f\u4ef6\u4ecb\u7ecd MDK \u5373RealView MDK \u6216MDK-ARM\uff08Microcontroller Development kit\uff09\uff0c\u662f ARM \u516c\u53f8\u6536\u8d2dKeil\u516c\u53f8\u4ee5\u540e\uff0c\u57fa\u4e8euVision\u754c\u9762\u63a8\u51fa\u7684\u9488\u5bf9ARM7\u3001ARM9\u3001Cortex-M0\u3001Cortex-M1\u3001Cortex-M2\u3001Cortex-M3\u3001Cortex-R4\u7b49ARM\u5904\u7406\u5668\u7684\u5d4c\u5165\u5f0f\u8f6f\u4ef6\u5f00\u53d1\u5de5\u5177\u3002MDK-ARM \u96c6\u6210\u4e86\u4e1a\u5185\u6700\u9886\u5148\u7684\u6280\u672f\uff0c\u5305\u62ec uVision4 \u96c6\u6210\u5f00\u53d1\u73af\u5883\u4e0e RealView \u7f16\u8bd1\u5668RVCT\u3002\u652f\u6301 ARM7\u3001ARM9 \u548c\u6700\u65b0\u7684Cortex-M3/M1/M0 \u6838\u5904\u7406\u5668\uff0c\u81ea\u52a8\u914d\u7f6e\u542f\u52a8\u4ee3\u7801\uff0c\u96c6\u6210 Flash \u70e7\u5199\u6a21\u5757\uff0c\u5f3a\u5927\u7684 Simulation \u8bbe\u5907\u6a21\u62df\uff0c\u6027\u80fd\u5206\u6790\u7b49\u529f\u80fd\uff0c\u4e0e ARM \u4e4b\u524d\u7684\u5de5\u5177\u5305 ADS \u7b49\u76f8\u6bd4\uff0cRealView \u7f16\u8bd1\u5668\u7684\u6700\u65b0\u7248\u672c\u53ef\u5c06\u6027\u80fd\u6539\u5584\u8d85\u8fc7 20%\u3002 Keil\u516c\u53f8\u5f00\u53d1\u7684ARM\u5f00\u53d1\u5de5\u5177MDK\uff0c\u662f\u7528\u6765\u5f00\u53d1\u57fa\u4e8eARM\u6838\u7684\u7cfb\u5217\u5fae\u63a7\u5236\u5668\u7684\u5d4c\u5165\u5f0f\u5e94\u7528\u7a0b\u5e8f\u3002\u5b83\u9002\u5408\u4e0d\u540c\u5c42\u6b21\u7684\u5f00\u53d1\u8005\u4f7f\u7528\uff0c\u5305\u62ec\u4e13\u4e1a\u7684\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u5de5\u7a0b\u5e08\u548c\u5d4c\u5165\u5f0f\u8f6f\u4ef6\u5f00\u53d1\u7684\u5165\u95e8\u8005\u3002MDK\u5305\u542b\u4e86\u5de5\u4e1a\u6807\u51c6\u7684Keil C\u7f16\u8bd1\u5668\u3001\u5b8f\u6c47\u7f16\u5668\u3001\u8c03\u8bd5\u5668\u3001\u5b9e\u65f6\u5185\u6838\u7b49\u7ec4\u4ef6\uff0c\u652f\u6301\u6240\u6709\u57fa\u4e8eARM\u7684\u8bbe\u5907\uff0c\u80fd\u5e2e\u52a9\u5de5\u7a0b\u5e08\u6309\u7167\u8ba1\u5212\u5b8c\u6210\u9879\u76ee\u3002 2.2 MDK\u5b89\u88c5 \u70b9\u51fb\u4e0b\u9762\u7684\u5730\u5740\u4e0b\u8f7dMDK\u8f6f\u4ef6\uff0c\u8f6f\u4ef6\u7248\u672c\u6700\u597d\u662f5.24\u53ca\u4ee5\u4e0a\uff1a https://www.keil.com/download/product/ \u6559\u7a0b\u4ee55.24\u7248\u672c\u4e3a\u4f8b\uff0c\u53cc\u51fbMDK524\u5e94\u7528\u7a0b\u5e8f\u6587\u4ef6\uff0c\u70b9\u51fbnext>>\u3002 \u6253\u4e0a I agree\u524d\u9762\u7684\u52fe\u52fe\uff0c\u5373\u662f\u540c\u610f\u4e00\u4e9b\u5b89\u88c5\u534f\u8bae\u3002\u70b9\u51fbnext>>\u3002 \u9009\u62e9\u5b89\u88c5\u8def\u5f84\uff0c\u53ef\u4ee5\u9ed8\u8ba4\u4e5f\u53ef\u4ee5\u5b89\u88c5\u5728\u6211\u4eec\u81ea\u5df1\u5efa\u7acb\u7684\u6587\u4ef6\u5939\u4e0b\u3002\u70b9\u51fbnext>>\u3002 \u8fd9\u91cc\u586b\u5199\u7684\u662f\u6211\u4eec\u7684\u4e00\u4e9b\u4fe1\u606f\uff0c\u586b\u5199\u5b8c\u6574\u540e\uff0c\u7ee7\u7eednext>>\u3002 \u7136\u540e\u7b49\u5f85\u5b89\u88c5\u5b8c\u6210\u5373\u53ef\u3002 \u5b89\u88c5\u5b8c\u6210\uff0c\u70b9\u51fbFinish\u3002 \u7136\u540e\u4f1a\u8df3\u51fa\u6765\u8fd9\u4e2a\u754c\u9762\uff0c\u8fd9\u4e2a\u6211\u4eec\u540e\u9762\u518d\u8bb2\uff0c\u5148\u70b9OK\uff0c\u628a\u5f39\u6846\u90fd\u53c9\u6389\u3002 \u6fc0\u6d3bMDK\uff0c\u5bfc\u5165License,\u6fc0\u6d3bMDK\u540e\u4fbf\u53ef\u4f7f\u7528\u4e86\u3002 \u7279\u522b\u63d0\u793a\uff1a\u4e00\u5b9a\u8981\u8f93\u5165License\u6fc0\u6d3bMDK\u8f6f\u4ef6\uff0c\u8bf7\u8d2d\u4e70\u6b63\u7248License\u3002 2.3 Pack\u5b89\u88c5 \u5b89\u88c5\u5b8cMDK\u540e\uff0c\u6211\u4eec\u9700\u8981\u5b89\u88c5\u5f00\u53d1\u5957\u4ef6\u4e2d\u5355\u7247\u673a\u578b\u53f7\u5bf9\u5e94\u7684Pack\u3002 \u5b89\u88c5\u65b9\u5f0f\u4e00\uff1a\u767b\u5f55\u5b98\u7f51\uff1ahttp://www.keil.com/dd2/pack/ \u4e0b\u8f7dKeil.STM32L0xx_DFP.2.0.0.pack \u540e\u5b89\u88c5\uff0c\u5982\u4e0b\u56fe \u5b89\u88c5\u65b9\u5f0f\u4e8c\uff1aMDK\u8f6f\u4ef6\u4e0a\u5728\u7ebf\u5b89\u88c5 \u6253\u5f00\u8f6f\u4ef6\uff0c\u5728\u5bfc\u822a\u680f\u6253\u5f00Pack\u5b89\u88c5\u754c\u9762\uff0c\u7136\u540e\u9009\u62e9ok\u9009\u9879\u3002 \u8fdb\u5165\u5728\u7ebf\u5b89\u88c5\u754c\u9762\uff0c\u9009\u7740STM32L0XX Pack,\u70b9\u51fbInstall\u8fdb\u884c\u5b89\u88c5\u3002 \u81f3\u6b64\uff0c\u6211\u4eec\u5f00\u53d1\u677f\u7684\u5355\u7247\u673a\u7a0b\u5e8f\u5f00\u53d1\u73af\u5883\u5df2\u7ecf\u642d\u5efa\u5b8c\u6bd5\uff0c\u91cd\u542fMDK\u8f6f\u4ef6\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002 2.4 ST-Link\u9a71\u52a8\u5b89\u88c5 \u524d\u9762\u8bb2\u4e86\u5f00\u53d1\u677f\u5355\u7247\u673a\u7a0b\u5e8f\u7684\u5f00\u53d1\u73af\u5883\u7684\u642d\u5efa\uff0c\u4f46\u662f\u4e3a\u4e86\u5c06\u7a0b\u5e8f\u70e7\u5f55\u5230\u5f00\u53d1\u677f\u4e2d\u6211\u4eec\u8fd8\u9700\u8981\u4f7f\u7528\u4eff\u771f\u5668\u3002\u6211\u4eec\u8fd9\u5957\u5f00\u53d1\u677f\u9009\u7528ST\u516c\u53f8\u7684ST-Link V2\u4eff\u771f\u5668\u8fdb\u884c\u5f00\u53d1\u677f\u7a0b\u5e8f\u7684\u70e7\u5199\u548c\u4eff\u771f\uff0c\u4e0b\u9762\u4ecb\u7ecdST-Link\u9a71\u52a8\u7684\u5b89\u88c5\u53ca\u73af\u5883\u642d\u5efa\u3002 \u5728ST\u5b98\u7f51\u4e0b\u8f7dST-Link\u9a71\u52a8\uff0c https://www.st.com/content/st_com/zh/products/development-tools/software-development-tools/stm32-software-development-tools/stm32-utilities/stsw-link009.html \uff08\u9a71\u52a8\u67092\u79cd\uff1a 32\u4f4d\u7535\u8111\u7cfb\u7edf\u5b89\u88c5\u201cdpinst_x86\u201d\u300164\u4f4d\u7535\u8111\u7cfb\u7edf\u5b89\u88c5\u201cdpinst_amd64\u201d\uff09\u3002 \u8fd0\u884c\u5bf9\u5e94\u7684\u9a71\u52a8\uff0c\u5b89\u88c5ST-Link V2\u9a71\u52a8\u7a0b\u5e8f\u3002\u5b89\u88c5\u8def\u5f84\u5c3d\u91cf\u4fdd\u6301\u9ed8\u8ba4\u8def\u5f84\u3002 \u5b89\u88c5\u5b8c\u6210\u540e, \u5c06ST-Link\u901a\u8fc7USB\u63a5\u53e3\u8fde\u5165\u7535\u8111\u3002\u6253\u5f00\u201c\u8bbe\u5907\u7ba1\u7406\u5668\u201d\u3002\u82e5\u770b\u5230\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u8868\u793a\u9a71\u52a8\u5b89\u88c5\u6210\u529f\u3002 \u8fd9\u91cc\u63d0\u9192 2 \u70b9: 1\uff0c \u5404\u79cd windows \u7248\u672c\u8bbe\u5907\u540d\u79f0\u548c\u6240\u5728\u8bbe\u5907\u7ba1\u7406\u5668\u680f\u76ee\u53ef\u80fd\u4e0d\u4e00\u6837\uff0c\u4f8b\u5982 WIN10 \u63d2\u4e0aSTLINK \u540e\u663e\u793a\u7684\u662f STM32 STLINK\u3002 2\uff0c \u5982\u679c\u8bbe\u5907\u540d\u79f0\u65c1\u8fb9\u663e\u793a\u7684\u662f\u9ec4\u8272\u7684\u53f9\u53f7\uff0c\u8bf7\u76f4\u63a5\u70b9\u51fb\u8bbe\u5907\u540d\u79f0\uff0c\u7136\u540e\u5728\u5f39\u51fa\u7684\u754c\u9762\u70b9\u51fb\u66f4\u65b0\u8bbe\u5907\u9a71\u52a8 \u81f3\u6b64\uff0c ST-Link \u9a71\u52a8\u5df2\u7ecf\u5b89\u88c5\u5b8c\u6210\u3002\u63a5\u4e0b\u6765\u5927\u5bb6\u53ea\u9700\u8981\u5728 MDK\u5de5\u7a0b\u91cc\u9762\u914d\u7f6e\u4e00\u4e0b ST-Link\u5373\u53ef\u3002 2.5 \u7f16\u7a0b\u8f6f\u4ef6(MDK)\u914d\u7f6e \u5b89\u88c5\u9a71\u52a8\u6210\u529f\u540e\uff0c\u6253\u5f00MDK\u8f6f\u4ef6\uff0c\u914d\u7f6e\u7a0b\u5e8f\u70e7\u5199\u548c\u4eff\u771f\u7684\u73af\u5883\u3002 \u70b9\u51fb\u8fdb\u5165\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\u6309\u7ebd\uff0c\u8fdb\u5165\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\u3002 \u9009\u62e9Debug\u9009\u9879\uff0c\u8fdb\u5165\u4eff\u771f\u5668\u8bbe\u7f6e\u754c\u9762\u3002 \u4e0b\u62c9\u4eff\u771f\u5668\u9009\u62e9\u5217\u8868\uff0c\u9009\u7740ST-Link Debugger\u5e76\u52fe\u9009\u53f3\u4fa7Use,\u70b9\u51fbSettings\u8fdb\u5165ST-Link V2\u4eff\u771f\u5668\u914d\u7f6e\u754c\u9762\u3002 \u5f00\u53d1\u677f\u8bbe\u8ba1\u7684\u7a0b\u5e8f\u70e7\u5f55\u65b9\u5f0f\u4e3aSW\uff0c\u6b64\u5904Unit\u9009\u62e9ST-Link/V2,\u4e14Port\u9009\u62e9SW,\u5e76\u786e\u8ba4\u53f3\u4fa7\u6846\u5185\u662f\u5426\u68c0\u6d4b\u51faSW\u8bbe\u5907\uff0c\u70b9\u51fb<\u786e\u8ba4>\u4fdd\u5b58\u914d\u7f6e\u3002 2.6 \u4e32\u53e3\u8c03\u8bd5\u52a9\u624b\u7684\u5b89\u88c5\u4e0e\u4f7f\u7528 \u5de5\u5177\u4e0b\u8f7d\uff1a http://www.daxia.com/download/sscom.rar \u5b89\u88c5\u65b9\u6cd5\uff1a\u4e32\u53e3\u8c03\u8bd5\u52a9\u624bsscom5.13.1\u662f\u514d\u5b89\u88c5\u7684\uff0c\u89e3\u538b\u51fa\u538b\u7f29\u5305\u5373\u53ef\u76f4\u63a5\u4f7f\u7528\u3002 \u6839\u636ePC\u548c\u7ec8\u7aef\u4e4b\u95f4\u7684\u8fde\u63a5\uff0c\u9009\u62e9\u6b63\u786e\u7684\u4e32\u884c\u7aef\u53e3\u3002 \u6253\u5f00\u7535\u8111\u7684\u8bbe\u5907\u7ba1\u7406\u5668\uff0c\u5728\u7aef\u53e3\u5217\u8868\u53ef\u4ee5\u770b\u5230PC\u4e0e\u5f00\u53d1\u677f\u8fde\u63a5\u7684\u7aef\u53e3\u53f7\u3002 \u6211\u8fd9\u91cc\u663e\u793a\u7684\u662fCOM6\uff0c\u6240\u4ee5\u8981\u5728sscom\u5de5\u5177\u4e2d\u9009\u62e9COM6\uff0c\u5f00\u53d1\u677f\u7a0b\u5e8f\u6ce2\u7279\u7387\u8bbe\u7f6e\u4e3a115200\uff0c\u6240\u4ee5\u6211\u5728sscom\u4e32\u53e3\u5de5\u5177\u4e2d\u9009\u62e9115200\u6ce2\u7279\u7387\u3002 3. TencentOS tiny \u57fa\u7840\u5185\u6838\u5b9e\u9a8c 3.1 \u6253\u5f00 TencentOS tiny\u63d0\u4f9b\u7684 Hello_world \u5de5\u7a0b TencentOS tiny\u5b98\u65b9\u5f00\u6e90\u4ed3\u4e0b\u8f7d\u6e90\u7801\uff0c\u5730\u5740\u4e3a\uff1a https://github.com/Tencent/TencentOS-tiny \u8fdb\u5165 < TencentOS-tiny/board/NUCLEO_STM32L073RZ/KEIL/hello_world> \u76ee\u5f55\uff0c\u6253\u5f00TencentOS_tiny.uvprojx\u5de5\u7a0b\uff1a 3.2 \u7f16\u8bd1HelloWorld\u5de5\u7a0b \u6253\u5f00\u5de5\u7a0b\u540e\uff0c\u6211\u4eec\u5728\u5de6\u4fa7\u7684\u5de5\u7a0b\u6587\u4ef6\u5bfc\u822a\u9875\u9762\u5c55\u5f00examples\u76ee\u5f55\uff0c\u53ef\u4ee5\u770b\u5230helloworld.c\u6e90\u7801\uff0c\u8fd9\u91cc\u521b\u5efa\u4e86\u4e24\u4e2aTencentOS tiny\u7684\u4efb\u52a1\uff0c\u4ea4\u66ff\u8fd0\u884c\u6253\u5370\u4efb\u52a1\u3002\u5f00\u53d1\u8005\u5b89\u88c5\u4e0b\u56fe\u6307\u793a\uff0c\u70b9\u51fb\u7f16\u8bd1\u6309\u94ae\u5373\u53ef\u7f16\u8bd1\u5de5\u7a0b\uff0c\u5982\u56fe\uff1a 3.3 \u4e0b\u8f7d\u8fd0\u884c \u9996\u5148\u9700\u8981\u914d\u7f6e\u4e0b\u8f7d\u73af\u5883 \u6309\u4e0b\u56fe\u6240\u793a\u914d\u7f6e\u4e0b\u8f7d\u53c2\u6570 \u7f16\u8bd1\u5b8c\u6210\u540e\u70b9\u51fb\u5982\u56fe\u6240\u793a\u201dLOAD\u201d\u6309\u94ae\u4e0b\u8f7d\u7a0b\u5e8f\u5373\u53ef\u3002 3.4 \u67e5\u770b\u8fd0\u884c\u7ed3\u679c \u8fde\u63a5\u597d\u4e32\u53e3\uff0c\u5728PC\u7684\u4e32\u53e3\u52a9\u624b\u4e2d\u53ef\u4ee5\u770b\u5230TencentOS tiny\u7684\u4e24\u4e2a\u4efb\u52a1\u4ea4\u66ff\u8fd0\u884c\uff0c\u6253\u5370\u6d88\u606f\u5e76\u5b8c\u6210\u4efb\u52a1\u8ba1\u6570\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u66f4\u591aTencentOS tiny\u57fa\u7840\u5185\u6838\u7684\u4f7f\u7528\uff0c\u8bf7\u53c2\u8003\u5185\u6838\u5f00\u53d1\u6307\u5357\u6587\u6863\uff1a TencentOS_tiny\\doc\\04.TencentOS_tiny_Development_Guide.md TencentOS_tiny\\doc\\05.TencentOS_tiny_SDK_documentation.md 4. \u4f7f\u7528TencentOS tiny AT\u6846\u67b6\u9a71\u52a8LoRaWAN\u8282\u70b9\u5bf9\u63a5\u817e\u8baf\u4e91IoT Explorer \u672c\u5b9e\u9a8c\u4e2d\u5047\u8bbe\u4e00\u6b3e LoRa \u6e29\u6e7f\u5ea6\u4f20\u611f\u5668 \u63a5\u5165\u5230\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\uff0c\u901a\u8fc7\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u53ef\u4ee5\u8fdc\u7a0b\u67e5\u770b\u4f20\u611f\u5668\u7684\u6e29\u5ea6\u3001\u6e7f\u5ea6\uff0c\u5e76\u53ef\u8fdc\u7a0b\u914d\u7f6e\u4f20\u611f\u5668\u7684\u4e0a\u62a5\u5468\u671f\u3002\u672c\u6587\u6863\u4e3b\u8981\u6307\u5bfc\u60a8\u5982\u4f55\u5728\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u63a7\u5236\u53f0\u63a5\u5165 LoRa \u6e29\u6e7f\u5ea6\u4f20\u611f\u5668\u3002 4.1 \u63a7\u5236\u53f0\u64cd\u4f5c LoRa \u8282\u70b9 \u521b\u5efa\u9879\u76ee\u548c\u4ea7\u54c1 \u767b\u5f55 \u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u63a7\u5236\u53f0 \uff0c\u9009\u62e9\u3010\u65b0\u5efa\u9879\u76ee\u3011\u3002 \u5728\u65b0\u5efa\u9879\u76ee\u9875\u9762\uff0c\u586b\u5199\u9879\u76ee\u57fa\u672c\u4fe1\u606f\u540e\uff0c\u5355\u51fb\u3010\u4fdd\u5b58\u3011 \u9879\u76ee\u540d\u79f0\uff1a\u8f93\u5165\u201cLoRa \u6e29\u6e7f\u5ea6\u4f20\u611f\u5668\u6f14\u793a\u201d\u6216\u5176\u4ed6\u540d\u79f0\u3002 \u9879\u76ee\u63cf\u8ff0\uff1a\u6309\u7167\u5b9e\u9645\u9700\u6c42\u586b\u5199\u9879\u76ee\u63cf\u8ff0\u3002 \u9879\u76ee\u65b0\u5efa\u6210\u529f\u540e\uff0c\u5373\u53ef\u65b0\u5efa\u4ea7\u54c1\u3002 \u65b0\u5efa\u4ea7\u54c1 \u8fdb\u5165\u8be5\u9879\u76ee\u7684\u4ea7\u54c1\u5217\u8868\u9875\u9762\uff0c\u5355\u51fb\u3010\u65b0\u5efa\u4ea7\u54c1\u3011\u3002 \u5728\u65b0\u5efa\u4ea7\u54c1\u9875\u9762\uff0c\u586b\u5199\u4ea7\u54c1\u57fa\u672c\u4fe1\u606f\u3002 \u4ea7\u54c1\u540d\u79f0\uff1a\u8f93\u5165\u201c\u6e29\u6e7f\u5ea6\u4f20\u611f\u5668\u201d\u6216\u5176\u4ed6\u4ea7\u54c1\u540d\u79f0\u3002 \u4ea7\u54c1\u7c7b\u578b\uff1a\u9009\u62e9\u201c\u6e29\u6e7f\u5ea6\u4f20\u611f\u5668\u201d\u3002 \u8ba4\u8bc1\u65b9\u5f0f\uff1a\u9009\u62e9\u201c\u5bc6\u94a5\u8ba4\u8bc1\u201d\u3002 \u901a\u4fe1\u65b9\u5f0f\uff1a\u9009\u62e9\u201cLoRaWAN\u201d\u3002 \u4ea7\u54c1\u65b0\u5efa\u6210\u529f\u540e\uff0c\u60a8\u53ef\u5728\u4ea7\u54c1\u5217\u8868\u9875\u67e5\u770b\u201cLoRa \u6e29\u6e7f\u5ea6\u4f20\u611f\u5668\u201d\u3002 \u521b\u5efa\u6570\u636e\u6a21\u677f \u5355\u51fb\u4ea7\u54c1\u540d\u79f0\uff0c\u8fdb\u5165\u4ea7\u54c1\u914d\u7f6e\u9875\uff0c\u5728\u3010\u81ea\u5b9a\u4e49\u529f\u80fd\u3011\u914d\u7f6e\u9879\u4e0b\uff0c\u5355\u51fb\u3010\u65b0\u5efa\u529f\u80fd\u3011\uff0c\u81ea\u5b9a\u4e49\u4ea7\u54c1\u529f\u80fd\u3002 \u914d\u7f6e LoRaWAN \u53c2\u6570 \u5728\u8bbe\u5907\u5f00\u53d1\u9875\u9762\u4e2d\uff0c\u6309\u9700\u8c03\u6574 LoRaWAN \u53c2\u6570\u914d\u7f6e\u3002\u672c\u793a\u4f8b\u4e2d\u4f7f\u7528\u9ed8\u8ba4\u7684 OTAA \u914d\u7f6e\u3002 \u8bbe\u5907\u6570\u636e\u89e3\u6790 \u5728\u8bbe\u5907\u5f00\u53d1\u9875\u9762\u4e2d\uff0c\u6309\u9700\u8c03\u6574\u8bbe\u5907\u6570\u636e\u89e3\u6790\u3002\u7531\u4e8e LoRa \u7c7b\u8d44\u6e90\u6709\u9650\u8bbe\u5907\u4e0d\u9002\u5408\u76f4\u63a5\u4f20\u8f93 JSON \u683c\u5f0f\u6570\u636e\uff0c\u4f7f\u7528\u201c\u8bbe\u5907\u6570\u636e\u89e3\u6790\u201d\u53ef\u4ee5\u5c06\u8bbe\u5907\u539f\u59cb\u6570\u636e\u8f6c\u5316\u4e3a\u4ea7\u54c1 JSON \u6570\u636e\u3002 \u8bbe\u5907\u6570\u636e\u534f\u8bae \u5728\u672c\u793a\u4f8b\u4e2d\uff0c\u8bbe\u5907\u4e0a\u884c\u6570\u636e\u51714\u5b57\u8282\uff1a - \u7b2c1\u5b57\u8282\uff1a\u6e29\u5ea6\u3002 - \u7b2c2\u5b57\u8282\uff1a\u76f8\u5bf9\u6e7f\u5ea6\u3002 - \u7b2c3\u30014\u5b57\u8282\uff1a\u8868\u793a\u4e0a\u62a5\u5468\u671f\uff08\u5355\u4f4d\u79d2\uff09\u3002 - \u8bbe\u5907\u4e0b\u884c\u6570\u636e\u4e3a2\u5b57\u8282\uff1a\u4e0a\u62a5\u5468\u671f\uff08\u5355\u4f4d\u79d2\uff09\u3002 \u6570\u636e\u89e3\u6790\u811a\u672c \u4e0a\u884c\u6570\u636e\u89e3\u6790\u7684\u811a\u672c\u4e3b\u51fd\u6570\u4e3a RawToProtocol\uff0c\u5176\u5e26\u6709 fPort\u3001bytes \u4e24\u4e2a\u5165\u53c2\uff1a - fPort\uff1a\u8bbe\u5907\u4e0a\u62a5\u7684 LoRaWAN \u534f\u8bae\u6570\u636e\u7684 FPort \u5b57\u6bb5\u3002 - bytes\uff1a\u8bbe\u5907\u4e0a\u62a5\u7684 LoRaWAN \u534f\u8bae\u6570\u636e\u7684 FRMPayload \u5b57\u6bb5\u3002 \u811a\u672c\u4e3b\u51fd\u6570\u7684\u51fa\u53c2\u4e3a\u4ea7\u54c1\u6570\u636e\u6a21\u7248\u534f\u8bae\u683c\u5f0f\u7684\u5bf9\u8c61\u3002 \u5728\u4e0a\u884c\u6570\u636e\u89e3\u6790\u90e8\u5206\uff0cjavascript \u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a function RawToProtocol(fPort, bytes) { var data = { \"method\": \"report\", \"clientToken\" : new Date(), \"params\" : {} }; data.params.temperature = bytes[0]; data.params.humidity = bytes[1]; data.params.period = bytes[2] | (bytes[3] << 8); return data; } \u4e0b\u884c\u6570\u636e\u89e3\u6790\u7684\u811a\u672c\u4e3b\u51fd\u6570\u4e3a ProtocolToRaw\uff0c\u5176\u5165\u53c2\u4e3a\u4ea7\u54c1\u6570\u636e\u6a21\u7248\u534f\u8bae\u683c\u5f0f\u7684\u5bf9\u8c61\uff0c\u5176\u51fa\u53c2\u4e3a\u81f3\u5c113\u4e2a\u5b57\u8282\u7684\u6570\u7ec4\uff1a \u7b2c1\u5b57\u8282\uff1a\u4e0b\u53d1\u7ed9\u8bbe\u5907\u7684 LoRaWAN \u534f\u8bae\u6570\u636e\u7684 FPort \u5b57\u6bb5\u3002 \u7b2c2\u5b57\u8282\uff1abytes \u4e3a\u4e0b\u53d1\u7ed9\u8bbe\u5907\u7684 LoRaWAN \u534f\u8bae\u6570\u636e\u7684 MType\uff080\u8868\u793a Unconfirmed Data Down\uff0c1\u8868\u793a Confirmed Data Down\uff09\u3002 \u7b2c3\u5b57\u8282\uff1a\u5f00\u59cb\u4e3a\u4e0b\u53d1\u7ed9\u8bbe\u5907\u7684 LoRaWAN \u534f\u8bae\u6570\u636e\u7684 FRMPayload \u5b57\u6bb5\u3002 \u5728\u4e0b\u884c\u6570\u636e\u89e3\u6790\u90e8\u5206\uff0cjavascript \u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a function ProtocolToRaw(obj) { var data = new Array(); data[0] = 5;// fport=5 data[1] = 0;// unconfirmed mode data[2] = obj.params.period & 0x00FF; data[3] = (obj.params.period >> 8) & 0x00FF; return data; } \u811a\u672c\u6a21\u62df\u6d4b\u8bd5 \u60a8\u4e5f\u53ef\u4f7f\u7528\u6570\u636e\u89e3\u6790\u9875\u9762\u4e0b\u65b9\u7684\u6a21\u62df\u8c03\u8bd5\u5de5\u5177\uff0c\u5982\u9700\u5f00\u53d1\u66f4\u591a\u7684\u529f\u80fd\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u6a21\u62df\u811a\u672c\u3002 \u4e0a\u884c\u6d88\u606f \u8bbe\u5907\u539f\u59cb\u6570\u636e\u4e3a 0x113DB80B\uff0c\u6211\u4eec\u5c06\u5176\u8f6c\u5316\u4e3a\u6570\u7ec4\uff0c\u5373\u4e0a\u884c\u6a21\u62df\u6570\u636e\u4e3a\uff1a[17,69,30,0]\uff0c\u586b\u5165\u8bbe\u5907\u4e0a\u884c\u6570\u636e\u7684\u7f16\u8f91\u6846\u4e2d\u3002\u5355\u51fb\u3010\u8fd0\u884c\u3011\uff0c\u5373\u53ef\u5728\u6a21\u62df\u8c03\u8bd5\u754c\u9762\u53f3\u4fa7\u67e5\u770b\u7ed3\u679c\u3002 \u4e0b\u884c\u6d88\u606f \u6a21\u62df\u6d4b\u8bd5\u6570\u636e\u5982\u4e0b\uff0c\u5c06\u5176\u586b\u5165\u8bbe\u5907\u4e0b\u884c\u6570\u636e\u7684\u7f16\u8f91\u6846\u4e2d\uff1a { \"params\": { \"period\": 15 } } \u521b\u5efa\u6d4b\u8bd5\u8bbe\u5907 \u5728\u8bbe\u5907\u8c03\u8bd5\u9875\u9762\u4e2d\uff0c\u5355\u51fb\u3010\u65b0\u5efa\u8bbe\u5907\u3011\uff0c\u8bbe\u5907\u540d\u4e3a dev001\u3002 DevEUI \u7b49\u4fe1\u606f\u53ef\u4ece LoRa \u8282\u70b9\u5f00\u53d1\u677f\u80cc\u9762\u8d34\u7eb8\u4e0a\u83b7\u53d6\u3002 4.2 \u63a7\u5236\u53f0\u64cd\u4f5c LoRa \u7f51\u5173 \u767b\u5f55 \u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u63a7\u5236\u53f0 \uff0c\u9009\u62e9\u4e0a\u6587 \u201c\u63a7\u5236\u53f0\u64cd\u4f5c LoRa \u8282\u70b9\u201d \u4e2d\u5bf9\u5e94\u7684\u9879\u76ee\u3002 \u5728\u5de6\u4fa7\u5de5\u5177\u5217\u8868\u4e2d\uff0c\u9009\u62e9\u3010\u670d\u52a1\u4e2d\u5fc3\u3011>\u3010LoRa \u7f51\u5173\u7ba1\u7406\u3011\u3002 \u8fdb\u5165 LoRa \u7f51\u5173\u7ba1\u7406\u9875\u9762\uff0c\u9009\u62e9\u3010\u6dfb\u52a0\u7f51\u5173\u3011\u3002 \u5728\u65b0\u5efa\u7f51\u5173\u9875\u9762\uff0c\u586b\u5199\u7f51\u5173\u57fa\u672c\u4fe1\u606f\u3002 \u7f51\u5173\u540d\u79f0\uff1a\u672c\u793a\u4f8b\u4e2d\u586b\u5199 GW1\u3002 GwEUI\uff1a\u4e3a\u7f51\u5173\u552f\u4e00ID\u3002\u672c\u4f8b\u4e2d\u6839\u636e ST NUCLEO LoRa GW \u80cc\u90e8\u7684 MAC \u5730\u5740\uff0c\u5c066\u5b57\u8282 MAC \u5730\u5740\u7684\u4e2d\u95f4\u8865\u8db30xffff\u3002 \u662f\u5426\u516c\u5f00\uff1a\u9009\u62e9\u201c\u662f\u201d\uff0c\u8868\u793a\u793e\u533a\u5f00\u53d1\u8005\u53ef\u5728\u793e\u533a\u7f51\u7edc\u67e5\u770b\u8be5\u7f51\u5173\uff0c\u5e76\u53ef\u901a\u8fc7\u8fd9\u4e2a\u7f51\u5173\u8fdb\u884c LoRa \u8282\u70b9\u63a5\u5165\uff1b\u9009\u62e9\u201c\u5426\u201d\uff0c\u5219\u4ec5\u7528\u6237\u81ea\u5df1\u80fd\u67e5\u770b\u8be5\u7f51\u5173\u3002 \u7f51\u5173\u65b0\u5efa\u6210\u529f\u540e\uff0c\u60a8\u53ef\u5728\u7f51\u5173\u5217\u8868\u9875\u67e5\u770b\u201cGW1\u201d\u3002 4.3 LoRa\u7f51\u5173\u5b9e\u7269\u64cd\u4f5c \u786c\u4ef6\u8fde\u63a5 \u6574\u4e2a\u7cfb\u7edf\u642d\u5efa\u9700\u8981\u7531LRWAN_GS_LF1\u7f51\u5173\uff08\u7f51\u5173\u6a21\u7ec4\u548c STM32F746 Nucleo\u6838\u5fc3\u677f\uff09\u30015V\u9002\u914d\u5668\u548c\u7535\u8111\u7ec4\u6210\u3002 \u5148\u4f7f\u7528 5V \u9002\u914d\u5668\u901a\u8fc7 USB \u7ebf\u8fde\u63a5\u5230 LRWAN_GS_LF1 \u7f51\u5173\u7684\u7f51\u5173\u6a21\u7ec4\u4e0a\u7684 Micro USB \u63a5\u53e3\uff0c\u7ed9\u6574\u4e2a\u7f51\u5173\u4f9b\u7535\u3002 Nucleo \u6838\u5fc3\u677f\u4e0a\u7684 Micro USB \u53e3\uff08\u975e\u4ee5\u592a\u7f51\u53e3\u90a3\u8fb9\u7684 Micro USB \u53e3\uff09\uff0c\u901a\u8fc7 USB \u7ebf\u8fde\u63a5\u5230 PC \u7aef\uff0c\u53ef\u4ee5\u5b9e\u73b0\u865a\u62df\u4e32\u53e3\u7684\u529f\u80fd\u3002 \u7f51\u5173\u5f00\u53d1\u677f\u901a\u8fc7\u7f51\u7ebf\u8fde\u63a5\u5230\u4e0a\u4e00\u7ea7\u8def\u7531\u5668\u7684 LAN \u53e3\uff0c\u4ece\u800c\u53ef\u4ee5\u5b9e\u73b0 DHCP \u7684\u65b9\u5f0f\u8fde\u63a5\u4ee5\u592a\u7f51\u3002 \u4e32\u53e3\u51c6\u5907 \u786c\u4ef6\u8fde\u63a5\u6210\u529f\u540e\uff0c\u6253\u5f00 PC \u4e0a\u7684\u8bbe\u5907\u7ba1\u7406\u5668\uff0c\u5373\u53ef\u67e5\u770b\u7f51\u5173\u6240\u5bf9\u5e94\u7684\u4e32\u53e3\uff08\u8bf7\u786e\u4fdd\u5df2\u5b89\u88c5 stlink \u9a71\u52a8\uff09\u3002 \u6253\u5f00\u4e32\u53e3\u5de5\u5177\uff0c\u505a\u597d\u76f8\u5e94\u914d\u7f6e\u540e\uff0c\u6253\u5f00\u4e32\u53e3\u3002 \u7aef\u53e3\u53f7\u3002\u672c\u4f8b\u4e2d\u4e3a COM5\u3002 \u6ce2\u7279\u7387\u3002\u672c\u4f8b\u4e2d\u4e3a 115200\u3002 \u914d\u7f6e\u4fee\u6539 \u8bf7\u6309\u7167\u5982\u4e0b\u6b65\u9aa4\u5b8c\u6210\u76f8\u5173\u914d\u7f6e\uff1a 1. \u6309\u7167\u4e0a\u56fe\u5b8c\u6210\u786c\u4ef6\u8fde\u63a5\u548c\u7cfb\u7edf\u642d\u5efa\u3002 2. \u914d\u7f6e\u670d\u52a1\u5668\u5730\u5740\u3002\u672c\u793a\u4f8b\u4e2d\u8bbe\u7f6e\u7684\u662f\u817e\u8baf\u4e91\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u7684 LoRa \u670d\u52a1\u5668\u5730\u5740\uff08\u63a5\u5165\u57df\u540d\uff1a loragw.things.qcloud.com \uff0c\u63a5\u5165\u7aef\u53e3\uff1a1700\uff09\u3002 AT+PKTFWD=loragw.things.qcloud.com,1700,1700 \u914d\u7f6e\u9891\u7387\u8ba1\u5212\u3002\u8c03\u6574\u9891\u70b9\u4fe1\u606f\u5230486.3MHz - 487.7 MHz\uff0c\u6307\u4ee4\u4fee\u6539\u5982\u4e0b\uff08\u9700\u8981\u9010\u6761\u53d1\u9001\uff09\uff1a AT+CH=0,486.3,A AT+CH=1,486.5,A AT+CH=2,486.7,A AT+CH=3,486.9,A AT+CH=4,487.1,B AT+CH=5,487.3,B AT+CH=6,487.5,B AT+CH=7,487.7,B AT+CH=8,OFF AT+CH=9,OFF \u793a\u4f8b\u622a\u56fe\u5982\u4e0b\u6240\u793a\uff1a 4. \u5176\u4ed6\u6307\u4ee4\u3002 - \u901a\u8fc7\u201cAT+log=on\u201d\u6253\u5f00\u7f51\u5173\u65e5\u5fd7\u3002 - \u901a\u8fc7\u201cAT+EUI\u201d\u67e5\u8be2\u7f51\u5173\u7684 ID\u3002 \u8fd0\u884c \u901a\u8fc7 AT+Reset \u5373\u53ef\u590d\u4f4d\u7f51\u5173\uff0c\u5f00\u59cb\u670d\u52a1\u5668\u8fde\u63a5\u3002 \u4ece\u4e32\u53e3\u65e5\u5fd7\u67e5\u770b\uff1a LORAWAN SERVER: loragw.things.qcloud.com \u8868\u660e\u670d\u52a1\u5668\u5730\u5740\u4fee\u6539\u6210\u529f\u3002 Ethernet started DHCP IP: 192.168.3.249 Downlink UDP Connected Uplink UDP Connected \u8868\u660e\u7f51\u5173 DHCP \u5165\u7f51\u6210\u529f\uff0c\u7f51\u7edc\u8fde\u63a5\u6b63\u5e38\u3002 4.4 LoRa \u8282\u70b9\u5b9e\u7269\u64cd\u4f5c \u7f16\u8bd1\u53ca\u4e0b\u8f7d Step 1. \u4e0b\u8f7d LoRaWAN \u4f8b\u7a0b \u8bf7\u4e0b\u8f7d TencentOS tiny \u5b98\u65b9\u5f00\u6e90\u4ed3 \u4e0b\u8f7d\u6e90\u7801 \u3002 \u8fdb\u5165 <TencentOS-tiny\\board\\NUCLEO_STM32L073RZ\\KEIL\\lorawan> \u76ee\u5f55\uff0c\u6253\u5f00 TencentOS_tiny.uvprojx \u5de5\u7a0b\u3002 \u793a\u4f8b\u5de5\u7a0b\u5305\u542b STM32L073 \u5916\u8bbe\u9a71\u52a8\u3001TencentOS tiny \u5185\u6838\u3001AT \u6846\u67b6\u3001RHF76 LoRaWAN \u6a21\u7ec4\u9a71\u52a8\u3001LoRaWAN \u793a\u4f8b\u6848\u4f8b\u3002 Step 2. \u4ee3\u7801\u4fee\u6539 \u8bf7\u5148\u4fee\u6539 \\examples\\LoRaWAN\\lora_demo.c. \u3002 tos_lora_module_join_otaa(\"8cf957200000f806\", \"8cf957200000f8061b39aaaaad204a72\"); \u586b\u5165\u8282\u70b9\u76f8\u5e94\u7684 DevEUI \u548c AppKEY\uff0c\u53ef\u4ece LoRa \u8282\u70b9\u5f00\u53d1\u677f\u80cc\u9762\u8d34\u7eb8\u4e0a\u83b7\u53d6\u3002 2. \u4fee\u6539 \\devices\\rhf76_lora\\RHF76.h \u3002 #define RHF76_ATCMD_SET_CHANNEL \"at+ch=num,0-7\\r\\n\" \u7531\u4e8e\u672c\u793a\u4f8b\u4e2d\u8ba1\u5212\u4f7f\u752880 - 87\u4fe1\u9053\uff0c\u56e0\u6b64\u8c03\u6574\u4e3a\uff1a #define RHF76_ATCMD_SET_CHANNEL \"at+ch=num,80-87\\r\\n\" Step 3. \u7f16\u8bd1 \u5355\u51fb MDK \u5de5\u5177\u680f\u3010Rebuild All\u3011\uff0c\u7f16\u8bd1\u6574\u4e2a\u5de5\u7a0b\u3002 Step 4. \u4e0b\u8f7d \u5355\u51fb MDK \u5de5\u5177\u680f\u3010Download\u3011\uff0c\u4e0b\u8f7d\u7f16\u8bd1\u597d\u7684\u56fa\u4ef6\u3002 \u67e5\u770b\u8fd0\u884c\u7ed3\u679c \u8282\u70b9\u4e0b\u8f7d\u597d\u56fa\u4ef6\u540e\uff0c\u4f1a\u81ea\u52a8\u91cd\u542f\u8fd0\u884c\uff0c\u4ece\u4e32\u53e3\u5373\u53ef\u67e5\u770b\u8bbe\u5907\u7684\u8fd0\u884c\u65e5\u5fd7\u3002 \u5f53\u60a8\u770b\u5230\u4e32\u53e3\u6253\u5370\u5982\u4e0b\u65e5\u5fd7\uff0c\u5373\u8bf4\u660e LoRa \u8282\u70b9\u5df2\u7ecf\u901a\u8fc7\u7f51\u5173\u6210\u529f\u5165\u7f51\u3002 --->+JOIN: Network joined --->+JOIN: NetID 000035 DevAddr 6B:CC:9B:5D 4.5 \u67e5\u770b\u8bbe\u5907\u72b6\u6001 \u4fdd\u6301 LoRa \u8282\u70b9\u548c LoRa \u7f51\u5173 \u4e3a\u8fd0\u884c\u72b6\u6001\u3002 \u8fdb\u5165\u3010\u63a7\u5236\u53f0\u3011>\u3010\u4ea7\u54c1\u5f00\u53d1\u3011>\u3010\u8bbe\u5907\u8c03\u8bd5\u3011\uff0c\u53ef\u67e5\u770b\u5230\u8bbe\u5907 \"dev001\" \u3002 \u5355\u51fb\u3010\u8c03\u8bd5\u3011\uff0c\u53ef\u8fdb\u5165\u8bbe\u5907\u8be6\u60c5\u9875\u3002 \u5355\u51fb\u3010\u8bbe\u5907\u5c5e\u6027\u3011\uff0c\u53ef\u67e5\u8be2\u8bbe\u5907\u4e0a\u62a5\u5230\u5f00\u53d1\u5e73\u53f0\u7684\u6700\u65b0\u6570\u636e\u53ca\u5386\u53f2\u6570\u636e\u3002 \u8bbe\u5907\u5c5e\u6027\u7684\u6700\u65b0\u503c\uff1a\u4f1a\u663e\u793a\u8bbe\u5907\u4e0a\u62a5\u7684\u6700\u65b0\u6570\u636e\u3002 \u8bbe\u5907\u5c5e\u6027\u7684\u66f4\u65b0\u65f6\u95f4\uff1a\u663e\u793a\u6570\u636e\u7684\u66f4\u65b0\u65f6\u95f4\u3002 \u5355\u51fb\u3010\u67e5\u770b\u3011\uff0c\u53ef\u67e5\u770b\u67d0\u4e2a\u5c5e\u6027\u7684\u5386\u53f2\u4e0a\u62a5\u6570\u636e\u3002 4.6 \u67e5\u770b\u8bbe\u5907\u901a\u4fe1\u65e5\u5fd7 \u5355\u51fb\u3010\u8bbe\u5907\u65e5\u5fd7\u3011\uff0c\u53ef\u67e5\u8be2\u8be5\u8bbe\u5907\u67d0\u6bb5\u65f6\u95f4\u8303\u56f4\u7684\u6240\u6709\u4e0a\u4e0b\u884c\u6570\u636e\u3002 - \u4e0a\u884c\uff1a\u4e0a\u884c\u6307\u8bbe\u5907\u7aef\u4e0a\u62a5\u5230\u5f00\u53d1\u5e73\u53f0\u7684\u6570\u636e\u3002 - \u4e0b\u884c\uff1a\u4e0b\u884c\u6307\u4ece\u5f00\u53d1\u5e73\u53f0\u4e0b\u53d1\u5230\u8bbe\u5907\u7684\u6570\u636e\u3002 4.7 \u5728\u7ebf\u8c03\u8bd5 \u5f53 LoRa \u8282\u70b9 \u6210\u529f\u8fde\u63a5\u5230\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u540e\uff0c\u60a8\u53ef\u5728\u63a7\u5236\u53f0\u3010\u8bbe\u5907\u8c03\u8bd5\u3011\u5217\u8868\uff0c\u5355\u51fb\u3010\u8c03\u8bd5\u3011\uff0c\u8fdb\u5165\u5728\u7ebf\u8c03\u8bd5\u3002 \u5c06\u201c\u4e0a\u62a5\u5468\u671f\u201d\u8bbe\u7f6e\u4e3a15\u79d2\uff0c\u5355\u51fb\u3010\u53d1\u9001\u3011\u3002 \u67e5\u770b LoRa \u8282\u70b9\u7684\u4e32\u53e3\u65e5\u5fd7\uff0c\u53ef\u67e5\u770b\u5df2\u6210\u529f\u63a5\u6536\u5230\u4e0b\u53d1\u7684\u6570\u636e\u3002 ? \u7531\u4e8e\u672c\u793a\u4f8b\u4e2d LoRa \u8282\u70b9\u662f LoRaWAN Class A \u7c7b\u8bbe\u5907\uff0c\u8fd9\u7c7b\u8bbe\u5907\u4e0d\u4f1a\u7acb\u5373\u4e0b\u53d1\u6570\u636e\uff0c\u9700\u8981\u5728\u6709\u6570\u636e\u4e0a\u884c\u540e\uff0c\u670d\u52a1\u5668\u624d\u4f1a\u5411\u8be5\u8bbe\u5907\u4e0b\u884c\u6570\u636e\u3002 \u56e0\u6b64\u5728 LoRa \u8282\u70b9\u4e0a\u62a5\u6570\u636e\u4e4b\u540e\uff0c\u624d\u80fd\u67e5\u770b\u4e0b\u53d1\u7684\u5468\u671f\u8c03\u6574\u547d\u4ee4\u3002 LoRa \u8282\u70b9\u7684\u4e32\u53e3\u4f1a\u663e\u793a\u5982\u4e0b\u65e5\u5fd7\uff0c\u8868\u793a\u6210\u529f\u4e0b\u53d1\u4e86\u6307\u4ee4\u5230\u8bbe\u5907\u7aef\u3002 rhf76_incoming_data_process 4: 0F00 len: 2 data[0]: 15 data[1]: 0 report_period: 15","title":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#tencentos-tiny-lorawan","text":"","title":"\u57fa\u4e8e TencentOS tiny \u7684 LoRaWAN \u5f00\u53d1\u5165\u95e8\u6307\u5357"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#1-st-p-nucleo-lrwan3","text":"","title":"1. ST P-NUCLEO-LRWAN3\u5957\u4ef6\u7b80\u4ecb"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#11","text":"P-NUCLEO-LRWAN3\u662f\u5b8c\u6574\u7684\u5957\u4ef6\uff0c\u5305\u62ec\u7f51\u5173\u548c\u8282\u70b9\uff0c\u53ef\u7528\u4e8e\u8bc4\u4f30LoRaWAN\u7f51\u7edc\u3002\u4f7f\u7528\u8be5\u5957\u4ef6\uff0c\u7528\u6237\u53ef\u4ee5\u8f7b\u677e\u8bbe\u7f6eLPWAN\u7f51\u7edc\uff0c\u5e2e\u52a9\u7528\u6237\u5b66\u4e60LoRaWAN\u6280\u672f\uff0c\u4e86\u89e3\u5982\u4f55\u5728\u81ea\u5df1\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f7f\u7528LoRaWAN\u6280\u672f\u3002 LoRa\u7f51\u5173\u5957\u4ef6\u7531ST Nucleo-F746ZG\u5e95\u677f\u548c\u745e\u5174\u6052\u65b9\u57fa\u4e8eSX1301\u7684LRWAN_GS\u6a21\u5757\u7ec4\u6210\u3002 ST Nucleo LoRa\u8282\u70b9\u5957\u4ef6\u7531LRWAN_NS1\u6269\u5c55\u677f\u548cST Nucleo-L073\u5e95\u677f\u7ec4\u6210\u3002\u5176\u4e2d LRWAN_NS1\u6269\u5c55\u677f\u96c6\u6210\u745e\u5174\u6052\u65b9\u7684RHF0M003 LoRaWAN\u6a21\u7ec4\uff0c\u5e76\u96c6\u6210\u4e86\u6e29\u6e7f\u5ea6\u4f20\u611f\u5668HTS221\u3001\u6c14\u538b\u4f20\u611f\u5668LPS22HB\u30013\u8f74\u78c1\u529b\u4f20\u611f\u5668LIS3MDL\u30016\u8f74\u59ff\u6001\u4f20\u611f\u5668LSM6DS3\u51714\u4e2aI2C\u4f20\u611f\u5668\u4ef6\u3002 \u5f00\u53d1\u5957\u4ef6\u5b9e\u7269\u56fe\u5982\u4e0b\uff1a","title":"1.1 \u5f00\u53d1\u5957\u4ef6\u7b80\u4ecb"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#12-lorawan","text":"","title":"1.2 LoRaWAN\u8282\u70b9\u786c\u4ef6\u8be6\u89e3"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#121-nucleo-l073rz-cortex-m0","text":"NUCLEO-L073RZ\u57fa\u4e8eNUCLEO 64\u516c\u7248PCB\u8bbe\u8ba1\uff0c\u53ef\u4ee5\u65b9\u4fbf\u7684\u66f4\u6362ST\u7684\u5176\u5b8364PIN MCU\u3002\u4e3b\u8981\u7279\u6027\u5305\u62ec\uff1a LQFP64 STM32-L073RZT6 MCU 20KB SRAM 192KB Flash 6KB data EEPROM \u4e24\u79cd\u7c7b\u578b\u6269\u5c55\u63a5\u53e3\uff1aArduino UNO\u6269\u5c55\u63a5\u53e3\uff1bSTM32 MORPHO\u6269\u5c55\u63a5\u53e3 \u677f\u8f7dST-LINK/V2-1\u8c03\u8bd5/\u7f16\u7a0b\u5668 \u7075\u6d3b\u7684\u4f9b\u7535\u65b9\u5f0f\u9009\u62e9 \u677f\u8f7d3\u4e2aLED\u706f\uff0cLD1\u3001LD3\u6307\u793a\u5de5\u4f5c\u72b6\u6001\uff0cLD2\u4e3a\u7528\u6237\u53ef\u7f16\u7a0bLED\u706f \u4e24\u4e2a\u6309\u94ae\uff0c\u590d\u4f4d\u53ca\u7528\u6237\u53ef\u7f16\u7a0b\u6309\u94ae USB\u91cd\u679a\u4e3e\u80fd\u529b\uff0c\u652f\u6301VCP\uff0cMSD\uff0cDEBUG\u529f\u80fd \u5927\u91cfIDE\u5f00\u53d1\u73af\u5883\u652f\u6301 \u6269\u5c55\u63a5\u53e3\u5982\u4e0b\u56fe\u6240\u793a\uff1a","title":"1.2.1  NUCLEO-L073RZ \u57fa\u4e8eCORTEX-M0+\u7684\u8bc4\u4f30\u677f"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#122-lrwan_ns1","text":"1\uff09\u6269\u5c55\u677f\u63a5\u53e3\u517c\u5bb9Arduino UNO\u63a5\u53e3\uff0c\u539f\u7406\u56fe\u5982\u4e0b\uff1a 2\uff09 \u6269\u5c55\u677f\u4e0a\u540c\u4e00\u4e2aI2C\u7aef\u53e3\uff0c\u6302\u8f7d\u4e864\u4e2aI2C\u63a5\u53e3\u7684\u4f20\u611f\u5668\uff0c\u5206\u522b\u662f\u6e29\u6e7f\u5ea6\u4f20\u611f\u5668HTS221\u3001\u6c14\u538b\u4f20\u611f\u5668LPS22HB\u30013\u8f74\u78c1\u529b\u4f20\u611f\u5668LIS3MDL\u30016\u8f74\u59ff\u6001\u4f20\u611f\u5668LSM6DS3\uff0c\u539f\u7406\u56fe\u5982\u4e0b\uff1a 3\uff09LoRaWAN\u901a\u4fe1\u6a21\u7ec4\u7535\u8def\u539f\u7406\u56fe","title":"1.2.2 LRWAN_NS1 \u6269\u5c55\u677f\u786c\u4ef6"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#2-lorawan","text":"","title":"2. LoRaWAN\u8282\u70b9\u8f6f\u4ef6\u5f00\u53d1\u73af\u5883\u51c6\u5907"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#21-mdk","text":"MDK \u5373RealView MDK \u6216MDK-ARM\uff08Microcontroller Development kit\uff09\uff0c\u662f ARM \u516c\u53f8\u6536\u8d2dKeil\u516c\u53f8\u4ee5\u540e\uff0c\u57fa\u4e8euVision\u754c\u9762\u63a8\u51fa\u7684\u9488\u5bf9ARM7\u3001ARM9\u3001Cortex-M0\u3001Cortex-M1\u3001Cortex-M2\u3001Cortex-M3\u3001Cortex-R4\u7b49ARM\u5904\u7406\u5668\u7684\u5d4c\u5165\u5f0f\u8f6f\u4ef6\u5f00\u53d1\u5de5\u5177\u3002MDK-ARM \u96c6\u6210\u4e86\u4e1a\u5185\u6700\u9886\u5148\u7684\u6280\u672f\uff0c\u5305\u62ec uVision4 \u96c6\u6210\u5f00\u53d1\u73af\u5883\u4e0e RealView \u7f16\u8bd1\u5668RVCT\u3002\u652f\u6301 ARM7\u3001ARM9 \u548c\u6700\u65b0\u7684Cortex-M3/M1/M0 \u6838\u5904\u7406\u5668\uff0c\u81ea\u52a8\u914d\u7f6e\u542f\u52a8\u4ee3\u7801\uff0c\u96c6\u6210 Flash \u70e7\u5199\u6a21\u5757\uff0c\u5f3a\u5927\u7684 Simulation \u8bbe\u5907\u6a21\u62df\uff0c\u6027\u80fd\u5206\u6790\u7b49\u529f\u80fd\uff0c\u4e0e ARM \u4e4b\u524d\u7684\u5de5\u5177\u5305 ADS \u7b49\u76f8\u6bd4\uff0cRealView \u7f16\u8bd1\u5668\u7684\u6700\u65b0\u7248\u672c\u53ef\u5c06\u6027\u80fd\u6539\u5584\u8d85\u8fc7 20%\u3002 Keil\u516c\u53f8\u5f00\u53d1\u7684ARM\u5f00\u53d1\u5de5\u5177MDK\uff0c\u662f\u7528\u6765\u5f00\u53d1\u57fa\u4e8eARM\u6838\u7684\u7cfb\u5217\u5fae\u63a7\u5236\u5668\u7684\u5d4c\u5165\u5f0f\u5e94\u7528\u7a0b\u5e8f\u3002\u5b83\u9002\u5408\u4e0d\u540c\u5c42\u6b21\u7684\u5f00\u53d1\u8005\u4f7f\u7528\uff0c\u5305\u62ec\u4e13\u4e1a\u7684\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u5de5\u7a0b\u5e08\u548c\u5d4c\u5165\u5f0f\u8f6f\u4ef6\u5f00\u53d1\u7684\u5165\u95e8\u8005\u3002MDK\u5305\u542b\u4e86\u5de5\u4e1a\u6807\u51c6\u7684Keil C\u7f16\u8bd1\u5668\u3001\u5b8f\u6c47\u7f16\u5668\u3001\u8c03\u8bd5\u5668\u3001\u5b9e\u65f6\u5185\u6838\u7b49\u7ec4\u4ef6\uff0c\u652f\u6301\u6240\u6709\u57fa\u4e8eARM\u7684\u8bbe\u5907\uff0c\u80fd\u5e2e\u52a9\u5de5\u7a0b\u5e08\u6309\u7167\u8ba1\u5212\u5b8c\u6210\u9879\u76ee\u3002","title":"2.1 MDK\u8f6f\u4ef6\u4ecb\u7ecd"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#22-mdk","text":"\u70b9\u51fb\u4e0b\u9762\u7684\u5730\u5740\u4e0b\u8f7dMDK\u8f6f\u4ef6\uff0c\u8f6f\u4ef6\u7248\u672c\u6700\u597d\u662f5.24\u53ca\u4ee5\u4e0a\uff1a https://www.keil.com/download/product/ \u6559\u7a0b\u4ee55.24\u7248\u672c\u4e3a\u4f8b\uff0c\u53cc\u51fbMDK524\u5e94\u7528\u7a0b\u5e8f\u6587\u4ef6\uff0c\u70b9\u51fbnext>>\u3002 \u6253\u4e0a I agree\u524d\u9762\u7684\u52fe\u52fe\uff0c\u5373\u662f\u540c\u610f\u4e00\u4e9b\u5b89\u88c5\u534f\u8bae\u3002\u70b9\u51fbnext>>\u3002 \u9009\u62e9\u5b89\u88c5\u8def\u5f84\uff0c\u53ef\u4ee5\u9ed8\u8ba4\u4e5f\u53ef\u4ee5\u5b89\u88c5\u5728\u6211\u4eec\u81ea\u5df1\u5efa\u7acb\u7684\u6587\u4ef6\u5939\u4e0b\u3002\u70b9\u51fbnext>>\u3002 \u8fd9\u91cc\u586b\u5199\u7684\u662f\u6211\u4eec\u7684\u4e00\u4e9b\u4fe1\u606f\uff0c\u586b\u5199\u5b8c\u6574\u540e\uff0c\u7ee7\u7eednext>>\u3002 \u7136\u540e\u7b49\u5f85\u5b89\u88c5\u5b8c\u6210\u5373\u53ef\u3002 \u5b89\u88c5\u5b8c\u6210\uff0c\u70b9\u51fbFinish\u3002 \u7136\u540e\u4f1a\u8df3\u51fa\u6765\u8fd9\u4e2a\u754c\u9762\uff0c\u8fd9\u4e2a\u6211\u4eec\u540e\u9762\u518d\u8bb2\uff0c\u5148\u70b9OK\uff0c\u628a\u5f39\u6846\u90fd\u53c9\u6389\u3002 \u6fc0\u6d3bMDK\uff0c\u5bfc\u5165License,\u6fc0\u6d3bMDK\u540e\u4fbf\u53ef\u4f7f\u7528\u4e86\u3002 \u7279\u522b\u63d0\u793a\uff1a\u4e00\u5b9a\u8981\u8f93\u5165License\u6fc0\u6d3bMDK\u8f6f\u4ef6\uff0c\u8bf7\u8d2d\u4e70\u6b63\u7248License\u3002","title":"2.2 MDK\u5b89\u88c5"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#23-pack","text":"\u5b89\u88c5\u5b8cMDK\u540e\uff0c\u6211\u4eec\u9700\u8981\u5b89\u88c5\u5f00\u53d1\u5957\u4ef6\u4e2d\u5355\u7247\u673a\u578b\u53f7\u5bf9\u5e94\u7684Pack\u3002 \u5b89\u88c5\u65b9\u5f0f\u4e00\uff1a\u767b\u5f55\u5b98\u7f51\uff1ahttp://www.keil.com/dd2/pack/ \u4e0b\u8f7dKeil.STM32L0xx_DFP.2.0.0.pack \u540e\u5b89\u88c5\uff0c\u5982\u4e0b\u56fe \u5b89\u88c5\u65b9\u5f0f\u4e8c\uff1aMDK\u8f6f\u4ef6\u4e0a\u5728\u7ebf\u5b89\u88c5 \u6253\u5f00\u8f6f\u4ef6\uff0c\u5728\u5bfc\u822a\u680f\u6253\u5f00Pack\u5b89\u88c5\u754c\u9762\uff0c\u7136\u540e\u9009\u62e9ok\u9009\u9879\u3002 \u8fdb\u5165\u5728\u7ebf\u5b89\u88c5\u754c\u9762\uff0c\u9009\u7740STM32L0XX Pack,\u70b9\u51fbInstall\u8fdb\u884c\u5b89\u88c5\u3002 \u81f3\u6b64\uff0c\u6211\u4eec\u5f00\u53d1\u677f\u7684\u5355\u7247\u673a\u7a0b\u5e8f\u5f00\u53d1\u73af\u5883\u5df2\u7ecf\u642d\u5efa\u5b8c\u6bd5\uff0c\u91cd\u542fMDK\u8f6f\u4ef6\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002","title":"2.3 Pack\u5b89\u88c5"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#24-st-link","text":"\u524d\u9762\u8bb2\u4e86\u5f00\u53d1\u677f\u5355\u7247\u673a\u7a0b\u5e8f\u7684\u5f00\u53d1\u73af\u5883\u7684\u642d\u5efa\uff0c\u4f46\u662f\u4e3a\u4e86\u5c06\u7a0b\u5e8f\u70e7\u5f55\u5230\u5f00\u53d1\u677f\u4e2d\u6211\u4eec\u8fd8\u9700\u8981\u4f7f\u7528\u4eff\u771f\u5668\u3002\u6211\u4eec\u8fd9\u5957\u5f00\u53d1\u677f\u9009\u7528ST\u516c\u53f8\u7684ST-Link V2\u4eff\u771f\u5668\u8fdb\u884c\u5f00\u53d1\u677f\u7a0b\u5e8f\u7684\u70e7\u5199\u548c\u4eff\u771f\uff0c\u4e0b\u9762\u4ecb\u7ecdST-Link\u9a71\u52a8\u7684\u5b89\u88c5\u53ca\u73af\u5883\u642d\u5efa\u3002 \u5728ST\u5b98\u7f51\u4e0b\u8f7dST-Link\u9a71\u52a8\uff0c https://www.st.com/content/st_com/zh/products/development-tools/software-development-tools/stm32-software-development-tools/stm32-utilities/stsw-link009.html \uff08\u9a71\u52a8\u67092\u79cd\uff1a 32\u4f4d\u7535\u8111\u7cfb\u7edf\u5b89\u88c5\u201cdpinst_x86\u201d\u300164\u4f4d\u7535\u8111\u7cfb\u7edf\u5b89\u88c5\u201cdpinst_amd64\u201d\uff09\u3002 \u8fd0\u884c\u5bf9\u5e94\u7684\u9a71\u52a8\uff0c\u5b89\u88c5ST-Link V2\u9a71\u52a8\u7a0b\u5e8f\u3002\u5b89\u88c5\u8def\u5f84\u5c3d\u91cf\u4fdd\u6301\u9ed8\u8ba4\u8def\u5f84\u3002 \u5b89\u88c5\u5b8c\u6210\u540e, \u5c06ST-Link\u901a\u8fc7USB\u63a5\u53e3\u8fde\u5165\u7535\u8111\u3002\u6253\u5f00\u201c\u8bbe\u5907\u7ba1\u7406\u5668\u201d\u3002\u82e5\u770b\u5230\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u8868\u793a\u9a71\u52a8\u5b89\u88c5\u6210\u529f\u3002 \u8fd9\u91cc\u63d0\u9192 2 \u70b9: 1\uff0c \u5404\u79cd windows \u7248\u672c\u8bbe\u5907\u540d\u79f0\u548c\u6240\u5728\u8bbe\u5907\u7ba1\u7406\u5668\u680f\u76ee\u53ef\u80fd\u4e0d\u4e00\u6837\uff0c\u4f8b\u5982 WIN10 \u63d2\u4e0aSTLINK \u540e\u663e\u793a\u7684\u662f STM32 STLINK\u3002 2\uff0c \u5982\u679c\u8bbe\u5907\u540d\u79f0\u65c1\u8fb9\u663e\u793a\u7684\u662f\u9ec4\u8272\u7684\u53f9\u53f7\uff0c\u8bf7\u76f4\u63a5\u70b9\u51fb\u8bbe\u5907\u540d\u79f0\uff0c\u7136\u540e\u5728\u5f39\u51fa\u7684\u754c\u9762\u70b9\u51fb\u66f4\u65b0\u8bbe\u5907\u9a71\u52a8 \u81f3\u6b64\uff0c ST-Link \u9a71\u52a8\u5df2\u7ecf\u5b89\u88c5\u5b8c\u6210\u3002\u63a5\u4e0b\u6765\u5927\u5bb6\u53ea\u9700\u8981\u5728 MDK\u5de5\u7a0b\u91cc\u9762\u914d\u7f6e\u4e00\u4e0b ST-Link\u5373\u53ef\u3002","title":"2.4 ST-Link\u9a71\u52a8\u5b89\u88c5"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#25-mdk","text":"\u5b89\u88c5\u9a71\u52a8\u6210\u529f\u540e\uff0c\u6253\u5f00MDK\u8f6f\u4ef6\uff0c\u914d\u7f6e\u7a0b\u5e8f\u70e7\u5199\u548c\u4eff\u771f\u7684\u73af\u5883\u3002 \u70b9\u51fb\u8fdb\u5165\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\u6309\u7ebd\uff0c\u8fdb\u5165\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\u3002 \u9009\u62e9Debug\u9009\u9879\uff0c\u8fdb\u5165\u4eff\u771f\u5668\u8bbe\u7f6e\u754c\u9762\u3002 \u4e0b\u62c9\u4eff\u771f\u5668\u9009\u62e9\u5217\u8868\uff0c\u9009\u7740ST-Link Debugger\u5e76\u52fe\u9009\u53f3\u4fa7Use,\u70b9\u51fbSettings\u8fdb\u5165ST-Link V2\u4eff\u771f\u5668\u914d\u7f6e\u754c\u9762\u3002 \u5f00\u53d1\u677f\u8bbe\u8ba1\u7684\u7a0b\u5e8f\u70e7\u5f55\u65b9\u5f0f\u4e3aSW\uff0c\u6b64\u5904Unit\u9009\u62e9ST-Link/V2,\u4e14Port\u9009\u62e9SW,\u5e76\u786e\u8ba4\u53f3\u4fa7\u6846\u5185\u662f\u5426\u68c0\u6d4b\u51faSW\u8bbe\u5907\uff0c\u70b9\u51fb<\u786e\u8ba4>\u4fdd\u5b58\u914d\u7f6e\u3002","title":"2.5 \u7f16\u7a0b\u8f6f\u4ef6(MDK)\u914d\u7f6e"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#26","text":"\u5de5\u5177\u4e0b\u8f7d\uff1a http://www.daxia.com/download/sscom.rar \u5b89\u88c5\u65b9\u6cd5\uff1a\u4e32\u53e3\u8c03\u8bd5\u52a9\u624bsscom5.13.1\u662f\u514d\u5b89\u88c5\u7684\uff0c\u89e3\u538b\u51fa\u538b\u7f29\u5305\u5373\u53ef\u76f4\u63a5\u4f7f\u7528\u3002 \u6839\u636ePC\u548c\u7ec8\u7aef\u4e4b\u95f4\u7684\u8fde\u63a5\uff0c\u9009\u62e9\u6b63\u786e\u7684\u4e32\u884c\u7aef\u53e3\u3002 \u6253\u5f00\u7535\u8111\u7684\u8bbe\u5907\u7ba1\u7406\u5668\uff0c\u5728\u7aef\u53e3\u5217\u8868\u53ef\u4ee5\u770b\u5230PC\u4e0e\u5f00\u53d1\u677f\u8fde\u63a5\u7684\u7aef\u53e3\u53f7\u3002 \u6211\u8fd9\u91cc\u663e\u793a\u7684\u662fCOM6\uff0c\u6240\u4ee5\u8981\u5728sscom\u5de5\u5177\u4e2d\u9009\u62e9COM6\uff0c\u5f00\u53d1\u677f\u7a0b\u5e8f\u6ce2\u7279\u7387\u8bbe\u7f6e\u4e3a115200\uff0c\u6240\u4ee5\u6211\u5728sscom\u4e32\u53e3\u5de5\u5177\u4e2d\u9009\u62e9115200\u6ce2\u7279\u7387\u3002","title":"2.6 \u4e32\u53e3\u8c03\u8bd5\u52a9\u624b\u7684\u5b89\u88c5\u4e0e\u4f7f\u7528"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#3-tencentos-tiny","text":"","title":"3. TencentOS tiny \u57fa\u7840\u5185\u6838\u5b9e\u9a8c"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#31-tencentos-tiny-hello_world","text":"TencentOS tiny\u5b98\u65b9\u5f00\u6e90\u4ed3\u4e0b\u8f7d\u6e90\u7801\uff0c\u5730\u5740\u4e3a\uff1a https://github.com/Tencent/TencentOS-tiny \u8fdb\u5165 < TencentOS-tiny/board/NUCLEO_STM32L073RZ/KEIL/hello_world> \u76ee\u5f55\uff0c\u6253\u5f00TencentOS_tiny.uvprojx\u5de5\u7a0b\uff1a","title":"3.1 \u6253\u5f00 TencentOS tiny\u63d0\u4f9b\u7684 Hello_world \u5de5\u7a0b"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#32-helloworld","text":"\u6253\u5f00\u5de5\u7a0b\u540e\uff0c\u6211\u4eec\u5728\u5de6\u4fa7\u7684\u5de5\u7a0b\u6587\u4ef6\u5bfc\u822a\u9875\u9762\u5c55\u5f00examples\u76ee\u5f55\uff0c\u53ef\u4ee5\u770b\u5230helloworld.c\u6e90\u7801\uff0c\u8fd9\u91cc\u521b\u5efa\u4e86\u4e24\u4e2aTencentOS tiny\u7684\u4efb\u52a1\uff0c\u4ea4\u66ff\u8fd0\u884c\u6253\u5370\u4efb\u52a1\u3002\u5f00\u53d1\u8005\u5b89\u88c5\u4e0b\u56fe\u6307\u793a\uff0c\u70b9\u51fb\u7f16\u8bd1\u6309\u94ae\u5373\u53ef\u7f16\u8bd1\u5de5\u7a0b\uff0c\u5982\u56fe\uff1a","title":"3.2 \u7f16\u8bd1HelloWorld\u5de5\u7a0b"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#33","text":"\u9996\u5148\u9700\u8981\u914d\u7f6e\u4e0b\u8f7d\u73af\u5883 \u6309\u4e0b\u56fe\u6240\u793a\u914d\u7f6e\u4e0b\u8f7d\u53c2\u6570 \u7f16\u8bd1\u5b8c\u6210\u540e\u70b9\u51fb\u5982\u56fe\u6240\u793a\u201dLOAD\u201d\u6309\u94ae\u4e0b\u8f7d\u7a0b\u5e8f\u5373\u53ef\u3002","title":"3.3 \u4e0b\u8f7d\u8fd0\u884c"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#34","text":"\u8fde\u63a5\u597d\u4e32\u53e3\uff0c\u5728PC\u7684\u4e32\u53e3\u52a9\u624b\u4e2d\u53ef\u4ee5\u770b\u5230TencentOS tiny\u7684\u4e24\u4e2a\u4efb\u52a1\u4ea4\u66ff\u8fd0\u884c\uff0c\u6253\u5370\u6d88\u606f\u5e76\u5b8c\u6210\u4efb\u52a1\u8ba1\u6570\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u66f4\u591aTencentOS tiny\u57fa\u7840\u5185\u6838\u7684\u4f7f\u7528\uff0c\u8bf7\u53c2\u8003\u5185\u6838\u5f00\u53d1\u6307\u5357\u6587\u6863\uff1a TencentOS_tiny\\doc\\04.TencentOS_tiny_Development_Guide.md TencentOS_tiny\\doc\\05.TencentOS_tiny_SDK_documentation.md","title":"3.4 \u67e5\u770b\u8fd0\u884c\u7ed3\u679c"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#4-tencentos-tiny-atlorawaniot-explorer","text":"\u672c\u5b9e\u9a8c\u4e2d\u5047\u8bbe\u4e00\u6b3e LoRa \u6e29\u6e7f\u5ea6\u4f20\u611f\u5668 \u63a5\u5165\u5230\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\uff0c\u901a\u8fc7\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u53ef\u4ee5\u8fdc\u7a0b\u67e5\u770b\u4f20\u611f\u5668\u7684\u6e29\u5ea6\u3001\u6e7f\u5ea6\uff0c\u5e76\u53ef\u8fdc\u7a0b\u914d\u7f6e\u4f20\u611f\u5668\u7684\u4e0a\u62a5\u5468\u671f\u3002\u672c\u6587\u6863\u4e3b\u8981\u6307\u5bfc\u60a8\u5982\u4f55\u5728\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u63a7\u5236\u53f0\u63a5\u5165 LoRa \u6e29\u6e7f\u5ea6\u4f20\u611f\u5668\u3002","title":"4. \u4f7f\u7528TencentOS tiny AT\u6846\u67b6\u9a71\u52a8LoRaWAN\u8282\u70b9\u5bf9\u63a5\u817e\u8baf\u4e91IoT Explorer"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#41-lora","text":"","title":"4.1 \u63a7\u5236\u53f0\u64cd\u4f5c LoRa \u8282\u70b9"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#_1","text":"\u767b\u5f55 \u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u63a7\u5236\u53f0 \uff0c\u9009\u62e9\u3010\u65b0\u5efa\u9879\u76ee\u3011\u3002 \u5728\u65b0\u5efa\u9879\u76ee\u9875\u9762\uff0c\u586b\u5199\u9879\u76ee\u57fa\u672c\u4fe1\u606f\u540e\uff0c\u5355\u51fb\u3010\u4fdd\u5b58\u3011 \u9879\u76ee\u540d\u79f0\uff1a\u8f93\u5165\u201cLoRa \u6e29\u6e7f\u5ea6\u4f20\u611f\u5668\u6f14\u793a\u201d\u6216\u5176\u4ed6\u540d\u79f0\u3002 \u9879\u76ee\u63cf\u8ff0\uff1a\u6309\u7167\u5b9e\u9645\u9700\u6c42\u586b\u5199\u9879\u76ee\u63cf\u8ff0\u3002 \u9879\u76ee\u65b0\u5efa\u6210\u529f\u540e\uff0c\u5373\u53ef\u65b0\u5efa\u4ea7\u54c1\u3002","title":"\u521b\u5efa\u9879\u76ee\u548c\u4ea7\u54c1"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#_2","text":"\u8fdb\u5165\u8be5\u9879\u76ee\u7684\u4ea7\u54c1\u5217\u8868\u9875\u9762\uff0c\u5355\u51fb\u3010\u65b0\u5efa\u4ea7\u54c1\u3011\u3002 \u5728\u65b0\u5efa\u4ea7\u54c1\u9875\u9762\uff0c\u586b\u5199\u4ea7\u54c1\u57fa\u672c\u4fe1\u606f\u3002 \u4ea7\u54c1\u540d\u79f0\uff1a\u8f93\u5165\u201c\u6e29\u6e7f\u5ea6\u4f20\u611f\u5668\u201d\u6216\u5176\u4ed6\u4ea7\u54c1\u540d\u79f0\u3002 \u4ea7\u54c1\u7c7b\u578b\uff1a\u9009\u62e9\u201c\u6e29\u6e7f\u5ea6\u4f20\u611f\u5668\u201d\u3002 \u8ba4\u8bc1\u65b9\u5f0f\uff1a\u9009\u62e9\u201c\u5bc6\u94a5\u8ba4\u8bc1\u201d\u3002 \u901a\u4fe1\u65b9\u5f0f\uff1a\u9009\u62e9\u201cLoRaWAN\u201d\u3002 \u4ea7\u54c1\u65b0\u5efa\u6210\u529f\u540e\uff0c\u60a8\u53ef\u5728\u4ea7\u54c1\u5217\u8868\u9875\u67e5\u770b\u201cLoRa \u6e29\u6e7f\u5ea6\u4f20\u611f\u5668\u201d\u3002","title":"\u65b0\u5efa\u4ea7\u54c1"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#_3","text":"\u5355\u51fb\u4ea7\u54c1\u540d\u79f0\uff0c\u8fdb\u5165\u4ea7\u54c1\u914d\u7f6e\u9875\uff0c\u5728\u3010\u81ea\u5b9a\u4e49\u529f\u80fd\u3011\u914d\u7f6e\u9879\u4e0b\uff0c\u5355\u51fb\u3010\u65b0\u5efa\u529f\u80fd\u3011\uff0c\u81ea\u5b9a\u4e49\u4ea7\u54c1\u529f\u80fd\u3002","title":"\u521b\u5efa\u6570\u636e\u6a21\u677f"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#lorawan","text":"\u5728\u8bbe\u5907\u5f00\u53d1\u9875\u9762\u4e2d\uff0c\u6309\u9700\u8c03\u6574 LoRaWAN \u53c2\u6570\u914d\u7f6e\u3002\u672c\u793a\u4f8b\u4e2d\u4f7f\u7528\u9ed8\u8ba4\u7684 OTAA \u914d\u7f6e\u3002","title":"\u914d\u7f6e LoRaWAN \u53c2\u6570"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#_4","text":"\u5728\u8bbe\u5907\u5f00\u53d1\u9875\u9762\u4e2d\uff0c\u6309\u9700\u8c03\u6574\u8bbe\u5907\u6570\u636e\u89e3\u6790\u3002\u7531\u4e8e LoRa \u7c7b\u8d44\u6e90\u6709\u9650\u8bbe\u5907\u4e0d\u9002\u5408\u76f4\u63a5\u4f20\u8f93 JSON \u683c\u5f0f\u6570\u636e\uff0c\u4f7f\u7528\u201c\u8bbe\u5907\u6570\u636e\u89e3\u6790\u201d\u53ef\u4ee5\u5c06\u8bbe\u5907\u539f\u59cb\u6570\u636e\u8f6c\u5316\u4e3a\u4ea7\u54c1 JSON \u6570\u636e\u3002","title":"\u8bbe\u5907\u6570\u636e\u89e3\u6790"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#_5","text":"\u5728\u672c\u793a\u4f8b\u4e2d\uff0c\u8bbe\u5907\u4e0a\u884c\u6570\u636e\u51714\u5b57\u8282\uff1a - \u7b2c1\u5b57\u8282\uff1a\u6e29\u5ea6\u3002 - \u7b2c2\u5b57\u8282\uff1a\u76f8\u5bf9\u6e7f\u5ea6\u3002 - \u7b2c3\u30014\u5b57\u8282\uff1a\u8868\u793a\u4e0a\u62a5\u5468\u671f\uff08\u5355\u4f4d\u79d2\uff09\u3002 - \u8bbe\u5907\u4e0b\u884c\u6570\u636e\u4e3a2\u5b57\u8282\uff1a\u4e0a\u62a5\u5468\u671f\uff08\u5355\u4f4d\u79d2\uff09\u3002","title":"\u8bbe\u5907\u6570\u636e\u534f\u8bae"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#_6","text":"\u4e0a\u884c\u6570\u636e\u89e3\u6790\u7684\u811a\u672c\u4e3b\u51fd\u6570\u4e3a RawToProtocol\uff0c\u5176\u5e26\u6709 fPort\u3001bytes \u4e24\u4e2a\u5165\u53c2\uff1a - fPort\uff1a\u8bbe\u5907\u4e0a\u62a5\u7684 LoRaWAN \u534f\u8bae\u6570\u636e\u7684 FPort \u5b57\u6bb5\u3002 - bytes\uff1a\u8bbe\u5907\u4e0a\u62a5\u7684 LoRaWAN \u534f\u8bae\u6570\u636e\u7684 FRMPayload \u5b57\u6bb5\u3002 \u811a\u672c\u4e3b\u51fd\u6570\u7684\u51fa\u53c2\u4e3a\u4ea7\u54c1\u6570\u636e\u6a21\u7248\u534f\u8bae\u683c\u5f0f\u7684\u5bf9\u8c61\u3002 \u5728\u4e0a\u884c\u6570\u636e\u89e3\u6790\u90e8\u5206\uff0cjavascript \u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a function RawToProtocol(fPort, bytes) { var data = { \"method\": \"report\", \"clientToken\" : new Date(), \"params\" : {} }; data.params.temperature = bytes[0]; data.params.humidity = bytes[1]; data.params.period = bytes[2] | (bytes[3] << 8); return data; } \u4e0b\u884c\u6570\u636e\u89e3\u6790\u7684\u811a\u672c\u4e3b\u51fd\u6570\u4e3a ProtocolToRaw\uff0c\u5176\u5165\u53c2\u4e3a\u4ea7\u54c1\u6570\u636e\u6a21\u7248\u534f\u8bae\u683c\u5f0f\u7684\u5bf9\u8c61\uff0c\u5176\u51fa\u53c2\u4e3a\u81f3\u5c113\u4e2a\u5b57\u8282\u7684\u6570\u7ec4\uff1a \u7b2c1\u5b57\u8282\uff1a\u4e0b\u53d1\u7ed9\u8bbe\u5907\u7684 LoRaWAN \u534f\u8bae\u6570\u636e\u7684 FPort \u5b57\u6bb5\u3002 \u7b2c2\u5b57\u8282\uff1abytes \u4e3a\u4e0b\u53d1\u7ed9\u8bbe\u5907\u7684 LoRaWAN \u534f\u8bae\u6570\u636e\u7684 MType\uff080\u8868\u793a Unconfirmed Data Down\uff0c1\u8868\u793a Confirmed Data Down\uff09\u3002 \u7b2c3\u5b57\u8282\uff1a\u5f00\u59cb\u4e3a\u4e0b\u53d1\u7ed9\u8bbe\u5907\u7684 LoRaWAN \u534f\u8bae\u6570\u636e\u7684 FRMPayload \u5b57\u6bb5\u3002 \u5728\u4e0b\u884c\u6570\u636e\u89e3\u6790\u90e8\u5206\uff0cjavascript \u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a function ProtocolToRaw(obj) { var data = new Array(); data[0] = 5;// fport=5 data[1] = 0;// unconfirmed mode data[2] = obj.params.period & 0x00FF; data[3] = (obj.params.period >> 8) & 0x00FF; return data; }","title":"\u6570\u636e\u89e3\u6790\u811a\u672c"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#_7","text":"\u60a8\u4e5f\u53ef\u4f7f\u7528\u6570\u636e\u89e3\u6790\u9875\u9762\u4e0b\u65b9\u7684\u6a21\u62df\u8c03\u8bd5\u5de5\u5177\uff0c\u5982\u9700\u5f00\u53d1\u66f4\u591a\u7684\u529f\u80fd\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u6a21\u62df\u811a\u672c\u3002 \u4e0a\u884c\u6d88\u606f \u8bbe\u5907\u539f\u59cb\u6570\u636e\u4e3a 0x113DB80B\uff0c\u6211\u4eec\u5c06\u5176\u8f6c\u5316\u4e3a\u6570\u7ec4\uff0c\u5373\u4e0a\u884c\u6a21\u62df\u6570\u636e\u4e3a\uff1a[17,69,30,0]\uff0c\u586b\u5165\u8bbe\u5907\u4e0a\u884c\u6570\u636e\u7684\u7f16\u8f91\u6846\u4e2d\u3002\u5355\u51fb\u3010\u8fd0\u884c\u3011\uff0c\u5373\u53ef\u5728\u6a21\u62df\u8c03\u8bd5\u754c\u9762\u53f3\u4fa7\u67e5\u770b\u7ed3\u679c\u3002 \u4e0b\u884c\u6d88\u606f \u6a21\u62df\u6d4b\u8bd5\u6570\u636e\u5982\u4e0b\uff0c\u5c06\u5176\u586b\u5165\u8bbe\u5907\u4e0b\u884c\u6570\u636e\u7684\u7f16\u8f91\u6846\u4e2d\uff1a { \"params\": { \"period\": 15 } }","title":"\u811a\u672c\u6a21\u62df\u6d4b\u8bd5"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#_8","text":"\u5728\u8bbe\u5907\u8c03\u8bd5\u9875\u9762\u4e2d\uff0c\u5355\u51fb\u3010\u65b0\u5efa\u8bbe\u5907\u3011\uff0c\u8bbe\u5907\u540d\u4e3a dev001\u3002 DevEUI \u7b49\u4fe1\u606f\u53ef\u4ece LoRa \u8282\u70b9\u5f00\u53d1\u677f\u80cc\u9762\u8d34\u7eb8\u4e0a\u83b7\u53d6\u3002","title":"\u521b\u5efa\u6d4b\u8bd5\u8bbe\u5907"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#42-lora","text":"\u767b\u5f55 \u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u63a7\u5236\u53f0 \uff0c\u9009\u62e9\u4e0a\u6587 \u201c\u63a7\u5236\u53f0\u64cd\u4f5c LoRa \u8282\u70b9\u201d \u4e2d\u5bf9\u5e94\u7684\u9879\u76ee\u3002 \u5728\u5de6\u4fa7\u5de5\u5177\u5217\u8868\u4e2d\uff0c\u9009\u62e9\u3010\u670d\u52a1\u4e2d\u5fc3\u3011>\u3010LoRa \u7f51\u5173\u7ba1\u7406\u3011\u3002 \u8fdb\u5165 LoRa \u7f51\u5173\u7ba1\u7406\u9875\u9762\uff0c\u9009\u62e9\u3010\u6dfb\u52a0\u7f51\u5173\u3011\u3002 \u5728\u65b0\u5efa\u7f51\u5173\u9875\u9762\uff0c\u586b\u5199\u7f51\u5173\u57fa\u672c\u4fe1\u606f\u3002 \u7f51\u5173\u540d\u79f0\uff1a\u672c\u793a\u4f8b\u4e2d\u586b\u5199 GW1\u3002 GwEUI\uff1a\u4e3a\u7f51\u5173\u552f\u4e00ID\u3002\u672c\u4f8b\u4e2d\u6839\u636e ST NUCLEO LoRa GW \u80cc\u90e8\u7684 MAC \u5730\u5740\uff0c\u5c066\u5b57\u8282 MAC \u5730\u5740\u7684\u4e2d\u95f4\u8865\u8db30xffff\u3002 \u662f\u5426\u516c\u5f00\uff1a\u9009\u62e9\u201c\u662f\u201d\uff0c\u8868\u793a\u793e\u533a\u5f00\u53d1\u8005\u53ef\u5728\u793e\u533a\u7f51\u7edc\u67e5\u770b\u8be5\u7f51\u5173\uff0c\u5e76\u53ef\u901a\u8fc7\u8fd9\u4e2a\u7f51\u5173\u8fdb\u884c LoRa \u8282\u70b9\u63a5\u5165\uff1b\u9009\u62e9\u201c\u5426\u201d\uff0c\u5219\u4ec5\u7528\u6237\u81ea\u5df1\u80fd\u67e5\u770b\u8be5\u7f51\u5173\u3002 \u7f51\u5173\u65b0\u5efa\u6210\u529f\u540e\uff0c\u60a8\u53ef\u5728\u7f51\u5173\u5217\u8868\u9875\u67e5\u770b\u201cGW1\u201d\u3002","title":"4.2 \u63a7\u5236\u53f0\u64cd\u4f5c LoRa \u7f51\u5173"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#43-lora","text":"","title":"4.3 LoRa\u7f51\u5173\u5b9e\u7269\u64cd\u4f5c"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#_9","text":"\u6574\u4e2a\u7cfb\u7edf\u642d\u5efa\u9700\u8981\u7531LRWAN_GS_LF1\u7f51\u5173\uff08\u7f51\u5173\u6a21\u7ec4\u548c STM32F746 Nucleo\u6838\u5fc3\u677f\uff09\u30015V\u9002\u914d\u5668\u548c\u7535\u8111\u7ec4\u6210\u3002 \u5148\u4f7f\u7528 5V \u9002\u914d\u5668\u901a\u8fc7 USB \u7ebf\u8fde\u63a5\u5230 LRWAN_GS_LF1 \u7f51\u5173\u7684\u7f51\u5173\u6a21\u7ec4\u4e0a\u7684 Micro USB \u63a5\u53e3\uff0c\u7ed9\u6574\u4e2a\u7f51\u5173\u4f9b\u7535\u3002 Nucleo \u6838\u5fc3\u677f\u4e0a\u7684 Micro USB \u53e3\uff08\u975e\u4ee5\u592a\u7f51\u53e3\u90a3\u8fb9\u7684 Micro USB \u53e3\uff09\uff0c\u901a\u8fc7 USB \u7ebf\u8fde\u63a5\u5230 PC \u7aef\uff0c\u53ef\u4ee5\u5b9e\u73b0\u865a\u62df\u4e32\u53e3\u7684\u529f\u80fd\u3002 \u7f51\u5173\u5f00\u53d1\u677f\u901a\u8fc7\u7f51\u7ebf\u8fde\u63a5\u5230\u4e0a\u4e00\u7ea7\u8def\u7531\u5668\u7684 LAN \u53e3\uff0c\u4ece\u800c\u53ef\u4ee5\u5b9e\u73b0 DHCP \u7684\u65b9\u5f0f\u8fde\u63a5\u4ee5\u592a\u7f51\u3002","title":"\u786c\u4ef6\u8fde\u63a5"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#_10","text":"\u786c\u4ef6\u8fde\u63a5\u6210\u529f\u540e\uff0c\u6253\u5f00 PC \u4e0a\u7684\u8bbe\u5907\u7ba1\u7406\u5668\uff0c\u5373\u53ef\u67e5\u770b\u7f51\u5173\u6240\u5bf9\u5e94\u7684\u4e32\u53e3\uff08\u8bf7\u786e\u4fdd\u5df2\u5b89\u88c5 stlink \u9a71\u52a8\uff09\u3002 \u6253\u5f00\u4e32\u53e3\u5de5\u5177\uff0c\u505a\u597d\u76f8\u5e94\u914d\u7f6e\u540e\uff0c\u6253\u5f00\u4e32\u53e3\u3002 \u7aef\u53e3\u53f7\u3002\u672c\u4f8b\u4e2d\u4e3a COM5\u3002 \u6ce2\u7279\u7387\u3002\u672c\u4f8b\u4e2d\u4e3a 115200\u3002","title":"\u4e32\u53e3\u51c6\u5907"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#_11","text":"\u8bf7\u6309\u7167\u5982\u4e0b\u6b65\u9aa4\u5b8c\u6210\u76f8\u5173\u914d\u7f6e\uff1a 1. \u6309\u7167\u4e0a\u56fe\u5b8c\u6210\u786c\u4ef6\u8fde\u63a5\u548c\u7cfb\u7edf\u642d\u5efa\u3002 2. \u914d\u7f6e\u670d\u52a1\u5668\u5730\u5740\u3002\u672c\u793a\u4f8b\u4e2d\u8bbe\u7f6e\u7684\u662f\u817e\u8baf\u4e91\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u7684 LoRa \u670d\u52a1\u5668\u5730\u5740\uff08\u63a5\u5165\u57df\u540d\uff1a loragw.things.qcloud.com \uff0c\u63a5\u5165\u7aef\u53e3\uff1a1700\uff09\u3002 AT+PKTFWD=loragw.things.qcloud.com,1700,1700 \u914d\u7f6e\u9891\u7387\u8ba1\u5212\u3002\u8c03\u6574\u9891\u70b9\u4fe1\u606f\u5230486.3MHz - 487.7 MHz\uff0c\u6307\u4ee4\u4fee\u6539\u5982\u4e0b\uff08\u9700\u8981\u9010\u6761\u53d1\u9001\uff09\uff1a AT+CH=0,486.3,A AT+CH=1,486.5,A AT+CH=2,486.7,A AT+CH=3,486.9,A AT+CH=4,487.1,B AT+CH=5,487.3,B AT+CH=6,487.5,B AT+CH=7,487.7,B AT+CH=8,OFF AT+CH=9,OFF \u793a\u4f8b\u622a\u56fe\u5982\u4e0b\u6240\u793a\uff1a 4. \u5176\u4ed6\u6307\u4ee4\u3002 - \u901a\u8fc7\u201cAT+log=on\u201d\u6253\u5f00\u7f51\u5173\u65e5\u5fd7\u3002 - \u901a\u8fc7\u201cAT+EUI\u201d\u67e5\u8be2\u7f51\u5173\u7684 ID\u3002","title":"\u914d\u7f6e\u4fee\u6539"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#_12","text":"\u901a\u8fc7 AT+Reset \u5373\u53ef\u590d\u4f4d\u7f51\u5173\uff0c\u5f00\u59cb\u670d\u52a1\u5668\u8fde\u63a5\u3002 \u4ece\u4e32\u53e3\u65e5\u5fd7\u67e5\u770b\uff1a LORAWAN SERVER: loragw.things.qcloud.com \u8868\u660e\u670d\u52a1\u5668\u5730\u5740\u4fee\u6539\u6210\u529f\u3002 Ethernet started DHCP IP: 192.168.3.249 Downlink UDP Connected Uplink UDP Connected \u8868\u660e\u7f51\u5173 DHCP \u5165\u7f51\u6210\u529f\uff0c\u7f51\u7edc\u8fde\u63a5\u6b63\u5e38\u3002","title":"\u8fd0\u884c"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#44-lora","text":"","title":"4.4 LoRa \u8282\u70b9\u5b9e\u7269\u64cd\u4f5c"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#_13","text":"","title":"\u7f16\u8bd1\u53ca\u4e0b\u8f7d"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#step-1-lorawan","text":"\u8bf7\u4e0b\u8f7d TencentOS tiny \u5b98\u65b9\u5f00\u6e90\u4ed3 \u4e0b\u8f7d\u6e90\u7801 \u3002 \u8fdb\u5165 <TencentOS-tiny\\board\\NUCLEO_STM32L073RZ\\KEIL\\lorawan> \u76ee\u5f55\uff0c\u6253\u5f00 TencentOS_tiny.uvprojx \u5de5\u7a0b\u3002 \u793a\u4f8b\u5de5\u7a0b\u5305\u542b STM32L073 \u5916\u8bbe\u9a71\u52a8\u3001TencentOS tiny \u5185\u6838\u3001AT \u6846\u67b6\u3001RHF76 LoRaWAN \u6a21\u7ec4\u9a71\u52a8\u3001LoRaWAN \u793a\u4f8b\u6848\u4f8b\u3002","title":"Step 1. \u4e0b\u8f7d LoRaWAN \u4f8b\u7a0b"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#step-2","text":"\u8bf7\u5148\u4fee\u6539 \\examples\\LoRaWAN\\lora_demo.c. \u3002 tos_lora_module_join_otaa(\"8cf957200000f806\", \"8cf957200000f8061b39aaaaad204a72\"); \u586b\u5165\u8282\u70b9\u76f8\u5e94\u7684 DevEUI \u548c AppKEY\uff0c\u53ef\u4ece LoRa \u8282\u70b9\u5f00\u53d1\u677f\u80cc\u9762\u8d34\u7eb8\u4e0a\u83b7\u53d6\u3002 2. \u4fee\u6539 \\devices\\rhf76_lora\\RHF76.h \u3002 #define RHF76_ATCMD_SET_CHANNEL \"at+ch=num,0-7\\r\\n\" \u7531\u4e8e\u672c\u793a\u4f8b\u4e2d\u8ba1\u5212\u4f7f\u752880 - 87\u4fe1\u9053\uff0c\u56e0\u6b64\u8c03\u6574\u4e3a\uff1a #define RHF76_ATCMD_SET_CHANNEL \"at+ch=num,80-87\\r\\n\"","title":"Step 2. \u4ee3\u7801\u4fee\u6539"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#step-3","text":"\u5355\u51fb MDK \u5de5\u5177\u680f\u3010Rebuild All\u3011\uff0c\u7f16\u8bd1\u6574\u4e2a\u5de5\u7a0b\u3002","title":"Step 3. \u7f16\u8bd1"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#step-4","text":"\u5355\u51fb MDK \u5de5\u5177\u680f\u3010Download\u3011\uff0c\u4e0b\u8f7d\u7f16\u8bd1\u597d\u7684\u56fa\u4ef6\u3002","title":"Step 4. \u4e0b\u8f7d"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#_14","text":"\u8282\u70b9\u4e0b\u8f7d\u597d\u56fa\u4ef6\u540e\uff0c\u4f1a\u81ea\u52a8\u91cd\u542f\u8fd0\u884c\uff0c\u4ece\u4e32\u53e3\u5373\u53ef\u67e5\u770b\u8bbe\u5907\u7684\u8fd0\u884c\u65e5\u5fd7\u3002 \u5f53\u60a8\u770b\u5230\u4e32\u53e3\u6253\u5370\u5982\u4e0b\u65e5\u5fd7\uff0c\u5373\u8bf4\u660e LoRa \u8282\u70b9\u5df2\u7ecf\u901a\u8fc7\u7f51\u5173\u6210\u529f\u5165\u7f51\u3002 --->+JOIN: Network joined --->+JOIN: NetID 000035 DevAddr 6B:CC:9B:5D","title":"\u67e5\u770b\u8fd0\u884c\u7ed3\u679c"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#45","text":"\u4fdd\u6301 LoRa \u8282\u70b9\u548c LoRa \u7f51\u5173 \u4e3a\u8fd0\u884c\u72b6\u6001\u3002 \u8fdb\u5165\u3010\u63a7\u5236\u53f0\u3011>\u3010\u4ea7\u54c1\u5f00\u53d1\u3011>\u3010\u8bbe\u5907\u8c03\u8bd5\u3011\uff0c\u53ef\u67e5\u770b\u5230\u8bbe\u5907 \"dev001\" \u3002 \u5355\u51fb\u3010\u8c03\u8bd5\u3011\uff0c\u53ef\u8fdb\u5165\u8bbe\u5907\u8be6\u60c5\u9875\u3002 \u5355\u51fb\u3010\u8bbe\u5907\u5c5e\u6027\u3011\uff0c\u53ef\u67e5\u8be2\u8bbe\u5907\u4e0a\u62a5\u5230\u5f00\u53d1\u5e73\u53f0\u7684\u6700\u65b0\u6570\u636e\u53ca\u5386\u53f2\u6570\u636e\u3002 \u8bbe\u5907\u5c5e\u6027\u7684\u6700\u65b0\u503c\uff1a\u4f1a\u663e\u793a\u8bbe\u5907\u4e0a\u62a5\u7684\u6700\u65b0\u6570\u636e\u3002 \u8bbe\u5907\u5c5e\u6027\u7684\u66f4\u65b0\u65f6\u95f4\uff1a\u663e\u793a\u6570\u636e\u7684\u66f4\u65b0\u65f6\u95f4\u3002 \u5355\u51fb\u3010\u67e5\u770b\u3011\uff0c\u53ef\u67e5\u770b\u67d0\u4e2a\u5c5e\u6027\u7684\u5386\u53f2\u4e0a\u62a5\u6570\u636e\u3002","title":"4.5 \u67e5\u770b\u8bbe\u5907\u72b6\u6001"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#46","text":"\u5355\u51fb\u3010\u8bbe\u5907\u65e5\u5fd7\u3011\uff0c\u53ef\u67e5\u8be2\u8be5\u8bbe\u5907\u67d0\u6bb5\u65f6\u95f4\u8303\u56f4\u7684\u6240\u6709\u4e0a\u4e0b\u884c\u6570\u636e\u3002 - \u4e0a\u884c\uff1a\u4e0a\u884c\u6307\u8bbe\u5907\u7aef\u4e0a\u62a5\u5230\u5f00\u53d1\u5e73\u53f0\u7684\u6570\u636e\u3002 - \u4e0b\u884c\uff1a\u4e0b\u884c\u6307\u4ece\u5f00\u53d1\u5e73\u53f0\u4e0b\u53d1\u5230\u8bbe\u5907\u7684\u6570\u636e\u3002","title":"4.6 \u67e5\u770b\u8bbe\u5907\u901a\u4fe1\u65e5\u5fd7"},{"location":"16.TencentOS_tiny_LoRaWAN_Getting_Started_Guide/#47","text":"\u5f53 LoRa \u8282\u70b9 \u6210\u529f\u8fde\u63a5\u5230\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u540e\uff0c\u60a8\u53ef\u5728\u63a7\u5236\u53f0\u3010\u8bbe\u5907\u8c03\u8bd5\u3011\u5217\u8868\uff0c\u5355\u51fb\u3010\u8c03\u8bd5\u3011\uff0c\u8fdb\u5165\u5728\u7ebf\u8c03\u8bd5\u3002 \u5c06\u201c\u4e0a\u62a5\u5468\u671f\u201d\u8bbe\u7f6e\u4e3a15\u79d2\uff0c\u5355\u51fb\u3010\u53d1\u9001\u3011\u3002 \u67e5\u770b LoRa \u8282\u70b9\u7684\u4e32\u53e3\u65e5\u5fd7\uff0c\u53ef\u67e5\u770b\u5df2\u6210\u529f\u63a5\u6536\u5230\u4e0b\u53d1\u7684\u6570\u636e\u3002 ? \u7531\u4e8e\u672c\u793a\u4f8b\u4e2d LoRa \u8282\u70b9\u662f LoRaWAN Class A \u7c7b\u8bbe\u5907\uff0c\u8fd9\u7c7b\u8bbe\u5907\u4e0d\u4f1a\u7acb\u5373\u4e0b\u53d1\u6570\u636e\uff0c\u9700\u8981\u5728\u6709\u6570\u636e\u4e0a\u884c\u540e\uff0c\u670d\u52a1\u5668\u624d\u4f1a\u5411\u8be5\u8bbe\u5907\u4e0b\u884c\u6570\u636e\u3002 \u56e0\u6b64\u5728 LoRa \u8282\u70b9\u4e0a\u62a5\u6570\u636e\u4e4b\u540e\uff0c\u624d\u80fd\u67e5\u770b\u4e0b\u53d1\u7684\u5468\u671f\u8c03\u6574\u547d\u4ee4\u3002 LoRa \u8282\u70b9\u7684\u4e32\u53e3\u4f1a\u663e\u793a\u5982\u4e0b\u65e5\u5fd7\uff0c\u8868\u793a\u6210\u529f\u4e0b\u53d1\u4e86\u6307\u4ee4\u5230\u8bbe\u5907\u7aef\u3002 rhf76_incoming_data_process 4: 0F00 len: 2 data[0]: 15 data[1]: 0 report_period: 15","title":"4.7 \u5728\u7ebf\u8c03\u8bd5"},{"location":"17.Mini_Program_Quick_Start/","text":"1. \u5c0f\u7a0b\u5e8f\u5f00\u53d1\u5feb\u901f\u6307\u5f15 1. \u5c0f\u7a0b\u5e8f\u5f00\u53d1\u5feb\u901f\u6307\u5f15 1.1. \u5f00\u53d1\u73af\u5883\u51c6\u5907 1.1.1. \u7533\u8bf7\u5c0f\u7a0b\u5e8f\u8d26\u53f7 1.1.2. \u5c0f\u7a0b\u5e8f\u7ba1\u7406\u540e\u53f0 1.1.3. \u5b89\u88c5\u5f00\u53d1\u5de5\u5177 1.2. \u667a\u80fd\u706f\u5c0f\u7a0b\u5e8fDemo 1.2.1. \u6982\u8ff0 1.2.2. \u524d\u7f6e\u5de5\u4f5c 1.2.3. \u666e\u901a\u5f00\u53d1\u65b9\u5f0f\uff08SDK\uff09 1.2.3.1. \u5bfc\u5165\u5de5\u7a0b 1.2.3.2. \u4fee\u6539\u914d\u7f6e 1.2.3.3. \u529f\u80fd\u6269\u5c55 1.2.4. \u4e91\u5f00\u53d1\u65b9\u5f0f\uff08\u4e91\u51fd\u6570\uff09 1.2.4.1. \u5bfc\u5165\u5de5\u7a0b 1.2.4.2. \u5f00\u901a\u4e91\u5f00\u53d1\uff0c\u521b\u5efa\u73af\u5883 1.2.4.3. \u90e8\u7f72\u4e91\u51fd\u6570 1.2.4.4. \u4fee\u6539\u914d\u7f6e 1.2.4.5. \u529f\u80fd\u6269\u5c55\uff1a\u7ed3\u5408API 3.0 Explorer\u5de5\u5177\u5feb\u901f\u5b9e\u73b0\u4e91\u51fd\u6570 1.2.5. \u8c03\u8bd5\u548c\u53d1\u5e03 1.2.6. \u914d\u7f6e\u4fe1\u606f\u8bf4\u660e 1.3. FAQ 1.3.1. \u7f51\u7edc\u8bf7\u6c42\u62a5\u9519: reqeust:fail url not in domain list 1.3.2. \u4e91\u5f00\u53d1: \u521d\u59cb\u5316\u9519\u8bef cloud init error 1.3.3. \u4e91\u5f00\u53d1\uff1a\u4e91\u73af\u5883\u4e0d\u5b58\u5728 env not exists 1.3.4. \u4e91\u5f00\u53d1\uff1a\u4e91\u51fd\u6570\u4e0d\u5b58\u5728 Function not found 1.3.5. \u53ef\u4ee5\u63a5\u5165\u7b2c\u4e09\u65b9\u670d\u52a1\u5417\uff1f 1.1. \u5f00\u53d1\u73af\u5883\u51c6\u5907 \u66f4\u8be6\u7ec6\u5c0f\u7a0b\u5e8f\u5f00\u53d1\u6307\u5357\uff0c\u8bf7\u53c2\u89c1\uff1a \u5b98\u65b9\u5c0f\u7a0b\u5e8f\u5f00\u53d1\u6307\u5357 1.1.1. \u7533\u8bf7\u5c0f\u7a0b\u5e8f\u8d26\u53f7 \u8fdb\u5165 \u5c0f\u7a0b\u5e8f\u6ce8\u518c\u9875 https://mp.weixin.qq.com/ \u6839\u636e\u6307\u5f15\u586b\u5199\u4fe1\u606f\u548c\u63d0\u4ea4\u76f8\u5e94\u7684\u8d44\u6599\uff0c\u5c31\u53ef\u4ee5\u62e5\u6709\u81ea\u5df1\u7684\u5c0f\u7a0b\u5e8f\u5e10\u53f7 1.1.2. \u5c0f\u7a0b\u5e8f\u7ba1\u7406\u540e\u53f0 \u7533\u8bf7\u5c0f\u7a0b\u5e8f\u6210\u529f\u540e\uff0c\u767b\u5f55 \u5c0f\u7a0b\u5e8f\u7ba1\u7406\u540e\u53f0 \u3002\u5728\u5c0f\u7a0b\u5e8f\u7ba1\u7406\u5e73\u53f0\uff0c\u4f60\u53ef\u4ee5\u7ba1\u7406\u4f60\u7684\u5c0f\u7a0b\u5e8f\u7684\u6743\u9650\uff0c\u67e5\u770b\u6570\u636e\u62a5\u8868\uff0c\u53d1\u5e03\u5c0f\u7a0b\u5e8f\u7b49\u64cd\u4f5c\u3002 AppID\uff1a\u5728\u83dc\u5355 \u201c\u8bbe\u7f6e\u201d-\u201c\u5f00\u53d1\u8bbe\u7f6e\u201d \u53ef\u4ee5\u770b\u5230\u5c0f\u7a0b\u5e8f\u7684 AppID\uff0c\u5c0f\u7a0b\u5e8f\u7684 AppID \u76f8\u5f53\u4e8e\u5c0f\u7a0b\u5e8f\u5e73\u53f0\u7684\u4e00\u4e2a\u8eab\u4efd\u8bc1\uff0c\u5728\u5c0f\u7a0b\u5e8f\u9879\u76ee\u7684\u57fa\u672c\u4fe1\u606f\u4e2d\u9700\u8981\u914d\u7f6eAppID\u3002 1.1.3. \u5b89\u88c5\u5f00\u53d1\u5de5\u5177 \u524d\u5f80 \u5f00\u53d1\u8005\u5de5\u5177\u4e0b\u8f7d\u9875\u9762 \uff0c\u6839\u636e\u81ea\u5df1\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u8f7d\u5bf9\u5e94\u7684\u5b89\u88c5\u5305\u8fdb\u884c\u5b89\u88c5\u3002\u5b89\u88c5\u6210\u529f\u540e\uff0c\u6253\u5f00\u5c0f\u7a0b\u5e8f\u5f00\u53d1\u8005\u5de5\u5177\uff0c\u7528\u5fae\u4fe1\u626b\u7801\u767b\u5f55\u5f00\u53d1\u8005\u5de5\u5177 1.2. \u667a\u80fd\u706f\u5c0f\u7a0b\u5e8fDemo 1.2.1. \u6982\u8ff0 \u57fa\u4e8e\u817e\u8baf\u4e91\u5f00\u53d1\u7269\u8054\u7f51\u5c0f\u7a0b\u5e8f\u5e94\u7528\uff0c\u5173\u952e\u662f\u5982\u4f55\u5728\u5c0f\u7a0b\u5e8f\u4e0a\u65b9\u4fbf\u7684\u8c03\u7528\u817e\u8baf\u4e91\u7269\u8054\u7f51\u5e73\u53f0\u7684API\uff08\u5982\u56fe\u6240\u793a\u7684\u7ea2\u6846\u90e8\u5206\uff09\u3002 TencentOS tiny \u63d0\u4f9b\u4e86\u4e24\u79cd\u5f00\u53d1\u65b9\u5f0f\u7684\u5c0f\u7a0b\u5e8fDemo\u6848\u4f8b\uff0c\u5e2e\u52a9\u5f00\u53d1\u8005\u7684\u5c0f\u7a0b\u5e8f\u66f4\u5feb\u63a5\u5165\u817e\u8baf\u4e91\uff1a \u666e\u901a\u5f00\u53d1\u65b9\u5f0f\uff0c\u4f7f\u7528SDK\u8c03\u7528\u817e\u8baf\u4e91API \u4e91\u5f00\u53d1\u65b9\u5f0f\uff0c\u5728\u4e91\u51fd\u6570\u4e2d\u8c03\u7528\u817e\u8baf\u4e91API 1.2.2. \u524d\u7f6e\u5de5\u4f5c Demo\u6848\u4f8b\u4ee5\u5f00\u53d1\u667a\u80fd\u706f\u5e94\u7528\u4e3a\u4f8b\u5b50\uff0c\u5728\u5c0f\u7a0b\u5e8f\u5f00\u53d1\u4e4b\u524d\uff0c\u5e94\u8be5\u5148\u5b8c\u6210\u4ee5\u4e0b\u5de5\u4f5c\uff1a \u5728\u817e\u8baf\u4e91\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0IotExplorer\u521b\u5efa\u667a\u80fd\u706f\u4ea7\u54c1\u548c\u8bbe\u5907 \u53c2\u8003 \u817e\u8baf\u4e91\u667a\u80fd\u706f\u63a5\u5165\u6307\u5f15 \u3002\u53ea\u9700\u8981\u5173\u6ce8\u63a7\u5236\u53f0\u64cd\u4f5c\u90e8\u5206\uff1a\u521b\u5efa\u9879\u76ee\u548c\u4ea7\u54c1, \u65b0\u5efa\u4ea7\u54c1, \u521b\u5efa\u6570\u636e\u6a21\u677f, \u521b\u5efa\u6d4b\u8bd5\u8bbe\u5907 \u57fa\u4e8eTencentOS tiny\u5b8c\u6210\u8bbe\u5907\u548cIotExplorer\u5bf9\u63a5 \u53c2\u8003\u667a\u80fd\u706f\u6570\u636e\u6a21\u6848\u4f8b\uff1aTencentOS_tiny/examples/qcloud_iot_explorer_sdk_data_template 1.2.3. \u666e\u901a\u5f00\u53d1\u65b9\u5f0f\uff08SDK\uff09 1.2.3.1. \u5bfc\u5165\u5de5\u7a0b \u5728\u5c0f\u7a0b\u5e8f\u5f00\u53d1\u5de5\u5177\u4e2d\uff0c\u5bfc\u5165\u9879\u76ee\uff1a TencentOS_tiny\\tools\\Mini_Program\\iotexplorer_mp_demo \u6ce8\uff1aAppID\u53ef\u5728\u5c0f\u7a0b\u5e8f\u7ba1\u7406\u540e\u53f0\u83b7\u53d6\uff0c\u672c\u5730\u8c03\u8bd5\u53ef\u4ee5\u5148\u4f7f\u7528\u6d4b\u8bd5\u53f7 1.2.3.2. \u4fee\u6539\u914d\u7f6e \u5728miniprogram/app.js\u91cc\u66f4\u65b0\u914d\u7f6e\u4fe1\u606f\uff0c\u53c2\u8003 \u914d\u7f6e\u4fe1\u606f\u8bf4\u660e 1.2.3.3. \u529f\u80fd\u6269\u5c55 SDK\u652f\u6301\u7684api\u53c2\u89c1iotclient.js\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u57fa\u4e8e\u6848\u4f8b\u8fdb\u884c\u529f\u80fd\u6269\u5c55\uff1aTencentOS_tiny\\tools\\Mini_Program\\iotexplorer_mp_demo\\iotclient_for_miniprogram\\iotclient.js \u6ce8\uff1a\u817e\u8baf\u4e91\u6682\u65f6\u6ca1\u6709\u63d0\u4f9b\u5c0f\u7a0b\u5e8f\u7aef\u7684API SDK\uff0c\u672c\u6848\u4f8b\u7684\u5c0f\u7a0b\u5e8fSDK(iotclient_for_miniprogram)\u662f\u57fa\u4e8e \u817e\u8baf\u4e91\u7684NodeJS SDK \u79fb\u690d\u8fc7\u6765\u7684 1.2.4. \u4e91\u5f00\u53d1\u65b9\u5f0f\uff08\u4e91\u51fd\u6570\uff09 \u66f4\u8be6\u7ec6\u7684\u4e91\u5f00\u53d1\u6307\u5357\uff0c\u8bf7\u53c2\u89c1 \u5b98\u65b9\u7684\u4e91\u5f00\u53d1\u5feb\u901f\u6307\u5f15 1.2.4.1. \u5bfc\u5165\u5de5\u7a0b \u5728\u5c0f\u7a0b\u5e8f\u5f00\u53d1\u5de5\u5177\u4e2d\uff0c\u5bfc\u5165\u4e91\u5f00\u53d1Demo\u9879\u76ee\uff1a TencentOS_tiny\\tools\\Mini_Program\\iotexplorer_mp_cloudfunctions_demo \u6ce8\uff1aAppID\u53ef\u5728\u5c0f\u7a0b\u5e8f\u7ba1\u7406\u540e\u53f0\u83b7\u53d6\uff1b\u6d4b\u8bd5\u53f7\u4e0d\u652f\u6301\u4e91\u5f00\u53d1\uff0c\u5fc5\u987b\u7533\u8bf7\u5c0f\u7a0b\u5e8f\u8d26\u53f7 1.2.4.2. \u5f00\u901a\u4e91\u5f00\u53d1\uff0c\u521b\u5efa\u73af\u5883 \u5728\u4f7f\u7528\u4e91\u5f00\u53d1\u80fd\u529b\u4e4b\u524d\u9700\u8981\u5148\u5f00\u901a\u4e91\u5f00\u53d1\u3002\u5728\u5f00\u53d1\u8005\u5de5\u5177\u5de5\u5177\u680f\u5de6\u4fa7\uff0c\u70b9\u51fb \u201c\u4e91\u5f00\u53d1\u201d \u6309\u94ae\u5373\u53ef\u6253\u5f00\u4e91\u63a7\u5236\u53f0\u3001\u6839\u636e\u63d0\u793a\u5f00\u901a\u4e91\u5f00\u53d1\u3001\u521b\u5efa\u4e91\u73af\u5883\u3002 \u4f8b\u5982\uff1a\u586b\u5165\u73af\u5883\u540d\u79f0\u4e3atos-demo, \u73af\u5883ID\u4e3atos-demo\u3002 1.2.4.3. \u90e8\u7f72\u4e91\u51fd\u6570 \u4e91\u51fd\u6570\u9700\u8981\u90e8\u7f72\u5230\u4e91\u73af\u5883\u4e2d\u624d\u80fd\u751f\u6548\u3002\u5728\u4e91\u51fd\u6570\u76ee\u5f55\u4e0a\uff0c\u70b9\u51fb\u53f3\u952e\uff0c\u9009\u62e9\"\u521b\u5efa\u5e76\u90e8\u7f72\uff1a\u4e91\u7aef\u5b89\u88c5\u4f9d\u8d56\uff08\u4e0d\u4e0a\u4f20node_modules\uff09\" \u6848\u4f8b\u7684cloudfunctions\u76ee\u5f55\u63d0\u4f9b\u4e86\u4e24\u4e2a\u4e91\u51fd\u6570query\u548ccontrol\uff0c\u901a\u8fc7\u8c03\u7528Iotexplorer\u7684\u67e5\u8be2\u548c\u63a7\u5236\u63a5\u53e3\uff0c\u5b9e\u73b0\u4e86\u5bf9\u8bbe\u5907\u7684\u67e5\u8be2\u548c\u63a7\u5236\u3002 \u5206\u522b\u5c06control\u548cquery\u4e91\u51fd\u6570\u90e8\u7f72\u5230\u4e91\u73af\u5883\u4e2d\u3002\u90e8\u7f72\u6210\u529f\u540e\uff0c\u53ef\u4ee5\u5728\u4e91\u5f00\u53d1\u63a7\u5236\u53f0\u91cc\u770b\u5230\u5bf9\u5e94\u7684\u4e91\u51fd\u6570\u3002 1.2.4.4. \u4fee\u6539\u914d\u7f6e \u5728miniprogram/app.js\u91cc\u66f4\u65b0\u914d\u7f6e\u4fe1\u606f\uff0c\u53c2\u8003 \u914d\u7f6e\u4fe1\u606f\u8bf4\u660e 1.2.4.5. \u529f\u80fd\u6269\u5c55\uff1a\u7ed3\u5408API 3.0 Explorer\u5de5\u5177\u5feb\u901f\u5b9e\u73b0\u4e91\u51fd\u6570 \u817e\u8baf\u4e91\u63d0\u4f9b\u7684 API 3.0 Explorer \uff0c\u53ef\u4ee5\u975e\u5e38\u65b9\u4fbf\u7684\u751f\u6210 API SDK\u4ee3\u7801\u3002\u53ea\u9700\u8981\u7a0d\u5fae\u4fee\u6539\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u5728\u4e91\u51fd\u6570\u4e2d\u4f7f\u7528\u3002 \u81ea\u52a8\u751f\u6210API SDK\u4ee3\u7801 \u8fdb\u5165 API 3.0 Explorer\u5de5\u5177 \u5de6\u4fa7\u9009\u62e9\u5bf9\u5e94\u670d\u52a1\uff0c\u5982\uff1a\u201c\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u201d \u7ee7\u7eed\u9009\u62e9\u5bf9\u5e94\u63a5\u53e3\uff0c\u5982\uff1a\u201c\u6570\u636e\u67e5\u8be2\u76f8\u5173\u63a5\u53e3\u201d-\u201c\u83b7\u53d6\u8bbe\u5907\u5c5e\u6027\u6570\u636e\u201d \u586b\u5199\u4e2a\u4eba\u5bc6\u94a5\u548c\u8f93\u5165\u53c2\u6570\u3002\u53c2\u89c1 \u914d\u7f6e\u4fe1\u606f\u8bf4\u660e \u4f7f\u7528\u5728\u7ebf\u8c03\u7528\uff0c\u6d4b\u8bd5\u63a5\u53e3\u662f\u5426\u8c03\u7528\u6210\u529f \u6d4b\u8bd5\u5b8c\u6210\u540e\uff0c\u9009\u62e9\u751f\u6210NodeJS\u4ee3\u7801\u3002\u5c06\u4ee3\u7801\u62f7\u8d1d\uff0c\u540e\u7eed\u7528\u4e8e\u4e91\u51fd\u6570\u4e2d \u521b\u5efa\u5e76\u5b9e\u73b0\u4e91\u51fd\u6570 \u521b\u5efa\u4e91\u51fd\u6570query\uff0c\u5c06\u81ea\u52a8\u751f\u6210\u7684NodeJS\u4ee3\u7801\u62f7\u8d1d\u5230\u4e91\u51fd\u6570\uff0c\u5e76\u7a0d\u4f5c\u4fee\u6539\u5373\u53ef\u4f7f\u7528\u3002\u53c2\u8003\uff1a TencentOS-tiny\\tools\\Mini_Program\\iotexplorer_mp_cloudfunctions_demo\\cloudfunctions\\query\\index.js \u8bb0\u5f97\u4e0a\u4f20\u90e8\u7f72\u4fee\u6539\u540e\u7684\u4e91\u51fd\u6570 \u8c03\u7528\u4e91\u51fd\u6570 \u8c03\u7528\u4e91\u51fd\u6570\u7684\u4ee3\u7801\u4e5f\u5f88\u7b80\u5355\u3002\u53c2\u8003\uff1a TencentOS-tiny\\tools\\Mini_Program\\iotexplorer_mp_cloudfunctions_demo\\miniprogram\\pages\\index\\index.js#queryDeviceData() // \u8c03\u7528\u4e91\u51fd\u6570query wx.cloud.callFunction({ name: 'query', data: queryData, success: res => { try { let deviceData = JSON.parse(res.result.Data) this.setData({ deviceData: deviceData }) console.log(\"result:\", deviceData) wx.showToast({ title: '\u8c03\u7528\u6210\u529f', }) } catch (e) { wx.showToast({ icon: 'none', title: '\u8c03\u7528\u5931\u8d25', }) console.log(res.result.Data, e) } }, fail: err => { wx.showToast({ icon: 'none', title: '\u8c03\u7528\u5931\u8d25', }) console.error('[\u4e91\u51fd\u6570] [iotexplorer] \u8c03\u7528\u5931\u8d25\uff1a', err) } }) 1.2.5. \u8c03\u8bd5\u548c\u53d1\u5e03 \u4e0a\u6587\u7684\u6b65\u9aa4\u5b8c\u6210\u540e\uff0c\u5c31\u53ef\u4ee5\u5bf9\u57fa\u672c\u529f\u80fd\u8fdb\u884c\u8c03\u8bd5\uff0c\u5982\uff1a\u67e5\u8be2\u548c\u63a7\u5236\u8bbe\u5907\u3002 \u672c\u5730\u8c03\u8bd5\u3002\u70b9\u51fb\u83dc\u5355\u680f\u7684\"\u7f16\u8bd1\"\u6309\u94ae\u8fdb\u884c\u7f16\u8bd1\uff0c\u5de6\u4fa7\u6a21\u62df\u5668\u4e2d\u70b9\u51fb\u67e5\u8be2\u548c\u53d1\u9001\u6309\u94ae\uff0c\u4e0b\u4fa7\u8c03\u8bd5\u5668\u4e2d\u67e5\u770b\u8c03\u8bd5\u4fe1\u606f \u771f\u673a\u8c03\u8bd5\u3002\u70b9\u51fb\u83dc\u5355\u680f\"\u771f\u673a\u8c03\u8bd5\"\uff0c\u624b\u673a\u5fae\u4fe1\u626b\u63cf\u5f39\u51fa\u7684\u4e8c\u7ef4\u7801\uff0c\u8fdb\u5165\u771f\u673a\u8c03\u8bd5\u3002\u53ef\u5728\u624b\u673a\u5c0f\u7a0b\u5e8f\u9875\u9762\u70b9\u51fb\u6309\u94ae\u8fdb\u884c\u8c03\u8bd5\u3002 \u8c03\u8bd5OK\u540e\uff0c\u5c31\u53ef\u4ee5\u53d1\u5e03\u5c0f\u7a0b\u5e8f\u4e86 + \u4e0a\u4f20\u4ee3\u7801\u3002\u70b9\u51fb\u83dc\u5355\u680f\u201c\u4e0a\u4f20\u201d\uff0c\u586b\u5199\u7248\u672c\u4fe1\u606f\uff0c\u4e0a\u4f20\u5f00\u53d1\u7248\u672c\u5230\u5c0f\u7a0b\u5e8f\u7ba1\u7406\u540e\u53f0 \u53d1\u5e03\u7248\u672c\u3002\u767b\u5f55\u5c0f\u7a0b\u5e8f\u7ba1\u7406\u540e\u53f0\uff0c\u8fdb\u5165\u201c\u7ba1\u7406\u201d-\u201c\u7248\u672c\u7ba1\u7406\u201d\u3002\u5c06\u5f00\u53d1\u7248\u672c\u63d0\u4ea4\u5ba1\u6838\uff0c\u7b49\u5f85\u5ba1\u6838\u901a\u8fc7\u540e\uff0c\u70b9\u51fb\u53d1\u5e03\u7248\u672c\u3002 1.2.6. \u914d\u7f6e\u4fe1\u606f\u8bf4\u660e productId, deviceName \u4ea7\u54c1ID\u548c\u8bbe\u5907\u540d\u79f0\u3002\u7528\u4e8eIotExplorer API\u63a5\u53e3\u8c03\u7528\u7684\u53c2\u6570\u3002\u5728\u817e\u8baf\u4e91\u63a7\u5236\u53f0-\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0-\u4ea7\u54c1\u5f00\u53d1-\u8bbe\u5907\u8c03\u8bd5\u4e2d\uff0c\u83b7\u53d6\u4ea7\u54c1ID\u548c\u8bbe\u5907\u540d\u79f0 secretId, secretKey \u817e\u8baf\u4e91API\u5bc6\u94a5\u4fe1\u606f\uff0c\u7528\u4e8eIotExplorer API \u63a5\u53e3\u8c03\u7528\u7684\u9274\u6743\u3002\u5728\u817e\u8baf\u4e91\u63a7\u5236\u53f0-\u8bbf\u95ee\u7ba1\u7406-\u8bbf\u95ee\u5bc6\u94a5-API\u5bc6\u94a5\u7ba1\u7406\u4e2d\uff0c\u83b7\u53d6 secretId, secretKey region Region\u5b57\u6bb5\uff0c\u63a5\u53e3\u670d\u52a1\u7684\u5730\u57df\uff0c\u586b\u5199\"ap-guangzhou\"\u5373\u53ef env \u4e91\u5f00\u53d1\u7684\u73af\u5883ID\u3002\u586b\u5165\u4e91\u5f00\u53d1\u521b\u5efa\u7684\u73af\u5883ID 1.3. FAQ 1.3.1. \u7f51\u7edc\u8bf7\u6c42\u62a5\u9519: reqeust:fail url not in domain list \u62a5\u9519\u4fe1\u606f: https://iotexplorer.tencentcloudapi.com \u4e0d\u5728\u4ee5\u4e0b request \u5408\u6cd5\u57df\u540d\u5217\u8868\u4e2d\uff0c\u8bf7\u53c2\u8003\u6587\u6863\uff1ahttps://developers.weixin.qq.com/miniprogram/dev/framework/ability/network.html {errMsg: \"request:fail url not in domain list\"} \u89e3\u51b3\u65b9\u5f0f\uff1a \u5982\u679c\u662f\u672c\u5730\u8c03\u8bd5\uff0c\u53ef\u4ee5\u5728\u672c\u5730\u8bbe\u7f6e\u4e2d\u52fe\u9009 \u4e0d\u6821\u9a8c\u5408\u6cd5\u57df\u540d \u5982\u679c\u662f\u771f\u673a\u8c03\u8bd5\u6216\u53d1\u5e03\u5c0f\u7a0b\u5e8f\uff0c\u5219\u9700\u8981\u5728\u5c0f\u7a0b\u5e8f\u7ba1\u7406\u540e\u53f0\u8fdb\u884c\u670d\u52a1\u5668\u57df\u540d\u914d\u7f6e\uff1a\u8fdb\u5165\u5fae\u4fe1\u516c\u4f17\u5e73\u53f0\u5c0f\u7a0b\u5e8f\u540e\u53f0 - \u5f00\u53d1 - \u5f00\u53d1\u8bbe\u7f6e - \u670d\u52a1\u5668\u57df\u540d - \u8f93\u5165\u57df\u540d\u3002\u53c2\u89c1 \u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u6dfb\u52a0\u670d\u52a1\u5668\u7aef\u63a5\u53e3\u57df\u540d \u5982\u679c\u4f7f\u7528\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0 IoT Explorer\uff0c\u8f93\u5165\u57df\u540d: iotexplorer.tencentcloudapi.com \u5982\u679c\u4f7f\u7528\u7269\u8054\u7f51\u901a\u4fe1\u5e73\u53f0 IoT Hub\uff0c\u8f93\u5165\u57df\u540d\uff1a iotcloud.tencentcloudapi.com 1.3.2. \u4e91\u5f00\u53d1: \u521d\u59cb\u5316\u9519\u8bef cloud init error \u62a5\u9519\u4fe1\u606f cloud init error\uff1a{ errMsg: \"invalid scope\" } \u9996\u6b21\u5f00\u901a\u4e91\u73af\u5883\u540e\uff0c\u9700\u7b49\u5f85\u5927\u7ea6 10 \u5206\u949f\u65b9\u53ef\u6b63\u5e38\u4f7f\u7528\u4e91 API\uff0c\u5728\u6b64\u671f\u95f4\u5b98\u65b9\u540e\u53f0\u670d\u52a1\u6b63\u5728\u505a\u51c6\u5907\u670d\u52a1\uff0c\u5982\u5c1d\u8bd5\u5728\u5c0f\u7a0b\u5e8f\u4e2d\u8c03\u7528\u4e91 API \u5219\u4f1a\u62a5 cloud init error\uff1a{ errMsg: \"invalid scope\" } \u7684\u9519\u8bef 1.3.3. \u4e91\u5f00\u53d1\uff1a\u4e91\u73af\u5883\u4e0d\u5b58\u5728 env not exists \u62a5\u9519\u4fe1\u606f\uff1a Error: errCode: -404011 cloud function execution error | errMsg: cloud.callFunction:fail requestID , cloud function service error code -501000, error message [100004] env not exists; \u786e\u5b9a\u662f\u5426\u5f00\u901a\u4e91\u5f00\u53d1\u5e76\u521b\u5efa\u73af\u5883 \u786e\u5b9a\u914d\u7f6e\u6587\u4ef6app.js\u4e2denv\u5b57\u6bb5\u662f\u5426\u548c\u4e91\u5f00\u53d1\u4e2d\u521b\u5efa\u7684\u4e91\u73af\u5883ID\u4e00\u81f4 1.3.4. \u4e91\u5f00\u53d1\uff1a\u4e91\u51fd\u6570\u4e0d\u5b58\u5728 Function not found Error: errCode: -404011 cloud function execution error | errMsg: cloud.callFunction:fail requestID , cloud function service error code -504002, error message Function not found [query]; at cloud.callFunction api \u786e\u8ba4\u4e91\u51fd\u6570\u662f\u5426\u90e8\u7f72\u5230\u5bf9\u5e94\u4e91\u73af\u5883 1.3.5. \u53ef\u4ee5\u63a5\u5165\u7b2c\u4e09\u65b9\u670d\u52a1\u5417\uff1f \u53ef\u4ee5\u3002\u53ea\u8981\u662f\u7b26\u5408\u8981\u6c42\u7684\u670d\u52a1\uff0c\u5c0f\u7a0b\u5e8f\u90fd\u80fd\u8bbf\u95ee\u3002\u7b80\u5355\u6765\u8bf4\uff0c\u6709\u4ee5\u4e0b\u51e0\u4e2a\u8981\u6c42\uff1a\u5fc5\u987b\u4f7f\u7528https/wss\u8bf7\u6c42\uff0c\u8bf7\u6c42\u57df\u540d\u9700\u8981\u505a\u5907\u6848\uff0c\u5e76\u5e26\u6709\u53ef\u4fe1\u4efb\u7684SSL\u8bc1\u4e66\u3002\u8be6\u7ec6\u53c2\u89c1 \u5c0f\u7a0b\u5e8f\u7f51\u7edc\u80fd\u529b\u4f7f\u7528\u8bf4\u660e","title":"17.Mini_Program_Quick_Start"},{"location":"17.Mini_Program_Quick_Start/#1","text":"1. \u5c0f\u7a0b\u5e8f\u5f00\u53d1\u5feb\u901f\u6307\u5f15 1.1. \u5f00\u53d1\u73af\u5883\u51c6\u5907 1.1.1. \u7533\u8bf7\u5c0f\u7a0b\u5e8f\u8d26\u53f7 1.1.2. \u5c0f\u7a0b\u5e8f\u7ba1\u7406\u540e\u53f0 1.1.3. \u5b89\u88c5\u5f00\u53d1\u5de5\u5177 1.2. \u667a\u80fd\u706f\u5c0f\u7a0b\u5e8fDemo 1.2.1. \u6982\u8ff0 1.2.2. \u524d\u7f6e\u5de5\u4f5c 1.2.3. \u666e\u901a\u5f00\u53d1\u65b9\u5f0f\uff08SDK\uff09 1.2.3.1. \u5bfc\u5165\u5de5\u7a0b 1.2.3.2. \u4fee\u6539\u914d\u7f6e 1.2.3.3. \u529f\u80fd\u6269\u5c55 1.2.4. \u4e91\u5f00\u53d1\u65b9\u5f0f\uff08\u4e91\u51fd\u6570\uff09 1.2.4.1. \u5bfc\u5165\u5de5\u7a0b 1.2.4.2. \u5f00\u901a\u4e91\u5f00\u53d1\uff0c\u521b\u5efa\u73af\u5883 1.2.4.3. \u90e8\u7f72\u4e91\u51fd\u6570 1.2.4.4. \u4fee\u6539\u914d\u7f6e 1.2.4.5. \u529f\u80fd\u6269\u5c55\uff1a\u7ed3\u5408API 3.0 Explorer\u5de5\u5177\u5feb\u901f\u5b9e\u73b0\u4e91\u51fd\u6570 1.2.5. \u8c03\u8bd5\u548c\u53d1\u5e03 1.2.6. \u914d\u7f6e\u4fe1\u606f\u8bf4\u660e 1.3. FAQ 1.3.1. \u7f51\u7edc\u8bf7\u6c42\u62a5\u9519: reqeust:fail url not in domain list 1.3.2. \u4e91\u5f00\u53d1: \u521d\u59cb\u5316\u9519\u8bef cloud init error 1.3.3. \u4e91\u5f00\u53d1\uff1a\u4e91\u73af\u5883\u4e0d\u5b58\u5728 env not exists 1.3.4. \u4e91\u5f00\u53d1\uff1a\u4e91\u51fd\u6570\u4e0d\u5b58\u5728 Function not found 1.3.5. \u53ef\u4ee5\u63a5\u5165\u7b2c\u4e09\u65b9\u670d\u52a1\u5417\uff1f","title":"1. \u5c0f\u7a0b\u5e8f\u5f00\u53d1\u5feb\u901f\u6307\u5f15"},{"location":"17.Mini_Program_Quick_Start/#11","text":"\u66f4\u8be6\u7ec6\u5c0f\u7a0b\u5e8f\u5f00\u53d1\u6307\u5357\uff0c\u8bf7\u53c2\u89c1\uff1a \u5b98\u65b9\u5c0f\u7a0b\u5e8f\u5f00\u53d1\u6307\u5357","title":"1.1. \u5f00\u53d1\u73af\u5883\u51c6\u5907"},{"location":"17.Mini_Program_Quick_Start/#111","text":"\u8fdb\u5165 \u5c0f\u7a0b\u5e8f\u6ce8\u518c\u9875 https://mp.weixin.qq.com/ \u6839\u636e\u6307\u5f15\u586b\u5199\u4fe1\u606f\u548c\u63d0\u4ea4\u76f8\u5e94\u7684\u8d44\u6599\uff0c\u5c31\u53ef\u4ee5\u62e5\u6709\u81ea\u5df1\u7684\u5c0f\u7a0b\u5e8f\u5e10\u53f7","title":"1.1.1. \u7533\u8bf7\u5c0f\u7a0b\u5e8f\u8d26\u53f7"},{"location":"17.Mini_Program_Quick_Start/#112","text":"\u7533\u8bf7\u5c0f\u7a0b\u5e8f\u6210\u529f\u540e\uff0c\u767b\u5f55 \u5c0f\u7a0b\u5e8f\u7ba1\u7406\u540e\u53f0 \u3002\u5728\u5c0f\u7a0b\u5e8f\u7ba1\u7406\u5e73\u53f0\uff0c\u4f60\u53ef\u4ee5\u7ba1\u7406\u4f60\u7684\u5c0f\u7a0b\u5e8f\u7684\u6743\u9650\uff0c\u67e5\u770b\u6570\u636e\u62a5\u8868\uff0c\u53d1\u5e03\u5c0f\u7a0b\u5e8f\u7b49\u64cd\u4f5c\u3002 AppID\uff1a\u5728\u83dc\u5355 \u201c\u8bbe\u7f6e\u201d-\u201c\u5f00\u53d1\u8bbe\u7f6e\u201d \u53ef\u4ee5\u770b\u5230\u5c0f\u7a0b\u5e8f\u7684 AppID\uff0c\u5c0f\u7a0b\u5e8f\u7684 AppID \u76f8\u5f53\u4e8e\u5c0f\u7a0b\u5e8f\u5e73\u53f0\u7684\u4e00\u4e2a\u8eab\u4efd\u8bc1\uff0c\u5728\u5c0f\u7a0b\u5e8f\u9879\u76ee\u7684\u57fa\u672c\u4fe1\u606f\u4e2d\u9700\u8981\u914d\u7f6eAppID\u3002","title":"1.1.2. \u5c0f\u7a0b\u5e8f\u7ba1\u7406\u540e\u53f0"},{"location":"17.Mini_Program_Quick_Start/#113","text":"\u524d\u5f80 \u5f00\u53d1\u8005\u5de5\u5177\u4e0b\u8f7d\u9875\u9762 \uff0c\u6839\u636e\u81ea\u5df1\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u8f7d\u5bf9\u5e94\u7684\u5b89\u88c5\u5305\u8fdb\u884c\u5b89\u88c5\u3002\u5b89\u88c5\u6210\u529f\u540e\uff0c\u6253\u5f00\u5c0f\u7a0b\u5e8f\u5f00\u53d1\u8005\u5de5\u5177\uff0c\u7528\u5fae\u4fe1\u626b\u7801\u767b\u5f55\u5f00\u53d1\u8005\u5de5\u5177","title":"1.1.3. \u5b89\u88c5\u5f00\u53d1\u5de5\u5177"},{"location":"17.Mini_Program_Quick_Start/#12-demo","text":"","title":"1.2. \u667a\u80fd\u706f\u5c0f\u7a0b\u5e8fDemo"},{"location":"17.Mini_Program_Quick_Start/#121","text":"\u57fa\u4e8e\u817e\u8baf\u4e91\u5f00\u53d1\u7269\u8054\u7f51\u5c0f\u7a0b\u5e8f\u5e94\u7528\uff0c\u5173\u952e\u662f\u5982\u4f55\u5728\u5c0f\u7a0b\u5e8f\u4e0a\u65b9\u4fbf\u7684\u8c03\u7528\u817e\u8baf\u4e91\u7269\u8054\u7f51\u5e73\u53f0\u7684API\uff08\u5982\u56fe\u6240\u793a\u7684\u7ea2\u6846\u90e8\u5206\uff09\u3002 TencentOS tiny \u63d0\u4f9b\u4e86\u4e24\u79cd\u5f00\u53d1\u65b9\u5f0f\u7684\u5c0f\u7a0b\u5e8fDemo\u6848\u4f8b\uff0c\u5e2e\u52a9\u5f00\u53d1\u8005\u7684\u5c0f\u7a0b\u5e8f\u66f4\u5feb\u63a5\u5165\u817e\u8baf\u4e91\uff1a \u666e\u901a\u5f00\u53d1\u65b9\u5f0f\uff0c\u4f7f\u7528SDK\u8c03\u7528\u817e\u8baf\u4e91API \u4e91\u5f00\u53d1\u65b9\u5f0f\uff0c\u5728\u4e91\u51fd\u6570\u4e2d\u8c03\u7528\u817e\u8baf\u4e91API","title":"1.2.1. \u6982\u8ff0"},{"location":"17.Mini_Program_Quick_Start/#122","text":"Demo\u6848\u4f8b\u4ee5\u5f00\u53d1\u667a\u80fd\u706f\u5e94\u7528\u4e3a\u4f8b\u5b50\uff0c\u5728\u5c0f\u7a0b\u5e8f\u5f00\u53d1\u4e4b\u524d\uff0c\u5e94\u8be5\u5148\u5b8c\u6210\u4ee5\u4e0b\u5de5\u4f5c\uff1a \u5728\u817e\u8baf\u4e91\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0IotExplorer\u521b\u5efa\u667a\u80fd\u706f\u4ea7\u54c1\u548c\u8bbe\u5907 \u53c2\u8003 \u817e\u8baf\u4e91\u667a\u80fd\u706f\u63a5\u5165\u6307\u5f15 \u3002\u53ea\u9700\u8981\u5173\u6ce8\u63a7\u5236\u53f0\u64cd\u4f5c\u90e8\u5206\uff1a\u521b\u5efa\u9879\u76ee\u548c\u4ea7\u54c1, \u65b0\u5efa\u4ea7\u54c1, \u521b\u5efa\u6570\u636e\u6a21\u677f, \u521b\u5efa\u6d4b\u8bd5\u8bbe\u5907 \u57fa\u4e8eTencentOS tiny\u5b8c\u6210\u8bbe\u5907\u548cIotExplorer\u5bf9\u63a5 \u53c2\u8003\u667a\u80fd\u706f\u6570\u636e\u6a21\u6848\u4f8b\uff1aTencentOS_tiny/examples/qcloud_iot_explorer_sdk_data_template","title":"1.2.2. \u524d\u7f6e\u5de5\u4f5c"},{"location":"17.Mini_Program_Quick_Start/#123-sdk","text":"","title":"1.2.3. \u666e\u901a\u5f00\u53d1\u65b9\u5f0f\uff08SDK\uff09"},{"location":"17.Mini_Program_Quick_Start/#1231","text":"\u5728\u5c0f\u7a0b\u5e8f\u5f00\u53d1\u5de5\u5177\u4e2d\uff0c\u5bfc\u5165\u9879\u76ee\uff1a TencentOS_tiny\\tools\\Mini_Program\\iotexplorer_mp_demo \u6ce8\uff1aAppID\u53ef\u5728\u5c0f\u7a0b\u5e8f\u7ba1\u7406\u540e\u53f0\u83b7\u53d6\uff0c\u672c\u5730\u8c03\u8bd5\u53ef\u4ee5\u5148\u4f7f\u7528\u6d4b\u8bd5\u53f7","title":"1.2.3.1. \u5bfc\u5165\u5de5\u7a0b"},{"location":"17.Mini_Program_Quick_Start/#1232","text":"\u5728miniprogram/app.js\u91cc\u66f4\u65b0\u914d\u7f6e\u4fe1\u606f\uff0c\u53c2\u8003 \u914d\u7f6e\u4fe1\u606f\u8bf4\u660e","title":"1.2.3.2. \u4fee\u6539\u914d\u7f6e"},{"location":"17.Mini_Program_Quick_Start/#1233","text":"SDK\u652f\u6301\u7684api\u53c2\u89c1iotclient.js\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u57fa\u4e8e\u6848\u4f8b\u8fdb\u884c\u529f\u80fd\u6269\u5c55\uff1aTencentOS_tiny\\tools\\Mini_Program\\iotexplorer_mp_demo\\iotclient_for_miniprogram\\iotclient.js \u6ce8\uff1a\u817e\u8baf\u4e91\u6682\u65f6\u6ca1\u6709\u63d0\u4f9b\u5c0f\u7a0b\u5e8f\u7aef\u7684API SDK\uff0c\u672c\u6848\u4f8b\u7684\u5c0f\u7a0b\u5e8fSDK(iotclient_for_miniprogram)\u662f\u57fa\u4e8e \u817e\u8baf\u4e91\u7684NodeJS SDK \u79fb\u690d\u8fc7\u6765\u7684","title":"1.2.3.3. \u529f\u80fd\u6269\u5c55"},{"location":"17.Mini_Program_Quick_Start/#124","text":"\u66f4\u8be6\u7ec6\u7684\u4e91\u5f00\u53d1\u6307\u5357\uff0c\u8bf7\u53c2\u89c1 \u5b98\u65b9\u7684\u4e91\u5f00\u53d1\u5feb\u901f\u6307\u5f15","title":"1.2.4. \u4e91\u5f00\u53d1\u65b9\u5f0f\uff08\u4e91\u51fd\u6570\uff09"},{"location":"17.Mini_Program_Quick_Start/#1241","text":"\u5728\u5c0f\u7a0b\u5e8f\u5f00\u53d1\u5de5\u5177\u4e2d\uff0c\u5bfc\u5165\u4e91\u5f00\u53d1Demo\u9879\u76ee\uff1a TencentOS_tiny\\tools\\Mini_Program\\iotexplorer_mp_cloudfunctions_demo \u6ce8\uff1aAppID\u53ef\u5728\u5c0f\u7a0b\u5e8f\u7ba1\u7406\u540e\u53f0\u83b7\u53d6\uff1b\u6d4b\u8bd5\u53f7\u4e0d\u652f\u6301\u4e91\u5f00\u53d1\uff0c\u5fc5\u987b\u7533\u8bf7\u5c0f\u7a0b\u5e8f\u8d26\u53f7","title":"1.2.4.1. \u5bfc\u5165\u5de5\u7a0b"},{"location":"17.Mini_Program_Quick_Start/#1242","text":"\u5728\u4f7f\u7528\u4e91\u5f00\u53d1\u80fd\u529b\u4e4b\u524d\u9700\u8981\u5148\u5f00\u901a\u4e91\u5f00\u53d1\u3002\u5728\u5f00\u53d1\u8005\u5de5\u5177\u5de5\u5177\u680f\u5de6\u4fa7\uff0c\u70b9\u51fb \u201c\u4e91\u5f00\u53d1\u201d \u6309\u94ae\u5373\u53ef\u6253\u5f00\u4e91\u63a7\u5236\u53f0\u3001\u6839\u636e\u63d0\u793a\u5f00\u901a\u4e91\u5f00\u53d1\u3001\u521b\u5efa\u4e91\u73af\u5883\u3002 \u4f8b\u5982\uff1a\u586b\u5165\u73af\u5883\u540d\u79f0\u4e3atos-demo, \u73af\u5883ID\u4e3atos-demo\u3002","title":"1.2.4.2. \u5f00\u901a\u4e91\u5f00\u53d1\uff0c\u521b\u5efa\u73af\u5883"},{"location":"17.Mini_Program_Quick_Start/#1243","text":"\u4e91\u51fd\u6570\u9700\u8981\u90e8\u7f72\u5230\u4e91\u73af\u5883\u4e2d\u624d\u80fd\u751f\u6548\u3002\u5728\u4e91\u51fd\u6570\u76ee\u5f55\u4e0a\uff0c\u70b9\u51fb\u53f3\u952e\uff0c\u9009\u62e9\"\u521b\u5efa\u5e76\u90e8\u7f72\uff1a\u4e91\u7aef\u5b89\u88c5\u4f9d\u8d56\uff08\u4e0d\u4e0a\u4f20node_modules\uff09\" \u6848\u4f8b\u7684cloudfunctions\u76ee\u5f55\u63d0\u4f9b\u4e86\u4e24\u4e2a\u4e91\u51fd\u6570query\u548ccontrol\uff0c\u901a\u8fc7\u8c03\u7528Iotexplorer\u7684\u67e5\u8be2\u548c\u63a7\u5236\u63a5\u53e3\uff0c\u5b9e\u73b0\u4e86\u5bf9\u8bbe\u5907\u7684\u67e5\u8be2\u548c\u63a7\u5236\u3002 \u5206\u522b\u5c06control\u548cquery\u4e91\u51fd\u6570\u90e8\u7f72\u5230\u4e91\u73af\u5883\u4e2d\u3002\u90e8\u7f72\u6210\u529f\u540e\uff0c\u53ef\u4ee5\u5728\u4e91\u5f00\u53d1\u63a7\u5236\u53f0\u91cc\u770b\u5230\u5bf9\u5e94\u7684\u4e91\u51fd\u6570\u3002","title":"1.2.4.3. \u90e8\u7f72\u4e91\u51fd\u6570"},{"location":"17.Mini_Program_Quick_Start/#1244","text":"\u5728miniprogram/app.js\u91cc\u66f4\u65b0\u914d\u7f6e\u4fe1\u606f\uff0c\u53c2\u8003 \u914d\u7f6e\u4fe1\u606f\u8bf4\u660e","title":"1.2.4.4. \u4fee\u6539\u914d\u7f6e"},{"location":"17.Mini_Program_Quick_Start/#1245-api-30-explorer","text":"\u817e\u8baf\u4e91\u63d0\u4f9b\u7684 API 3.0 Explorer \uff0c\u53ef\u4ee5\u975e\u5e38\u65b9\u4fbf\u7684\u751f\u6210 API SDK\u4ee3\u7801\u3002\u53ea\u9700\u8981\u7a0d\u5fae\u4fee\u6539\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u5728\u4e91\u51fd\u6570\u4e2d\u4f7f\u7528\u3002 \u81ea\u52a8\u751f\u6210API SDK\u4ee3\u7801 \u8fdb\u5165 API 3.0 Explorer\u5de5\u5177 \u5de6\u4fa7\u9009\u62e9\u5bf9\u5e94\u670d\u52a1\uff0c\u5982\uff1a\u201c\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u201d \u7ee7\u7eed\u9009\u62e9\u5bf9\u5e94\u63a5\u53e3\uff0c\u5982\uff1a\u201c\u6570\u636e\u67e5\u8be2\u76f8\u5173\u63a5\u53e3\u201d-\u201c\u83b7\u53d6\u8bbe\u5907\u5c5e\u6027\u6570\u636e\u201d \u586b\u5199\u4e2a\u4eba\u5bc6\u94a5\u548c\u8f93\u5165\u53c2\u6570\u3002\u53c2\u89c1 \u914d\u7f6e\u4fe1\u606f\u8bf4\u660e \u4f7f\u7528\u5728\u7ebf\u8c03\u7528\uff0c\u6d4b\u8bd5\u63a5\u53e3\u662f\u5426\u8c03\u7528\u6210\u529f \u6d4b\u8bd5\u5b8c\u6210\u540e\uff0c\u9009\u62e9\u751f\u6210NodeJS\u4ee3\u7801\u3002\u5c06\u4ee3\u7801\u62f7\u8d1d\uff0c\u540e\u7eed\u7528\u4e8e\u4e91\u51fd\u6570\u4e2d \u521b\u5efa\u5e76\u5b9e\u73b0\u4e91\u51fd\u6570 \u521b\u5efa\u4e91\u51fd\u6570query\uff0c\u5c06\u81ea\u52a8\u751f\u6210\u7684NodeJS\u4ee3\u7801\u62f7\u8d1d\u5230\u4e91\u51fd\u6570\uff0c\u5e76\u7a0d\u4f5c\u4fee\u6539\u5373\u53ef\u4f7f\u7528\u3002\u53c2\u8003\uff1a TencentOS-tiny\\tools\\Mini_Program\\iotexplorer_mp_cloudfunctions_demo\\cloudfunctions\\query\\index.js \u8bb0\u5f97\u4e0a\u4f20\u90e8\u7f72\u4fee\u6539\u540e\u7684\u4e91\u51fd\u6570 \u8c03\u7528\u4e91\u51fd\u6570 \u8c03\u7528\u4e91\u51fd\u6570\u7684\u4ee3\u7801\u4e5f\u5f88\u7b80\u5355\u3002\u53c2\u8003\uff1a TencentOS-tiny\\tools\\Mini_Program\\iotexplorer_mp_cloudfunctions_demo\\miniprogram\\pages\\index\\index.js#queryDeviceData() // \u8c03\u7528\u4e91\u51fd\u6570query wx.cloud.callFunction({ name: 'query', data: queryData, success: res => { try { let deviceData = JSON.parse(res.result.Data) this.setData({ deviceData: deviceData }) console.log(\"result:\", deviceData) wx.showToast({ title: '\u8c03\u7528\u6210\u529f', }) } catch (e) { wx.showToast({ icon: 'none', title: '\u8c03\u7528\u5931\u8d25', }) console.log(res.result.Data, e) } }, fail: err => { wx.showToast({ icon: 'none', title: '\u8c03\u7528\u5931\u8d25', }) console.error('[\u4e91\u51fd\u6570] [iotexplorer] \u8c03\u7528\u5931\u8d25\uff1a', err) } })","title":"1.2.4.5. \u529f\u80fd\u6269\u5c55\uff1a\u7ed3\u5408API 3.0 Explorer\u5de5\u5177\u5feb\u901f\u5b9e\u73b0\u4e91\u51fd\u6570"},{"location":"17.Mini_Program_Quick_Start/#125","text":"\u4e0a\u6587\u7684\u6b65\u9aa4\u5b8c\u6210\u540e\uff0c\u5c31\u53ef\u4ee5\u5bf9\u57fa\u672c\u529f\u80fd\u8fdb\u884c\u8c03\u8bd5\uff0c\u5982\uff1a\u67e5\u8be2\u548c\u63a7\u5236\u8bbe\u5907\u3002 \u672c\u5730\u8c03\u8bd5\u3002\u70b9\u51fb\u83dc\u5355\u680f\u7684\"\u7f16\u8bd1\"\u6309\u94ae\u8fdb\u884c\u7f16\u8bd1\uff0c\u5de6\u4fa7\u6a21\u62df\u5668\u4e2d\u70b9\u51fb\u67e5\u8be2\u548c\u53d1\u9001\u6309\u94ae\uff0c\u4e0b\u4fa7\u8c03\u8bd5\u5668\u4e2d\u67e5\u770b\u8c03\u8bd5\u4fe1\u606f \u771f\u673a\u8c03\u8bd5\u3002\u70b9\u51fb\u83dc\u5355\u680f\"\u771f\u673a\u8c03\u8bd5\"\uff0c\u624b\u673a\u5fae\u4fe1\u626b\u63cf\u5f39\u51fa\u7684\u4e8c\u7ef4\u7801\uff0c\u8fdb\u5165\u771f\u673a\u8c03\u8bd5\u3002\u53ef\u5728\u624b\u673a\u5c0f\u7a0b\u5e8f\u9875\u9762\u70b9\u51fb\u6309\u94ae\u8fdb\u884c\u8c03\u8bd5\u3002 \u8c03\u8bd5OK\u540e\uff0c\u5c31\u53ef\u4ee5\u53d1\u5e03\u5c0f\u7a0b\u5e8f\u4e86 + \u4e0a\u4f20\u4ee3\u7801\u3002\u70b9\u51fb\u83dc\u5355\u680f\u201c\u4e0a\u4f20\u201d\uff0c\u586b\u5199\u7248\u672c\u4fe1\u606f\uff0c\u4e0a\u4f20\u5f00\u53d1\u7248\u672c\u5230\u5c0f\u7a0b\u5e8f\u7ba1\u7406\u540e\u53f0 \u53d1\u5e03\u7248\u672c\u3002\u767b\u5f55\u5c0f\u7a0b\u5e8f\u7ba1\u7406\u540e\u53f0\uff0c\u8fdb\u5165\u201c\u7ba1\u7406\u201d-\u201c\u7248\u672c\u7ba1\u7406\u201d\u3002\u5c06\u5f00\u53d1\u7248\u672c\u63d0\u4ea4\u5ba1\u6838\uff0c\u7b49\u5f85\u5ba1\u6838\u901a\u8fc7\u540e\uff0c\u70b9\u51fb\u53d1\u5e03\u7248\u672c\u3002","title":"1.2.5. \u8c03\u8bd5\u548c\u53d1\u5e03"},{"location":"17.Mini_Program_Quick_Start/#126","text":"productId, deviceName \u4ea7\u54c1ID\u548c\u8bbe\u5907\u540d\u79f0\u3002\u7528\u4e8eIotExplorer API\u63a5\u53e3\u8c03\u7528\u7684\u53c2\u6570\u3002\u5728\u817e\u8baf\u4e91\u63a7\u5236\u53f0-\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0-\u4ea7\u54c1\u5f00\u53d1-\u8bbe\u5907\u8c03\u8bd5\u4e2d\uff0c\u83b7\u53d6\u4ea7\u54c1ID\u548c\u8bbe\u5907\u540d\u79f0 secretId, secretKey \u817e\u8baf\u4e91API\u5bc6\u94a5\u4fe1\u606f\uff0c\u7528\u4e8eIotExplorer API \u63a5\u53e3\u8c03\u7528\u7684\u9274\u6743\u3002\u5728\u817e\u8baf\u4e91\u63a7\u5236\u53f0-\u8bbf\u95ee\u7ba1\u7406-\u8bbf\u95ee\u5bc6\u94a5-API\u5bc6\u94a5\u7ba1\u7406\u4e2d\uff0c\u83b7\u53d6 secretId, secretKey region Region\u5b57\u6bb5\uff0c\u63a5\u53e3\u670d\u52a1\u7684\u5730\u57df\uff0c\u586b\u5199\"ap-guangzhou\"\u5373\u53ef env \u4e91\u5f00\u53d1\u7684\u73af\u5883ID\u3002\u586b\u5165\u4e91\u5f00\u53d1\u521b\u5efa\u7684\u73af\u5883ID","title":"1.2.6. \u914d\u7f6e\u4fe1\u606f\u8bf4\u660e"},{"location":"17.Mini_Program_Quick_Start/#13-faq","text":"","title":"1.3. FAQ"},{"location":"17.Mini_Program_Quick_Start/#131-reqeustfail-url-not-in-domain-list","text":"\u62a5\u9519\u4fe1\u606f: https://iotexplorer.tencentcloudapi.com \u4e0d\u5728\u4ee5\u4e0b request \u5408\u6cd5\u57df\u540d\u5217\u8868\u4e2d\uff0c\u8bf7\u53c2\u8003\u6587\u6863\uff1ahttps://developers.weixin.qq.com/miniprogram/dev/framework/ability/network.html {errMsg: \"request:fail url not in domain list\"} \u89e3\u51b3\u65b9\u5f0f\uff1a \u5982\u679c\u662f\u672c\u5730\u8c03\u8bd5\uff0c\u53ef\u4ee5\u5728\u672c\u5730\u8bbe\u7f6e\u4e2d\u52fe\u9009 \u4e0d\u6821\u9a8c\u5408\u6cd5\u57df\u540d \u5982\u679c\u662f\u771f\u673a\u8c03\u8bd5\u6216\u53d1\u5e03\u5c0f\u7a0b\u5e8f\uff0c\u5219\u9700\u8981\u5728\u5c0f\u7a0b\u5e8f\u7ba1\u7406\u540e\u53f0\u8fdb\u884c\u670d\u52a1\u5668\u57df\u540d\u914d\u7f6e\uff1a\u8fdb\u5165\u5fae\u4fe1\u516c\u4f17\u5e73\u53f0\u5c0f\u7a0b\u5e8f\u540e\u53f0 - \u5f00\u53d1 - \u5f00\u53d1\u8bbe\u7f6e - \u670d\u52a1\u5668\u57df\u540d - \u8f93\u5165\u57df\u540d\u3002\u53c2\u89c1 \u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u6dfb\u52a0\u670d\u52a1\u5668\u7aef\u63a5\u53e3\u57df\u540d \u5982\u679c\u4f7f\u7528\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0 IoT Explorer\uff0c\u8f93\u5165\u57df\u540d: iotexplorer.tencentcloudapi.com \u5982\u679c\u4f7f\u7528\u7269\u8054\u7f51\u901a\u4fe1\u5e73\u53f0 IoT Hub\uff0c\u8f93\u5165\u57df\u540d\uff1a iotcloud.tencentcloudapi.com","title":"1.3.1. \u7f51\u7edc\u8bf7\u6c42\u62a5\u9519: reqeust:fail url not in domain list"},{"location":"17.Mini_Program_Quick_Start/#132-cloud-init-error","text":"\u62a5\u9519\u4fe1\u606f cloud init error\uff1a{ errMsg: \"invalid scope\" } \u9996\u6b21\u5f00\u901a\u4e91\u73af\u5883\u540e\uff0c\u9700\u7b49\u5f85\u5927\u7ea6 10 \u5206\u949f\u65b9\u53ef\u6b63\u5e38\u4f7f\u7528\u4e91 API\uff0c\u5728\u6b64\u671f\u95f4\u5b98\u65b9\u540e\u53f0\u670d\u52a1\u6b63\u5728\u505a\u51c6\u5907\u670d\u52a1\uff0c\u5982\u5c1d\u8bd5\u5728\u5c0f\u7a0b\u5e8f\u4e2d\u8c03\u7528\u4e91 API \u5219\u4f1a\u62a5 cloud init error\uff1a{ errMsg: \"invalid scope\" } \u7684\u9519\u8bef","title":"1.3.2. \u4e91\u5f00\u53d1: \u521d\u59cb\u5316\u9519\u8bef cloud init error"},{"location":"17.Mini_Program_Quick_Start/#133-env-not-exists","text":"\u62a5\u9519\u4fe1\u606f\uff1a Error: errCode: -404011 cloud function execution error | errMsg: cloud.callFunction:fail requestID , cloud function service error code -501000, error message [100004] env not exists; \u786e\u5b9a\u662f\u5426\u5f00\u901a\u4e91\u5f00\u53d1\u5e76\u521b\u5efa\u73af\u5883 \u786e\u5b9a\u914d\u7f6e\u6587\u4ef6app.js\u4e2denv\u5b57\u6bb5\u662f\u5426\u548c\u4e91\u5f00\u53d1\u4e2d\u521b\u5efa\u7684\u4e91\u73af\u5883ID\u4e00\u81f4","title":"1.3.3. \u4e91\u5f00\u53d1\uff1a\u4e91\u73af\u5883\u4e0d\u5b58\u5728 env not exists"},{"location":"17.Mini_Program_Quick_Start/#134-function-not-found","text":"Error: errCode: -404011 cloud function execution error | errMsg: cloud.callFunction:fail requestID , cloud function service error code -504002, error message Function not found [query]; at cloud.callFunction api \u786e\u8ba4\u4e91\u51fd\u6570\u662f\u5426\u90e8\u7f72\u5230\u5bf9\u5e94\u4e91\u73af\u5883","title":"1.3.4. \u4e91\u5f00\u53d1\uff1a\u4e91\u51fd\u6570\u4e0d\u5b58\u5728 Function not found"},{"location":"17.Mini_Program_Quick_Start/#135","text":"\u53ef\u4ee5\u3002\u53ea\u8981\u662f\u7b26\u5408\u8981\u6c42\u7684\u670d\u52a1\uff0c\u5c0f\u7a0b\u5e8f\u90fd\u80fd\u8bbf\u95ee\u3002\u7b80\u5355\u6765\u8bf4\uff0c\u6709\u4ee5\u4e0b\u51e0\u4e2a\u8981\u6c42\uff1a\u5fc5\u987b\u4f7f\u7528https/wss\u8bf7\u6c42\uff0c\u8bf7\u6c42\u57df\u540d\u9700\u8981\u505a\u5907\u6848\uff0c\u5e76\u5e26\u6709\u53ef\u4fe1\u4efb\u7684SSL\u8bc1\u4e66\u3002\u8be6\u7ec6\u53c2\u89c1 \u5c0f\u7a0b\u5e8f\u7f51\u7edc\u80fd\u529b\u4f7f\u7528\u8bf4\u660e","title":"1.3.5. \u53ef\u4ee5\u63a5\u5165\u7b2c\u4e09\u65b9\u670d\u52a1\u5417\uff1f"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/","text":"TencentOS tiny\u5b9a\u5236\u5f00\u53d1\u677fEVB_LX\u5feb\u901f\u5165\u95e8\u6307\u5357 Revision Date Description 1.0 2020-2-12 \u6587\u6863\u521d\u7248 1. \u5b9a\u5236\u5f00\u53d1\u677fEVB_LX\u786c\u4ef6\u7b80\u4ecb 1.1 \u5f00\u53d1\u677f\u7b80\u4ecb EVB_LX+\u662f\u817e\u8baf\u7269\u8054\u7f51\u64cd\u4f5c\u7cfb\u7edfTencentOS tiny \u56e2\u961f\u8054\u5408\u5146\u6613\u521b\u65b0\uff08GD32\uff09\u3001\u5357\u4eac\u539a\u5fb7\u7269\u8054\u7f51\u6709\u9650\u516c\u53f8\u4e09\u65b9\u5408\u4f5c\u8bbe\u8ba1\u7684\u4e00\u6b3e\u7269\u8054\u7f51\u8bc4\u4f30\u677f\uff0c\u7528\u4e8eTencentOS tiny \u57fa\u7840\u5185\u6838\u3001RISC-V\u65b0IP\u6838\u67b6\u6784\u548cIoT\u7ec4\u4ef6\u529f\u80fd\u4f53\u9a8c\u548c\u8bc4\u4f30\u3002 \u5f00\u53d1\u677f\u529f\u80fd\u56fe\u5982\u4e0b\u6240\u793a\uff1a 1.2 \u5f00\u53d1\u677f\u7279\u6027 CPU \uff1aGD32VF103RBT6, 108MHz\uff0c128K Flash\uff0c32KB SRAM \u663e\u793a\u5c4f \uff1aOLED\uff0c64*32\u5206\u8fa8\u7387 \u7535\u6e90\u7279\u6027 \uff1aMicro USB\u63a5\u53e3\uff0c5V\u4f9b\u7535\uff0c\u5185\u90e8\u67095V\u8f6c3.3V\u7684DCDC\uff0cMCU\u4f9b\u7535\u7535\u538b\u4e3a3.3V\uff0c\u7cfb\u7edfIO\u7535\u538b\u4e5f\u4e3a3.3V \u6309\u952e \uff1a\u4e00\u4e2a\u590d\u4f4d\u6309\u952e\uff0c\u4e00\u4e2a\u529f\u80fd\u6309\u952e \u5916\u90e8\u6269\u5c55\u5b58\u50a8 \uff1aSPI FLASH LED\u6307\u793a\u706f \uff1a\u4e0a\u7535\u6307\u793a LED\uff0c\u7ea2\u8272\uff1b\u4e00\u4e2a\u7528\u6237\u5b9a\u4e49LED\uff0c\u84dd\u8272 \u8c03\u8bd5\u63a5\u53e3 \uff1a\u677f\u8f7dGD-Link\u4e0b\u8f7d\u8c03\u8bd5\u5668\uff0cUART2\u4e32\u53e3\u8fde\u63a5PC XTAL \uff1a8MHz\uff0c32.768KHz \u4f20\u611f\u5668\u6269\u5c55\u63a5\u53e3E53 Interface \uff1a\u652f\u6301E53\u4f20\u611f\u5668\u6848\u4f8b\u6269\u5c55\u677f\uff08\u652f\u6301UART\u3001SPI\u3001IIC\u3001GPIO\u3001ADC\u3001DAC\u7b49\uff09 \u7f51\u7edc\u6a21\u5757\u6269\u5c55\u63a5\u53e3WAN Interface \uff1a\u652f\u6301\u591a\u79cd\u65e0\u7ebf\u901a\u4fe1\u6a21\u7ec4\u6269\u5c55\uff08UART&SPI&GPIO\uff09 \u64cd\u4f5c\u7cfb\u7edf\u652f\u6301 \uff1aTencentOS tiny 1.3 \u5f00\u53d1\u677f\u786c\u4ef6\u8be6\u89e3 1.3.1 \u7535\u6e90\u7535\u8def \u7535\u6e90\u7a33\u538b\u7535\u8def \u5916\u90e8USB\u8f93\u5165\u7535\u538b\u4e00\u822c\u4e3a5V\uff0c\u4f46\u8fd9\u5e76\u4e0d\u80fd\u76f4\u63a5\u4f5c\u4e3a\u7535\u6e90\u7ed9EVB_LX\u4f9b\u7535\uff0cEVB_LX\u4e0a\u7684\u5143\u5668\u4ef6\u4f9b\u7535\u7535\u538b\u8303\u56f4\u666e\u904d\u57281.8V-3.6V\uff0c\u63a8\u8350\u7535\u538b\u5747\u4e3a3.3V\uff0c\uff08BC35\u4f9b\u7535\u8303\u56f4\u662f\uff1a3.1V-4.2V\uff0c\u63a8\u8350\u7535\u538b3.8V\uff0c\u4f7f\u75283.3V\u4e5f\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\uff09\uff0c\u56e0\u6b64\u9700\u8981\u5c065V\u7684\u7535\u5e73\u8f6c\u6362\u62103.3V\u4f9b\u7ed9EVB_LX\u5f00\u53d1\u677f\u4f7f\u7528\uff0c\u8fd9\u91cc\u4f7f\u7528RT8059\u4f5c\u4e3a3.3V\u7a33\u538b\u5668\u82af\u7247\u3002 RT8059\u662f\u4e00\u6b3e\u9ad8\u6548\u7387\u8109\u51b2\u5bbd\u5ea6\u964d\u538b\u578bDC/DC\u8f6c\u6362\u5668\u3002\u8f93\u5165\u7535\u538b2.8V-5.5V\uff0c\u8f93\u51fa\u7535\u538b\u53ef\u8c03\u8303\u56f4\u4e3a\uff1a0.6V-Vin\uff0c\u8f93\u51fa\u7535\u6d41\u53ef\u4ee5\u8fbe\u52301A\u3002\u5728\u6211\u4eec\u63d0\u4f9b\u7684\u7535\u8def\u4e2d\u5c06\u8f93\u51fa\u8c03\u8282\u81f33.3V\uff0c\u8ba9\u5f00\u53d1\u677f\u6b63\u5e38\u5de5\u4f5c\u3002 1.3.2 GD32V\u6700\u5c0f\u7cfb\u7edf\u7535\u8def \u5355\u7247\u673a\u6700\u5c0f\u7cfb\u7edf\u6216\u8005\u53eb\u6700\u5c0f\u786c\u4ef6\u5355\u5143\u7535\u8def\uff0c\u6307\u7528\u6700\u5c11\u5143\u5668\u4ef6\u7ec4\u6210\u7684\u5355\u7247\u673a\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u7684\u7cfb\u7edf\u3002\u6700\u5c0f\u7cfb\u7edf\u57fa\u672c\u7531\u7535\u6e90\u3001\u5355\u7247\u673a\u3001\u6676\u632f\u3001\u590d\u4f4d\u7535\u8def\u3001\u7a0b\u5e8f\u70e7\u5f55\u63a5\u53e3\u7ec4\u6210\uff0c\u7535\u6e90\u4f7f\u75283.3V\u76f4\u63a5\u4f9b\u7535\uff0c\u5176\u4ed6\u90e8\u5206\u539f\u7406\u56fe\u5982\u4e0b\uff1a 1.3.3 USB\u7535\u5e73\u8f6c\u6362\u7535\u8def USB\u7535\u5e73\u8f6c\u6362\u7535\u8def\u662f\u7528\u4e8eMCU\u548cPC\u901a\u4fe1\u7684\u573a\u666f\u4e2d\u3002PC\u673a\u4e0a\u7684\u901a\u4fe1\u63a5\u53e3\u4f7f\u7528USB\u63a5\u53e3\uff0c\u76f8\u5e94\u7684\u7535\u5e73\u903b\u8f91\u9700\u8981\u9075\u7167USB\u7535\u5e73\u89c4\u5219\uff0c\u800cMCU\u7684\u4e32\u884c\u901a\u4fe1\u63a5\u53e3\u662f\u4e32\u53e3\uff0c\u76f8\u5e94\u7535\u5e73\u9700\u8981\u9075\u5faaTTL\u539f\u5219\u3002\u4e3a\u4e86\u4f7f\u4e24\u8005\u53ef\u4ee5\u4e92\u76f8\u901a\u4fe1\uff0c\u5c31\u9700\u8981\u4e00\u4e2a\u7535\u5e73\u8f6c\u6362\u5668\uff0cEVB_LX\u4e0a\u4f7f\u7528\u4e86CH340\u82af\u7247\u4f5c\u4e3a\u8f6c\u6362\u5668\uff0cCH340\u5916\u56f4\u53ea\u9700\u8981\u63a5\u5f88\u5c11\u7684\u5143\u5668\u4ef6\u5373\u53ef\u4ee5\u5b9e\u73b0USB\u603b\u7ebf\u8f6c\u63a5\uff0c\u4f7f\u7528\u975e\u5e38\u65b9\u4fbf\u4e5f\u5e7f\u6cdb\u8fd0\u7528\u5728USB\u8f6cTTL\u5de5\u5177\u4e0a\uff0c\u7535\u8def\u5982\u4e0b\uff1a 1.3.4 OLED\u663e\u793a\u7535\u8def OLED\u6db2\u6676\u663e\u793a\u6a21\u5757\u7528\u6765\u5411\u7528\u6237\u663e\u793a\u7cfb\u7edf\u72b6\u6001\u3001\u53c2\u6570\u6216\u8005\u8981\u8f93\u5165\u7cfb\u7edf\u7684\u529f\u80fd\u3002\u4e3a\u4e86\u5c55\u793a\u826f\u597d\u7684\u89c6\u89c9\u6548\u679c\uff0c\u6a21\u5757\u4f7f\u7528SSD1306\u9a71\u52a8\u7684OLED\u663e\u793a\u5c4f\uff0c\u5206\u8fa8\u7387\u4e3a64*32\u3002SSD1306\u82af\u7247\u4e13\u4e3a\u5171\u9634\u6781OLED\u9762\u677f\u8bbe\u8ba1\uff0c\u5d4c\u5165\u4e86\u5bf9\u6bd4\u63a7\u5236\u5668\u3001\u663e\u793aRAM\u548c\u6676\u632f\uff0c\u5e76\u51cf\u5c11\u4e86\u5916\u90e8\u5668\u4ef6\u548c\u529f\u8017\uff0c\u6709256\u7ea7\u4eae\u5ea6\u63a7\u5236\u3002 \u8be5\u6b3eOLED\u4f7f\u7528IIC\u63a5\u53e3\uff0c\u7531\u4e8eIIC\u63a5\u53e3\u7a7a\u95f2\u65f6\u5f15\u811a\u8981\u4e0a\u62c9\uff0c\u56e0\u6b64\u4e0b\u9762\u7684\u539f\u7406\u56fe\u4e2d\u63a5\u4e8610k\u7535\u963b\u4e0a\u62c9\uff0c\u7136\u540e\u624d\u63a5\u5165MCU\u5f15\u811a\u3002 1.3.5 \u7528\u6237\u6309\u952e \u5f00\u53d1\u677f\u5e26\u6709\u4e00\u4e2a\u7cfb\u7edfReset\u6309\u952e\uff0c\u548c\u4e00\u4e2a\u529f\u80fd\u6309\u952e\u3002\u590d\u4f4d\u6309\u952e\u662f\u76f4\u63a5\u63a5\u5165GD32V MCU\u7684\u786c\u4ef6\u590d\u4f4dPin\uff0c\u6309\u4e0b\u590d\u4f4d\u6309\u952e\uff0c\u7cfb\u7edf\u81ea\u52a8\u91cd\u542f\u590d\u4f4d\u3002\u529f\u80fd\u6309\u952e\u53ef\u4ee5\u63d0\u4f9b\u7ed9\u5f00\u53d1\u8005\u505a\u529f\u80fd\u5b9a\u4e49\u5f00\u53d1\uff0c\u90fd\u662f\u4f7f\u7528GPIO\u53e3\uff0c\u65b9\u5411\u4e3a\u8f93\u5165\uff0c\u4f4e\u7535\u5e73\u6709\u6548\u3002\u5176\u539f\u7406\u56fe\u5982\u4e0b\u56fe\u6240\u793a\u3002 1.3.6 LED\u7a0b\u5e8f\u6307\u793a\u706f \u4e3a\u4e86\u65b9\u4fbf\u9879\u76ee\u5f00\u53d1\u8c03\u8bd5\uff0cEVB_LX\u5f00\u53d1\u677f\u63a5\u51fa\u6765\u4e00\u4e2aLED\u706f\uff0c\u4f9b\u7528\u6237\u81ea\u5df1\u8bbe\u7f6e\u72b6\u6001\u4f7f\u7528\uff0c\u8be5LED\u706f\u63a5MCU\u7684PB2\u5f15\u811a\uff0c\u5f53PB2\u5f15\u811a\u8f93\u51fa\u9ad8\u7535\u5e73\u65f6\uff0c\u4f1a\u70b9\u4eaeLED\u706f\u3002 1.3.7 Flash\u5b58\u50a8\u7535\u8def\u6269\u5c55 \u5f00\u53d1\u677f\u5e26\u6709\u4e00\u4e2aSPI Nor Flash\u82af\u7247\u6269\u5c55\uff0c\u7528\u6237\u5b58\u50a8\u4e00\u90e8\u5206\u7528\u6237\u6570\u636e\u548c\u5b58\u50a8\u7a7a\u95f4\u6269\u5c55\uff0c\u7535\u8def\u56fe\u5982\u4e0b\uff1a 1.3.8 \u591a\u4e32\u53e3\u5207\u6362\u7535\u8def \u5f00\u53d1\u677f\u5e26\u6709\u591a\u4e32\u53e3\u5207\u6362\u529f\u80fd\uff0c\u901a\u8fc7\u62e8S2 \u5f00\u5173\u53ef\u4ee5\u5207\u6362\u4e32\u53e3\u6620\u5c04\u5173\u7cfb\uff0c\u5f00\u5173\u5207\u6362\u5230PC AT\uff0c\u53ef\u4ee5\u4f7f\u7528PC\u673a\u4e0a\u7684\u4e32\u53e3\u52a9\u624b\u53d1\u9001AT\u547d\u4ee4\u6765\u8c03\u8bd5WAN\u53e3\u7684\u901a\u4fe1\u6a21\u7ec4\uff1b\u5f53\u5f00\u5173\u5207\u6362\u5230MCU AT\uff0c\u662f\u901a\u8fc7GD32V MCU\u7684\u4e32\u53e3\u76f4\u63a5\u6765\u53d1\u9001AT\u6307\u4ee4\u63a7\u5236\u901a\u4fe1\u6a21\u7ec4\uff0c\u540c\u65f6CH340\u4e32\u53e3\u8fde\u63a5PC\u53ef\u4ee5\u505a\u65e5\u5fd7\u8f93\u51fa\u3002\u4e32\u53e3\u5207\u6362\u7535\u8def\u56fe\u5982\u4e0b\uff1a 1.3.9 E53 \u4f20\u611f\u5668\u6269\u5c55\u63a5\u53e3 \u5f00\u53d1\u677f\u8bbe\u8ba1\u6709E53\u63a5\u53e3\u7684\u4f20\u611f\u5668\u6269\u5c55\u677f\u63a5\u53e3\uff0c\u8be5\u63a5\u53e3\u53ef\u517c\u5bb9\u6240\u6709E53\u63a5\u53e3\u7684\u4f20\u611f\u5668\u6269\u5c55\u677f\uff0c\u5b9e\u73b0\u4e0d\u540c\u7269\u8054\u7f51\u6848\u4f8b\u573a\u666f\u7684\u5feb\u901f\u642d\u5efa\u3002\u8be5\u63a5\u53e3\u53ef\u63a5\u5165UART\u3001SPI\u3001I2C\u3001ADC\u7b49\u901a\u4fe1\u534f\u8bae\u7684\u4f20\u611f\u5668\uff0c\u5176\u539f\u7406\u56fe\u5982\u4e0b\u56fe\u6240\u793a\u3002 1.3.10 WAN\u901a\u4fe1\u6a21\u5757\u6269\u5c55\u63a5\u53e3 \u5f00\u53d1\u677f\u8bbe\u8ba1\u6709\u901a\u4fe1\u6269\u5c55\u677f\u7684\u6269\u5c55\u63a5\u53e3\uff0c\u8be5\u63a5\u53e3\u53ef\u63a5\u5165WIFI\u3001NB-IoT\u30012G\u3001\u817e\u8baf\u5b9a\u5236IoT\u6a21\u7ec4\u3001LoRaWAN\u7b49\u4e0d\u540c\u901a\u4fe1\u65b9\u5f0f\u7684\u901a\u4fe1\u6269\u5c55\u677f\uff0c\u4ee5\u6ee1\u8db3\u4e0d\u540c\u573a\u666f\u4e0a\u4e91\u7684\u9700\u6c42\uff0c\u5176\u539f\u7406\u56fe\u5982\u4e0b\u56fe\u6240\u793a\u3002 1.3.11\u5f00\u53d1\u677f\u90e8\u5206\u5f15\u811a\u548c\u6a21\u5757\u6620\u5c04\u5173\u7cfb 1.4 \u5f00\u53d1\u677f\u5f00\u7bb1\u5b89\u88c5\u6307\u5357 1.4.1 \u68c0\u67e5\u914d\u5957\u8bbe\u5907 \u6253\u5f00\u5f00\u53d1\u5957\u4ef6\u76d2\u5b50\u540e\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u627e\u5230\u5f00\u53d1\u677f\u4e3b\u677f\uff0c\u4e00\u4e2aWAN\u53e3wifi\u6269\u5c55\u677fESP8266\u3001\u548c\u4e00\u4e2a\u667a\u6167\u8def\u706f\u4f20\u611f\u5668\u6269\u5c55\u677fE53_SC1(\u5982\u9700\u8981\u66f4\u591a\u4f20\u611f\u6269\u5c55\u677f\u53ef\u81ea\u884c\u627e\u5408\u4f5c\u4f9b\u5e94\u5546\uff08\u7269\u8054\u7f51\u4ff1\u4e50\u90e8\uff09\u8d2d\u4e70\uff09\uff0c\u5982\u4e0a\u56fe\u6240\u793a\u3002 1.4.2 \u5b89\u88c5WAN\u53e3WiFi\u6a21\u5757 1.4.3 \u5b89\u88c5\u4f20\u611f\u5668\u6269\u5c55\u677f \u6839\u636e\u60a8\u5f00\u53d1\u5957\u4ef6\u914d\u5957\u7684\u4f20\u611f\u6269\u5c55\u677f\u5b89\u88c5\u5176\u4e2d\u4e00\u4e2a\u5373\u53ef\u3002 1.4.4 \u8fde\u63a5Micor USB\u7ebf Micro USB\u7ebf\u7684\u529f\u80fd\u662f\u4f9b\u7535\u53ca\u8c03\u8bd5\uff0c\u5c06\u7ebf\u4e00\u5934\u4e0e\u5f00\u53d1\u677f\u7684Micro\u63a5\u53e3(GD-Link)\u8fde\u63a5\uff0c\u53e6\u4e00\u5934\u63a5\u5230\u7535\u8111\u7684USB\u53e3\u4e0a\u3002(\u7a0b\u5e8f\u4e0b\u8f7d\u5b8c\u4e86\uff0c\u4e5f\u53ef\u4ee5\u628ausb\u7ebf\u63a5\u5230pc uart\u7684\u7aef\u53e3\uff0c\u7528\u4e8e\u6253\u5370\u65e5\u5fd7) 2. \u5b9a\u5236\u5f00\u53d1\u677fEVB_LX\u8f6f\u4ef6\u5f00\u53d1\u73af\u5883\u51c6\u5907 2.1 Nuclei Studio IDE\u4e0b\u8f7d \u76ee\u524dGD32V\u6210\u719f\u7684\u96c6\u6210\u5f00\u53d1\u73af\u5883\u662f\u7531\u82af\u6765\u79d1\u6280\u63d0\u4f9b\u7684Nuclei Studio IDE\uff0cTencentOS tiny\u4e2d\u7684RISC-V\u9879\u76ee\u4e5f\u662f\u57fa\u4e8eNuclei Studio IDE\u3002\u9996\u5148\u6211\u4eec\u4e0b\u8f7dNuclei Studio IDE\u8f6f\u4ef6\u5f00\u53d1\u5305\uff0c\u4e0b\u8f7d\u94fe\u63a5\u4e3ahttps://www.nucleisys.com/download.php \u5982\u4e0b\u56fe\u6240\u793a\u3002 \u5355\u51fb\u201cNuclei Studio\uff1a\u82af\u6765\u96c6\u6210\u5f00\u53d1\u73af\u5883\uff08Nuclei Studio IDE\uff09\u201d\u5373\u53ef\u8fdb\u5165\u4e0b\u8f7d\u9875\u9762\u3002 2.2 Nuclei Studio IDE\u5b89\u88c5 \u4e0b\u8f7d\u4e0b\u6765\u7684\u82af\u6765\u96c6\u6210\u5f00\u53d1\u73af\u5883\uff08IDE\uff09Nuclei Studio\u538b\u7f29\u5305\u89e3\u538b\u540e\u5305\u542b\u82e5\u5e72\u4e2a\u6587\u4ef6\u3002 Nuclei Studio\u8f6f\u4ef6\u5305\uff1a\u8be5\u8f6f\u4ef6\u5305\u4e2d\u5305\u542b\u4e86Nuclei Studio IDE\u7684\u8f6f\u4ef6\u3002\u6ce8\u610f\uff1a\u5177\u4f53\u7248\u672c\u4ee5\u53ca\u6587\u4ef6\u540d\u53ef\u80fd\u4f1a\u4e0d\u65ad\u66f4\u65b0\uff1b HBird_Driver.exe\uff1a\u6b64\u6587\u4ef6\u4e3a\u82af\u6765\u8702\u9e1f\u8c03\u8bd5\u5668\u7684USB\u9a71\u52a8\u5b89\u88c5\u6587\u4ef6\uff0c\u8c03\u8bd5\u65f6\u9700\u8981\u5b89\u88c5\u6b64\u9a71\u52a8\u4f7f\u5f97\u5176USB\u80fd\u591f\u88ab\u8bc6\u522b\uff1b JDK\u5b89\u88c5\u6587\u4ef6\uff1ajdk-8u512-windows-x64.exe\uff1b 1.Nuclei Studio IDE\u662f\u57fa\u4e8eeclipse\u7684\uff0ceclipse\u9700\u8981jdk\u73af\u5883\u652f\u6301\uff0c\u4f60\u7684\u7535\u8111\u5982\u679c\u6ca1\u6709\u5b89\u88c5jdk\u73af\u5883\u9700\u8981\u5148\u5b89\u88c5jdk-8u512-windows-x64.exe\uff0c\u76f4\u63a5\u53cc\u51fb\u5b89\u88c5\u5373\u53ef\uff0c\u5982\u679c\u5df2\u7ecf\u5b89\u88c5\u53ef\u4ee5\u8df3\u8fc7\uff1b 2.\u5b89\u88c5HBird_Driver.exe 3.Nuclei Studio\u8f6f\u4ef6\u672c\u8eab\u4e3a\u7eff\u8272\u8f6f\u4ef6\u65e0\u9700\u5b89\u88c5\uff0c\u5b89\u88c5\u597dJDK\u8fd0\u884c\u73af\u5883\u540e\uff0c\u76f4\u63a5\u5355\u51fbNuclei Studio\u6587\u4ef6\u5939\u4e2declipsec.exe\u5373\u53ef\u542f\u52a8Nuclei Studio\u3002 \u76f4\u63a5\u5355\u51fbNucleiStudio_IDE\u6587\u4ef6\u5305\u4e2dNucleiStudio\u6587\u4ef6\u5939\u4e0b\u9762\u7684eclipse.exe\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5373\u53ef\u542f\u52a8Nuclei Studio\uff1b \u7b2c\u4e00\u6b21\u542f\u52a8Nuclei Studio\u540e\uff0c\u5c06\u4f1a\u5f39\u51fa\u5bf9\u8bdd\u6846\u8981\u6c42\u8bbe\u7f6eWorkspace\u76ee\u5f55\uff0c\u8be5\u76ee\u5f55\u5c06\u7528\u4e8e\u653e\u7f6e\u540e\u7eed\u521b\u5efa\u9879\u76ee\u7684\u6587\u4ef6\u5939\uff0c\u5982\u56fe\u6240\u793a\uff1b \u8bbe\u7f6e\u597dWorkspace\u76ee\u5f55\u4e4b\u540e\uff0c\u786e\u4fddWorkspace\u7684\u8def\u5f84\u4e2d\u6ca1\u6709\u4e2d\u6587\uff0c\u5355\u51fb\u201cLaunch\u201d\u6309\u94ae\uff0c\u5c06\u4f1a\u542f\u52a8Nuclei Studio\u3002\u7b2c\u4e00\u6b21\u542f\u52a8\u540e\u7684Nuclei Studio\u754c\u9762\u5982\u56fe\u6240\u793a\u3002 2.3 \u5bfc\u5165\u57fa\u4e8eTencentOS tiny\u7684RISC-V\u5de5\u7a0b \u5148\u4e0b\u8f7dTencentOS tiny\u9879\u76ee\uff0c\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://github.com/Tencent/TencentOS-tiny \u5b98\u65b9\u5730\u5740\u76f4\u63a5\u4e0b\u8f7dzip\u5305\u6216\u8005\u76f4\u63a5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4clone\u4e0b\u6765\uff1a git clone https://github.com/Tencent/TencentOS-tiny.git \u5728\u83dc\u5355\u680f\u9009\u62e9\u201dFile->Import\u201c\uff0c\u51fa\u73b0\u5982\u56fe\u5bf9\u8bdd\u6846\uff0c\u9009\u62e9\u201dGeneral\u201c\u83dc\u5355\u4e0b\u201dExit Project into Workspace\u201c\uff0c\u8bbe\u7f6e\u5bfc\u5165\u65b9\u5f0f\uff0c\u7136\u540e\u70b9\u51fb\u6309\u94ae\u201dNext\u201c\u3002 \u9009\u62e9\u5bfc\u5165\u7684\u65b9\u5f0f\u540e\uff0c\u70b9\u51fb\u201d Browse\u201c\u6309\u94ae\u9009\u62e9TencentOS tiny\u9879\u76ee\u4e2dGD32V\u5de5\u7a0b\u8def\u5f84\u3002\u6ce8\u610f\uff1a\u8fdb\u5165\u5230\u201d TencentOS-tiny\\board\\TencentOS_tiny_EVB_LX\\eclipse\"\u8fd9\u4e00\u7ea7\u76ee\u5f55\u5373\u53ef\uff0c\u5982\u56fe\u6240\u793a\u3002 2.4 \u7f16\u8bd1\u4e0b\u8f7d\u8c03\u8bd5\u57fa\u4e8eTencentOS tiny\u7684RISC-V\u5de5\u7a0b \u5bfc\u5165\u4e4b\u540e\uff0c\u5c31\u53ef\u770b\u5230TencentOS tiny\u7684hello_world\u5de5\u7a0b\u4e86\uff0c\u5982\u56fe\u6240\u793a\uff1a Hello_world\u5de5\u7a0b\u6587\u4ef6\u5939\u4e0a\u53f3\u952e Debug As\uff0c\u9009\u62e9Debug Configuration\uff0c\u914d\u7f6e\u8c03\u8bd5\u53c2\u6570\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u7136\u540e\u70b9\u51fbDebug\u5373\u53ef\u8fdb\u5165\u8c03\u8bd5\u7a97\u53e3\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u53ef\u4ee5\u8fdb\u884c\u5355\u6b65\u3001\u8df3\u6b65\u6267\u884c\uff0c\u8bbe\u7f6e\u65ad\u70b9\u7b49","title":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#tencentos-tinyevb_lx","text":"Revision Date Description 1.0 2020-2-12 \u6587\u6863\u521d\u7248","title":"TencentOS tiny\u5b9a\u5236\u5f00\u53d1\u677fEVB_LX\u5feb\u901f\u5165\u95e8\u6307\u5357"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#1-evb_lx","text":"","title":"1. \u5b9a\u5236\u5f00\u53d1\u677fEVB_LX\u786c\u4ef6\u7b80\u4ecb"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#11","text":"EVB_LX+\u662f\u817e\u8baf\u7269\u8054\u7f51\u64cd\u4f5c\u7cfb\u7edfTencentOS tiny \u56e2\u961f\u8054\u5408\u5146\u6613\u521b\u65b0\uff08GD32\uff09\u3001\u5357\u4eac\u539a\u5fb7\u7269\u8054\u7f51\u6709\u9650\u516c\u53f8\u4e09\u65b9\u5408\u4f5c\u8bbe\u8ba1\u7684\u4e00\u6b3e\u7269\u8054\u7f51\u8bc4\u4f30\u677f\uff0c\u7528\u4e8eTencentOS tiny \u57fa\u7840\u5185\u6838\u3001RISC-V\u65b0IP\u6838\u67b6\u6784\u548cIoT\u7ec4\u4ef6\u529f\u80fd\u4f53\u9a8c\u548c\u8bc4\u4f30\u3002 \u5f00\u53d1\u677f\u529f\u80fd\u56fe\u5982\u4e0b\u6240\u793a\uff1a","title":"1.1 \u5f00\u53d1\u677f\u7b80\u4ecb"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#12","text":"CPU \uff1aGD32VF103RBT6, 108MHz\uff0c128K Flash\uff0c32KB SRAM \u663e\u793a\u5c4f \uff1aOLED\uff0c64*32\u5206\u8fa8\u7387 \u7535\u6e90\u7279\u6027 \uff1aMicro USB\u63a5\u53e3\uff0c5V\u4f9b\u7535\uff0c\u5185\u90e8\u67095V\u8f6c3.3V\u7684DCDC\uff0cMCU\u4f9b\u7535\u7535\u538b\u4e3a3.3V\uff0c\u7cfb\u7edfIO\u7535\u538b\u4e5f\u4e3a3.3V \u6309\u952e \uff1a\u4e00\u4e2a\u590d\u4f4d\u6309\u952e\uff0c\u4e00\u4e2a\u529f\u80fd\u6309\u952e \u5916\u90e8\u6269\u5c55\u5b58\u50a8 \uff1aSPI FLASH LED\u6307\u793a\u706f \uff1a\u4e0a\u7535\u6307\u793a LED\uff0c\u7ea2\u8272\uff1b\u4e00\u4e2a\u7528\u6237\u5b9a\u4e49LED\uff0c\u84dd\u8272 \u8c03\u8bd5\u63a5\u53e3 \uff1a\u677f\u8f7dGD-Link\u4e0b\u8f7d\u8c03\u8bd5\u5668\uff0cUART2\u4e32\u53e3\u8fde\u63a5PC XTAL \uff1a8MHz\uff0c32.768KHz \u4f20\u611f\u5668\u6269\u5c55\u63a5\u53e3E53 Interface \uff1a\u652f\u6301E53\u4f20\u611f\u5668\u6848\u4f8b\u6269\u5c55\u677f\uff08\u652f\u6301UART\u3001SPI\u3001IIC\u3001GPIO\u3001ADC\u3001DAC\u7b49\uff09 \u7f51\u7edc\u6a21\u5757\u6269\u5c55\u63a5\u53e3WAN Interface \uff1a\u652f\u6301\u591a\u79cd\u65e0\u7ebf\u901a\u4fe1\u6a21\u7ec4\u6269\u5c55\uff08UART&SPI&GPIO\uff09 \u64cd\u4f5c\u7cfb\u7edf\u652f\u6301 \uff1aTencentOS tiny","title":"1.2 \u5f00\u53d1\u677f\u7279\u6027"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#13","text":"","title":"1.3 \u5f00\u53d1\u677f\u786c\u4ef6\u8be6\u89e3"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#131","text":"\u7535\u6e90\u7a33\u538b\u7535\u8def \u5916\u90e8USB\u8f93\u5165\u7535\u538b\u4e00\u822c\u4e3a5V\uff0c\u4f46\u8fd9\u5e76\u4e0d\u80fd\u76f4\u63a5\u4f5c\u4e3a\u7535\u6e90\u7ed9EVB_LX\u4f9b\u7535\uff0cEVB_LX\u4e0a\u7684\u5143\u5668\u4ef6\u4f9b\u7535\u7535\u538b\u8303\u56f4\u666e\u904d\u57281.8V-3.6V\uff0c\u63a8\u8350\u7535\u538b\u5747\u4e3a3.3V\uff0c\uff08BC35\u4f9b\u7535\u8303\u56f4\u662f\uff1a3.1V-4.2V\uff0c\u63a8\u8350\u7535\u538b3.8V\uff0c\u4f7f\u75283.3V\u4e5f\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\uff09\uff0c\u56e0\u6b64\u9700\u8981\u5c065V\u7684\u7535\u5e73\u8f6c\u6362\u62103.3V\u4f9b\u7ed9EVB_LX\u5f00\u53d1\u677f\u4f7f\u7528\uff0c\u8fd9\u91cc\u4f7f\u7528RT8059\u4f5c\u4e3a3.3V\u7a33\u538b\u5668\u82af\u7247\u3002 RT8059\u662f\u4e00\u6b3e\u9ad8\u6548\u7387\u8109\u51b2\u5bbd\u5ea6\u964d\u538b\u578bDC/DC\u8f6c\u6362\u5668\u3002\u8f93\u5165\u7535\u538b2.8V-5.5V\uff0c\u8f93\u51fa\u7535\u538b\u53ef\u8c03\u8303\u56f4\u4e3a\uff1a0.6V-Vin\uff0c\u8f93\u51fa\u7535\u6d41\u53ef\u4ee5\u8fbe\u52301A\u3002\u5728\u6211\u4eec\u63d0\u4f9b\u7684\u7535\u8def\u4e2d\u5c06\u8f93\u51fa\u8c03\u8282\u81f33.3V\uff0c\u8ba9\u5f00\u53d1\u677f\u6b63\u5e38\u5de5\u4f5c\u3002","title":"1.3.1 \u7535\u6e90\u7535\u8def"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#132-gd32v","text":"\u5355\u7247\u673a\u6700\u5c0f\u7cfb\u7edf\u6216\u8005\u53eb\u6700\u5c0f\u786c\u4ef6\u5355\u5143\u7535\u8def\uff0c\u6307\u7528\u6700\u5c11\u5143\u5668\u4ef6\u7ec4\u6210\u7684\u5355\u7247\u673a\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u7684\u7cfb\u7edf\u3002\u6700\u5c0f\u7cfb\u7edf\u57fa\u672c\u7531\u7535\u6e90\u3001\u5355\u7247\u673a\u3001\u6676\u632f\u3001\u590d\u4f4d\u7535\u8def\u3001\u7a0b\u5e8f\u70e7\u5f55\u63a5\u53e3\u7ec4\u6210\uff0c\u7535\u6e90\u4f7f\u75283.3V\u76f4\u63a5\u4f9b\u7535\uff0c\u5176\u4ed6\u90e8\u5206\u539f\u7406\u56fe\u5982\u4e0b\uff1a","title":"1.3.2  GD32V\u6700\u5c0f\u7cfb\u7edf\u7535\u8def"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#133-usb","text":"USB\u7535\u5e73\u8f6c\u6362\u7535\u8def\u662f\u7528\u4e8eMCU\u548cPC\u901a\u4fe1\u7684\u573a\u666f\u4e2d\u3002PC\u673a\u4e0a\u7684\u901a\u4fe1\u63a5\u53e3\u4f7f\u7528USB\u63a5\u53e3\uff0c\u76f8\u5e94\u7684\u7535\u5e73\u903b\u8f91\u9700\u8981\u9075\u7167USB\u7535\u5e73\u89c4\u5219\uff0c\u800cMCU\u7684\u4e32\u884c\u901a\u4fe1\u63a5\u53e3\u662f\u4e32\u53e3\uff0c\u76f8\u5e94\u7535\u5e73\u9700\u8981\u9075\u5faaTTL\u539f\u5219\u3002\u4e3a\u4e86\u4f7f\u4e24\u8005\u53ef\u4ee5\u4e92\u76f8\u901a\u4fe1\uff0c\u5c31\u9700\u8981\u4e00\u4e2a\u7535\u5e73\u8f6c\u6362\u5668\uff0cEVB_LX\u4e0a\u4f7f\u7528\u4e86CH340\u82af\u7247\u4f5c\u4e3a\u8f6c\u6362\u5668\uff0cCH340\u5916\u56f4\u53ea\u9700\u8981\u63a5\u5f88\u5c11\u7684\u5143\u5668\u4ef6\u5373\u53ef\u4ee5\u5b9e\u73b0USB\u603b\u7ebf\u8f6c\u63a5\uff0c\u4f7f\u7528\u975e\u5e38\u65b9\u4fbf\u4e5f\u5e7f\u6cdb\u8fd0\u7528\u5728USB\u8f6cTTL\u5de5\u5177\u4e0a\uff0c\u7535\u8def\u5982\u4e0b\uff1a","title":"1.3.3  USB\u7535\u5e73\u8f6c\u6362\u7535\u8def"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#134-oled","text":"OLED\u6db2\u6676\u663e\u793a\u6a21\u5757\u7528\u6765\u5411\u7528\u6237\u663e\u793a\u7cfb\u7edf\u72b6\u6001\u3001\u53c2\u6570\u6216\u8005\u8981\u8f93\u5165\u7cfb\u7edf\u7684\u529f\u80fd\u3002\u4e3a\u4e86\u5c55\u793a\u826f\u597d\u7684\u89c6\u89c9\u6548\u679c\uff0c\u6a21\u5757\u4f7f\u7528SSD1306\u9a71\u52a8\u7684OLED\u663e\u793a\u5c4f\uff0c\u5206\u8fa8\u7387\u4e3a64*32\u3002SSD1306\u82af\u7247\u4e13\u4e3a\u5171\u9634\u6781OLED\u9762\u677f\u8bbe\u8ba1\uff0c\u5d4c\u5165\u4e86\u5bf9\u6bd4\u63a7\u5236\u5668\u3001\u663e\u793aRAM\u548c\u6676\u632f\uff0c\u5e76\u51cf\u5c11\u4e86\u5916\u90e8\u5668\u4ef6\u548c\u529f\u8017\uff0c\u6709256\u7ea7\u4eae\u5ea6\u63a7\u5236\u3002 \u8be5\u6b3eOLED\u4f7f\u7528IIC\u63a5\u53e3\uff0c\u7531\u4e8eIIC\u63a5\u53e3\u7a7a\u95f2\u65f6\u5f15\u811a\u8981\u4e0a\u62c9\uff0c\u56e0\u6b64\u4e0b\u9762\u7684\u539f\u7406\u56fe\u4e2d\u63a5\u4e8610k\u7535\u963b\u4e0a\u62c9\uff0c\u7136\u540e\u624d\u63a5\u5165MCU\u5f15\u811a\u3002","title":"1.3.4  OLED\u663e\u793a\u7535\u8def"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#135","text":"\u5f00\u53d1\u677f\u5e26\u6709\u4e00\u4e2a\u7cfb\u7edfReset\u6309\u952e\uff0c\u548c\u4e00\u4e2a\u529f\u80fd\u6309\u952e\u3002\u590d\u4f4d\u6309\u952e\u662f\u76f4\u63a5\u63a5\u5165GD32V MCU\u7684\u786c\u4ef6\u590d\u4f4dPin\uff0c\u6309\u4e0b\u590d\u4f4d\u6309\u952e\uff0c\u7cfb\u7edf\u81ea\u52a8\u91cd\u542f\u590d\u4f4d\u3002\u529f\u80fd\u6309\u952e\u53ef\u4ee5\u63d0\u4f9b\u7ed9\u5f00\u53d1\u8005\u505a\u529f\u80fd\u5b9a\u4e49\u5f00\u53d1\uff0c\u90fd\u662f\u4f7f\u7528GPIO\u53e3\uff0c\u65b9\u5411\u4e3a\u8f93\u5165\uff0c\u4f4e\u7535\u5e73\u6709\u6548\u3002\u5176\u539f\u7406\u56fe\u5982\u4e0b\u56fe\u6240\u793a\u3002","title":"1.3.5 \u7528\u6237\u6309\u952e"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#136-led","text":"\u4e3a\u4e86\u65b9\u4fbf\u9879\u76ee\u5f00\u53d1\u8c03\u8bd5\uff0cEVB_LX\u5f00\u53d1\u677f\u63a5\u51fa\u6765\u4e00\u4e2aLED\u706f\uff0c\u4f9b\u7528\u6237\u81ea\u5df1\u8bbe\u7f6e\u72b6\u6001\u4f7f\u7528\uff0c\u8be5LED\u706f\u63a5MCU\u7684PB2\u5f15\u811a\uff0c\u5f53PB2\u5f15\u811a\u8f93\u51fa\u9ad8\u7535\u5e73\u65f6\uff0c\u4f1a\u70b9\u4eaeLED\u706f\u3002","title":"1.3.6 LED\u7a0b\u5e8f\u6307\u793a\u706f"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#137-flash","text":"\u5f00\u53d1\u677f\u5e26\u6709\u4e00\u4e2aSPI Nor Flash\u82af\u7247\u6269\u5c55\uff0c\u7528\u6237\u5b58\u50a8\u4e00\u90e8\u5206\u7528\u6237\u6570\u636e\u548c\u5b58\u50a8\u7a7a\u95f4\u6269\u5c55\uff0c\u7535\u8def\u56fe\u5982\u4e0b\uff1a","title":"1.3.7  Flash\u5b58\u50a8\u7535\u8def\u6269\u5c55"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#138","text":"\u5f00\u53d1\u677f\u5e26\u6709\u591a\u4e32\u53e3\u5207\u6362\u529f\u80fd\uff0c\u901a\u8fc7\u62e8S2 \u5f00\u5173\u53ef\u4ee5\u5207\u6362\u4e32\u53e3\u6620\u5c04\u5173\u7cfb\uff0c\u5f00\u5173\u5207\u6362\u5230PC AT\uff0c\u53ef\u4ee5\u4f7f\u7528PC\u673a\u4e0a\u7684\u4e32\u53e3\u52a9\u624b\u53d1\u9001AT\u547d\u4ee4\u6765\u8c03\u8bd5WAN\u53e3\u7684\u901a\u4fe1\u6a21\u7ec4\uff1b\u5f53\u5f00\u5173\u5207\u6362\u5230MCU AT\uff0c\u662f\u901a\u8fc7GD32V MCU\u7684\u4e32\u53e3\u76f4\u63a5\u6765\u53d1\u9001AT\u6307\u4ee4\u63a7\u5236\u901a\u4fe1\u6a21\u7ec4\uff0c\u540c\u65f6CH340\u4e32\u53e3\u8fde\u63a5PC\u53ef\u4ee5\u505a\u65e5\u5fd7\u8f93\u51fa\u3002\u4e32\u53e3\u5207\u6362\u7535\u8def\u56fe\u5982\u4e0b\uff1a","title":"1.3.8  \u591a\u4e32\u53e3\u5207\u6362\u7535\u8def"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#139-e53","text":"\u5f00\u53d1\u677f\u8bbe\u8ba1\u6709E53\u63a5\u53e3\u7684\u4f20\u611f\u5668\u6269\u5c55\u677f\u63a5\u53e3\uff0c\u8be5\u63a5\u53e3\u53ef\u517c\u5bb9\u6240\u6709E53\u63a5\u53e3\u7684\u4f20\u611f\u5668\u6269\u5c55\u677f\uff0c\u5b9e\u73b0\u4e0d\u540c\u7269\u8054\u7f51\u6848\u4f8b\u573a\u666f\u7684\u5feb\u901f\u642d\u5efa\u3002\u8be5\u63a5\u53e3\u53ef\u63a5\u5165UART\u3001SPI\u3001I2C\u3001ADC\u7b49\u901a\u4fe1\u534f\u8bae\u7684\u4f20\u611f\u5668\uff0c\u5176\u539f\u7406\u56fe\u5982\u4e0b\u56fe\u6240\u793a\u3002","title":"1.3.9 E53 \u4f20\u611f\u5668\u6269\u5c55\u63a5\u53e3"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#1310-wan","text":"\u5f00\u53d1\u677f\u8bbe\u8ba1\u6709\u901a\u4fe1\u6269\u5c55\u677f\u7684\u6269\u5c55\u63a5\u53e3\uff0c\u8be5\u63a5\u53e3\u53ef\u63a5\u5165WIFI\u3001NB-IoT\u30012G\u3001\u817e\u8baf\u5b9a\u5236IoT\u6a21\u7ec4\u3001LoRaWAN\u7b49\u4e0d\u540c\u901a\u4fe1\u65b9\u5f0f\u7684\u901a\u4fe1\u6269\u5c55\u677f\uff0c\u4ee5\u6ee1\u8db3\u4e0d\u540c\u573a\u666f\u4e0a\u4e91\u7684\u9700\u6c42\uff0c\u5176\u539f\u7406\u56fe\u5982\u4e0b\u56fe\u6240\u793a\u3002","title":"1.3.10 WAN\u901a\u4fe1\u6a21\u5757\u6269\u5c55\u63a5\u53e3"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#1311","text":"","title":"1.3.11\u5f00\u53d1\u677f\u90e8\u5206\u5f15\u811a\u548c\u6a21\u5757\u6620\u5c04\u5173\u7cfb"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#14","text":"","title":"1.4 \u5f00\u53d1\u677f\u5f00\u7bb1\u5b89\u88c5\u6307\u5357"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#141","text":"\u6253\u5f00\u5f00\u53d1\u5957\u4ef6\u76d2\u5b50\u540e\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u627e\u5230\u5f00\u53d1\u677f\u4e3b\u677f\uff0c\u4e00\u4e2aWAN\u53e3wifi\u6269\u5c55\u677fESP8266\u3001\u548c\u4e00\u4e2a\u667a\u6167\u8def\u706f\u4f20\u611f\u5668\u6269\u5c55\u677fE53_SC1(\u5982\u9700\u8981\u66f4\u591a\u4f20\u611f\u6269\u5c55\u677f\u53ef\u81ea\u884c\u627e\u5408\u4f5c\u4f9b\u5e94\u5546\uff08\u7269\u8054\u7f51\u4ff1\u4e50\u90e8\uff09\u8d2d\u4e70\uff09\uff0c\u5982\u4e0a\u56fe\u6240\u793a\u3002","title":"1.4.1  \u68c0\u67e5\u914d\u5957\u8bbe\u5907"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#142-wanwifi","text":"","title":"1.4.2 \u5b89\u88c5WAN\u53e3WiFi\u6a21\u5757"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#143","text":"\u6839\u636e\u60a8\u5f00\u53d1\u5957\u4ef6\u914d\u5957\u7684\u4f20\u611f\u6269\u5c55\u677f\u5b89\u88c5\u5176\u4e2d\u4e00\u4e2a\u5373\u53ef\u3002","title":"1.4.3 \u5b89\u88c5\u4f20\u611f\u5668\u6269\u5c55\u677f"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#144-micor-usb","text":"Micro USB\u7ebf\u7684\u529f\u80fd\u662f\u4f9b\u7535\u53ca\u8c03\u8bd5\uff0c\u5c06\u7ebf\u4e00\u5934\u4e0e\u5f00\u53d1\u677f\u7684Micro\u63a5\u53e3(GD-Link)\u8fde\u63a5\uff0c\u53e6\u4e00\u5934\u63a5\u5230\u7535\u8111\u7684USB\u53e3\u4e0a\u3002(\u7a0b\u5e8f\u4e0b\u8f7d\u5b8c\u4e86\uff0c\u4e5f\u53ef\u4ee5\u628ausb\u7ebf\u63a5\u5230pc uart\u7684\u7aef\u53e3\uff0c\u7528\u4e8e\u6253\u5370\u65e5\u5fd7)","title":"1.4.4  \u8fde\u63a5Micor USB\u7ebf"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#2-evb_lx","text":"","title":"2. \u5b9a\u5236\u5f00\u53d1\u677fEVB_LX\u8f6f\u4ef6\u5f00\u53d1\u73af\u5883\u51c6\u5907"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#21-nuclei-studio-ide","text":"\u76ee\u524dGD32V\u6210\u719f\u7684\u96c6\u6210\u5f00\u53d1\u73af\u5883\u662f\u7531\u82af\u6765\u79d1\u6280\u63d0\u4f9b\u7684Nuclei Studio IDE\uff0cTencentOS tiny\u4e2d\u7684RISC-V\u9879\u76ee\u4e5f\u662f\u57fa\u4e8eNuclei Studio IDE\u3002\u9996\u5148\u6211\u4eec\u4e0b\u8f7dNuclei Studio IDE\u8f6f\u4ef6\u5f00\u53d1\u5305\uff0c\u4e0b\u8f7d\u94fe\u63a5\u4e3ahttps://www.nucleisys.com/download.php \u5982\u4e0b\u56fe\u6240\u793a\u3002 \u5355\u51fb\u201cNuclei Studio\uff1a\u82af\u6765\u96c6\u6210\u5f00\u53d1\u73af\u5883\uff08Nuclei Studio IDE\uff09\u201d\u5373\u53ef\u8fdb\u5165\u4e0b\u8f7d\u9875\u9762\u3002","title":"2.1 Nuclei Studio IDE\u4e0b\u8f7d"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#22-nuclei-studio-ide","text":"\u4e0b\u8f7d\u4e0b\u6765\u7684\u82af\u6765\u96c6\u6210\u5f00\u53d1\u73af\u5883\uff08IDE\uff09Nuclei Studio\u538b\u7f29\u5305\u89e3\u538b\u540e\u5305\u542b\u82e5\u5e72\u4e2a\u6587\u4ef6\u3002 Nuclei Studio\u8f6f\u4ef6\u5305\uff1a\u8be5\u8f6f\u4ef6\u5305\u4e2d\u5305\u542b\u4e86Nuclei Studio IDE\u7684\u8f6f\u4ef6\u3002\u6ce8\u610f\uff1a\u5177\u4f53\u7248\u672c\u4ee5\u53ca\u6587\u4ef6\u540d\u53ef\u80fd\u4f1a\u4e0d\u65ad\u66f4\u65b0\uff1b HBird_Driver.exe\uff1a\u6b64\u6587\u4ef6\u4e3a\u82af\u6765\u8702\u9e1f\u8c03\u8bd5\u5668\u7684USB\u9a71\u52a8\u5b89\u88c5\u6587\u4ef6\uff0c\u8c03\u8bd5\u65f6\u9700\u8981\u5b89\u88c5\u6b64\u9a71\u52a8\u4f7f\u5f97\u5176USB\u80fd\u591f\u88ab\u8bc6\u522b\uff1b JDK\u5b89\u88c5\u6587\u4ef6\uff1ajdk-8u512-windows-x64.exe\uff1b 1.Nuclei Studio IDE\u662f\u57fa\u4e8eeclipse\u7684\uff0ceclipse\u9700\u8981jdk\u73af\u5883\u652f\u6301\uff0c\u4f60\u7684\u7535\u8111\u5982\u679c\u6ca1\u6709\u5b89\u88c5jdk\u73af\u5883\u9700\u8981\u5148\u5b89\u88c5jdk-8u512-windows-x64.exe\uff0c\u76f4\u63a5\u53cc\u51fb\u5b89\u88c5\u5373\u53ef\uff0c\u5982\u679c\u5df2\u7ecf\u5b89\u88c5\u53ef\u4ee5\u8df3\u8fc7\uff1b 2.\u5b89\u88c5HBird_Driver.exe 3.Nuclei Studio\u8f6f\u4ef6\u672c\u8eab\u4e3a\u7eff\u8272\u8f6f\u4ef6\u65e0\u9700\u5b89\u88c5\uff0c\u5b89\u88c5\u597dJDK\u8fd0\u884c\u73af\u5883\u540e\uff0c\u76f4\u63a5\u5355\u51fbNuclei Studio\u6587\u4ef6\u5939\u4e2declipsec.exe\u5373\u53ef\u542f\u52a8Nuclei Studio\u3002 \u76f4\u63a5\u5355\u51fbNucleiStudio_IDE\u6587\u4ef6\u5305\u4e2dNucleiStudio\u6587\u4ef6\u5939\u4e0b\u9762\u7684eclipse.exe\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5373\u53ef\u542f\u52a8Nuclei Studio\uff1b \u7b2c\u4e00\u6b21\u542f\u52a8Nuclei Studio\u540e\uff0c\u5c06\u4f1a\u5f39\u51fa\u5bf9\u8bdd\u6846\u8981\u6c42\u8bbe\u7f6eWorkspace\u76ee\u5f55\uff0c\u8be5\u76ee\u5f55\u5c06\u7528\u4e8e\u653e\u7f6e\u540e\u7eed\u521b\u5efa\u9879\u76ee\u7684\u6587\u4ef6\u5939\uff0c\u5982\u56fe\u6240\u793a\uff1b \u8bbe\u7f6e\u597dWorkspace\u76ee\u5f55\u4e4b\u540e\uff0c\u786e\u4fddWorkspace\u7684\u8def\u5f84\u4e2d\u6ca1\u6709\u4e2d\u6587\uff0c\u5355\u51fb\u201cLaunch\u201d\u6309\u94ae\uff0c\u5c06\u4f1a\u542f\u52a8Nuclei Studio\u3002\u7b2c\u4e00\u6b21\u542f\u52a8\u540e\u7684Nuclei Studio\u754c\u9762\u5982\u56fe\u6240\u793a\u3002","title":"2.2  Nuclei Studio IDE\u5b89\u88c5"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#23-tencentos-tinyrisc-v","text":"\u5148\u4e0b\u8f7dTencentOS tiny\u9879\u76ee\uff0c\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://github.com/Tencent/TencentOS-tiny \u5b98\u65b9\u5730\u5740\u76f4\u63a5\u4e0b\u8f7dzip\u5305\u6216\u8005\u76f4\u63a5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4clone\u4e0b\u6765\uff1a git clone https://github.com/Tencent/TencentOS-tiny.git \u5728\u83dc\u5355\u680f\u9009\u62e9\u201dFile->Import\u201c\uff0c\u51fa\u73b0\u5982\u56fe\u5bf9\u8bdd\u6846\uff0c\u9009\u62e9\u201dGeneral\u201c\u83dc\u5355\u4e0b\u201dExit Project into Workspace\u201c\uff0c\u8bbe\u7f6e\u5bfc\u5165\u65b9\u5f0f\uff0c\u7136\u540e\u70b9\u51fb\u6309\u94ae\u201dNext\u201c\u3002 \u9009\u62e9\u5bfc\u5165\u7684\u65b9\u5f0f\u540e\uff0c\u70b9\u51fb\u201d Browse\u201c\u6309\u94ae\u9009\u62e9TencentOS tiny\u9879\u76ee\u4e2dGD32V\u5de5\u7a0b\u8def\u5f84\u3002\u6ce8\u610f\uff1a\u8fdb\u5165\u5230\u201d TencentOS-tiny\\board\\TencentOS_tiny_EVB_LX\\eclipse\"\u8fd9\u4e00\u7ea7\u76ee\u5f55\u5373\u53ef\uff0c\u5982\u56fe\u6240\u793a\u3002","title":"2.3 \u5bfc\u5165\u57fa\u4e8eTencentOS tiny\u7684RISC-V\u5de5\u7a0b"},{"location":"18.TencentOS_tiny_EVB_LX_RISC-V_Quick_Start/#24-tencentos-tinyrisc-v","text":"\u5bfc\u5165\u4e4b\u540e\uff0c\u5c31\u53ef\u770b\u5230TencentOS tiny\u7684hello_world\u5de5\u7a0b\u4e86\uff0c\u5982\u56fe\u6240\u793a\uff1a Hello_world\u5de5\u7a0b\u6587\u4ef6\u5939\u4e0a\u53f3\u952e Debug As\uff0c\u9009\u62e9Debug Configuration\uff0c\u914d\u7f6e\u8c03\u8bd5\u53c2\u6570\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u7136\u540e\u70b9\u51fbDebug\u5373\u53ef\u8fdb\u5165\u8c03\u8bd5\u7a97\u53e3\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u53ef\u4ee5\u8fdb\u884c\u5355\u6b65\u3001\u8df3\u6b65\u6267\u884c\uff0c\u8bbe\u7f6e\u65ad\u70b9\u7b49","title":"2.4 \u7f16\u8bd1\u4e0b\u8f7d\u8c03\u8bd5\u57fa\u4e8eTencentOS tiny\u7684RISC-V\u5de5\u7a0b"},{"location":"19.TencentOS_Tiny_Simulator_Use_MDK/","text":"\u4f7f\u7528MDK\u8f6f\u4ef6\u5168\u4eff\u771f\u8c03\u8bd5\u4f53\u9a8cTencentOS Tiny \u6709\u8bb8\u591a\u670b\u53cb\u60f3\u4f53\u9a8c\u6216\u8005\u5b66\u4e60\u4e00\u4e0bTencentOS Tiny\u5185\u6838\uff0c\u4f46\u662f\u624b\u4e0a\u5374\u6ca1\u6709\u5408\u9002\u7684\u786c\u4ef6\uff0c\u6ca1\u5173\u7cfb\uff01\u672c\u6587\u5c06\u6559\u60a8\u5982\u4f55\u4f7f\u7528MDK\u8f6f\u4ef6\u6765\u4eff\u771f\u8c03\u8bd5TencentOS Tiny\u5185\u6838\u3002 \u53c2\u8003\u5de5\u7a0b\u8fde\u63a5\uff1ahttps://github.com/Tencent/TencentOS-tiny/tree/master/board/MDK_Simulator_STM32F103RCT6/KEIL/hello_world \u6211\u4eec\u9996\u5148\u5728TencentOS Tiny\u5b98\u5e93\u4e0a\u627e\u5230\u4e00\u4e2aSTM32\u5de5\u7a0b\uff0c\u7528MDK\u8f6f\u4ef6\u6253\u5f00\uff0c\u4fee\u6539printf \u51fd\u6570\u6620\u5c04\uff0c\u5982\u56fe\u6240\u793a\uff1a \u9700\u8981\u6dfb\u52a0\u7684\u4ee3\u7801\u5982\u4e0b\uff1a #include \"stdio.h\" #define ITM_Port8(n) (*((volatile unsigned char *)(0xE0000000+4*n))) #define ITM_Port16(n) (*((volatile unsigned short*)(0xE0000000+4*n))) #define ITM_Port32(n) (*((volatile unsigned long *)(0xE0000000+4*n))) #define DEMCR (*((volatile unsigned long *)(0xE000EDFC))) #define TRCENA 0x01000000 struct __FILE { int handle; /* Add whatever you need here */ }; FILE __stdout; FILE __stdin; int fputc(int ch, FILE *f) { if (DEMCR & TRCENA) { while (ITM_Port32(0) == 0); ITM_Port8(0) = ch; } return(ch); } \u6dfb\u52a0\u5b8c\u6bd5\u540e\uff0c\u5728MDK\u5de5\u7a0b\u4e0a\u6253\u5f00option\u9009\u9879\uff0c\u9009\u62e9debug\u9009\u9879\uff0c\u8c03\u8bd5\u65b9\u5f0f\u9009\u62e9User Simulator\uff0c\u5e76\u4fee\u6539\u8c03\u8bd5\u53c2\u6570\uff0c\u5982\u4e0b\u56fe\uff1a \u5b8c\u6210\u8f6f\u4ef6\u4eff\u771f\u53c2\u6570\u914d\u7f6e\u540e\uff0c\u5c31\u53ef\u4ee5\u70b9\u51fbdebug\u6309\u94ae\u5f00\u59cb\u8c03\u8bd5\u4e86\uff0c\u6253\u5f00\u8c03\u8bd5\u7a97\u53e3\u540e\uff0c\u9009\u62e9view->Serial windows->debug \u5c31\u53ef\u4ee5\u6253\u5f00\u8c03\u8bd5\u65e5\u5fd7\u7a97\u53e3\u4e86\uff0c\u5982\u56fe\uff0c\u53ef\u4ee5\u770b\u5230TencentOS Tiny\u5185\u6838\u7684\u4e24\u4e2a\u4efb\u52a1\u8f93\u51fa\u7684\u65e5\u5fd7\u4fe1\u606f\u3002","title":"19.TencentOS_Tiny_Simulator_Use_MDK"},{"location":"19.TencentOS_Tiny_Simulator_Use_MDK/#mdktencentos-tiny","text":"\u6709\u8bb8\u591a\u670b\u53cb\u60f3\u4f53\u9a8c\u6216\u8005\u5b66\u4e60\u4e00\u4e0bTencentOS Tiny\u5185\u6838\uff0c\u4f46\u662f\u624b\u4e0a\u5374\u6ca1\u6709\u5408\u9002\u7684\u786c\u4ef6\uff0c\u6ca1\u5173\u7cfb\uff01\u672c\u6587\u5c06\u6559\u60a8\u5982\u4f55\u4f7f\u7528MDK\u8f6f\u4ef6\u6765\u4eff\u771f\u8c03\u8bd5TencentOS Tiny\u5185\u6838\u3002 \u53c2\u8003\u5de5\u7a0b\u8fde\u63a5\uff1ahttps://github.com/Tencent/TencentOS-tiny/tree/master/board/MDK_Simulator_STM32F103RCT6/KEIL/hello_world \u6211\u4eec\u9996\u5148\u5728TencentOS Tiny\u5b98\u5e93\u4e0a\u627e\u5230\u4e00\u4e2aSTM32\u5de5\u7a0b\uff0c\u7528MDK\u8f6f\u4ef6\u6253\u5f00\uff0c\u4fee\u6539printf \u51fd\u6570\u6620\u5c04\uff0c\u5982\u56fe\u6240\u793a\uff1a \u9700\u8981\u6dfb\u52a0\u7684\u4ee3\u7801\u5982\u4e0b\uff1a #include \"stdio.h\" #define ITM_Port8(n) (*((volatile unsigned char *)(0xE0000000+4*n))) #define ITM_Port16(n) (*((volatile unsigned short*)(0xE0000000+4*n))) #define ITM_Port32(n) (*((volatile unsigned long *)(0xE0000000+4*n))) #define DEMCR (*((volatile unsigned long *)(0xE000EDFC))) #define TRCENA 0x01000000 struct __FILE { int handle; /* Add whatever you need here */ }; FILE __stdout; FILE __stdin; int fputc(int ch, FILE *f) { if (DEMCR & TRCENA) { while (ITM_Port32(0) == 0); ITM_Port8(0) = ch; } return(ch); } \u6dfb\u52a0\u5b8c\u6bd5\u540e\uff0c\u5728MDK\u5de5\u7a0b\u4e0a\u6253\u5f00option\u9009\u9879\uff0c\u9009\u62e9debug\u9009\u9879\uff0c\u8c03\u8bd5\u65b9\u5f0f\u9009\u62e9User Simulator\uff0c\u5e76\u4fee\u6539\u8c03\u8bd5\u53c2\u6570\uff0c\u5982\u4e0b\u56fe\uff1a \u5b8c\u6210\u8f6f\u4ef6\u4eff\u771f\u53c2\u6570\u914d\u7f6e\u540e\uff0c\u5c31\u53ef\u4ee5\u70b9\u51fbdebug\u6309\u94ae\u5f00\u59cb\u8c03\u8bd5\u4e86\uff0c\u6253\u5f00\u8c03\u8bd5\u7a97\u53e3\u540e\uff0c\u9009\u62e9view->Serial windows->debug \u5c31\u53ef\u4ee5\u6253\u5f00\u8c03\u8bd5\u65e5\u5fd7\u7a97\u53e3\u4e86\uff0c\u5982\u56fe\uff0c\u53ef\u4ee5\u770b\u5230TencentOS Tiny\u5185\u6838\u7684\u4e24\u4e2a\u4efb\u52a1\u8f93\u51fa\u7684\u65e5\u5fd7\u4fe1\u606f\u3002","title":"\u4f7f\u7528MDK\u8f6f\u4ef6\u5168\u4eff\u771f\u8c03\u8bd5\u4f53\u9a8cTencentOS Tiny"},{"location":"20.In_Application_Programming_based_EVB_MX_Plus/","text":"\u57fa\u4e8eTencentOS tiny\u5b98\u65b9EVB MX+\u5f00\u53d1\u677f\u7684IAP 1. \u4ec0\u4e48\u662fIAP \u4ee5\u4e0b\u5185\u5bb9\u5f15\u81ea\u6b63\u70b9\u539f\u5b50\u300aSTM32F429\u5f00\u53d1\u6307\u5357-HAL\u5e93\u7248\u672c_v1.1\u300b\u7b2c\u4e94\u5341\u4e03\u7ae0\uff0c\u5982\u4fb5\u6743\u8bf7\u8054\u7cfb\u5220\u9664\u3002 \u200b IAP\uff08 In Application Programming\uff09\u5373\u5728\u5e94\u7528\u7f16\u7a0b\uff0c IAP \u662f\u7528\u6237\u81ea\u5df1\u7684\u7a0b\u5e8f\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u5bf9User Flash \u7684\u90e8\u5206\u533a\u57df\u8fdb\u884c\u70e7\u5199\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u5728\u4ea7\u54c1\u53d1\u5e03\u540e\u53ef\u4ee5\u65b9\u4fbf\u5730\u901a\u8fc7\u9884\u7559\u7684\u901a\u4fe1\u53e3\u5bf9\u4ea7\u54c1\u4e2d\u7684\u56fa\u4ef6\u7a0b\u5e8f\u8fdb\u884c\u66f4\u65b0\u5347\u7ea7\u3002 \u901a\u5e38\u5b9e\u73b0 IAP \u529f\u80fd\u65f6\uff0c\u5373\u7528\u6237\u7a0b\u5e8f\u8fd0\u884c\u4e2d\u4f5c\u81ea\u8eab\u7684\u66f4\u65b0\u64cd\u4f5c\uff0c\u9700\u8981\u5728\u8bbe\u8ba1\u56fa\u4ef6\u7a0b\u5e8f\u65f6\u7f16\u5199\u4e24\u4e2a\u9879\u76ee\u4ee3\u7801\uff0c\u7b2c\u4e00\u4e2a\u9879\u76ee\u7a0b\u5e8f\u4e0d\u6267\u884c\u6b63\u5e38\u7684\u529f\u80fd\u64cd\u4f5c\uff0c\u800c\u53ea\u662f\u901a\u8fc7\u67d0\u79cd\u901a\u4fe1\u65b9\u5f0f(\u5982 USB\u3001 USART)\u63a5\u6536\u7a0b\u5e8f\u6216\u6570\u636e\uff0c\u6267\u884c\u5bf9\u7b2c\u4e8c\u90e8\u5206\u4ee3\u7801\u7684\u66f4\u65b0\uff1b\u7b2c\u4e8c\u4e2a\u9879\u76ee\u4ee3\u7801\u624d\u662f\u771f\u6b63\u7684\u529f\u80fd\u4ee3\u7801\u3002\u8fd9\u4e24\u90e8\u5206\u9879\u76ee\u4ee3\u7801\u90fd\u540c\u65f6\u70e7\u5f55\u5728 User Flash \u4e2d\uff0c\u5f53\u82af\u7247\u4e0a\u7535\u540e\uff0c\u9996\u5148\u662f\u7b2c\u4e00\u4e2a\u9879\u76ee\u4ee3\u7801\u5f00\u59cb\u8fd0\u884c\uff0c\u5b83\u4f5c\u5982\u4e0b\u64cd\u4f5c\uff1a \u200b 1\uff09\u68c0\u67e5\u662f\u5426\u9700\u8981\u5bf9\u7b2c\u4e8c\u90e8\u5206\u4ee3\u7801\u8fdb\u884c\u66f4\u65b0 \u200b 2\uff09\u5982\u679c\u4e0d\u9700\u8981\u66f4\u65b0\u5219\u8f6c\u5230 4\uff09 \u200b 3\uff09\u6267\u884c\u66f4\u65b0\u64cd\u4f5c \u200b 4\uff09\u8df3\u8f6c\u5230\u7b2c\u4e8c\u90e8\u5206\u4ee3\u7801\u6267\u884c \u200b \u7b2c\u4e00\u90e8\u5206\u4ee3\u7801\u5fc5\u987b\u901a\u8fc7\u5176\u5b83\u624b\u6bb5\uff0c\u5982 JTAG \u6216 ISP \u70e7\u5165\uff1b\u7b2c\u4e8c\u90e8\u5206\u4ee3\u7801\u53ef\u4ee5\u4f7f\u7528\u7b2c\u4e00\u90e8\u5206\u4ee3\u7801 IAP \u529f\u80fd\u70e7\u5165\uff0c\u4e5f\u53ef\u4ee5\u548c\u7b2c\u4e00\u90e8\u5206\u4ee3\u7801\u4e00\u8d77\u70e7\u5165\uff0c\u4ee5\u540e\u9700\u8981\u7a0b\u5e8f\u66f4\u65b0\u65f6\u518d\u901a\u8fc7\u7b2c\u4e00\u90e8\u5206 IAP\u4ee3\u7801\u66f4\u65b0\u3002 \u200b \u6211\u4eec\u5c06\u7b2c\u4e00\u4e2a\u9879\u76ee\u4ee3\u7801\u79f0\u4e4b\u4e3a Bootloader \u7a0b\u5e8f\uff0c\u7b2c\u4e8c\u4e2a\u9879\u76ee\u4ee3\u7801\u79f0\u4e4b\u4e3a APP \u7a0b\u5e8f\uff0c\u4ed6\u4eec\u5b58\u653e\u5728 STM32F429 FLASH \u7684\u4e0d\u540c\u5730\u5740\u8303\u56f4\uff0c\u4e00\u822c\u4ece\u6700\u4f4e\u5730\u5740\u533a\u5f00\u59cb\u5b58\u653e Bootloader\uff0c\u7d27\u8ddf\u5176\u540e\u7684\u5c31\u662f APP \u7a0b\u5e8f\u3002 2. TencentOS tiny\u7684IAP\u7a0b\u5e8f 2.1 BootLoader\u7a0b\u5e8f \u200b \u5982\u7b2c\u4e00\u7ae0\u6240\u8a00\uff0c\u4e00\u4e2aIAP\u4f8b\u7a0b\u4e00\u822c\u7531BootLoader\u53caAPP\u4e24\u90e8\u5206\u6784\u6210\uff0c\u5176\u4e2dBootLoader\u8d77\u5f15\u5bfc\u677f\u5b50\u542f\u52a8\u5e76\u63d0\u4f9bAPP\u4e0b\u8f7d\u70e7\u5f55\u9009\u9879\u3002 \u200b \u57fa\u4e8eTencentOS tiny\u5b98\u65b9EVB MX+\u5f00\u53d1\u677f\uff0c\u63d0\u4f9b\u4e86\u5b98\u65b9IAP BootLoader\u7a0b\u5e8f\uff0c\u5bf9\u5e94\u7684keil\u5de5\u7a0b\u4f4d\u4e8e\uff1a board\\TencentOS_tiny_EVB_MX_Plus\\KEIL\\iap\\bootloader \u200b \u4e0e\u6b63\u5e38\u7684\u5e94\u7528\u7a0b\u5e8f\u7f16\u8bd1\u70e7\u5199\u6d41\u7a0b\u4e00\u81f4\uff0c\u53cc\u51fb\u6253\u5f00keil\u5de5\u7a0b\u540e\uff0c\u5c06BootLoader\u70e7\u5199\u8fdb\u5f00\u53d1\u677f\u3002 \u200b \u6309\u4e0b\u590d\u4f4d\u952e\u540e\uff0cBootLoader\u4f1a\u76f4\u63a5\u8fdb\u5165\u52a0\u8f7d\u5e76\u8fd0\u884cAPP\u7684\u6d41\u7a0b\u3002 \u200b \u8fd9\u91cc\u4e3a\u4e86\u6f14\u793aIAP\u6d41\u7a0b\uff0c\u8ba9BootLoader\u8fdb\u5165APP\u5347\u7ea7\u6a21\u5f0f\uff0c\u5177\u4f53\u7684\u505a\u6cd5\u662f\u6309\u4f4f\u677f\u4e0aF2\u6309\u952e\u7684\u540c\u65f6\uff0c\u518d\u6309\u4e0b\u590d\u4f4d\u952e\uff1a \u200b \u5c06microUSB\uff08\u677f\u4e0aUSART2\uff09\u63a5\u5230\u7535\u8111\u4e0a\uff0c\u6253\u5f00\u4e32\u53e3\u8c03\u8bd5\u52a9\u624b\uff0c\u5e76\u5c06\u6ce2\u7279\u7387\u9009\u4e3a115200\uff0c\u53ef\u4ee5\u770b\u5230BootLoader\u7684\u83dc\u5355\uff1a \u200b BootLoader\u7684\u56db\u4e2a\u83dc\u5355\u9009\u9879\u5206\u522b\u662f\uff1a \u901a\u8fc7\u4e32\u53e3ymodem\u534f\u8bae\u4e0b\u8f7dAPP\u955c\u50cf\u5230\u677f\u5b50\u5185\u90e8FLASH \u901a\u8fc7\u4e32\u53e3ymodem\u534f\u8bae\u4e0a\u4f20\u677f\u5b50\u5185\u90e8FLASH\u4e0a\u7684APP\u955c\u50cf \u6267\u884cAPP \u4f7f\u80fd\u5185\u90e8FLASH\u5199\u4fdd\u62a4 2.2 APP\u7a0b\u5e8f \u200b \u57fa\u4e8eTencentOS tiny\u5b98\u65b9EVB MX+\u5f00\u53d1\u677f\uff0c\u63d0\u4f9b\u4e86\u5b98\u65b9\u793a\u4f8bAPP\u7a0b\u5e8f\uff0c\u7531hello world\u793a\u4f8b\u4fee\u6539\u800c\u6765\uff0c\u5bf9\u5e94\u7684keil\u5de5\u7a0b\u4f4d\u4e8e\uff1a board\\TencentOS_tiny_EVB_MX_Plus\\KEIL\\iap\\application \u200b \u56e0\u4e3aIAP\u4e2d\u7684APP\u662f\u7531BootLoader\u6765\u8df3\u8f6c\u6267\u884c\u7684\uff0cBootLoader\u53ea\u80fd\u8df3\u8f6c\u6267\u884cbin\u683c\u5f0f\u7684APP\u7a0b\u5e8f\uff0c\u56e0\u6b64\u9700\u8981\u6dfb\u52a0\u5c06APP\u7a0b\u5e8f\u8f6c\u6210bin\u683c\u5f0f\u7684\u6d41\u7a0b\uff1a \u200b \u540c\u65f6\uff0c\u8981\u786e\u4fddsystem_stm32l4xx.c\u4e2d\u7684VECT_TAB_OFFSET\u5b8f\u88ab\u5b9a\u4e49\u62100x8000\uff1a #define VECT_TAB_OFFSET 0x8000 /*!< Vector Table base offset field. This value must be a multiple of 0x200. */ \u200b \u7f16\u8bd1application\u7a0b\u5e8f\uff0c\u5728board\\TencentOS_tiny_EVB_MX_Plus\\KEIL\\iap\\application\u76ee\u5f55\u4e0b\u4f1a\u751f\u6210TencentOS_tiny.bin\uff0c\u8fd9\u4e2a\u5c31\u662f\u5728IAP\u5347\u7ea7\u4e2d\u8981\u4f20\u8f93\u5e76\u70e7\u5f55\u8fdb\u5f00\u53d1\u677f\u7684APP\u955c\u50cf\u3002 3. IAP APP\u5347\u7ea7\u6f14\u793a 3.1 \u57fa\u4e8exshell\u4e0e\u666e\u901a\u4e32\u53e3\u7684APP\u5347\u7ea7 \u200b \u56e0\u4e3aAPP\u4f20\u8f93\u5230\u5f00\u53d1\u677f\u4e0a\u662f\u901a\u8fc7ymodem\u534f\u8bae\uff0c\u666e\u901a\u7684\u4e32\u53e3\u8c03\u8bd5\u5de5\u5177\u6ca1\u6709\u96c6\u6210ymodem\u534f\u8bae\uff0c\u8fd9\u91cc\u901a\u8fc7xshell\u6765\u6f14\u793aAPP\u7684ymodem\u534f\u8bae\u3002\u5b9e\u9645\u4e0a\uff0c\u901a\u8fc7SecureCRT\u7b49\u5176\u4ed6\u96c6\u6210\u6709ymodem\u53ca\u4e32\u53e3\u534f\u8bae\u7684\u7ec8\u7aef\u7686\u53ef\u3002 \u200b \u7528xshell\u8fde\u63a5\u5230\u5f00\u53d1\u677f\u4e32\u53e3\u4e0a\uff0c\u5e76\u6309\u4f4f\u5f00\u53d1\u677fF2\u952e\u540c\u65f6\u590d\u4f4d\u5f00\u53d1\u677f\u8fdb\u5165BootLoader\u5347\u7ea7\u6a21\u5f0f\uff0c\u5728BootLoader\u83dc\u5355\u63d0\u793a\u4e0b\uff0cxshell\u4e2d\u8f93\u5165\u201c1\u201d\u8fdb\u5165APP\u4e0b\u8f7d\u53ca\u5347\u7ea7\u6a21\u5f0f\u3002 \u200b \u6b64\u65f6\u5f00\u53d1\u677f\u4f1a\u8fdb\u5165\u7b49\u5f85\u4e32\u53e3\u901a\u8fc7ymodem\u53d1\u9001APP\u7684\u72b6\u6001\u3002\u5728xshell\u7684\u6587\u4ef6\u2014\u2014\u4f20\u8f93\u2014\u2014YMODEM(Y)\u2014\u2014\u7528YMODEM\u53d1\u9001(S)\uff1a \u200b \u5728\u5f39\u51fa\u7684\u5bf9\u8bdd\u6846\u4e2d\uff0c\u9009\u62e92.2\u8282\u4e2d\u7f16\u8bd1\u751f\u6210\u7684bin\u683c\u5f0f\u7684APP\uff1a board\\TencentOS_tiny_EVB_MX_Plus\\KEIL\\iap\\application\\TencentOS_tiny.bin \u200b \u200b \u5f00\u53d1\u677f\u63a5\u6536\u5b8c\u6bd5\u540e\u4f1a\u5c06\u63a5\u6536\u5230\u7684APP bin\u5199\u5165\u5185\u90e8FLASH\uff0c\u5199\u5165\u5b8c\u6210\u540e\u4f1a\u6253\u5370\u63d0\u793a\uff1a \u200b \u6b64\u65f6BootLoader\u4f1a\u518d\u6b21\u8fdb\u5165\u83dc\u5355\u6a21\u5f0f\uff0c\u5728\u83dc\u5355\u6a21\u5f0f\u4e0b\u8f93\u51653\u5373\u53ef\u6267\u884c\u521a\u521a\u5199\u5165\u7684APP bin\uff1a 3.2 \u57fa\u4e8e\u5c0f\u7a0b\u5e8f\u4e0eBLE\u900f\u4f20\u4e32\u53e3\u7684APP\u5347\u7ea7 \u200b \u9664\u4e863.1\u8282\u7684\u4f20\u7edf\u4e32\u53e3\u5347\u7ea7\uff0cTencentOS tiny\u5b98\u65b9\u53e6\u5916\u63d0\u4f9b\u4e86\u57fa\u4e8eBLE\u900f\u4f20\u4e32\u53e3\u7684IAP APP\u5347\u7ea7\u914d\u5957\u5c0f\u7a0b\u5e8f\u3002 \u200b \u8fd9\u91cc\u57fa\u4e8eHC-08\u84dd\u7259\u900f\u4f20\u6a21\u5757\u8bb2\u89e3\u5982\u4f55\u4f7f\u7528\u5c0f\u7a0b\u5e8f\u8fdb\u884cIAP APP\u5347\u7ea7\u3002 \u200b \u6211\u5047\u8bbe\u4f60\u7684HC-08\uff08\u6216\u5176\u4ed6\u76f8\u4f3c\u7684\u84dd\u7259\u900f\u4f20\u4e32\u53e3\uff09\u6ce2\u7279\u7387\u4e3a115200\uff0c\u5982\u679c\u4e0d\u662f\uff0c\u53ef\u4ee5\u901a\u8fc7\u67e5\u9605\u76f8\u5173\u4ea7\u54c1\u8d44\u6599\u624b\u518c\u5c06\u6ce2\u7279\u7387\u4fee\u6539\u4e3a115200\uff1b\u6216\u8005\u6539\u52a8BootLoader\u53caapplication\u4e2dUSART2\u7684\u6ce2\u7279\u7387\u4e3a\u4f60\u7684\u6a21\u5757\u7684\u6ce2\u7279\u7387\u3002 \u200b HC-08\u4e0e\u5f00\u53d1\u677f\u7684\u63a5\u7ebf\u53c2\u8003\u4e0b\u56fe\uff1a HC-08 EVB MX+ RXD U2_TX TXD U2_RX GND GND VCC V5.0 \u200b \u6253\u5f00tools\\Mini_Program\\iap\u76ee\u5f55\u4e2d\u7684\u5c0f\u7a0b\u5e8f\uff0c\u7528\u5fae\u4fe1\u626b\u7801\u5f00\u59cb\u4f7f\u7528\u5c0f\u7a0b\u5e8f\uff1a \u6253\u5f00\u624b\u673a\u84dd\u7259 \u641c\u7d22\u8fde\u63a5HC-08\u7684\u84dd\u7259\u5e7f\u64ad \u6309\u4f4fF2\u590d\u4f4d\u5f00\u53d1\u677f\u53ef\u4ee5\u5728\u5c0f\u7a0b\u5e8f\u4e2d\u7684\u4e32\u53e3\u8f93\u51fa\u4e2d\u6536\u5230\u5f00\u53d1\u677f\u7684BootLoader\u83dc\u5355 \u5728\u56fa\u4ef6\u5347\u7ea7\u4e2d\uff0c\u70b9\u51fb\u83dc\u5355\u9009\u9879\u201c1\u201d\uff0c\u518d\u70b9\u51fb\"\u9009\u62e9\u56fa\u4ef6\"\uff0c\u901a\u8fc7\u6587\u4ef6\u4f20\u8f93\u52a9\u624b\u9009\u62e9TencentOS_tiny.bin \u70b9\u51fb\u201c\u4e0a\u4f20\u56fa\u4ef6\u201d\uff0c\u7b49\u5f85APP\u4f20\u8f93\u5e76\u70e7\u5199\u5b8c\u6bd5\uff1a \u7b49\u5f85\u955c\u50cf\u4f20\u8f93\u5e76\u70e7\u5199\u5b8c\u6bd5\u540e\uff0c\u5728BootLoader\u7684\u83dc\u5355\u9009\u9879\u4e0b\uff0c\u70b9\u51fb\u83dc\u5355\u9009\u9879\u201c3\u201d\u6267\u884c\u521a\u624d\u70e7\u5f55\u7684APP\uff1a","title":"20.In_Application_Programming_based_EVB_MX_Plus"},{"location":"20.In_Application_Programming_based_EVB_MX_Plus/#tencentos-tinyevb-mxiap","text":"","title":"\u57fa\u4e8eTencentOS tiny\u5b98\u65b9EVB MX+\u5f00\u53d1\u677f\u7684IAP"},{"location":"20.In_Application_Programming_based_EVB_MX_Plus/#1-iap","text":"\u4ee5\u4e0b\u5185\u5bb9\u5f15\u81ea\u6b63\u70b9\u539f\u5b50\u300aSTM32F429\u5f00\u53d1\u6307\u5357-HAL\u5e93\u7248\u672c_v1.1\u300b\u7b2c\u4e94\u5341\u4e03\u7ae0\uff0c\u5982\u4fb5\u6743\u8bf7\u8054\u7cfb\u5220\u9664\u3002 \u200b IAP\uff08 In Application Programming\uff09\u5373\u5728\u5e94\u7528\u7f16\u7a0b\uff0c IAP \u662f\u7528\u6237\u81ea\u5df1\u7684\u7a0b\u5e8f\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u5bf9User Flash \u7684\u90e8\u5206\u533a\u57df\u8fdb\u884c\u70e7\u5199\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u5728\u4ea7\u54c1\u53d1\u5e03\u540e\u53ef\u4ee5\u65b9\u4fbf\u5730\u901a\u8fc7\u9884\u7559\u7684\u901a\u4fe1\u53e3\u5bf9\u4ea7\u54c1\u4e2d\u7684\u56fa\u4ef6\u7a0b\u5e8f\u8fdb\u884c\u66f4\u65b0\u5347\u7ea7\u3002 \u901a\u5e38\u5b9e\u73b0 IAP \u529f\u80fd\u65f6\uff0c\u5373\u7528\u6237\u7a0b\u5e8f\u8fd0\u884c\u4e2d\u4f5c\u81ea\u8eab\u7684\u66f4\u65b0\u64cd\u4f5c\uff0c\u9700\u8981\u5728\u8bbe\u8ba1\u56fa\u4ef6\u7a0b\u5e8f\u65f6\u7f16\u5199\u4e24\u4e2a\u9879\u76ee\u4ee3\u7801\uff0c\u7b2c\u4e00\u4e2a\u9879\u76ee\u7a0b\u5e8f\u4e0d\u6267\u884c\u6b63\u5e38\u7684\u529f\u80fd\u64cd\u4f5c\uff0c\u800c\u53ea\u662f\u901a\u8fc7\u67d0\u79cd\u901a\u4fe1\u65b9\u5f0f(\u5982 USB\u3001 USART)\u63a5\u6536\u7a0b\u5e8f\u6216\u6570\u636e\uff0c\u6267\u884c\u5bf9\u7b2c\u4e8c\u90e8\u5206\u4ee3\u7801\u7684\u66f4\u65b0\uff1b\u7b2c\u4e8c\u4e2a\u9879\u76ee\u4ee3\u7801\u624d\u662f\u771f\u6b63\u7684\u529f\u80fd\u4ee3\u7801\u3002\u8fd9\u4e24\u90e8\u5206\u9879\u76ee\u4ee3\u7801\u90fd\u540c\u65f6\u70e7\u5f55\u5728 User Flash \u4e2d\uff0c\u5f53\u82af\u7247\u4e0a\u7535\u540e\uff0c\u9996\u5148\u662f\u7b2c\u4e00\u4e2a\u9879\u76ee\u4ee3\u7801\u5f00\u59cb\u8fd0\u884c\uff0c\u5b83\u4f5c\u5982\u4e0b\u64cd\u4f5c\uff1a \u200b 1\uff09\u68c0\u67e5\u662f\u5426\u9700\u8981\u5bf9\u7b2c\u4e8c\u90e8\u5206\u4ee3\u7801\u8fdb\u884c\u66f4\u65b0 \u200b 2\uff09\u5982\u679c\u4e0d\u9700\u8981\u66f4\u65b0\u5219\u8f6c\u5230 4\uff09 \u200b 3\uff09\u6267\u884c\u66f4\u65b0\u64cd\u4f5c \u200b 4\uff09\u8df3\u8f6c\u5230\u7b2c\u4e8c\u90e8\u5206\u4ee3\u7801\u6267\u884c \u200b \u7b2c\u4e00\u90e8\u5206\u4ee3\u7801\u5fc5\u987b\u901a\u8fc7\u5176\u5b83\u624b\u6bb5\uff0c\u5982 JTAG \u6216 ISP \u70e7\u5165\uff1b\u7b2c\u4e8c\u90e8\u5206\u4ee3\u7801\u53ef\u4ee5\u4f7f\u7528\u7b2c\u4e00\u90e8\u5206\u4ee3\u7801 IAP \u529f\u80fd\u70e7\u5165\uff0c\u4e5f\u53ef\u4ee5\u548c\u7b2c\u4e00\u90e8\u5206\u4ee3\u7801\u4e00\u8d77\u70e7\u5165\uff0c\u4ee5\u540e\u9700\u8981\u7a0b\u5e8f\u66f4\u65b0\u65f6\u518d\u901a\u8fc7\u7b2c\u4e00\u90e8\u5206 IAP\u4ee3\u7801\u66f4\u65b0\u3002 \u200b \u6211\u4eec\u5c06\u7b2c\u4e00\u4e2a\u9879\u76ee\u4ee3\u7801\u79f0\u4e4b\u4e3a Bootloader \u7a0b\u5e8f\uff0c\u7b2c\u4e8c\u4e2a\u9879\u76ee\u4ee3\u7801\u79f0\u4e4b\u4e3a APP \u7a0b\u5e8f\uff0c\u4ed6\u4eec\u5b58\u653e\u5728 STM32F429 FLASH \u7684\u4e0d\u540c\u5730\u5740\u8303\u56f4\uff0c\u4e00\u822c\u4ece\u6700\u4f4e\u5730\u5740\u533a\u5f00\u59cb\u5b58\u653e Bootloader\uff0c\u7d27\u8ddf\u5176\u540e\u7684\u5c31\u662f APP \u7a0b\u5e8f\u3002","title":"1. \u4ec0\u4e48\u662fIAP"},{"location":"20.In_Application_Programming_based_EVB_MX_Plus/#2-tencentos-tinyiap","text":"","title":"2. TencentOS tiny\u7684IAP\u7a0b\u5e8f"},{"location":"20.In_Application_Programming_based_EVB_MX_Plus/#21-bootloader","text":"\u200b \u5982\u7b2c\u4e00\u7ae0\u6240\u8a00\uff0c\u4e00\u4e2aIAP\u4f8b\u7a0b\u4e00\u822c\u7531BootLoader\u53caAPP\u4e24\u90e8\u5206\u6784\u6210\uff0c\u5176\u4e2dBootLoader\u8d77\u5f15\u5bfc\u677f\u5b50\u542f\u52a8\u5e76\u63d0\u4f9bAPP\u4e0b\u8f7d\u70e7\u5f55\u9009\u9879\u3002 \u200b \u57fa\u4e8eTencentOS tiny\u5b98\u65b9EVB MX+\u5f00\u53d1\u677f\uff0c\u63d0\u4f9b\u4e86\u5b98\u65b9IAP BootLoader\u7a0b\u5e8f\uff0c\u5bf9\u5e94\u7684keil\u5de5\u7a0b\u4f4d\u4e8e\uff1a board\\TencentOS_tiny_EVB_MX_Plus\\KEIL\\iap\\bootloader \u200b \u4e0e\u6b63\u5e38\u7684\u5e94\u7528\u7a0b\u5e8f\u7f16\u8bd1\u70e7\u5199\u6d41\u7a0b\u4e00\u81f4\uff0c\u53cc\u51fb\u6253\u5f00keil\u5de5\u7a0b\u540e\uff0c\u5c06BootLoader\u70e7\u5199\u8fdb\u5f00\u53d1\u677f\u3002 \u200b \u6309\u4e0b\u590d\u4f4d\u952e\u540e\uff0cBootLoader\u4f1a\u76f4\u63a5\u8fdb\u5165\u52a0\u8f7d\u5e76\u8fd0\u884cAPP\u7684\u6d41\u7a0b\u3002 \u200b \u8fd9\u91cc\u4e3a\u4e86\u6f14\u793aIAP\u6d41\u7a0b\uff0c\u8ba9BootLoader\u8fdb\u5165APP\u5347\u7ea7\u6a21\u5f0f\uff0c\u5177\u4f53\u7684\u505a\u6cd5\u662f\u6309\u4f4f\u677f\u4e0aF2\u6309\u952e\u7684\u540c\u65f6\uff0c\u518d\u6309\u4e0b\u590d\u4f4d\u952e\uff1a \u200b \u5c06microUSB\uff08\u677f\u4e0aUSART2\uff09\u63a5\u5230\u7535\u8111\u4e0a\uff0c\u6253\u5f00\u4e32\u53e3\u8c03\u8bd5\u52a9\u624b\uff0c\u5e76\u5c06\u6ce2\u7279\u7387\u9009\u4e3a115200\uff0c\u53ef\u4ee5\u770b\u5230BootLoader\u7684\u83dc\u5355\uff1a \u200b BootLoader\u7684\u56db\u4e2a\u83dc\u5355\u9009\u9879\u5206\u522b\u662f\uff1a \u901a\u8fc7\u4e32\u53e3ymodem\u534f\u8bae\u4e0b\u8f7dAPP\u955c\u50cf\u5230\u677f\u5b50\u5185\u90e8FLASH \u901a\u8fc7\u4e32\u53e3ymodem\u534f\u8bae\u4e0a\u4f20\u677f\u5b50\u5185\u90e8FLASH\u4e0a\u7684APP\u955c\u50cf \u6267\u884cAPP \u4f7f\u80fd\u5185\u90e8FLASH\u5199\u4fdd\u62a4","title":"2.1 BootLoader\u7a0b\u5e8f"},{"location":"20.In_Application_Programming_based_EVB_MX_Plus/#22-app","text":"\u200b \u57fa\u4e8eTencentOS tiny\u5b98\u65b9EVB MX+\u5f00\u53d1\u677f\uff0c\u63d0\u4f9b\u4e86\u5b98\u65b9\u793a\u4f8bAPP\u7a0b\u5e8f\uff0c\u7531hello world\u793a\u4f8b\u4fee\u6539\u800c\u6765\uff0c\u5bf9\u5e94\u7684keil\u5de5\u7a0b\u4f4d\u4e8e\uff1a board\\TencentOS_tiny_EVB_MX_Plus\\KEIL\\iap\\application \u200b \u56e0\u4e3aIAP\u4e2d\u7684APP\u662f\u7531BootLoader\u6765\u8df3\u8f6c\u6267\u884c\u7684\uff0cBootLoader\u53ea\u80fd\u8df3\u8f6c\u6267\u884cbin\u683c\u5f0f\u7684APP\u7a0b\u5e8f\uff0c\u56e0\u6b64\u9700\u8981\u6dfb\u52a0\u5c06APP\u7a0b\u5e8f\u8f6c\u6210bin\u683c\u5f0f\u7684\u6d41\u7a0b\uff1a","title":"2.2 APP\u7a0b\u5e8f"},{"location":"20.In_Application_Programming_based_EVB_MX_Plus/#_1","text":"\u200b \u540c\u65f6\uff0c\u8981\u786e\u4fddsystem_stm32l4xx.c\u4e2d\u7684VECT_TAB_OFFSET\u5b8f\u88ab\u5b9a\u4e49\u62100x8000\uff1a #define VECT_TAB_OFFSET 0x8000 /*!< Vector Table base offset field. This value must be a multiple of 0x200. */ \u200b \u7f16\u8bd1application\u7a0b\u5e8f\uff0c\u5728board\\TencentOS_tiny_EVB_MX_Plus\\KEIL\\iap\\application\u76ee\u5f55\u4e0b\u4f1a\u751f\u6210TencentOS_tiny.bin\uff0c\u8fd9\u4e2a\u5c31\u662f\u5728IAP\u5347\u7ea7\u4e2d\u8981\u4f20\u8f93\u5e76\u70e7\u5f55\u8fdb\u5f00\u53d1\u677f\u7684APP\u955c\u50cf\u3002","title":""},{"location":"20.In_Application_Programming_based_EVB_MX_Plus/#3-iap-app","text":"","title":"3. IAP APP\u5347\u7ea7\u6f14\u793a"},{"location":"20.In_Application_Programming_based_EVB_MX_Plus/#31-xshellapp","text":"\u200b \u56e0\u4e3aAPP\u4f20\u8f93\u5230\u5f00\u53d1\u677f\u4e0a\u662f\u901a\u8fc7ymodem\u534f\u8bae\uff0c\u666e\u901a\u7684\u4e32\u53e3\u8c03\u8bd5\u5de5\u5177\u6ca1\u6709\u96c6\u6210ymodem\u534f\u8bae\uff0c\u8fd9\u91cc\u901a\u8fc7xshell\u6765\u6f14\u793aAPP\u7684ymodem\u534f\u8bae\u3002\u5b9e\u9645\u4e0a\uff0c\u901a\u8fc7SecureCRT\u7b49\u5176\u4ed6\u96c6\u6210\u6709ymodem\u53ca\u4e32\u53e3\u534f\u8bae\u7684\u7ec8\u7aef\u7686\u53ef\u3002 \u200b \u7528xshell\u8fde\u63a5\u5230\u5f00\u53d1\u677f\u4e32\u53e3\u4e0a\uff0c\u5e76\u6309\u4f4f\u5f00\u53d1\u677fF2\u952e\u540c\u65f6\u590d\u4f4d\u5f00\u53d1\u677f\u8fdb\u5165BootLoader\u5347\u7ea7\u6a21\u5f0f\uff0c\u5728BootLoader\u83dc\u5355\u63d0\u793a\u4e0b\uff0cxshell\u4e2d\u8f93\u5165\u201c1\u201d\u8fdb\u5165APP\u4e0b\u8f7d\u53ca\u5347\u7ea7\u6a21\u5f0f\u3002 \u200b \u6b64\u65f6\u5f00\u53d1\u677f\u4f1a\u8fdb\u5165\u7b49\u5f85\u4e32\u53e3\u901a\u8fc7ymodem\u53d1\u9001APP\u7684\u72b6\u6001\u3002\u5728xshell\u7684\u6587\u4ef6\u2014\u2014\u4f20\u8f93\u2014\u2014YMODEM(Y)\u2014\u2014\u7528YMODEM\u53d1\u9001(S)\uff1a \u200b \u5728\u5f39\u51fa\u7684\u5bf9\u8bdd\u6846\u4e2d\uff0c\u9009\u62e92.2\u8282\u4e2d\u7f16\u8bd1\u751f\u6210\u7684bin\u683c\u5f0f\u7684APP\uff1a board\\TencentOS_tiny_EVB_MX_Plus\\KEIL\\iap\\application\\TencentOS_tiny.bin \u200b \u200b \u5f00\u53d1\u677f\u63a5\u6536\u5b8c\u6bd5\u540e\u4f1a\u5c06\u63a5\u6536\u5230\u7684APP bin\u5199\u5165\u5185\u90e8FLASH\uff0c\u5199\u5165\u5b8c\u6210\u540e\u4f1a\u6253\u5370\u63d0\u793a\uff1a \u200b \u6b64\u65f6BootLoader\u4f1a\u518d\u6b21\u8fdb\u5165\u83dc\u5355\u6a21\u5f0f\uff0c\u5728\u83dc\u5355\u6a21\u5f0f\u4e0b\u8f93\u51653\u5373\u53ef\u6267\u884c\u521a\u521a\u5199\u5165\u7684APP bin\uff1a","title":"3.1 \u57fa\u4e8exshell\u4e0e\u666e\u901a\u4e32\u53e3\u7684APP\u5347\u7ea7"},{"location":"20.In_Application_Programming_based_EVB_MX_Plus/#32-bleapp","text":"\u200b \u9664\u4e863.1\u8282\u7684\u4f20\u7edf\u4e32\u53e3\u5347\u7ea7\uff0cTencentOS tiny\u5b98\u65b9\u53e6\u5916\u63d0\u4f9b\u4e86\u57fa\u4e8eBLE\u900f\u4f20\u4e32\u53e3\u7684IAP APP\u5347\u7ea7\u914d\u5957\u5c0f\u7a0b\u5e8f\u3002 \u200b \u8fd9\u91cc\u57fa\u4e8eHC-08\u84dd\u7259\u900f\u4f20\u6a21\u5757\u8bb2\u89e3\u5982\u4f55\u4f7f\u7528\u5c0f\u7a0b\u5e8f\u8fdb\u884cIAP APP\u5347\u7ea7\u3002 \u200b \u6211\u5047\u8bbe\u4f60\u7684HC-08\uff08\u6216\u5176\u4ed6\u76f8\u4f3c\u7684\u84dd\u7259\u900f\u4f20\u4e32\u53e3\uff09\u6ce2\u7279\u7387\u4e3a115200\uff0c\u5982\u679c\u4e0d\u662f\uff0c\u53ef\u4ee5\u901a\u8fc7\u67e5\u9605\u76f8\u5173\u4ea7\u54c1\u8d44\u6599\u624b\u518c\u5c06\u6ce2\u7279\u7387\u4fee\u6539\u4e3a115200\uff1b\u6216\u8005\u6539\u52a8BootLoader\u53caapplication\u4e2dUSART2\u7684\u6ce2\u7279\u7387\u4e3a\u4f60\u7684\u6a21\u5757\u7684\u6ce2\u7279\u7387\u3002 \u200b HC-08\u4e0e\u5f00\u53d1\u677f\u7684\u63a5\u7ebf\u53c2\u8003\u4e0b\u56fe\uff1a HC-08 EVB MX+ RXD U2_TX TXD U2_RX GND GND VCC V5.0 \u200b \u6253\u5f00tools\\Mini_Program\\iap\u76ee\u5f55\u4e2d\u7684\u5c0f\u7a0b\u5e8f\uff0c\u7528\u5fae\u4fe1\u626b\u7801\u5f00\u59cb\u4f7f\u7528\u5c0f\u7a0b\u5e8f\uff1a \u6253\u5f00\u624b\u673a\u84dd\u7259 \u641c\u7d22\u8fde\u63a5HC-08\u7684\u84dd\u7259\u5e7f\u64ad \u6309\u4f4fF2\u590d\u4f4d\u5f00\u53d1\u677f\u53ef\u4ee5\u5728\u5c0f\u7a0b\u5e8f\u4e2d\u7684\u4e32\u53e3\u8f93\u51fa\u4e2d\u6536\u5230\u5f00\u53d1\u677f\u7684BootLoader\u83dc\u5355 \u5728\u56fa\u4ef6\u5347\u7ea7\u4e2d\uff0c\u70b9\u51fb\u83dc\u5355\u9009\u9879\u201c1\u201d\uff0c\u518d\u70b9\u51fb\"\u9009\u62e9\u56fa\u4ef6\"\uff0c\u901a\u8fc7\u6587\u4ef6\u4f20\u8f93\u52a9\u624b\u9009\u62e9TencentOS_tiny.bin \u70b9\u51fb\u201c\u4e0a\u4f20\u56fa\u4ef6\u201d\uff0c\u7b49\u5f85APP\u4f20\u8f93\u5e76\u70e7\u5199\u5b8c\u6bd5\uff1a \u7b49\u5f85\u955c\u50cf\u4f20\u8f93\u5e76\u70e7\u5199\u5b8c\u6bd5\u540e\uff0c\u5728BootLoader\u7684\u83dc\u5355\u9009\u9879\u4e0b\uff0c\u70b9\u51fb\u83dc\u5355\u9009\u9879\u201c3\u201d\u6267\u884c\u521a\u624d\u70e7\u5f55\u7684APP\uff1a","title":"3.2 \u57fa\u4e8e\u5c0f\u7a0b\u5e8f\u4e0eBLE\u900f\u4f20\u4e32\u53e3\u7684APP\u5347\u7ea7"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/","text":"1. TencentOS-tiny OTA 1.1. OTA\u4e0eIAP IAP\u5168\u79f0 In Application Programming\uff0c\u4ec0\u4e48\u662f\u5728\u5e94\u7528\u7f16\u7a0b\u5462\uff1f \u6b63\u5e38\u5f00\u53d1\u6d41\u7a0b\u5982\u4e0b\uff1a \u4f7f\u7528Keil MDK\u5de5\u5177\u7f16\u5199\u5e94\u7528\u7a0b\u5e8f\uff1b \u7f16\u8bd1\u51fa.axf\u53ef\u6267\u884c\u7a0b\u5e8f\u6216\u8005.bin\u6587\u4ef6\uff0c\u6216\u8005.hex\u6587\u4ef6\uff1b \u4f7f\u7528Keil MDK\u5de5\u5177\u76f4\u63a5\u70e7\u5f55.axf\u6587\u4ef6\u5230STM32 Flash\u4e2d\uff0c\u6216\u8005\u4f7f\u7528\u7c7b\u4f3cSTM32CubeProg\u4e4b\u7c7b\u7684\u8f6f\u4ef6\u70e7\u5f55.bin\u6587\u4ef6\u5230STM32 Flash\u4e2d\uff1b \u590d\u4f4d\uff0c\u5355\u7247\u673a\u4eceFlash\u8d77\u59cb\u5730\u5740\u5904\u8bfb\u53d6\u7a0b\u5e8f\u5e76\u6267\u884c\uff1b \u5f53\u4ea7\u54c1\u5f00\u53d1\u5b8c\u6210\u7528\u4e8e\u751f\u4ea7\u540e\uff0c\u901a\u5e38\u4e0d\u4f1a\u518d\u5f15\u51fa\u4e0b\u8f7d\u5668\u63a5\u53e3\u7ed9\u7528\u6237\uff0c\u6240\u4ee5\u4e5f\u5c31\u65e0\u6cd5\u8fde\u63a5\u5404\u79cd\u5404\u6837\u7684\u4e0b\u8f7d\u5668\uff0c\u66f4\u522b\u8bf4\u7528Keil\u6216\u8005STM32CubeProg\u8fd9\u4e9b\u5de5\u5177\u4e0b\u8f7d\u7a0b\u5e8f\uff0c\u5982\u679c\u53d1\u73b0\u5e94\u7528\u7a0b\u5e8f\u6709\u6f0f\u6d1e\uff0c\u6216\u8005\u8981\u4fee\u6539\u90e8\u5206\u529f\u80fd\uff0c\u90fd\u5df2\u7ecf\u65e0\u6cd5\u5b8c\u6210\u3002 1.1.1. IAP\u8bbe\u8ba1\u601d\u60f3 IAP\u5de7\u5999\u7684\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u5373\u5728\u5e94\u7528\u7a0b\u5e8f\u6b63\u5e38\u5de5\u4f5c\u7684\u65f6\u5019\uff0c\u8fd8\u53ef\u4ee5\u63a5\u6536\u65b0\u7684\u56fa\u4ef6\u5e76\u70e7\u5f55\u5230Flash\u4e2d\u3002 \u5e94\u7528\u7a0b\u5e8f\u5982\u4f55\u63a5\u6536\u65b0\u7684\u56fa\u4ef6\uff1f \u4e00\u822c\u4ea7\u54c1\u8bbe\u8ba1\u65f6\u90fd\u4f1a\u7559\u4e00\u4e2a\u7528\u4e8e\u6253\u5370\u65e5\u5fd7\u4fe1\u606f\u7684\u4e32\u53e3\uff0c\u53ef\u4ee5\u76f4\u63a5\u5229\u7528\u6b64\u4e32\u53e3\u6765\u63a5\u6536PC\u53d1\u9001\u5230\u65b0\u56fa\u4ef6\uff0c\u4f20\u8f93\u534f\u8bae\u5927\u591a\u90fd\u91c7\u7528Y-Modem\u534f\u8bae\u3002 \u63a5\u6536\u4e4b\u540e\u7684\u65b0\u56fa\u4ef6\u5b58\u653e\u5230\u54ea\u91cc\uff1f \u56fa\u4ef6\u5927\u5c0f\u4e00\u822c\u90fd\u6709\u51e0\u5341KB\u6216\u8005\u4e0a\u767eKB\uff0c\u5e94\u7528\u7a0b\u5e8f\u63a5\u6536\u5230\u65b0\u7684\u56fa\u4ef6\u4e4b\u540e\uff0c\u5982\u679c\u662f\u4ee5\u6570\u7ec4\u7684\u5f62\u5f0f\u6682\u5b58\u5728RAM\u7a7a\u95f4\u4e2d\uff0c\u4e0d\u4ec5\u4f1a\u6d6a\u8d39RAM\u7a7a\u95f4\uff0c\u800c\u4e14\u5bb9\u6613\u53d1\u751f\u56fa\u4ef6\u6570\u636e\u4e22\u5931\uff0c\u6240\u4ee5\u76f4\u63a5\u5b58\u50a8\u5230\u7a7a\u95f2\u7684Flash\u7a7a\u95f4\u4e2d\u662f\u6700\u597d\u7684\u65b9\u5f0f\u3002 eg. \u5b98\u65b9\u5f00\u53d1\u677f\u4f7f\u7528\u7684\u82af\u7247\u662fSTM32L431RCT6\uff0cFlash\u7a7a\u95f4\u6709256KB\uff0c\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u7684\u5927\u5c0f\u53ea\u6709100KB\uff0c\u90a3\u4e48\u63a5\u6536\u8fdb\u6765\u7684\u65b0\u56fa\u4ef6\u5c31\u53ef\u4ee5\u5b58\u653e\u5728\u5269\u4f59\u7684156KB\u7a7a\u95f4\u4e2d\u3002 \u540c\u65f6\u4f1a\u4eba\u4e3a\u7684\u5bf9Flash\u5212\u5206\u5206\u533a\uff0c\u4e5f\u5c31\u662f\u5bf9\u67d0\u4e00\u6bb5\u5730\u5740\u7a7a\u95f4\u8d77\u4e2a\u540d\u5b57\uff0c\u5982\u4e0b\u56fe\uff1a \u5982\u4f55\u5c06\u8001\u56fa\u4ef6\u66ff\u6362\u4e3a\u4e3a\u65b0\u56fa\u4ef6\uff1f \u4e0a\u7535\u4e4b\u540eCPU\u4f1a\u4eceFlash\u7684\u8d77\u59cb\u5730\u5740\u5904\u8bfb\u53d6\u6570\u636e\u5f00\u59cb\u6267\u884c\uff0c\u8fd9\u70b9\u65e0\u6cd5\u6539\u53d8\uff0c\u6b63\u5728\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\u5982\u679c\u8fdb\u884c\u81ea\u5df1\u64e6\u9664\u81ea\u5df1\u7684\u64cd\u4f5c\uff0c\u8bbe\u5907\u76f4\u63a5\u53d8\u7816\u3002 bootloader\u53ef\u4ee5\u5b8c\u7f8e\u7684\u89e3\u51b3\u8fd9\u4e00\u95ee\u9898\uff0c\u5373\u5199\u4e00\u5c0f\u6bb5\u5e94\u7528\u7a0b\u5e8f\uff0c\u653e\u5728Flash\u7684\u8d77\u59cb\u4f4d\u7f6e\u5904\uff0c\u4f7f\u5f97\u6bcf\u6b21\u4e0a\u7535\u4e4b\u540e\u6700\u5148\u8fd0\u884cbootloader\uff0c\u5b8c\u6210\u4e24\u4e2a\u529f\u80fd\uff1a \u68c0\u67e5\u5347\u7ea7\u6807\u5fd7\uff0c\u662f\u5426\u6709\u65b0\u7684\u56fa\u4ef6\u88ab\u4e0b\u8f7d\u5230IAP\u5206\u533a\u4e2d\uff1b \u5982\u679c\u65e0\u5347\u7ea7\u6807\u5fd7\uff0c\u5219\u8df3\u8f6c\u5230ActiveAPP\u5206\u533a\uff0c\u5f00\u59cb\u6267\u884c\u5e94\u7528\u7a0b\u5e8f\uff1b \u5982\u679c\u6709\u5347\u7ea7\u6807\u5fd7\uff0c\u5219\u5148\u5c06IAP\u5206\u533a\u4e2d\u7684\u56fa\u4ef6\u62f7\u8d1d\u5230ActiveAPP\u5206\u533a\u4e2d\uff0c\u7136\u540e\u8df3\u8f6c\u5230ActiveAPP\u5206\u533a\uff0c\u5f00\u59cb\u6267\u884c\u65b0\u7684\u5e94\u7528\u7a0b\u5e8f\uff1b \u52a0\u5165bootloader\u4e4b\u540e\uff0c\u6574\u4e2aFlash\u7684\u5206\u533a\u60c5\u51b5\u5982\u4e0b\uff1a 1.1.2. OTA\u8bbe\u8ba1\u601d\u60f3 \u5728IAP\u7684\u8fd9\u79cd\u8bbe\u8ba1\u601d\u60f3\u4e4b\u4e0a\uff0c\u56e0\u4e3a\u5f53\u524d\u7684\u7269\u8054\u7f51\u8bbe\u5907\u90fd\u5df2\u7ecf\u5177\u5907\u57fa\u672c\u7684\u7f51\u7edc\u901a\u4fe1\u529f\u80fd\uff0c\u6240\u4ee5\u65e0\u9700\u901a\u8fc7\u4e32\u53e3\u4f20\u8f93\u65b0\u7684\u56fa\u4ef6\uff0c\u76f4\u63a5\u901a\u8fc7\u7f51\u7edc\u4f20\u8f93\u65b0\u7684\u56fa\u4ef6\u5373\u53ef\uff0c\u79f0\u4e4b\u4e3aOTA IAP(Over The Air In Application Programming)\uff0c\u4e5f\u5c31\u662f\u5e73\u5e38\u6240\u8bf4\u7684\u7a7a\u4e2d\u5347\u7ea7\uff0c\u7b80\u79f0OTA\u3002 1.2. OTA\u7ec4\u4ef6\u6982\u8ff0\u3001\u7279\u6027\u53ca\u4f18\u52bf TencentOS-tiny\u4e2d\u63d0\u4f9b\u7684OTA\u7ec4\u4ef6\u5b8c\u5168\u5f00\u6e90\u514d\u8d39\uff0c\u76f8\u8f83\u4e8e\u5176\u4ed6\u7684OTA\u529f\u80fd\uff0cTencentOS-tiny OTA\u7ec4\u4ef6\u63d0\u4f9b\u66f4\u5c0f\u7684\u5dee\u5206\u5347\u7ea7\u5305\uff0c\u8017\u7528\u66f4\u5c11\u7684\u4f20\u8f93\u6d41\u91cf\uff0c\u5360\u7528\u66f4\u5c0f\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u63d0\u4f9b\u66f4\u53ef\u9760\u7684\u5347\u7ea7\u670d\u52a1\u3002 TencentOS-tiny OTA\u7ec4\u4ef6\u6709\u4ee5\u4e0b\u7684\u7279\u6027\uff1a \u4f20\u8f93\u5dee\u5206\u5347\u7ea7\u5305\uff0c\u800c\u4e0d\u662f\u6574\u4e2a\u56fa\u4ef6 \u7075\u6d3b\u7684\u5206\u533a\u8868\u529f\u80fd \u652f\u6301\u539f\u5730\u5347\u7ea7 \u652f\u6301\u4e52\u4e53\u5347\u7ea7\uff0c\u53ef\u4ee5\u5728\u5347\u7ea7\u4e2d\u65ad\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u7248\u672c\u56de\u6eda \u652f\u6301\u901a\u8fc7HTTP\u4ece\u81ea\u5efa\u670d\u52a1\u5668\u62c9\u53d6\u56fa\u4ef6 \u652f\u6301\u4ece\u817e\u8baf\u4e91\u5e73\u53f0\u8fdb\u884c\u7edf\u4e00\u7684\u56fa\u4ef6\u62c9\u53d6\u548c\u7ba1\u7406 1.3. OTA\u7ec4\u4ef6\u5f00\u53d1\u8c03\u8bd5\u63a8\u8350\u6d41\u7a0b OTA\u7684\u6574\u4e2a\u6d41\u7a0b\u8c03\u8bd5\u8f83\u590d\u6742\uff0c\u5982\u679c\u5206\u6b65\u6765\u505a\u4f1a\u6bd4\u8f83\u5bb9\u6613\uff1a (1)\u8c03\u8bd5bootloader\u662f\u5426\u53ef\u4ee5\u6b63\u5e38\u8bfb\u53d6\u5206\u533a\u8868\u4fe1\u606f\uff1b (2)\u8c03\u8bd5bootloader\u662f\u5426\u53ef\u4ee5\u6b63\u5e38\u8df3\u8f6c\u5230Active APP; (3)\u8c03\u8bd5bootloader\u662f\u5426\u76f4\u63a5\u53ef\u4ee5\u6839\u636epatch\u5305\u8fdb\u884c\u5347\u7ea7; (4)\u8c03\u8bd5Active APP\u662f\u5426\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u62c9\u53d6patch\u5347\u7ea7\u5305\u5e76\u4e0b\u8f7d\u5230 OTA \u5206\u533a; (5)\u7efc\u5408\u8c03\u8bd5\u3002 2. \u5206\u533a\u89c4\u5212\u53ca\u5206\u533a\u8868\u7684\u751f\u6210\u3001\u70e7\u5f55 2.1. \u5206\u533a\u89c4\u5212 TencentOS-tiny\u652f\u6301\u4e24\u79cd\u5347\u7ea7\u65b9\u5f0f\uff0c\u4e24\u79cd\u5347\u7ea7\u65b9\u5f0f\u5bf9\u5e94\u6709\u4e0d\u540c\u7684\u5206\u533a\u8868 \u539f\u5730\u5347\u7ea7\u65b9\u5f0f\u4e2d\uff0cbootloader\u76f4\u63a5\u6839\u636e\u65e7\u56fa\u4ef6+patch\u5347\u7ea7\u5305\u751f\u6210\u65b0\u7684\u56fa\u4ef6\uff0c\u4e00\u65e6\u5f00\u59cb\u5347\u7ea7\uff0c\u65e0\u8bba\u5347\u7ea7\u6210\u529f\u4e0e\u5426\u90fd\u65e0\u6cd5\u56de\u6eda\u5230\u4e0a\u4e00\u4e2a\u7248\u672c\uff0c\u4e3b\u8981\u6709\u4e94\u4e2a\u5206\u533a\uff1a Bootloader\u5206\u533a Active APP\u5206\u533a\uff1a\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684\u56fa\u4ef6\u5b58\u653e\u5206\u533a\uff1b OTA\u5206\u533a\uff1a\u65b0\u56fa\u4ef6\u5b58\u653e\u5206\u533a\uff1b KV\u5206\u533a\uff1a\u8bb0\u5f55\u7cfb\u7edf\u5347\u7ea7\u4e2d\u7684\u4e00\u4e9b\u73af\u5883\u53d8\u91cf\uff1b \u5206\u533a\u8868\uff1a\u5b58\u653e\u5206\u533a\u8868\uff08\u56fa\u5b9a\u5927\u5c0f32B\uff0c\u4e00\u822c\u653e\u5728Flash\u7684\u6700\u540e\u4e00\u4e2a\u6247\u533a\u4e2d\uff09 \u4e52\u4e53\u5347\u7ea7\u65b9\u5f0f\u4e2d\uff0cbootloader\u5728\u5347\u7ea7\u4e4b\u524d\u4f1a\u5c06\u539f\u6765\u7684\u56fa\u4ef6\u62f7\u8d1d\u4e00\u4efd\uff0c\u4e00\u65e6\u5f00\u59cb\u5347\u7ea7\uff0c\u65e0\u8bba\u65b0\u56fa\u4ef6\u5347\u7ea7\u6210\u529f\u4e0e\u5426\uff0c\u90fd\u53ef\u4ee5\u56de\u6eda\u5230\u4e0a\u4e00\u4e2a\u7248\u672c\uff0c\u4e3b\u8981\u6709\u516d\u4e2a\u5206\u533a\uff1a Bootloader\u5206\u533a Active APP\u5206\u533a\uff1a\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684\u56fa\u4ef6\u5b58\u653e\u5206\u533a\uff1b Backup\u5206\u533a \uff1a\u5907\u4efd\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684\u56fa\u4ef6\uff1b OTA\u5206\u533a\uff1a\u65b0\u56fa\u4ef6\u5b58\u653e\u5206\u533a\uff1b KV\u5206\u533a\uff1a\u8bb0\u5f55\u7cfb\u7edf\u5347\u7ea7\u4e2d\u7684\u4e00\u4e9b\u73af\u5883\u53d8\u91cf\uff1b \u5206\u533a\u8868\uff1a\u5b58\u653e\u5206\u533a\u8868\uff08\u56fa\u5b9a\u5927\u5c0f32B\uff0c\u4e00\u822c\u653e\u5728Flash\u7684\u6700\u540e\u4e00\u4e2a\u6247\u533a\u4e2d\uff09 \u5728\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c\u4e24\u79cd\u65b9\u5f0f\u7684\u9009\u62e9\u8981\u6839\u636e\u8bbe\u5907\u9700\u6c42\uff0c\u8bbe\u5907Flash\u7a7a\u95f4\u5927\u5c0f\uff0c\u8bbe\u5907Flash\u6247\u533a\u5927\u5c0f\u7efc\u5408\u8003\u8651\u3002 \u672c\u6587\u63a5\u4e0b\u6765\u5982\u65e0\u7279\u6b8a\u8bf4\u660e\uff0c\u90fd\u662f\u4ee5\u7b2c\u4e00\u79cd\u65b9\u5f0f\uff08\u539f\u5730\u5347\u7ea7\uff09\u4e3a\u4f8b\uff0c\u5b98\u65b9\u677f\u7684Flash\u5927\u5c0f\u4e3a256KB\uff0c\u53ef\u4ee5\u5982\u4e0b\u5206\u533a\uff1a 2.2. \u5206\u533a\u8868\u5de5\u5177\u7684\u4f7f\u7528\u65b9\u6cd5 TencentOS-tiny \u6e90\u7801\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e2a\u751f\u6210\u5206\u533a\u8868\u7684\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u9700\u8981\u5148\u4f7f\u7528gcc\u7f16\u8bd1\uff0c\u6ca1\u6709gcc\u73af\u5883\u53ef\u4ee5\u5b89\u88c5MinGW\u3002 2.2.1. \u7f16\u8bd1 \u8fdb\u5165 \\components\\ota\\tools\\partition_table \u76ee\u5f55\uff0c\u6267\u884cmake\u547d\u4ee4\u5f00\u59cb\u7f16\u8bd1\uff0c\u7f16\u8bd1\u4e4b\u540e\u8fdb\u5165\u5230\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 out\\target \u5373\u53ef\u770b\u5230\u5de5\u5177 ptbl.exe \uff1a cd out/target/ \u8be5\u5de5\u5177\u6709\u5982\u4e0b\u53c2\u6570\uff1a -h \uff1a\u6253\u5370\u5e2e\u52a9\u4fe1\u606f -p <ip/pp> \uff1a\u9009\u62e9\u5347\u7ea7\u65b9\u5f0f,ip\u6216\u8005pp -a <start,end> \uff1aActive APP\u5206\u533a\u7684\u8d77\u59cb\u548c\u7ed3\u675f\u5730\u5740 [-b <start,end>] \uff1aBackup \u5206\u533a\u7684\u8d77\u59cb\u548c\u7ed3\u675f\u5730\u5740\uff0c\u9009\u4e86pp\u65b9\u5f0f\u624d\u9700\u8981 -o <start,end> \uff1aOTA\u5206\u533a\u7684\u8d77\u59cb\u548c\u7ed3\u675f\u5730\u5740 -k <start,end> \uff1aKV\u5206\u533a\u7684\u8d77\u59cb\u548c\u7ed3\u675f\u5730\u5740 -v <major>.<minor> \uff1a\u521d\u8bc6\u56fa\u4ef6\u7248\u672c\u53f7 \u4e3a\u5b98\u65b9\u677f\u751f\u6210\u5206\u533a\u8868\u6587\u4ef6\u7684\u547d\u4ee4\u5982\u4e0b\uff1a ./ptbl.exe -p ip -a 0x08007800,0x0802D000 -o 0x0802D000,0x08039800 -k 0x08039800,0x0803F800 -v 0.1 ptbl.bin \u8fd0\u884c\u4e4b\u540e\u5373\u53ef\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u770b\u5230\u751f\u6210\u7684\u5206\u533a\u8868\u6587\u4ef6 ptbl.bin \u3002 2.3. \u5206\u533a\u8868\u70e7\u5f55\u65b9\u6cd5 \u751f\u6210\u7684\u5206\u533a\u8868\u6587\u4ef6 ptbl.bin \u53ef\u4ee5\u901a\u8fc7STM32CubeProg\u76f4\u63a5\u70e7\u5f55\u5230Flash\u4e2d\uff0c\u6309\u7167\u4e4b\u524d\u89c4\u5212\u7684\u5206\u533a\uff0c\u70e7\u5f55\u4f4d\u7f6e\u4e3a 0x0803F800 \uff0c\u70e7\u5f55\u65b9\u6cd5\u5982\u4e0b\uff1a (1)\u4f7f\u7528\u4e0b\u8f7d\u5668\u8fde\u63a5\u5f00\u53d1\u677f\u5230PC\uff0c\u6253\u5f00STM32CubeProg\u5de5\u5177\uff0c\u70b9\u51fbConnect\u8fde\u63a5\u5230\u5f00\u53d1\u677f\uff1a (2)\u5982\u679c\u662f \u7b2c\u4e00\u6b21\u4f7f\u7528OTA \uff0c\u70b9\u51fb\u5de6\u4fa7\u7684\u70e7\u5f55\u6309\u94ae\uff0c\u70b9\u51fb\u5168\u7247\u64e6\u9664\uff1a \u7b2c\u4e00\u6b21\u4f7f\u7528\u7684\u65f6\u5019\uff0cKV\u5206\u533a\u4e2d\u7684\u6570\u636e\u4e0d\u786e\u5b9a\uff0c\u53ef\u9760\u8d77\u89c1\u76f4\u63a5\u9009\u62e9\u5168\u7247\u64e6\u9664\u3002 (3)\u70b9\u51fb\u5de6\u4fa7\u7684\u70e7\u5f55\u6309\u94ae\uff0c\u9009\u62e9\u521a\u521a\u751f\u6210\u7684 ptbl.bin \uff0c\u4e0b\u8f7d\u5730\u5740\u586b\u5199 0x0803F800\uff0c\u70b9\u51fb\u70e7\u5f55\uff1a \u51fa\u73b0\u70e7\u5f55\u6210\u529f\u5f39\u7a97\u5373\u53ef\u3002 3. \u6d4b\u8bd5Bootloader\u7a0b\u5e8f \u8fdb\u5165 board\\TencentOS_tiny_EVB_MX_Plus\\KEIL\\ota \u76ee\u5f55\uff0c\u6253\u5f00\u5b98\u65b9\u63d0\u4f9b\u7684bootloader\u793a\u4f8b\u5de5\u7a0b\uff1a ota_bootloader_recovery \u3002 bootloader\u5176\u5b9e\u662f\u4e00\u4e2a\u88f8\u673a\u7a0b\u5e8f\uff0c\u5728 main \u51fd\u6570\u4e2d\u4e3b\u8981\u6709\u4e09\u90e8\u5206\uff0c\u5206\u522b\u5bf9\u5e94\u4e09\u4e2a\u529f\u80fd\uff1a \u8bfb\u53d6\u5206\u533a\u8868 \u6839\u636epatch\u5305\u8fdb\u884c\u5347\u7ea7 \u8df3\u8f6c\u5230Active APP\u5206\u533a\u5f00\u59cb\u6267\u884c \u63a5\u4e0b\u6765\u5c06\u5b8c\u6210 1.3 \u8282\u6240\u7ed9\u51fa\u7684OTA\u7ec4\u4ef6\u5f00\u53d1\u8c03\u8bd5\u63a8\u8350\u6d41\u7a0b\u524d\u4e09\u6b65\u3002 3.1. \u6d4b\u8bd5bootloader\u662f\u5426\u53ef\u4ee5\u8bfb\u53d6\u5206\u533a\u8868 \u9996\u5148\u9700\u8981\u6307\u5b9a\u5206\u533a\u8868\u5730\u5740\uff1a uint32_t partition_addr = 0x0803f800; \u5b8c\u5584\u521d\u59cb\u5316\u73af\u5883\u53d8\u91cf\u7684\u4ee3\u7801\uff0c\u5728\u521d\u59cb\u5316\u4e4b\u540e\u624b\u52a8\u6dfb\u52a0\u6253\u5370\u5206\u533a\u8868\u7684\u4ee3\u7801\uff0c\u6700\u540e\u7684while(1)\u7528\u4e8e\u505c\u6b62\u7a0b\u5e8f\uff0c\u9632\u6b62\u8fdb\u884c\u540e\u9762\u7684\u529f\u80fd\uff1a if ((ret = ota_env_init(OTA_UPDATE_IN_POSITION, partition_addr, &stm32l4_norflash_onchip_drv_ota, &stm32l4_norflash_onchip_prop_ota)) != OTA_ERR_NONE) { printf(\"env init failed!OTA errcode = %d\\n\", ret); return -1; } else { printf(\"env init successfully!\\r\\n\"); printf(\"+-------------------------+\\r\\n\"); printf(\"|Active APP | 0x%08x |\\r\\n\", ota_partition_start(OTA_PARTITION_ACTIVE_APP)); printf(\"| OTA | 0x%08x |\\r\\n\", ota_partition_start(OTA_PARTITION_OTA)); printf(\"| KV | 0x%08x |\\r\\n\", ota_partition_start(OTA_PARTITION_KV)); printf(\"| Version | %d.%d |\\r\\n\", ota_partition_init_version_get().major, ota_partition_init_version_get().minor); printf(\"+-------------------------+\"); } while(1); \u4fee\u6539\u7a0b\u5e8f\u7f16\u8bd1\u5730\u5740\u548c\u5927\u5c0f\uff0c\u4e0eBootloader\u5206\u533a\u7684\u5212\u5206\u76f8\u5bf9\u5e94\uff1a \u7f16\u8bd1\u7a0b\u5e8f\u3002 \u7f16\u8bd1\u6210\u529f\u4e4b\u540e\u4fee\u6539\u4e0b\u8f7d\u8bbe\u7f6e\uff0c\u9009\u62e9\u6247\u533a\u64e6\u9664\u65b9\u5f0f\u3001\u8bbe\u7f6e\u7a0b\u5e8f\u70e7\u5f55\u8d77\u59cb\u5730\u5740\u3001\u8bbe\u7f6e\u7a0b\u5e8f\u70e7\u5f55\u5927\u5c0f\uff0c\u540c\u6837\u4e0ebootloader\u5206\u533a\u7684\u5212\u5206\u76f8\u5bf9\u5e94\uff1a \u4e0b\u8f7d\u7a0b\u5e8f\uff0c\u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u89c2\u5bdf\u8f93\u51fa\uff1a 3.2. \u6d4b\u8bd5bootloader\u662f\u5426\u53ef\u4ee5\u8df3\u8f6c\u5230Active APP\u5206\u533a \u6253\u5f00\u548cbootloader\u5728\u4e00\u4e2a\u76ee\u5f55\u4e0b\u7684app\u5de5\u7a0b\uff1a ota_application_download_through_http \u3002 \u76ee\u524d\u6211\u4eec\u53ea\u662f\u6d4b\u8bd5bootloader\u662f\u5426\u53ef\u4ee5\u8df3\u8f6c\u8fc7\u6765\u6267\u884c\u6b64\u7a0b\u5e8f\uff0c\u6240\u4ee5\u5982\u56fe\u6240\u793a\u4fee\u6539\u4ee3\u7801\uff0c\u4e0d\u8981\u89e6\u53d1OTA\u56fa\u4ef6\u62c9\u53d6\u529f\u80fd\uff1a \u53e6\u5916\uff0c\u56e0\u4e3a\u6b64\u7a0b\u5e8f\u88ab\u70e7\u5f55\u5230 Active APP \u5206\u533a\uff0c\u662f\u4eceActive APP\u5206\u533a\u7684\u8d77\u59cb\u5730\u5740\u5f00\u59cb\u8fd0\u884c\u7684\uff0c\u6240\u4ee5\u9700\u8981\u4fee\u6539\u4e2d\u65ad\u5411\u91cf\u8868\u7684\u504f\u79fb\u5730\u5740\uff0c\u5982\u56fe\uff1a \u540c\u6837\u4fee\u6539\u7a0b\u5e8f\u7f16\u8bd1\u7684\u8d77\u59cb\u5730\u5740\u548c\u5927\u5c0f\uff0c\u4e0e\u89c4\u5212\u7684 Active APP\u5206\u533a\u4fe1\u606f\u76f8\u5bf9\u5e94\uff1a \u7f16\u8bd1\u7a0b\u5e8f\u3002 \u7f16\u8bd1\u6210\u529f\u4e4b\u540e\u4fee\u6539\u4e0b\u8f7d\u8bbe\u7f6e\uff0c\u70e7\u5f55\u5230Actice APP\u5206\u533a\u4e2d\uff1a \u6700\u540e\u518d\u4fee\u6539bootloader\u7a0b\u5e8f\uff0c\u5c4f\u853dwhile(1)\uff0c\u5c4f\u853dOTA\u56fa\u4ef6\u5347\u7ea7\u529f\u80fd\uff0c\u5f00\u542f\u8df3\u8f6c\u529f\u80fd\uff1a \u518d\u6b21\u7f16\u8bd1\uff0c\u4e0b\u8f7dbootloader\uff0c\u590d\u4f4d\u5f00\u53d1\u677f\uff0c\u67e5\u770b\u4e32\u53e3\u52a9\u624b\u4e2d\u7684\u8f93\u51fa\uff0c\u53ef\u4ee5\u770b\u5230bootloader\u6210\u529f\u8df3\u8f6c\u5230Actice APP\u5f00\u59cb\u6267\u884c\uff1a 3.3. \u5dee\u5206patch\u5305\u751f\u6210\u65b9\u6cd5 3.3.1. \u51c6\u5907\u8001\u56fa\u4ef6\u548c\u65b0\u56fa\u4ef6 \u5b98\u65b9\u793a\u4f8b\u5de5\u7a0b\u5df2\u7ecf\u5728MDK\u4e2d\u914d\u7f6e\u7f16\u8bd1\u540e\u751f\u6210.bin\u56fa\u4ef6\uff0c\u5982\u56fe\uff1a \u7f16\u8bd1\u4e4b\u540e\u4f1a\u5728\u5de5\u7a0b\u76ee\u5f55\u4e0b\u751f\u6210TencentOS_tiny.bin\u6587\u4ef6\uff0c\u62f7\u8d1d\u4e00\u4efd\u51fa\u6765\uff0c\u91cd\u547d\u540d\u4e3a:TencentOS_tiny_0_1.bin\uff0c\u8868\u793a\u8fd9\u662f0.1\u7248\u672c\u7684\u56fa\u4ef6\u3002 \u4fee\u6539app\u5de5\u7a0b\uff0c\u5c06\u6253\u5370\u4fe1\u606f\u4e2d\u76840.1\u6539\u4e3a0.2\uff0c\u4ee5\u9a8c\u8bc1\u662f\u5426\u5347\u7ea7\u6210\u529f\uff1a \u91cd\u65b0\u7f16\u8bd1\uff0c\u751f\u6210\u65b0\u56fa\u4ef6TencentOS_tiny.bin\uff0c\u540c\u6837\u62f7\u8d1d\u4e00\u4efd\uff0c\u91cd\u547d\u540d\u4e3a\uff1aTencentOS_tiny_0_2\uff0c\u8868\u793a\u8fd9\u662f0.2\u7248\u672c\u7684\u56fa\u4ef6\u3002 3.3.2. \u5dee\u5206\u5347\u7ea7\u5305\u751f\u6210\u5de5\u5177\u7684\u4f7f\u7528 \u7f16\u8bd1\u6b64\u5de5\u5177\u540c\u6837\u9700\u8981gcc\u73af\u5883\u3002 \u8fdb\u5165 \\components\\ota\\tools\\diff \u76ee\u5f55\uff0c\u6267\u884cmake\u547d\u4ee4\u5f00\u59cb\u7f16\u8bd1\uff0c\u7f16\u8bd1\u4e4b\u540e\u8fdb\u5165\u5230\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 out\\target \u5373\u53ef\u770b\u5230\u5de5\u5177 diff.exe \uff1a cd out/target/ \u8be5\u5de5\u5177\u6709\u5982\u4e0b\u53c2\u6570\uff1a -h \uff1a\u6253\u5370\u5e2e\u52a9\u4fe1\u606f -v \uff1a\u6253\u5370\u66f4\u591a\u4fe1\u606f -s \uff1a<\u5f85\u5b9a...> -b <n> \uff1a\u6307\u5b9a\u6247\u533a\u5927\u5c0f\uff0c\u5355\u4f4d\uff1a\u5b57\u8282Byte -n <major>.<minor> \uff1a\u65b0\u7684\u56fa\u4ef6\u7248\u672c\u53f7 -o <major>.<minor> \uff1a\u65e7\u7684\u56fa\u4ef6\u7248\u672c\u53f7 \u5c063.3.1\u8282\u51c6\u5907\u7684\u4e24\u4e2a\u56fa\u4ef6\u62f7\u8d1d\u5230\u5f53\u524d\u5de5\u5177\u6240\u5728\u76ee\u5f55\u4e0b\u3002 \u6839\u636e\u524d\u9762\u51c6\u5907\u7684\u4e24\u4e2a\u65b0\u65e7\u56fa\u4ef6\uff0c\u5236\u4f5c\u5dee\u5206\u5347\u7ea7\u5305\u7684\u547d\u4ee4\u5982\u4e0b\uff1a ./diff.exe -v -b 2048 -n 0.2 -o 0.1 TencentOS_tiny_0_1.bin TencentOS_tiny_0_2.bin patch.bin \u8fd0\u884c\u4e4b\u540e\u5373\u53ef\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u770b\u5230\u751f\u6210\u7684\u5dee\u5206\u5347\u7ea7\u5305 patch.bin \u3002 3.4. \u6d4b\u8bd5bootloader\u662f\u5426\u53ef\u4ee5\u6839\u636epatch\u8fdb\u884c\u5347\u7ea7 \u4f7f\u7528STM32CubeProg\u76f4\u63a5\u5c06\u5dee\u5206\u5347\u7ea7\u5305patch.bin\u4e0b\u8f7d\u5230OTA\u5206\u533a\uff1a \u4e0b\u8f7d\u6210\u529f\u540e\uff0c\u56e0\u4e3abootloader\u901a\u8fc7\u68c0\u6d4bKV\u5206\u533a\u4e2d\u7684\u73af\u5883\u53d8\u91cfnew_version\u6765\u5224\u65ad\u662f\u5426\u6709\u65b0\u7684\u56fa\u4ef6\uff0c\u4f46\u662f\u73af\u5883\u53d8\u91cf\u5728app\u7a0b\u5e8f\u62c9\u53d6\u56fa\u4ef6\u6210\u529f\u4e4b\u540e\u624d\u4f1a\u8bbe\u7f6e\uff0c\u6240\u4ee5\u6211\u4eec\u624b\u52a8\u5728bootloader\u4e2d\u6765\u8bbe\u7f6e\u6b64\u73af\u5883\u53d8\u91cf\u3002 \u5728main.c\u4e2d\u5f15\u5165KV\u7684\u5934\u6587\u4ef6\uff1a #include \"tos_kv.h\" \u5728\u73af\u5883\u53d8\u91cf\u521d\u59cb\u5316\u4ee3\u7801\u4e4b\u540e\uff0c\u5347\u7ea7\u4ee3\u7801\u4e4b\u524d\u6dfb\u52a0\u5982\u4e0b\u7684\u4ee3\u7801\uff1a ota_img_vs_t new_version; new_version.major = 0; new_version.minor = 2; tos_kv_set(\"new_version\", &new_version, sizeof(ota_img_vs_t)); \u6dfb\u52a0\u4e4b\u540e\u7f16\u8bd1\uff0c\u4e0b\u8f7d\uff0c\u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u67e5\u770b\u8f93\u51fa\uff1a \u53ef\u4ee5\u770b\u5230bootloader\u6210\u529f\u6839\u636epatch\u5dee\u5206\u5305\u548c\u65e7\u7684\u56fa\u4ef6\uff0c\u8fd8\u539f\u51fa\u4e86\u65b0\u7684\u56fa\u4ef6\u5e76\u6210\u529f\u5347\u7ea7\u3002 4. \u4f7f\u7528HTTP\u65b9\u5f0f\u83b7\u53d6\u56fa\u4ef6\u5e76\u5347\u7ea7 TencentOS-tiny OTA\u7ec4\u4ef6\u652f\u6301\u4f7f\u7528 HTTP \u534f\u8bae\u62c9\u53d6\u5dee\u5206\u5347\u7ea7patch\u5305\uff0c\u5e76\u70e7\u5199\u5230OTA\u5206\u533a\u4e2d\u3002 4.1. \u51c6\u5907HTTP\u670d\u52a1\u5668 HTTP\u670d\u52a1\u5668\u7684\u9009\u62e9\u975e\u5e38\u591a\uff0c\u5e38\u7528\u9009\u62e9\u6709\uff1a \u5728Windows\u4e0a\u4f7f\u7528\u7c7b\u4f3cMyWebServer\u7684\u5c0f\u5de5\u5177\u5f00\u542fHTTP\u670d\u52a1 \u4f18\u70b9\uff1a\u7b80\u5355\u65b9\u4fbf\uff0c\u7528\u4e8e\u6d4b\u8bd5 \u7f3a\u70b9\uff1a\u65e0\u516c\u7f51ip\uff0c\u53ea\u80fd\u5728\u540c\u4e00\u4e2a\u5c40\u57df\u7f51\u5185\u88ab\u8bbf\u95ee \u5728\u4e91\u670d\u52a1\u5668\u4e0a\u5b89\u88c5\u7c7b\u4f3cNginx\u7684\u5de5\u5177\uff0c\u5f00\u542fHTTP\u8bbf\u95ee \u4f18\u70b9\uff1a\u6027\u80fd\u5f3a\u52b2\u3001\u6709\u516c\u7f51ip\u3001\u652f\u6301\u9ad8\u5e76\u53d1\uff08\u5927\u91cf\u8bbe\u5907\u540c\u65f6\u5f00\u673a\u62c9\u53d6\u56fa\u4ef6\uff09 \u7f3a\u70b9\uff1a\u5b89\u88c5\u8fc7\u7a0b\u8f83\u590d\u6742 \u9664\u4e86\u8fd9\u4e24\u79cd\u65b9\u5f0f\u5916\uff0c\u8fd8\u6709\u5f88\u591a\u7684\u65b9\u5f0f\u53ef\u4f9b\u9009\u62e9\uff0c\u53ea\u9700\u8981\u5f00\u542fHTTP\u670d\u52a1\u5373\u53ef\uff0c\u672c\u6587\u4e2d\u6211\u4f7f\u7528\u7b2c\u4e00\u79cd\u65b9\u5f0f\u3002 \u5f00\u542f\u4e4b\u540e\u5c06\u7b2c3\u6b65\u4e2d\u751f\u6210\u7684\u5dee\u5206\u5347\u7ea7\u56fa\u4ef6 patch.bin \u4e0a\u4f20/\u590d\u5236\u5230HTTP\u670d\u52a1\u76ee\u5f55\u4e2d\uff0c\u7136\u540e\u4f7f\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee http://<\u5df2\u7ecf\u5f00\u542fHTTP\u670d\u52a1PC\u7684ip>:<HTTP\u670d\u52a1\u7aef\u53e3>/patch.bin \uff0c\u6d4b\u8bd5\u6b63\u5e38\u83b7\u53d6\u4e4b\u540e\u65b9\u53ef\u8fdb\u884c\u540e\u7eed\u64cd\u4f5c\u3002 \u5f00\u542fHTTP\u670d\u52a1\u4e4b\u540e\u8bb0\u5f97\u5173\u95ed\u5404\u79cd\u9632\u706b\u5899\uff0c\u6bd4\u5982Win10\u7f51\u7edc\u9632\u706b\u5899\uff0c\u4e91\u670d\u52a1\u5668\u5b89\u5168\u7ec4\u7b49\u3002 4.2. HTTP\u83b7\u53d6\u56fa\u4ef6\u5e76\u5347\u7ea7 (1)\u4f7f\u7528STM32CubeMX Prog\u5168\u7247\u64e6\u9664\uff0c\u70e7\u5199\u5206\u533a\u8868\u52300x0803f800; (2)\u4fee\u6539bootloader\u7a0b\u5e8f\uff0c\u53bb\u9664\u624b\u52a8\u8bbe\u7f6enew_version\u73af\u5883\u53d8\u91cf\u4ee3\u7801\uff0c\u7f16\u8bd1\uff0c\u4e0b\u8f7d\uff0c \u4e0d\u8981\u590d\u4f4d : (3)\u4fee\u6539Actice APP\u5de5\u7a0b( ota_application_download_through_http )\uff0c\u5f00\u542fHTTP\u56fa\u4ef6\u62c9\u53d6\u548c\u5347\u7ea7\u529f\u80fd: \u4fee\u6539\u4e4b\u540e\u7f16\u8bd1\uff0c\u4e0b\u8f7d\u3002 \u7279\u522b\u6ce8\u610f\uff0c \u6b64\u65f60.1\u7248\u672c\u7684\u7a0b\u5e8f\u5df2\u7ecf\u88ab\u6211\u4eec\u4fee\u6539\uff0c\u6240\u4ee5\u4e4b\u524d\u751f\u6210\u7684patch\u5305\u65e0\u6cd5\u5b8c\u6210\u5347\u7ea7 \uff0c\u91cd\u65b0\u57280.1\u7248\u672c\u7684\u57fa\u7840\u4e0a\u4fee\u6539\u59040.2\u7248\u672c\u7684\u7a0b\u5e8f\uff0c\u5e76\u5236\u4f5cpatch\u5305\u3002 \u91cd\u590d\u4e00\u904d\u4e4b\u524d\u7684\u5236\u4f5c\u6d41\u7a0b\u5373\u53ef\uff1a \u2460 \u5c06\u5f53\u524d\u56fa\u4ef6\u62f7\u8d1d\u51fa\u6765\uff0c\u91cd\u547d\u540d\u4e3a TencentOS_tiny_0_1.bin ; \u2461 \u4fee\u6539\u6253\u5370\u63d0\u793a\uff0c\u8868\u793a\u8fd9\u662f0.2\u7248\u672c\u7684\u7a0b\u5e8f\uff1a printf(\"do sth(v0.2)...\\n\"); \u2462 \u5c06\u65b0\u56fa\u4ef6\u62f7\u8d1d\u51fa\u6765\u547d\u540d\u4e3a TencentOS_tiny_0_2.bin ; \u2463 \u4f7f\u7528diff\u547d\u4ee4\u884c\u5de5\u5177\u6216\u8005\u53ef\u89c6\u5316\u5de5\u5177\u5236\u4f5c\u5dee\u5206\u5347\u7ea7\u5305patch.bin\uff1b \u2464 \u5c06\u5236\u4f5c\u51fa\u7684\u5dee\u5206\u5347\u7ea7\u5305\u62f7\u8d1d/\u4e0a\u4f20\u5230HTTP\u670d\u52a1\u5668\u76ee\u5f55\uff1b \u6b64\u65f6\uff0c\u4e00\u5207\u51c6\u5907\u5c31\u7eea\uff0c\u590d\u4f4d\u8bbe\u5907\uff0c\u5373\u53ef\u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u770b\u5230OTA\u7684\u5347\u7ea7\u72b6\u51b5\uff1a","title":"21.OTA_Quick_Start_based_EVB_MX_Plus"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#1-tencentos-tiny-ota","text":"","title":"1. TencentOS-tiny OTA"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#11-otaiap","text":"IAP\u5168\u79f0 In Application Programming\uff0c\u4ec0\u4e48\u662f\u5728\u5e94\u7528\u7f16\u7a0b\u5462\uff1f \u6b63\u5e38\u5f00\u53d1\u6d41\u7a0b\u5982\u4e0b\uff1a \u4f7f\u7528Keil MDK\u5de5\u5177\u7f16\u5199\u5e94\u7528\u7a0b\u5e8f\uff1b \u7f16\u8bd1\u51fa.axf\u53ef\u6267\u884c\u7a0b\u5e8f\u6216\u8005.bin\u6587\u4ef6\uff0c\u6216\u8005.hex\u6587\u4ef6\uff1b \u4f7f\u7528Keil MDK\u5de5\u5177\u76f4\u63a5\u70e7\u5f55.axf\u6587\u4ef6\u5230STM32 Flash\u4e2d\uff0c\u6216\u8005\u4f7f\u7528\u7c7b\u4f3cSTM32CubeProg\u4e4b\u7c7b\u7684\u8f6f\u4ef6\u70e7\u5f55.bin\u6587\u4ef6\u5230STM32 Flash\u4e2d\uff1b \u590d\u4f4d\uff0c\u5355\u7247\u673a\u4eceFlash\u8d77\u59cb\u5730\u5740\u5904\u8bfb\u53d6\u7a0b\u5e8f\u5e76\u6267\u884c\uff1b \u5f53\u4ea7\u54c1\u5f00\u53d1\u5b8c\u6210\u7528\u4e8e\u751f\u4ea7\u540e\uff0c\u901a\u5e38\u4e0d\u4f1a\u518d\u5f15\u51fa\u4e0b\u8f7d\u5668\u63a5\u53e3\u7ed9\u7528\u6237\uff0c\u6240\u4ee5\u4e5f\u5c31\u65e0\u6cd5\u8fde\u63a5\u5404\u79cd\u5404\u6837\u7684\u4e0b\u8f7d\u5668\uff0c\u66f4\u522b\u8bf4\u7528Keil\u6216\u8005STM32CubeProg\u8fd9\u4e9b\u5de5\u5177\u4e0b\u8f7d\u7a0b\u5e8f\uff0c\u5982\u679c\u53d1\u73b0\u5e94\u7528\u7a0b\u5e8f\u6709\u6f0f\u6d1e\uff0c\u6216\u8005\u8981\u4fee\u6539\u90e8\u5206\u529f\u80fd\uff0c\u90fd\u5df2\u7ecf\u65e0\u6cd5\u5b8c\u6210\u3002","title":"1.1. OTA\u4e0eIAP"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#111-iap","text":"IAP\u5de7\u5999\u7684\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u5373\u5728\u5e94\u7528\u7a0b\u5e8f\u6b63\u5e38\u5de5\u4f5c\u7684\u65f6\u5019\uff0c\u8fd8\u53ef\u4ee5\u63a5\u6536\u65b0\u7684\u56fa\u4ef6\u5e76\u70e7\u5f55\u5230Flash\u4e2d\u3002 \u5e94\u7528\u7a0b\u5e8f\u5982\u4f55\u63a5\u6536\u65b0\u7684\u56fa\u4ef6\uff1f \u4e00\u822c\u4ea7\u54c1\u8bbe\u8ba1\u65f6\u90fd\u4f1a\u7559\u4e00\u4e2a\u7528\u4e8e\u6253\u5370\u65e5\u5fd7\u4fe1\u606f\u7684\u4e32\u53e3\uff0c\u53ef\u4ee5\u76f4\u63a5\u5229\u7528\u6b64\u4e32\u53e3\u6765\u63a5\u6536PC\u53d1\u9001\u5230\u65b0\u56fa\u4ef6\uff0c\u4f20\u8f93\u534f\u8bae\u5927\u591a\u90fd\u91c7\u7528Y-Modem\u534f\u8bae\u3002 \u63a5\u6536\u4e4b\u540e\u7684\u65b0\u56fa\u4ef6\u5b58\u653e\u5230\u54ea\u91cc\uff1f \u56fa\u4ef6\u5927\u5c0f\u4e00\u822c\u90fd\u6709\u51e0\u5341KB\u6216\u8005\u4e0a\u767eKB\uff0c\u5e94\u7528\u7a0b\u5e8f\u63a5\u6536\u5230\u65b0\u7684\u56fa\u4ef6\u4e4b\u540e\uff0c\u5982\u679c\u662f\u4ee5\u6570\u7ec4\u7684\u5f62\u5f0f\u6682\u5b58\u5728RAM\u7a7a\u95f4\u4e2d\uff0c\u4e0d\u4ec5\u4f1a\u6d6a\u8d39RAM\u7a7a\u95f4\uff0c\u800c\u4e14\u5bb9\u6613\u53d1\u751f\u56fa\u4ef6\u6570\u636e\u4e22\u5931\uff0c\u6240\u4ee5\u76f4\u63a5\u5b58\u50a8\u5230\u7a7a\u95f2\u7684Flash\u7a7a\u95f4\u4e2d\u662f\u6700\u597d\u7684\u65b9\u5f0f\u3002 eg. \u5b98\u65b9\u5f00\u53d1\u677f\u4f7f\u7528\u7684\u82af\u7247\u662fSTM32L431RCT6\uff0cFlash\u7a7a\u95f4\u6709256KB\uff0c\u5982\u679c\u5e94\u7528\u7a0b\u5e8f\u7684\u5927\u5c0f\u53ea\u6709100KB\uff0c\u90a3\u4e48\u63a5\u6536\u8fdb\u6765\u7684\u65b0\u56fa\u4ef6\u5c31\u53ef\u4ee5\u5b58\u653e\u5728\u5269\u4f59\u7684156KB\u7a7a\u95f4\u4e2d\u3002 \u540c\u65f6\u4f1a\u4eba\u4e3a\u7684\u5bf9Flash\u5212\u5206\u5206\u533a\uff0c\u4e5f\u5c31\u662f\u5bf9\u67d0\u4e00\u6bb5\u5730\u5740\u7a7a\u95f4\u8d77\u4e2a\u540d\u5b57\uff0c\u5982\u4e0b\u56fe\uff1a \u5982\u4f55\u5c06\u8001\u56fa\u4ef6\u66ff\u6362\u4e3a\u4e3a\u65b0\u56fa\u4ef6\uff1f \u4e0a\u7535\u4e4b\u540eCPU\u4f1a\u4eceFlash\u7684\u8d77\u59cb\u5730\u5740\u5904\u8bfb\u53d6\u6570\u636e\u5f00\u59cb\u6267\u884c\uff0c\u8fd9\u70b9\u65e0\u6cd5\u6539\u53d8\uff0c\u6b63\u5728\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\u5982\u679c\u8fdb\u884c\u81ea\u5df1\u64e6\u9664\u81ea\u5df1\u7684\u64cd\u4f5c\uff0c\u8bbe\u5907\u76f4\u63a5\u53d8\u7816\u3002 bootloader\u53ef\u4ee5\u5b8c\u7f8e\u7684\u89e3\u51b3\u8fd9\u4e00\u95ee\u9898\uff0c\u5373\u5199\u4e00\u5c0f\u6bb5\u5e94\u7528\u7a0b\u5e8f\uff0c\u653e\u5728Flash\u7684\u8d77\u59cb\u4f4d\u7f6e\u5904\uff0c\u4f7f\u5f97\u6bcf\u6b21\u4e0a\u7535\u4e4b\u540e\u6700\u5148\u8fd0\u884cbootloader\uff0c\u5b8c\u6210\u4e24\u4e2a\u529f\u80fd\uff1a \u68c0\u67e5\u5347\u7ea7\u6807\u5fd7\uff0c\u662f\u5426\u6709\u65b0\u7684\u56fa\u4ef6\u88ab\u4e0b\u8f7d\u5230IAP\u5206\u533a\u4e2d\uff1b \u5982\u679c\u65e0\u5347\u7ea7\u6807\u5fd7\uff0c\u5219\u8df3\u8f6c\u5230ActiveAPP\u5206\u533a\uff0c\u5f00\u59cb\u6267\u884c\u5e94\u7528\u7a0b\u5e8f\uff1b \u5982\u679c\u6709\u5347\u7ea7\u6807\u5fd7\uff0c\u5219\u5148\u5c06IAP\u5206\u533a\u4e2d\u7684\u56fa\u4ef6\u62f7\u8d1d\u5230ActiveAPP\u5206\u533a\u4e2d\uff0c\u7136\u540e\u8df3\u8f6c\u5230ActiveAPP\u5206\u533a\uff0c\u5f00\u59cb\u6267\u884c\u65b0\u7684\u5e94\u7528\u7a0b\u5e8f\uff1b \u52a0\u5165bootloader\u4e4b\u540e\uff0c\u6574\u4e2aFlash\u7684\u5206\u533a\u60c5\u51b5\u5982\u4e0b\uff1a","title":"1.1.1. IAP\u8bbe\u8ba1\u601d\u60f3"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#112-ota","text":"\u5728IAP\u7684\u8fd9\u79cd\u8bbe\u8ba1\u601d\u60f3\u4e4b\u4e0a\uff0c\u56e0\u4e3a\u5f53\u524d\u7684\u7269\u8054\u7f51\u8bbe\u5907\u90fd\u5df2\u7ecf\u5177\u5907\u57fa\u672c\u7684\u7f51\u7edc\u901a\u4fe1\u529f\u80fd\uff0c\u6240\u4ee5\u65e0\u9700\u901a\u8fc7\u4e32\u53e3\u4f20\u8f93\u65b0\u7684\u56fa\u4ef6\uff0c\u76f4\u63a5\u901a\u8fc7\u7f51\u7edc\u4f20\u8f93\u65b0\u7684\u56fa\u4ef6\u5373\u53ef\uff0c\u79f0\u4e4b\u4e3aOTA IAP(Over The Air In Application Programming)\uff0c\u4e5f\u5c31\u662f\u5e73\u5e38\u6240\u8bf4\u7684\u7a7a\u4e2d\u5347\u7ea7\uff0c\u7b80\u79f0OTA\u3002","title":"1.1.2. OTA\u8bbe\u8ba1\u601d\u60f3"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#12-ota","text":"TencentOS-tiny\u4e2d\u63d0\u4f9b\u7684OTA\u7ec4\u4ef6\u5b8c\u5168\u5f00\u6e90\u514d\u8d39\uff0c\u76f8\u8f83\u4e8e\u5176\u4ed6\u7684OTA\u529f\u80fd\uff0cTencentOS-tiny OTA\u7ec4\u4ef6\u63d0\u4f9b\u66f4\u5c0f\u7684\u5dee\u5206\u5347\u7ea7\u5305\uff0c\u8017\u7528\u66f4\u5c11\u7684\u4f20\u8f93\u6d41\u91cf\uff0c\u5360\u7528\u66f4\u5c0f\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u63d0\u4f9b\u66f4\u53ef\u9760\u7684\u5347\u7ea7\u670d\u52a1\u3002 TencentOS-tiny OTA\u7ec4\u4ef6\u6709\u4ee5\u4e0b\u7684\u7279\u6027\uff1a \u4f20\u8f93\u5dee\u5206\u5347\u7ea7\u5305\uff0c\u800c\u4e0d\u662f\u6574\u4e2a\u56fa\u4ef6 \u7075\u6d3b\u7684\u5206\u533a\u8868\u529f\u80fd \u652f\u6301\u539f\u5730\u5347\u7ea7 \u652f\u6301\u4e52\u4e53\u5347\u7ea7\uff0c\u53ef\u4ee5\u5728\u5347\u7ea7\u4e2d\u65ad\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u7248\u672c\u56de\u6eda \u652f\u6301\u901a\u8fc7HTTP\u4ece\u81ea\u5efa\u670d\u52a1\u5668\u62c9\u53d6\u56fa\u4ef6 \u652f\u6301\u4ece\u817e\u8baf\u4e91\u5e73\u53f0\u8fdb\u884c\u7edf\u4e00\u7684\u56fa\u4ef6\u62c9\u53d6\u548c\u7ba1\u7406","title":"1.2. OTA\u7ec4\u4ef6\u6982\u8ff0\u3001\u7279\u6027\u53ca\u4f18\u52bf"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#13-ota","text":"OTA\u7684\u6574\u4e2a\u6d41\u7a0b\u8c03\u8bd5\u8f83\u590d\u6742\uff0c\u5982\u679c\u5206\u6b65\u6765\u505a\u4f1a\u6bd4\u8f83\u5bb9\u6613\uff1a (1)\u8c03\u8bd5bootloader\u662f\u5426\u53ef\u4ee5\u6b63\u5e38\u8bfb\u53d6\u5206\u533a\u8868\u4fe1\u606f\uff1b (2)\u8c03\u8bd5bootloader\u662f\u5426\u53ef\u4ee5\u6b63\u5e38\u8df3\u8f6c\u5230Active APP; (3)\u8c03\u8bd5bootloader\u662f\u5426\u76f4\u63a5\u53ef\u4ee5\u6839\u636epatch\u5305\u8fdb\u884c\u5347\u7ea7; (4)\u8c03\u8bd5Active APP\u662f\u5426\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u62c9\u53d6patch\u5347\u7ea7\u5305\u5e76\u4e0b\u8f7d\u5230 OTA \u5206\u533a; (5)\u7efc\u5408\u8c03\u8bd5\u3002","title":"1.3. OTA\u7ec4\u4ef6\u5f00\u53d1\u8c03\u8bd5\u63a8\u8350\u6d41\u7a0b"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#2","text":"","title":"2. \u5206\u533a\u89c4\u5212\u53ca\u5206\u533a\u8868\u7684\u751f\u6210\u3001\u70e7\u5f55"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#21","text":"TencentOS-tiny\u652f\u6301\u4e24\u79cd\u5347\u7ea7\u65b9\u5f0f\uff0c\u4e24\u79cd\u5347\u7ea7\u65b9\u5f0f\u5bf9\u5e94\u6709\u4e0d\u540c\u7684\u5206\u533a\u8868 \u539f\u5730\u5347\u7ea7\u65b9\u5f0f\u4e2d\uff0cbootloader\u76f4\u63a5\u6839\u636e\u65e7\u56fa\u4ef6+patch\u5347\u7ea7\u5305\u751f\u6210\u65b0\u7684\u56fa\u4ef6\uff0c\u4e00\u65e6\u5f00\u59cb\u5347\u7ea7\uff0c\u65e0\u8bba\u5347\u7ea7\u6210\u529f\u4e0e\u5426\u90fd\u65e0\u6cd5\u56de\u6eda\u5230\u4e0a\u4e00\u4e2a\u7248\u672c\uff0c\u4e3b\u8981\u6709\u4e94\u4e2a\u5206\u533a\uff1a Bootloader\u5206\u533a Active APP\u5206\u533a\uff1a\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684\u56fa\u4ef6\u5b58\u653e\u5206\u533a\uff1b OTA\u5206\u533a\uff1a\u65b0\u56fa\u4ef6\u5b58\u653e\u5206\u533a\uff1b KV\u5206\u533a\uff1a\u8bb0\u5f55\u7cfb\u7edf\u5347\u7ea7\u4e2d\u7684\u4e00\u4e9b\u73af\u5883\u53d8\u91cf\uff1b \u5206\u533a\u8868\uff1a\u5b58\u653e\u5206\u533a\u8868\uff08\u56fa\u5b9a\u5927\u5c0f32B\uff0c\u4e00\u822c\u653e\u5728Flash\u7684\u6700\u540e\u4e00\u4e2a\u6247\u533a\u4e2d\uff09 \u4e52\u4e53\u5347\u7ea7\u65b9\u5f0f\u4e2d\uff0cbootloader\u5728\u5347\u7ea7\u4e4b\u524d\u4f1a\u5c06\u539f\u6765\u7684\u56fa\u4ef6\u62f7\u8d1d\u4e00\u4efd\uff0c\u4e00\u65e6\u5f00\u59cb\u5347\u7ea7\uff0c\u65e0\u8bba\u65b0\u56fa\u4ef6\u5347\u7ea7\u6210\u529f\u4e0e\u5426\uff0c\u90fd\u53ef\u4ee5\u56de\u6eda\u5230\u4e0a\u4e00\u4e2a\u7248\u672c\uff0c\u4e3b\u8981\u6709\u516d\u4e2a\u5206\u533a\uff1a Bootloader\u5206\u533a Active APP\u5206\u533a\uff1a\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684\u56fa\u4ef6\u5b58\u653e\u5206\u533a\uff1b Backup\u5206\u533a \uff1a\u5907\u4efd\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684\u56fa\u4ef6\uff1b OTA\u5206\u533a\uff1a\u65b0\u56fa\u4ef6\u5b58\u653e\u5206\u533a\uff1b KV\u5206\u533a\uff1a\u8bb0\u5f55\u7cfb\u7edf\u5347\u7ea7\u4e2d\u7684\u4e00\u4e9b\u73af\u5883\u53d8\u91cf\uff1b \u5206\u533a\u8868\uff1a\u5b58\u653e\u5206\u533a\u8868\uff08\u56fa\u5b9a\u5927\u5c0f32B\uff0c\u4e00\u822c\u653e\u5728Flash\u7684\u6700\u540e\u4e00\u4e2a\u6247\u533a\u4e2d\uff09 \u5728\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c\u4e24\u79cd\u65b9\u5f0f\u7684\u9009\u62e9\u8981\u6839\u636e\u8bbe\u5907\u9700\u6c42\uff0c\u8bbe\u5907Flash\u7a7a\u95f4\u5927\u5c0f\uff0c\u8bbe\u5907Flash\u6247\u533a\u5927\u5c0f\u7efc\u5408\u8003\u8651\u3002 \u672c\u6587\u63a5\u4e0b\u6765\u5982\u65e0\u7279\u6b8a\u8bf4\u660e\uff0c\u90fd\u662f\u4ee5\u7b2c\u4e00\u79cd\u65b9\u5f0f\uff08\u539f\u5730\u5347\u7ea7\uff09\u4e3a\u4f8b\uff0c\u5b98\u65b9\u677f\u7684Flash\u5927\u5c0f\u4e3a256KB\uff0c\u53ef\u4ee5\u5982\u4e0b\u5206\u533a\uff1a","title":"2.1. \u5206\u533a\u89c4\u5212"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#22","text":"TencentOS-tiny \u6e90\u7801\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e2a\u751f\u6210\u5206\u533a\u8868\u7684\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u9700\u8981\u5148\u4f7f\u7528gcc\u7f16\u8bd1\uff0c\u6ca1\u6709gcc\u73af\u5883\u53ef\u4ee5\u5b89\u88c5MinGW\u3002","title":"2.2. \u5206\u533a\u8868\u5de5\u5177\u7684\u4f7f\u7528\u65b9\u6cd5"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#221","text":"\u8fdb\u5165 \\components\\ota\\tools\\partition_table \u76ee\u5f55\uff0c\u6267\u884cmake\u547d\u4ee4\u5f00\u59cb\u7f16\u8bd1\uff0c\u7f16\u8bd1\u4e4b\u540e\u8fdb\u5165\u5230\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 out\\target \u5373\u53ef\u770b\u5230\u5de5\u5177 ptbl.exe \uff1a cd out/target/ \u8be5\u5de5\u5177\u6709\u5982\u4e0b\u53c2\u6570\uff1a -h \uff1a\u6253\u5370\u5e2e\u52a9\u4fe1\u606f -p <ip/pp> \uff1a\u9009\u62e9\u5347\u7ea7\u65b9\u5f0f,ip\u6216\u8005pp -a <start,end> \uff1aActive APP\u5206\u533a\u7684\u8d77\u59cb\u548c\u7ed3\u675f\u5730\u5740 [-b <start,end>] \uff1aBackup \u5206\u533a\u7684\u8d77\u59cb\u548c\u7ed3\u675f\u5730\u5740\uff0c\u9009\u4e86pp\u65b9\u5f0f\u624d\u9700\u8981 -o <start,end> \uff1aOTA\u5206\u533a\u7684\u8d77\u59cb\u548c\u7ed3\u675f\u5730\u5740 -k <start,end> \uff1aKV\u5206\u533a\u7684\u8d77\u59cb\u548c\u7ed3\u675f\u5730\u5740 -v <major>.<minor> \uff1a\u521d\u8bc6\u56fa\u4ef6\u7248\u672c\u53f7 \u4e3a\u5b98\u65b9\u677f\u751f\u6210\u5206\u533a\u8868\u6587\u4ef6\u7684\u547d\u4ee4\u5982\u4e0b\uff1a ./ptbl.exe -p ip -a 0x08007800,0x0802D000 -o 0x0802D000,0x08039800 -k 0x08039800,0x0803F800 -v 0.1 ptbl.bin \u8fd0\u884c\u4e4b\u540e\u5373\u53ef\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u770b\u5230\u751f\u6210\u7684\u5206\u533a\u8868\u6587\u4ef6 ptbl.bin \u3002","title":"2.2.1. \u7f16\u8bd1"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#23","text":"\u751f\u6210\u7684\u5206\u533a\u8868\u6587\u4ef6 ptbl.bin \u53ef\u4ee5\u901a\u8fc7STM32CubeProg\u76f4\u63a5\u70e7\u5f55\u5230Flash\u4e2d\uff0c\u6309\u7167\u4e4b\u524d\u89c4\u5212\u7684\u5206\u533a\uff0c\u70e7\u5f55\u4f4d\u7f6e\u4e3a 0x0803F800 \uff0c\u70e7\u5f55\u65b9\u6cd5\u5982\u4e0b\uff1a (1)\u4f7f\u7528\u4e0b\u8f7d\u5668\u8fde\u63a5\u5f00\u53d1\u677f\u5230PC\uff0c\u6253\u5f00STM32CubeProg\u5de5\u5177\uff0c\u70b9\u51fbConnect\u8fde\u63a5\u5230\u5f00\u53d1\u677f\uff1a (2)\u5982\u679c\u662f \u7b2c\u4e00\u6b21\u4f7f\u7528OTA \uff0c\u70b9\u51fb\u5de6\u4fa7\u7684\u70e7\u5f55\u6309\u94ae\uff0c\u70b9\u51fb\u5168\u7247\u64e6\u9664\uff1a \u7b2c\u4e00\u6b21\u4f7f\u7528\u7684\u65f6\u5019\uff0cKV\u5206\u533a\u4e2d\u7684\u6570\u636e\u4e0d\u786e\u5b9a\uff0c\u53ef\u9760\u8d77\u89c1\u76f4\u63a5\u9009\u62e9\u5168\u7247\u64e6\u9664\u3002 (3)\u70b9\u51fb\u5de6\u4fa7\u7684\u70e7\u5f55\u6309\u94ae\uff0c\u9009\u62e9\u521a\u521a\u751f\u6210\u7684 ptbl.bin \uff0c\u4e0b\u8f7d\u5730\u5740\u586b\u5199 0x0803F800\uff0c\u70b9\u51fb\u70e7\u5f55\uff1a \u51fa\u73b0\u70e7\u5f55\u6210\u529f\u5f39\u7a97\u5373\u53ef\u3002","title":"2.3. \u5206\u533a\u8868\u70e7\u5f55\u65b9\u6cd5"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#3-bootloader","text":"\u8fdb\u5165 board\\TencentOS_tiny_EVB_MX_Plus\\KEIL\\ota \u76ee\u5f55\uff0c\u6253\u5f00\u5b98\u65b9\u63d0\u4f9b\u7684bootloader\u793a\u4f8b\u5de5\u7a0b\uff1a ota_bootloader_recovery \u3002 bootloader\u5176\u5b9e\u662f\u4e00\u4e2a\u88f8\u673a\u7a0b\u5e8f\uff0c\u5728 main \u51fd\u6570\u4e2d\u4e3b\u8981\u6709\u4e09\u90e8\u5206\uff0c\u5206\u522b\u5bf9\u5e94\u4e09\u4e2a\u529f\u80fd\uff1a \u8bfb\u53d6\u5206\u533a\u8868 \u6839\u636epatch\u5305\u8fdb\u884c\u5347\u7ea7 \u8df3\u8f6c\u5230Active APP\u5206\u533a\u5f00\u59cb\u6267\u884c \u63a5\u4e0b\u6765\u5c06\u5b8c\u6210 1.3 \u8282\u6240\u7ed9\u51fa\u7684OTA\u7ec4\u4ef6\u5f00\u53d1\u8c03\u8bd5\u63a8\u8350\u6d41\u7a0b\u524d\u4e09\u6b65\u3002","title":"3. \u6d4b\u8bd5Bootloader\u7a0b\u5e8f"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#31-bootloader","text":"\u9996\u5148\u9700\u8981\u6307\u5b9a\u5206\u533a\u8868\u5730\u5740\uff1a uint32_t partition_addr = 0x0803f800; \u5b8c\u5584\u521d\u59cb\u5316\u73af\u5883\u53d8\u91cf\u7684\u4ee3\u7801\uff0c\u5728\u521d\u59cb\u5316\u4e4b\u540e\u624b\u52a8\u6dfb\u52a0\u6253\u5370\u5206\u533a\u8868\u7684\u4ee3\u7801\uff0c\u6700\u540e\u7684while(1)\u7528\u4e8e\u505c\u6b62\u7a0b\u5e8f\uff0c\u9632\u6b62\u8fdb\u884c\u540e\u9762\u7684\u529f\u80fd\uff1a if ((ret = ota_env_init(OTA_UPDATE_IN_POSITION, partition_addr, &stm32l4_norflash_onchip_drv_ota, &stm32l4_norflash_onchip_prop_ota)) != OTA_ERR_NONE) { printf(\"env init failed!OTA errcode = %d\\n\", ret); return -1; } else { printf(\"env init successfully!\\r\\n\"); printf(\"+-------------------------+\\r\\n\"); printf(\"|Active APP | 0x%08x |\\r\\n\", ota_partition_start(OTA_PARTITION_ACTIVE_APP)); printf(\"| OTA | 0x%08x |\\r\\n\", ota_partition_start(OTA_PARTITION_OTA)); printf(\"| KV | 0x%08x |\\r\\n\", ota_partition_start(OTA_PARTITION_KV)); printf(\"| Version | %d.%d |\\r\\n\", ota_partition_init_version_get().major, ota_partition_init_version_get().minor); printf(\"+-------------------------+\"); } while(1); \u4fee\u6539\u7a0b\u5e8f\u7f16\u8bd1\u5730\u5740\u548c\u5927\u5c0f\uff0c\u4e0eBootloader\u5206\u533a\u7684\u5212\u5206\u76f8\u5bf9\u5e94\uff1a \u7f16\u8bd1\u7a0b\u5e8f\u3002 \u7f16\u8bd1\u6210\u529f\u4e4b\u540e\u4fee\u6539\u4e0b\u8f7d\u8bbe\u7f6e\uff0c\u9009\u62e9\u6247\u533a\u64e6\u9664\u65b9\u5f0f\u3001\u8bbe\u7f6e\u7a0b\u5e8f\u70e7\u5f55\u8d77\u59cb\u5730\u5740\u3001\u8bbe\u7f6e\u7a0b\u5e8f\u70e7\u5f55\u5927\u5c0f\uff0c\u540c\u6837\u4e0ebootloader\u5206\u533a\u7684\u5212\u5206\u76f8\u5bf9\u5e94\uff1a \u4e0b\u8f7d\u7a0b\u5e8f\uff0c\u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u89c2\u5bdf\u8f93\u51fa\uff1a","title":"3.1. \u6d4b\u8bd5bootloader\u662f\u5426\u53ef\u4ee5\u8bfb\u53d6\u5206\u533a\u8868"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#32-bootloaderactive-app","text":"\u6253\u5f00\u548cbootloader\u5728\u4e00\u4e2a\u76ee\u5f55\u4e0b\u7684app\u5de5\u7a0b\uff1a ota_application_download_through_http \u3002 \u76ee\u524d\u6211\u4eec\u53ea\u662f\u6d4b\u8bd5bootloader\u662f\u5426\u53ef\u4ee5\u8df3\u8f6c\u8fc7\u6765\u6267\u884c\u6b64\u7a0b\u5e8f\uff0c\u6240\u4ee5\u5982\u56fe\u6240\u793a\u4fee\u6539\u4ee3\u7801\uff0c\u4e0d\u8981\u89e6\u53d1OTA\u56fa\u4ef6\u62c9\u53d6\u529f\u80fd\uff1a \u53e6\u5916\uff0c\u56e0\u4e3a\u6b64\u7a0b\u5e8f\u88ab\u70e7\u5f55\u5230 Active APP \u5206\u533a\uff0c\u662f\u4eceActive APP\u5206\u533a\u7684\u8d77\u59cb\u5730\u5740\u5f00\u59cb\u8fd0\u884c\u7684\uff0c\u6240\u4ee5\u9700\u8981\u4fee\u6539\u4e2d\u65ad\u5411\u91cf\u8868\u7684\u504f\u79fb\u5730\u5740\uff0c\u5982\u56fe\uff1a \u540c\u6837\u4fee\u6539\u7a0b\u5e8f\u7f16\u8bd1\u7684\u8d77\u59cb\u5730\u5740\u548c\u5927\u5c0f\uff0c\u4e0e\u89c4\u5212\u7684 Active APP\u5206\u533a\u4fe1\u606f\u76f8\u5bf9\u5e94\uff1a \u7f16\u8bd1\u7a0b\u5e8f\u3002 \u7f16\u8bd1\u6210\u529f\u4e4b\u540e\u4fee\u6539\u4e0b\u8f7d\u8bbe\u7f6e\uff0c\u70e7\u5f55\u5230Actice APP\u5206\u533a\u4e2d\uff1a \u6700\u540e\u518d\u4fee\u6539bootloader\u7a0b\u5e8f\uff0c\u5c4f\u853dwhile(1)\uff0c\u5c4f\u853dOTA\u56fa\u4ef6\u5347\u7ea7\u529f\u80fd\uff0c\u5f00\u542f\u8df3\u8f6c\u529f\u80fd\uff1a \u518d\u6b21\u7f16\u8bd1\uff0c\u4e0b\u8f7dbootloader\uff0c\u590d\u4f4d\u5f00\u53d1\u677f\uff0c\u67e5\u770b\u4e32\u53e3\u52a9\u624b\u4e2d\u7684\u8f93\u51fa\uff0c\u53ef\u4ee5\u770b\u5230bootloader\u6210\u529f\u8df3\u8f6c\u5230Actice APP\u5f00\u59cb\u6267\u884c\uff1a","title":"3.2. \u6d4b\u8bd5bootloader\u662f\u5426\u53ef\u4ee5\u8df3\u8f6c\u5230Active APP\u5206\u533a"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#33-patch","text":"","title":"3.3. \u5dee\u5206patch\u5305\u751f\u6210\u65b9\u6cd5"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#331","text":"\u5b98\u65b9\u793a\u4f8b\u5de5\u7a0b\u5df2\u7ecf\u5728MDK\u4e2d\u914d\u7f6e\u7f16\u8bd1\u540e\u751f\u6210.bin\u56fa\u4ef6\uff0c\u5982\u56fe\uff1a \u7f16\u8bd1\u4e4b\u540e\u4f1a\u5728\u5de5\u7a0b\u76ee\u5f55\u4e0b\u751f\u6210TencentOS_tiny.bin\u6587\u4ef6\uff0c\u62f7\u8d1d\u4e00\u4efd\u51fa\u6765\uff0c\u91cd\u547d\u540d\u4e3a:TencentOS_tiny_0_1.bin\uff0c\u8868\u793a\u8fd9\u662f0.1\u7248\u672c\u7684\u56fa\u4ef6\u3002 \u4fee\u6539app\u5de5\u7a0b\uff0c\u5c06\u6253\u5370\u4fe1\u606f\u4e2d\u76840.1\u6539\u4e3a0.2\uff0c\u4ee5\u9a8c\u8bc1\u662f\u5426\u5347\u7ea7\u6210\u529f\uff1a \u91cd\u65b0\u7f16\u8bd1\uff0c\u751f\u6210\u65b0\u56fa\u4ef6TencentOS_tiny.bin\uff0c\u540c\u6837\u62f7\u8d1d\u4e00\u4efd\uff0c\u91cd\u547d\u540d\u4e3a\uff1aTencentOS_tiny_0_2\uff0c\u8868\u793a\u8fd9\u662f0.2\u7248\u672c\u7684\u56fa\u4ef6\u3002","title":"3.3.1. \u51c6\u5907\u8001\u56fa\u4ef6\u548c\u65b0\u56fa\u4ef6"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#332","text":"\u7f16\u8bd1\u6b64\u5de5\u5177\u540c\u6837\u9700\u8981gcc\u73af\u5883\u3002 \u8fdb\u5165 \\components\\ota\\tools\\diff \u76ee\u5f55\uff0c\u6267\u884cmake\u547d\u4ee4\u5f00\u59cb\u7f16\u8bd1\uff0c\u7f16\u8bd1\u4e4b\u540e\u8fdb\u5165\u5230\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 out\\target \u5373\u53ef\u770b\u5230\u5de5\u5177 diff.exe \uff1a cd out/target/ \u8be5\u5de5\u5177\u6709\u5982\u4e0b\u53c2\u6570\uff1a -h \uff1a\u6253\u5370\u5e2e\u52a9\u4fe1\u606f -v \uff1a\u6253\u5370\u66f4\u591a\u4fe1\u606f -s \uff1a<\u5f85\u5b9a...> -b <n> \uff1a\u6307\u5b9a\u6247\u533a\u5927\u5c0f\uff0c\u5355\u4f4d\uff1a\u5b57\u8282Byte -n <major>.<minor> \uff1a\u65b0\u7684\u56fa\u4ef6\u7248\u672c\u53f7 -o <major>.<minor> \uff1a\u65e7\u7684\u56fa\u4ef6\u7248\u672c\u53f7 \u5c063.3.1\u8282\u51c6\u5907\u7684\u4e24\u4e2a\u56fa\u4ef6\u62f7\u8d1d\u5230\u5f53\u524d\u5de5\u5177\u6240\u5728\u76ee\u5f55\u4e0b\u3002 \u6839\u636e\u524d\u9762\u51c6\u5907\u7684\u4e24\u4e2a\u65b0\u65e7\u56fa\u4ef6\uff0c\u5236\u4f5c\u5dee\u5206\u5347\u7ea7\u5305\u7684\u547d\u4ee4\u5982\u4e0b\uff1a ./diff.exe -v -b 2048 -n 0.2 -o 0.1 TencentOS_tiny_0_1.bin TencentOS_tiny_0_2.bin patch.bin \u8fd0\u884c\u4e4b\u540e\u5373\u53ef\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u770b\u5230\u751f\u6210\u7684\u5dee\u5206\u5347\u7ea7\u5305 patch.bin \u3002","title":"3.3.2. \u5dee\u5206\u5347\u7ea7\u5305\u751f\u6210\u5de5\u5177\u7684\u4f7f\u7528"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#34-bootloaderpatch","text":"\u4f7f\u7528STM32CubeProg\u76f4\u63a5\u5c06\u5dee\u5206\u5347\u7ea7\u5305patch.bin\u4e0b\u8f7d\u5230OTA\u5206\u533a\uff1a \u4e0b\u8f7d\u6210\u529f\u540e\uff0c\u56e0\u4e3abootloader\u901a\u8fc7\u68c0\u6d4bKV\u5206\u533a\u4e2d\u7684\u73af\u5883\u53d8\u91cfnew_version\u6765\u5224\u65ad\u662f\u5426\u6709\u65b0\u7684\u56fa\u4ef6\uff0c\u4f46\u662f\u73af\u5883\u53d8\u91cf\u5728app\u7a0b\u5e8f\u62c9\u53d6\u56fa\u4ef6\u6210\u529f\u4e4b\u540e\u624d\u4f1a\u8bbe\u7f6e\uff0c\u6240\u4ee5\u6211\u4eec\u624b\u52a8\u5728bootloader\u4e2d\u6765\u8bbe\u7f6e\u6b64\u73af\u5883\u53d8\u91cf\u3002 \u5728main.c\u4e2d\u5f15\u5165KV\u7684\u5934\u6587\u4ef6\uff1a #include \"tos_kv.h\" \u5728\u73af\u5883\u53d8\u91cf\u521d\u59cb\u5316\u4ee3\u7801\u4e4b\u540e\uff0c\u5347\u7ea7\u4ee3\u7801\u4e4b\u524d\u6dfb\u52a0\u5982\u4e0b\u7684\u4ee3\u7801\uff1a ota_img_vs_t new_version; new_version.major = 0; new_version.minor = 2; tos_kv_set(\"new_version\", &new_version, sizeof(ota_img_vs_t)); \u6dfb\u52a0\u4e4b\u540e\u7f16\u8bd1\uff0c\u4e0b\u8f7d\uff0c\u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u67e5\u770b\u8f93\u51fa\uff1a \u53ef\u4ee5\u770b\u5230bootloader\u6210\u529f\u6839\u636epatch\u5dee\u5206\u5305\u548c\u65e7\u7684\u56fa\u4ef6\uff0c\u8fd8\u539f\u51fa\u4e86\u65b0\u7684\u56fa\u4ef6\u5e76\u6210\u529f\u5347\u7ea7\u3002","title":"3.4. \u6d4b\u8bd5bootloader\u662f\u5426\u53ef\u4ee5\u6839\u636epatch\u8fdb\u884c\u5347\u7ea7"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#4-http","text":"TencentOS-tiny OTA\u7ec4\u4ef6\u652f\u6301\u4f7f\u7528 HTTP \u534f\u8bae\u62c9\u53d6\u5dee\u5206\u5347\u7ea7patch\u5305\uff0c\u5e76\u70e7\u5199\u5230OTA\u5206\u533a\u4e2d\u3002","title":"4. \u4f7f\u7528HTTP\u65b9\u5f0f\u83b7\u53d6\u56fa\u4ef6\u5e76\u5347\u7ea7"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#41-http","text":"HTTP\u670d\u52a1\u5668\u7684\u9009\u62e9\u975e\u5e38\u591a\uff0c\u5e38\u7528\u9009\u62e9\u6709\uff1a \u5728Windows\u4e0a\u4f7f\u7528\u7c7b\u4f3cMyWebServer\u7684\u5c0f\u5de5\u5177\u5f00\u542fHTTP\u670d\u52a1 \u4f18\u70b9\uff1a\u7b80\u5355\u65b9\u4fbf\uff0c\u7528\u4e8e\u6d4b\u8bd5 \u7f3a\u70b9\uff1a\u65e0\u516c\u7f51ip\uff0c\u53ea\u80fd\u5728\u540c\u4e00\u4e2a\u5c40\u57df\u7f51\u5185\u88ab\u8bbf\u95ee \u5728\u4e91\u670d\u52a1\u5668\u4e0a\u5b89\u88c5\u7c7b\u4f3cNginx\u7684\u5de5\u5177\uff0c\u5f00\u542fHTTP\u8bbf\u95ee \u4f18\u70b9\uff1a\u6027\u80fd\u5f3a\u52b2\u3001\u6709\u516c\u7f51ip\u3001\u652f\u6301\u9ad8\u5e76\u53d1\uff08\u5927\u91cf\u8bbe\u5907\u540c\u65f6\u5f00\u673a\u62c9\u53d6\u56fa\u4ef6\uff09 \u7f3a\u70b9\uff1a\u5b89\u88c5\u8fc7\u7a0b\u8f83\u590d\u6742 \u9664\u4e86\u8fd9\u4e24\u79cd\u65b9\u5f0f\u5916\uff0c\u8fd8\u6709\u5f88\u591a\u7684\u65b9\u5f0f\u53ef\u4f9b\u9009\u62e9\uff0c\u53ea\u9700\u8981\u5f00\u542fHTTP\u670d\u52a1\u5373\u53ef\uff0c\u672c\u6587\u4e2d\u6211\u4f7f\u7528\u7b2c\u4e00\u79cd\u65b9\u5f0f\u3002 \u5f00\u542f\u4e4b\u540e\u5c06\u7b2c3\u6b65\u4e2d\u751f\u6210\u7684\u5dee\u5206\u5347\u7ea7\u56fa\u4ef6 patch.bin \u4e0a\u4f20/\u590d\u5236\u5230HTTP\u670d\u52a1\u76ee\u5f55\u4e2d\uff0c\u7136\u540e\u4f7f\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee http://<\u5df2\u7ecf\u5f00\u542fHTTP\u670d\u52a1PC\u7684ip>:<HTTP\u670d\u52a1\u7aef\u53e3>/patch.bin \uff0c\u6d4b\u8bd5\u6b63\u5e38\u83b7\u53d6\u4e4b\u540e\u65b9\u53ef\u8fdb\u884c\u540e\u7eed\u64cd\u4f5c\u3002 \u5f00\u542fHTTP\u670d\u52a1\u4e4b\u540e\u8bb0\u5f97\u5173\u95ed\u5404\u79cd\u9632\u706b\u5899\uff0c\u6bd4\u5982Win10\u7f51\u7edc\u9632\u706b\u5899\uff0c\u4e91\u670d\u52a1\u5668\u5b89\u5168\u7ec4\u7b49\u3002","title":"4.1. \u51c6\u5907HTTP\u670d\u52a1\u5668"},{"location":"21.OTA_Quick_Start_based_EVB_MX_Plus/#42-http","text":"(1)\u4f7f\u7528STM32CubeMX Prog\u5168\u7247\u64e6\u9664\uff0c\u70e7\u5199\u5206\u533a\u8868\u52300x0803f800; (2)\u4fee\u6539bootloader\u7a0b\u5e8f\uff0c\u53bb\u9664\u624b\u52a8\u8bbe\u7f6enew_version\u73af\u5883\u53d8\u91cf\u4ee3\u7801\uff0c\u7f16\u8bd1\uff0c\u4e0b\u8f7d\uff0c \u4e0d\u8981\u590d\u4f4d : (3)\u4fee\u6539Actice APP\u5de5\u7a0b( ota_application_download_through_http )\uff0c\u5f00\u542fHTTP\u56fa\u4ef6\u62c9\u53d6\u548c\u5347\u7ea7\u529f\u80fd: \u4fee\u6539\u4e4b\u540e\u7f16\u8bd1\uff0c\u4e0b\u8f7d\u3002 \u7279\u522b\u6ce8\u610f\uff0c \u6b64\u65f60.1\u7248\u672c\u7684\u7a0b\u5e8f\u5df2\u7ecf\u88ab\u6211\u4eec\u4fee\u6539\uff0c\u6240\u4ee5\u4e4b\u524d\u751f\u6210\u7684patch\u5305\u65e0\u6cd5\u5b8c\u6210\u5347\u7ea7 \uff0c\u91cd\u65b0\u57280.1\u7248\u672c\u7684\u57fa\u7840\u4e0a\u4fee\u6539\u59040.2\u7248\u672c\u7684\u7a0b\u5e8f\uff0c\u5e76\u5236\u4f5cpatch\u5305\u3002 \u91cd\u590d\u4e00\u904d\u4e4b\u524d\u7684\u5236\u4f5c\u6d41\u7a0b\u5373\u53ef\uff1a \u2460 \u5c06\u5f53\u524d\u56fa\u4ef6\u62f7\u8d1d\u51fa\u6765\uff0c\u91cd\u547d\u540d\u4e3a TencentOS_tiny_0_1.bin ; \u2461 \u4fee\u6539\u6253\u5370\u63d0\u793a\uff0c\u8868\u793a\u8fd9\u662f0.2\u7248\u672c\u7684\u7a0b\u5e8f\uff1a printf(\"do sth(v0.2)...\\n\"); \u2462 \u5c06\u65b0\u56fa\u4ef6\u62f7\u8d1d\u51fa\u6765\u547d\u540d\u4e3a TencentOS_tiny_0_2.bin ; \u2463 \u4f7f\u7528diff\u547d\u4ee4\u884c\u5de5\u5177\u6216\u8005\u53ef\u89c6\u5316\u5de5\u5177\u5236\u4f5c\u5dee\u5206\u5347\u7ea7\u5305patch.bin\uff1b \u2464 \u5c06\u5236\u4f5c\u51fa\u7684\u5dee\u5206\u5347\u7ea7\u5305\u62f7\u8d1d/\u4e0a\u4f20\u5230HTTP\u670d\u52a1\u5668\u76ee\u5f55\uff1b \u6b64\u65f6\uff0c\u4e00\u5207\u51c6\u5907\u5c31\u7eea\uff0c\u590d\u4f4d\u8bbe\u5907\uff0c\u5373\u53ef\u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u770b\u5230OTA\u7684\u5347\u7ea7\u72b6\u51b5\uff1a","title":"4.2. HTTP\u83b7\u53d6\u56fa\u4ef6\u5e76\u5347\u7ea7"},{"location":"22.ElfLoader_Quick_Start/","text":"TencentOS tiny elfLoader\u7ec4\u4ef6 1. \u4ec0\u4e48\u662felfLoader elfLoader\u662fTencentOS tiny\u63d0\u4f9b\u7684\u5bf9elf\u683c\u5f0f\u6587\u4ef6\u8fdb\u884c\u52a0\u8f7d\u5e76\u6267\u884c\u7684\u7ec4\u4ef6\uff0cTencentOS tiny\u76ee\u524d\u7684elfLoader\u7ec4\u4ef6\uff0c\u63d0\u4f9b\u76ee\u6807\u6587\u4ef6\uff08object\uff09\u53ca\u5171\u4eab\u76ee\u6807\u6587\u4ef6\uff08shared object\uff09\u7684\u52a8\u6001\u52a0\u8f7d\u652f\u6301\u3002 2. elfLoader\u7ec4\u4ef6\u7684\u57fa\u672c\u4f7f\u7528\u8303\u5f0f \u5bf9\u4e8eelfLoader\u6765\u8bf4\uff0c\u4f7f\u7528\u7684\u57fa\u672c\u8303\u5f0f\u6d41\u7a0b\u4e3a\uff1a \u5c06\u6e90\u4ee3\u7801\u7f16\u8bd1\u6210object\u6216shared-object\u6587\u4ef6\u3002 \u5c06object\u6216shared-object\u6587\u4ef6\u62f7\u8d1d\u5230\u5f00\u53d1\u677f\u53ef\u4ee5\u8bbf\u95ee\u7684\u6587\u4ef6\u7cfb\u7edf\u4e2d\u3002 \u8c03\u7528elfLoader\u7ec4\u4ef6\u63d0\u4f9b\u7684tos_elfloader_load\u63a5\u53e3\u52a0\u8f7d\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684object\u6216shared-object\u6587\u4ef6\u3002 \u8c03\u7528elfLoader\u7ec4\u4ef6\u63d0\u4f9b\u7684tos_elfloader_find_symbol\u67e5\u627e\u5df2\u52a0\u8f7d\u7684\u6a21\u5757\u4e2d\u67d0\u4e2a\u7b26\u53f7\u7684\u52a0\u8f7d\u5730\u5740\uff08\u4e00\u822c\u6765\u8bf4\u662f\u4e00\u4e2a\u51fd\u6570\uff09\uff0c\u6267\u884c\u4e4b\u3002 \u5982\u679c\u540e\u7eed\u4e1a\u52a1\u4e0d\u518d\u9700\u8981\u8fd9\u4e2a\u6a21\u5757\uff0c\u6267\u884ctos_elfloader_unload\u5c06\u6a21\u5757\u5378\u8f7d\u3002 3. elfLoader\u7ec4\u4ef6\u7684\u5177\u4f53\u4f7f\u7528\u5b9e\u4f8b\uff08object\uff09 3.1 \u7f16\u5199\u4e00\u4e2a\u6a21\u5757\u7684\u6e90\u7801 extern int d_e_a; int d_g_a = 3; static int d_s_a = 5; extern int f_e_a(int); static int f_s_a(void) { d_s_a += 7; // d_s_a = 12 } int f_g_a(void) { f_s_a(); d_g_a += d_s_a; // d_g_a = 15 d_e_a += d_g_a; // + 15 f_e_a(d_e_a); } \u6e90\u78011.c\u5982\u4e0a\uff0c\u6539\u6a21\u5757\u4e2d\uff1a \u5f15\u7528\u4e86\u4e00\u4e2a\u5916\u90e8\u7684\u7b26\u53f7d_e_a\uff08\u53d8\u91cf\uff0c\u8fd9\u662f\u4e00\u4e2a\u5e94\u8be5\u5728\u6a21\u5757\u5916\u5b9a\u4e49\u7684\u7b26\u53f7\uff09 \u5b9a\u4e49\u4e86\u4e00\u4e2a\u5168\u5c40\u7b26\u53f7d_g_a\uff08\u53d8\u91cf\uff09 \u5b9a\u4e49\u4e86\u4e00\u4e2a\u6a21\u5757\u5185\u7684\u9759\u6001\u7b26\u53f7d_s_a\uff08\u53d8\u91cf\uff09 \u5f15\u7528\u4e86\u4e00\u4e2a\u5916\u90e8\u7684\u7b26\u53f7f_e_a\uff08\u51fd\u6570\uff0c\u8fd9\u662f\u4e00\u4e2a\u5e94\u8be5\u5728\u6a21\u5757\u5916\u5b9a\u4e49\u7684\u7b26\u53f7\uff09 \u5b9a\u4e49\u4e86\u4e00\u4e2a\u6a21\u5757\u5185\u7684\u9759\u6001\u7b26\u53f7f_s_a\uff08\u51fd\u6570\uff09 \u5b9a\u4e49\u4e86\u4e00\u4e2a\u5168\u5c40\u7b26\u53f7f_g_a\uff08\u51fd\u6570\uff09 3.2 \u5c06\u6a21\u5757\u7f16\u8bd1\u6210object\u6587\u4ef6 arm-linux-gnueabihf-gcc -fno-builtin -nostdlib -mthumb -mthumb-interwork -mcpu=cortex-m4 -c 1.c -o 1.o \u6211\u8fd9\u91cc\u5047\u8bbe\u8bfb\u8005\u5df2\u7ecf\u5728\u672c\u5730\u5b89\u88c5\u597darm\u4ea4\u53c9\u7f16\u8bd1\u5668\uff0c\u4e14\u672c\u5b9e\u4f8b\u662f\u57fa\u4e8eTencentOS tiny\u5b98\u65b9\u5f00\u53d1\u677f\uff08mcu\u662farm cortex-m4\u6838\u5fc3\uff09\uff0c\u6309\u7167\u4ee5\u4e0a\u7f16\u8bd1\u9009\u9879\u5c061.c\u7f16\u8bd1\u4e3a1.o 3.3 \u5c06\u6a21\u5757\u62f7\u8d1d\u81f3\u6587\u4ef6\u7cfb\u7edf \u5c06\u6a21\u5757\uff081.o\uff09\u62f7\u8d1d\u81f3\u5df2\u8fdb\u884cFAT32\u683c\u5f0f\u5316\u540e\u7684sd\u5361\uff0c\u5c06sd\u5361\u63d2\u5165TencentOS tiny\u5b98\u65b9\u5f00\u53d1\u677f\u4e0a\u7684sd\u5361\u69fd\u3002 3.4 \u8fd0\u884c\u793a\u4f8b\u5de5\u7a0b TencentOS-tiny\\board\\TencentOS_tiny_EVB_MX_Plus\\KEIL\\elfloader_relocatable_object \u7528keil\u6253\u5f00\u4ee5\u4e0a\u8def\u5f84\u4e2d\u7684\u793a\u4f8b\u5de5\u7a0b\uff1a \u6dfb\u52a0d_e_a\u53caf_e_a\u5b9e\u73b0 \u56e0\u4e3a1.o\u4f9d\u8d56\u6b64\u4e24\u4e2a\u5916\u90e8\u7b26\u53f7\uff0c\u56e0\u800c\u9700\u8981\u5728\u5185\u6838\u4e2d\u5b9a\u4e49\u8fd9\u4e24\u4e2a\u7b26\u53f7 int d_e_a = 9; int f_e_a(int a) { /* a = d_e_a + d_g_a = d_e_a + 15 = 24 */ printf(\"f_e_a: %d\\n\", a); return 0; } \u6dfb\u52a0\u7cfb\u7edf\u7b26\u53f7\u8868 const el_symbol_t el_symbols[] = { { \"d_e_a\", &d_e_a }, { \"f_e_a\", f_e_a }, { K_NULL, K_NULL }, }; \u6309\u7167\u4ee5\u4e0a\u683c\u5f0f\uff0c\u5b9a\u4e49el_symbols\u7b26\u53f7\u8868\uff0c\u7b26\u53f7\u8868\u4e2d\u5305\u542b1.o\u4e2d\u4f9d\u8d56\u7684\u4e24\u4e2a\u5916\u90e8\u7b26\u53f7\u5730\u5740\u3002 \u7f16\u5199elfLoader\u4f7f\u7528\u6848\u4f8b\u4ee3\u7801 void application_entry(void *arg) { int fd; el_module_t module; extern vfs_blkdev_ops_t sd_dev; extern vfs_fs_ops_t fatfs_ops; if (tos_vfs_block_device_register(\"/dev/sd\", &sd_dev) != VFS_ERR_NONE) { return; } if (tos_vfs_fs_register(\"fatfs_sd\", &fatfs_ops) != VFS_ERR_NONE) { return; } if (tos_vfs_fs_mount(\"/dev/sd\", \"/fs/fatfs_sd\", \"fatfs_sd\") != VFS_ERR_NONE) { printf(\"mount failed!\\n\"); return; } fd = tos_vfs_open(\"/fs/fatfs_sd/1.o\", VFS_OFLAG_READ | VFS_OFLAG_EXISTING); if (fd < 0) { return; } if (tos_elfloader_load(&module, fd) != ELFLOADER_ERR_NONE) { return; } void *addr = tos_elfloader_find_symbol(&module, \"f_g_a\"); if (!addr) { printf(\"symbol NOT FOUND: %s\\n\", \"f_g_a\"); return; } printf(\"addr: %x\\n\", addr); typedef int (*fp_t)(void); /* call f_g_a in 1.o */ ((fp_t)addr)(); tos_elfloader_unload(&module); tos_vfs_close(fd); } \u4ee5\u4e0a\u4ee3\u7801\uff1a\u4f7f\u7528TencentOS tiny\u7684vfs\u7ec4\u4ef6\u6302\u8f7dsd\u5361\u4e0a\u7684FAT32\u6587\u4ef6\u7cfb\u7edf\uff0c\u5e76\u6253\u5f00\u6587\u4ef6\u7cfb\u7edf\u4e0a\u76841.o\u83b7\u53d6\u6587\u4ef6\u63cf\u8ff0\u7b26fd\uff0c\u5c06fd\u4f5c\u4e3atos_elfloader_load\u7684\u5165\u53c2\uff0c\u52a0\u8f7d\u8fd9\u4e2a\u6a21\u5757\u5e76\u83b7\u53d6\u6a21\u5757\u7684\u53e5\u67c4module\uff0c\u4f7f\u7528tos_elfloader_find_symbol\u63a5\u53e3\u5728module\u4e2d\u67e5\u627ef_g_a\u7b26\u53f7\uff08\u51fd\u6570\uff09\u7684\u52a0\u8f7d\u5730\u5740\uff0c\u5e76\u6267\u884c\u4e4b\u3002 \u6839\u636e1.c\u4e2df_g_a\u7684\u903b\u8f91\uff0c\u6700\u7ec8\u4f1a\u8c03\u7528f_e_a\u5c06d_e_a\u6700\u7ec8\u7684\u503c\u6253\u5370\u51fa\u6765\uff0c\u6839\u636e\u8fd0\u7b97\u903b\u8f91\uff0cd_e_a\u7684\u6700\u7ec8\u503c\u5e94\u8be5\u4e3a24\u3002 \u8c03\u7528tos_elfloader_unload\u5378\u8f7d\u8be5\u6a21\u5757\uff0c\u8c03\u7528tos_vfs_close\u63a5\u53e3\u5173\u95ed\u6587\u4ef6\u63cf\u8ff0\u7b26fd\u3002 3.5 \u6ce8\u610f \u5bf9\u4e8e\u4e00\u822c\u7684mcu\u6765\u8bf4\uff0c\u53ef\u6267\u884c\u4ee3\u7801\u4f4d\u4e8eFLASH\u4e0a\uff0c\u800c\u6a21\u5757\u7684\u53ef\u6267\u884c\u4ee3\u7801\u53ca\u6570\u636e\u7686\u88ab\u52a0\u8f7d\u81f3RAM\u4e0a\u3002\u800c\u4e00\u822c\u6765\u8bf4FLASH\u548cRAM\u4e4b\u95f4\u7684\u5730\u5740\u76f8\u9694\u751a\u8fdc\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u52a0\u8f7dobject\u6587\u4ef6\u7684\u91cd\u5b9a\u4f4d\u9636\u6bb5\uff0c\u67d0\u4e9b\u91cd\u5b9a\u4f4d\u7c7b\u578b\u65e0\u6cd5\u987a\u5229\u5b8c\u6210\u91cd\u5b9a\u4f4d\u64cd\u4f5c\uff0c\u8fdb\u800c\u5bfc\u81f4object\u6587\u4ef6\u52a0\u8f7d\u5931\u8d25\u3002 4. elfLoader\u7ec4\u4ef6\u7684\u5177\u4f53\u4f7f\u7528\u5b9e\u4f8b\uff08shared-object\uff09 \u5171\u4eab\u76ee\u6807\u6587\u4ef6(shared-object)\u7684\u88c5\u8f7d\u53ca\u8fd0\u884c\u4e0eobject\u6587\u4ef6\u7c7b\u4f3c 4.1 \u7f16\u5199\u4e00\u4e2a\u6a21\u5757\u7684\u6e90\u7801 \u53c2\u80033.1\u8282 4.2 \u5c06\u6a21\u5757\u7f16\u8bd1\u6210shared-object\u6587\u4ef6 arm-linux-gnueabihf-gcc -fno-builtin -nostdlib -mthumb -mthumb-interwork -fPIC -mcpu=cortex-m4 -c 1.c -o 1.o arm-linux-gnueabihf-ld -fno-builtin -nostdlib -fPIC -shared -z max-page-size=0x4 1.o -o 1.so \u6211\u8fd9\u91cc\u5047\u8bbe\u8bfb\u8005\u5df2\u7ecf\u5728\u672c\u5730\u5b89\u88c5\u597darm\u4ea4\u53c9\u7f16\u8bd1\u5668\uff0c\u4e14\u672c\u5b9e\u4f8b\u662f\u57fa\u4e8eTencentOS tiny\u5b98\u65b9\u5f00\u53d1\u677f\uff08mcu\u662farm cortex-m4\u6838\u5fc3\uff09\uff0c\u6309\u7167\u4ee5\u4e0a\u7f16\u8bd1\u9009\u9879\u5c061.c\u7f16\u8bd1\u4e3a1.so 4.3 \u5c06\u6a21\u5757\u62f7\u8d1d\u81f3\u6587\u4ef6\u7cfb\u7edf \u53c2\u80033.3\u8282 4.4 \u8fd0\u884c\u793a\u4f8b\u4ee3\u7801 TencentOS-tiny\\board\\TencentOS_tiny_EVB_MX_Plus\\KEIL\\elfloader_shared_object \u7528keil\u6253\u5f00\u4ee5\u4e0a\u8def\u5f84\u4e2d\u7684\u793a\u4f8b\u5de5\u7a0b\uff0c\u5de5\u7a0b\u4e2d\u7684\u5177\u4f53\u4ee3\u7801\u4e0eobject\u5de5\u7a0b\u7c7b\u4f3c\uff0c\u53c2\u80033.4\u8282\uff0c\u4e0d\u518d\u8d58\u8ff0\u3002 5. elfLoader\u7ec4\u4ef6\u7684\u6587\u4ef6\u8bbf\u95ee\u6269\u5c55 elfLoader\u7684\u7ec4\u4ef6\u5b9e\u73b0\uff0c\u5bf9\u4e8e\u6a21\u5757\u6587\u4ef6\u7684\u8bbf\u95ee\uff0c\u662f\u901a\u8fc7elfloader_fd_read\u63a5\u53e3\u6765\u8fdb\u884c\u7684\uff1a __KNL__ __WEAK__ el_err_t elfloader_fd_read(int fd, uint32_t offset, void *buf, size_t len) { if (tos_vfs_lseek(fd, (vfs_off_t)offset, VFS_SEEK_SET) < 0) { return ELFLOADER_ERR_FD_READ_FAILED; } if (tos_vfs_read(fd, buf, len) < 0) { return ELFLOADER_ERR_FD_READ_FAILED; } return ELFLOADER_ERR_NONE; } \u6b64\u63a5\u53e3\u63a5\u6536\u56db\u4e2a\u53c2\u6570\uff1a fd \u6587\u4ef6\u7684\u63cf\u8ff0\u7b26fd\u3002\u6b64fd\u53ef\u4ee5\u4e0d\u7528\u62d8\u6ce5\u4e8e\u6587\u4ef6\u7cfb\u7edf\u7684fd\uff0cfd\u53ea\u662f\u4e00\u4e2a\u6587\u4ef6\u7684\u62bd\u8c61\u3002 offset \u5bf9\u6587\u4ef6\u7684offset\u504f\u79fb\u5904\u8fdb\u884c\u8bfb\u53d6\u3002 buf \u6587\u4ef6\u8bfb\u53d6\u7684\u6570\u636e\u7f13\u51b2 len \u6587\u4ef6\u8bfb\u53d6\u7684\u957f\u5ea6 elfloader_fd_read\u7684\u5b9e\u73b0\u4f4d\u4e8etos_elfloader_fd_read-vfs.c\u4e2d\uff0c\u9ed8\u8ba4\u5b9e\u73b0\u662f\u57fa\u4e8eTencentOS tiny\u7684vfs\u63a5\u53e3\u8fdb\u884c\u6587\u4ef6\u8bbf\u95ee\u3002 \u73b0\u5728\u5047\u8bbe\u6709\u8fd9\u6837\u7684\u573a\u666f\uff1a\u7528\u6237\u5728\u4f7f\u7528elfLoader\u65f6\uff0c\u4e0d\u5e0c\u671b\u901a\u8fc7vfs\u6846\u67b6\u6765\u8fdb\u884c\u6587\u4ef6\u8bbf\u95ee\uff08\u7528\u6237\u7684\u573a\u666f\u53ef\u80fd\u6839\u672c\u5c31\u6ca1\u6709\u6587\u4ef6\u7cfb\u7edf\uff0c\u6216\u8005\u538b\u6839\u4e0d\u5e0c\u671b\u901a\u8fc7\u6587\u4ef6\u7cfb\u7edf\u6765\u8bbf\u95ee\u6a21\u5757\uff09\uff0c\u6bd4\u5982\u7528\u6237\u5c06\u7f16\u8bd1\u597d\u7684\u6a21\u5757\u70e7\u5199\u8fdb\u88f8FLASH\u7684\u56fa\u5b9a\u504f\u79fb\u5904\uff0c\u5047\u8bbe\u6709\u8fd9\u79cd\u573a\u666f\uff1a uint32_t offset_of_modules[] = { 0x8000 0000, 0x8000 2000, 0x8000 4000, }; \u7528\u6237\u5206\u522b\u5728FLASH\u76840x8000 0000\u30010x8000 2000\u30010x8000 4000\u504f\u79fb\u5904\u70e7\u5199\u4e86\u4e09\u4e2ashared-object\u6587\u4ef6\uff0c\u7528\u6237\u5982\u4f55\u4e0d\u901a\u8fc7\u6587\u4ef6\u7cfb\u7edf\u6846\u67b6\u6765\u5b9e\u73b0\u6a21\u5757\u7684\u52a0\u8f7d\u8fd0\u884c\u5462\uff1f \u4e1a\u52a1\u4ee3\u7801\u4e2d\uff0c\u5e0c\u671b\u901a\u8fc7fd\u4e3a0\u65f6\uff0c\u52a0\u8f7d0x8000 0000\u5904\u7684\u6a21\u5757\uff0c\u901a\u8fc7fd\u4e3a1\u65f6\uff0c\u52a0\u8f7d0x8000 2000\u5904\u7684\u6a21\u5757\uff0c\u901a\u8fc7fd\u4e3a2\u65f6\uff0c\u52a0\u8f7d0x8000 4000\u5904\u7684\u6a21\u5757\u3002\u4ee3\u7801\u5982\u4e0b\uff1a void application_entry(void *arg) { el_module_t module0, module1, module2; if (tos_elfloader_load(&module0, 0) != ELFLOADER_ERR_NONE) { return; } void *addr = tos_elfloader_find_symbol(&module0, \"f_g_a\"); if (!addr) { printf(\"symbol NOT FOUND: %s\\n\", \"f_g_a\"); return; } if (tos_elfloader_load(&module1, 1) != ELFLOADER_ERR_NONE) { return; } if (tos_elfloader_load(&module2, 2) != ELFLOADER_ERR_NONE) { return; } tos_elfloader_unload(&module0); tos_elfloader_unload(&module1); tos_elfloader_unload(&module2); } \u4e1a\u52a1\u4ee3\u7801\u91cc\uff0c\u5e76\u4e0d\u9700\u8981\u4f9d\u8d56\u6587\u4ef6\u7cfb\u7edf\uff0cfd\u672c\u8d28\u4e0a\u53ea\u662f\u53ea\u662f\u4e00\u79cd\u62bd\u8c61\uff0c\u5b83\u53ef\u4ee5\u4e0e\u6587\u4ef6\u7cfb\u7edf\u65e0\u5173\u3002 \u73b0\u5728\u5047\u8bbe\u7528\u6237\u5df2\u7ecf\u5b9e\u73b0\u4e86FLASH\u7684\u8bfb\u9a71\u52a8\u63a5\u53e3flash_read\uff0c\u8981\u505a\u5230\u4e0a\u8ff0\u8bc9\u6c42\uff0c\u53ea\u9700\u8981\u91cd\u65b0\u5b9e\u73b0elfloader_fd_read\u5373\u53ef\uff1a el_err_t elfloader_fd_read(int fd, uint32_t offset, void *buf, size_t len) { uint32_t offset = offset_of_modules[fd]; if (flash_read(offset, buf, len) < 0) { return ELFLOADER_ERR_FD_READ_FAILED; } return ELFLOADER_ERR_NONE; } \u53ef\u4ee5\u770b\u51fa\u6765\uff0cTencentOS tiny\u7684\u7ec4\u4ef6\u5b9e\u73b0\uff0c\u4f9d\u8d56\u4e00\u5b9a\u7a0b\u5ea6\u7684\u62bd\u8c61\uff0c\u4f46\u6b64\u62bd\u8c61\u53c8\u5e76\u4e0d\u4e0e\u67d0\u4e2a\u7279\u5b9a\u6846\u67b6\u5f3a\u8026\u5408\u3002\u5bf9\u4e8eelfLoader\u7ec4\u4ef6\u6765\u8bf4\uff0c\u7528\u6237\u5373\u53ef\u4ee5\u57fa\u4e8e\u6587\u4ef6\u7cfb\u7edf\u5b9e\u73b0\u5bf9\u6a21\u5757\u7684\u8bbf\u95ee\uff0c\u7ecf\u8fc7\u5c11\u91cf\u7684\u9002\u914d\u5de5\u4f5c\uff0c\u4e5f\u5b8c\u5168\u53ef\u4ee5\u57fa\u4e8e\u88f8FLASH\u9a71\u52a8\u6765\u8fdb\u884c\u6a21\u5757\u7684\u8bbf\u95ee\u3002","title":"22.ElfLoader_Quick_Start"},{"location":"22.ElfLoader_Quick_Start/#tencentos-tiny-elfloader","text":"","title":"TencentOS tiny elfLoader\u7ec4\u4ef6"},{"location":"22.ElfLoader_Quick_Start/#1-elfloader","text":"elfLoader\u662fTencentOS tiny\u63d0\u4f9b\u7684\u5bf9elf\u683c\u5f0f\u6587\u4ef6\u8fdb\u884c\u52a0\u8f7d\u5e76\u6267\u884c\u7684\u7ec4\u4ef6\uff0cTencentOS tiny\u76ee\u524d\u7684elfLoader\u7ec4\u4ef6\uff0c\u63d0\u4f9b\u76ee\u6807\u6587\u4ef6\uff08object\uff09\u53ca\u5171\u4eab\u76ee\u6807\u6587\u4ef6\uff08shared object\uff09\u7684\u52a8\u6001\u52a0\u8f7d\u652f\u6301\u3002","title":"1. \u4ec0\u4e48\u662felfLoader"},{"location":"22.ElfLoader_Quick_Start/#2-elfloader","text":"\u5bf9\u4e8eelfLoader\u6765\u8bf4\uff0c\u4f7f\u7528\u7684\u57fa\u672c\u8303\u5f0f\u6d41\u7a0b\u4e3a\uff1a \u5c06\u6e90\u4ee3\u7801\u7f16\u8bd1\u6210object\u6216shared-object\u6587\u4ef6\u3002 \u5c06object\u6216shared-object\u6587\u4ef6\u62f7\u8d1d\u5230\u5f00\u53d1\u677f\u53ef\u4ee5\u8bbf\u95ee\u7684\u6587\u4ef6\u7cfb\u7edf\u4e2d\u3002 \u8c03\u7528elfLoader\u7ec4\u4ef6\u63d0\u4f9b\u7684tos_elfloader_load\u63a5\u53e3\u52a0\u8f7d\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684object\u6216shared-object\u6587\u4ef6\u3002 \u8c03\u7528elfLoader\u7ec4\u4ef6\u63d0\u4f9b\u7684tos_elfloader_find_symbol\u67e5\u627e\u5df2\u52a0\u8f7d\u7684\u6a21\u5757\u4e2d\u67d0\u4e2a\u7b26\u53f7\u7684\u52a0\u8f7d\u5730\u5740\uff08\u4e00\u822c\u6765\u8bf4\u662f\u4e00\u4e2a\u51fd\u6570\uff09\uff0c\u6267\u884c\u4e4b\u3002 \u5982\u679c\u540e\u7eed\u4e1a\u52a1\u4e0d\u518d\u9700\u8981\u8fd9\u4e2a\u6a21\u5757\uff0c\u6267\u884ctos_elfloader_unload\u5c06\u6a21\u5757\u5378\u8f7d\u3002","title":"2. elfLoader\u7ec4\u4ef6\u7684\u57fa\u672c\u4f7f\u7528\u8303\u5f0f"},{"location":"22.ElfLoader_Quick_Start/#3-elfloaderobject","text":"","title":"3. elfLoader\u7ec4\u4ef6\u7684\u5177\u4f53\u4f7f\u7528\u5b9e\u4f8b\uff08object\uff09"},{"location":"22.ElfLoader_Quick_Start/#31","text":"extern int d_e_a; int d_g_a = 3; static int d_s_a = 5; extern int f_e_a(int); static int f_s_a(void) { d_s_a += 7; // d_s_a = 12 } int f_g_a(void) { f_s_a(); d_g_a += d_s_a; // d_g_a = 15 d_e_a += d_g_a; // + 15 f_e_a(d_e_a); } \u6e90\u78011.c\u5982\u4e0a\uff0c\u6539\u6a21\u5757\u4e2d\uff1a \u5f15\u7528\u4e86\u4e00\u4e2a\u5916\u90e8\u7684\u7b26\u53f7d_e_a\uff08\u53d8\u91cf\uff0c\u8fd9\u662f\u4e00\u4e2a\u5e94\u8be5\u5728\u6a21\u5757\u5916\u5b9a\u4e49\u7684\u7b26\u53f7\uff09 \u5b9a\u4e49\u4e86\u4e00\u4e2a\u5168\u5c40\u7b26\u53f7d_g_a\uff08\u53d8\u91cf\uff09 \u5b9a\u4e49\u4e86\u4e00\u4e2a\u6a21\u5757\u5185\u7684\u9759\u6001\u7b26\u53f7d_s_a\uff08\u53d8\u91cf\uff09 \u5f15\u7528\u4e86\u4e00\u4e2a\u5916\u90e8\u7684\u7b26\u53f7f_e_a\uff08\u51fd\u6570\uff0c\u8fd9\u662f\u4e00\u4e2a\u5e94\u8be5\u5728\u6a21\u5757\u5916\u5b9a\u4e49\u7684\u7b26\u53f7\uff09 \u5b9a\u4e49\u4e86\u4e00\u4e2a\u6a21\u5757\u5185\u7684\u9759\u6001\u7b26\u53f7f_s_a\uff08\u51fd\u6570\uff09 \u5b9a\u4e49\u4e86\u4e00\u4e2a\u5168\u5c40\u7b26\u53f7f_g_a\uff08\u51fd\u6570\uff09","title":"3.1 \u7f16\u5199\u4e00\u4e2a\u6a21\u5757\u7684\u6e90\u7801"},{"location":"22.ElfLoader_Quick_Start/#32-object","text":"arm-linux-gnueabihf-gcc -fno-builtin -nostdlib -mthumb -mthumb-interwork -mcpu=cortex-m4 -c 1.c -o 1.o \u6211\u8fd9\u91cc\u5047\u8bbe\u8bfb\u8005\u5df2\u7ecf\u5728\u672c\u5730\u5b89\u88c5\u597darm\u4ea4\u53c9\u7f16\u8bd1\u5668\uff0c\u4e14\u672c\u5b9e\u4f8b\u662f\u57fa\u4e8eTencentOS tiny\u5b98\u65b9\u5f00\u53d1\u677f\uff08mcu\u662farm cortex-m4\u6838\u5fc3\uff09\uff0c\u6309\u7167\u4ee5\u4e0a\u7f16\u8bd1\u9009\u9879\u5c061.c\u7f16\u8bd1\u4e3a1.o","title":"3.2 \u5c06\u6a21\u5757\u7f16\u8bd1\u6210object\u6587\u4ef6"},{"location":"22.ElfLoader_Quick_Start/#33","text":"\u5c06\u6a21\u5757\uff081.o\uff09\u62f7\u8d1d\u81f3\u5df2\u8fdb\u884cFAT32\u683c\u5f0f\u5316\u540e\u7684sd\u5361\uff0c\u5c06sd\u5361\u63d2\u5165TencentOS tiny\u5b98\u65b9\u5f00\u53d1\u677f\u4e0a\u7684sd\u5361\u69fd\u3002","title":"3.3 \u5c06\u6a21\u5757\u62f7\u8d1d\u81f3\u6587\u4ef6\u7cfb\u7edf"},{"location":"22.ElfLoader_Quick_Start/#34","text":"TencentOS-tiny\\board\\TencentOS_tiny_EVB_MX_Plus\\KEIL\\elfloader_relocatable_object \u7528keil\u6253\u5f00\u4ee5\u4e0a\u8def\u5f84\u4e2d\u7684\u793a\u4f8b\u5de5\u7a0b\uff1a \u6dfb\u52a0d_e_a\u53caf_e_a\u5b9e\u73b0 \u56e0\u4e3a1.o\u4f9d\u8d56\u6b64\u4e24\u4e2a\u5916\u90e8\u7b26\u53f7\uff0c\u56e0\u800c\u9700\u8981\u5728\u5185\u6838\u4e2d\u5b9a\u4e49\u8fd9\u4e24\u4e2a\u7b26\u53f7 int d_e_a = 9; int f_e_a(int a) { /* a = d_e_a + d_g_a = d_e_a + 15 = 24 */ printf(\"f_e_a: %d\\n\", a); return 0; } \u6dfb\u52a0\u7cfb\u7edf\u7b26\u53f7\u8868 const el_symbol_t el_symbols[] = { { \"d_e_a\", &d_e_a }, { \"f_e_a\", f_e_a }, { K_NULL, K_NULL }, }; \u6309\u7167\u4ee5\u4e0a\u683c\u5f0f\uff0c\u5b9a\u4e49el_symbols\u7b26\u53f7\u8868\uff0c\u7b26\u53f7\u8868\u4e2d\u5305\u542b1.o\u4e2d\u4f9d\u8d56\u7684\u4e24\u4e2a\u5916\u90e8\u7b26\u53f7\u5730\u5740\u3002 \u7f16\u5199elfLoader\u4f7f\u7528\u6848\u4f8b\u4ee3\u7801 void application_entry(void *arg) { int fd; el_module_t module; extern vfs_blkdev_ops_t sd_dev; extern vfs_fs_ops_t fatfs_ops; if (tos_vfs_block_device_register(\"/dev/sd\", &sd_dev) != VFS_ERR_NONE) { return; } if (tos_vfs_fs_register(\"fatfs_sd\", &fatfs_ops) != VFS_ERR_NONE) { return; } if (tos_vfs_fs_mount(\"/dev/sd\", \"/fs/fatfs_sd\", \"fatfs_sd\") != VFS_ERR_NONE) { printf(\"mount failed!\\n\"); return; } fd = tos_vfs_open(\"/fs/fatfs_sd/1.o\", VFS_OFLAG_READ | VFS_OFLAG_EXISTING); if (fd < 0) { return; } if (tos_elfloader_load(&module, fd) != ELFLOADER_ERR_NONE) { return; } void *addr = tos_elfloader_find_symbol(&module, \"f_g_a\"); if (!addr) { printf(\"symbol NOT FOUND: %s\\n\", \"f_g_a\"); return; } printf(\"addr: %x\\n\", addr); typedef int (*fp_t)(void); /* call f_g_a in 1.o */ ((fp_t)addr)(); tos_elfloader_unload(&module); tos_vfs_close(fd); } \u4ee5\u4e0a\u4ee3\u7801\uff1a\u4f7f\u7528TencentOS tiny\u7684vfs\u7ec4\u4ef6\u6302\u8f7dsd\u5361\u4e0a\u7684FAT32\u6587\u4ef6\u7cfb\u7edf\uff0c\u5e76\u6253\u5f00\u6587\u4ef6\u7cfb\u7edf\u4e0a\u76841.o\u83b7\u53d6\u6587\u4ef6\u63cf\u8ff0\u7b26fd\uff0c\u5c06fd\u4f5c\u4e3atos_elfloader_load\u7684\u5165\u53c2\uff0c\u52a0\u8f7d\u8fd9\u4e2a\u6a21\u5757\u5e76\u83b7\u53d6\u6a21\u5757\u7684\u53e5\u67c4module\uff0c\u4f7f\u7528tos_elfloader_find_symbol\u63a5\u53e3\u5728module\u4e2d\u67e5\u627ef_g_a\u7b26\u53f7\uff08\u51fd\u6570\uff09\u7684\u52a0\u8f7d\u5730\u5740\uff0c\u5e76\u6267\u884c\u4e4b\u3002 \u6839\u636e1.c\u4e2df_g_a\u7684\u903b\u8f91\uff0c\u6700\u7ec8\u4f1a\u8c03\u7528f_e_a\u5c06d_e_a\u6700\u7ec8\u7684\u503c\u6253\u5370\u51fa\u6765\uff0c\u6839\u636e\u8fd0\u7b97\u903b\u8f91\uff0cd_e_a\u7684\u6700\u7ec8\u503c\u5e94\u8be5\u4e3a24\u3002 \u8c03\u7528tos_elfloader_unload\u5378\u8f7d\u8be5\u6a21\u5757\uff0c\u8c03\u7528tos_vfs_close\u63a5\u53e3\u5173\u95ed\u6587\u4ef6\u63cf\u8ff0\u7b26fd\u3002","title":"3.4 \u8fd0\u884c\u793a\u4f8b\u5de5\u7a0b"},{"location":"22.ElfLoader_Quick_Start/#35","text":"\u5bf9\u4e8e\u4e00\u822c\u7684mcu\u6765\u8bf4\uff0c\u53ef\u6267\u884c\u4ee3\u7801\u4f4d\u4e8eFLASH\u4e0a\uff0c\u800c\u6a21\u5757\u7684\u53ef\u6267\u884c\u4ee3\u7801\u53ca\u6570\u636e\u7686\u88ab\u52a0\u8f7d\u81f3RAM\u4e0a\u3002\u800c\u4e00\u822c\u6765\u8bf4FLASH\u548cRAM\u4e4b\u95f4\u7684\u5730\u5740\u76f8\u9694\u751a\u8fdc\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u52a0\u8f7dobject\u6587\u4ef6\u7684\u91cd\u5b9a\u4f4d\u9636\u6bb5\uff0c\u67d0\u4e9b\u91cd\u5b9a\u4f4d\u7c7b\u578b\u65e0\u6cd5\u987a\u5229\u5b8c\u6210\u91cd\u5b9a\u4f4d\u64cd\u4f5c\uff0c\u8fdb\u800c\u5bfc\u81f4object\u6587\u4ef6\u52a0\u8f7d\u5931\u8d25\u3002","title":"3.5 \u6ce8\u610f"},{"location":"22.ElfLoader_Quick_Start/#4-elfloadershared-object","text":"\u5171\u4eab\u76ee\u6807\u6587\u4ef6(shared-object)\u7684\u88c5\u8f7d\u53ca\u8fd0\u884c\u4e0eobject\u6587\u4ef6\u7c7b\u4f3c","title":"4. elfLoader\u7ec4\u4ef6\u7684\u5177\u4f53\u4f7f\u7528\u5b9e\u4f8b\uff08shared-object\uff09"},{"location":"22.ElfLoader_Quick_Start/#41","text":"\u53c2\u80033.1\u8282","title":"4.1 \u7f16\u5199\u4e00\u4e2a\u6a21\u5757\u7684\u6e90\u7801"},{"location":"22.ElfLoader_Quick_Start/#42-shared-object","text":"arm-linux-gnueabihf-gcc -fno-builtin -nostdlib -mthumb -mthumb-interwork -fPIC -mcpu=cortex-m4 -c 1.c -o 1.o arm-linux-gnueabihf-ld -fno-builtin -nostdlib -fPIC -shared -z max-page-size=0x4 1.o -o 1.so \u6211\u8fd9\u91cc\u5047\u8bbe\u8bfb\u8005\u5df2\u7ecf\u5728\u672c\u5730\u5b89\u88c5\u597darm\u4ea4\u53c9\u7f16\u8bd1\u5668\uff0c\u4e14\u672c\u5b9e\u4f8b\u662f\u57fa\u4e8eTencentOS tiny\u5b98\u65b9\u5f00\u53d1\u677f\uff08mcu\u662farm cortex-m4\u6838\u5fc3\uff09\uff0c\u6309\u7167\u4ee5\u4e0a\u7f16\u8bd1\u9009\u9879\u5c061.c\u7f16\u8bd1\u4e3a1.so","title":"4.2 \u5c06\u6a21\u5757\u7f16\u8bd1\u6210shared-object\u6587\u4ef6"},{"location":"22.ElfLoader_Quick_Start/#43","text":"\u53c2\u80033.3\u8282","title":"4.3 \u5c06\u6a21\u5757\u62f7\u8d1d\u81f3\u6587\u4ef6\u7cfb\u7edf"},{"location":"22.ElfLoader_Quick_Start/#44","text":"TencentOS-tiny\\board\\TencentOS_tiny_EVB_MX_Plus\\KEIL\\elfloader_shared_object \u7528keil\u6253\u5f00\u4ee5\u4e0a\u8def\u5f84\u4e2d\u7684\u793a\u4f8b\u5de5\u7a0b\uff0c\u5de5\u7a0b\u4e2d\u7684\u5177\u4f53\u4ee3\u7801\u4e0eobject\u5de5\u7a0b\u7c7b\u4f3c\uff0c\u53c2\u80033.4\u8282\uff0c\u4e0d\u518d\u8d58\u8ff0\u3002","title":"4.4 \u8fd0\u884c\u793a\u4f8b\u4ee3\u7801"},{"location":"22.ElfLoader_Quick_Start/#5-elfloader","text":"elfLoader\u7684\u7ec4\u4ef6\u5b9e\u73b0\uff0c\u5bf9\u4e8e\u6a21\u5757\u6587\u4ef6\u7684\u8bbf\u95ee\uff0c\u662f\u901a\u8fc7elfloader_fd_read\u63a5\u53e3\u6765\u8fdb\u884c\u7684\uff1a __KNL__ __WEAK__ el_err_t elfloader_fd_read(int fd, uint32_t offset, void *buf, size_t len) { if (tos_vfs_lseek(fd, (vfs_off_t)offset, VFS_SEEK_SET) < 0) { return ELFLOADER_ERR_FD_READ_FAILED; } if (tos_vfs_read(fd, buf, len) < 0) { return ELFLOADER_ERR_FD_READ_FAILED; } return ELFLOADER_ERR_NONE; } \u6b64\u63a5\u53e3\u63a5\u6536\u56db\u4e2a\u53c2\u6570\uff1a fd \u6587\u4ef6\u7684\u63cf\u8ff0\u7b26fd\u3002\u6b64fd\u53ef\u4ee5\u4e0d\u7528\u62d8\u6ce5\u4e8e\u6587\u4ef6\u7cfb\u7edf\u7684fd\uff0cfd\u53ea\u662f\u4e00\u4e2a\u6587\u4ef6\u7684\u62bd\u8c61\u3002 offset \u5bf9\u6587\u4ef6\u7684offset\u504f\u79fb\u5904\u8fdb\u884c\u8bfb\u53d6\u3002 buf \u6587\u4ef6\u8bfb\u53d6\u7684\u6570\u636e\u7f13\u51b2 len \u6587\u4ef6\u8bfb\u53d6\u7684\u957f\u5ea6 elfloader_fd_read\u7684\u5b9e\u73b0\u4f4d\u4e8etos_elfloader_fd_read-vfs.c\u4e2d\uff0c\u9ed8\u8ba4\u5b9e\u73b0\u662f\u57fa\u4e8eTencentOS tiny\u7684vfs\u63a5\u53e3\u8fdb\u884c\u6587\u4ef6\u8bbf\u95ee\u3002 \u73b0\u5728\u5047\u8bbe\u6709\u8fd9\u6837\u7684\u573a\u666f\uff1a\u7528\u6237\u5728\u4f7f\u7528elfLoader\u65f6\uff0c\u4e0d\u5e0c\u671b\u901a\u8fc7vfs\u6846\u67b6\u6765\u8fdb\u884c\u6587\u4ef6\u8bbf\u95ee\uff08\u7528\u6237\u7684\u573a\u666f\u53ef\u80fd\u6839\u672c\u5c31\u6ca1\u6709\u6587\u4ef6\u7cfb\u7edf\uff0c\u6216\u8005\u538b\u6839\u4e0d\u5e0c\u671b\u901a\u8fc7\u6587\u4ef6\u7cfb\u7edf\u6765\u8bbf\u95ee\u6a21\u5757\uff09\uff0c\u6bd4\u5982\u7528\u6237\u5c06\u7f16\u8bd1\u597d\u7684\u6a21\u5757\u70e7\u5199\u8fdb\u88f8FLASH\u7684\u56fa\u5b9a\u504f\u79fb\u5904\uff0c\u5047\u8bbe\u6709\u8fd9\u79cd\u573a\u666f\uff1a uint32_t offset_of_modules[] = { 0x8000 0000, 0x8000 2000, 0x8000 4000, }; \u7528\u6237\u5206\u522b\u5728FLASH\u76840x8000 0000\u30010x8000 2000\u30010x8000 4000\u504f\u79fb\u5904\u70e7\u5199\u4e86\u4e09\u4e2ashared-object\u6587\u4ef6\uff0c\u7528\u6237\u5982\u4f55\u4e0d\u901a\u8fc7\u6587\u4ef6\u7cfb\u7edf\u6846\u67b6\u6765\u5b9e\u73b0\u6a21\u5757\u7684\u52a0\u8f7d\u8fd0\u884c\u5462\uff1f \u4e1a\u52a1\u4ee3\u7801\u4e2d\uff0c\u5e0c\u671b\u901a\u8fc7fd\u4e3a0\u65f6\uff0c\u52a0\u8f7d0x8000 0000\u5904\u7684\u6a21\u5757\uff0c\u901a\u8fc7fd\u4e3a1\u65f6\uff0c\u52a0\u8f7d0x8000 2000\u5904\u7684\u6a21\u5757\uff0c\u901a\u8fc7fd\u4e3a2\u65f6\uff0c\u52a0\u8f7d0x8000 4000\u5904\u7684\u6a21\u5757\u3002\u4ee3\u7801\u5982\u4e0b\uff1a void application_entry(void *arg) { el_module_t module0, module1, module2; if (tos_elfloader_load(&module0, 0) != ELFLOADER_ERR_NONE) { return; } void *addr = tos_elfloader_find_symbol(&module0, \"f_g_a\"); if (!addr) { printf(\"symbol NOT FOUND: %s\\n\", \"f_g_a\"); return; } if (tos_elfloader_load(&module1, 1) != ELFLOADER_ERR_NONE) { return; } if (tos_elfloader_load(&module2, 2) != ELFLOADER_ERR_NONE) { return; } tos_elfloader_unload(&module0); tos_elfloader_unload(&module1); tos_elfloader_unload(&module2); } \u4e1a\u52a1\u4ee3\u7801\u91cc\uff0c\u5e76\u4e0d\u9700\u8981\u4f9d\u8d56\u6587\u4ef6\u7cfb\u7edf\uff0cfd\u672c\u8d28\u4e0a\u53ea\u662f\u53ea\u662f\u4e00\u79cd\u62bd\u8c61\uff0c\u5b83\u53ef\u4ee5\u4e0e\u6587\u4ef6\u7cfb\u7edf\u65e0\u5173\u3002 \u73b0\u5728\u5047\u8bbe\u7528\u6237\u5df2\u7ecf\u5b9e\u73b0\u4e86FLASH\u7684\u8bfb\u9a71\u52a8\u63a5\u53e3flash_read\uff0c\u8981\u505a\u5230\u4e0a\u8ff0\u8bc9\u6c42\uff0c\u53ea\u9700\u8981\u91cd\u65b0\u5b9e\u73b0elfloader_fd_read\u5373\u53ef\uff1a el_err_t elfloader_fd_read(int fd, uint32_t offset, void *buf, size_t len) { uint32_t offset = offset_of_modules[fd]; if (flash_read(offset, buf, len) < 0) { return ELFLOADER_ERR_FD_READ_FAILED; } return ELFLOADER_ERR_NONE; } \u53ef\u4ee5\u770b\u51fa\u6765\uff0cTencentOS tiny\u7684\u7ec4\u4ef6\u5b9e\u73b0\uff0c\u4f9d\u8d56\u4e00\u5b9a\u7a0b\u5ea6\u7684\u62bd\u8c61\uff0c\u4f46\u6b64\u62bd\u8c61\u53c8\u5e76\u4e0d\u4e0e\u67d0\u4e2a\u7279\u5b9a\u6846\u67b6\u5f3a\u8026\u5408\u3002\u5bf9\u4e8eelfLoader\u7ec4\u4ef6\u6765\u8bf4\uff0c\u7528\u6237\u5373\u53ef\u4ee5\u57fa\u4e8e\u6587\u4ef6\u7cfb\u7edf\u5b9e\u73b0\u5bf9\u6a21\u5757\u7684\u8bbf\u95ee\uff0c\u7ecf\u8fc7\u5c11\u91cf\u7684\u9002\u914d\u5de5\u4f5c\uff0c\u4e5f\u5b8c\u5168\u53ef\u4ee5\u57fa\u4e8e\u88f8FLASH\u9a71\u52a8\u6765\u8fdb\u884c\u6a21\u5757\u7684\u8bbf\u95ee\u3002","title":"5. elfLoader\u7ec4\u4ef6\u7684\u6587\u4ef6\u8bbf\u95ee\u6269\u5c55"},{"location":"23.CMSIS_RTOS_API_Use_Guide/","text":"1. CMSIS-RTOS API\u662f\u4ec0\u4e48 CMSIS-RTOS\u662f\u7528\u4e8e\u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf\uff08RTOS\uff09\u7684\u4e00\u5c42\u901a\u7528API\uff0c\u5b83\u63d0\u4f9b\u4e86\u4e00\u5957\u6807\u51c6\u7684API\u63a5\u53e3\uff0c\u53ef\u4ee5\u79fb\u690d\u5230\u5404\u79cd\u5404\u6837\u7684RTOS\u4e0a\uff0c\u4f7f\u5f97\u4e0a\u5c42\u7684\u8f6f\u4ef6\u3001\u4e2d\u95f4\u4ef6\u3001\u5e93\u4ee5\u53ca\u5176\u4ed6\u7ec4\u4ef6\u5728\u4e0d\u540c\u7684RTOS\u4e4b\u4e0a\u90fd\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u3002 \u8fd9\u5957API\u8868\u73b0\u4e3a\u4e24\u4e2a\u6587\u4ef6\uff1acmsis-os.h\u548ccmsis-os.c\uff0c\u5728TencentOS-tiny\u4e2d\u5982\u4e0b\u3002 \u57fa\u4e8eTencentOS-tiny\u7684CMSIS-RTOS API v1.02\u7248\u672c\u5b9e\u73b0\uff1a cmsis_os.h cmsis_os.c \u57fa\u4e8eTencentOS-tiny\u7684CMSIS-RTOS API v2.1.3\u7248\u672c\u5b9e\u73b0\uff1a cmsis_os2.h cmsis_os2.c CMSIS-RTOS API\u7684\u6574\u4f53\u67b6\u6784\u5982\u4e0b\u56fe\uff1a CMSIS-RTOS API\u5b98\u65b9\u53c2\u8003\u6587\u6863\u94fe\u63a5\uff1a https://www.keil.com/pack/doc/CMSIS/RTOS/html/index.html 2. CMSIS-RTOS API\u5217\u8868 \u4e0b\u9762\u5217\u51fa\u4e86 CMSIS-RTOS API v1.02 \u7248\u672c\u63d0\u4f9b\u7684\u6240\u6709API\u3002 CMSIS-RTOS \u6240\u6709API\u4f7f\u7528\u7684\u9519\u8bef\u7801\uff08cmsis-os.h\uff09\uff1a typedef enum { osOK = 0, ///< function completed; no error or event occurred. osEventSignal = 0x08, ///< function completed; signal event occurred. osEventMessage = 0x10, ///< function completed; message event occurred. osEventMail = 0x20, ///< function completed; mail event occurred. osEventTimeout = 0x40, ///< function completed; timeout occurred. osErrorParameter = 0x80, ///< parameter error: a mandatory parameter was missing or specified an incorrect object. osErrorResource = 0x81, ///< resource not available: a specified resource was not available. osErrorTimeoutResource = 0xC1, ///< resource not available within given time: a specified resource was not available within the timeout period. osErrorISR = 0x82, ///< not allowed in ISR context: the function cannot be called from interrupt service routines. osErrorISRRecursive = 0x83, ///< function called multiple times from ISR with same object. osErrorPriority = 0x84, ///< system cannot determine priority or thread has illegal priority. osErrorNoMemory = 0x85, ///< system is out of memory: it was impossible to allocate or reserve memory for the operation. osErrorValue = 0x86, ///< value of a parameter is out of range. osErrorOS = 0xFF, ///< unspecified RTOS error: run-time error but no other error message fits. os_status_reserved = 0x7FFFFFFF ///< prevent from enum down-size compiler optimization. } osStatus; CMSIS-RTOS API\u4e00\u4e9b\u53ef\u9009\u9879\u63a7\u5236\u662f\u5426\u5f00\u542f\uff08cmsis-os.h\uff09\uff1a #define osFeature_MainThread 1 ///< main thread 1=main can be thread, 0=not available #define osFeature_Pool 1 ///< Memory Pools: 1=available, 0=not available #define osFeature_MailQ 1 ///< Mail Queues: 1=available, 0=not available #define osFeature_MessageQ 1 ///< Message Queues: 1=available, 0=not available #define osFeature_Signals 0 ///< maximum number of Signal Flags available per thread #define osFeature_Semaphore 30 ///< maximum count for \\ref osSemaphoreCreate function #define osFeature_Wait 0 ///< osWait function: 1=available, 0=not available #define osFeature_SysTick 1 ///< osKernelSysTick functions: 1=available, 0=not available 2.1. \u5185\u6838\u4fe1\u606f\u548c\u63a7\u5236\uff08Kernel information and control\uff09 API \u63cf\u8ff0 osKernelInitialize \u521d\u59cb\u5316RTOS\u5185\u6838 osKernelStart \u542f\u52a8RTOS\u5185\u6838 osKernelRunning Query if the RTOS kernel is running osKernelSysTick (\u53ef\u9009) Get RTOS kernel system timer counter osKernelSysTickFrequency (\u53ef\u9009) RTOS kernel system timer frequency in Hz osKernelSysTickMicroSec (\u53ef\u9009) Convert microseconds value to RTOS kernel system timer value osKernelInitialize osStatus osKernelInitialize(void); \u8fd4\u56de\u503c\uff1astatus code osKernelStart osStatus osKernelStart(void); \u8fd4\u56de\u503c\uff1astatus code osKernelRunning int32_t osKernelRunning(void); \u8fd4\u56de\u503c\uff1a0\u8868\u793aRTOS\u672a\u542f\u52a8\uff0c1\u8868\u793aRTOS\u5df2\u7ecf\u542f\u52a8 osKernelSysTick uint32_t osKernelSysTick(void); \u8fd4\u56de\u503c\uff1aRTOS\u5185\u6838\u7cfb\u7edf\u5f53\u524d\u7684\u65f6\u95f4 2.2. \u7ebf\u7a0b\u7ba1\u7406\uff08Thread management\uff09 ## \u8fde\u63a5\u7b26\u7684\u4f5c\u7528\u662f\u8fde\u63a5\u4e24\u4e2a\u5b57\u7b26\u4e32\uff0c\u5408\u4e3a\u4e00\u4e2a\u5b57\u7b26\u4e32\u3002 CMSIS-RTOS API \u5b58\u653e\u7ebf\u7a0b\u53c2\u6570\u7ba1\u7406\u7684\u7ed3\u6784\u4f53\u5982\u4e0b\uff1a typedef struct os_thread_def { char *name; ///< Thread name os_pthread pthread; ///< start address of thread function osPriority tpriority; ///< initial thread priority uint32_t instances; ///< maximum number of instances of that thread function k_stack_t *stackbase; ///< base address of task uint32_t stacksize; ///< stack size requirements in bytes; 0 is default stack size k_timeslice_t timeslice; ///< timeslice k_task_t *task; } osThreadDef_t; CMSIS-RTOS API \u5b9a\u4e49\u7ebf\u7a0b\u7684\u5b8f\u5982\u4e0b\uff1a #define osThreadDef(name, priority, instances, stacksz) \\ k_task_t task_handler_##name; \\ k_stack_t task_stack_##name[(stacksz)]; \\ const osThreadDef_t os_thread_def_##name = \\ { #name, (os_pthread)(name), (osPriority)(priority), (instances), \\ (&((task_stack_##name)[0])), (stacksz), ((k_timeslice_t)0u), (&(task_handler_##name)) } \u5b8f\u5b9a\u4e49\u4e2d\u7684 instances \u8868\u793a\u57fa\u4e8e\u6b64\u4efb\u52a1\u53c2\u6570\uff0c\u521b\u5efa\u51fa\u51e0\u4e2a\u4efb\u52a1\u5b9e\u4f8b\uff0c\u6bd4\u5982instances\u4e3a2\uff0c\u5219\u4f1a\u521b\u5efa\u51fa\u4e24\u4e2a\u4efb\u52a1\u3002 CMSIS-RTOS API\u5b9a\u4e49\u7684\u83b7\u53d6\u7ebf\u7a0b\u53c2\u6570\u7ed3\u6784\u4f53\u7684\u5b8f\u5982\u4e0b\uff1a #define osThread(name) \\ &os_thread_def_##name \u7ba1\u7406\u7ebf\u7a0b\u53c2\u6570\u7684API\u5982\u4e0b\uff1a API \u63cf\u8ff0 osThreadCreate \u521b\u5efa\u7ebf\u7a0b\u5e76\u5f00\u59cb\u6267\u884c osThreadTerminate \u505c\u6b62\u7ebf\u7a0b\u6267\u884c osThreadYield \u7ebf\u7a0b\u4e3b\u52a8\u8ba9\u51fa osThreadGetID \u83b7\u53d6\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7ebf\u7a0b\u7684ID osThreadSetPriority \u6539\u53d8\u7ebf\u7a0b\u4f18\u5148\u7ea7 osThreadGetPriority \u83b7\u53d6\u7ebf\u7a0b\u4f18\u5148\u7ea7 osThreadCreate osThreadId osThreadCreate(const osThreadDef_t *thread_def, void *argument); \u5176\u4e2dosThreadId\u88ab\u5b9a\u4e49\u4e3ak_task_t\u6307\u9488\u7c7b\u578b\uff1a typedef k_task_t *osThreadId; \u8fd4\u56de\u503c\uff1aTencentOS-tiny\u4e2d\u7684\u4efb\u52a1\u63a7\u5236\u5757\u7c7b\u578b\u6307\u9488\u3002 osThreadTerminate osStatus osThreadTerminate(osThreadId thread_id); \u8fd4\u56de\u503c\uff1aosStatus osThreadYield osStatus osThreadYield(void); \u8fd4\u56de\u503c\uff1aosStatus osThreadGetID osThreadId osThreadGetId(void); osThreadSetPriority osStatus osThreadSetPriority(osThreadId thread_id, osPriority priority); osThreadGetPriority osPriority osThreadGetPriority(osThreadId thread_id); \u4f7f\u7528\u65f6\u9700\u8981\u7279\u522b\u6ce8\u610f\uff0c\u5728TencentOS-tiny\u4e2d\uff0c\u8c03\u7528CMSIS-RTOS API\u63d0\u4f9b\u7684\u4f18\u5148\u7ea7\u9009\u9879\u8bbe\u7f6e\u4e4b\u540e\uff0c\u5b9e\u9645\u8bbe\u7f6e\u7684\u4efb\u52a1\u503c\u662f\u4e0d\u540c\u7684\u3002 CMSIS-RTOS API\u63d0\u4f9b\u7684\u7ebf\u7a0b\u4f18\u5148\u7ea7\u5b8f\u5b9a\u4e49\u5982\u4e0b\uff1a typedef enum { osPriorityIdle = -3, ///< priority: idle (lowest) osPriorityLow = -2, ///< priority: low osPriorityBelowNormal = -1, ///< priority: below normal osPriorityNormal = 0, ///< priority: normal (default) osPriorityAboveNormal = +1, ///< priority: above normal osPriorityHigh = +2, ///< priority: high osPriorityRealtime = +3, ///< priority: realtime (highest) osPriorityError = 0x84 ///< system cannot determine priority or thread has illegal priority } osPriority; \u5728TencentOS-tiny\u4e2d\u5b9e\u73b0\u7684\u65f6\u5019\u8fdb\u884c\u4e86\u8f6c\u5316\uff1a static k_prio_t priority_cmsis2knl(osPriority prio) { if (prio == osPriorityError) { return K_TASK_PRIO_INVALID; } return (k_prio_t)(3 - prio); } static osPriority priority_knl2cmsis(k_prio_t prio) { return (osPriority)(3 - prio); } \u6bd4\u5982\u521b\u5efa\u7ebf\u7a0b\u65f6\u8bbe\u7f6e\u4e3a osPriorityNormal=0\uff0c\u5219 \u5b9e\u9645\u8bbe\u7f6e\u7684\u4efb\u52a1\u4f18\u5148\u7ea7\u4e3a3 \u3002 2.3. \u901a\u7528\u7b49\u5f85\u51fd\u6570 CMSIS-RTOS\u63d0\u4f9b\u7684\u7b49\u5f85\u51fd\u6570API\u5982\u4e0b\uff1a API \u63cf\u8ff0 osDelay \u7b49\u5f85\u6307\u5b9a\u7684\u65f6\u95f4 osWait\uff08\u53ef\u9009\uff09 \u7b49\u5f85\u4fe1\u53f7\u3001\u6d88\u606f\u3001\u90ae\u7bb1\u7684\u67d0\u4e2a\u4e8b\u4ef6 osDelay osStatus osDelay(uint32_t millisec); \u8fd4\u56de\u503c\uff1aosStatus\u3002 2.4. \u8f6f\u4ef6\u5b9a\u65f6\u5668\u7ba1\u7406 CMSIS-RTOS API\u63d0\u4f9b\u7684\u5b58\u50a8\u5b9a\u65f6\u5668\u53c2\u6570\u7684\u7ed3\u6784\u4f53\u5982\u4e0b\uff1a typedef struct os_timer_def { os_ptimer cb; ///< start address of a timer function k_timer_t *timer; } osTimerDef_t; CMSIS-RTOS API\u63d0\u4f9b\u7684\u5b9a\u4e49\u4e00\u4e2a\u8f6f\u4ef6\u5b9a\u65f6\u5668\u7684\u5b8f\u5b9a\u4e49\u5982\u4e0b\uff1a #define osTimerDef(name, function) \\ k_timer_t timer_handler_##name; \\ const osTimerDef_t os_timer_def_##name = \\ { (os_ptimer)(function), (&(timer_handler_##name)) } CMSIS-RTOS API\u5b9a\u4e49\u7684\u83b7\u53d6\u8f6f\u4ef6\u5b9a\u65f6\u5668\u53c2\u6570\u7ed3\u6784\u4f53\u7684\u5b8f\u5982\u4e0b\uff1a #define osTimer(name) \\ &os_timer_def_##name CMSIS-RTOS API\u63d0\u4f9b\u7684\u8f6f\u4ef6\u5b9a\u65f6\u5668\u7ba1\u7406API\u5982\u4e0b\uff1a API \u63cf\u8ff0 osTimerCreate \u521b\u5efa\u4e00\u4e2a\u8f6f\u4ef6\u5b9a\u65f6\u5668 osTimerStart \u542f\u52a8\u8f6f\u4ef6\u5b9a\u65f6\u5668 osTimerStop \u505c\u6b62\u8f6f\u4ef6\u5b9a\u65f6\u5668 osTimerDelete \u5220\u9664\u8f6f\u4ef6\u5b9a\u65f6\u5668 osTimerCreate osTimerId osTimerCreate(const osTimerDef_t *timer_def, os_timer_type type, void *argument); \u5176\u4e2dosTimerId\u88ab\u5b9a\u4e49\u4e3ak_timer_t\u6307\u9488\u7c7b\u578b\uff1a typedef k_timer_t *osTimerId; type\u53c2\u6570\u4e3a os_timer_type \u7c7b\u578b\uff0c\u8868\u793a\u8f6f\u4ef6\u5b9a\u65f6\u5668\u7684\u7c7b\u578b\u4e3a\u5355\u6b21\u89e6\u53d1\u6216\u8005\u5468\u671f\u89e6\u53d1\uff1a typedef enum { osTimerOnce = 0, ///< one-shot timer osTimerPeriodic = 1 ///< repeating timer } os_timer_type; osTimerStart osStatus osTimerStart(osTimerId timer_id, uint32_t millisec); \u8fd4\u56de\u503c\uff1aosStatus\u3002 osTimerStop osStatus osTimerStop(osTimerId timer_id) \u8fd4\u56de\u503c\uff1aosStatus\u3002 osTimerDelete osStatus osTimerDelete(osTimerId timer_id); \u8fd4\u56de\u503c\uff1aosStatus\u3002 2.5. \u4fe1\u53f7\u91cf\u7ba1\u7406 CMSIS-RTOS API\u63d0\u4f9b\u7684\u5b58\u50a8\u4fe1\u53f7\u91cf\u53c2\u6570\u7684\u7ed3\u6784\u4f53\u5982\u4e0b\uff1a typedef struct os_semaphore_def { uint32_t dummy; ///< dummy value. k_sem_t *sem; } osSemaphoreDef_t; CMSIS-RTOS API\u63d0\u4f9b\u7684\u5b9a\u4e49\u4e00\u4e2a\u4fe1\u53f7\u91cf\u7684\u5b8f\u5b9a\u4e49\u5982\u4e0b\uff1a #define osSemaphoreDef(name) \\ k_sem_t sem_handler_##name; \\ const osSemaphoreDef_t os_semaphore_def_##name = { 0, (&(sem_handler_##name)) } CMSIS-RTOS API\u5b9a\u4e49\u7684\u83b7\u53d6\u4fe1\u53f7\u91cf\u53c2\u6570\u7ed3\u6784\u4f53\u7684\u5b8f\u5982\u4e0b\uff1a #define osSemaphore(name) \\ &os_semaphore_def_##name CMSIS-RTOS API\u63d0\u4f9b\u7684\u4fe1\u53f7\u91cf\u7ba1\u7406API\u5982\u4e0b\uff1a API \u63cf\u8ff0 osSemaphoreCreate \u521b\u5efa\u4e00\u4e2a\u4fe1\u53f7\u91cf osSemaphoreWait \u7b49\u5f85\u4fe1\u53f7\u91cf osSemaphoreRelease \u91ca\u653e\u4fe1\u53f7\u91cf osSemaphoreDelete \u5220\u9664\u4fe1\u53f7\u91cf osSemaphoreCreate osSemaphoreId osSemaphoreCreate(const osSemaphoreDef_t *semaphore_def, int32_t count); \u5176\u4e2d osSemaphoreId \u88ab\u5b9a\u4e49\u4e3ak_sem_t\u6307\u9488\u7c7b\u578b\uff1a typedef k_sem_t *osSemaphoreId; osSemaphoreWait int32_t osSemaphoreWait(osSemaphoreId semaphore_id, uint32_t millisec); \u8fd4\u56de\u503c\uff1aint32_t \uff0c\u6b63\u5e38\u8fd4\u56de\u5f53\u524dcount\u6570\uff0c\u5931\u8d25\u8fd4\u56de-1\u3002 \u5982\u679c\u9700\u8981\u963b\u585e\u5ef6\u65f6\uff0c\u53c2\u6570\u5e94\u8be5\u8bbe\u7f6e\u4e3aCMSIS-RTOS API\u63d0\u4f9b\u7684\u5b8f\u5b9a\u4e49 osWaitForever \uff1a #define osWaitForever 0xFFFFFFFF ///< wait forever timeout value osSemaphoreRelease osStatus osSemaphoreRelease(osSemaphoreId semaphore_id); \u8fd4\u56de\u503c\uff1aosStatus\u3002 osSemaphoreDelete osStatus osSemaphoreDelete(osSemaphoreId semaphore_id); \u8fd4\u56de\u503c\uff1aosStatus\u3002 2.6. \u4e92\u65a5\u9501\u7ba1\u7406 CMSIS-RTOS API\u63d0\u4f9b\u7684\u5b58\u50a8\u4e92\u65a5\u9501\u53c2\u6570\u7684\u7ed3\u6784\u4f53\u5982\u4e0b\uff1a typedef struct os_mutex_def { uint32_t dummy; ///< dummy value. k_mutex_t *mutex; } osMutexDef_t; CMSIS-RTOS API\u63d0\u4f9b\u7684\u5b9a\u4e49\u4e00\u4e2a\u4e92\u65a5\u9501\u7684\u5b8f\u5b9a\u4e49\u5982\u4e0b\uff1a #define osMutexDef(name) \\ k_mutex_t mutex_handler_##name; \\ const osMutexDef_t os_mutex_def_##name = { 0, (&(mutex_handler_##name)) } CMSIS-RTOS API\u5b9a\u4e49\u7684\u83b7\u53d6\u4e92\u65a5\u9501\u53c2\u6570\u7ed3\u6784\u4f53\u7684\u5b8f\u5982\u4e0b\uff1a #define osMutex(name) \\ &os_mutex_def_##name CMSIS-RTOS API\u63d0\u4f9b\u7684\u4e92\u65a5\u9501\u7ba1\u7406API\u5982\u4e0b\uff1a API \u63cf\u8ff0 osMutexCreate \u521b\u5efa\u4e00\u4e2a\u4e92\u65a5\u9501 osMutexWait \u7b49\u5f85\u83b7\u53d6\u4e92\u65a5\u9501 osMutexRelease \u91ca\u653e\u4e92\u65a5\u9501 osMutexDelete \u5220\u9664\u4e92\u65a5\u9501 osMutexCreate osMutexId osMutexCreate(const osMutexDef_t *mutex_def); \u5176\u4e2d osMutexId \u88ab\u5b9a\u4e49\u4e3ak_mutex_t\u6307\u9488\u7c7b\u578b\uff1a typedef k_mutex_t *osMutexId; osMutexWait osStatus osMutexWait(osMutexId mutex_id, uint32_t millisec); \u8fd4\u56de\u503c\uff1aosStatus \u3002 \u5982\u679c\u9700\u8981\u963b\u585e\u5ef6\u65f6\uff0c\u53c2\u6570\u5e94\u8be5\u8bbe\u7f6e\u4e3aCMSIS-RTOS API\u63d0\u4f9b\u7684\u5b8f\u5b9a\u4e49 osWaitForever \uff1a #define osWaitForever 0xFFFFFFFF ///< wait forever timeout value osMutexRelease osStatus osMutexRelease(osMutexId mutex_id); \u8fd4\u56de\u503c\uff1aosStatus\u3002 osMutexDelete osStatus osMutexDelete(osMutexId mutex_id); \u8fd4\u56de\u503c\uff1aosStatus\u3002 2.7. \u9759\u6001\u5185\u5b58\u6c60\u7ba1\u7406 CMSIS-RTOS API\u63d0\u4f9b\u7684\u5b58\u50a8\u9759\u6001\u5185\u5b58\u6c60\u53c2\u6570\u7684\u7ed3\u6784\u4f53\u5982\u4e0b\uff1a typedef struct os_pool_def { uint32_t pool_sz; ///< number of items (elements) in the pool uint32_t item_sz; ///< size of an item void *pool; ///< pointer to memory for pool k_mmblk_pool_t *mmblk_pool; ///< memory blk pool handler } osPoolDef_t; CMSIS-RTOS API\u63d0\u4f9b\u7684\u5b9a\u4e49\u4e00\u4e2a\u4e92\u65a5\u9501\u7684\u5b8f\u5b9a\u4e49\u5982\u4e0b\uff1a #define osPoolDef(name, no, type) \\ k_mmblk_pool_t mmblk_pool_handler_##name; \\ uint8_t mmblk_pool_buf_##name[(no) * sizeof(type)]; \\ const osPoolDef_t os_pool_def_##name = \\ { (no), sizeof(type), (&((mmblk_pool_buf_##name)[0])), (&(mmblk_pool_handler_##name)) } CMSIS-RTOS API\u5b9a\u4e49\u7684\u83b7\u53d6\u4e92\u65a5\u9501\u53c2\u6570\u7ed3\u6784\u4f53\u7684\u5b8f\u5982\u4e0b\uff1a #define osPool(name) \\ &os_pool_def_##name CMSIS-RTOS API\u63d0\u4f9b\u7684\u4e92\u65a5\u9501\u7ba1\u7406API\u5982\u4e0b\uff1a API \u63cf\u8ff0 osPoolCreate \u521b\u5efa\u4e00\u5757\u56fa\u5b9a\u5927\u5c0f\u7684\u9759\u6001\u5185\u5b58\u6c60 osPoolAlloc \u7533\u8bf7\u5206\u914d\u5185\u5b58 osPoolCAlloc \u7533\u8bf7\u5206\u914d\u4e00\u5757\u5185\u5b58\u5e76\u5168\u90e8\u521d\u59cb\u5316\u4e3a0 osPoolFree \u7533\u8bf7\u56de\u6536\u5185\u5b58 osPoolCreate osPoolId osPoolCreate(const osPoolDef_t *pool_def); \u5176\u4e2d osPoolId \u88ab\u5b9a\u4e49\u4e3a k_mmblk_pool_t \u6307\u9488\u7c7b\u578b\uff1a typedef k_mmblk_pool_t *osPoolId; osPoolAlloc void *osPoolAlloc(osPoolId pool_id); osPoolCAlloc void *osPoolCAlloc(osPoolId pool_id); osPoolFree osStatus osPoolFree(osPoolId pool_id, void *block); \u8fd4\u56de\u503c\uff1aosStatus\u3002 2.8. \u6d88\u606f\u961f\u5217\u7ba1\u7406 CMSIS-RTOS API\u63d0\u4f9b\u7684\u5b58\u50a8\u6d88\u606f\u961f\u5217\u53c2\u6570\u7684\u7ed3\u6784\u4f53\u5982\u4e0b\uff1a typedef struct os_messageQ_def { uint32_t queue_sz; ///< number of elements in the queue uint32_t item_sz; ///< size of an item void *pool; ///< memory array for messages k_msg_q_t *queue; ///< queue handler } osMessageQDef_t; CMSIS-RTOS API\u63d0\u4f9b\u7684\u5b9a\u4e49\u4e00\u4e2a\u6d88\u606f\u961f\u5217\u7684\u5b8f\u5b9a\u4e49\u5982\u4e0b\uff1a #define osMessageQDef(name, queue_sz, type) \\ k_msg_q_t msg_q_handler_##name; \\ const osMessageQDef_t os_messageQ_def_##name = \\ { (queue_sz), sizeof(type), NULL, (&(msg_q_handler_##name)) } CMSIS-RTOS API\u5b9a\u4e49\u7684\u83b7\u53d6\u6d88\u606f\u961f\u5217\u53c2\u6570\u7ed3\u6784\u4f53\u7684\u5b8f\u5982\u4e0b\uff1a #define osMessageQ(name) \\ &os_messageQ_def_##name CMSIS-RTOS API\u63d0\u4f9b\u7684\u6d88\u606f\u961f\u5217\u7ba1\u7406API\u5982\u4e0b\uff1a API \u63cf\u8ff0 osMessageCreate \u521d\u59cb\u5316\u4e00\u4e2a\u6d88\u606f\u961f\u5217 osMessagePut \u5411\u6d88\u606f\u961f\u5217\u4e2d\u52a0\u5165\u6570\u636e osMessageGet \u4ece\u6d88\u606f\u961f\u5217\u4e2d\u53d6\u51fa\u6570\u636e osMessageCreate osMessageQId osMessageCreate(const osMessageQDef_t *queue_def, osThreadId thread_id); \u5176\u4e2d osMessageQId \u88ab\u5b9a\u4e49\u4e3a k_msg_q_t \u6307\u9488\u7c7b\u578b\uff1a typedef k_msg_q_t *osMessageQId; osMessagePut osStatus osMessagePut(osMessageQId queue_id, uint32_t info, uint32_t millisec); \u8fd4\u56de\u503c\uff1aosStatus \u3002 \u56e0\u4e3aTencentOS-tiny\u4e2d\u6d88\u606f\u961f\u5217\u5b9e\u73b0\u673a\u5236\u7684\u4e0d\u540c\uff0c\u6b64API\u4e2d\u7684 millisec \u53c2\u6570\u672a\u7528\u5230\u3002 osMessageGet osEvent osMessageGet(osMessageQId queue_id, uint32_t millisec); \u8fd4\u56de\u503c\uff1aosEvent \uff0c\u5176\u4e2d\u5305\u542b\u4e86\u4e8b\u4ef6\u4fe1\u606f\u548c\u9519\u8bef\u7801\uff0c\u4ee5\u53ca\u6d88\u606f\u961f\u5217\u6536\u5230\u7684\u503c\u3002 \u5982\u679c\u9700\u8981\u963b\u585e\u5ef6\u65f6\uff0c\u53c2\u6570\u5e94\u8be5\u8bbe\u7f6e\u4e3aCMSIS-RTOS API\u63d0\u4f9b\u7684\u5b8f\u5b9a\u4e49 osWaitForever \uff1a #define osWaitForever 0xFFFFFFFF ///< wait forever timeout value 3. \u4f7f\u7528\u793a\u4f8b 3.1. \u4efb\u52a1\u521b\u5efa\u793a\u4f8b #include <cmsis_os.h> void task1_entry(void *arg) { while(1) { printf(\"task1 is running...\\r\\n\"); osDelay(1000); } } osThreadDef(task1_entry, osPriorityNormal, 1, 512); void task2_entry(void *arg) { while(1) { printf(\"task2 is running...\\r\\n\"); osDelay(1000); } } osThreadDef(task2_entry, osPriorityNormal, 1, 512); void application_entry(void *arg) { osThreadCreate(osThread(task1_entry), NULL); osThreadCreate(osThread(task2_entry), NULL); return; } \u4efb\u52a1\u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\uff1a task1 is running... task2 is running... task1 is running... task2 is running... task1 is running... task2 is running... 3.2. \u8f6f\u4ef6\u5b9a\u65f6\u5668\u4f7f\u7528\u793a\u4f8b #include <cmsis_os.h> void timer1_cb(void *arg) { printf(\"timer1 is timeout!\\r\\n\"); } void timer2_cb(void *arg) { printf(\"timer2 is timeout!\\r\\n\"); } osTimerDef(timer1, timer1_cb); osTimerDef(timer2, timer2_cb); void application_entry(void *arg) { osTimerId timer1; osTimerId timer2; timer1 = osTimerCreate(osTimer(timer1), osTimerOnce, NULL); timer2 = osTimerCreate(osTimer(timer2), osTimerPeriodic, NULL); osTimerStart(timer1, 5000); osTimerStart(timer2, 1000); return; } \u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\uff1a timer2 is timeout! timer2 is timeout! timer2 is timeout! timer2 is timeout! timer1 is timeout! timer2 is timeout! timer2 is timeout! timer2 is timeout! timer2 is timeout! 3.3. \u4fe1\u53f7\u91cf\u4f7f\u7528\u793a\u4f8b #include <cmsis_os.h> osSemaphoreId sync_sem_id; osSemaphoreDef(sync_sem); void task1_entry(void *arg) { while(1) { printf(\"task1 is waiting sem forever...\\r\\n\"); osSemaphoreWait(sync_sem_id, osWaitForever); printf(\"task1 get sem!\\r\\n\"); } } osThreadDef(task1_entry, osPriorityNormal, 1, 512); void task2_entry(void *arg) { while(1) { printf(\"task2 will release a sem...\\r\\n\"); osSemaphoreRelease(sync_sem_id); osDelay(1000); } } osThreadDef(task2_entry, osPriorityNormal, 1, 512); void application_entry(void *arg) { sync_sem_id = osSemaphoreCreate(osSemaphore(sync_sem), 0); osThreadCreate(osThread(task1_entry), NULL); osThreadCreate(osThread(task2_entry), NULL); return; } \u8fd0\u884c\u7ed3\u679c\u4e3a\uff1a task1 is waiting sem forever... task1 get sem! task1 is waiting sem forever... task2 will release a sem... task1 get sem! task1 is waiting sem forever... task2 will release a sem... task1 get sem! task1 is waiting sem forever... task2 will release a sem... task1 get sem! task1 is waiting sem forever... task2 will release a sem... task1 get sem! task1 is waiting sem forever... 3.4. \u4e92\u65a5\u9501\u4f7f\u7528\u793a\u4f8b #include <cmsis_os.h> osMutexId sync_mutex_id; osMutexDef(sync_mutex); void task1_entry(void *arg) { while(1) { osMutexWait(sync_mutex_id, osWaitForever); printf(\"task1 get mutex,doing sth...\\r\\n\"); HAL_Delay(1000); //\u6b7b\u5faa\u73af\u5360\u7528CPU printf(\"task1 finish do sth!\\r\\n\"); osMutexRelease(sync_mutex_id); osDelay(1000); } } osThreadDef(task1_entry, osPriorityHigh, 1, 512); void task2_entry(void *arg) { while(1) { osMutexWait(sync_mutex_id, osWaitForever); printf(\"task2 get mutex,doing sth...\\r\\n\"); HAL_Delay(2000); //\u6b7b\u5faa\u73af\u5360\u7528CPU printf(\"task2 finish do sth!\\r\\n\"); osMutexRelease(sync_mutex_id); osDelay(1000); } } osThreadDef(task2_entry, osPriorityNormal, 1, 512); void application_entry(void *arg) { sync_mutex_id = osMutexCreate(osMutex(sync_mutex)); osThreadCreate(osThread(task1_entry), NULL); osThreadCreate(osThread(task2_entry), NULL); return; } \u8fd0\u884c\u7ed3\u679c\u4e3a\uff1a task1 get mutex,doing sth... task1 finish do sth! task2 get mutex,doing sth... task2 finish do sth! task1 get mutex,doing sth... task1 finish do sth! task1 get mutex,doing sth... task1 finish do sth! task2 get mutex,doing sth... 3.5. \u52a8\u6001\u5185\u5b58\u4f7f\u7528\u793a\u4f8b #include <cmsis_os.h> typedef struct blk_st { int id; char* payload; } blk_t; #define MMBLK_BLK_NUM 10 osPoolDef (MemPool, MMBLK_BLK_NUM, blk_t); osPoolId mem_pool_id; void task1_entry(void *arg) { blk_t *ptr = NULL; osStatus err; /* \u6253\u5370\u51fa\u4e00\u4e2a\u5757\u7684\u5927\u5c0f */ printf(\"block size is %d bytes\\r\\n\", sizeof(blk_t)); /* \u7533\u8bf7\u4e00\u4e2a\u5757 */ ptr = osPoolAlloc(mem_pool_id); if (ptr == NULL) { printf(\"a mmblk alloc fail\\r\\n\"); return; } else { printf(\"a mmblk alloc success\\r\\n\"); } /* \u4f7f\u7528\u8be5\u5757 */ ptr->id = 1; ptr->payload = \"hello\"; printf(\"mmblk id:%d payload:%s\\r\\n\", ptr->id, ptr->payload); /* \u4f7f\u7528\u5b8c\u6bd5\u4e4b\u540e\u91ca\u653e */ err = osPoolFree(mem_pool_id, ptr); if (err != osOK) { printf(\"a mmblk free fail, err = %d\\r\\n\", err); return; } else { printf(\"a mmblk free success\\r\\n\"); } while (1) { tos_task_delay(1000); } } #define STK_SIZE_TASK1 1024 osThreadDef(task1_entry, osPriorityNormal, 1, STK_SIZE_TASK1); void application_entry(void *arg) { //\u521d\u59cb\u5316\u9759\u6001\u5185\u5b58\u6c60 mem_pool_id = osPoolCreate(osPool(MemPool)); if (mem_pool_id == NULL) { printf(\"mmblk pool create fail\\r\\n\"); return; } else { printf(\"mmblk pool create success\\r\\n\"); } //\u521b\u5efa\u4efb\u52a1 osThreadCreate(osThread(task1_entry), NULL); return; } \u8fd0\u884c\u7ed3\u679c\u4e3a\uff1a mmblk pool create success block size is 8 bytes a mmblk alloc success mmblk id:1 payload:hello a mmblk free success 3.6. \u6d88\u606f\u961f\u5217\u4f7f\u7528\u793a\u4f8b #include <cmsis_os.h> #define STK_SIZE_TASK_RECEIVER 512 #define STK_SIZE_TASK_SENDER 512 #define MESSAGE_MAX 10 osMessageQId msg_q_id; osMessageQDef(msg_q,MESSAGE_MAX,uint32_t); void task_receiver_entry(void *arg) { osEvent event; osStatus ret; uint32_t value; while (1) { event = osMessageGet(msg_q_id, osWaitForever); ret = event.status; if (ret == osOK) { value = event.value.v; printf(\"receiver: msg incoming[%s]\\r\\n\", (char*)value); } } } osThreadDef(task_receiver_entry, osPriorityNormal, 1, STK_SIZE_TASK_RECEIVER); void task_sender_entry(void *arg) { char *msg_prio_0 = \"msg 0\"; char *msg_prio_1 = \"msg 1\"; char *msg_prio_2 = \"msg 2\"; printf(\"sender: post a messgae:[%s]\\r\\n\", msg_prio_2); osMessagePut(msg_q_id,(uint32_t)msg_prio_2,0); printf(\"sender: post a messgae:[%s]\\r\\n\", msg_prio_1); osMessagePut(msg_q_id,(uint32_t)msg_prio_1,0); printf(\"sender: post a messgae:[%s]\\r\\n\", msg_prio_0); osMessagePut(msg_q_id,(uint32_t)msg_prio_0,0); } osThreadDef(task_sender_entry, osPriorityNormal, 1, STK_SIZE_TASK_SENDER); void application_entry(void *arg) { msg_q_id = osMessageCreate(osMessageQ(msg_q),NULL); osThreadCreate(osThread(task_receiver_entry), NULL); osThreadCreate(osThread(task_sender_entry), NULL); return; } \u8fd0\u884c\u7ed3\u679c\u4e3a\uff1a sender: post a messgae:[msg 2] sender: post a messgae:[msg 1] sender: post a messgae:[msg 0] receiver: msg incoming[msg 2] receiver: msg incoming[msg 1] receiver: msg incoming[msg 0]","title":"23.CMSIS_RTOS_API_Use_Guide"},{"location":"23.CMSIS_RTOS_API_Use_Guide/#1-cmsis-rtos-api","text":"CMSIS-RTOS\u662f\u7528\u4e8e\u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf\uff08RTOS\uff09\u7684\u4e00\u5c42\u901a\u7528API\uff0c\u5b83\u63d0\u4f9b\u4e86\u4e00\u5957\u6807\u51c6\u7684API\u63a5\u53e3\uff0c\u53ef\u4ee5\u79fb\u690d\u5230\u5404\u79cd\u5404\u6837\u7684RTOS\u4e0a\uff0c\u4f7f\u5f97\u4e0a\u5c42\u7684\u8f6f\u4ef6\u3001\u4e2d\u95f4\u4ef6\u3001\u5e93\u4ee5\u53ca\u5176\u4ed6\u7ec4\u4ef6\u5728\u4e0d\u540c\u7684RTOS\u4e4b\u4e0a\u90fd\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u3002 \u8fd9\u5957API\u8868\u73b0\u4e3a\u4e24\u4e2a\u6587\u4ef6\uff1acmsis-os.h\u548ccmsis-os.c\uff0c\u5728TencentOS-tiny\u4e2d\u5982\u4e0b\u3002 \u57fa\u4e8eTencentOS-tiny\u7684CMSIS-RTOS API v1.02\u7248\u672c\u5b9e\u73b0\uff1a cmsis_os.h cmsis_os.c \u57fa\u4e8eTencentOS-tiny\u7684CMSIS-RTOS API v2.1.3\u7248\u672c\u5b9e\u73b0\uff1a cmsis_os2.h cmsis_os2.c CMSIS-RTOS API\u7684\u6574\u4f53\u67b6\u6784\u5982\u4e0b\u56fe\uff1a CMSIS-RTOS API\u5b98\u65b9\u53c2\u8003\u6587\u6863\u94fe\u63a5\uff1a https://www.keil.com/pack/doc/CMSIS/RTOS/html/index.html","title":"1. CMSIS-RTOS API\u662f\u4ec0\u4e48"},{"location":"23.CMSIS_RTOS_API_Use_Guide/#2-cmsis-rtos-api","text":"\u4e0b\u9762\u5217\u51fa\u4e86 CMSIS-RTOS API v1.02 \u7248\u672c\u63d0\u4f9b\u7684\u6240\u6709API\u3002 CMSIS-RTOS \u6240\u6709API\u4f7f\u7528\u7684\u9519\u8bef\u7801\uff08cmsis-os.h\uff09\uff1a typedef enum { osOK = 0, ///< function completed; no error or event occurred. osEventSignal = 0x08, ///< function completed; signal event occurred. osEventMessage = 0x10, ///< function completed; message event occurred. osEventMail = 0x20, ///< function completed; mail event occurred. osEventTimeout = 0x40, ///< function completed; timeout occurred. osErrorParameter = 0x80, ///< parameter error: a mandatory parameter was missing or specified an incorrect object. osErrorResource = 0x81, ///< resource not available: a specified resource was not available. osErrorTimeoutResource = 0xC1, ///< resource not available within given time: a specified resource was not available within the timeout period. osErrorISR = 0x82, ///< not allowed in ISR context: the function cannot be called from interrupt service routines. osErrorISRRecursive = 0x83, ///< function called multiple times from ISR with same object. osErrorPriority = 0x84, ///< system cannot determine priority or thread has illegal priority. osErrorNoMemory = 0x85, ///< system is out of memory: it was impossible to allocate or reserve memory for the operation. osErrorValue = 0x86, ///< value of a parameter is out of range. osErrorOS = 0xFF, ///< unspecified RTOS error: run-time error but no other error message fits. os_status_reserved = 0x7FFFFFFF ///< prevent from enum down-size compiler optimization. } osStatus; CMSIS-RTOS API\u4e00\u4e9b\u53ef\u9009\u9879\u63a7\u5236\u662f\u5426\u5f00\u542f\uff08cmsis-os.h\uff09\uff1a #define osFeature_MainThread 1 ///< main thread 1=main can be thread, 0=not available #define osFeature_Pool 1 ///< Memory Pools: 1=available, 0=not available #define osFeature_MailQ 1 ///< Mail Queues: 1=available, 0=not available #define osFeature_MessageQ 1 ///< Message Queues: 1=available, 0=not available #define osFeature_Signals 0 ///< maximum number of Signal Flags available per thread #define osFeature_Semaphore 30 ///< maximum count for \\ref osSemaphoreCreate function #define osFeature_Wait 0 ///< osWait function: 1=available, 0=not available #define osFeature_SysTick 1 ///< osKernelSysTick functions: 1=available, 0=not available","title":"2. CMSIS-RTOS API\u5217\u8868"},{"location":"23.CMSIS_RTOS_API_Use_Guide/#21-kernel-information-and-control","text":"API \u63cf\u8ff0 osKernelInitialize \u521d\u59cb\u5316RTOS\u5185\u6838 osKernelStart \u542f\u52a8RTOS\u5185\u6838 osKernelRunning Query if the RTOS kernel is running osKernelSysTick (\u53ef\u9009) Get RTOS kernel system timer counter osKernelSysTickFrequency (\u53ef\u9009) RTOS kernel system timer frequency in Hz osKernelSysTickMicroSec (\u53ef\u9009) Convert microseconds value to RTOS kernel system timer value osKernelInitialize osStatus osKernelInitialize(void); \u8fd4\u56de\u503c\uff1astatus code osKernelStart osStatus osKernelStart(void); \u8fd4\u56de\u503c\uff1astatus code osKernelRunning int32_t osKernelRunning(void); \u8fd4\u56de\u503c\uff1a0\u8868\u793aRTOS\u672a\u542f\u52a8\uff0c1\u8868\u793aRTOS\u5df2\u7ecf\u542f\u52a8 osKernelSysTick uint32_t osKernelSysTick(void); \u8fd4\u56de\u503c\uff1aRTOS\u5185\u6838\u7cfb\u7edf\u5f53\u524d\u7684\u65f6\u95f4","title":"2.1. \u5185\u6838\u4fe1\u606f\u548c\u63a7\u5236\uff08Kernel information and control\uff09"},{"location":"23.CMSIS_RTOS_API_Use_Guide/#22-thread-management","text":"## \u8fde\u63a5\u7b26\u7684\u4f5c\u7528\u662f\u8fde\u63a5\u4e24\u4e2a\u5b57\u7b26\u4e32\uff0c\u5408\u4e3a\u4e00\u4e2a\u5b57\u7b26\u4e32\u3002 CMSIS-RTOS API \u5b58\u653e\u7ebf\u7a0b\u53c2\u6570\u7ba1\u7406\u7684\u7ed3\u6784\u4f53\u5982\u4e0b\uff1a typedef struct os_thread_def { char *name; ///< Thread name os_pthread pthread; ///< start address of thread function osPriority tpriority; ///< initial thread priority uint32_t instances; ///< maximum number of instances of that thread function k_stack_t *stackbase; ///< base address of task uint32_t stacksize; ///< stack size requirements in bytes; 0 is default stack size k_timeslice_t timeslice; ///< timeslice k_task_t *task; } osThreadDef_t; CMSIS-RTOS API \u5b9a\u4e49\u7ebf\u7a0b\u7684\u5b8f\u5982\u4e0b\uff1a #define osThreadDef(name, priority, instances, stacksz) \\ k_task_t task_handler_##name; \\ k_stack_t task_stack_##name[(stacksz)]; \\ const osThreadDef_t os_thread_def_##name = \\ { #name, (os_pthread)(name), (osPriority)(priority), (instances), \\ (&((task_stack_##name)[0])), (stacksz), ((k_timeslice_t)0u), (&(task_handler_##name)) } \u5b8f\u5b9a\u4e49\u4e2d\u7684 instances \u8868\u793a\u57fa\u4e8e\u6b64\u4efb\u52a1\u53c2\u6570\uff0c\u521b\u5efa\u51fa\u51e0\u4e2a\u4efb\u52a1\u5b9e\u4f8b\uff0c\u6bd4\u5982instances\u4e3a2\uff0c\u5219\u4f1a\u521b\u5efa\u51fa\u4e24\u4e2a\u4efb\u52a1\u3002 CMSIS-RTOS API\u5b9a\u4e49\u7684\u83b7\u53d6\u7ebf\u7a0b\u53c2\u6570\u7ed3\u6784\u4f53\u7684\u5b8f\u5982\u4e0b\uff1a #define osThread(name) \\ &os_thread_def_##name \u7ba1\u7406\u7ebf\u7a0b\u53c2\u6570\u7684API\u5982\u4e0b\uff1a API \u63cf\u8ff0 osThreadCreate \u521b\u5efa\u7ebf\u7a0b\u5e76\u5f00\u59cb\u6267\u884c osThreadTerminate \u505c\u6b62\u7ebf\u7a0b\u6267\u884c osThreadYield \u7ebf\u7a0b\u4e3b\u52a8\u8ba9\u51fa osThreadGetID \u83b7\u53d6\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7ebf\u7a0b\u7684ID osThreadSetPriority \u6539\u53d8\u7ebf\u7a0b\u4f18\u5148\u7ea7 osThreadGetPriority \u83b7\u53d6\u7ebf\u7a0b\u4f18\u5148\u7ea7 osThreadCreate osThreadId osThreadCreate(const osThreadDef_t *thread_def, void *argument); \u5176\u4e2dosThreadId\u88ab\u5b9a\u4e49\u4e3ak_task_t\u6307\u9488\u7c7b\u578b\uff1a typedef k_task_t *osThreadId; \u8fd4\u56de\u503c\uff1aTencentOS-tiny\u4e2d\u7684\u4efb\u52a1\u63a7\u5236\u5757\u7c7b\u578b\u6307\u9488\u3002 osThreadTerminate osStatus osThreadTerminate(osThreadId thread_id); \u8fd4\u56de\u503c\uff1aosStatus osThreadYield osStatus osThreadYield(void); \u8fd4\u56de\u503c\uff1aosStatus osThreadGetID osThreadId osThreadGetId(void); osThreadSetPriority osStatus osThreadSetPriority(osThreadId thread_id, osPriority priority); osThreadGetPriority osPriority osThreadGetPriority(osThreadId thread_id); \u4f7f\u7528\u65f6\u9700\u8981\u7279\u522b\u6ce8\u610f\uff0c\u5728TencentOS-tiny\u4e2d\uff0c\u8c03\u7528CMSIS-RTOS API\u63d0\u4f9b\u7684\u4f18\u5148\u7ea7\u9009\u9879\u8bbe\u7f6e\u4e4b\u540e\uff0c\u5b9e\u9645\u8bbe\u7f6e\u7684\u4efb\u52a1\u503c\u662f\u4e0d\u540c\u7684\u3002 CMSIS-RTOS API\u63d0\u4f9b\u7684\u7ebf\u7a0b\u4f18\u5148\u7ea7\u5b8f\u5b9a\u4e49\u5982\u4e0b\uff1a typedef enum { osPriorityIdle = -3, ///< priority: idle (lowest) osPriorityLow = -2, ///< priority: low osPriorityBelowNormal = -1, ///< priority: below normal osPriorityNormal = 0, ///< priority: normal (default) osPriorityAboveNormal = +1, ///< priority: above normal osPriorityHigh = +2, ///< priority: high osPriorityRealtime = +3, ///< priority: realtime (highest) osPriorityError = 0x84 ///< system cannot determine priority or thread has illegal priority } osPriority; \u5728TencentOS-tiny\u4e2d\u5b9e\u73b0\u7684\u65f6\u5019\u8fdb\u884c\u4e86\u8f6c\u5316\uff1a static k_prio_t priority_cmsis2knl(osPriority prio) { if (prio == osPriorityError) { return K_TASK_PRIO_INVALID; } return (k_prio_t)(3 - prio); } static osPriority priority_knl2cmsis(k_prio_t prio) { return (osPriority)(3 - prio); } \u6bd4\u5982\u521b\u5efa\u7ebf\u7a0b\u65f6\u8bbe\u7f6e\u4e3a osPriorityNormal=0\uff0c\u5219 \u5b9e\u9645\u8bbe\u7f6e\u7684\u4efb\u52a1\u4f18\u5148\u7ea7\u4e3a3 \u3002","title":"2.2. \u7ebf\u7a0b\u7ba1\u7406\uff08Thread management\uff09"},{"location":"23.CMSIS_RTOS_API_Use_Guide/#23","text":"CMSIS-RTOS\u63d0\u4f9b\u7684\u7b49\u5f85\u51fd\u6570API\u5982\u4e0b\uff1a API \u63cf\u8ff0 osDelay \u7b49\u5f85\u6307\u5b9a\u7684\u65f6\u95f4 osWait\uff08\u53ef\u9009\uff09 \u7b49\u5f85\u4fe1\u53f7\u3001\u6d88\u606f\u3001\u90ae\u7bb1\u7684\u67d0\u4e2a\u4e8b\u4ef6 osDelay osStatus osDelay(uint32_t millisec); \u8fd4\u56de\u503c\uff1aosStatus\u3002","title":"2.3. \u901a\u7528\u7b49\u5f85\u51fd\u6570"},{"location":"23.CMSIS_RTOS_API_Use_Guide/#24","text":"CMSIS-RTOS API\u63d0\u4f9b\u7684\u5b58\u50a8\u5b9a\u65f6\u5668\u53c2\u6570\u7684\u7ed3\u6784\u4f53\u5982\u4e0b\uff1a typedef struct os_timer_def { os_ptimer cb; ///< start address of a timer function k_timer_t *timer; } osTimerDef_t; CMSIS-RTOS API\u63d0\u4f9b\u7684\u5b9a\u4e49\u4e00\u4e2a\u8f6f\u4ef6\u5b9a\u65f6\u5668\u7684\u5b8f\u5b9a\u4e49\u5982\u4e0b\uff1a #define osTimerDef(name, function) \\ k_timer_t timer_handler_##name; \\ const osTimerDef_t os_timer_def_##name = \\ { (os_ptimer)(function), (&(timer_handler_##name)) } CMSIS-RTOS API\u5b9a\u4e49\u7684\u83b7\u53d6\u8f6f\u4ef6\u5b9a\u65f6\u5668\u53c2\u6570\u7ed3\u6784\u4f53\u7684\u5b8f\u5982\u4e0b\uff1a #define osTimer(name) \\ &os_timer_def_##name CMSIS-RTOS API\u63d0\u4f9b\u7684\u8f6f\u4ef6\u5b9a\u65f6\u5668\u7ba1\u7406API\u5982\u4e0b\uff1a API \u63cf\u8ff0 osTimerCreate \u521b\u5efa\u4e00\u4e2a\u8f6f\u4ef6\u5b9a\u65f6\u5668 osTimerStart \u542f\u52a8\u8f6f\u4ef6\u5b9a\u65f6\u5668 osTimerStop \u505c\u6b62\u8f6f\u4ef6\u5b9a\u65f6\u5668 osTimerDelete \u5220\u9664\u8f6f\u4ef6\u5b9a\u65f6\u5668 osTimerCreate osTimerId osTimerCreate(const osTimerDef_t *timer_def, os_timer_type type, void *argument); \u5176\u4e2dosTimerId\u88ab\u5b9a\u4e49\u4e3ak_timer_t\u6307\u9488\u7c7b\u578b\uff1a typedef k_timer_t *osTimerId; type\u53c2\u6570\u4e3a os_timer_type \u7c7b\u578b\uff0c\u8868\u793a\u8f6f\u4ef6\u5b9a\u65f6\u5668\u7684\u7c7b\u578b\u4e3a\u5355\u6b21\u89e6\u53d1\u6216\u8005\u5468\u671f\u89e6\u53d1\uff1a typedef enum { osTimerOnce = 0, ///< one-shot timer osTimerPeriodic = 1 ///< repeating timer } os_timer_type; osTimerStart osStatus osTimerStart(osTimerId timer_id, uint32_t millisec); \u8fd4\u56de\u503c\uff1aosStatus\u3002 osTimerStop osStatus osTimerStop(osTimerId timer_id) \u8fd4\u56de\u503c\uff1aosStatus\u3002 osTimerDelete osStatus osTimerDelete(osTimerId timer_id); \u8fd4\u56de\u503c\uff1aosStatus\u3002","title":"2.4. \u8f6f\u4ef6\u5b9a\u65f6\u5668\u7ba1\u7406"},{"location":"23.CMSIS_RTOS_API_Use_Guide/#25","text":"CMSIS-RTOS API\u63d0\u4f9b\u7684\u5b58\u50a8\u4fe1\u53f7\u91cf\u53c2\u6570\u7684\u7ed3\u6784\u4f53\u5982\u4e0b\uff1a typedef struct os_semaphore_def { uint32_t dummy; ///< dummy value. k_sem_t *sem; } osSemaphoreDef_t; CMSIS-RTOS API\u63d0\u4f9b\u7684\u5b9a\u4e49\u4e00\u4e2a\u4fe1\u53f7\u91cf\u7684\u5b8f\u5b9a\u4e49\u5982\u4e0b\uff1a #define osSemaphoreDef(name) \\ k_sem_t sem_handler_##name; \\ const osSemaphoreDef_t os_semaphore_def_##name = { 0, (&(sem_handler_##name)) } CMSIS-RTOS API\u5b9a\u4e49\u7684\u83b7\u53d6\u4fe1\u53f7\u91cf\u53c2\u6570\u7ed3\u6784\u4f53\u7684\u5b8f\u5982\u4e0b\uff1a #define osSemaphore(name) \\ &os_semaphore_def_##name CMSIS-RTOS API\u63d0\u4f9b\u7684\u4fe1\u53f7\u91cf\u7ba1\u7406API\u5982\u4e0b\uff1a API \u63cf\u8ff0 osSemaphoreCreate \u521b\u5efa\u4e00\u4e2a\u4fe1\u53f7\u91cf osSemaphoreWait \u7b49\u5f85\u4fe1\u53f7\u91cf osSemaphoreRelease \u91ca\u653e\u4fe1\u53f7\u91cf osSemaphoreDelete \u5220\u9664\u4fe1\u53f7\u91cf osSemaphoreCreate osSemaphoreId osSemaphoreCreate(const osSemaphoreDef_t *semaphore_def, int32_t count); \u5176\u4e2d osSemaphoreId \u88ab\u5b9a\u4e49\u4e3ak_sem_t\u6307\u9488\u7c7b\u578b\uff1a typedef k_sem_t *osSemaphoreId; osSemaphoreWait int32_t osSemaphoreWait(osSemaphoreId semaphore_id, uint32_t millisec); \u8fd4\u56de\u503c\uff1aint32_t \uff0c\u6b63\u5e38\u8fd4\u56de\u5f53\u524dcount\u6570\uff0c\u5931\u8d25\u8fd4\u56de-1\u3002 \u5982\u679c\u9700\u8981\u963b\u585e\u5ef6\u65f6\uff0c\u53c2\u6570\u5e94\u8be5\u8bbe\u7f6e\u4e3aCMSIS-RTOS API\u63d0\u4f9b\u7684\u5b8f\u5b9a\u4e49 osWaitForever \uff1a #define osWaitForever 0xFFFFFFFF ///< wait forever timeout value osSemaphoreRelease osStatus osSemaphoreRelease(osSemaphoreId semaphore_id); \u8fd4\u56de\u503c\uff1aosStatus\u3002 osSemaphoreDelete osStatus osSemaphoreDelete(osSemaphoreId semaphore_id); \u8fd4\u56de\u503c\uff1aosStatus\u3002","title":"2.5. \u4fe1\u53f7\u91cf\u7ba1\u7406"},{"location":"23.CMSIS_RTOS_API_Use_Guide/#26","text":"CMSIS-RTOS API\u63d0\u4f9b\u7684\u5b58\u50a8\u4e92\u65a5\u9501\u53c2\u6570\u7684\u7ed3\u6784\u4f53\u5982\u4e0b\uff1a typedef struct os_mutex_def { uint32_t dummy; ///< dummy value. k_mutex_t *mutex; } osMutexDef_t; CMSIS-RTOS API\u63d0\u4f9b\u7684\u5b9a\u4e49\u4e00\u4e2a\u4e92\u65a5\u9501\u7684\u5b8f\u5b9a\u4e49\u5982\u4e0b\uff1a #define osMutexDef(name) \\ k_mutex_t mutex_handler_##name; \\ const osMutexDef_t os_mutex_def_##name = { 0, (&(mutex_handler_##name)) } CMSIS-RTOS API\u5b9a\u4e49\u7684\u83b7\u53d6\u4e92\u65a5\u9501\u53c2\u6570\u7ed3\u6784\u4f53\u7684\u5b8f\u5982\u4e0b\uff1a #define osMutex(name) \\ &os_mutex_def_##name CMSIS-RTOS API\u63d0\u4f9b\u7684\u4e92\u65a5\u9501\u7ba1\u7406API\u5982\u4e0b\uff1a API \u63cf\u8ff0 osMutexCreate \u521b\u5efa\u4e00\u4e2a\u4e92\u65a5\u9501 osMutexWait \u7b49\u5f85\u83b7\u53d6\u4e92\u65a5\u9501 osMutexRelease \u91ca\u653e\u4e92\u65a5\u9501 osMutexDelete \u5220\u9664\u4e92\u65a5\u9501 osMutexCreate osMutexId osMutexCreate(const osMutexDef_t *mutex_def); \u5176\u4e2d osMutexId \u88ab\u5b9a\u4e49\u4e3ak_mutex_t\u6307\u9488\u7c7b\u578b\uff1a typedef k_mutex_t *osMutexId; osMutexWait osStatus osMutexWait(osMutexId mutex_id, uint32_t millisec); \u8fd4\u56de\u503c\uff1aosStatus \u3002 \u5982\u679c\u9700\u8981\u963b\u585e\u5ef6\u65f6\uff0c\u53c2\u6570\u5e94\u8be5\u8bbe\u7f6e\u4e3aCMSIS-RTOS API\u63d0\u4f9b\u7684\u5b8f\u5b9a\u4e49 osWaitForever \uff1a #define osWaitForever 0xFFFFFFFF ///< wait forever timeout value osMutexRelease osStatus osMutexRelease(osMutexId mutex_id); \u8fd4\u56de\u503c\uff1aosStatus\u3002 osMutexDelete osStatus osMutexDelete(osMutexId mutex_id); \u8fd4\u56de\u503c\uff1aosStatus\u3002","title":"2.6. \u4e92\u65a5\u9501\u7ba1\u7406"},{"location":"23.CMSIS_RTOS_API_Use_Guide/#27","text":"CMSIS-RTOS API\u63d0\u4f9b\u7684\u5b58\u50a8\u9759\u6001\u5185\u5b58\u6c60\u53c2\u6570\u7684\u7ed3\u6784\u4f53\u5982\u4e0b\uff1a typedef struct os_pool_def { uint32_t pool_sz; ///< number of items (elements) in the pool uint32_t item_sz; ///< size of an item void *pool; ///< pointer to memory for pool k_mmblk_pool_t *mmblk_pool; ///< memory blk pool handler } osPoolDef_t; CMSIS-RTOS API\u63d0\u4f9b\u7684\u5b9a\u4e49\u4e00\u4e2a\u4e92\u65a5\u9501\u7684\u5b8f\u5b9a\u4e49\u5982\u4e0b\uff1a #define osPoolDef(name, no, type) \\ k_mmblk_pool_t mmblk_pool_handler_##name; \\ uint8_t mmblk_pool_buf_##name[(no) * sizeof(type)]; \\ const osPoolDef_t os_pool_def_##name = \\ { (no), sizeof(type), (&((mmblk_pool_buf_##name)[0])), (&(mmblk_pool_handler_##name)) } CMSIS-RTOS API\u5b9a\u4e49\u7684\u83b7\u53d6\u4e92\u65a5\u9501\u53c2\u6570\u7ed3\u6784\u4f53\u7684\u5b8f\u5982\u4e0b\uff1a #define osPool(name) \\ &os_pool_def_##name CMSIS-RTOS API\u63d0\u4f9b\u7684\u4e92\u65a5\u9501\u7ba1\u7406API\u5982\u4e0b\uff1a API \u63cf\u8ff0 osPoolCreate \u521b\u5efa\u4e00\u5757\u56fa\u5b9a\u5927\u5c0f\u7684\u9759\u6001\u5185\u5b58\u6c60 osPoolAlloc \u7533\u8bf7\u5206\u914d\u5185\u5b58 osPoolCAlloc \u7533\u8bf7\u5206\u914d\u4e00\u5757\u5185\u5b58\u5e76\u5168\u90e8\u521d\u59cb\u5316\u4e3a0 osPoolFree \u7533\u8bf7\u56de\u6536\u5185\u5b58 osPoolCreate osPoolId osPoolCreate(const osPoolDef_t *pool_def); \u5176\u4e2d osPoolId \u88ab\u5b9a\u4e49\u4e3a k_mmblk_pool_t \u6307\u9488\u7c7b\u578b\uff1a typedef k_mmblk_pool_t *osPoolId; osPoolAlloc void *osPoolAlloc(osPoolId pool_id); osPoolCAlloc void *osPoolCAlloc(osPoolId pool_id); osPoolFree osStatus osPoolFree(osPoolId pool_id, void *block); \u8fd4\u56de\u503c\uff1aosStatus\u3002","title":"2.7. \u9759\u6001\u5185\u5b58\u6c60\u7ba1\u7406"},{"location":"23.CMSIS_RTOS_API_Use_Guide/#28","text":"CMSIS-RTOS API\u63d0\u4f9b\u7684\u5b58\u50a8\u6d88\u606f\u961f\u5217\u53c2\u6570\u7684\u7ed3\u6784\u4f53\u5982\u4e0b\uff1a typedef struct os_messageQ_def { uint32_t queue_sz; ///< number of elements in the queue uint32_t item_sz; ///< size of an item void *pool; ///< memory array for messages k_msg_q_t *queue; ///< queue handler } osMessageQDef_t; CMSIS-RTOS API\u63d0\u4f9b\u7684\u5b9a\u4e49\u4e00\u4e2a\u6d88\u606f\u961f\u5217\u7684\u5b8f\u5b9a\u4e49\u5982\u4e0b\uff1a #define osMessageQDef(name, queue_sz, type) \\ k_msg_q_t msg_q_handler_##name; \\ const osMessageQDef_t os_messageQ_def_##name = \\ { (queue_sz), sizeof(type), NULL, (&(msg_q_handler_##name)) } CMSIS-RTOS API\u5b9a\u4e49\u7684\u83b7\u53d6\u6d88\u606f\u961f\u5217\u53c2\u6570\u7ed3\u6784\u4f53\u7684\u5b8f\u5982\u4e0b\uff1a #define osMessageQ(name) \\ &os_messageQ_def_##name CMSIS-RTOS API\u63d0\u4f9b\u7684\u6d88\u606f\u961f\u5217\u7ba1\u7406API\u5982\u4e0b\uff1a API \u63cf\u8ff0 osMessageCreate \u521d\u59cb\u5316\u4e00\u4e2a\u6d88\u606f\u961f\u5217 osMessagePut \u5411\u6d88\u606f\u961f\u5217\u4e2d\u52a0\u5165\u6570\u636e osMessageGet \u4ece\u6d88\u606f\u961f\u5217\u4e2d\u53d6\u51fa\u6570\u636e osMessageCreate osMessageQId osMessageCreate(const osMessageQDef_t *queue_def, osThreadId thread_id); \u5176\u4e2d osMessageQId \u88ab\u5b9a\u4e49\u4e3a k_msg_q_t \u6307\u9488\u7c7b\u578b\uff1a typedef k_msg_q_t *osMessageQId; osMessagePut osStatus osMessagePut(osMessageQId queue_id, uint32_t info, uint32_t millisec); \u8fd4\u56de\u503c\uff1aosStatus \u3002 \u56e0\u4e3aTencentOS-tiny\u4e2d\u6d88\u606f\u961f\u5217\u5b9e\u73b0\u673a\u5236\u7684\u4e0d\u540c\uff0c\u6b64API\u4e2d\u7684 millisec \u53c2\u6570\u672a\u7528\u5230\u3002 osMessageGet osEvent osMessageGet(osMessageQId queue_id, uint32_t millisec); \u8fd4\u56de\u503c\uff1aosEvent \uff0c\u5176\u4e2d\u5305\u542b\u4e86\u4e8b\u4ef6\u4fe1\u606f\u548c\u9519\u8bef\u7801\uff0c\u4ee5\u53ca\u6d88\u606f\u961f\u5217\u6536\u5230\u7684\u503c\u3002 \u5982\u679c\u9700\u8981\u963b\u585e\u5ef6\u65f6\uff0c\u53c2\u6570\u5e94\u8be5\u8bbe\u7f6e\u4e3aCMSIS-RTOS API\u63d0\u4f9b\u7684\u5b8f\u5b9a\u4e49 osWaitForever \uff1a #define osWaitForever 0xFFFFFFFF ///< wait forever timeout value","title":"2.8. \u6d88\u606f\u961f\u5217\u7ba1\u7406"},{"location":"23.CMSIS_RTOS_API_Use_Guide/#3","text":"","title":"3. \u4f7f\u7528\u793a\u4f8b"},{"location":"23.CMSIS_RTOS_API_Use_Guide/#31","text":"#include <cmsis_os.h> void task1_entry(void *arg) { while(1) { printf(\"task1 is running...\\r\\n\"); osDelay(1000); } } osThreadDef(task1_entry, osPriorityNormal, 1, 512); void task2_entry(void *arg) { while(1) { printf(\"task2 is running...\\r\\n\"); osDelay(1000); } } osThreadDef(task2_entry, osPriorityNormal, 1, 512); void application_entry(void *arg) { osThreadCreate(osThread(task1_entry), NULL); osThreadCreate(osThread(task2_entry), NULL); return; } \u4efb\u52a1\u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\uff1a task1 is running... task2 is running... task1 is running... task2 is running... task1 is running... task2 is running...","title":"3.1. \u4efb\u52a1\u521b\u5efa\u793a\u4f8b"},{"location":"23.CMSIS_RTOS_API_Use_Guide/#32","text":"#include <cmsis_os.h> void timer1_cb(void *arg) { printf(\"timer1 is timeout!\\r\\n\"); } void timer2_cb(void *arg) { printf(\"timer2 is timeout!\\r\\n\"); } osTimerDef(timer1, timer1_cb); osTimerDef(timer2, timer2_cb); void application_entry(void *arg) { osTimerId timer1; osTimerId timer2; timer1 = osTimerCreate(osTimer(timer1), osTimerOnce, NULL); timer2 = osTimerCreate(osTimer(timer2), osTimerPeriodic, NULL); osTimerStart(timer1, 5000); osTimerStart(timer2, 1000); return; } \u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\uff1a timer2 is timeout! timer2 is timeout! timer2 is timeout! timer2 is timeout! timer1 is timeout! timer2 is timeout! timer2 is timeout! timer2 is timeout! timer2 is timeout!","title":"3.2. \u8f6f\u4ef6\u5b9a\u65f6\u5668\u4f7f\u7528\u793a\u4f8b"},{"location":"23.CMSIS_RTOS_API_Use_Guide/#33","text":"#include <cmsis_os.h> osSemaphoreId sync_sem_id; osSemaphoreDef(sync_sem); void task1_entry(void *arg) { while(1) { printf(\"task1 is waiting sem forever...\\r\\n\"); osSemaphoreWait(sync_sem_id, osWaitForever); printf(\"task1 get sem!\\r\\n\"); } } osThreadDef(task1_entry, osPriorityNormal, 1, 512); void task2_entry(void *arg) { while(1) { printf(\"task2 will release a sem...\\r\\n\"); osSemaphoreRelease(sync_sem_id); osDelay(1000); } } osThreadDef(task2_entry, osPriorityNormal, 1, 512); void application_entry(void *arg) { sync_sem_id = osSemaphoreCreate(osSemaphore(sync_sem), 0); osThreadCreate(osThread(task1_entry), NULL); osThreadCreate(osThread(task2_entry), NULL); return; } \u8fd0\u884c\u7ed3\u679c\u4e3a\uff1a task1 is waiting sem forever... task1 get sem! task1 is waiting sem forever... task2 will release a sem... task1 get sem! task1 is waiting sem forever... task2 will release a sem... task1 get sem! task1 is waiting sem forever... task2 will release a sem... task1 get sem! task1 is waiting sem forever... task2 will release a sem... task1 get sem! task1 is waiting sem forever...","title":"3.3. \u4fe1\u53f7\u91cf\u4f7f\u7528\u793a\u4f8b"},{"location":"23.CMSIS_RTOS_API_Use_Guide/#34","text":"#include <cmsis_os.h> osMutexId sync_mutex_id; osMutexDef(sync_mutex); void task1_entry(void *arg) { while(1) { osMutexWait(sync_mutex_id, osWaitForever); printf(\"task1 get mutex,doing sth...\\r\\n\"); HAL_Delay(1000); //\u6b7b\u5faa\u73af\u5360\u7528CPU printf(\"task1 finish do sth!\\r\\n\"); osMutexRelease(sync_mutex_id); osDelay(1000); } } osThreadDef(task1_entry, osPriorityHigh, 1, 512); void task2_entry(void *arg) { while(1) { osMutexWait(sync_mutex_id, osWaitForever); printf(\"task2 get mutex,doing sth...\\r\\n\"); HAL_Delay(2000); //\u6b7b\u5faa\u73af\u5360\u7528CPU printf(\"task2 finish do sth!\\r\\n\"); osMutexRelease(sync_mutex_id); osDelay(1000); } } osThreadDef(task2_entry, osPriorityNormal, 1, 512); void application_entry(void *arg) { sync_mutex_id = osMutexCreate(osMutex(sync_mutex)); osThreadCreate(osThread(task1_entry), NULL); osThreadCreate(osThread(task2_entry), NULL); return; } \u8fd0\u884c\u7ed3\u679c\u4e3a\uff1a task1 get mutex,doing sth... task1 finish do sth! task2 get mutex,doing sth... task2 finish do sth! task1 get mutex,doing sth... task1 finish do sth! task1 get mutex,doing sth... task1 finish do sth! task2 get mutex,doing sth...","title":"3.4. \u4e92\u65a5\u9501\u4f7f\u7528\u793a\u4f8b"},{"location":"23.CMSIS_RTOS_API_Use_Guide/#35","text":"#include <cmsis_os.h> typedef struct blk_st { int id; char* payload; } blk_t; #define MMBLK_BLK_NUM 10 osPoolDef (MemPool, MMBLK_BLK_NUM, blk_t); osPoolId mem_pool_id; void task1_entry(void *arg) { blk_t *ptr = NULL; osStatus err; /* \u6253\u5370\u51fa\u4e00\u4e2a\u5757\u7684\u5927\u5c0f */ printf(\"block size is %d bytes\\r\\n\", sizeof(blk_t)); /* \u7533\u8bf7\u4e00\u4e2a\u5757 */ ptr = osPoolAlloc(mem_pool_id); if (ptr == NULL) { printf(\"a mmblk alloc fail\\r\\n\"); return; } else { printf(\"a mmblk alloc success\\r\\n\"); } /* \u4f7f\u7528\u8be5\u5757 */ ptr->id = 1; ptr->payload = \"hello\"; printf(\"mmblk id:%d payload:%s\\r\\n\", ptr->id, ptr->payload); /* \u4f7f\u7528\u5b8c\u6bd5\u4e4b\u540e\u91ca\u653e */ err = osPoolFree(mem_pool_id, ptr); if (err != osOK) { printf(\"a mmblk free fail, err = %d\\r\\n\", err); return; } else { printf(\"a mmblk free success\\r\\n\"); } while (1) { tos_task_delay(1000); } } #define STK_SIZE_TASK1 1024 osThreadDef(task1_entry, osPriorityNormal, 1, STK_SIZE_TASK1); void application_entry(void *arg) { //\u521d\u59cb\u5316\u9759\u6001\u5185\u5b58\u6c60 mem_pool_id = osPoolCreate(osPool(MemPool)); if (mem_pool_id == NULL) { printf(\"mmblk pool create fail\\r\\n\"); return; } else { printf(\"mmblk pool create success\\r\\n\"); } //\u521b\u5efa\u4efb\u52a1 osThreadCreate(osThread(task1_entry), NULL); return; } \u8fd0\u884c\u7ed3\u679c\u4e3a\uff1a mmblk pool create success block size is 8 bytes a mmblk alloc success mmblk id:1 payload:hello a mmblk free success","title":"3.5. \u52a8\u6001\u5185\u5b58\u4f7f\u7528\u793a\u4f8b"},{"location":"23.CMSIS_RTOS_API_Use_Guide/#36","text":"#include <cmsis_os.h> #define STK_SIZE_TASK_RECEIVER 512 #define STK_SIZE_TASK_SENDER 512 #define MESSAGE_MAX 10 osMessageQId msg_q_id; osMessageQDef(msg_q,MESSAGE_MAX,uint32_t); void task_receiver_entry(void *arg) { osEvent event; osStatus ret; uint32_t value; while (1) { event = osMessageGet(msg_q_id, osWaitForever); ret = event.status; if (ret == osOK) { value = event.value.v; printf(\"receiver: msg incoming[%s]\\r\\n\", (char*)value); } } } osThreadDef(task_receiver_entry, osPriorityNormal, 1, STK_SIZE_TASK_RECEIVER); void task_sender_entry(void *arg) { char *msg_prio_0 = \"msg 0\"; char *msg_prio_1 = \"msg 1\"; char *msg_prio_2 = \"msg 2\"; printf(\"sender: post a messgae:[%s]\\r\\n\", msg_prio_2); osMessagePut(msg_q_id,(uint32_t)msg_prio_2,0); printf(\"sender: post a messgae:[%s]\\r\\n\", msg_prio_1); osMessagePut(msg_q_id,(uint32_t)msg_prio_1,0); printf(\"sender: post a messgae:[%s]\\r\\n\", msg_prio_0); osMessagePut(msg_q_id,(uint32_t)msg_prio_0,0); } osThreadDef(task_sender_entry, osPriorityNormal, 1, STK_SIZE_TASK_SENDER); void application_entry(void *arg) { msg_q_id = osMessageCreate(osMessageQ(msg_q),NULL); osThreadCreate(osThread(task_receiver_entry), NULL); osThreadCreate(osThread(task_sender_entry), NULL); return; } \u8fd0\u884c\u7ed3\u679c\u4e3a\uff1a sender: post a messgae:[msg 2] sender: post a messgae:[msg 1] sender: post a messgae:[msg 0] receiver: msg incoming[msg 2] receiver: msg incoming[msg 1] receiver: msg incoming[msg 0]","title":"3.6. \u6d88\u606f\u961f\u5217\u4f7f\u7528\u793a\u4f8b"},{"location":"24.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Explorer/","text":"1. \u817e\u8baf\u4e91ESP8266\u5b9a\u5236\u56fa\u4ef6\u8bf4\u660e\u53ca\u70e7\u5f55 \u817e\u8baf\u4e91IoT AT\u6307\u4ee4\u662f\u4e00\u5957\u9488\u5bf9\u4f7f\u7528\u901a\u8baf\u6a21\u7ec4\uff082G/4G/NB/WIFI\uff09\u63a5\u5165\u817e\u8baf\u4e91\u7269\u8054\u5e73\u53f0\u7684\u5b9a\u5236AT\u6307\u4ee4\u96c6\uff0c\u5982\u679c\u901a\u8baf\u6a21\u7ec4\u5b9e\u73b0\u4e86\u8be5\u6307\u4ee4\u96c6\uff0c\u5219\u8bbe\u5907\u63a5\u5165\u548c\u901a\u8baf\u66f4\u4e3a\u7b80\u5355\uff0c\u6240\u9700\u4ee3\u7801\u91cf\u66f4\u5c11\u3002 ESP8266\u4f5c\u4e3aIoT\u9886\u57df\u4f7f\u7528\u6700\u5e7f\u6cdb\u7684\u4e00\u6b3eWiFi\u82af\u7247/\u6a21\u7ec4\uff0c\u6211\u4eec\u5728\u5176\u901a\u7528AT\u6307\u4ee4\u57fa\u7840\u4e0a\uff0c\u589e\u52a0\u4e86\u817e\u8baf\u4e91IoT AT\u6307\u4ee4\u96c6\uff0c\u5f62\u6210\u4e00\u4e2a\u5b9a\u5236\u7684\u6a21\u7ec4\u56fa\u4ef6QCloud_IoT_AT_ESP8266\uff0c\u817e\u8baf\u4e91IoT\u5b9a\u5236\u7684AT\u6a21\u7ec4\u56fa\u4ef6QCloud_IoT_AT_ESP8266\uff0c\u9002\u7528\u4e8e\u6240\u6709FLASH\u5927\u5c0f\u4e3a2MB\u6216\u80052MB\u4ee5\u4e0a\u7684ESP8266\u6a21\u7ec4\u3002 \u56fa\u4ef6\u70e7\u5f55\u65b9\u6cd5\u8bf7\u9605\u8bfb\u6587\u6863\uff1a \u817e\u8baf\u4e91 IoT AT ESP8266 \u5b9a\u5236\u56fa\u4ef6\u53ca\u8bf4\u660e \u3002 2. \u4e91\u7aef\u914d\u7f6e \u767b\u5f55 \u817e\u8baf\u4e91\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\uff08IoT Explorer\uff09 ,\u70b9\u51fb\u201c\u7acb\u5373\u4f7f\u7528\u201d\u8fdb\u5165\u63a7\u5236\u53f0\u3002 2.1. \u65b0\u5efa\u9879\u76ee \u9879\u76ee\u662f\u4e3a\u4e86\u7528\u6237\u9762\u5bf9\u4e0d\u540c\u7684\u4ea7\u54c1\u8fed\u4ee3\u6216\u4e0d\u540c\u7684\u9879\u76ee\u89d2\u8272\u800c\u8bbe\u8ba1\u7684\u4e00\u79cd\u9694\u79bb\u673a\u5236\uff0c\u4fbf\u4e8e\u7528\u6237\u6e05\u6670\u7ba1\u7406\u7269\u8054\u7f51\u9879\u76ee\uff0c\u5e76\u80fd\u7075\u6d3b\u5730\u914d\u7f6e\u9879\u76ee\u6743\u9650\u3002 \u9879\u76ee\u4e0b\u53ef\u4ee5\u5efa\u7acb\u591a\u4e2a\u4ea7\u54c1\u4e0e\u5e94\u7528\uff0c\u5e94\u7528\u9ed8\u8ba4\u6709\u6743\u9650\u8bbf\u95ee\u8be5\u9879\u76ee\u4e0b\u7684 \u6240\u6709\u4ea7\u54c1 \uff1b \u6bcf\u4e2a\u9879\u76ee\u4f1a\u6709\u81ea\u5df1\u7684\u552f\u4e00 ID\uff0c\u6570\u636e\u4f1a\u6839\u636e\u9879\u76ee\u8fdb\u884c\u9694\u79bb\uff0c\u4ee5\u786e\u4fdd\u6570\u636e\u5b89\u5168\uff1b \u9879\u76ee\u5220\u9664\u540e\uff0c\u8be5\u9879\u76ee\u6240\u5c5e\u4ea7\u54c1\u7b49\u6570\u636e\u90fd\u5c06\u88ab\u5220\u9664\u4e14\u4e0d\u80fd\u6062\u590d\uff1b \u5f00\u53d1\u5e73\u53f0\u63d0\u4f9b\u8d44\u6e90\u7ea7\u7684\u6743\u9650\u63a7\u5236\uff0c\u53ef\u4e3a\u4e0d\u540c\u7684\u5b50\u7528\u6237\u5206\u914d\u9879\u76ee\u7ea7\u3001\u4ea7\u54c1\u7ea7\u7684\u6743\u9650\u63a7\u5236\uff1b \u70b9\u51fb\u65b0\u5efa\u9879\u76ee\uff0c\u586b\u5199\u9879\u76ee\u540d\u79f0\u548c\u7b80\u4ecb\uff1a 2.2. \u4ea7\u54c1\u5f00\u53d1 2.2.1. \u65b0\u5efa\u4ea7\u54c1 \u70b9\u51fb\u9879\u76ee\u540d\u79f0\u8fdb\u5165\u5230\u8be5\u9879\u76ee\u4e2d\uff0c\u70b9\u51fb\u65b0\u5efa\u4ea7\u54c1\uff1a \u586b\u5199\u4ea7\u54c1\u7684\u4e00\u4e9b\u4fe1\u606f\uff1a \u4ea7\u54c1\u540d\u79f0\uff1a\u540d\u79f0\u4e3a\u4e2d\u6587\u3001\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u4e0b\u5212\u7ebf\u7684\u7ec4\u5408\uff0c1 - 20\u4f4d\u4e14\u4e0d\u80fd\u4e3a\u7a7a\u3002 \u4ea7\u54c1\u54c1\u7c7b\uff1a\u9009\u62e9\u60a8\u6240\u521b\u5efa\u4ea7\u54c1\u7684\u6240\u5c5e\u54c1\u7c7b\uff0c\u4e0d\u540c\u7c7b\u578b\u4ea7\u54c1\u7684\u5c5e\u6027\u3001\u4e8b\u4ef6\u7b49\u6570\u636e\u6a21\u677f\u4f1a\u6709\u6240\u4e0d\u540c\u3002\u8be6\u60c5\u8bf7\u53c2\u89c1 \u6570\u636e\u6a21\u677f\u3002 \u8bbe\u5907\u7c7b\u578b\uff1a\u8bbe\u5907\u4f7f\u75282G/3G/4G/Wi-Fi\u65e0\u7ebf\u901a\u4fe1\u6216\u6709\u7ebf\u901a\u4fe1\u65b9\u5f0f\uff0c\u7f51\u5173\u53ef\u63d0\u4f9b\u4e91\u7aef\u901a\u4fe1\u80fd\u529b\uff0c\u5e2e\u52a9\u8bbe\u5907\u4e0e\u5e73\u53f0\u901a\u4fe1\u3002 \u8ba4\u8bc1\u65b9\u5f0f\uff1a\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u63d0\u4f9b\u4e24\u79cd\u8ba4\u8bc1\u65b9\u5f0f\u7528\u4e8e\u8bbe\u5907\u4e0e\u5e73\u53f0\u4e4b\u95f4\u9274\u6743\u8ba4\u8bc1\u3002 \u8bc1\u4e66\u8ba4\u8bc1\uff1a\u5728\u521b\u5efa\u8bbe\u5907\u65f6\uff0c\u5e73\u53f0\u5c06\u4e3a\u8bbe\u5907\u751f\u6210\u4e00\u4e2a\u8bc1\u4e66\u6587\u4ef6\u548c\u4e00\u4e2a\u79c1\u94a5\u6587\u4ef6\uff0c\u5b9e\u73b0\u8bbe\u5907\u4e0e\u4e91\u4e4b\u95f4\u7684\u53cc\u5411\u8ba4\u8bc1\u3002 \u5bc6\u94a5\u8ba4\u8bc1\uff1a\u5728\u521b\u5efa\u8bbe\u5907\u65f6\uff0c\u4f7f\u7528\u5e73\u53f0\u4e3a\u8bbe\u5907\u968f\u673a\u751f\u6210\u7684 PSK\u3002 \u901a\u4fe1\u65b9\u5f0f\uff1a\u60a8\u53ef\u4ee5\u9009\u62e9 Wi-Fi\u3001\u79fb\u52a8\u8702\u7a9d\uff082G/3G/4G\uff09\u548c\u5176\u4ed6\u901a\u4fe1\u65b9\u5f0f\u3002 \u6570\u636e\u534f\u8bae\uff1a\u9ed8\u8ba4\u91c7\u7528\u6570\u636e\u6a21\u677f\u7684\u6570\u636e\u534f\u8bae\uff0c\u60a8\u4e5f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u534f\u8bae\u8fdb\u884c\u900f\u4f20\u3002 \u63cf\u8ff0\uff1a\u5b57\u6570\u4e0d\u80fd\u8d85\u8fc780\u4e2a\uff0c\u60a8\u53ef\u4ee5\u6839\u636e\u9700\u8981\u9009\u586b\u3002 \u4ea7\u54c1\u65b0\u5efa\u6210\u529f\u540e\uff0c\u53ef\u5728\u4ea7\u54c1\u5217\u8868\u9875\u67e5\u770b\u5230\u201c\u667a\u80fd\u706f\u201d\u3002 2.2.2. \u6570\u636e\u6a21\u677f \u6570\u636e\u6a21\u677f\u662f\u5c06\u7269\u7406\u5b9e\u4f53\u8bbe\u5907\u8fdb\u884c\u6570\u5b57\u5316\u63cf\u8ff0\uff0c\u6784\u5efa\u5176\u6570\u5b57\u6a21\u578b\u3002\u5728\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u5b9a\u4e49\u6570\u636e\u6a21\u677f\u5373\u5b9a\u4e49\u4ea7\u54c1\u529f\u80fd\u3002\u5b8c\u6210\u529f\u80fd\u5b9a\u4e49\u540e\uff0c\u7cfb\u7edf\u5c06\u81ea\u52a8\u751f\u6210\u8be5\u4ea7\u54c1\u7684\u6570\u636e\u6a21\u677f\u3002 \u8fdb\u5165\u4ea7\u54c1\uff0c\u70b9\u51fb\u65b0\u5efa\u529f\u80fd\u3002 \u586b\u5199\u529f\u80fd\u4fe1\u606f\u3002 \u529f\u80fd\u7c7b\u578b\u5305\u542b\u4e09\u5143\u7d20\uff1a \u5c5e\u6027\uff1a\u5305\u62ec\u5e03\u5c14\u578b\u3001\u6574\u6570\u578b\u3001\u5b57\u7b26\u578b\u3001\u6d6e\u70b9\u578b\u3001\u679a\u4e3e\u578b\u548c\u65f6\u95f4\u578b\u7b496\u79cd\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff1b \u4e8b\u4ef6\uff1a\u5305\u62ec\u544a\u8b66\u3001\u6545\u969c\u548c\u4fe1\u606f\u4e09\u79cd\u7c7b\u578b\uff0c\u4e8b\u4ef6\u578b\u529f\u80fd\u5c5e\u6027\u53ef\u4ee5\u6dfb\u52a0\u5177\u4f53\u7684\u4e8b\u4ef6\u53c2\u6570\uff0c\u8fd9\u4e9b\u53c2\u6570\u53ef\u4ee5\u7531\u5c5e\u6027\u4e2d6\u79cd\u57fa\u672c\u6570\u636e\u7c7b\u578b\u7ec4\u6210\uff1b \u884c\u4e3a\uff1a\u7528\u4e8e\u5b9e\u73b0\u66f4\u590d\u6742\u7684\u4e1a\u52a1\u903b\u8f91\uff0c\u53ef\u5305\u542b\u8f93\u5165\u53c2\u6570\u548c\u8f93\u51fa\u53c2\u6570\uff0c\u53ef\u7528\u4e8e\u8ba9\u8bbe\u5907\u6267\u884c\u67d0\u9879\u7279\u5b9a\u7684\u4efb\u52a1\u3002\u884c\u4e3a\u7684\u8f93\u5165\u53c2\u6570\u548c\u8f93\u51fa\u53c2\u6570\u53ef\u6dfb\u52a0\u4e0a\u8ff06\u79cd\u5c5e\u6027\u7684\u57fa\u672c\u6570\u636e\u7c7b\u578b\u3002 \u529f\u80fd\u5143\u7d20 \u529f\u80fd\u63cf\u8ff0 \u529f\u80fd\u6807\u8bc6\u7b26 \u5c5e\u6027 \u7528\u4e8e\u63cf\u8ff0\u8bbe\u5907\u7684\u5b9e\u65f6\u72b6\u6001\uff0c\u652f\u6301\u8bfb\u53d6\u548c\u8bbe\u7f6e\uff0c\u5982\u6a21\u5f0f\u3001\u4eae\u5ea6\u3001\u5f00\u5173\u7b49\u3002 PropertiesId \u4e8b\u4ef6 \u7528\u4e8e\u63cf\u8ff0\u8bbe\u5907\u8fd0\u884c\u65f6\u7684\u4e8b\u4ef6\uff0c\u5305\u62ec\u544a\u8b66\u3001\u4fe1\u606f\u548c\u6545\u969c\u7b49\u4e09\u79cd\u4e8b\u4ef6\u7c7b\u578b\uff0c\u53ef\u6dfb\u52a0\u591a\u4e2a\u8f93\u51fa\u53c2\u6570\uff0c\u5982\u73af\u5883\u4f20\u611f\u5668\u68c0\u6d4b\u5230\u7a7a\u6c14\u8d28\u91cf\u5f88\u5dee\uff0c\u7a7a\u8c03\u5f02\u5e38\u544a\u8b66\u7b49\u3002 EventId \u884c\u4e3a \u7528\u4e8e\u63cf\u8ff0\u590d\u6742\u7684\u4e1a\u52a1\u903b\u8f91,\u53ef\u6dfb\u52a0\u591a\u4e2a\u8c03\u7528\u53c2\u6570\u548c\u8fd4\u56de\u53c2\u6570,\u7528\u4e8e\u8ba9\u8bbe\u5907\u6267\u884c\u67d0\u9879\u5b9a\u7279\u5b9a\u7684\u4efb\u52a1\uff0c\u4f8b\u5982\uff0c\u5f00\u9501\u52a8\u4f5c\u9700\u8981\u77e5\u9053\u662f\u54ea\u4e2a\u7528\u6237\u5728\u4ec0\u4e48\u65f6\u95f4\u5f00\u9501\uff0c\u9501\u7684\u72b6\u6001\u5982\u4f55\u7b49\u3002 ActionId \u6570\u636e\u7c7b\u578b\u652f\u63016\u79cd\uff1a \u5e03\u5c14\u578b\uff1a\u975e\u771f\u5373\u5047\u7684\u4e8c\u503c\u578b\u53d8\u91cf\u3002\u4f8b\u5982\uff0c\u5f00\u5173\u529f\u80fd\u3002 \u6574\u6570\u578b\uff1a\u53ef\u7528\u4e8e\u7ebf\u6027\u8c03\u8282\u7684\u6574\u6570\u53d8\u91cf\u3002\u4f8b\u5982\uff0c\u7a7a\u8c03\u7684\u6e29\u5ea6\u3002 \u5b57\u7b26\u578b\uff1a\u4ee5\u5b57\u7b26\u4e32\u5f62\u5f0f\u8868\u8fbe\u7684\u529f\u80fd\u70b9\uff0c\u4f8b\u5982\uff0c\u706f\u7684\u4f4d\u7f6e\u3002 \u6d6e\u70b9\u578b\uff1a\u7cbe\u5ea6\u4e3a\u6d6e\u70b9\u578b\u7684\u529f\u80fd\u70b9\u3002\u4f8b\u5982\uff0c\u538b\u529b\u503c\u7684\u8303\u56f4\uff1a0.0 - 24.0\u3002 \u679a\u4e3e\u578b\uff1a\u81ea\u5b9a\u4e49\u7684\u6709\u9650\u96c6\u5408\u503c\u3002\u4f8b\u5982\uff0c\u706f\u7684\u989c\u8272\uff1a\u767d\u8272\u3001\u7ea2\u8272\u3001\u9ec4\u8272\u7b49\u3002 \u65f6\u95f4\u578b\uff1astring \u7c7b\u578b\u7684 UTC \u65f6\u95f4\u6233\uff08\u6beb\u79d2\uff09\u3002 \u9009\u62e9\u201c\u667a\u80fd\u706f\u201d\u7c7b\u578b\u540e\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u751f\u6210\u6807\u51c6\u529f\u80fd\uff1a \u6570\u636e\u6a21\u677f\u662f\u4e00\u4e2a JSON \u683c\u5f0f\u7684\u6587\u4ef6\uff0c\u4f7f\u7528\u6570\u636e\u6a21\u677f\u534f\u8bae\uff0c\u7528\u6237\u7684\u8bbe\u5907\u9700\u6309\u6570\u636e\u6a21\u677f\u5b9a\u4e49\u8981\u6c42\u4f20\u8f93\u8bbe\u5907\u6570\u636e\u5230\u4e91\u7aef\uff0c\u5e76\u53ef\u4f7f\u7528\u57fa\u4e8e\u6570\u636e\u6a21\u677f\u7684\u8bf8\u591a\u4e1a\u52a1\u529f\u80fd\uff0c\u70b9\u51fb\u67e5\u770bjson\u53ef\u4ee5\u770b\u5230\u4e0a\u9762\u521b\u5efa\u529f\u80fd\u7684json\u683c\u5f0f\uff1a { \"version\": \"1.0\", \"properties\": [ { \"id\": \"power_switch\", \"name\": \"\u7535\u706f\u5f00\u5173\", \"desc\": \"\u63a7\u5236\u7535\u706f\u5f00\u706d\", \"required\": true, \"mode\": \"rw\", \"define\": { \"type\": \"bool\", \"mapping\": { \"0\": \"\u5173\", \"1\": \"\u5f00\" } } }, { \"id\": \"color\", \"name\": \"\u989c\u8272\", \"desc\": \"\u706f\u5149\u989c\u8272\", \"mode\": \"rw\", \"define\": { \"type\": \"enum\", \"mapping\": { \"0\": \"Red\", \"1\": \"Green\", \"2\": \"Blue\" } } }, { \"id\": \"brightness\", \"name\": \"\u4eae\u5ea6\", \"desc\": \"\u706f\u5149\u4eae\u5ea6\", \"mode\": \"rw\", \"define\": { \"type\": \"int\", \"unit\": \"%\", \"step\": \"1\", \"min\": \"0\", \"max\": \"100\", \"start\": \"1\" } }, { \"id\": \"name\", \"name\": \"\u706f\u4f4d\u7f6e\u540d\u79f0\", \"desc\": \"\u706f\u4f4d\u7f6e\u540d\u79f0\uff1a\u4e66\u623f\u3001\u5ba2\u5385\u7b49\", \"mode\": \"rw\", \"required\": false, \"define\": { \"type\": \"string\", \"min\": \"0\", \"max\": \"64\" } } ], \"events\": [ { \"id\": \"status_report\", \"name\": \"DeviceStatus\", \"desc\": \"Report the device status\", \"type\": \"info\", \"required\": false, \"params\": [ { \"id\": \"status\", \"name\": \"running_state\", \"desc\": \"Report current device running state\", \"define\": { \"type\": \"bool\", \"mapping\": { \"0\": \"normal\", \"1\": \"fault\" } } }, { \"id\": \"message\", \"name\": \"Message\", \"desc\": \"Some extra message\", \"define\": { \"type\": \"string\", \"min\": \"0\", \"max\": \"64\" } } ] }, { \"id\": \"low_voltage\", \"name\": \"LowVoltage\", \"desc\": \"Alert for device voltage is low\", \"type\": \"alert\", \"required\": false, \"params\": [ { \"id\": \"voltage\", \"name\": \"Voltage\", \"desc\": \"Current voltage\", \"define\": { \"type\": \"float\", \"unit\": \"V\", \"step\": \"1\", \"min\": \"0.0\", \"max\": \"24.0\", \"start\": \"1\" } } ] }, { \"id\": \"hardware_fault\", \"name\": \"Hardware_fault\", \"desc\": \"Report hardware fault\", \"type\": \"fault\", \"required\": false, \"params\": [ { \"id\": \"name\", \"name\": \"Name\", \"desc\": \"Name like: memory,tf card, censors ...\", \"define\": { \"type\": \"string\", \"min\": \"0\", \"max\": \"64\" } }, { \"id\": \"error_code\", \"name\": \"Error_Code\", \"desc\": \"Error code for fault\", \"define\": { \"type\": \"int\", \"unit\": \"\", \"step\": \"1\", \"min\": \"0\", \"max\": \"2000\", \"start\": \"1\" } } ] } ], \"profile\": { \"ProductId\": \"FWR8PGACUS\", \"CategoryId\": \"3\" }, \"actions\": [] } 2.3. \u521b\u5efa\u8bbe\u5907 \u8fdb\u5165\u8bbe\u5907\u8c03\u8bd5\u754c\u9762\uff0c\u65b0\u5efa\u8bbe\u5907\uff1a \u8fdb\u5165\u8bbe\u5907\u4e4b\u540e\u5373\u53ef\u770b\u5230\u5bf9\u63a5\u4fe1\u606f\u3002 3. \u8bbe\u5907\u7aef\u5bf9\u63a5\u6d4b\u8bd5 \u4f7f\u7528USB\u8f6c\u4e32\u53e3\u5c06\u70e7\u5f55\u597d\u817e\u8baf\u4e91\u5b9a\u5236\u56fa\u4ef6\u7684ESP8266\u8fde\u63a5\u5230PC\uff0c\u4f7f\u7528\u4e32\u53e3\u52a9\u624b\u6253\u5f00\u4e32\u53e3\u5f00\u59cb\u8c03\u8bd5\u3002 3.1. \u5165\u7f51 \u6d4b\u8bd5AT\u6307\u4ee4\u662f\u5426\u6b63\u5e38\uff1a AT OK \u8bbe\u7f6eESP8266\u5de5\u4f5c\u6a21\u5f0f\u4e3aAP\u548cSTA\u5e76\u5b58\uff1a AT+CWMODE=3 OK \u8bbe\u7f6e\u4f20\u8f93\u6a21\u5f0f\u4e3a\u666e\u901a\u4f20\u8f93\u6a21\u5f0f\uff1a AT+CIPMODE=0 OK \u5f00\u542f\u591a\u8def\u6a21\u5f0f\uff1a AT+CIPMUX=1 OK \u5165\u7f51\uff1a AT+CWJAP=\"Mculover666\",\"mculover666\" WIFI CONNECTED WIFI GOT IP OK 3.2. \u8bbe\u7f6e\u817e\u8baf\u4e91\u5bf9\u63a5\u4fe1\u606f \u793a\u4f8b\uff1a AT+TCDEVINFOSET=1,\"FWR8PGACUS\",\"ESP8266_Dev_001\",\"0VqX0xzrvwmivBHwzuBrCQ==\" OK +TCDEVINFOSET:OK \u6b64\u4fe1\u606f\u4f1a\u4fdd\u5b58\u5230Flash\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u67e5\u770b\uff1a AT+TCDEVINFOSET? 3.3. \u8fde\u63a5\u817e\u8baf\u4e91 \u793a\u4f8b\uff1a AT+TCMQTTCONN=1,5000,240,1,1 OK +TCMQTTCONN:OK \u8fde\u63a5\u6210\u529f\uff0c\u6b64\u65f6\u5728\u817e\u8baf\u4e91IoT Explorer\u5e73\u53f0\u5373\u53ef\u770b\u5230\u8bbe\u5907\u5728\u7ebf\uff1a 3.4. \u8ba2\u9605\u548c\u53d1\u5e03\u4e3b\u9898 Explorer\u5e73\u53f0\u76f8\u6bd4IoThub\u5e73\u53f0\uff0c\u652f\u6301\u7684topic\u6bd4\u8f83\u591a\uff0c\u4e3b\u8981\u6709\u5982\u4e0b\u529f\u80fd\uff1a \u8bbe\u5907\u5c5e\u6027\u4e0a\u62a5\uff1a\u8bbe\u5907\u7aef\u5c06\u5b9a\u4e49\u7684\u5c5e\u6027\u6839\u636e\u8bbe\u5907\u7aef\u7684\u4e1a\u52a1\u903b\u8f91\u5411\u4e91\u7aef\u4e0a\u62a5\u3002 \u8bbe\u5907\u8fdc\u7a0b\u63a7\u5236\uff1a\u4ece\u4e91\u7aef\u5411\u8bbe\u5907\u7aef\u4e0b\u53d1\u63a7\u5236\u6307\u4ee4\uff0c\u5373\u8bbe\u7f6e\u8bbe\u5907\u53ef\u5199\u5c5e\u6027\u3002 \u83b7\u53d6\u8bbe\u5907\u6700\u65b0\u4e0a\u62a5\u4fe1\u606f\uff1a\u83b7\u53d6\u8bbe\u5907\u6700\u65b0\u7684\u4e0a\u62a5\u6570\u636e\u3002 \u8bbe\u5907\u4e8b\u4ef6\u4e0a\u62a5\uff1a\u8bbe\u5907\u53ef\u6839\u636e\u5b9a\u4e49\u7684\u6570\u636e\u6a21\u677f\u4e2d\u7684\u4e8b\u4ef6\uff0c\u5f53\u4e8b\u4ef6\u88ab\u89e6\u53d1\uff0c\u5219\u6839\u636e\u8bbe\u5907\u4e8b\u4ef6\u4e0a\u62a5\u7684\u534f\u8bae\u4e0a\u62a5\u544a\u8b66\u3001\u6545\u969c\u7b49\u4e8b\u4ef6\u4fe1\u606f\u3002 \u8bbe\u5907\u884c\u4e3a\uff1a\u4e91\u7aef\u53ef\u4ee5\u901a\u8fc7 RPC \u7684\u65b9\u5f0f\u6765\u8981\u6c42\u8bbe\u5907\u6267\u884c\u67d0\u4e2a\u52a8\u4f5c\u884c\u4e3a\uff0c\u9002\u7528\u4e8e\u5e94\u7528\u9700\u8981\u5b9e\u65f6\u83b7\u53d6\u8bbe\u5907\u7684\u6267\u884c\u7ed3\u679c\u7684\u573a\u666f\u3002 3.4.1. \u8bbe\u5907\u5c5e\u6027\u4e0a\u62a5 \u8bbe\u5907\u5411\u4e91\u7aef\u4e0a\u62a5\u6570\u636e\u7684topic\u5982\u4e0b\uff1a \u4e0a\u884c\u8bf7\u6c42 Topic\uff1a $thing/up/property/{ProductID}/{DeviceName} \u4e0a\u884c\u54cd\u5e94 Topic\uff1a $thing/down/property/{ProductID}/{DeviceName} \u8fd9\u4e24\u4e2atopic\u548b\u73a9\u5462\uff1f \u9996\u5148\u8ba2\u9605\u4e0a\u884c\u54cd\u5e94topic\uff1a AT+TCMQTTSUB=\"$thing/down/property/FWR8PGACUS/ESP8266_Dev_001\",0 \u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\uff1a OK +TCMQTTSUB:OK \u63a5\u7740\u5411\u4e0a\u884c\u8bf7\u6c42topic\u4e0a\u62a5\u6570\u636e\uff0c\u4e0a\u62a5\u6570\u636e\u65f6\u5e73\u53f0\u4e0d\u4ec5\u89c4\u5b9a\u4e86topic\uff0c\u8fd8\u89c4\u5b9a\u4e86\u6570\u636e\u5185\u5bb9\uff0c\u5982\u4e0b\uff1a { \"method\":\"report\", \"clientToken\":\"clientToken-145023f5-bc9b-4174-ba3b-430ba5956e5c\", \"params\": { \"brightness\":55, \"name\":\"bedroom\", \"power_switch\":1, \"color\":2 } } \u5176\u4e2d\u6bcf\u4e00\u9879\u7684\u610f\u4e49\u5982\u4e0b; \u53c2\u6570 \u7c7b\u578b \u8bf4\u660e method String report \u8868\u793a\u8bbe\u5907\u5c5e\u6027\u4e0a\u62a5\u3002 clientToken String \u7528\u4e8e\u4e0a\u4e0b\u884c\u6d88\u606f\u914d\u5bf9\u6807\u8bc6 timestamp Integer \u5c5e\u6027\u4e0a\u62a5\u7684\u65f6\u95f4 params JSON JSON \u7ed3\u6784\u5185\u4e3a\u8bbe\u5907\u4e0a\u62a5\u7684\u5c5e\u6027\u503c \u6240\u4ee5\u7ec4\u5408\u51fa\u6765\u4e0a\u62a5\u6570\u636e\u7684AT\u6307\u4ee4\u5982\u4e0b\uff1a AT+TCMQTTPUB=\"$thing/up/property/FWR8PGACUS/ESP8266_Dev_001\",0,\"{\\\"method\\\":\\\"report\\\"\\,\\\"clientToken\\\":\\\"clientToken-145023f5-bc9b-4174-ba3b-430ba5956e5c\\\"\\,\\\"params\\\":{\\\"brightness\\\":55\\,\\\"name\\\":\\\"bedroom\\\"\\,\\\"power_switch\\\":1\\,\\\"color\\\":2}}\" \u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\uff1a OK +TCMQTTPUB:OK \u540c\u65f6\uff0c\u56e0\u4e3a\u8ba2\u9605\u4e86\u4e0a\u884c\u54cd\u5e94topic\uff0c\u6240\u4ee5\u6a21\u7ec4\u4f1a\u6536\u5230\u4e91\u7aef\u4e0b\u53d1\u7684\u54cd\u5e94\u5e76\u901a\u8fc7URC\u6a21\u5f0f\u4e0a\u62a5\uff1a +TCMQTTRCVPUB:\"$thing/down/property/FWR8PGACUS/ESP8266_Dev_001\",118,\"{\"method\":\"report_reply\",\"clientToken\":\"clientToken-145023f5-bc9b-4174-ba3b-430ba5956e5c\",\"code\":0,\"status\":\"success\"}\" \u4e91\u7aef\u54cd\u5e94\u62a5\u6587\u6574\u7406\u4e00\u4e0b\u683c\u5f0f\u5982\u4e0b\uff1a { \"method\":\"report_reply\", \"clientToken\":\"clientToken-145023f5-bc9b-4174-ba3b-430ba5956e5c\", \"code\":0, \"status\":\"success\" } \u5176\u4e2d\u6bcf\u4e00\u9879\u4e5f\u6709\u5177\u4f53\u7684\u542b\u4e49\uff1a \u53c2\u6570 \u7c7b\u578b \u8bf4\u660e method String report_reply \u8868\u793a\u4e91\u7aef\u63a5\u6536\u8bbe\u5907\u4e0a\u62a5\u540e\u7684\u54cd\u5e94\u62a5\u6587 clientToken String \u7528\u4e8e\u4e0a\u4e0b\u884c\u6d88\u606f\u914d\u5bf9\u6807\u8bc6 code Integer 0\u8868\u793a\u4e91\u7aef\u6210\u529f\u6536\u5230\u8bbe\u5907\u4e0a\u62a5\u7684\u5c5e\u6027 status String \u5f53code\u975e0\u7684\u65f6\u5019, \u63d0\u793a\u9519\u8bef\u4fe1\u606f \u5728\u4e91\u7aef\u67e5\u770b\u8bbe\u5907\u4e0a\u62a5\u7684\u6570\u636e\uff1a \u540c\u65f6\u5728\u8bbe\u5907\u65e5\u5fd7\u4e2d\u53ef\u4ee5\u67e5\u770b\u8bbe\u522b\u4e0a\u62a5\u7684\u6570\u636e\u5185\u5bb9\u3002 3.4.2. \u8bbe\u5907\u8fdc\u7a0b\u63a7\u5236 \u7ecf\u8fc73.4.1\u8282\u7684\u73a9\u6cd5\u8bf4\u660e\uff0c\u540e\u7eed\u90fd\u662f\u4e00\u6837\u7684\u73a9\u6cd5\u3002 \u4e91\u7aef\u4e0b\u53d1\u63a7\u5236\u6307\u4ee4\u7684 Topic\u5982\u4e0b\uff1a \u4e0b\u53d1 Topic\uff1a $thing/down/property/{ProductID}/{DeviceName} \u54cd\u5e94 Topic\uff1a $thing/up/property/{ProductID}/{DeviceName} \u4e0b\u9762\u8bb2\u8ff0\u5982\u4f55\u73a9\u3002 \u9996\u5148\u8ba2\u9605\u4e0b\u53d1Topic\uff1a AT+TCMQTTSUB=\"$thing/down/property/FWR8PGACUS/ESP8266_Dev_001\",0 \u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\uff0c\u8ba2\u9605\u6210\u529f\uff1a OK +TCMQTTSUB:OK \u7136\u540e\u5728\u4e91\u7aef\u8fdb\u5165\u8bbe\u5907\u5728\u7ebf\u8c03\u8bd5\uff0c\u4fee\u6539\u706f\u7684\u5c5e\u6027\uff0c\u7136\u540e\u4e0b\u53d1\u63a7\u5236\u547d\u4ee4\uff1a \u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u53ef\u4ee5\u770b\u5230\u8bbe\u5907\u6536\u5230\u4e86\u4e91\u7aef\u4e0b\u53d1\u7684\u6570\u636e\uff0c\u5e76\u4ee5URC\u6a21\u5f0f\u4e0a\u62a5\uff1a +TCMQTTRCVPUB:\"$thing/down/property/FWR8PGACUS/ESP8266_Dev_001\",156,\"{\"method\":\"control\",\"clientToken\":\"clientToken-e037d04b-c3a4-4350-8d67-5c6be19b888a\",\"params\":{\"name\":\"bedroom\",\"power_switch\":0,\"color\":0,\"brightness\":30}}\" \u6574\u7406\u4e00\u4e0bjson\u5185\u5bb9\u7684\u683c\u5f0f\uff0c\u53ef\u4ee5\u770b\u5230\u4e0e\u6211\u4eec\u671f\u5f85\u4e0b\u53d1\u7684\u6570\u636e\u76f8\u5bf9\u5e94\uff1a { \"method\":\"control\", \"clientToken\":\"clientToken-e037d04b-c3a4-4350-8d67-5c6be19b888a\", \"params\": { \"name\":\"bedroom\", \"power_switch\":0, \"color\":0, \"brightness\":30 } } \u6ce8\u610f\uff0c\u6b64\u65f6\u8bbe\u5907\u8fd8\u9700\u8981\u624b\u52a8\u7ed9\u5e73\u53f0\u56de\u590d\u5185\u5bb9\u7ed9\u4e0b\u53d1\u54cd\u5e94topic\uff0c\u5185\u5bb9\u683c\u5f0f\u5982\u4e0b\uff1a { \"method\":\"control_reply\", \"clientToken\":\"clientToken-e037d04b-c3a4-4350-8d67-5c6be19b888a\", \"code\":0, \"status\":\"success\" } \u7ec4\u5408\u51fa\u6765\u53d1\u5e03\u56de\u5e94\u6d88\u606f\u7684AT\u6307\u4ee4\u5982\u4e0b\uff1a AT+TCMQTTPUB=\"$thing/up/property/FWR8PGACUS/ESP8266_Dev_001\",0,\"{ \\\"method\\\":\\\"control_reply\\\"\\, \\\"clientToken\\\":\\\"clientToken-e037d04b-c3a4-4350-8d67-5c6be19b888a\\\"\\, \\\"code\\\":0\\, \\\"status\\\":\\\"success\\\" }\" \u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\uff1a OK +TCMQTTPUB:OK 3.4.3. \u83b7\u53d6\u8bbe\u5907\u6700\u65b0\u4e0a\u62a5\u4fe1\u606f \u8bbe\u5907\u4ece\u4e91\u7aef\u63a5\u6536\u6700\u65b0\u6d88\u606f\u4f7f\u7528\u7684 Topic\u5982\u4e0b\uff1a \u8bf7\u6c42 Topic\uff1a $thing/up/property/{ProductID}/{DeviceName} \u54cd\u5e94 Topic\uff1a $thing/down/property/{ProductID}/{DeviceName} \u9996\u5148\u8ba2\u9605\u54cd\u5e94topic\uff08\u4e4b\u524d\u5df2\u7ecf\u8ba2\u9605\u8fc7\uff0c\u4e0d\u7528\u91cd\u590d\u8ba2\u9605\uff09\u3002 \u5411\u8bf7\u6c42Topic\u53d1\u9001\u6570\u636e\uff0c\u8bf7\u6c42\u5185\u5bb9\u5982\u4e0b\uff1a { \"method\": \"get_status\", \"clientToken\": \"123\", \"type\" : \"report\", \"showmeta\": 0 } \u7ec4\u5408\u4e00\u4e0b\u53d1\u51fa\u7684AT\u6307\u4ee4\u5982\u4e0b\uff1a AT+TCMQTTPUB=\"$thing/up/property/FWR8PGACUS/ESP8266_Dev_001\",0,\"{ \\\"method\\\": \\\"get_status\\\"\\, \\\"clientToken\\\": \\\"123\\\"\\, \\\"type\\\" : \\\"report\\\"\\, \\\"showmeta\\\": 0 }\" \u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\uff1a OK +TCMQTTPUB:OK \u540c\u65f6\u8bbe\u5907\u6536\u5230\u4e86\u4e91\u7aef\u7684\u54cd\u5e94\uff1a +TCMQTTRCVPUB:\"$thing/down/property/FWR8PGACUS/ESP8266_Dev_001\",175,\"{\"method\":\"get_status_reply\",\"clientToken\":\"123\",\"code\":0,\"status\":\"success\",\"type\":\"report\",\"data\":{\"reported\":{\"brightness\":55,\"name\":\"bedroom\",\"power_switch\":1,\"color\":2}}}\" \u5c06\u5176\u4e2d\u7684json\u5185\u5bb9\u6574\u7406\u683c\u5f0f\u5982\u4e0b\uff0c\u548c\u5f53\u524d\u8bbe\u5907\u6700\u540e\u4e00\u6b21\u4e0a\u62a5\u6570\u636e\u7684\u72b6\u6001\u5bf9\u5e94\uff1a { \"method\":\"get_status_reply\", \"clientToken\":\"123\", \"code\":0, \"status\":\"success\", \"type\":\"report\", \"data\": { \"reported\": { \"brightness\":55, \"name\":\"bedroom\", \"power_switch\":1, \"color\":2 } } } 3.4.4. \u8bbe\u5907\u4e8b\u4ef6\u4e0a\u62a5 \u8bbe\u5907\u5411\u4e91\u7aef\u4e0a\u62a5\u4e8b\u4ef6\u7684 Topic\u5982\u4e0b\uff1a \u4e0a\u884c\u8bf7\u6c42 Topic\uff1a $thing/up/event/{ProductID}/{DeviceName} \u4e0a\u884c\u54cd\u5e94 Topic\uff1a $thing/down/event/{ProductID}/{DeviceName} \u9996\u5148\u8ba2\u9605\u4e0a\u884c\u54cd\u5e94Topic\uff1a AT+TCMQTTSUB=\"$thing/down/event/FWR8PGACUS/ESP8266_Dev_001\",0 \u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\uff1a OK +TCMQTTSUB:OK \u63a5\u7740\u5411\u4e0a\u884c\u8bf7\u6c42Topic\u53d1\u5e03\u6d88\u606f\uff0c\u4e8b\u4ef6\u5185\u5bb9\u683c\u5f0f\u5982\u4e0b\uff1a { \"method\":\"event_post\", \"clientToken\":\"123\", \"version\":\"1.0\", \"eventId\":\"low_voltage\", \"type\":\"alert \", \"params\": { \"Voltage\":2.8 } } \u5176\u4e2d\u53c2\u6570\u8bf4\u660e\u5982\u4e0b\uff1a \u53c2\u6570 \u7c7b\u578b \u8bf4\u660e method String event_post \u8868\u793a\u4e8b\u4ef6\u4e0a\u62a5\u3002 clientToken String \u6d88\u606f ID\uff0c\u56de\u590d\u7684\u6d88\u606f\u5c06\u4f1a\u8fd4\u56de\u8be5\u6570\u636e, \u7528\u4e8e\u8bf7\u6c42\u54cd\u5e94\u6d88\u606f\u7684\u5bf9\u6bd4\u3002 version String \u534f\u8bae\u7248\u672c\uff0c\u9ed8\u8ba4\u4e3a1.0\u3002 eventId String \u4e8b\u4ef6\u7684 ID\uff0c\u5728\u6570\u636e\u6a21\u677f\u4e8b\u4ef6\u4e2d\u5b9a\u4e49\u3002 params String \u4e8b\u4ef6\u7684\u53c2\u6570\uff0c\u5728\u6570\u636e\u6a21\u677f\u4e8b\u4ef6\u4e2d\u5b9a\u4e49\u3002 timestamp Integer \u4e8b\u4ef6\u4e0a\u62a5\u7684\u65f6\u95f4\uff0c\u4e0d\u586b\u5199\u8be5\u5b57\u6bb5\u8868\u793a\u5c31\u4f7f\u7528\u4e8b\u4ef6\u4e0a\u62a5\u672c\u8eab\u7684\u65f6\u95f4\u3002 type String \u4e8b\u4ef6\u7c7b\u578b\uff0cinfo \u4e3a\u4fe1\u606f\uff0calert \u4e3a\u544a\u8b66\uff0cfault \u4e3a\u6545\u969c\u3002 \u7ec4\u5408\u51fa\u5411\u4e0a\u884c\u8bf7\u6c42\u53d1\u9001\u7684AT\u547d\u4ee4\u5982\u4e0b\uff1a AT+TCMQTTPUB=\"$thing/up/event/FWR8PGACUS/ESP8266_Dev_001\",0,\"{ \\\"method\\\":\\\"event_post\\\"\\, \\\"clientToken\\\":\\\"123\\\"\\, \\\"version\\\":\\\"1.0\\\"\\, \\\"eventId\\\":\\\"low_voltage\\\"\\, \\\"type\\\":\\\"alert \\\"\\, \\\"params\\\": { \\\"voltage\\\":2.8 } }\" \u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\uff0c\u4e0a\u62a5\u6210\u529f\uff1a OK +TCMQTTPUB:OK \u540c\u65f6\u6536\u5230\u5e73\u53f0\u53d1\u7ed9\u8bbe\u5907\u7684\u56de\u5e94\uff1a +TCMQTTRCVPUB:\"$thing/down/event/FWR8PGACUS/ESP8266_Dev_001\",75,\"{\"method\":\"event_reply\",\"clientToken\":\"123\",\"code\":0,\"status\":\"\",\"data\":{}}\" \u5176\u4e2d\u7684json\u6570\u636e\u6574\u7406\u4e00\u4e0b\u5982\u4e0b\uff1a { \"method\":\"event_reply\", \"clientToken\":\"123\", \"code\":0, \"status\":\"\", \"data\":{} } \u5728\u4e91\u7aef\u8bbe\u5907\u4e8b\u4ef6\u65e5\u5fd7\u4e2d\u53ef\u4ee5\u770b\u5230\uff1a 3.4.5. \u8bbe\u5907\u884c\u4e3a\u8c03\u7528 \u5f53\u5e94\u7528\u901a\u8fc7\u4e91\u7aef\u5411\u8bbe\u5907\u53d1\u8d77\u67d0\u4e2a\u884c\u4e3a\u8c03\u7528\u65f6\uff0c\u5f00\u53d1\u5e73\u53f0\u4e3a\u8bbe\u5907\u884c\u4e3a\u7684\u5904\u7406\u8bbe\u5b9a\u4e86\u9ed8\u8ba4\u7684 Topic \u5982\u4e0b\uff1a \u5e94\u7528\u8c03\u7528\u8bbe\u5907\u884c\u4e3a Topic\uff1a $thing/down/action/{ProductID}/{DeviceName} \u8bbe\u5907\u54cd\u5e94\u884c\u4e3a\u6267\u884c\u7ed3\u679c Topic\uff1a $thing/up/action/{ProductID}/{DeviceName} \u9996\u5148\u8ba2\u9605\u8bbe\u5907\u5e94\u7528\u8c03\u7528\u8bbe\u5907\u884c\u4e3a\u7684Topic\uff1a AT+TCMQTTSUB=\"$thing/down/action/FWR8PGACUS/ESP8266_Dev_001\",0 \u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\uff1a OK +TCMQTTSUB:OK \u667a\u80fd\u706f\u9ed8\u8ba4\u6570\u636e\u6a21\u677f\u4e2d\u6ca1\u6709\u2026\u2026\u9700\u8981\u624b\u52a8\u521b\u5efa\uff0c\u65b0\u5efa\u4e00\u4e2a\u884c\u4e3a\u529f\u80fd\uff1a \u65b0\u5efa\u4e4b\u540e\u5728\u81ea\u5b9a\u4e49\u529f\u80fd\u8fd9\u4e00\u680f\u5373\u53ef\u770b\u5230\uff1a \u8fdb\u5165\u8bbe\u5907\u5728\u7ebf\u8c03\u8bd5\u754c\u9762\uff0c\u53d1\u9001\u884c\u4e3a\uff1a \u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u53ef\u4ee5\u770b\u5230\u6a21\u7ec4\u63a5\u6536\u5230\u4e91\u7aef\u7684\u6d88\u606f\uff1a +TCMQTTRCVPUB:\"$thing/down/action/FWR8PGACUS/ESP8266_Dev_001\",132,\"{\"method\":\"action\",\"clientToken\":\"1d603a84c71e4d1da38c2dacce27112e\",\"actionId\":\"blink\",\"timestamp\":1593396804,\"params\":{\"period\":5}}\" \u6574\u7406\u4e00\u4e0bjson\u683c\u5f0f\u5982\u4e0b\uff1a { \"method\":\"action\", \"clientToken\":\"1d603a84c71e4d1da38c2dacce27112e\", \"actionId\":\"blink\", \"timestamp\":1593396804, \"params\": { \"period\":5 } } \u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u5411\u8bbe\u5907\u54cd\u5e94\u884c\u4e3a\u6267\u884c\u7ed3\u679c Topic\u56de\u590d\u54cd\u5e94\uff0c\u54cd\u5e94\u5185\u5bb9\u683c\u5f0f\u5982\u4e0b\uff1a { \"method\": \"action_reply\", \"clientToken\": \"1d603a84c71e4d1da38c2dacce27112e\", \"code\": 0, \"status\": \"success\", \"response\": { \"Code\": 0 } } \u7ec4\u5408\u51fa\u53d1\u9001\u54cd\u5e94\u7684AT\u6307\u4ee4\u5982\u4e0b; AT+TCMQTTPUB=\"$thing/up/action/FWR8PGACUS/ESP8266_Dev_001\",0,\"{ \\\"method\\\": \\\"action_reply\\\"\\, \\\"clientToken\\\": \\\"1d603a84c71e4d1da38c2dacce27112e\\\"\\, \\\"code\\\": 0\\, \\\"status\\\": \\\"success\\\"\\, \\\"response\\\": { \\\"Code\\\": 0 } }\" \u8fd4\u56de\u7ed3\u679c\u4e3a\uff1a OK +TCMQTTPUB:OK \u81f3\u6b64\uff0c\u4f7f\u7528ESP8266\u817e\u8baf\u4e91\u5b9a\u5236\u56fa\u4ef6\u5bf9\u63a5\u817e\u8baf\u4e91IoT Explorer\u5e73\u53f0\u7684\u6d4b\u8bd5\u5b8c\u6210\u3002","title":"24.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Explorer"},{"location":"24.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Explorer/#1-esp8266","text":"\u817e\u8baf\u4e91IoT AT\u6307\u4ee4\u662f\u4e00\u5957\u9488\u5bf9\u4f7f\u7528\u901a\u8baf\u6a21\u7ec4\uff082G/4G/NB/WIFI\uff09\u63a5\u5165\u817e\u8baf\u4e91\u7269\u8054\u5e73\u53f0\u7684\u5b9a\u5236AT\u6307\u4ee4\u96c6\uff0c\u5982\u679c\u901a\u8baf\u6a21\u7ec4\u5b9e\u73b0\u4e86\u8be5\u6307\u4ee4\u96c6\uff0c\u5219\u8bbe\u5907\u63a5\u5165\u548c\u901a\u8baf\u66f4\u4e3a\u7b80\u5355\uff0c\u6240\u9700\u4ee3\u7801\u91cf\u66f4\u5c11\u3002 ESP8266\u4f5c\u4e3aIoT\u9886\u57df\u4f7f\u7528\u6700\u5e7f\u6cdb\u7684\u4e00\u6b3eWiFi\u82af\u7247/\u6a21\u7ec4\uff0c\u6211\u4eec\u5728\u5176\u901a\u7528AT\u6307\u4ee4\u57fa\u7840\u4e0a\uff0c\u589e\u52a0\u4e86\u817e\u8baf\u4e91IoT AT\u6307\u4ee4\u96c6\uff0c\u5f62\u6210\u4e00\u4e2a\u5b9a\u5236\u7684\u6a21\u7ec4\u56fa\u4ef6QCloud_IoT_AT_ESP8266\uff0c\u817e\u8baf\u4e91IoT\u5b9a\u5236\u7684AT\u6a21\u7ec4\u56fa\u4ef6QCloud_IoT_AT_ESP8266\uff0c\u9002\u7528\u4e8e\u6240\u6709FLASH\u5927\u5c0f\u4e3a2MB\u6216\u80052MB\u4ee5\u4e0a\u7684ESP8266\u6a21\u7ec4\u3002 \u56fa\u4ef6\u70e7\u5f55\u65b9\u6cd5\u8bf7\u9605\u8bfb\u6587\u6863\uff1a \u817e\u8baf\u4e91 IoT AT ESP8266 \u5b9a\u5236\u56fa\u4ef6\u53ca\u8bf4\u660e \u3002","title":"1. \u817e\u8baf\u4e91ESP8266\u5b9a\u5236\u56fa\u4ef6\u8bf4\u660e\u53ca\u70e7\u5f55"},{"location":"24.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Explorer/#2","text":"\u767b\u5f55 \u817e\u8baf\u4e91\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\uff08IoT Explorer\uff09 ,\u70b9\u51fb\u201c\u7acb\u5373\u4f7f\u7528\u201d\u8fdb\u5165\u63a7\u5236\u53f0\u3002","title":"2. \u4e91\u7aef\u914d\u7f6e"},{"location":"24.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Explorer/#21","text":"\u9879\u76ee\u662f\u4e3a\u4e86\u7528\u6237\u9762\u5bf9\u4e0d\u540c\u7684\u4ea7\u54c1\u8fed\u4ee3\u6216\u4e0d\u540c\u7684\u9879\u76ee\u89d2\u8272\u800c\u8bbe\u8ba1\u7684\u4e00\u79cd\u9694\u79bb\u673a\u5236\uff0c\u4fbf\u4e8e\u7528\u6237\u6e05\u6670\u7ba1\u7406\u7269\u8054\u7f51\u9879\u76ee\uff0c\u5e76\u80fd\u7075\u6d3b\u5730\u914d\u7f6e\u9879\u76ee\u6743\u9650\u3002 \u9879\u76ee\u4e0b\u53ef\u4ee5\u5efa\u7acb\u591a\u4e2a\u4ea7\u54c1\u4e0e\u5e94\u7528\uff0c\u5e94\u7528\u9ed8\u8ba4\u6709\u6743\u9650\u8bbf\u95ee\u8be5\u9879\u76ee\u4e0b\u7684 \u6240\u6709\u4ea7\u54c1 \uff1b \u6bcf\u4e2a\u9879\u76ee\u4f1a\u6709\u81ea\u5df1\u7684\u552f\u4e00 ID\uff0c\u6570\u636e\u4f1a\u6839\u636e\u9879\u76ee\u8fdb\u884c\u9694\u79bb\uff0c\u4ee5\u786e\u4fdd\u6570\u636e\u5b89\u5168\uff1b \u9879\u76ee\u5220\u9664\u540e\uff0c\u8be5\u9879\u76ee\u6240\u5c5e\u4ea7\u54c1\u7b49\u6570\u636e\u90fd\u5c06\u88ab\u5220\u9664\u4e14\u4e0d\u80fd\u6062\u590d\uff1b \u5f00\u53d1\u5e73\u53f0\u63d0\u4f9b\u8d44\u6e90\u7ea7\u7684\u6743\u9650\u63a7\u5236\uff0c\u53ef\u4e3a\u4e0d\u540c\u7684\u5b50\u7528\u6237\u5206\u914d\u9879\u76ee\u7ea7\u3001\u4ea7\u54c1\u7ea7\u7684\u6743\u9650\u63a7\u5236\uff1b \u70b9\u51fb\u65b0\u5efa\u9879\u76ee\uff0c\u586b\u5199\u9879\u76ee\u540d\u79f0\u548c\u7b80\u4ecb\uff1a","title":"2.1. \u65b0\u5efa\u9879\u76ee"},{"location":"24.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Explorer/#22","text":"","title":"2.2. \u4ea7\u54c1\u5f00\u53d1"},{"location":"24.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Explorer/#221","text":"\u70b9\u51fb\u9879\u76ee\u540d\u79f0\u8fdb\u5165\u5230\u8be5\u9879\u76ee\u4e2d\uff0c\u70b9\u51fb\u65b0\u5efa\u4ea7\u54c1\uff1a \u586b\u5199\u4ea7\u54c1\u7684\u4e00\u4e9b\u4fe1\u606f\uff1a \u4ea7\u54c1\u540d\u79f0\uff1a\u540d\u79f0\u4e3a\u4e2d\u6587\u3001\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u4e0b\u5212\u7ebf\u7684\u7ec4\u5408\uff0c1 - 20\u4f4d\u4e14\u4e0d\u80fd\u4e3a\u7a7a\u3002 \u4ea7\u54c1\u54c1\u7c7b\uff1a\u9009\u62e9\u60a8\u6240\u521b\u5efa\u4ea7\u54c1\u7684\u6240\u5c5e\u54c1\u7c7b\uff0c\u4e0d\u540c\u7c7b\u578b\u4ea7\u54c1\u7684\u5c5e\u6027\u3001\u4e8b\u4ef6\u7b49\u6570\u636e\u6a21\u677f\u4f1a\u6709\u6240\u4e0d\u540c\u3002\u8be6\u60c5\u8bf7\u53c2\u89c1 \u6570\u636e\u6a21\u677f\u3002 \u8bbe\u5907\u7c7b\u578b\uff1a\u8bbe\u5907\u4f7f\u75282G/3G/4G/Wi-Fi\u65e0\u7ebf\u901a\u4fe1\u6216\u6709\u7ebf\u901a\u4fe1\u65b9\u5f0f\uff0c\u7f51\u5173\u53ef\u63d0\u4f9b\u4e91\u7aef\u901a\u4fe1\u80fd\u529b\uff0c\u5e2e\u52a9\u8bbe\u5907\u4e0e\u5e73\u53f0\u901a\u4fe1\u3002 \u8ba4\u8bc1\u65b9\u5f0f\uff1a\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u63d0\u4f9b\u4e24\u79cd\u8ba4\u8bc1\u65b9\u5f0f\u7528\u4e8e\u8bbe\u5907\u4e0e\u5e73\u53f0\u4e4b\u95f4\u9274\u6743\u8ba4\u8bc1\u3002 \u8bc1\u4e66\u8ba4\u8bc1\uff1a\u5728\u521b\u5efa\u8bbe\u5907\u65f6\uff0c\u5e73\u53f0\u5c06\u4e3a\u8bbe\u5907\u751f\u6210\u4e00\u4e2a\u8bc1\u4e66\u6587\u4ef6\u548c\u4e00\u4e2a\u79c1\u94a5\u6587\u4ef6\uff0c\u5b9e\u73b0\u8bbe\u5907\u4e0e\u4e91\u4e4b\u95f4\u7684\u53cc\u5411\u8ba4\u8bc1\u3002 \u5bc6\u94a5\u8ba4\u8bc1\uff1a\u5728\u521b\u5efa\u8bbe\u5907\u65f6\uff0c\u4f7f\u7528\u5e73\u53f0\u4e3a\u8bbe\u5907\u968f\u673a\u751f\u6210\u7684 PSK\u3002 \u901a\u4fe1\u65b9\u5f0f\uff1a\u60a8\u53ef\u4ee5\u9009\u62e9 Wi-Fi\u3001\u79fb\u52a8\u8702\u7a9d\uff082G/3G/4G\uff09\u548c\u5176\u4ed6\u901a\u4fe1\u65b9\u5f0f\u3002 \u6570\u636e\u534f\u8bae\uff1a\u9ed8\u8ba4\u91c7\u7528\u6570\u636e\u6a21\u677f\u7684\u6570\u636e\u534f\u8bae\uff0c\u60a8\u4e5f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u534f\u8bae\u8fdb\u884c\u900f\u4f20\u3002 \u63cf\u8ff0\uff1a\u5b57\u6570\u4e0d\u80fd\u8d85\u8fc780\u4e2a\uff0c\u60a8\u53ef\u4ee5\u6839\u636e\u9700\u8981\u9009\u586b\u3002 \u4ea7\u54c1\u65b0\u5efa\u6210\u529f\u540e\uff0c\u53ef\u5728\u4ea7\u54c1\u5217\u8868\u9875\u67e5\u770b\u5230\u201c\u667a\u80fd\u706f\u201d\u3002","title":"2.2.1. \u65b0\u5efa\u4ea7\u54c1"},{"location":"24.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Explorer/#222","text":"\u6570\u636e\u6a21\u677f\u662f\u5c06\u7269\u7406\u5b9e\u4f53\u8bbe\u5907\u8fdb\u884c\u6570\u5b57\u5316\u63cf\u8ff0\uff0c\u6784\u5efa\u5176\u6570\u5b57\u6a21\u578b\u3002\u5728\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u5b9a\u4e49\u6570\u636e\u6a21\u677f\u5373\u5b9a\u4e49\u4ea7\u54c1\u529f\u80fd\u3002\u5b8c\u6210\u529f\u80fd\u5b9a\u4e49\u540e\uff0c\u7cfb\u7edf\u5c06\u81ea\u52a8\u751f\u6210\u8be5\u4ea7\u54c1\u7684\u6570\u636e\u6a21\u677f\u3002 \u8fdb\u5165\u4ea7\u54c1\uff0c\u70b9\u51fb\u65b0\u5efa\u529f\u80fd\u3002 \u586b\u5199\u529f\u80fd\u4fe1\u606f\u3002 \u529f\u80fd\u7c7b\u578b\u5305\u542b\u4e09\u5143\u7d20\uff1a \u5c5e\u6027\uff1a\u5305\u62ec\u5e03\u5c14\u578b\u3001\u6574\u6570\u578b\u3001\u5b57\u7b26\u578b\u3001\u6d6e\u70b9\u578b\u3001\u679a\u4e3e\u578b\u548c\u65f6\u95f4\u578b\u7b496\u79cd\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff1b \u4e8b\u4ef6\uff1a\u5305\u62ec\u544a\u8b66\u3001\u6545\u969c\u548c\u4fe1\u606f\u4e09\u79cd\u7c7b\u578b\uff0c\u4e8b\u4ef6\u578b\u529f\u80fd\u5c5e\u6027\u53ef\u4ee5\u6dfb\u52a0\u5177\u4f53\u7684\u4e8b\u4ef6\u53c2\u6570\uff0c\u8fd9\u4e9b\u53c2\u6570\u53ef\u4ee5\u7531\u5c5e\u6027\u4e2d6\u79cd\u57fa\u672c\u6570\u636e\u7c7b\u578b\u7ec4\u6210\uff1b \u884c\u4e3a\uff1a\u7528\u4e8e\u5b9e\u73b0\u66f4\u590d\u6742\u7684\u4e1a\u52a1\u903b\u8f91\uff0c\u53ef\u5305\u542b\u8f93\u5165\u53c2\u6570\u548c\u8f93\u51fa\u53c2\u6570\uff0c\u53ef\u7528\u4e8e\u8ba9\u8bbe\u5907\u6267\u884c\u67d0\u9879\u7279\u5b9a\u7684\u4efb\u52a1\u3002\u884c\u4e3a\u7684\u8f93\u5165\u53c2\u6570\u548c\u8f93\u51fa\u53c2\u6570\u53ef\u6dfb\u52a0\u4e0a\u8ff06\u79cd\u5c5e\u6027\u7684\u57fa\u672c\u6570\u636e\u7c7b\u578b\u3002 \u529f\u80fd\u5143\u7d20 \u529f\u80fd\u63cf\u8ff0 \u529f\u80fd\u6807\u8bc6\u7b26 \u5c5e\u6027 \u7528\u4e8e\u63cf\u8ff0\u8bbe\u5907\u7684\u5b9e\u65f6\u72b6\u6001\uff0c\u652f\u6301\u8bfb\u53d6\u548c\u8bbe\u7f6e\uff0c\u5982\u6a21\u5f0f\u3001\u4eae\u5ea6\u3001\u5f00\u5173\u7b49\u3002 PropertiesId \u4e8b\u4ef6 \u7528\u4e8e\u63cf\u8ff0\u8bbe\u5907\u8fd0\u884c\u65f6\u7684\u4e8b\u4ef6\uff0c\u5305\u62ec\u544a\u8b66\u3001\u4fe1\u606f\u548c\u6545\u969c\u7b49\u4e09\u79cd\u4e8b\u4ef6\u7c7b\u578b\uff0c\u53ef\u6dfb\u52a0\u591a\u4e2a\u8f93\u51fa\u53c2\u6570\uff0c\u5982\u73af\u5883\u4f20\u611f\u5668\u68c0\u6d4b\u5230\u7a7a\u6c14\u8d28\u91cf\u5f88\u5dee\uff0c\u7a7a\u8c03\u5f02\u5e38\u544a\u8b66\u7b49\u3002 EventId \u884c\u4e3a \u7528\u4e8e\u63cf\u8ff0\u590d\u6742\u7684\u4e1a\u52a1\u903b\u8f91,\u53ef\u6dfb\u52a0\u591a\u4e2a\u8c03\u7528\u53c2\u6570\u548c\u8fd4\u56de\u53c2\u6570,\u7528\u4e8e\u8ba9\u8bbe\u5907\u6267\u884c\u67d0\u9879\u5b9a\u7279\u5b9a\u7684\u4efb\u52a1\uff0c\u4f8b\u5982\uff0c\u5f00\u9501\u52a8\u4f5c\u9700\u8981\u77e5\u9053\u662f\u54ea\u4e2a\u7528\u6237\u5728\u4ec0\u4e48\u65f6\u95f4\u5f00\u9501\uff0c\u9501\u7684\u72b6\u6001\u5982\u4f55\u7b49\u3002 ActionId \u6570\u636e\u7c7b\u578b\u652f\u63016\u79cd\uff1a \u5e03\u5c14\u578b\uff1a\u975e\u771f\u5373\u5047\u7684\u4e8c\u503c\u578b\u53d8\u91cf\u3002\u4f8b\u5982\uff0c\u5f00\u5173\u529f\u80fd\u3002 \u6574\u6570\u578b\uff1a\u53ef\u7528\u4e8e\u7ebf\u6027\u8c03\u8282\u7684\u6574\u6570\u53d8\u91cf\u3002\u4f8b\u5982\uff0c\u7a7a\u8c03\u7684\u6e29\u5ea6\u3002 \u5b57\u7b26\u578b\uff1a\u4ee5\u5b57\u7b26\u4e32\u5f62\u5f0f\u8868\u8fbe\u7684\u529f\u80fd\u70b9\uff0c\u4f8b\u5982\uff0c\u706f\u7684\u4f4d\u7f6e\u3002 \u6d6e\u70b9\u578b\uff1a\u7cbe\u5ea6\u4e3a\u6d6e\u70b9\u578b\u7684\u529f\u80fd\u70b9\u3002\u4f8b\u5982\uff0c\u538b\u529b\u503c\u7684\u8303\u56f4\uff1a0.0 - 24.0\u3002 \u679a\u4e3e\u578b\uff1a\u81ea\u5b9a\u4e49\u7684\u6709\u9650\u96c6\u5408\u503c\u3002\u4f8b\u5982\uff0c\u706f\u7684\u989c\u8272\uff1a\u767d\u8272\u3001\u7ea2\u8272\u3001\u9ec4\u8272\u7b49\u3002 \u65f6\u95f4\u578b\uff1astring \u7c7b\u578b\u7684 UTC \u65f6\u95f4\u6233\uff08\u6beb\u79d2\uff09\u3002 \u9009\u62e9\u201c\u667a\u80fd\u706f\u201d\u7c7b\u578b\u540e\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u751f\u6210\u6807\u51c6\u529f\u80fd\uff1a \u6570\u636e\u6a21\u677f\u662f\u4e00\u4e2a JSON \u683c\u5f0f\u7684\u6587\u4ef6\uff0c\u4f7f\u7528\u6570\u636e\u6a21\u677f\u534f\u8bae\uff0c\u7528\u6237\u7684\u8bbe\u5907\u9700\u6309\u6570\u636e\u6a21\u677f\u5b9a\u4e49\u8981\u6c42\u4f20\u8f93\u8bbe\u5907\u6570\u636e\u5230\u4e91\u7aef\uff0c\u5e76\u53ef\u4f7f\u7528\u57fa\u4e8e\u6570\u636e\u6a21\u677f\u7684\u8bf8\u591a\u4e1a\u52a1\u529f\u80fd\uff0c\u70b9\u51fb\u67e5\u770bjson\u53ef\u4ee5\u770b\u5230\u4e0a\u9762\u521b\u5efa\u529f\u80fd\u7684json\u683c\u5f0f\uff1a { \"version\": \"1.0\", \"properties\": [ { \"id\": \"power_switch\", \"name\": \"\u7535\u706f\u5f00\u5173\", \"desc\": \"\u63a7\u5236\u7535\u706f\u5f00\u706d\", \"required\": true, \"mode\": \"rw\", \"define\": { \"type\": \"bool\", \"mapping\": { \"0\": \"\u5173\", \"1\": \"\u5f00\" } } }, { \"id\": \"color\", \"name\": \"\u989c\u8272\", \"desc\": \"\u706f\u5149\u989c\u8272\", \"mode\": \"rw\", \"define\": { \"type\": \"enum\", \"mapping\": { \"0\": \"Red\", \"1\": \"Green\", \"2\": \"Blue\" } } }, { \"id\": \"brightness\", \"name\": \"\u4eae\u5ea6\", \"desc\": \"\u706f\u5149\u4eae\u5ea6\", \"mode\": \"rw\", \"define\": { \"type\": \"int\", \"unit\": \"%\", \"step\": \"1\", \"min\": \"0\", \"max\": \"100\", \"start\": \"1\" } }, { \"id\": \"name\", \"name\": \"\u706f\u4f4d\u7f6e\u540d\u79f0\", \"desc\": \"\u706f\u4f4d\u7f6e\u540d\u79f0\uff1a\u4e66\u623f\u3001\u5ba2\u5385\u7b49\", \"mode\": \"rw\", \"required\": false, \"define\": { \"type\": \"string\", \"min\": \"0\", \"max\": \"64\" } } ], \"events\": [ { \"id\": \"status_report\", \"name\": \"DeviceStatus\", \"desc\": \"Report the device status\", \"type\": \"info\", \"required\": false, \"params\": [ { \"id\": \"status\", \"name\": \"running_state\", \"desc\": \"Report current device running state\", \"define\": { \"type\": \"bool\", \"mapping\": { \"0\": \"normal\", \"1\": \"fault\" } } }, { \"id\": \"message\", \"name\": \"Message\", \"desc\": \"Some extra message\", \"define\": { \"type\": \"string\", \"min\": \"0\", \"max\": \"64\" } } ] }, { \"id\": \"low_voltage\", \"name\": \"LowVoltage\", \"desc\": \"Alert for device voltage is low\", \"type\": \"alert\", \"required\": false, \"params\": [ { \"id\": \"voltage\", \"name\": \"Voltage\", \"desc\": \"Current voltage\", \"define\": { \"type\": \"float\", \"unit\": \"V\", \"step\": \"1\", \"min\": \"0.0\", \"max\": \"24.0\", \"start\": \"1\" } } ] }, { \"id\": \"hardware_fault\", \"name\": \"Hardware_fault\", \"desc\": \"Report hardware fault\", \"type\": \"fault\", \"required\": false, \"params\": [ { \"id\": \"name\", \"name\": \"Name\", \"desc\": \"Name like: memory,tf card, censors ...\", \"define\": { \"type\": \"string\", \"min\": \"0\", \"max\": \"64\" } }, { \"id\": \"error_code\", \"name\": \"Error_Code\", \"desc\": \"Error code for fault\", \"define\": { \"type\": \"int\", \"unit\": \"\", \"step\": \"1\", \"min\": \"0\", \"max\": \"2000\", \"start\": \"1\" } } ] } ], \"profile\": { \"ProductId\": \"FWR8PGACUS\", \"CategoryId\": \"3\" }, \"actions\": [] }","title":"2.2.2. \u6570\u636e\u6a21\u677f"},{"location":"24.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Explorer/#23","text":"\u8fdb\u5165\u8bbe\u5907\u8c03\u8bd5\u754c\u9762\uff0c\u65b0\u5efa\u8bbe\u5907\uff1a \u8fdb\u5165\u8bbe\u5907\u4e4b\u540e\u5373\u53ef\u770b\u5230\u5bf9\u63a5\u4fe1\u606f\u3002","title":"2.3. \u521b\u5efa\u8bbe\u5907"},{"location":"24.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Explorer/#3","text":"\u4f7f\u7528USB\u8f6c\u4e32\u53e3\u5c06\u70e7\u5f55\u597d\u817e\u8baf\u4e91\u5b9a\u5236\u56fa\u4ef6\u7684ESP8266\u8fde\u63a5\u5230PC\uff0c\u4f7f\u7528\u4e32\u53e3\u52a9\u624b\u6253\u5f00\u4e32\u53e3\u5f00\u59cb\u8c03\u8bd5\u3002","title":"3. \u8bbe\u5907\u7aef\u5bf9\u63a5\u6d4b\u8bd5"},{"location":"24.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Explorer/#31","text":"\u6d4b\u8bd5AT\u6307\u4ee4\u662f\u5426\u6b63\u5e38\uff1a AT OK \u8bbe\u7f6eESP8266\u5de5\u4f5c\u6a21\u5f0f\u4e3aAP\u548cSTA\u5e76\u5b58\uff1a AT+CWMODE=3 OK \u8bbe\u7f6e\u4f20\u8f93\u6a21\u5f0f\u4e3a\u666e\u901a\u4f20\u8f93\u6a21\u5f0f\uff1a AT+CIPMODE=0 OK \u5f00\u542f\u591a\u8def\u6a21\u5f0f\uff1a AT+CIPMUX=1 OK \u5165\u7f51\uff1a AT+CWJAP=\"Mculover666\",\"mculover666\" WIFI CONNECTED WIFI GOT IP OK","title":"3.1. \u5165\u7f51"},{"location":"24.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Explorer/#32","text":"\u793a\u4f8b\uff1a AT+TCDEVINFOSET=1,\"FWR8PGACUS\",\"ESP8266_Dev_001\",\"0VqX0xzrvwmivBHwzuBrCQ==\" OK +TCDEVINFOSET:OK \u6b64\u4fe1\u606f\u4f1a\u4fdd\u5b58\u5230Flash\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u67e5\u770b\uff1a AT+TCDEVINFOSET?","title":"3.2. \u8bbe\u7f6e\u817e\u8baf\u4e91\u5bf9\u63a5\u4fe1\u606f"},{"location":"24.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Explorer/#33","text":"\u793a\u4f8b\uff1a AT+TCMQTTCONN=1,5000,240,1,1 OK +TCMQTTCONN:OK \u8fde\u63a5\u6210\u529f\uff0c\u6b64\u65f6\u5728\u817e\u8baf\u4e91IoT Explorer\u5e73\u53f0\u5373\u53ef\u770b\u5230\u8bbe\u5907\u5728\u7ebf\uff1a","title":"3.3. \u8fde\u63a5\u817e\u8baf\u4e91"},{"location":"24.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Explorer/#34","text":"Explorer\u5e73\u53f0\u76f8\u6bd4IoThub\u5e73\u53f0\uff0c\u652f\u6301\u7684topic\u6bd4\u8f83\u591a\uff0c\u4e3b\u8981\u6709\u5982\u4e0b\u529f\u80fd\uff1a \u8bbe\u5907\u5c5e\u6027\u4e0a\u62a5\uff1a\u8bbe\u5907\u7aef\u5c06\u5b9a\u4e49\u7684\u5c5e\u6027\u6839\u636e\u8bbe\u5907\u7aef\u7684\u4e1a\u52a1\u903b\u8f91\u5411\u4e91\u7aef\u4e0a\u62a5\u3002 \u8bbe\u5907\u8fdc\u7a0b\u63a7\u5236\uff1a\u4ece\u4e91\u7aef\u5411\u8bbe\u5907\u7aef\u4e0b\u53d1\u63a7\u5236\u6307\u4ee4\uff0c\u5373\u8bbe\u7f6e\u8bbe\u5907\u53ef\u5199\u5c5e\u6027\u3002 \u83b7\u53d6\u8bbe\u5907\u6700\u65b0\u4e0a\u62a5\u4fe1\u606f\uff1a\u83b7\u53d6\u8bbe\u5907\u6700\u65b0\u7684\u4e0a\u62a5\u6570\u636e\u3002 \u8bbe\u5907\u4e8b\u4ef6\u4e0a\u62a5\uff1a\u8bbe\u5907\u53ef\u6839\u636e\u5b9a\u4e49\u7684\u6570\u636e\u6a21\u677f\u4e2d\u7684\u4e8b\u4ef6\uff0c\u5f53\u4e8b\u4ef6\u88ab\u89e6\u53d1\uff0c\u5219\u6839\u636e\u8bbe\u5907\u4e8b\u4ef6\u4e0a\u62a5\u7684\u534f\u8bae\u4e0a\u62a5\u544a\u8b66\u3001\u6545\u969c\u7b49\u4e8b\u4ef6\u4fe1\u606f\u3002 \u8bbe\u5907\u884c\u4e3a\uff1a\u4e91\u7aef\u53ef\u4ee5\u901a\u8fc7 RPC \u7684\u65b9\u5f0f\u6765\u8981\u6c42\u8bbe\u5907\u6267\u884c\u67d0\u4e2a\u52a8\u4f5c\u884c\u4e3a\uff0c\u9002\u7528\u4e8e\u5e94\u7528\u9700\u8981\u5b9e\u65f6\u83b7\u53d6\u8bbe\u5907\u7684\u6267\u884c\u7ed3\u679c\u7684\u573a\u666f\u3002","title":"3.4. \u8ba2\u9605\u548c\u53d1\u5e03\u4e3b\u9898"},{"location":"24.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Explorer/#341","text":"\u8bbe\u5907\u5411\u4e91\u7aef\u4e0a\u62a5\u6570\u636e\u7684topic\u5982\u4e0b\uff1a \u4e0a\u884c\u8bf7\u6c42 Topic\uff1a $thing/up/property/{ProductID}/{DeviceName} \u4e0a\u884c\u54cd\u5e94 Topic\uff1a $thing/down/property/{ProductID}/{DeviceName} \u8fd9\u4e24\u4e2atopic\u548b\u73a9\u5462\uff1f \u9996\u5148\u8ba2\u9605\u4e0a\u884c\u54cd\u5e94topic\uff1a AT+TCMQTTSUB=\"$thing/down/property/FWR8PGACUS/ESP8266_Dev_001\",0 \u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\uff1a OK +TCMQTTSUB:OK \u63a5\u7740\u5411\u4e0a\u884c\u8bf7\u6c42topic\u4e0a\u62a5\u6570\u636e\uff0c\u4e0a\u62a5\u6570\u636e\u65f6\u5e73\u53f0\u4e0d\u4ec5\u89c4\u5b9a\u4e86topic\uff0c\u8fd8\u89c4\u5b9a\u4e86\u6570\u636e\u5185\u5bb9\uff0c\u5982\u4e0b\uff1a { \"method\":\"report\", \"clientToken\":\"clientToken-145023f5-bc9b-4174-ba3b-430ba5956e5c\", \"params\": { \"brightness\":55, \"name\":\"bedroom\", \"power_switch\":1, \"color\":2 } } \u5176\u4e2d\u6bcf\u4e00\u9879\u7684\u610f\u4e49\u5982\u4e0b; \u53c2\u6570 \u7c7b\u578b \u8bf4\u660e method String report \u8868\u793a\u8bbe\u5907\u5c5e\u6027\u4e0a\u62a5\u3002 clientToken String \u7528\u4e8e\u4e0a\u4e0b\u884c\u6d88\u606f\u914d\u5bf9\u6807\u8bc6 timestamp Integer \u5c5e\u6027\u4e0a\u62a5\u7684\u65f6\u95f4 params JSON JSON \u7ed3\u6784\u5185\u4e3a\u8bbe\u5907\u4e0a\u62a5\u7684\u5c5e\u6027\u503c \u6240\u4ee5\u7ec4\u5408\u51fa\u6765\u4e0a\u62a5\u6570\u636e\u7684AT\u6307\u4ee4\u5982\u4e0b\uff1a AT+TCMQTTPUB=\"$thing/up/property/FWR8PGACUS/ESP8266_Dev_001\",0,\"{\\\"method\\\":\\\"report\\\"\\,\\\"clientToken\\\":\\\"clientToken-145023f5-bc9b-4174-ba3b-430ba5956e5c\\\"\\,\\\"params\\\":{\\\"brightness\\\":55\\,\\\"name\\\":\\\"bedroom\\\"\\,\\\"power_switch\\\":1\\,\\\"color\\\":2}}\" \u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\uff1a OK +TCMQTTPUB:OK \u540c\u65f6\uff0c\u56e0\u4e3a\u8ba2\u9605\u4e86\u4e0a\u884c\u54cd\u5e94topic\uff0c\u6240\u4ee5\u6a21\u7ec4\u4f1a\u6536\u5230\u4e91\u7aef\u4e0b\u53d1\u7684\u54cd\u5e94\u5e76\u901a\u8fc7URC\u6a21\u5f0f\u4e0a\u62a5\uff1a +TCMQTTRCVPUB:\"$thing/down/property/FWR8PGACUS/ESP8266_Dev_001\",118,\"{\"method\":\"report_reply\",\"clientToken\":\"clientToken-145023f5-bc9b-4174-ba3b-430ba5956e5c\",\"code\":0,\"status\":\"success\"}\" \u4e91\u7aef\u54cd\u5e94\u62a5\u6587\u6574\u7406\u4e00\u4e0b\u683c\u5f0f\u5982\u4e0b\uff1a { \"method\":\"report_reply\", \"clientToken\":\"clientToken-145023f5-bc9b-4174-ba3b-430ba5956e5c\", \"code\":0, \"status\":\"success\" } \u5176\u4e2d\u6bcf\u4e00\u9879\u4e5f\u6709\u5177\u4f53\u7684\u542b\u4e49\uff1a \u53c2\u6570 \u7c7b\u578b \u8bf4\u660e method String report_reply \u8868\u793a\u4e91\u7aef\u63a5\u6536\u8bbe\u5907\u4e0a\u62a5\u540e\u7684\u54cd\u5e94\u62a5\u6587 clientToken String \u7528\u4e8e\u4e0a\u4e0b\u884c\u6d88\u606f\u914d\u5bf9\u6807\u8bc6 code Integer 0\u8868\u793a\u4e91\u7aef\u6210\u529f\u6536\u5230\u8bbe\u5907\u4e0a\u62a5\u7684\u5c5e\u6027 status String \u5f53code\u975e0\u7684\u65f6\u5019, \u63d0\u793a\u9519\u8bef\u4fe1\u606f \u5728\u4e91\u7aef\u67e5\u770b\u8bbe\u5907\u4e0a\u62a5\u7684\u6570\u636e\uff1a \u540c\u65f6\u5728\u8bbe\u5907\u65e5\u5fd7\u4e2d\u53ef\u4ee5\u67e5\u770b\u8bbe\u522b\u4e0a\u62a5\u7684\u6570\u636e\u5185\u5bb9\u3002","title":"3.4.1. \u8bbe\u5907\u5c5e\u6027\u4e0a\u62a5"},{"location":"24.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Explorer/#342","text":"\u7ecf\u8fc73.4.1\u8282\u7684\u73a9\u6cd5\u8bf4\u660e\uff0c\u540e\u7eed\u90fd\u662f\u4e00\u6837\u7684\u73a9\u6cd5\u3002 \u4e91\u7aef\u4e0b\u53d1\u63a7\u5236\u6307\u4ee4\u7684 Topic\u5982\u4e0b\uff1a \u4e0b\u53d1 Topic\uff1a $thing/down/property/{ProductID}/{DeviceName} \u54cd\u5e94 Topic\uff1a $thing/up/property/{ProductID}/{DeviceName} \u4e0b\u9762\u8bb2\u8ff0\u5982\u4f55\u73a9\u3002 \u9996\u5148\u8ba2\u9605\u4e0b\u53d1Topic\uff1a AT+TCMQTTSUB=\"$thing/down/property/FWR8PGACUS/ESP8266_Dev_001\",0 \u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\uff0c\u8ba2\u9605\u6210\u529f\uff1a OK +TCMQTTSUB:OK \u7136\u540e\u5728\u4e91\u7aef\u8fdb\u5165\u8bbe\u5907\u5728\u7ebf\u8c03\u8bd5\uff0c\u4fee\u6539\u706f\u7684\u5c5e\u6027\uff0c\u7136\u540e\u4e0b\u53d1\u63a7\u5236\u547d\u4ee4\uff1a \u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u53ef\u4ee5\u770b\u5230\u8bbe\u5907\u6536\u5230\u4e86\u4e91\u7aef\u4e0b\u53d1\u7684\u6570\u636e\uff0c\u5e76\u4ee5URC\u6a21\u5f0f\u4e0a\u62a5\uff1a +TCMQTTRCVPUB:\"$thing/down/property/FWR8PGACUS/ESP8266_Dev_001\",156,\"{\"method\":\"control\",\"clientToken\":\"clientToken-e037d04b-c3a4-4350-8d67-5c6be19b888a\",\"params\":{\"name\":\"bedroom\",\"power_switch\":0,\"color\":0,\"brightness\":30}}\" \u6574\u7406\u4e00\u4e0bjson\u5185\u5bb9\u7684\u683c\u5f0f\uff0c\u53ef\u4ee5\u770b\u5230\u4e0e\u6211\u4eec\u671f\u5f85\u4e0b\u53d1\u7684\u6570\u636e\u76f8\u5bf9\u5e94\uff1a { \"method\":\"control\", \"clientToken\":\"clientToken-e037d04b-c3a4-4350-8d67-5c6be19b888a\", \"params\": { \"name\":\"bedroom\", \"power_switch\":0, \"color\":0, \"brightness\":30 } } \u6ce8\u610f\uff0c\u6b64\u65f6\u8bbe\u5907\u8fd8\u9700\u8981\u624b\u52a8\u7ed9\u5e73\u53f0\u56de\u590d\u5185\u5bb9\u7ed9\u4e0b\u53d1\u54cd\u5e94topic\uff0c\u5185\u5bb9\u683c\u5f0f\u5982\u4e0b\uff1a { \"method\":\"control_reply\", \"clientToken\":\"clientToken-e037d04b-c3a4-4350-8d67-5c6be19b888a\", \"code\":0, \"status\":\"success\" } \u7ec4\u5408\u51fa\u6765\u53d1\u5e03\u56de\u5e94\u6d88\u606f\u7684AT\u6307\u4ee4\u5982\u4e0b\uff1a AT+TCMQTTPUB=\"$thing/up/property/FWR8PGACUS/ESP8266_Dev_001\",0,\"{ \\\"method\\\":\\\"control_reply\\\"\\, \\\"clientToken\\\":\\\"clientToken-e037d04b-c3a4-4350-8d67-5c6be19b888a\\\"\\, \\\"code\\\":0\\, \\\"status\\\":\\\"success\\\" }\" \u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\uff1a OK +TCMQTTPUB:OK","title":"3.4.2. \u8bbe\u5907\u8fdc\u7a0b\u63a7\u5236"},{"location":"24.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Explorer/#343","text":"\u8bbe\u5907\u4ece\u4e91\u7aef\u63a5\u6536\u6700\u65b0\u6d88\u606f\u4f7f\u7528\u7684 Topic\u5982\u4e0b\uff1a \u8bf7\u6c42 Topic\uff1a $thing/up/property/{ProductID}/{DeviceName} \u54cd\u5e94 Topic\uff1a $thing/down/property/{ProductID}/{DeviceName} \u9996\u5148\u8ba2\u9605\u54cd\u5e94topic\uff08\u4e4b\u524d\u5df2\u7ecf\u8ba2\u9605\u8fc7\uff0c\u4e0d\u7528\u91cd\u590d\u8ba2\u9605\uff09\u3002 \u5411\u8bf7\u6c42Topic\u53d1\u9001\u6570\u636e\uff0c\u8bf7\u6c42\u5185\u5bb9\u5982\u4e0b\uff1a { \"method\": \"get_status\", \"clientToken\": \"123\", \"type\" : \"report\", \"showmeta\": 0 } \u7ec4\u5408\u4e00\u4e0b\u53d1\u51fa\u7684AT\u6307\u4ee4\u5982\u4e0b\uff1a AT+TCMQTTPUB=\"$thing/up/property/FWR8PGACUS/ESP8266_Dev_001\",0,\"{ \\\"method\\\": \\\"get_status\\\"\\, \\\"clientToken\\\": \\\"123\\\"\\, \\\"type\\\" : \\\"report\\\"\\, \\\"showmeta\\\": 0 }\" \u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\uff1a OK +TCMQTTPUB:OK \u540c\u65f6\u8bbe\u5907\u6536\u5230\u4e86\u4e91\u7aef\u7684\u54cd\u5e94\uff1a +TCMQTTRCVPUB:\"$thing/down/property/FWR8PGACUS/ESP8266_Dev_001\",175,\"{\"method\":\"get_status_reply\",\"clientToken\":\"123\",\"code\":0,\"status\":\"success\",\"type\":\"report\",\"data\":{\"reported\":{\"brightness\":55,\"name\":\"bedroom\",\"power_switch\":1,\"color\":2}}}\" \u5c06\u5176\u4e2d\u7684json\u5185\u5bb9\u6574\u7406\u683c\u5f0f\u5982\u4e0b\uff0c\u548c\u5f53\u524d\u8bbe\u5907\u6700\u540e\u4e00\u6b21\u4e0a\u62a5\u6570\u636e\u7684\u72b6\u6001\u5bf9\u5e94\uff1a { \"method\":\"get_status_reply\", \"clientToken\":\"123\", \"code\":0, \"status\":\"success\", \"type\":\"report\", \"data\": { \"reported\": { \"brightness\":55, \"name\":\"bedroom\", \"power_switch\":1, \"color\":2 } } }","title":"3.4.3. \u83b7\u53d6\u8bbe\u5907\u6700\u65b0\u4e0a\u62a5\u4fe1\u606f"},{"location":"24.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Explorer/#344","text":"\u8bbe\u5907\u5411\u4e91\u7aef\u4e0a\u62a5\u4e8b\u4ef6\u7684 Topic\u5982\u4e0b\uff1a \u4e0a\u884c\u8bf7\u6c42 Topic\uff1a $thing/up/event/{ProductID}/{DeviceName} \u4e0a\u884c\u54cd\u5e94 Topic\uff1a $thing/down/event/{ProductID}/{DeviceName} \u9996\u5148\u8ba2\u9605\u4e0a\u884c\u54cd\u5e94Topic\uff1a AT+TCMQTTSUB=\"$thing/down/event/FWR8PGACUS/ESP8266_Dev_001\",0 \u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\uff1a OK +TCMQTTSUB:OK \u63a5\u7740\u5411\u4e0a\u884c\u8bf7\u6c42Topic\u53d1\u5e03\u6d88\u606f\uff0c\u4e8b\u4ef6\u5185\u5bb9\u683c\u5f0f\u5982\u4e0b\uff1a { \"method\":\"event_post\", \"clientToken\":\"123\", \"version\":\"1.0\", \"eventId\":\"low_voltage\", \"type\":\"alert \", \"params\": { \"Voltage\":2.8 } } \u5176\u4e2d\u53c2\u6570\u8bf4\u660e\u5982\u4e0b\uff1a \u53c2\u6570 \u7c7b\u578b \u8bf4\u660e method String event_post \u8868\u793a\u4e8b\u4ef6\u4e0a\u62a5\u3002 clientToken String \u6d88\u606f ID\uff0c\u56de\u590d\u7684\u6d88\u606f\u5c06\u4f1a\u8fd4\u56de\u8be5\u6570\u636e, \u7528\u4e8e\u8bf7\u6c42\u54cd\u5e94\u6d88\u606f\u7684\u5bf9\u6bd4\u3002 version String \u534f\u8bae\u7248\u672c\uff0c\u9ed8\u8ba4\u4e3a1.0\u3002 eventId String \u4e8b\u4ef6\u7684 ID\uff0c\u5728\u6570\u636e\u6a21\u677f\u4e8b\u4ef6\u4e2d\u5b9a\u4e49\u3002 params String \u4e8b\u4ef6\u7684\u53c2\u6570\uff0c\u5728\u6570\u636e\u6a21\u677f\u4e8b\u4ef6\u4e2d\u5b9a\u4e49\u3002 timestamp Integer \u4e8b\u4ef6\u4e0a\u62a5\u7684\u65f6\u95f4\uff0c\u4e0d\u586b\u5199\u8be5\u5b57\u6bb5\u8868\u793a\u5c31\u4f7f\u7528\u4e8b\u4ef6\u4e0a\u62a5\u672c\u8eab\u7684\u65f6\u95f4\u3002 type String \u4e8b\u4ef6\u7c7b\u578b\uff0cinfo \u4e3a\u4fe1\u606f\uff0calert \u4e3a\u544a\u8b66\uff0cfault \u4e3a\u6545\u969c\u3002 \u7ec4\u5408\u51fa\u5411\u4e0a\u884c\u8bf7\u6c42\u53d1\u9001\u7684AT\u547d\u4ee4\u5982\u4e0b\uff1a AT+TCMQTTPUB=\"$thing/up/event/FWR8PGACUS/ESP8266_Dev_001\",0,\"{ \\\"method\\\":\\\"event_post\\\"\\, \\\"clientToken\\\":\\\"123\\\"\\, \\\"version\\\":\\\"1.0\\\"\\, \\\"eventId\\\":\\\"low_voltage\\\"\\, \\\"type\\\":\\\"alert \\\"\\, \\\"params\\\": { \\\"voltage\\\":2.8 } }\" \u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\uff0c\u4e0a\u62a5\u6210\u529f\uff1a OK +TCMQTTPUB:OK \u540c\u65f6\u6536\u5230\u5e73\u53f0\u53d1\u7ed9\u8bbe\u5907\u7684\u56de\u5e94\uff1a +TCMQTTRCVPUB:\"$thing/down/event/FWR8PGACUS/ESP8266_Dev_001\",75,\"{\"method\":\"event_reply\",\"clientToken\":\"123\",\"code\":0,\"status\":\"\",\"data\":{}}\" \u5176\u4e2d\u7684json\u6570\u636e\u6574\u7406\u4e00\u4e0b\u5982\u4e0b\uff1a { \"method\":\"event_reply\", \"clientToken\":\"123\", \"code\":0, \"status\":\"\", \"data\":{} } \u5728\u4e91\u7aef\u8bbe\u5907\u4e8b\u4ef6\u65e5\u5fd7\u4e2d\u53ef\u4ee5\u770b\u5230\uff1a","title":"3.4.4. \u8bbe\u5907\u4e8b\u4ef6\u4e0a\u62a5"},{"location":"24.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Explorer/#345","text":"\u5f53\u5e94\u7528\u901a\u8fc7\u4e91\u7aef\u5411\u8bbe\u5907\u53d1\u8d77\u67d0\u4e2a\u884c\u4e3a\u8c03\u7528\u65f6\uff0c\u5f00\u53d1\u5e73\u53f0\u4e3a\u8bbe\u5907\u884c\u4e3a\u7684\u5904\u7406\u8bbe\u5b9a\u4e86\u9ed8\u8ba4\u7684 Topic \u5982\u4e0b\uff1a \u5e94\u7528\u8c03\u7528\u8bbe\u5907\u884c\u4e3a Topic\uff1a $thing/down/action/{ProductID}/{DeviceName} \u8bbe\u5907\u54cd\u5e94\u884c\u4e3a\u6267\u884c\u7ed3\u679c Topic\uff1a $thing/up/action/{ProductID}/{DeviceName} \u9996\u5148\u8ba2\u9605\u8bbe\u5907\u5e94\u7528\u8c03\u7528\u8bbe\u5907\u884c\u4e3a\u7684Topic\uff1a AT+TCMQTTSUB=\"$thing/down/action/FWR8PGACUS/ESP8266_Dev_001\",0 \u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\uff1a OK +TCMQTTSUB:OK \u667a\u80fd\u706f\u9ed8\u8ba4\u6570\u636e\u6a21\u677f\u4e2d\u6ca1\u6709\u2026\u2026\u9700\u8981\u624b\u52a8\u521b\u5efa\uff0c\u65b0\u5efa\u4e00\u4e2a\u884c\u4e3a\u529f\u80fd\uff1a \u65b0\u5efa\u4e4b\u540e\u5728\u81ea\u5b9a\u4e49\u529f\u80fd\u8fd9\u4e00\u680f\u5373\u53ef\u770b\u5230\uff1a \u8fdb\u5165\u8bbe\u5907\u5728\u7ebf\u8c03\u8bd5\u754c\u9762\uff0c\u53d1\u9001\u884c\u4e3a\uff1a \u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u53ef\u4ee5\u770b\u5230\u6a21\u7ec4\u63a5\u6536\u5230\u4e91\u7aef\u7684\u6d88\u606f\uff1a +TCMQTTRCVPUB:\"$thing/down/action/FWR8PGACUS/ESP8266_Dev_001\",132,\"{\"method\":\"action\",\"clientToken\":\"1d603a84c71e4d1da38c2dacce27112e\",\"actionId\":\"blink\",\"timestamp\":1593396804,\"params\":{\"period\":5}}\" \u6574\u7406\u4e00\u4e0bjson\u683c\u5f0f\u5982\u4e0b\uff1a { \"method\":\"action\", \"clientToken\":\"1d603a84c71e4d1da38c2dacce27112e\", \"actionId\":\"blink\", \"timestamp\":1593396804, \"params\": { \"period\":5 } } \u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u5411\u8bbe\u5907\u54cd\u5e94\u884c\u4e3a\u6267\u884c\u7ed3\u679c Topic\u56de\u590d\u54cd\u5e94\uff0c\u54cd\u5e94\u5185\u5bb9\u683c\u5f0f\u5982\u4e0b\uff1a { \"method\": \"action_reply\", \"clientToken\": \"1d603a84c71e4d1da38c2dacce27112e\", \"code\": 0, \"status\": \"success\", \"response\": { \"Code\": 0 } } \u7ec4\u5408\u51fa\u53d1\u9001\u54cd\u5e94\u7684AT\u6307\u4ee4\u5982\u4e0b; AT+TCMQTTPUB=\"$thing/up/action/FWR8PGACUS/ESP8266_Dev_001\",0,\"{ \\\"method\\\": \\\"action_reply\\\"\\, \\\"clientToken\\\": \\\"1d603a84c71e4d1da38c2dacce27112e\\\"\\, \\\"code\\\": 0\\, \\\"status\\\": \\\"success\\\"\\, \\\"response\\\": { \\\"Code\\\": 0 } }\" \u8fd4\u56de\u7ed3\u679c\u4e3a\uff1a OK +TCMQTTPUB:OK \u81f3\u6b64\uff0c\u4f7f\u7528ESP8266\u817e\u8baf\u4e91\u5b9a\u5236\u56fa\u4ef6\u5bf9\u63a5\u817e\u8baf\u4e91IoT Explorer\u5e73\u53f0\u7684\u6d4b\u8bd5\u5b8c\u6210\u3002","title":"3.4.5. \u8bbe\u5907\u884c\u4e3a\u8c03\u7528"},{"location":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub/","text":"1. \u817e\u8baf\u4e91ESP8266\u5b9a\u5236\u56fa\u4ef6\u8bf4\u660e\u53ca\u70e7\u5f55 \u817e\u8baf\u4e91IoT AT\u6307\u4ee4\u662f\u4e00\u5957\u9488\u5bf9\u4f7f\u7528\u901a\u8baf\u6a21\u7ec4\uff082G/4G/NB/WIFI\uff09\u63a5\u5165\u817e\u8baf\u4e91\u7269\u8054\u5e73\u53f0\u7684\u5b9a\u5236AT\u6307\u4ee4\u96c6\uff0c\u5982\u679c\u901a\u8baf\u6a21\u7ec4\u5b9e\u73b0\u4e86\u8be5\u6307\u4ee4\u96c6\uff0c\u5219\u8bbe\u5907\u63a5\u5165\u548c\u901a\u8baf\u66f4\u4e3a\u7b80\u5355\uff0c\u6240\u9700\u4ee3\u7801\u91cf\u66f4\u5c11\u3002 ESP8266\u4f5c\u4e3aIoT\u9886\u57df\u4f7f\u7528\u6700\u5e7f\u6cdb\u7684\u4e00\u6b3eWiFi\u82af\u7247/\u6a21\u7ec4\uff0c\u6211\u4eec\u5728\u5176\u901a\u7528AT\u6307\u4ee4\u57fa\u7840\u4e0a\uff0c\u589e\u52a0\u4e86\u817e\u8baf\u4e91IoT AT\u6307\u4ee4\u96c6\uff0c\u5f62\u6210\u4e00\u4e2a\u5b9a\u5236\u7684\u6a21\u7ec4\u56fa\u4ef6QCloud_IoT_AT_ESP8266\uff0c\u817e\u8baf\u4e91IoT\u5b9a\u5236\u7684AT\u6a21\u7ec4\u56fa\u4ef6QCloud_IoT_AT_ESP8266\uff0c\u9002\u7528\u4e8e\u6240\u6709FLASH\u5927\u5c0f\u4e3a2MB\u6216\u80052MB\u4ee5\u4e0a\u7684ESP8266\u6a21\u7ec4\u3002 \u56fa\u4ef6\u70e7\u5f55\u65b9\u6cd5\u8bf7\u9605\u8bfb\u6587\u6863\uff1a \u817e\u8baf\u4e91 IoT AT ESP8266 \u5b9a\u5236\u56fa\u4ef6\u53ca\u8bf4\u660e \u3002 2. \u4e91\u7aef\u914d\u7f6e \u767b\u5f55\u817e\u8baf\u4e91, \u641c\u7d22\"\u4e91\u4ea7\u54c1\"\u4e0b\u7684\"\u7269\u8054\u7f51\u901a\u4fe1\"\u4ea7\u54c1, \u6216\u76f4\u63a5\u8bbf\u95ee\uff1a https://console.cloud.tencent.com/iotcloud 2.1. \u521b\u5efa\u65b0\u4ea7\u54c1 \u5bf9\u4e8e\u8ba4\u8bc1\u65b9\u5f0f, \u6307\u5b9a\u4e86\u8bbe\u5907\u901a\u8fc7\u4f55\u79cd\u65b9\u5f0f\u548c\u4e91\u7aef\u8fdb\u884c\u53cc\u5411\u8ba4\u8bc1. \u9ed8\u8ba4\u7684\u8bc1\u4e66\u65b9\u5f0f\u76f8\u5bf9\u4e8e\u5bc6\u94a5\u8ba4\u8bc1\u5b89\u5168\u6027\u9ad8\u4e00\u70b9, \u4f46\u662f\u95ee\u9898\u5728\u4e8e\u8bc1\u4e66\u65b9\u5f0f\u9700\u8981\u5728\u5d4c\u5165\u5f0f\u8bbe\u5907\u7aef\u5b58\u50a8\u8bc1\u4e66\u540c\u65f6\u5b9e\u73b0\u8bc1\u4e66\u7684\u76f8\u5173\u5904\u7406, \u5bf9\u8bbe\u5907\u7684RAM\u548cROM\u8981\u6c42\u8f83\u9ad8, \u76f8\u5bf9\u800c\u8a00, \u5bc6\u94a5\u8ba4\u8bc1\u7684\u65b9\u5f0f\u8d44\u6e90\u5360\u7528\u91cf\u5c31\u5c0f\u70b9, \u7531\u4e8e\u6211\u4eec\u4e3b\u8981\u652f\u6301\u7684\u8bbe\u5907\u90fd\u662f\u5c0f\u578b\u5d4c\u5165\u5f0f\u8bbe\u5907, \u56e0\u6b64\u9009\u7528\u5bc6\u94a5\u8ba4\u8bc1\u3002 \u6570\u636e\u683c\u5f0f\u6307\u7684\u662f\u8bbe\u5907\u548c\u4e91\u7aef\u8fdb\u884c\u6570\u636e\u4ea4\u4e92\u65f6\u5019\u4f7f\u7528\u7684\u683c\u5f0f, json\u683c\u5f0f\u4e3a\u6587\u672c\u5b57\u7b26\u4e32, \u53ef\u8bfb\u6027\u9ad8, \u5e76\u4e14\u4fbf\u4e8e\u89e3\u6790, \u5bf9\u4e8e\u529f\u80fd\u590d\u6742\u7684\u8bbe\u5907\u4ea4\u4e92\u800c\u5df2\u6bd4\u8f83\u7406\u60f3, \u4f46\u662f\u5bf9\u4e8e\u5c0f\u578b\u8bbe\u5907\u6216\u662f\u5b9a\u5236\u8bbe\u5907, \u6570\u636e\u5355\u4e00, \u6216\u662f\u6709\u81ea\u5b9a\u4e49\u7684\u683c\u5f0f(\u4e8c\u8fdb\u5236\u6216\u662f\u6587\u672c), \u8fd9\u79cd\u65f6\u5019, \u7528\u81ea\u5b9a\u4e49\u7684\u6570\u636e\u683c\u5f0f, \u4e00\u65b9\u9762\u8282\u7ea6\u6d41\u91cf, \u53e6\u4e00\u65b9\u9762\u6bd4\u8f83\u7075\u6d3b.\u3002 \u521b\u5efa\u6210\u529f\u540e\uff0c\u83b7\u53d6\u5230\u4ea7\u54c1ID\uff1a 2.2. \u521b\u5efa\u65b0\u8bbe\u5907 \u6dfb\u52a0\u5b8c\u8bbe\u5907\u540e, \u4f1a\u544a\u77e5\u8bbe\u5907\u5bf9\u5e94\u7684\u5bc6\u94a5. \u8be5\u5bc6\u94a5\u5c06\u4f1a\u7528\u4e8e\u4e4b\u540e\u8bbe\u5907\u4e0e\u5e73\u53f0\u901a\u4fe1\u65f6\u7684\u8ba4\u8bc1\uff1a \u4e3a\u4e86\u5b9e\u73b0\u8bbe\u5907\u95f4\u7684\u901a\u4fe1, \u6211\u4eec\u8fd8\u9700\u8981\u521b\u5efa\u7b2c\u4e8c\u4e2a\u8bbe\u5907, \u64cd\u4f5c\u540c\u4e0a, \u5c06\u5176\u547d\u540d\u4e3a\"dev2\"\uff1a 2.3. \u8bbe\u7f6eTopic \u53ef\u4ee5\u5728\"\u6743\u9650\u5217\u8868\"\u4e2d\u770b\u5230Topic\u5bf9\u5e94\u7684\u64cd\u4f5c\u6743\u9650\uff1a \u5e73\u53f0\u9ed8\u8ba4\u914d\u7f6e\u4e86\u4e09\u7c7b\u7684Topic, \u7528\u4e8e\u6267\u884c\u53d1\u5e03\u548c\u8ba2\u9605.\uff0c\u8fd9\u91cc\u4e4b\u6240\u4ee5 \u662f\u4e09\u7c7b\u800c\u4e0d\u662f\u4e09\u4e2a , \u662f\u56e0\u4e3aTopic\u91cc\u4f7f\u7528\u4e86\u53d8\u91cf.\u3002 WDRRDCF1TE \u5b9e\u9645\u4e0a\u662fproductID\uff1b ${deviceName} \u4e3a\u5e73\u53f0\u8bbe\u7f6e\u7684\u53d8\u91cf, \u5373\u8bbe\u5907\u540d\uff1b control \u548c data \u4ee5\u53ca event \u4e3aTopic\u540d\u5b57.\uff1b \u6240\u4ee5, \u5728\u6211\u4eec\u521b\u5efa\u4e862\u4e2a\u8bbe\u5907dev1\u548cdev2\u7684\u60c5\u51b5\u4e0b, \u5728 BearPiTest \u4ea7\u54c1\u4e0b, \u5373\u5b58\u57286\u4e2aTopic, \u5206\u522b\u4e3a: WDRRDCF1T/dev1/control \u8ba2\u9605\u6743\u9650 WDRRDCF1T/dev1/data \u53d1\u5e03\u548c\u8ba2\u9605\u6743\u9650 WDRRDCF1T/dev1/event \u53d1\u5e03\u6743\u9650 WDRRDCF1T/dev2/control \u8ba2\u9605\u6743\u9650 WDRRDCF1T/dev2/data \u53d1\u5e03\u548c\u8ba2\u9605\u6743\u9650 WDRRDCF1T/dev2/event \u53d1\u5e03\u6743\u9650 \u8fd9\u91cc\u9ed8\u8ba4\u7684Topic\u5df2\u7ecf\u8db3\u591f\u6211\u4eec\u4f7f\u7528, \u4e0d\u9700\u8981\u989d\u5916\u6dfb\u52a0Topic\u548c\u6743\u9650\u4e86\u3002 2.4. \u8bbe\u7f6e\u89c4\u5219\u5f15\u64ce \u89c4\u5219\u5f15\u64ce\u672c\u8eab\u4e0d\u5c5e\u4e8eMQTT\u534f\u8bae\u7684\u8303\u7574, \u4f46\u662f\u5e73\u53f0\u4fa7\u51fa\u4e8e\u5b89\u5168\u89d2\u5ea6\u8003\u8651\u6dfb\u52a0\u4e86\u89c4\u5219\u5f15\u64ce, \u5b9e\u73b0\u4e86Topic\u4e4b\u95f4\u7684\u8f6c\u53d1\u64cd\u4f5c, \u6211\u4eec\u9700\u8981\u5408\u7406\u7684\u8bbe\u7f6e\u89c4\u5219\u5f15\u64ce\u624d\u80fd\u5b9e\u73b0\u591a\u4e2a\u8bbe\u5907\u4e4b\u95f4\u7684\u6570\u636e\u6536\u53d1, \u7531\u4e8e\u7406\u89e3\u8d77\u6765\u6bd4\u8f83\u590d\u6742, \u6211\u4eec\u8fd9\u91cc\u7b80\u8981\u8bb2\u89e3\u4e0b\u4e3a\u4ec0\u4e48\u9700\u8981\u89c4\u5219\u5f15\u64ce, \u89c4\u5219\u5f15\u64ce\u7684\u4f5c\u7528, \u5982\u4f55\u8bbe\u7f6e\u89c4\u5219\u5f15\u64ce. \u4e3a\u4ec0\u4e48\u9700\u8981\u89c4\u5219\u5f15\u64ce \u5728\u4e0a\u8282\u7684Topic\u4e2d, \u6211\u4eec\u77e5\u9053, \u5728\u5e73\u53f0\u4fa7, \u5bf9\u4e8e\u4e0d\u540c\u7684Topic, \u89c4\u5b9a\u4e86\u4e0d\u540c\u7684\u6743\u9650, \u4f8b\u5982, \u5bf9\u4e8e WDRRDCF1T/dev1/event \u8fd9\u4e2aTopic, \u53ea\u5177\u6709\u53d1\u5e03\u6743\u9650, \u800c\u5bf9\u4e8e WDRRDCF1T/dev1/control \u8fd9\u4e2aTopic, \u53ea\u5177\u6709\u8ba2\u9605\u6743\u9650. \u5bf9\u4e8e\u8bbe\u5907dev1, \u5f88\u81ea\u7136\u7684, \u4f1a\u671d WDRRDCF1T/dev1/event \u8fd9\u4e2aTopic\u53d1\u9001\u6570\u636e, \u5e76\u4e14\u8ba2\u9605 WDRRDCF1T/dev1/control \u8fd9\u4e2aTopic\u7684\u6d88\u606f. \u4f46\u662f\u8fd9\u91cc\u5c31\u4f1a\u6d89\u53ca\u5230, event\u7684\u6570\u636e\u6700\u540e\u5230\u54ea\u53bb, control\u7684\u6570\u636e\u4ece\u54ea\u91cc\u6765\u7684\u95ee\u9898. \u5728\u672c\u6587\u7684\u4f8b\u5b50\u4e2d, \u6211\u4eec\u5e0c\u671bdev1\u548cdev2\u53d1\u751f\u4ea4\u4e92, \u5373\u76f8\u4e92\u6536\u53d1\u6d88\u606f. \u7531\u4e8eMQTT\u662f\u57fa\u4e8eTopic\u7684\u53d1\u5e03\u8ba2\u9605\u673a\u5236, \u56e0\u6b64, dev1\u60f3\u8981\u83b7\u5f97dev2\u7684\u6570\u636e, \u76f4\u89c9\u4e0a, \u9700\u8981\u8ba2\u9605dev2\u53d1\u5e03\u6d88\u606f\u7684\u90a3\u4e2aTopic. \u5047\u5b9adev2\u671d 25KCIUIR1G/dev2/event Topic\u4e0a\u53d1\u9001\u6570\u636e, \u90a3\u4e48dev1\u60f3\u8981\u83b7\u5f97dev2\u53d1\u5e03\u7684\u6d88\u606f, \u6700\u76f4\u63a5\u7684\u529e\u6cd5\u662f\u8ba2\u9605\u540c\u6837\u7684Topic, \u5373 25KCIUIR1G/dev2/event , \u4f46\u662f\u8fd9\u91cc\u5b58\u5728\u51e0\u4e2a\u95ee\u9898, \u9996\u5148, event Topic\u53ea\u5177\u6709\u53d1\u5e03\u6743\u9650, \u6ca1\u6709\u8ba2\u9605\u6743\u9650, \u5176\u6b21, \u5728\u5e73\u53f0\u4fa7, \u89c4\u5b9a\u4e86, \u4e0d\u5141\u8bb8\u8de8\u8bbe\u5907\u53d1\u5e03\u6216\u662f\u8ba2\u9605Topic , \u4e5f\u5c31\u662f\u8bf4, \u5bf9\u4e8edev1, \u53ea\u80fd\u770b\u5230\u6216\u53ea\u5141\u8bb8\u8bbf\u95ee WDRRDCF1T/dev1 \u8fd9\u4e2aTopic\u4ee5\u53ca\u5176\u4e0b\u5c5e\u7684Topic, \u4e0d\u80fd\u8bbf\u95ee WDRRDCF1T/dev2 \u53ca\u5176\u4e0b\u5c5eTopic. \u5e73\u53f0\u4fa7\u6dfb\u52a0\u4e0d\u5141\u8bb8\u8de8\u8bbe\u5907\u8bbf\u95eeTopic\u7684\u89c4\u5219\u867d\u7136\u4e0d\u76f4\u89c2, \u4f46\u5374\u662f\u5408\u7406\u7684. \u5982\u679c\u4e0d\u6dfb\u52a0\u8fd9\u6761\u9650\u5236, \u90a3\u4e48\u4e00\u4e2a\u8bbe\u5907\u53ef\u4ee5\u4e0d\u52a0\u9650\u5236\u7684\u8ba2\u9605\u540c\u4e00\u4e2a\u4ea7\u54c1\u4e0b\u6240\u6709\u5176\u4ed6\u8bbe\u5907\u7684Topic, \u83b7\u53d6\u5176\u4e0a\u62a5\u7684\u6d88\u606f, \u8fd9\u5b58\u5728\u6f5c\u5728\u7684\u5b89\u5168\u6f0f\u6d1e. \u89c4\u5219\u5f15\u64ce\u7684\u4f5c\u7528 \u56e0\u4e3a\u4e0d\u5141\u8bb8\u76f4\u63a5\u8de8\u8bbe\u5907\u8bbf\u95eeTopic, \u6240\u4ee5\u9700\u8981\u4f9d\u9760\"\u89c4\u5219\u5f15\u64ce\"\u6765\u624b\u52a8\u6dfb\u52a0\u89c4\u5219, \u5c06\u6307\u5b9a\u7684Topic\u6d88\u606f\u8f6c\u53d1\u5230\u53e6\u4e00\u4e2aTopic\u4e0a, \u5b9e\u73b0\u4e0d\u540c\u8bbe\u5907\u4e4b\u95f4\u7684\u901a\u4fe1. \u4e0a\u56fe\u4ecb\u7ecd\u4e86\u89c4\u5219\u5f15\u64ce\u7684\u4e3b\u8981\u4f5c\u7528\"republish\", \u5373\u5c06\u4e00\u4e2aTopic\u4e0b\u7684\u6d88\u606frepublish\u5230\u53e6\u4e00\u4e2aTopic\u4e0b. \u4ece\u56fe\u4e2d\u6211\u4eec\u53ef\u4ee5\u770b\u5230, \u89c4\u5219\u5f15\u64ce\u5c06 WDRRDCF1TE/dev2/event \u7684\u6d88\u606frepublish\u5230\u4e86 WDRRDCF1TE/dev1/control \u4e0b. \u5c06 WDRRDCF1TE/dev1/event \u7684\u6d88\u606frepublish\u5230\u4e86 WDRRDCF1TE/dev2/control \u4e0b\u3002 \u8fd9\u6837, \u5bf9\u4e8edev1\u800c\u8a00, \u53ea\u9700\u8981\u8ba2\u9605 WDRRDCF1TE/dev1/control \u5c31\u53ef\u4ee5\u63a5\u6536\u6765\u81ea 25KCIUIR1G/dev2/event \u7684\u6d88\u606f\u4e86\uff0cdev2\u540c\u7406\u3002 \u8bbe\u7f6e\u89c4\u5219\u5f15\u64ce \u5728\u7269\u8054\u7f51\u901a\u4fe1\u754c\u9762\u9009\u62e9\"\u89c4\u5219\u5f15\u64ce\"--\"\u65b0\u5efa\u89c4\u5219\", \u968f\u610f\u6307\u5b9a\u4e00\u4e2a\u89c4\u5219\u540d\u79f0, \u6211\u4eec\u8fd9\u91cc\u4e0d\u59a8\u8bbe\u7f6e\u4e3a\"1to2\"\uff1a \u8fd9\u91cc, \u6211\u4eec\u770b\u5230\u89c4\u5219\u7684\u8be6\u7ec6\u8bbe\u7f6e\u4fe1\u606f, \u4e3b\u8981\u5305\u62ec\"\u7b5b\u9009\u6570\u636e\"\u548c\"\u884c\u4e3a\u64cd\u4f5c\"\u3002 \"\u7b5b\u9009\u6570\u636e\"\u9488\u5bf9\u6307\u5b9aTopic\u63a5\u6536\u5230\u7684\u6d88\u606f\u5185\u5bb9\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u7b5b\u9009, \u6bd4\u5982\u5339\u914d\u6d88\u606f\u4e2d\u7684\u5b57\u6bb5\u6765\u51b3\u5b9a\u662f\u5426\u6267\u884c\u4e4b\u540e\u7684\u8bbe\u7f6e\u7684\"\u884c\u4e3a\u64cd\u4f5c\".\uff0c\u800c\"\u884c\u4e3a\u64cd\u4f5c\"\u5219\u662f\u6307\u5b9a\u5bf9\u901a\u8fc7\u5339\u914d\u7684\u6d88\u606f\u8fdb\u884c\u4f55\u79cd\u64cd\u4f5c, \u4e3b\u8981\u7684\u64cd\u4f5c\u6709\"\u6570\u636e\u8f6c\u53d1\u5230\u53e6\u4e00\u4e2aTopic(Republish)\", \"\u8f6c\u53d1\u5230\u7b2c\u4e09\u65b9\u670d\u52a1(Forward)\"\u4ee5\u53ca\u8f6c\u53d1\u5230\u817e\u8baf\u4e91\u5404\u4e2a\u5bf9\u5e94\u7ec4\u4ef6\u4e2d\u3002 \u4e0a\u56fe\u662f\u8bbe\u7f6e\u597d\u7684\u89c4\u5219, \u8fd9\u91cc, \u6211\u4eec\u5c06\"\u7b5b\u9009\u6570\u636e\"\u90e8\u5206\u7684\u7b5b\u9009\u5b57\u6bb5\u8bbe\u7f6e\u4e3a * , \u7b5b\u9009\u7684Topic\u4e3a WDRRDCF1T/dev1/event , \u6761\u4ef6\u8bbe\u7f6e\u4e3a\u7a7a, \u5373\u4e0d\u7b5b\u9009\u6570\u636e, \u5168\u90e8\u5339\u914d\uff0c\u7136\u540e, \u6267\u884c\u7684\u64cd\u4f5c\u662f\u5c06\u6570\u636e\u8f6c\u53d1\u5230 WDRRDCF1T/dev2/control , \u8bbe\u7f6e\u5b8c\u8fd9\u6761\u89c4\u5219, \u5c31\u5b9e\u73b0\u4e86dev2\u901a\u8fc7\u8ba2\u9605control\u5c31\u80fd\u6536\u5230dev1\u53d1\u9001\u5230event\u7684\u6570\u636e\u3002 \u5173\u4e8e\"\u7b5b\u9009\u6570\u636e\"\u7684\u8bbe\u5b9a\uff1a \u7531\u4e8e\u6211\u4eec\u5728\u65b0\u5efa\u4ea7\u54c1, \u8bbe\u7f6e\u6570\u636e\u683c\u5f0f\u7684\u65f6\u5019\u9009\u62e9\u4e86\u81ea\u5b9a\u4e49\u6570\u636e\u683c\u5f0f, \u5728\u81ea\u5b9a\u4e49\u6570\u636e\u683c\u5f0f\u7684\u60c5\u51b5\u4e0b, \u5f53\u524d\u5e73\u53f0\u5c06\u5176\u5f53\u505a\u4e8c\u8fdb\u5236\u6d41\u6765\u5904\u7406, \u4e5f\u5c31\u65e0\u6cd5\u901a\u8fc7\u5339\u914d\u5b57\u6bb5\u8fdb\u884c\u6570\u636e\u7b5b\u9009. \u5982\u679c\u5728\u8fdb\u884c\u4ea7\u54c1\u7684\u65f6\u5019, \u4f7f\u7528\u6570\u636e\u683c\u5f0f\u662fjson, \u90a3\u4e48\u6b64\u5904\u5c31\u53ef\u4ee5\u6839\u636ejson\u4e2d\u7684\u5b57\u6bb5\u8fdb\u884cSQL\u7684\u5339\u914d\u548c\u7b5b\u9009. \u540c\u7406, \u6211\u4eec\u518d\u8bbe\u7f6e\u65b0\u7684\u4e00\u4e2a\u89c4\u5219\"2to1\", \u5b9e\u73b0 WDRRDCF1T/dev2/event \u5230 WDRRDCF1T/dev1/control \u7684\u8f6c\u53d1\uff1a \u89c4\u5219\u5f15\u64ce\u90fd\u8bbe\u7f6e\u597d\u540e\uff0c\u8bb0\u5f97\u70b9\u542f\u7528\u6309\u94ae\uff0c\u8fd9\u6837, \u5728\u5e73\u53f0\u4fa7dev1\u5230dev2\u7684\u53cc\u5411\u6570\u636e\u901a\u8def\u5c31\u6253\u901a\u4e86\uff1a 2.5. \u4e91\u65e5\u5fd7 \u5728\u5e73\u53f0\u4fa7\u90fd\u8bbe\u7f6e\u597d\u540e, \u6211\u4eec\u5728\u4e4b\u540e\u7684\u6d4b\u8bd5\u8fc7\u7a0b\u6216\u662f\u901a\u4fe1\u8fc7\u7a0b\u4e2d, \u5f80\u5f80\u8fd8\u9700\u8981\u67e5\u770b\u5e73\u53f0\u662f\u5426\u6536\u5230\u4e86\u8bbe\u5907\u53d1\u9001\u4e0a\u6765\u7684\u6d88\u606f, \u5bf9\u6d88\u606f\u6267\u884c\u4e86\u54ea\u4e9b\u64cd\u4f5c, \u6d88\u606f\u7684\u5177\u4f53\u5185\u5bb9(payload)\u662f\u4ec0\u4e48. \u817e\u8baf\u4e91\u63d0\u4f9b\u4e86\u7269\u8054\u7f51\u901a\u4fe1\u4ea7\u54c1\u7684\"\u4e91\u65e5\u5fd7\"\u529f\u80fd\u548c\u817e\u8baf\u4e91\u7ec4\u4ef6\"\u6d88\u606f\u961f\u5217CMQ\"\u3002 \u65e5\u5fd7\u4e2d\u53ef\u4ee5\u770b\u5230\u65e5\u5fd7\u8bb0\u5f55\u4e86\u8bbe\u5907\u7684\u8fde\u63a5, \u8fde\u63a5\u65ad\u5f00, \u53d1\u5e03, \u8ba2\u9605\u7b49\u884c\u4e3a, \u4e5f\u8bb0\u5f55\u4e86\u89c4\u5219\u5f15\u64ce\u7684\u64cd\u4f5c, \u8fd8\u6709CMQ\u961f\u5217\u7684\u4e00\u4e9b\u884c\u4e3a\u65e5\u5fd7.\u3002 2.6. \u6d88\u606f\u961f\u5217CMQ \u53ef\u4ee5\u5728\u4ea7\u54c1\u5217\u8868\u4e2d\u627e\u5230\"\u6d88\u606f\u961f\u5217\"\u9009\u9879, \u8bbe\u7f6e\u961f\u5217\u6240\u60f3\u8981\u63a5\u6536\u7684\u6d88\u606f\u7c7b\u578b\u540e\u4fdd\u5b58\u914d\u7f6e, \u5373\u53ef\u5c06\u5e73\u53f0\u4fa7\u6536\u5230\u7684\u8bbe\u5907\u6d88\u606f\u989d\u5916\u53d1\u9001\u5230\u817e\u8baf\u4e91\u6d88\u606f\u961f\u5217CMQ\u7ec4\u4ef6\u4e2d\uff1a \u5728\u5bc6\u94a5\u8ba4\u8bc1\u4e0b, \u6d88\u606f\u7684\u5185\u5bb9(payload)\u662f\u7ecf\u8fc7base64\u7f16\u7801\u7684, \u6240\u4ee5\u5728\u5e73\u53f0\u4fa7\u770b\u5230\u7684\u6570\u636e\u7c7b\u4f3c\u4e71\u7801\u5b9e\u9645\u4e0a\u662f\u7ecf\u8fc7\u7f16\u7801\u540e\u7684\u7ed3\u679c, \u60f3\u8981\u67e5\u770b\u5177\u4f53\u7684\u5185\u5bb9, \u53ef\u4ee5\u5728linux\u4e0b, echo <payload> | base64 --decode . 3. \u8bbe\u5907\u7aef\u5bf9\u63a5\u6d4b\u8bd5 \u4f7f\u7528USB\u8f6c\u4e32\u53e3\u5c06\u70e7\u5f55\u597d\u817e\u8baf\u4e91\u5b9a\u5236\u56fa\u4ef6\u7684ESP8266\u8fde\u63a5\u5230PC\uff0c\u4f7f\u7528\u4e32\u53e3\u52a9\u624b\u6253\u5f00\u4e32\u53e3\u5f00\u59cb\u8c03\u8bd5\u3002 3.1. \u5165\u7f51 \u6d4b\u8bd5AT\u6307\u4ee4\u662f\u5426\u6b63\u5e38\uff1a AT OK \u8bbe\u7f6eESP8266\u5de5\u4f5c\u6a21\u5f0f\u4e3aAP\u548cSTA\u5e76\u5b58\uff1a AT+CWMODE=3 OK \u8bbe\u7f6e\u4f20\u8f93\u6a21\u5f0f\u4e3a\u666e\u901a\u4f20\u8f93\u6a21\u5f0f\uff1a AT+CIPMODE=0 OK \u5f00\u542f\u591a\u8def\u6a21\u5f0f\uff1a AT+CIPMUX=1 OK \u5165\u7f51\uff1a AT+CWJAP=\"Mculover666\",\"mculover666\" WIFI CONNECTED WIFI GOT IP OK 3.2. \u8bbe\u7f6e\u817e\u8baf\u4e91\u5bf9\u63a5\u4fe1\u606f \u793a\u4f8b\uff1a AT+TCDEVINFOSET=1,\"WDRRDCF1TE\",\"dev1\",\"ULtbpSxXtSQyaFyeaax6pw==\" OK +TCDEVINFOSET:OK \u6b64\u4fe1\u606f\u4f1a\u4fdd\u5b58\u5230Flash\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u67e5\u770b\uff1a AT+TCDEVINFOSET? +TCDEVINFOSET:1,\"WDRRDCF1TE\",\"dev1\",113 OK 3.3. \u8fde\u63a5\u817e\u8baf\u4e91 \u793a\u4f8b\uff1a AT+TCMQTTCONN=1,5000,240,1,1 OK +TCMQTTCONN:OK \u8fde\u63a5\u6210\u529f\uff0c\u6b64\u65f6\u5728\u817e\u8baf\u4e91IoThub\u5e73\u53f0\u5373\u53ef\u770b\u5230\u8bbe\u5907\u5728\u7ebf\uff1a 3.4. \u8ba2\u9605\u4e3b\u9898 \u793a\u4f8b\uff1a AT+TCMQTTSUB=\"WDRRDCF1TE/dev1/data\",0 OK +TCMQTTSUB:OK \u8ba2\u9605\u6210\u529f\u4e4b\u540e\uff0c\u5728\u4e91\u7aef\u8fdb\u5165\u8bbe\u5907\u5728\u7ebf\u8c03\u8bd5\uff0c\u53d1\u9001\u6d4b\u8bd5\u6570\u636e\uff1a \u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u53ef\u4ee5\u770b\u5230ESP8266\u6a21\u7ec4\u901a\u8fc7URC\u65b9\u5f0f\u4e0a\u62a5\u7684\u6570\u636e\uff1a 3.5. \u53d1\u5e03\u6d88\u606f \u793a\u4f8b\uff1a AT+TCMQTTPUB=\"WDRRDCF1TE/dev1/data\",0,\"helloworld\" \u8fd4\u56de\u7ed3\u679c\u4e3a\uff1a OK +TCMQTTPUB:OK \u5728\u4e91\u7aef\u53ef\u4ee5\u770b\u5230\u8bbe\u5907\u4e0a\u62a5\u7684\u6d88\u606f\uff1a 4. OTA\u5347\u7ea7 \u817e\u8baf\u4e91\u5b9a\u5236\u56fa\u4ef6\u4e2d\u5185\u7f6e\u4e86\u4e0eIoThub\u5e73\u53f0OTA\u56fa\u4ef6\u5347\u7ea7\u5bf9\u63a5\u7684AT\u6307\u4ee4\uff0c\u6574\u4e2a\u5347\u7ea7\u6d41\u7a0b\u5982\u4e0b\uff1a \u5728\u6a21\u7ec4\u8fde\u63a5IoThub\u5e73\u53f0\u6210\u529f\u4e4b\u540e\u8fdb\u884c\u5982\u4e0b\u7684\u64cd\u4f5c\u3002 4.1. \u4f7f\u80fdOTA\u529f\u80fd AT+TCOTASET=1,\"0.1\" \u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\uff1a OK +TCOTASET:OK \u6307\u4ee4\u6210\u529f\uff0c\u6b64\u65f6\u6a21\u7ec4\u5df2\u7ecf\u5904\u4e8e\u76d1\u542c\u5347\u7ea7\u547d\u4ee4\u72b6\u6001\u3002 4.2. \u4e91\u7aef\u4e0b\u53d1\u56fa\u4ef6 \u5c06\u5f85\u5347\u7ea7\u7684\u56fa\u4ef6\u4e0a\u4f20\u5230\u4e91\u5e73\u53f0\uff1a \u9009\u62e9\u4e0b\u53d10.2\u7248\u672c\u7684\u56fa\u4ef6\uff1a \u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u53ef\u4ee5\u770b\u5230\u6a21\u7ec4\u4e0a\u62a5\u7684URC\u6570\u636e\uff1a +TCOTASTATUS:ENTERUPDATE +TCOTASTATUS:UPDATESUCCESS 4.3. \u8bfb\u53d6\u6a21\u7ec4\u7f13\u5b58\u7684\u56fa\u4ef6\u4fe1\u606f AT+TCFWINFO? \u8fd4\u56de\u7ed3\u679c\u4e3a\uff1a OK +TCFWINFO:\"0.2\",6892,\"1eb6c5f8622f5b005bc3ff8f01575df8\",716800 \u4ece\u4e2d\u5f97\u5230\u7f13\u5b58\u7684\u56fa\u4ef6\u4fe1\u606f\u5982\u4e0b\uff1a \u56fa\u4ef6\u7248\u672c\uff1a0.2 \u56fa\u4ef6\u5927\u5c0f\uff1a6892\u5b57\u8282 \u56fa\u4ef6MD5 \u7528\u6237\u5f85\u5347\u7ea7\u7684OTA\u56fa\u4ef6\u7684\u6700\u5927\u5b57\u8282\u6570\uff0c700KB 4.4. \u8bfb\u53d6\u6a21\u7ec4\u7f13\u5b58\u7684\u56fa\u4ef6\u6570\u636e \u6bcf\u6b21\u8bfb\u53d6512\u5b57\u8282\uff1a AT+TCREADFWDATA=512 \u5f53\u6700\u540e\u4e00\u6b21\u8bfb\u53d6\u7684\u65f6\u5019\uff0c\u6a21\u7ec4\u5b9e\u9645\u8fd4\u56de\u8bfb\u53d6\u5927\u5c0f\u4e3a236\u5b57\u8282\uff0c\u5c0f\u4e8e512\u5b57\u8282\uff0c\u8868\u793a\u8bfb\u53d6\u7ed3\u675f\u3002","title":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub"},{"location":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub/#1-esp8266","text":"\u817e\u8baf\u4e91IoT AT\u6307\u4ee4\u662f\u4e00\u5957\u9488\u5bf9\u4f7f\u7528\u901a\u8baf\u6a21\u7ec4\uff082G/4G/NB/WIFI\uff09\u63a5\u5165\u817e\u8baf\u4e91\u7269\u8054\u5e73\u53f0\u7684\u5b9a\u5236AT\u6307\u4ee4\u96c6\uff0c\u5982\u679c\u901a\u8baf\u6a21\u7ec4\u5b9e\u73b0\u4e86\u8be5\u6307\u4ee4\u96c6\uff0c\u5219\u8bbe\u5907\u63a5\u5165\u548c\u901a\u8baf\u66f4\u4e3a\u7b80\u5355\uff0c\u6240\u9700\u4ee3\u7801\u91cf\u66f4\u5c11\u3002 ESP8266\u4f5c\u4e3aIoT\u9886\u57df\u4f7f\u7528\u6700\u5e7f\u6cdb\u7684\u4e00\u6b3eWiFi\u82af\u7247/\u6a21\u7ec4\uff0c\u6211\u4eec\u5728\u5176\u901a\u7528AT\u6307\u4ee4\u57fa\u7840\u4e0a\uff0c\u589e\u52a0\u4e86\u817e\u8baf\u4e91IoT AT\u6307\u4ee4\u96c6\uff0c\u5f62\u6210\u4e00\u4e2a\u5b9a\u5236\u7684\u6a21\u7ec4\u56fa\u4ef6QCloud_IoT_AT_ESP8266\uff0c\u817e\u8baf\u4e91IoT\u5b9a\u5236\u7684AT\u6a21\u7ec4\u56fa\u4ef6QCloud_IoT_AT_ESP8266\uff0c\u9002\u7528\u4e8e\u6240\u6709FLASH\u5927\u5c0f\u4e3a2MB\u6216\u80052MB\u4ee5\u4e0a\u7684ESP8266\u6a21\u7ec4\u3002 \u56fa\u4ef6\u70e7\u5f55\u65b9\u6cd5\u8bf7\u9605\u8bfb\u6587\u6863\uff1a \u817e\u8baf\u4e91 IoT AT ESP8266 \u5b9a\u5236\u56fa\u4ef6\u53ca\u8bf4\u660e \u3002","title":"1. \u817e\u8baf\u4e91ESP8266\u5b9a\u5236\u56fa\u4ef6\u8bf4\u660e\u53ca\u70e7\u5f55"},{"location":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub/#2","text":"\u767b\u5f55\u817e\u8baf\u4e91, \u641c\u7d22\"\u4e91\u4ea7\u54c1\"\u4e0b\u7684\"\u7269\u8054\u7f51\u901a\u4fe1\"\u4ea7\u54c1, \u6216\u76f4\u63a5\u8bbf\u95ee\uff1a https://console.cloud.tencent.com/iotcloud","title":"2. \u4e91\u7aef\u914d\u7f6e"},{"location":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub/#21","text":"\u5bf9\u4e8e\u8ba4\u8bc1\u65b9\u5f0f, \u6307\u5b9a\u4e86\u8bbe\u5907\u901a\u8fc7\u4f55\u79cd\u65b9\u5f0f\u548c\u4e91\u7aef\u8fdb\u884c\u53cc\u5411\u8ba4\u8bc1. \u9ed8\u8ba4\u7684\u8bc1\u4e66\u65b9\u5f0f\u76f8\u5bf9\u4e8e\u5bc6\u94a5\u8ba4\u8bc1\u5b89\u5168\u6027\u9ad8\u4e00\u70b9, \u4f46\u662f\u95ee\u9898\u5728\u4e8e\u8bc1\u4e66\u65b9\u5f0f\u9700\u8981\u5728\u5d4c\u5165\u5f0f\u8bbe\u5907\u7aef\u5b58\u50a8\u8bc1\u4e66\u540c\u65f6\u5b9e\u73b0\u8bc1\u4e66\u7684\u76f8\u5173\u5904\u7406, \u5bf9\u8bbe\u5907\u7684RAM\u548cROM\u8981\u6c42\u8f83\u9ad8, \u76f8\u5bf9\u800c\u8a00, \u5bc6\u94a5\u8ba4\u8bc1\u7684\u65b9\u5f0f\u8d44\u6e90\u5360\u7528\u91cf\u5c31\u5c0f\u70b9, \u7531\u4e8e\u6211\u4eec\u4e3b\u8981\u652f\u6301\u7684\u8bbe\u5907\u90fd\u662f\u5c0f\u578b\u5d4c\u5165\u5f0f\u8bbe\u5907, \u56e0\u6b64\u9009\u7528\u5bc6\u94a5\u8ba4\u8bc1\u3002 \u6570\u636e\u683c\u5f0f\u6307\u7684\u662f\u8bbe\u5907\u548c\u4e91\u7aef\u8fdb\u884c\u6570\u636e\u4ea4\u4e92\u65f6\u5019\u4f7f\u7528\u7684\u683c\u5f0f, json\u683c\u5f0f\u4e3a\u6587\u672c\u5b57\u7b26\u4e32, \u53ef\u8bfb\u6027\u9ad8, \u5e76\u4e14\u4fbf\u4e8e\u89e3\u6790, \u5bf9\u4e8e\u529f\u80fd\u590d\u6742\u7684\u8bbe\u5907\u4ea4\u4e92\u800c\u5df2\u6bd4\u8f83\u7406\u60f3, \u4f46\u662f\u5bf9\u4e8e\u5c0f\u578b\u8bbe\u5907\u6216\u662f\u5b9a\u5236\u8bbe\u5907, \u6570\u636e\u5355\u4e00, \u6216\u662f\u6709\u81ea\u5b9a\u4e49\u7684\u683c\u5f0f(\u4e8c\u8fdb\u5236\u6216\u662f\u6587\u672c), \u8fd9\u79cd\u65f6\u5019, \u7528\u81ea\u5b9a\u4e49\u7684\u6570\u636e\u683c\u5f0f, \u4e00\u65b9\u9762\u8282\u7ea6\u6d41\u91cf, \u53e6\u4e00\u65b9\u9762\u6bd4\u8f83\u7075\u6d3b.\u3002 \u521b\u5efa\u6210\u529f\u540e\uff0c\u83b7\u53d6\u5230\u4ea7\u54c1ID\uff1a","title":"2.1. \u521b\u5efa\u65b0\u4ea7\u54c1"},{"location":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub/#22","text":"\u6dfb\u52a0\u5b8c\u8bbe\u5907\u540e, \u4f1a\u544a\u77e5\u8bbe\u5907\u5bf9\u5e94\u7684\u5bc6\u94a5. \u8be5\u5bc6\u94a5\u5c06\u4f1a\u7528\u4e8e\u4e4b\u540e\u8bbe\u5907\u4e0e\u5e73\u53f0\u901a\u4fe1\u65f6\u7684\u8ba4\u8bc1\uff1a \u4e3a\u4e86\u5b9e\u73b0\u8bbe\u5907\u95f4\u7684\u901a\u4fe1, \u6211\u4eec\u8fd8\u9700\u8981\u521b\u5efa\u7b2c\u4e8c\u4e2a\u8bbe\u5907, \u64cd\u4f5c\u540c\u4e0a, \u5c06\u5176\u547d\u540d\u4e3a\"dev2\"\uff1a","title":"2.2. \u521b\u5efa\u65b0\u8bbe\u5907"},{"location":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub/#23-topic","text":"\u53ef\u4ee5\u5728\"\u6743\u9650\u5217\u8868\"\u4e2d\u770b\u5230Topic\u5bf9\u5e94\u7684\u64cd\u4f5c\u6743\u9650\uff1a \u5e73\u53f0\u9ed8\u8ba4\u914d\u7f6e\u4e86\u4e09\u7c7b\u7684Topic, \u7528\u4e8e\u6267\u884c\u53d1\u5e03\u548c\u8ba2\u9605.\uff0c\u8fd9\u91cc\u4e4b\u6240\u4ee5 \u662f\u4e09\u7c7b\u800c\u4e0d\u662f\u4e09\u4e2a , \u662f\u56e0\u4e3aTopic\u91cc\u4f7f\u7528\u4e86\u53d8\u91cf.\u3002 WDRRDCF1TE \u5b9e\u9645\u4e0a\u662fproductID\uff1b ${deviceName} \u4e3a\u5e73\u53f0\u8bbe\u7f6e\u7684\u53d8\u91cf, \u5373\u8bbe\u5907\u540d\uff1b control \u548c data \u4ee5\u53ca event \u4e3aTopic\u540d\u5b57.\uff1b \u6240\u4ee5, \u5728\u6211\u4eec\u521b\u5efa\u4e862\u4e2a\u8bbe\u5907dev1\u548cdev2\u7684\u60c5\u51b5\u4e0b, \u5728 BearPiTest \u4ea7\u54c1\u4e0b, \u5373\u5b58\u57286\u4e2aTopic, \u5206\u522b\u4e3a: WDRRDCF1T/dev1/control \u8ba2\u9605\u6743\u9650 WDRRDCF1T/dev1/data \u53d1\u5e03\u548c\u8ba2\u9605\u6743\u9650 WDRRDCF1T/dev1/event \u53d1\u5e03\u6743\u9650 WDRRDCF1T/dev2/control \u8ba2\u9605\u6743\u9650 WDRRDCF1T/dev2/data \u53d1\u5e03\u548c\u8ba2\u9605\u6743\u9650 WDRRDCF1T/dev2/event \u53d1\u5e03\u6743\u9650 \u8fd9\u91cc\u9ed8\u8ba4\u7684Topic\u5df2\u7ecf\u8db3\u591f\u6211\u4eec\u4f7f\u7528, \u4e0d\u9700\u8981\u989d\u5916\u6dfb\u52a0Topic\u548c\u6743\u9650\u4e86\u3002","title":"2.3. \u8bbe\u7f6eTopic"},{"location":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub/#24","text":"\u89c4\u5219\u5f15\u64ce\u672c\u8eab\u4e0d\u5c5e\u4e8eMQTT\u534f\u8bae\u7684\u8303\u7574, \u4f46\u662f\u5e73\u53f0\u4fa7\u51fa\u4e8e\u5b89\u5168\u89d2\u5ea6\u8003\u8651\u6dfb\u52a0\u4e86\u89c4\u5219\u5f15\u64ce, \u5b9e\u73b0\u4e86Topic\u4e4b\u95f4\u7684\u8f6c\u53d1\u64cd\u4f5c, \u6211\u4eec\u9700\u8981\u5408\u7406\u7684\u8bbe\u7f6e\u89c4\u5219\u5f15\u64ce\u624d\u80fd\u5b9e\u73b0\u591a\u4e2a\u8bbe\u5907\u4e4b\u95f4\u7684\u6570\u636e\u6536\u53d1, \u7531\u4e8e\u7406\u89e3\u8d77\u6765\u6bd4\u8f83\u590d\u6742, \u6211\u4eec\u8fd9\u91cc\u7b80\u8981\u8bb2\u89e3\u4e0b\u4e3a\u4ec0\u4e48\u9700\u8981\u89c4\u5219\u5f15\u64ce, \u89c4\u5219\u5f15\u64ce\u7684\u4f5c\u7528, \u5982\u4f55\u8bbe\u7f6e\u89c4\u5219\u5f15\u64ce. \u4e3a\u4ec0\u4e48\u9700\u8981\u89c4\u5219\u5f15\u64ce \u5728\u4e0a\u8282\u7684Topic\u4e2d, \u6211\u4eec\u77e5\u9053, \u5728\u5e73\u53f0\u4fa7, \u5bf9\u4e8e\u4e0d\u540c\u7684Topic, \u89c4\u5b9a\u4e86\u4e0d\u540c\u7684\u6743\u9650, \u4f8b\u5982, \u5bf9\u4e8e WDRRDCF1T/dev1/event \u8fd9\u4e2aTopic, \u53ea\u5177\u6709\u53d1\u5e03\u6743\u9650, \u800c\u5bf9\u4e8e WDRRDCF1T/dev1/control \u8fd9\u4e2aTopic, \u53ea\u5177\u6709\u8ba2\u9605\u6743\u9650. \u5bf9\u4e8e\u8bbe\u5907dev1, \u5f88\u81ea\u7136\u7684, \u4f1a\u671d WDRRDCF1T/dev1/event \u8fd9\u4e2aTopic\u53d1\u9001\u6570\u636e, \u5e76\u4e14\u8ba2\u9605 WDRRDCF1T/dev1/control \u8fd9\u4e2aTopic\u7684\u6d88\u606f. \u4f46\u662f\u8fd9\u91cc\u5c31\u4f1a\u6d89\u53ca\u5230, event\u7684\u6570\u636e\u6700\u540e\u5230\u54ea\u53bb, control\u7684\u6570\u636e\u4ece\u54ea\u91cc\u6765\u7684\u95ee\u9898. \u5728\u672c\u6587\u7684\u4f8b\u5b50\u4e2d, \u6211\u4eec\u5e0c\u671bdev1\u548cdev2\u53d1\u751f\u4ea4\u4e92, \u5373\u76f8\u4e92\u6536\u53d1\u6d88\u606f. \u7531\u4e8eMQTT\u662f\u57fa\u4e8eTopic\u7684\u53d1\u5e03\u8ba2\u9605\u673a\u5236, \u56e0\u6b64, dev1\u60f3\u8981\u83b7\u5f97dev2\u7684\u6570\u636e, \u76f4\u89c9\u4e0a, \u9700\u8981\u8ba2\u9605dev2\u53d1\u5e03\u6d88\u606f\u7684\u90a3\u4e2aTopic. \u5047\u5b9adev2\u671d 25KCIUIR1G/dev2/event Topic\u4e0a\u53d1\u9001\u6570\u636e, \u90a3\u4e48dev1\u60f3\u8981\u83b7\u5f97dev2\u53d1\u5e03\u7684\u6d88\u606f, \u6700\u76f4\u63a5\u7684\u529e\u6cd5\u662f\u8ba2\u9605\u540c\u6837\u7684Topic, \u5373 25KCIUIR1G/dev2/event , \u4f46\u662f\u8fd9\u91cc\u5b58\u5728\u51e0\u4e2a\u95ee\u9898, \u9996\u5148, event Topic\u53ea\u5177\u6709\u53d1\u5e03\u6743\u9650, \u6ca1\u6709\u8ba2\u9605\u6743\u9650, \u5176\u6b21, \u5728\u5e73\u53f0\u4fa7, \u89c4\u5b9a\u4e86, \u4e0d\u5141\u8bb8\u8de8\u8bbe\u5907\u53d1\u5e03\u6216\u662f\u8ba2\u9605Topic , \u4e5f\u5c31\u662f\u8bf4, \u5bf9\u4e8edev1, \u53ea\u80fd\u770b\u5230\u6216\u53ea\u5141\u8bb8\u8bbf\u95ee WDRRDCF1T/dev1 \u8fd9\u4e2aTopic\u4ee5\u53ca\u5176\u4e0b\u5c5e\u7684Topic, \u4e0d\u80fd\u8bbf\u95ee WDRRDCF1T/dev2 \u53ca\u5176\u4e0b\u5c5eTopic. \u5e73\u53f0\u4fa7\u6dfb\u52a0\u4e0d\u5141\u8bb8\u8de8\u8bbe\u5907\u8bbf\u95eeTopic\u7684\u89c4\u5219\u867d\u7136\u4e0d\u76f4\u89c2, \u4f46\u5374\u662f\u5408\u7406\u7684. \u5982\u679c\u4e0d\u6dfb\u52a0\u8fd9\u6761\u9650\u5236, \u90a3\u4e48\u4e00\u4e2a\u8bbe\u5907\u53ef\u4ee5\u4e0d\u52a0\u9650\u5236\u7684\u8ba2\u9605\u540c\u4e00\u4e2a\u4ea7\u54c1\u4e0b\u6240\u6709\u5176\u4ed6\u8bbe\u5907\u7684Topic, \u83b7\u53d6\u5176\u4e0a\u62a5\u7684\u6d88\u606f, \u8fd9\u5b58\u5728\u6f5c\u5728\u7684\u5b89\u5168\u6f0f\u6d1e. \u89c4\u5219\u5f15\u64ce\u7684\u4f5c\u7528 \u56e0\u4e3a\u4e0d\u5141\u8bb8\u76f4\u63a5\u8de8\u8bbe\u5907\u8bbf\u95eeTopic, \u6240\u4ee5\u9700\u8981\u4f9d\u9760\"\u89c4\u5219\u5f15\u64ce\"\u6765\u624b\u52a8\u6dfb\u52a0\u89c4\u5219, \u5c06\u6307\u5b9a\u7684Topic\u6d88\u606f\u8f6c\u53d1\u5230\u53e6\u4e00\u4e2aTopic\u4e0a, \u5b9e\u73b0\u4e0d\u540c\u8bbe\u5907\u4e4b\u95f4\u7684\u901a\u4fe1. \u4e0a\u56fe\u4ecb\u7ecd\u4e86\u89c4\u5219\u5f15\u64ce\u7684\u4e3b\u8981\u4f5c\u7528\"republish\", \u5373\u5c06\u4e00\u4e2aTopic\u4e0b\u7684\u6d88\u606frepublish\u5230\u53e6\u4e00\u4e2aTopic\u4e0b. \u4ece\u56fe\u4e2d\u6211\u4eec\u53ef\u4ee5\u770b\u5230, \u89c4\u5219\u5f15\u64ce\u5c06 WDRRDCF1TE/dev2/event \u7684\u6d88\u606frepublish\u5230\u4e86 WDRRDCF1TE/dev1/control \u4e0b. \u5c06 WDRRDCF1TE/dev1/event \u7684\u6d88\u606frepublish\u5230\u4e86 WDRRDCF1TE/dev2/control \u4e0b\u3002 \u8fd9\u6837, \u5bf9\u4e8edev1\u800c\u8a00, \u53ea\u9700\u8981\u8ba2\u9605 WDRRDCF1TE/dev1/control \u5c31\u53ef\u4ee5\u63a5\u6536\u6765\u81ea 25KCIUIR1G/dev2/event \u7684\u6d88\u606f\u4e86\uff0cdev2\u540c\u7406\u3002 \u8bbe\u7f6e\u89c4\u5219\u5f15\u64ce \u5728\u7269\u8054\u7f51\u901a\u4fe1\u754c\u9762\u9009\u62e9\"\u89c4\u5219\u5f15\u64ce\"--\"\u65b0\u5efa\u89c4\u5219\", \u968f\u610f\u6307\u5b9a\u4e00\u4e2a\u89c4\u5219\u540d\u79f0, \u6211\u4eec\u8fd9\u91cc\u4e0d\u59a8\u8bbe\u7f6e\u4e3a\"1to2\"\uff1a \u8fd9\u91cc, \u6211\u4eec\u770b\u5230\u89c4\u5219\u7684\u8be6\u7ec6\u8bbe\u7f6e\u4fe1\u606f, \u4e3b\u8981\u5305\u62ec\"\u7b5b\u9009\u6570\u636e\"\u548c\"\u884c\u4e3a\u64cd\u4f5c\"\u3002 \"\u7b5b\u9009\u6570\u636e\"\u9488\u5bf9\u6307\u5b9aTopic\u63a5\u6536\u5230\u7684\u6d88\u606f\u5185\u5bb9\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u7b5b\u9009, \u6bd4\u5982\u5339\u914d\u6d88\u606f\u4e2d\u7684\u5b57\u6bb5\u6765\u51b3\u5b9a\u662f\u5426\u6267\u884c\u4e4b\u540e\u7684\u8bbe\u7f6e\u7684\"\u884c\u4e3a\u64cd\u4f5c\".\uff0c\u800c\"\u884c\u4e3a\u64cd\u4f5c\"\u5219\u662f\u6307\u5b9a\u5bf9\u901a\u8fc7\u5339\u914d\u7684\u6d88\u606f\u8fdb\u884c\u4f55\u79cd\u64cd\u4f5c, \u4e3b\u8981\u7684\u64cd\u4f5c\u6709\"\u6570\u636e\u8f6c\u53d1\u5230\u53e6\u4e00\u4e2aTopic(Republish)\", \"\u8f6c\u53d1\u5230\u7b2c\u4e09\u65b9\u670d\u52a1(Forward)\"\u4ee5\u53ca\u8f6c\u53d1\u5230\u817e\u8baf\u4e91\u5404\u4e2a\u5bf9\u5e94\u7ec4\u4ef6\u4e2d\u3002 \u4e0a\u56fe\u662f\u8bbe\u7f6e\u597d\u7684\u89c4\u5219, \u8fd9\u91cc, \u6211\u4eec\u5c06\"\u7b5b\u9009\u6570\u636e\"\u90e8\u5206\u7684\u7b5b\u9009\u5b57\u6bb5\u8bbe\u7f6e\u4e3a * , \u7b5b\u9009\u7684Topic\u4e3a WDRRDCF1T/dev1/event , \u6761\u4ef6\u8bbe\u7f6e\u4e3a\u7a7a, \u5373\u4e0d\u7b5b\u9009\u6570\u636e, \u5168\u90e8\u5339\u914d\uff0c\u7136\u540e, \u6267\u884c\u7684\u64cd\u4f5c\u662f\u5c06\u6570\u636e\u8f6c\u53d1\u5230 WDRRDCF1T/dev2/control , \u8bbe\u7f6e\u5b8c\u8fd9\u6761\u89c4\u5219, \u5c31\u5b9e\u73b0\u4e86dev2\u901a\u8fc7\u8ba2\u9605control\u5c31\u80fd\u6536\u5230dev1\u53d1\u9001\u5230event\u7684\u6570\u636e\u3002 \u5173\u4e8e\"\u7b5b\u9009\u6570\u636e\"\u7684\u8bbe\u5b9a\uff1a \u7531\u4e8e\u6211\u4eec\u5728\u65b0\u5efa\u4ea7\u54c1, \u8bbe\u7f6e\u6570\u636e\u683c\u5f0f\u7684\u65f6\u5019\u9009\u62e9\u4e86\u81ea\u5b9a\u4e49\u6570\u636e\u683c\u5f0f, \u5728\u81ea\u5b9a\u4e49\u6570\u636e\u683c\u5f0f\u7684\u60c5\u51b5\u4e0b, \u5f53\u524d\u5e73\u53f0\u5c06\u5176\u5f53\u505a\u4e8c\u8fdb\u5236\u6d41\u6765\u5904\u7406, \u4e5f\u5c31\u65e0\u6cd5\u901a\u8fc7\u5339\u914d\u5b57\u6bb5\u8fdb\u884c\u6570\u636e\u7b5b\u9009. \u5982\u679c\u5728\u8fdb\u884c\u4ea7\u54c1\u7684\u65f6\u5019, \u4f7f\u7528\u6570\u636e\u683c\u5f0f\u662fjson, \u90a3\u4e48\u6b64\u5904\u5c31\u53ef\u4ee5\u6839\u636ejson\u4e2d\u7684\u5b57\u6bb5\u8fdb\u884cSQL\u7684\u5339\u914d\u548c\u7b5b\u9009. \u540c\u7406, \u6211\u4eec\u518d\u8bbe\u7f6e\u65b0\u7684\u4e00\u4e2a\u89c4\u5219\"2to1\", \u5b9e\u73b0 WDRRDCF1T/dev2/event \u5230 WDRRDCF1T/dev1/control \u7684\u8f6c\u53d1\uff1a \u89c4\u5219\u5f15\u64ce\u90fd\u8bbe\u7f6e\u597d\u540e\uff0c\u8bb0\u5f97\u70b9\u542f\u7528\u6309\u94ae\uff0c\u8fd9\u6837, \u5728\u5e73\u53f0\u4fa7dev1\u5230dev2\u7684\u53cc\u5411\u6570\u636e\u901a\u8def\u5c31\u6253\u901a\u4e86\uff1a","title":"2.4. \u8bbe\u7f6e\u89c4\u5219\u5f15\u64ce"},{"location":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub/#25","text":"\u5728\u5e73\u53f0\u4fa7\u90fd\u8bbe\u7f6e\u597d\u540e, \u6211\u4eec\u5728\u4e4b\u540e\u7684\u6d4b\u8bd5\u8fc7\u7a0b\u6216\u662f\u901a\u4fe1\u8fc7\u7a0b\u4e2d, \u5f80\u5f80\u8fd8\u9700\u8981\u67e5\u770b\u5e73\u53f0\u662f\u5426\u6536\u5230\u4e86\u8bbe\u5907\u53d1\u9001\u4e0a\u6765\u7684\u6d88\u606f, \u5bf9\u6d88\u606f\u6267\u884c\u4e86\u54ea\u4e9b\u64cd\u4f5c, \u6d88\u606f\u7684\u5177\u4f53\u5185\u5bb9(payload)\u662f\u4ec0\u4e48. \u817e\u8baf\u4e91\u63d0\u4f9b\u4e86\u7269\u8054\u7f51\u901a\u4fe1\u4ea7\u54c1\u7684\"\u4e91\u65e5\u5fd7\"\u529f\u80fd\u548c\u817e\u8baf\u4e91\u7ec4\u4ef6\"\u6d88\u606f\u961f\u5217CMQ\"\u3002 \u65e5\u5fd7\u4e2d\u53ef\u4ee5\u770b\u5230\u65e5\u5fd7\u8bb0\u5f55\u4e86\u8bbe\u5907\u7684\u8fde\u63a5, \u8fde\u63a5\u65ad\u5f00, \u53d1\u5e03, \u8ba2\u9605\u7b49\u884c\u4e3a, \u4e5f\u8bb0\u5f55\u4e86\u89c4\u5219\u5f15\u64ce\u7684\u64cd\u4f5c, \u8fd8\u6709CMQ\u961f\u5217\u7684\u4e00\u4e9b\u884c\u4e3a\u65e5\u5fd7.\u3002","title":"2.5. \u4e91\u65e5\u5fd7"},{"location":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub/#26-cmq","text":"\u53ef\u4ee5\u5728\u4ea7\u54c1\u5217\u8868\u4e2d\u627e\u5230\"\u6d88\u606f\u961f\u5217\"\u9009\u9879, \u8bbe\u7f6e\u961f\u5217\u6240\u60f3\u8981\u63a5\u6536\u7684\u6d88\u606f\u7c7b\u578b\u540e\u4fdd\u5b58\u914d\u7f6e, \u5373\u53ef\u5c06\u5e73\u53f0\u4fa7\u6536\u5230\u7684\u8bbe\u5907\u6d88\u606f\u989d\u5916\u53d1\u9001\u5230\u817e\u8baf\u4e91\u6d88\u606f\u961f\u5217CMQ\u7ec4\u4ef6\u4e2d\uff1a \u5728\u5bc6\u94a5\u8ba4\u8bc1\u4e0b, \u6d88\u606f\u7684\u5185\u5bb9(payload)\u662f\u7ecf\u8fc7base64\u7f16\u7801\u7684, \u6240\u4ee5\u5728\u5e73\u53f0\u4fa7\u770b\u5230\u7684\u6570\u636e\u7c7b\u4f3c\u4e71\u7801\u5b9e\u9645\u4e0a\u662f\u7ecf\u8fc7\u7f16\u7801\u540e\u7684\u7ed3\u679c, \u60f3\u8981\u67e5\u770b\u5177\u4f53\u7684\u5185\u5bb9, \u53ef\u4ee5\u5728linux\u4e0b, echo <payload> | base64 --decode .","title":"2.6. \u6d88\u606f\u961f\u5217CMQ"},{"location":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub/#3","text":"\u4f7f\u7528USB\u8f6c\u4e32\u53e3\u5c06\u70e7\u5f55\u597d\u817e\u8baf\u4e91\u5b9a\u5236\u56fa\u4ef6\u7684ESP8266\u8fde\u63a5\u5230PC\uff0c\u4f7f\u7528\u4e32\u53e3\u52a9\u624b\u6253\u5f00\u4e32\u53e3\u5f00\u59cb\u8c03\u8bd5\u3002","title":"3. \u8bbe\u5907\u7aef\u5bf9\u63a5\u6d4b\u8bd5"},{"location":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub/#31","text":"\u6d4b\u8bd5AT\u6307\u4ee4\u662f\u5426\u6b63\u5e38\uff1a AT OK \u8bbe\u7f6eESP8266\u5de5\u4f5c\u6a21\u5f0f\u4e3aAP\u548cSTA\u5e76\u5b58\uff1a AT+CWMODE=3 OK \u8bbe\u7f6e\u4f20\u8f93\u6a21\u5f0f\u4e3a\u666e\u901a\u4f20\u8f93\u6a21\u5f0f\uff1a AT+CIPMODE=0 OK \u5f00\u542f\u591a\u8def\u6a21\u5f0f\uff1a AT+CIPMUX=1 OK \u5165\u7f51\uff1a AT+CWJAP=\"Mculover666\",\"mculover666\" WIFI CONNECTED WIFI GOT IP OK","title":"3.1. \u5165\u7f51"},{"location":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub/#32","text":"\u793a\u4f8b\uff1a AT+TCDEVINFOSET=1,\"WDRRDCF1TE\",\"dev1\",\"ULtbpSxXtSQyaFyeaax6pw==\" OK +TCDEVINFOSET:OK \u6b64\u4fe1\u606f\u4f1a\u4fdd\u5b58\u5230Flash\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u67e5\u770b\uff1a AT+TCDEVINFOSET? +TCDEVINFOSET:1,\"WDRRDCF1TE\",\"dev1\",113 OK","title":"3.2. \u8bbe\u7f6e\u817e\u8baf\u4e91\u5bf9\u63a5\u4fe1\u606f"},{"location":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub/#33","text":"\u793a\u4f8b\uff1a AT+TCMQTTCONN=1,5000,240,1,1 OK +TCMQTTCONN:OK \u8fde\u63a5\u6210\u529f\uff0c\u6b64\u65f6\u5728\u817e\u8baf\u4e91IoThub\u5e73\u53f0\u5373\u53ef\u770b\u5230\u8bbe\u5907\u5728\u7ebf\uff1a","title":"3.3. \u8fde\u63a5\u817e\u8baf\u4e91"},{"location":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub/#34","text":"\u793a\u4f8b\uff1a AT+TCMQTTSUB=\"WDRRDCF1TE/dev1/data\",0 OK +TCMQTTSUB:OK \u8ba2\u9605\u6210\u529f\u4e4b\u540e\uff0c\u5728\u4e91\u7aef\u8fdb\u5165\u8bbe\u5907\u5728\u7ebf\u8c03\u8bd5\uff0c\u53d1\u9001\u6d4b\u8bd5\u6570\u636e\uff1a \u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u53ef\u4ee5\u770b\u5230ESP8266\u6a21\u7ec4\u901a\u8fc7URC\u65b9\u5f0f\u4e0a\u62a5\u7684\u6570\u636e\uff1a","title":"3.4. \u8ba2\u9605\u4e3b\u9898"},{"location":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub/#35","text":"\u793a\u4f8b\uff1a AT+TCMQTTPUB=\"WDRRDCF1TE/dev1/data\",0,\"helloworld\" \u8fd4\u56de\u7ed3\u679c\u4e3a\uff1a OK +TCMQTTPUB:OK \u5728\u4e91\u7aef\u53ef\u4ee5\u770b\u5230\u8bbe\u5907\u4e0a\u62a5\u7684\u6d88\u606f\uff1a","title":"3.5. \u53d1\u5e03\u6d88\u606f"},{"location":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub/#4-ota","text":"\u817e\u8baf\u4e91\u5b9a\u5236\u56fa\u4ef6\u4e2d\u5185\u7f6e\u4e86\u4e0eIoThub\u5e73\u53f0OTA\u56fa\u4ef6\u5347\u7ea7\u5bf9\u63a5\u7684AT\u6307\u4ee4\uff0c\u6574\u4e2a\u5347\u7ea7\u6d41\u7a0b\u5982\u4e0b\uff1a \u5728\u6a21\u7ec4\u8fde\u63a5IoThub\u5e73\u53f0\u6210\u529f\u4e4b\u540e\u8fdb\u884c\u5982\u4e0b\u7684\u64cd\u4f5c\u3002","title":"4. OTA\u5347\u7ea7"},{"location":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub/#41-ota","text":"AT+TCOTASET=1,\"0.1\" \u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\uff1a OK +TCOTASET:OK \u6307\u4ee4\u6210\u529f\uff0c\u6b64\u65f6\u6a21\u7ec4\u5df2\u7ecf\u5904\u4e8e\u76d1\u542c\u5347\u7ea7\u547d\u4ee4\u72b6\u6001\u3002","title":"4.1. \u4f7f\u80fdOTA\u529f\u80fd"},{"location":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub/#42","text":"\u5c06\u5f85\u5347\u7ea7\u7684\u56fa\u4ef6\u4e0a\u4f20\u5230\u4e91\u5e73\u53f0\uff1a \u9009\u62e9\u4e0b\u53d10.2\u7248\u672c\u7684\u56fa\u4ef6\uff1a \u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u53ef\u4ee5\u770b\u5230\u6a21\u7ec4\u4e0a\u62a5\u7684URC\u6570\u636e\uff1a +TCOTASTATUS:ENTERUPDATE +TCOTASTATUS:UPDATESUCCESS","title":"4.2. \u4e91\u7aef\u4e0b\u53d1\u56fa\u4ef6"},{"location":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub/#43","text":"AT+TCFWINFO? \u8fd4\u56de\u7ed3\u679c\u4e3a\uff1a OK +TCFWINFO:\"0.2\",6892,\"1eb6c5f8622f5b005bc3ff8f01575df8\",716800 \u4ece\u4e2d\u5f97\u5230\u7f13\u5b58\u7684\u56fa\u4ef6\u4fe1\u606f\u5982\u4e0b\uff1a \u56fa\u4ef6\u7248\u672c\uff1a0.2 \u56fa\u4ef6\u5927\u5c0f\uff1a6892\u5b57\u8282 \u56fa\u4ef6MD5 \u7528\u6237\u5f85\u5347\u7ea7\u7684OTA\u56fa\u4ef6\u7684\u6700\u5927\u5b57\u8282\u6570\uff0c700KB","title":"4.3. \u8bfb\u53d6\u6a21\u7ec4\u7f13\u5b58\u7684\u56fa\u4ef6\u4fe1\u606f"},{"location":"25.How_To_Use_Esp8266_Tencent_Firmware_Connect_Iot_Hub/#44","text":"\u6bcf\u6b21\u8bfb\u53d6512\u5b57\u8282\uff1a AT+TCREADFWDATA=512 \u5f53\u6700\u540e\u4e00\u6b21\u8bfb\u53d6\u7684\u65f6\u5019\uff0c\u6a21\u7ec4\u5b9e\u9645\u8fd4\u56de\u8bfb\u53d6\u5927\u5c0f\u4e3a236\u5b57\u8282\uff0c\u5c0f\u4e8e512\u5b57\u8282\uff0c\u8868\u793a\u8bfb\u53d6\u7ed3\u675f\u3002","title":"4.4. \u8bfb\u53d6\u6a21\u7ec4\u7f13\u5b58\u7684\u56fa\u4ef6\u6570\u636e"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/","text":"TencentOS tiny\u5b9a\u5236\u5f00\u53d1\u677fEVB_WL\u5feb\u901f\u5165\u95e8\u6307\u5357 Revision Date Description 1.0 2020-7-28 \u6587\u6863\u521d\u7248 1.1 2020-9-6 \u6dfb\u52a0\u82af\u7247\u89e3\u9501\u7ae0\u8282 1. \u5b9a\u5236\u5f00\u53d1\u677fEVB_WL\u786c\u4ef6\u7b80\u4ecb 1.1 \u5f00\u53d1\u677f\u7b80\u4ecb EVB_WL\u662f\u817e\u8baf\u7269\u8054\u7f51\u64cd\u4f5c\u7cfb\u7edfTencentOS tiny \u56e2\u961f\u8054\u5408\u610f\u6cd5\u534a\u5bfc\u4f53\u3001\u745e\u5174\u6052\u65b9\u3001\u667a\u82af\u4e91\u6280\u672f\u8bbe\u8ba1\u7684\u4e00\u6b3eloRaWAN OpenCPU\u8bc4\u4f30\u677f\uff0c\u7528\u4e8eTencentOS tiny \u57fa\u7840\u5185\u6838\u548cLoRaWAN\u7269\u8054\u7f51\u7ec4\u4ef6\u529f\u80fd\u4f53\u9a8c\u548c\u8bc4\u4f30\u3002 \u5f00\u53d1\u677f\u529f\u80fd\u56fe\u5982\u4e0b\u6240\u793a\uff1a 1.2 \u5f00\u53d1\u677f\u7279\u6027 CPU \uff1a\u4f7f\u7528\u745e\u5174\u6052\u65b9\u7684RHF0M0E5\u6a21\u7ec4\uff0c\u6a21\u7ec4\u5185\u90e8\u96c6\u6210\u610f\u6cd5\u534a\u5bfc\u4f53STM32WLE5\u82af\u7247\uff0c\u5355\u82af\u7247\u96c6\u6210ARM\u00ae Cortex\u00ae-M4 48MHz\u5185\u6838\u548cSX126x IP\uff1b\u91c7\u7528LoRa\u00ae\u6269\u9891\u8c03\u5236\u6280\u672f\uff0cLoRa\u00ae\u63a5\u6536\u7075\u654f\u5ea6\u9ad8\u8fbe-148dBm\uff0c\u901a\u4fe1\u8ddd\u79bb\u8fbe1KM\uff5e10KM\uff1b\u5185\u7f6e\u9ad8\u6548\u7387PA\uff0c\u529f\u8017\u66f4\u4f4e\uff0c\u6700\u5927\u652f\u6301+22dBm\u8f93\u51fa\uff0c\u5e76\u57280-22dBm\u8303\u56f4\u5185\u53ef\u914d\u7f6e\u3002 \u7535\u6e90\u7279\u6027 \uff1aMicro USB\u63a5\u53e3\uff0c5V\u4f9b\u7535\uff0c\u5185\u90e8\u67095V\u8f6c3.3V\u7684DCDC\uff0cMCU\u4f9b\u7535\u7535\u538b\u4e3a3.3V\uff0c\u7cfb\u7edfIO\u7535\u538b\u4e5f\u4e3a3.3V \u6309\u952e \uff1a\u4e00\u4e2a\u590d\u4f4d\u6309\u952e LED\u6307\u793a\u706f \uff1a\u4e0a\u7535\u6307\u793a LED\uff0c\u7ea2\u8272\uff1b \u8c03\u8bd5\u63a5\u53e3 \uff1aSWD\u5916\u63a5ST-Link\uff0cUART1\u4e32\u53e3\u8fde\u63a5PC/LUART\u4e32\u53e3 \u4f20\u611f\u5668\u6269\u5c55\u63a5\u53e3E53 Interface \uff1a\u652f\u6301E53\u4f20\u611f\u5668\u6848\u4f8b\u6269\u5c55\u677f\uff08\u652f\u6301UART\u3001SPI\u3001IIC\u3001GPIO\u3001ADC\u3001DAC\u7b49\uff09 \u64cd\u4f5c\u7cfb\u7edf\u652f\u6301 \uff1aTencentOS tiny 1.3 \u5f00\u53d1\u677f\u786c\u4ef6\u8be6\u89e3 1.3.1 \u7535\u6e90\u7535\u8def Micro USB \u63d0\u4f9b5V\u7535\u6e90\uff0c\u7531\u4e8eMCU\u4f9b\u7535\u7535\u538b\u662f3.3V\uff0c\u6240\u4ee5\u8fd9\u91cc\u91c7\u7528AMS1117\u8fdb\u884cDC-DC\u7535\u538b\u8f6c\u6362\uff0c\u8f93\u51fa\u8c03\u8282\u81f33.3V\uff0c\u8ba9\u5f00\u53d1\u677f\u6b63\u5e38\u5de5\u4f5c\u3002 1.3.2 CPU\u6700\u5c0f\u7cfb\u7edf\u7535\u8def \u5355\u7247\u673a\u6700\u5c0f\u7cfb\u7edf\u6216\u8005\u53eb\u6700\u5c0f\u786c\u4ef6\u5355\u5143\u7535\u8def\uff0c\u6307\u7528\u6700\u5c11\u5143\u5668\u4ef6\u7ec4\u6210\u7684\u5355\u7247\u673a\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u7684\u7cfb\u7edf\u3002\u6700\u5c0f\u7cfb\u7edf\u57fa\u672c\u7531\u7535\u6e90\u3001\u5355\u7247\u673a\u3001\u6676\u632f\u3001\u590d\u4f4d\u7535\u8def\u3001\u7a0b\u5e8f\u70e7\u5f55\u63a5\u53e3\u7ec4\u6210\uff0c\u7535\u6e90\u4f7f\u75283.3V\u76f4\u63a5\u4f9b\u7535\uff0c\u4f46\u662fEVB_WL\u7684\u6676\u632f\u7535\u8def\u5c01\u88c5\u5728\u745e\u5174\u6052\u65b9\u6a21\u7ec4\u5185\u90e8\u4e86\uff0c\u6240\u4ee5\u8fd9\u91cc\u53ea\u80fd\u770b\u5230\u6a21\u7ec4\u5f15\u811a\u8fde\u63a5\u548c\u590d\u4f4d\u7535\u8def\uff0c\u539f\u7406\u56fe\u5982\u4e0b\uff1a 1.3.3 USB\u7535\u5e73\u8f6c\u6362\u7535\u8def USB\u7535\u5e73\u8f6c\u6362\u7535\u8def\u662f\u7528\u4e8eMCU\u548cPC\u901a\u4fe1\u7684\u573a\u666f\u4e2d\u3002PC\u673a\u4e0a\u7684\u901a\u4fe1\u63a5\u53e3\u4f7f\u7528USB\u63a5\u53e3\uff0c\u76f8\u5e94\u7684\u7535\u5e73\u903b\u8f91\u9700\u8981\u9075\u7167USB\u7535\u5e73\u89c4\u5219\uff0c\u800cMCU\u7684\u4e32\u884c\u901a\u4fe1\u63a5\u53e3\u662f\u4e32\u53e3\uff0c\u76f8\u5e94\u7535\u5e73\u9700\u8981\u9075\u5faaTTL\u539f\u5219\u3002\u4e3a\u4e86\u4f7f\u4e24\u8005\u53ef\u4ee5\u4e92\u76f8\u901a\u4fe1\uff0c\u5c31\u9700\u8981\u4e00\u4e2a\u7535\u5e73\u8f6c\u6362\u5668\uff0cEVB_WL\u4e0a\u4f7f\u7528\u4e86CH340\u82af\u7247\u4f5c\u4e3a\u8f6c\u6362\u5668\uff0cCH340\u5916\u56f4\u53ea\u9700\u8981\u63a5\u5f88\u5c11\u7684\u5143\u5668\u4ef6\u5373\u53ef\u4ee5\u5b9e\u73b0USB\u603b\u7ebf\u8f6c\u63a5\uff0c\u4f7f\u7528\u975e\u5e38\u65b9\u4fbf\u4e5f\u5e7f\u6cdb\u8fd0\u7528\u5728USB\u8f6cTTL\u5de5\u5177\u4e0a\uff0c\u7535\u8def\u5982\u4e0b\uff1a 1.3.4 E53 \u4f20\u611f\u5668\u6269\u5c55\u63a5\u53e3 \u5f00\u53d1\u677f\u8bbe\u8ba1\u6709E53\u63a5\u53e3\u7684\u4f20\u611f\u5668\u6269\u5c55\u677f\u63a5\u53e3\uff0c\u8be5\u63a5\u53e3\u53ef\u517c\u5bb9\u6240\u6709E53\u63a5\u53e3\u7684\u4f20\u611f\u5668\u6269\u5c55\u677f\uff0c\u5b9e\u73b0\u4e0d\u540c\u7269\u8054\u7f51\u6848\u4f8b\u573a\u666f\u7684\u5feb\u901f\u642d\u5efa\u3002\u8be5\u63a5\u53e3\u53ef\u63a5\u5165UART\u3001SPI\u3001I2C\u3001ADC\u7b49\u901a\u4fe1\u534f\u8bae\u7684\u4f20\u611f\u5668\uff0c\u5176\u539f\u7406\u56fe\u5982\u4e0b\u56fe\u6240\u793a\u3002 \u4f20\u611f\u5668\u6269\u5c55\u677f\u6709E53_SC1\u667a\u6167\u57ce\u5e02\u706f\u5149\u6a21\u5757\u3001E53_SF1\u667a\u6167\u6d88\u9632\u70df\u611f\u6a21\u5757\u3001E53_IA1\u667a\u6167\u519c\u4e1a\u6a21\u5757\u7b49\uff0c\u5982\u9700\u8981\u66f4\u591a\u4f20\u611f\u6269\u5c55\u677f\u53ef\u81ea\u884c\u627e\u5408\u4f5c\u4f9b\u5e94\u5546\uff08\u7269\u8054\u7f51\u4ff1\u4e50\u90e8\uff09\u8d2d\u4e70\uff09\u3002 \u5982\u4e0b\u56fe\uff1a 1.3.5 \u5f00\u53d1\u677f\u8c03\u8bd5\u70e7\u5f55\u53e3 \u5f00\u53d1\u677f\u9884\u7559\u4e86SWD\u7a0b\u5e8f\u4e0b\u8f7d\u8c03\u8bd5\u53e3\uff0c\u8fd8\u6709UART1\u548c\u4f4e\u529f\u8017\u4e32\u53e3LP_UART\uff0c\u65b9\u4fbf\u7528\u6237\u4e0b\u8f7d\u8c03\u8bd5\u7a0b\u5e8f\uff0c\u4f7f\u7528\u4e32\u53e3\u3002 1.3.6 \u8fde\u63a5Micor USB\u7ebf Micro USB\u7ebf\u7684\u529f\u80fd\u662f\u4f9b\u7535\u53ca\u8c03\u8bd5\uff0c\u5c06\u7ebf\u4e00\u5934\u4e0e\u5f00\u53d1\u677f\u7684Micro\u63a5\u53e3\u8fde\u63a5\uff0c\u53e6\u4e00\u5934\u63a5\u5230\u7535\u8111\u7684USB\u53e3\u4e0a\u3002 1.3.7 \u8fde\u63a5ST-Link\u7a0b\u5e8f\u4e0b\u8f7d\u5668 \u628a\u5f00\u53d1\u677f\u5185\u63d0\u4f9b\u7684\u914d\u5957\u4e0b\u8f7d\u7ebf\u63a5\u5728\u5f00\u53d1\u677f\u7684\u7a0b\u5e8f\u4e0b\u8f7d\u63a5\u53e3\uff08SWD\u53e3\uff09\uff0c\u53e6\u4e00\u7aef\u4e0eST-Link\u7a0b\u5e8f\u4e0b\u8f7d\u5668\u5bf9\u5e94\u5f15\u811a\u76f8\u8fde\uff0c\u6ce8\u610f\u8fde\u63a5\u7d27\u5bc6\uff0c\u9632\u6b62\u63a5\u89e6\u4e0d\u826f\uff0c\u7ea2\u8272\u4e3aVCC\uff0c\u4e00\u5b9a\u53c2\u8003\u4e0b\u56fe\u8fdb\u884c\u8fde\u63a5\uff0c\u4e0d\u8981\u63a5\u9519\u3002 2. \u5b9a\u5236\u5f00\u53d1\u677fEVB_WL\u8f6f\u4ef6\u5f00\u53d1\u73af\u5883\u51c6\u5907 2.1 MDK\u8f6f\u4ef6\u4ecb\u7ecd MDK \u5373RealView MDK \u6216MDK-ARM\uff08Microcontroller Development kit\uff09\uff0c\u662f ARM \u516c\u53f8\u6536\u8d2dKeil\u516c\u53f8\u4ee5\u540e\uff0c\u57fa\u4e8euVision\u754c\u9762\u63a8\u51fa\u7684\u9488\u5bf9ARM7\u3001ARM9\u3001Cortex-M0\u3001Cortex-M1\u3001Cortex-M2\u3001Cortex-M3\u3001Cortex-R4\u7b49ARM\u5904\u7406\u5668\u7684\u5d4c\u5165\u5f0f\u8f6f\u4ef6\u5f00\u53d1\u5de5\u5177\u3002MDK-ARM \u96c6\u6210\u4e86\u4e1a\u5185\u6700\u9886\u5148\u7684\u6280\u672f\uff0c\u5305\u62ec uVision4 \u96c6\u6210\u5f00\u53d1\u73af\u5883\u4e0e RealView \u7f16\u8bd1\u5668RVCT\u3002\u652f\u6301 ARM7\u3001ARM9 \u548c\u6700\u65b0\u7684Cortex-M3/M1/M0 \u6838\u5904\u7406\u5668\uff0c\u81ea\u52a8\u914d\u7f6e\u542f\u52a8\u4ee3\u7801\uff0c\u96c6\u6210 Flash \u70e7\u5199\u6a21\u5757\uff0c\u5f3a\u5927\u7684 Simulation \u8bbe\u5907\u6a21\u62df\uff0c\u6027\u80fd\u5206\u6790\u7b49\u529f\u80fd\uff0c\u4e0e ARM \u4e4b\u524d\u7684\u5de5\u5177\u5305 ADS \u7b49\u76f8\u6bd4\uff0cRealView \u7f16\u8bd1\u5668\u7684\u6700\u65b0\u7248\u672c\u53ef\u5c06\u6027\u80fd\u6539\u5584\u8d85\u8fc7 20%\u3002 Keil\u516c\u53f8\u5f00\u53d1\u7684ARM\u5f00\u53d1\u5de5\u5177MDK\uff0c\u662f\u7528\u6765\u5f00\u53d1\u57fa\u4e8eARM\u6838\u7684\u7cfb\u5217\u5fae\u63a7\u5236\u5668\u7684\u5d4c\u5165\u5f0f\u5e94\u7528\u7a0b\u5e8f\u3002\u5b83\u9002\u5408\u4e0d\u540c\u5c42\u6b21\u7684\u5f00\u53d1\u8005\u4f7f\u7528\uff0c\u5305\u62ec\u4e13\u4e1a\u7684\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u5de5\u7a0b\u5e08\u548c\u5d4c\u5165\u5f0f\u8f6f\u4ef6\u5f00\u53d1\u7684\u5165\u95e8\u8005\u3002MDK\u5305\u542b\u4e86\u5de5\u4e1a\u6807\u51c6\u7684Keil C\u7f16\u8bd1\u5668\u3001\u5b8f\u6c47\u7f16\u5668\u3001\u8c03\u8bd5\u5668\u3001\u5b9e\u65f6\u5185\u6838\u7b49\u7ec4\u4ef6\uff0c\u652f\u6301\u6240\u6709\u57fa\u4e8eARM\u7684\u8bbe\u5907\uff0c\u80fd\u5e2e\u52a9\u5de5\u7a0b\u5e08\u6309\u7167\u8ba1\u5212\u5b8c\u6210\u9879\u76ee\u3002 2.2 MDK\u5b89\u88c5 \u767b\u5f55MDK\u5b98\u7f51\uff0c\u4e0b\u8f7dMDK5\u8f6f\u4ef6\uff0c\u4e0b\u8f7d\u5730\u5740\uff1a http://www2.keil.com/mdk5 \u6216\u8005 https://www.keil.com/download/product/ \u4e0b\u8f7d\u7684\u7248\u672c\u6700\u597d\u57285.24\u4ee5\u4e0a\uff0c\u672c\u5f00\u53d1\u6559\u7a0b\u4ee55.24\u7248\u672c\u4e3a\u4f8b\uff0c\u53cc\u51fbMDK524\u5e94\u7528\u7a0b\u5e8f\u6587\u4ef6\uff0c\u70b9\u51fbnext>>\u3002 \u6253\u4e0a I agree\u524d\u9762\u7684\u52fe\u52fe\uff0c\u5373\u662f\u540c\u610f\u4e00\u4e9b\u5b89\u88c5\u534f\u8bae\u3002\u70b9\u51fbnext>>\u3002 \u9009\u62e9\u5b89\u88c5\u8def\u5f84\uff0c\u53ef\u4ee5\u9ed8\u8ba4\u4e5f\u53ef\u4ee5\u5b89\u88c5\u5728\u6211\u4eec\u81ea\u5df1\u5efa\u7acb\u7684\u6587\u4ef6\u5939\u4e0b\u3002\u70b9\u51fbnext>>\u3002 \u8fd9\u91cc\u586b\u5199\u7684\u662f\u6211\u4eec\u7684\u4e00\u4e9b\u4fe1\u606f\uff0c\u586b\u5199\u5b8c\u6574\u540e\uff0c\u7ee7\u7eednext>>\u3002 \u7136\u540e\u7b49\u5f85\u5b89\u88c5\u5b8c\u6210\u5373\u53ef\u3002 \u5b89\u88c5\u5b8c\u6210\uff0c\u70b9\u51fbFinish\u3002 \u7136\u540e\u4f1a\u8df3\u51fa\u6765\u8fd9\u4e2a\u754c\u9762\uff0c\u8fd9\u4e2a\u6211\u4eec\u540e\u9762\u518d\u8bb2\uff0c\u5148\u70b9OK\uff0c\u628a\u5f39\u6846\u90fd\u53c9\u6389\u3002 \u6fc0\u6d3bMDK\uff0c\u5bfc\u5165License,\u6fc0\u6d3bMDK\u540e\u4fbf\u53ef\u4f7f\u7528\u4e86\u3002 \u7279\u522b\u63d0\u793a\uff1a\u4e00\u5b9a\u8981\u8f93\u5165License\u6fc0\u6d3bMDK\u8f6f\u4ef6\uff0c\u5efa\u8bae\u8d2d\u4e70\u6b63\u7248License\u3002 2.3 MDK\u5b89\u88c5 \u5b89\u88c5\u5b8cMDK\u540e\uff0c\u6211\u4eec\u9700\u8981\u5b89\u88c5\u5f00\u53d1\u5957\u4ef6\u4e2d\u5355\u7247\u673a\u578b\u53f7\u5bf9\u5e94\u7684Pack\u3002 \u5b89\u88c5\u65b9\u5f0f\u4e00 \u767b\u5f55\u5b98\u7f51\uff1ahttp://www.keil.com/dd2/pack/ \u4e0b\u8f7dKeil.STM32WLxx_DFP.1.0.0.pack \u540e\u5b89\u88c5\uff0c\u5982\u4e0b\u56fe \u5b89\u88c5\u65b9\u5f0f\u4e8c MDK\u8f6f\u4ef6\u4e0a\u5728\u7ebf\u5b89\u88c5 \u6253\u5f00\u8f6f\u4ef6\uff0c\u5728\u5bfc\u822a\u680f\u6253\u5f00Pack\u5b89\u88c5\u754c\u9762\uff0c\u7136\u540e\u9009\u62e9ok\u9009\u9879\u3002 \u8fdb\u5165\u5728\u7ebf\u5b89\u88c5\u754c\u9762\uff0c\u9009\u7740STM32WLXX Pack,\u70b9\u51fbInstall\u8fdb\u884c\u5b89\u88c5\u3002 \u81f3\u6b64\uff0c\u6211\u4eec\u5f00\u53d1\u677f\u7684\u5355\u7247\u673a\u7a0b\u5e8f\u5f00\u53d1\u73af\u5883\u5df2\u7ecf\u642d\u5efa\u5b8c\u6bd5\uff0c\u91cd\u542fMDK\u8f6f\u4ef6\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002 2.4 ST-Link\u9a71\u52a8\u5b89\u88c5 \u524d\u9762\u8bb2\u4e86\u5f00\u53d1\u677f\u5355\u7247\u673a\u7a0b\u5e8f\u7684\u5f00\u53d1\u73af\u5883\u7684\u642d\u5efa\uff0c\u4f46\u662f\u4e3a\u4e86\u5c06\u7a0b\u5e8f\u70e7\u5f55\u5230\u5f00\u53d1\u677f\u4e2d\u6211\u4eec\u8fd8\u9700\u8981\u4f7f\u7528\u4eff\u771f\u5668\u3002\u6211\u4eec\u8fd9\u5957\u5f00\u53d1\u677f\u9009\u7528ST\u516c\u53f8\u7684ST-Link V2\u4eff\u771f\u5668\u8fdb\u884c\u5f00\u53d1\u677f\u7a0b\u5e8f\u7684\u70e7\u5199\u548c\u4eff\u771f\uff0c\u4e0b\u9762\u4ecb\u7ecdST-Link\u9a71\u52a8\u7684\u5b89\u88c5\u53ca\u73af\u5883\u642d\u5efa\u3002 \u5728ST\u5b98\u7f51\u4e0b\u8f7dST-Link\u9a71\u52a8\uff0c https://www.st.com/content/st_com/zh/products/development-tools/software-development-tools/stm32-software-development-tools/stm32-utilities/stsw-link009.html \uff08\u9a71\u52a8\u67092\u79cd\uff1a 32\u4f4d\u7535\u8111\u7cfb\u7edf\u5b89\u88c5\u201cdpinst_x86\u201d\u300164\u4f4d\u7535\u8111\u7cfb\u7edf\u5b89\u88c5\u201cdpinst_amd64\u201d\uff09\u3002 \u8fd0\u884c\u5bf9\u5e94\u7684\u9a71\u52a8\uff0c\u5b89\u88c5ST-Link V2\u9a71\u52a8\u7a0b\u5e8f\u3002\u5b89\u88c5\u8def\u5f84\u5c3d\u91cf\u4fdd\u6301\u9ed8\u8ba4\u8def\u5f84\u3002 \u5b89\u88c5\u5b8c\u6210\u540e, \u5c06ST-Link\u901a\u8fc7USB\u63a5\u53e3\u8fde\u5165\u7535\u8111\u3002\u6253\u5f00\u201c\u8bbe\u5907\u7ba1\u7406\u5668\u201d\u3002\u82e5\u770b\u5230\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u8868\u793a\u9a71\u52a8\u5b89\u88c5\u6210\u529f\u3002 \u8fd9\u91cc\u63d0\u9192 2 \u70b9: 1\uff0c \u5404\u79cd windows \u7248\u672c\u8bbe\u5907\u540d\u79f0\u548c\u6240\u5728\u8bbe\u5907\u7ba1\u7406\u5668\u680f\u76ee\u53ef\u80fd\u4e0d\u4e00\u6837\uff0c\u4f8b\u5982 WIN10 \u63d2\u4e0aSTLINK \u540e\u663e\u793a\u7684\u662f STM32 STLINK\u3002 2\uff0c \u5982\u679c\u8bbe\u5907\u540d\u79f0\u65c1\u8fb9\u663e\u793a\u7684\u662f\u9ec4\u8272\u7684\u53f9\u53f7\uff0c\u8bf7\u76f4\u63a5\u70b9\u51fb\u8bbe\u5907\u540d\u79f0\uff0c\u7136\u540e\u5728\u5f39\u51fa\u7684\u754c\u9762\u70b9\u51fb\u66f4\u65b0\u8bbe\u5907\u9a71\u52a8 \u81f3\u6b64\uff0c ST-Link \u9a71\u52a8\u5df2\u7ecf\u5b89\u88c5\u5b8c\u6210\u3002\u63a5\u4e0b\u6765\u5927\u5bb6\u53ea\u9700\u8981\u5728 MDK\u5de5\u7a0b\u91cc\u9762\u914d\u7f6e\u4e00\u4e0b ST-Link\u5373\u53ef\u3002 2.5 \u7f16\u7a0b\u8f6f\u4ef6(MDK)\u914d\u7f6e \u5b89\u88c5\u9a71\u52a8\u6210\u529f\u540e\uff0c\u6253\u5f00MDK\u8f6f\u4ef6\uff0c\u914d\u7f6e\u7a0b\u5e8f\u70e7\u5199\u548c\u4eff\u771f\u7684\u73af\u5883\u3002 \u70b9\u51fb\u8fdb\u5165\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\u6309\u7ebd\uff0c\u8fdb\u5165\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\u3002 \u9009\u62e9Debug\u9009\u9879\uff0c\u8fdb\u5165\u4eff\u771f\u5668\u8bbe\u7f6e\u754c\u9762\u3002 \u4e0b\u62c9\u4eff\u771f\u5668\u9009\u62e9\u5217\u8868\uff0c\u9009\u7740ST-Link Debugger\u5e76\u52fe\u9009\u53f3\u4fa7Use,\u70b9\u51fbSettings\u8fdb\u5165ST-Link V2\u4eff\u771f\u5668\u914d\u7f6e\u754c\u9762\u3002 \u5f00\u53d1\u677f\u8bbe\u8ba1\u7684\u7a0b\u5e8f\u70e7\u5f55\u65b9\u5f0f\u4e3aSW\uff0c\u6b64\u5904Unit\u9009\u62e9ST-Link/V2,\u4e14Port\u9009\u62e9SW,\u5e76\u786e\u8ba4\u53f3\u4fa7\u6846\u5185\u662f\u5426\u68c0\u6d4b\u51faSW\u8bbe\u5907\uff0c\u70b9\u51fb<\u786e\u8ba4>\u4fdd\u5b58\u914d\u7f6e\u3002 2.6 CH340\u4e32\u53e3\u9a71\u52a8\u5b89\u88c5 \u4e92\u8054\u7f51\u641c\u7d22\u4e0b\u8f7dCH340 \u4e32\u53e3\u82af\u7247\u7684\u9a71\u52a8 \u5b89\u88c5\u65b9\u6cd5\uff1a\u6253\u5f00\u9a71\u52a8\u5b89\u88c5\u7a0b\u5e8f\u70b9\u51fb\u5b89\u88c5\u5373\u53ef\u3002 \u6ce8\uff1a\u82e5\u5b89\u88c5\u5931\u8d25\uff0c\u8bf7\u5148\u70b9\u51fb\u5378\u8f7d\uff0c\u540e\u70b9\u51fb\u5b89\u88c5\u3002 2.7 \u4e32\u53e3\u8c03\u8bd5\u52a9\u624b\u7684\u5b89\u88c5\u4e0e\u4f7f\u7528 \u5de5\u5177\u4e0b\u8f7d\uff1a http://www.daxia.com/download/sscom.rar \u5b89\u88c5\u65b9\u6cd5\uff1a\u4e32\u53e3\u8c03\u8bd5\u52a9\u624bsscom5.13.1\u662f\u514d\u5b89\u88c5\u7684\uff0c\u89e3\u538b\u51fa\u538b\u7f29\u5305\u5373\u53ef\u76f4\u63a5\u4f7f\u7528\u3002 \u6839\u636ePC\u548c\u7ec8\u7aef\u4e4b\u95f4\u7684\u8fde\u63a5\uff0c\u9009\u62e9\u6b63\u786e\u7684\u4e32\u884c\u7aef\u53e3\u3002 \u6253\u5f00\u7535\u8111\u7684\u8bbe\u5907\u7ba1\u7406\u5668\uff0c\u5728\u7aef\u53e3\u5217\u8868\u53ef\u4ee5\u770b\u5230PC\u4e0e\u5f00\u53d1\u677f\u8fde\u63a5\u7684\u7aef\u53e3\u53f7\u3002 \u6211\u8fd9\u91cc\u663e\u793a\u7684\u662fCOM6\uff0c\u6240\u4ee5\u8981\u5728sscom\u5de5\u5177\u4e2d\u9009\u62e9COM6\uff0c\u5f00\u53d1\u677f\u7a0b\u5e8f\u6ce2\u7279\u7387\u8bbe\u7f6e\u4e3a115200\uff0c\u6240\u4ee5\u6211\u5728sscom\u4e32\u53e3\u5de5\u5177\u4e2d\u9009\u62e9115200\u6ce2\u7279\u7387\u3002 3. \u57fa\u4e8eTencentOS tiny\u7684STM32WL LoRaWAN \u63a5\u5165\u817e\u8baf\u4e91IoT Explorer\u6307\u5f15 \u57fa\u4e8eTencentOS Tiny EVB WL\u8981\u5b8c\u6210\u817e\u8baf\u4e91IoT Explorer\u5bf9\u63a5\uff0c\u9700\u8981\u5b8c\u6210\u4e24\u4e2a\u90e8\u5206\u7684\u5de5\u4f5c\u3002 \u4e00\u662f\uff1a\u817e\u8baf\u4e91IoT explorer \u4e0a\u5b8c\u6210\u9879\u76ee\u3001\u4ea7\u54c1\u3001\u8bbe\u5907\u521b\u5efa\u3001\u53c2\u6570\u914d\u7f6e \u4e8c\u662f\uff1a\u57fa\u4e8eTencentOS Tiny\u5b8c\u6210LoRaWAN\u5e94\u7528\u5f00\u53d1\uff0c\u5411\u817e\u8baf\u4e91\u4e0a\u62a5\u4e1a\u52a1\u6570\u636e\u3002 3.1 \u817e\u8baf\u4e91IoT explorer\u4e0a\u521b\u5efa\u9879\u76ee\u3001\u4ea7\u54c1\u3001\u8bbe\u5907 \u521b\u5efa\u9879\u76ee\u548c\u4ea7\u54c1 \u767b\u5f55 \u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u63a7\u5236\u53f0 \uff0c\u9009\u62e9\u3010\u65b0\u5efa\u9879\u76ee\u3011\u3002 \u5728\u65b0\u5efa\u9879\u76ee\u9875\u9762\uff0c\u586b\u5199\u9879\u76ee\u57fa\u672c\u4fe1\u606f\u540e\uff0c\u5355\u51fb\u3010\u4fdd\u5b58\u3011 \u9879\u76ee\u540d\u79f0\uff1a\u8f93\u5165\u201cLoRa \u6e29\u6e7f\u5ea6\u6f14\u793a\u201d\u6216\u5176\u4ed6\u540d\u79f0\u3002 \u9879\u76ee\u63cf\u8ff0\uff1a\u6309\u7167\u5b9e\u9645\u9700\u6c42\u586b\u5199\u9879\u76ee\u63cf\u8ff0\u3002 \u9879\u76ee\u65b0\u5efa\u6210\u529f\u540e\uff0c\u5373\u53ef\u65b0\u5efa\u4ea7\u54c1\u3002 \u65b0\u5efa\u4ea7\u54c1 \u8fdb\u5165\u8be5\u9879\u76ee\u7684\u4ea7\u54c1\u5217\u8868\u9875\u9762\uff0c\u5355\u51fb\u3010\u65b0\u5efa\u4ea7\u54c1\u3011\u3002 \u5728\u65b0\u5efa\u4ea7\u54c1\u9875\u9762\uff0c\u586b\u5199\u4ea7\u54c1\u57fa\u672c\u4fe1\u606f\u3002 \u4ea7\u54c1\u540d\u79f0\uff1a\u8f93\u5165\u201cLoRa\u6e29\u6e7f\u5ea6\u76d1\u6d4b\u4eea\u201d\u6216\u5176\u4ed6\u4ea7\u54c1\u540d\u79f0\u3002 \u4ea7\u54c1\u7c7b\u578b\uff1a\u9009\u62e9\u201c\u7528\u6237\u81ea\u5b9a\u4e49\u201d\u3002 \u8bbe\u5907\u7c7b\u578b\uff1a\u9009\u62e9\u201c\u8bbe\u5907\u201d\u3002 \u8ba4\u8bc1\u65b9\u5f0f\uff1a\u9009\u62e9\u201c\u5bc6\u94a5\u8ba4\u8bc1\u201d\u3002 \u901a\u4fe1\u65b9\u5f0f\uff1a\u9009\u62e9\u201cLoRaWAN\u201d\u3002 \u6570\u636e\u534f\u8bae\uff1a\u9009\u62e9\u201c\u81ea\u5b9a\u4e49\u900f\u4f20\u201d\u3002 \u4ea7\u54c1\u65b0\u5efa\u6210\u529f\u540e\uff0c\u60a8\u53ef\u5728\u4ea7\u54c1\u5217\u8868\u9875\u67e5\u770b\u201cLoRa\u6e29\u6e7f\u5ea6\u76d1\u6d4b\u4eea\u201d\u3002 \u521b\u5efa\u6570\u636e\u6a21\u677f \u5355\u51fb\u4ea7\u54c1\u540d\u79f0\uff0c\u8fdb\u5165\u4ea7\u54c1\u914d\u7f6e\u9875\uff0c\u5728\u3010\u81ea\u5b9a\u4e49\u529f\u80fd\u3011\u914d\u7f6e\u9879\u4e0b\uff0c\u5355\u51fb\u3010\u65b0\u5efa\u529f\u80fd\u3011\uff0c\u81ea\u5b9a\u4e49\u4ea7\u54c1\u529f\u80fd\u3002 \u8fd9\u91cc\u6211\u4eec\u5c31\u4e0d\u4e00\u4e00\u5b9a\u4e49\u6570\u636e\u6a21\u677f\u4e86\uff0c\u76f4\u63a5\u5bfc\u5165\u4e0b\u9762\u7684json\u4ee3\u7801: { \"version\": \"1.0\", \"profile\": { \"ProductId\": \"F2G256SY2G\", \"CategoryId\": \"1\" }, \"properties\": [ { \"id\": \"temperature\", \"name\": \"\u6e29\u5ea6\", \"desc\": \"\", \"mode\": \"r\", \"define\": { \"type\": \"int\", \"min\": \"-100\", \"max\": \"155\", \"start\": \"0\", \"step\": \"1\", \"unit\": \"\u6444\u6c0f\u5ea6\" }, \"required\": false }, { \"id\": \"humidity\", \"name\": \"\u6e7f\u5ea6\", \"desc\": \"\", \"mode\": \"rw\", \"define\": { \"type\": \"int\", \"min\": \"0\", \"max\": \"100\", \"start\": \"0\", \"step\": \"1\", \"unit\": \"%\" }, \"required\": false }, { \"id\": \"period\", \"name\": \"\u4e0a\u62a5\u5468\u671f\", \"desc\": \"\", \"mode\": \"rw\", \"define\": { \"type\": \"int\", \"min\": \"0\", \"max\": \"3600\", \"start\": \"0\", \"step\": \"1\", \"unit\": \"\u79d2\" }, \"required\": false } ], \"events\": [], \"actions\": [] } \u5bfc\u5165\u5b8c\u6210\u540e\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u914d\u7f6e LoRaWAN \u53c2\u6570 \u5728\u8bbe\u5907\u5f00\u53d1\u9875\u9762\u4e2d\uff0c\u6309\u9700\u8c03\u6574 LoRaWAN \u53c2\u6570\u914d\u7f6e\u3002\u672c\u793a\u4f8b\u4e2d\u4f7f\u7528\u9ed8\u8ba4\u7684 OTAA \u914d\u7f6e\u3002 \u8bbe\u5907\u6570\u636e\u89e3\u6790 \u5728\u8bbe\u5907\u5f00\u53d1\u9875\u9762\u4e2d\uff0c\u6309\u9700\u8c03\u6574\u8bbe\u5907\u6570\u636e\u89e3\u6790\u3002\u7531\u4e8e LoRa \u7c7b\u8d44\u6e90\u6709\u9650\u8bbe\u5907\u4e0d\u9002\u5408\u76f4\u63a5\u4f20\u8f93 JSON \u683c\u5f0f\u6570\u636e\uff0c\u4f7f\u7528\u201c\u8bbe\u5907\u6570\u636e\u89e3\u6790\u201d\u53ef\u4ee5\u5c06\u8bbe\u5907\u539f\u59cb\u6570\u636e\u8f6c\u5316\u4e3a\u4ea7\u54c1 JSON \u6570\u636e\u3002 \u8bbe\u5907\u6570\u636e\u534f\u8bae \u5728\u672c\u793a\u4f8b\u4e2d\uff0c\u8bbe\u5907\u4e0a\u884c\u6570\u636e\u5171\u67093\u4e2a\uff0c\u5305\u62ec\u6e29\u5ea6\u3001\u6e7f\u5ea6\u3001\u4e0a\u62a5\u5468\u671f3\u4e2a\u5c5e\u6027\u6570\u636e \u6570\u636e\u89e3\u6790\u811a\u672c \u4e0a\u884c\u6570\u636e\u89e3\u6790\u7684\u811a\u672c\u4e3b\u51fd\u6570\u4e3a RawToProtocol\uff0c\u5176\u5e26\u6709 fPort\u3001bytes \u4e24\u4e2a\u5165\u53c2\uff1a - fPort\uff1a\u8bbe\u5907\u4e0a\u62a5\u7684 LoRaWAN \u534f\u8bae\u6570\u636e\u7684 FPort \u5b57\u6bb5\u3002 - bytes\uff1a\u8bbe\u5907\u4e0a\u62a5\u7684 LoRaWAN \u534f\u8bae\u6570\u636e\u7684 FRMPayload \u5b57\u6bb5\u3002 \u811a\u672c\u4e3b\u51fd\u6570\u7684\u51fa\u53c2\u4e3a\u4ea7\u54c1\u6570\u636e\u6a21\u7248\u534f\u8bae\u683c\u5f0f\u7684\u5bf9\u8c61\u3002 \u5728\u4e0a\u884c\u6570\u636e\u89e3\u6790\u90e8\u5206\uff0cjavascript \u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a function RawToProtocol(fPort, bytes) { var data = { \"method\": \"report\", \"clientToken\" : new Date(), \"params\" : {} }; data.params.temperature = bytes[0]; data.params.humidity = bytes[1]; data.params.period = bytes[2] | (bytes[3] << 8); return data; } \u4e0b\u884c\u6570\u636e\u89e3\u6790\u7684\u811a\u672c\u4e3b\u51fd\u6570\u4e3a ProtocolToRaw\uff0c\u5176\u5165\u53c2\u4e3a\u4ea7\u54c1\u6570\u636e\u6a21\u7248\u534f\u8bae\u683c\u5f0f\u7684\u5bf9\u8c61\u3002 \u5728\u4e0b\u884c\u6570\u636e\u89e3\u6790\u90e8\u5206\uff0cjavascript \u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a function ProtocolToRaw(obj) { var data = new Array(); data[0] = 5;// fport=5 data[1] = 0;// unconfirmed mode data[2] = obj.params.period & 0x00FF; data[3] = (obj.params.period >> 8) & 0x00FF; return data; } \u521b\u5efa\u6d4b\u8bd5\u8bbe\u5907 \u5728\u8bbe\u5907\u8c03\u8bd5\u9875\u9762\u4e2d\uff0c\u5355\u51fb\u3010\u65b0\u5efa\u8bbe\u5907\u3011\uff0c\u8bbe\u5907\u540d\u4e3a WL_DEV_001\u3002 DevEUI\u3001APPKEY\u7b49\u4fe1\u606f\u53ef\u4ece WL \u5f00\u53d1\u677f \u7ec8\u7aef\u8bbe\u5907\u83b7\u53d6\u6216\u8005\u8bbe\u7f6e\uff0c\u4e91\u5e73\u53f0\u548c\u7ec8\u7aef\u8981\u4fdd\u6301\u4e00\u81f4\u3002 \u67e5\u770b\u8bbe\u5907\u72b6\u6001 \u4fdd\u6301 LoRa \u8282\u70b9\u548c LoRa \u7f51\u5173 \u4e3a\u8fd0\u884c\u72b6\u6001\u3002 \u8fdb\u5165\u3010\u63a7\u5236\u53f0\u3011>\u3010\u4ea7\u54c1\u5f00\u53d1\u3011>\u3010\u8bbe\u5907\u8c03\u8bd5\u3011\uff0c\u53ef\u67e5\u770b\u5230\u8bbe\u5907 \"WL_DEV_001\" \u3002 \u5355\u51fb\u3010\u8c03\u8bd5\u3011\uff0c\u53ef\u8fdb\u5165\u8bbe\u5907\u8be6\u60c5\u9875\u3002 \u5355\u51fb\u3010\u8bbe\u5907\u5c5e\u6027\u3011\uff0c\u53ef\u67e5\u8be2\u8bbe\u5907\u4e0a\u62a5\u5230\u5f00\u53d1\u5e73\u53f0\u7684\u6700\u65b0\u6570\u636e\u53ca\u5386\u53f2\u6570\u636e\u3002 \u8bbe\u5907\u5c5e\u6027\u7684\u6700\u65b0\u503c\uff1a\u4f1a\u663e\u793a\u8bbe\u5907\u4e0a\u62a5\u7684\u6700\u65b0\u6570\u636e\u3002 \u8bbe\u5907\u5c5e\u6027\u7684\u66f4\u65b0\u65f6\u95f4\uff1a\u663e\u793a\u6570\u636e\u7684\u66f4\u65b0\u65f6\u95f4\u3002 \u5355\u51fb\u3010\u67e5\u770b\u3011\uff0c\u53ef\u67e5\u770b\u67d0\u4e2a\u5c5e\u6027\u7684\u5386\u53f2\u4e0a\u62a5\u6570\u636e\u3002 \u67e5\u770b\u8bbe\u5907\u901a\u4fe1\u65e5\u5fd7 \u5355\u51fb\u3010\u8bbe\u5907\u65e5\u5fd7\u3011\uff0c\u53ef\u67e5\u8be2\u8be5\u8bbe\u5907\u67d0\u6bb5\u65f6\u95f4\u8303\u56f4\u7684\u6240\u6709\u4e0a\u4e0b\u884c\u6570\u636e\u3002 - \u4e0a\u884c\uff1a\u4e0a\u884c\u6307\u8bbe\u5907\u7aef\u4e0a\u62a5\u5230\u5f00\u53d1\u5e73\u53f0\u7684\u6570\u636e\u3002 - \u4e0b\u884c\uff1a\u4e0b\u884c\u6307\u4ece\u5f00\u53d1\u5e73\u53f0\u4e0b\u53d1\u5230\u8bbe\u5907\u7684\u6570\u636e\u3002 3.2 \u57fa\u4e8eTencentOS Tiny EVB_WL\u5f00\u53d1\u677f\u5b8c\u6210LoRaWAN\u5e94\u7528\u5f00\u53d1 \u4e0b\u8f7d\u6e90\u7801 TencentOS tiny\u5b98\u65b9\u5f00\u6e90\u4ed3\u4e0b\u8f7d\u6e90\u7801\uff0c\u5730\u5740\u4e3a\uff1a https://github.com/Tencent/TencentOS-tiny \u8fdb\u5165 < TencentOS-tiny\\board\\RHF0M0E5_STM32WLE5xx\\KEIL\\lorawan> \u76ee\u5f55\uff0c\u6253\u5f00TencentOS_tiny.uvprojx\u5de5\u7a0b\uff1a \u7f16\u8bd1lorawan\u5de5\u7a0b \u6253\u5f00\u5de5\u7a0b\u540e\uff0c\u6211\u4eec\u5728\u5de6\u4fa7\u7684\u5de5\u7a0b\u6587\u4ef6\u5bfc\u822a\u9875\u9762\u53ef\u4ee5\u770b\u5230WL\u7684LoRaWAN\u76f8\u5173\u6e90\u7801\uff0c\u8fd9\u91cc\u521b\u5efa\u4e86\u4e24\u4e2aTencentOS tiny\u7684\u4efb\u52a1\uff0c\u4e00\u4e2a\u8d1f\u8d23\u5904\u7406LoRaWAN MAC\u5c42\u534f\u8bae\uff0c\u4e00\u4e2a\u5904\u7406\u4e1a\u52a1\u3002\u5f00\u53d1\u8005\u5728\u7f16\u8bd1\u524d\u9700\u8981\u914d\u7f6e\u8bbe\u5907\u76f8\u5173\u4fe1\u606f\u3002 \u6253\u5f00commissioning.h\u5934\u6587\u4ef6\uff0c\u5728\u6587\u4ef6\u4e2d\u8f93\u5165\u4e0e\u524d\u6587IoT Explorer\u5e73\u53f0\u5bf9\u5e94\u7684device EUI\u548cAPP KEY\uff0c\u6309\u5982\u4e0b\u56fe\u6240\u793a\u7684\u683c\u5f0f\uff1a \u57fa\u4e8eTencentOS Tiny\u7684WL\u5f00\u53d1\u677f\u7684\u4e1a\u52a1\u6d41\u7a0b\u5982\u4e0b\uff1a 1. main\u51fd\u6570\u4e2d\u5b8c\u6210 \u677f\u7ea7\u521d\u59cb\u5316\uff0c\u4e3b\u8981\u662f board_init\u51fd\u6570\u4e2d\u521d\u59cb\u5316\u597d\u57fa\u7840\u5916\u8bbe\u548cLoRa\u5c04\u9891\u53caLoRa\u534f\u8bae\u6808\uff1b\u5176\u4e2dMX_LoRaWAN_Init\u51fd\u6570\u4f1a\u5b8c\u6210LoRaWAN\u534f\u8bae\u7684\u57fa\u7840\u914d\u7f6e\uff0c\u6bd4\u5982\u9009\u62e9CLASS\u3001\u914d\u7f6e\u901a\u9053\u3001\u914d\u7f6eADR\u7b49\uff1b 2. main\u51fd\u6570\u4e2d\uff0c\u5b8c\u6210\u5185\u6838\u521d\u59cb\u5316\u3001\u521b\u5efa\u4e3b\u7ebf\u7a0b\u5165\u53e3application_entry\uff0c\u542f\u52a8\u5185\u6838\uff1b 3. application_entry\u51fd\u6570\u4e2d\u518d\u521b\u5efalora_mac_process_task\uff1b 4. application_entry\u51fd\u6570\u4e2d\u8c03\u7528lw_send\u51fd\u6570\u5411LoRa\u7f51\u5173\u548c\u4e91\u7aef\u4e0a\u62a5\u7ec8\u7aef\u6570\u636e\u3002\u793a\u4f8b\u4e2d\u662f\u6a21\u62df\u4e863\u4e2a\u5143\u6570\u636e\u53d1\u9001\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u4fee\u6539\u53d1\u9001\u81ea\u5df1\u60f3\u53d1\u9001\u7684\u6570\u636e\uff0c\u914d\u5408\u817e\u8baf\u4e91IoT\u5e73\u53f0\u8bbe\u8ba1\u597d\u5bf9\u5e94\u7684\u6570\u636e\u6a21\u677f\u5373\u53ef\u3002 \u4fee\u6539\u8bbe\u5907\u4fe1\u606f\u540e\uff0c\u5f00\u53d1\u8005\u6309\u7167\u4e0b\u56fe\u6307\u793a\uff0c\u70b9\u51fb\u7f16\u8bd1\u6309\u94ae\u5373\u53ef\u7f16\u8bd1\u5de5\u7a0b\uff0c\u5982\u56fe\uff1a \u4e0b\u8f7d\u8fd0\u884c \u9996\u5148\u9700\u8981\u914d\u7f6e\u4e0b\u8f7d\u73af\u5883 \u6309\u4e0b\u56fe\u6240\u793a\u914d\u7f6e\u4e0b\u8f7d\u53c2\u6570 \u7f16\u8bd1\u5b8c\u6210\u540e\u70b9\u51fb\u5982\u56fe\u6240\u793a\u201dLOAD\u201d\u6309\u94ae\u4e0b\u8f7d\u7a0b\u5e8f\u5373\u53ef\u3002 \u5982\u679c\u51fa\u73b0\u65e0\u6cd5\u4e0b\u8f7d\u95ee\u9898\uff0c\u5219\u82af\u7247\u5904\u4e8e\u5199\u4fdd\u62a4\u72b6\u6001\uff0c\u8bf7\u67e5\u770b\u672c\u6587\u7b2c 4 \u5c0f\u8282\u7684\u5185\u5bb9\uff0c\u53bb\u9664\u5199\u4fdd\u62a4\u3002 \u67e5\u770b\u8fd0\u884c\u7ed3\u679c \u8fde\u63a5\u597d\u4e32\u53e3\uff0c\u5728PC\u7684\u4e32\u53e3\u52a9\u624b\u4e2d\u53ef\u4ee5\u770b\u5230TencentOS Tiny EVB_WL\u5f00\u53d1\u677f\u6253\u5370LoRa\u4e1a\u52a1\u8fd0\u884c\u7684\u76f8\u5173\u65e5\u5fd7\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u540c\u65f6\u9700\u8981\u67e5\u8be2\u817e\u8baf\u4e91IoT Explore\u4e0a\u7684\u8bbe\u5907\u72b6\u6001\u548c\u4e0a\u62a5\u7684\u6570\u636e\u9879\uff0c\u5982\u56fe\u6240\u793a\uff1a 4. \u53bb\u9664\u82af\u7247\u5199\u4fdd\u62a4 4.1. \u4f7f\u7528ST-Link\u8fde\u63a5\u5f00\u53d1\u677f \u786e\u4fddST-Link\u4e0e\u5f00\u53d1\u677f\u6b63\u5e38\u8fde\u63a5\uff0c\u5e76\u4e14\u5728 MDK \u4e2d\u53ef\u4ee5\u6b63\u5e38\u8bfb\u53d6\u5230\u4fe1\u606f\uff0c\u5982\u56fe\uff1a 4.2. \u4f7f\u7528STM32CubeProg\u89e3\u9501 \u5173\u95edMDK\uff0c\u6253\u5f00STM32CubeProg\u8f6f\u4ef6\uff0c\u70b9\u51fb\u53f3\u4e0a\u89d2\u7684 Connect\uff0c\u8fde\u63a5\u6210\u529f\u540e\u663e\u793aConnected\uff1a \u70b9\u51fb\u9009\u62e9 OB \u56fe\u6807\u6309\u94ae\uff0c\u6309\u7167\u56fe\u4e2d\u6d41\u7a0b\u8fdb\u884c\u89e3\u9501\uff1a \u6210\u529f\u4e4b\u540e\u70b9\u51fb dicconnnect \u65ad\u5f00\u8fde\u63a5\uff1a \u82af\u7247\u89e3\u9501\u6210\u529f\uff0c\u6b64\u65f6\u5373\u53ef\u4f7f\u7528MDK\u6b63\u5e38\u4e0b\u8f7d\u3002 \u5199\u5728\u7ed3\u5c3e\u7684\u8bdd\uff1a\u611f\u8c22\u5927\u5bb6\u4f7f\u7528TencentOS Tiny\uff0c\u672c\u6587\u96be\u514d\u6709\u63cf\u8ff0\u4e0d\u6e05\u6670\u7684\u5730\u65b9\uff0c\u5982\u679c\u6709\u4efb\u4f55\u95ee\u9898\uff0c\u6b22\u8fce\u52a0\u5165TencentOS Tiny \u7684\u5b98\u7f51QQ\u6280\u672f\u7fa4\u8fdb\u884c\u4ea4\u6d41\uff0c\u57fa\u4e8eTencentOS Tiny\u76f8\u5173\u7684\u9879\u76ee\u5408\u4f5c\u8bf7\u90ae\u4ef6\u8054\u7cfb supowang@tencent.com","title":"26.TencentOS_tiny_EVB_WL_Quick_Start"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#tencentos-tinyevb_wl","text":"Revision Date Description 1.0 2020-7-28 \u6587\u6863\u521d\u7248 1.1 2020-9-6 \u6dfb\u52a0\u82af\u7247\u89e3\u9501\u7ae0\u8282","title":"TencentOS tiny\u5b9a\u5236\u5f00\u53d1\u677fEVB_WL\u5feb\u901f\u5165\u95e8\u6307\u5357"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#1-evb_wl","text":"","title":"1. \u5b9a\u5236\u5f00\u53d1\u677fEVB_WL\u786c\u4ef6\u7b80\u4ecb"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#11","text":"EVB_WL\u662f\u817e\u8baf\u7269\u8054\u7f51\u64cd\u4f5c\u7cfb\u7edfTencentOS tiny \u56e2\u961f\u8054\u5408\u610f\u6cd5\u534a\u5bfc\u4f53\u3001\u745e\u5174\u6052\u65b9\u3001\u667a\u82af\u4e91\u6280\u672f\u8bbe\u8ba1\u7684\u4e00\u6b3eloRaWAN OpenCPU\u8bc4\u4f30\u677f\uff0c\u7528\u4e8eTencentOS tiny \u57fa\u7840\u5185\u6838\u548cLoRaWAN\u7269\u8054\u7f51\u7ec4\u4ef6\u529f\u80fd\u4f53\u9a8c\u548c\u8bc4\u4f30\u3002 \u5f00\u53d1\u677f\u529f\u80fd\u56fe\u5982\u4e0b\u6240\u793a\uff1a","title":"1.1 \u5f00\u53d1\u677f\u7b80\u4ecb"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#12","text":"CPU \uff1a\u4f7f\u7528\u745e\u5174\u6052\u65b9\u7684RHF0M0E5\u6a21\u7ec4\uff0c\u6a21\u7ec4\u5185\u90e8\u96c6\u6210\u610f\u6cd5\u534a\u5bfc\u4f53STM32WLE5\u82af\u7247\uff0c\u5355\u82af\u7247\u96c6\u6210ARM\u00ae Cortex\u00ae-M4 48MHz\u5185\u6838\u548cSX126x IP\uff1b\u91c7\u7528LoRa\u00ae\u6269\u9891\u8c03\u5236\u6280\u672f\uff0cLoRa\u00ae\u63a5\u6536\u7075\u654f\u5ea6\u9ad8\u8fbe-148dBm\uff0c\u901a\u4fe1\u8ddd\u79bb\u8fbe1KM\uff5e10KM\uff1b\u5185\u7f6e\u9ad8\u6548\u7387PA\uff0c\u529f\u8017\u66f4\u4f4e\uff0c\u6700\u5927\u652f\u6301+22dBm\u8f93\u51fa\uff0c\u5e76\u57280-22dBm\u8303\u56f4\u5185\u53ef\u914d\u7f6e\u3002 \u7535\u6e90\u7279\u6027 \uff1aMicro USB\u63a5\u53e3\uff0c5V\u4f9b\u7535\uff0c\u5185\u90e8\u67095V\u8f6c3.3V\u7684DCDC\uff0cMCU\u4f9b\u7535\u7535\u538b\u4e3a3.3V\uff0c\u7cfb\u7edfIO\u7535\u538b\u4e5f\u4e3a3.3V \u6309\u952e \uff1a\u4e00\u4e2a\u590d\u4f4d\u6309\u952e LED\u6307\u793a\u706f \uff1a\u4e0a\u7535\u6307\u793a LED\uff0c\u7ea2\u8272\uff1b \u8c03\u8bd5\u63a5\u53e3 \uff1aSWD\u5916\u63a5ST-Link\uff0cUART1\u4e32\u53e3\u8fde\u63a5PC/LUART\u4e32\u53e3 \u4f20\u611f\u5668\u6269\u5c55\u63a5\u53e3E53 Interface \uff1a\u652f\u6301E53\u4f20\u611f\u5668\u6848\u4f8b\u6269\u5c55\u677f\uff08\u652f\u6301UART\u3001SPI\u3001IIC\u3001GPIO\u3001ADC\u3001DAC\u7b49\uff09 \u64cd\u4f5c\u7cfb\u7edf\u652f\u6301 \uff1aTencentOS tiny","title":"1.2 \u5f00\u53d1\u677f\u7279\u6027"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#13","text":"","title":"1.3 \u5f00\u53d1\u677f\u786c\u4ef6\u8be6\u89e3"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#131","text":"Micro USB \u63d0\u4f9b5V\u7535\u6e90\uff0c\u7531\u4e8eMCU\u4f9b\u7535\u7535\u538b\u662f3.3V\uff0c\u6240\u4ee5\u8fd9\u91cc\u91c7\u7528AMS1117\u8fdb\u884cDC-DC\u7535\u538b\u8f6c\u6362\uff0c\u8f93\u51fa\u8c03\u8282\u81f33.3V\uff0c\u8ba9\u5f00\u53d1\u677f\u6b63\u5e38\u5de5\u4f5c\u3002","title":"1.3.1 \u7535\u6e90\u7535\u8def"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#132-cpu","text":"\u5355\u7247\u673a\u6700\u5c0f\u7cfb\u7edf\u6216\u8005\u53eb\u6700\u5c0f\u786c\u4ef6\u5355\u5143\u7535\u8def\uff0c\u6307\u7528\u6700\u5c11\u5143\u5668\u4ef6\u7ec4\u6210\u7684\u5355\u7247\u673a\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u7684\u7cfb\u7edf\u3002\u6700\u5c0f\u7cfb\u7edf\u57fa\u672c\u7531\u7535\u6e90\u3001\u5355\u7247\u673a\u3001\u6676\u632f\u3001\u590d\u4f4d\u7535\u8def\u3001\u7a0b\u5e8f\u70e7\u5f55\u63a5\u53e3\u7ec4\u6210\uff0c\u7535\u6e90\u4f7f\u75283.3V\u76f4\u63a5\u4f9b\u7535\uff0c\u4f46\u662fEVB_WL\u7684\u6676\u632f\u7535\u8def\u5c01\u88c5\u5728\u745e\u5174\u6052\u65b9\u6a21\u7ec4\u5185\u90e8\u4e86\uff0c\u6240\u4ee5\u8fd9\u91cc\u53ea\u80fd\u770b\u5230\u6a21\u7ec4\u5f15\u811a\u8fde\u63a5\u548c\u590d\u4f4d\u7535\u8def\uff0c\u539f\u7406\u56fe\u5982\u4e0b\uff1a","title":"1.3.2  CPU\u6700\u5c0f\u7cfb\u7edf\u7535\u8def"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#133-usb","text":"USB\u7535\u5e73\u8f6c\u6362\u7535\u8def\u662f\u7528\u4e8eMCU\u548cPC\u901a\u4fe1\u7684\u573a\u666f\u4e2d\u3002PC\u673a\u4e0a\u7684\u901a\u4fe1\u63a5\u53e3\u4f7f\u7528USB\u63a5\u53e3\uff0c\u76f8\u5e94\u7684\u7535\u5e73\u903b\u8f91\u9700\u8981\u9075\u7167USB\u7535\u5e73\u89c4\u5219\uff0c\u800cMCU\u7684\u4e32\u884c\u901a\u4fe1\u63a5\u53e3\u662f\u4e32\u53e3\uff0c\u76f8\u5e94\u7535\u5e73\u9700\u8981\u9075\u5faaTTL\u539f\u5219\u3002\u4e3a\u4e86\u4f7f\u4e24\u8005\u53ef\u4ee5\u4e92\u76f8\u901a\u4fe1\uff0c\u5c31\u9700\u8981\u4e00\u4e2a\u7535\u5e73\u8f6c\u6362\u5668\uff0cEVB_WL\u4e0a\u4f7f\u7528\u4e86CH340\u82af\u7247\u4f5c\u4e3a\u8f6c\u6362\u5668\uff0cCH340\u5916\u56f4\u53ea\u9700\u8981\u63a5\u5f88\u5c11\u7684\u5143\u5668\u4ef6\u5373\u53ef\u4ee5\u5b9e\u73b0USB\u603b\u7ebf\u8f6c\u63a5\uff0c\u4f7f\u7528\u975e\u5e38\u65b9\u4fbf\u4e5f\u5e7f\u6cdb\u8fd0\u7528\u5728USB\u8f6cTTL\u5de5\u5177\u4e0a\uff0c\u7535\u8def\u5982\u4e0b\uff1a","title":"1.3.3  USB\u7535\u5e73\u8f6c\u6362\u7535\u8def"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#134-e53","text":"\u5f00\u53d1\u677f\u8bbe\u8ba1\u6709E53\u63a5\u53e3\u7684\u4f20\u611f\u5668\u6269\u5c55\u677f\u63a5\u53e3\uff0c\u8be5\u63a5\u53e3\u53ef\u517c\u5bb9\u6240\u6709E53\u63a5\u53e3\u7684\u4f20\u611f\u5668\u6269\u5c55\u677f\uff0c\u5b9e\u73b0\u4e0d\u540c\u7269\u8054\u7f51\u6848\u4f8b\u573a\u666f\u7684\u5feb\u901f\u642d\u5efa\u3002\u8be5\u63a5\u53e3\u53ef\u63a5\u5165UART\u3001SPI\u3001I2C\u3001ADC\u7b49\u901a\u4fe1\u534f\u8bae\u7684\u4f20\u611f\u5668\uff0c\u5176\u539f\u7406\u56fe\u5982\u4e0b\u56fe\u6240\u793a\u3002 \u4f20\u611f\u5668\u6269\u5c55\u677f\u6709E53_SC1\u667a\u6167\u57ce\u5e02\u706f\u5149\u6a21\u5757\u3001E53_SF1\u667a\u6167\u6d88\u9632\u70df\u611f\u6a21\u5757\u3001E53_IA1\u667a\u6167\u519c\u4e1a\u6a21\u5757\u7b49\uff0c\u5982\u9700\u8981\u66f4\u591a\u4f20\u611f\u6269\u5c55\u677f\u53ef\u81ea\u884c\u627e\u5408\u4f5c\u4f9b\u5e94\u5546\uff08\u7269\u8054\u7f51\u4ff1\u4e50\u90e8\uff09\u8d2d\u4e70\uff09\u3002 \u5982\u4e0b\u56fe\uff1a","title":"1.3.4 E53 \u4f20\u611f\u5668\u6269\u5c55\u63a5\u53e3"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#135","text":"\u5f00\u53d1\u677f\u9884\u7559\u4e86SWD\u7a0b\u5e8f\u4e0b\u8f7d\u8c03\u8bd5\u53e3\uff0c\u8fd8\u6709UART1\u548c\u4f4e\u529f\u8017\u4e32\u53e3LP_UART\uff0c\u65b9\u4fbf\u7528\u6237\u4e0b\u8f7d\u8c03\u8bd5\u7a0b\u5e8f\uff0c\u4f7f\u7528\u4e32\u53e3\u3002","title":"1.3.5 \u5f00\u53d1\u677f\u8c03\u8bd5\u70e7\u5f55\u53e3"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#136-micor-usb","text":"Micro USB\u7ebf\u7684\u529f\u80fd\u662f\u4f9b\u7535\u53ca\u8c03\u8bd5\uff0c\u5c06\u7ebf\u4e00\u5934\u4e0e\u5f00\u53d1\u677f\u7684Micro\u63a5\u53e3\u8fde\u63a5\uff0c\u53e6\u4e00\u5934\u63a5\u5230\u7535\u8111\u7684USB\u53e3\u4e0a\u3002","title":"1.3.6  \u8fde\u63a5Micor USB\u7ebf"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#137-st-link","text":"\u628a\u5f00\u53d1\u677f\u5185\u63d0\u4f9b\u7684\u914d\u5957\u4e0b\u8f7d\u7ebf\u63a5\u5728\u5f00\u53d1\u677f\u7684\u7a0b\u5e8f\u4e0b\u8f7d\u63a5\u53e3\uff08SWD\u53e3\uff09\uff0c\u53e6\u4e00\u7aef\u4e0eST-Link\u7a0b\u5e8f\u4e0b\u8f7d\u5668\u5bf9\u5e94\u5f15\u811a\u76f8\u8fde\uff0c\u6ce8\u610f\u8fde\u63a5\u7d27\u5bc6\uff0c\u9632\u6b62\u63a5\u89e6\u4e0d\u826f\uff0c\u7ea2\u8272\u4e3aVCC\uff0c\u4e00\u5b9a\u53c2\u8003\u4e0b\u56fe\u8fdb\u884c\u8fde\u63a5\uff0c\u4e0d\u8981\u63a5\u9519\u3002","title":"1.3.7  \u8fde\u63a5ST-Link\u7a0b\u5e8f\u4e0b\u8f7d\u5668"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#2-evb_wl","text":"","title":"2. \u5b9a\u5236\u5f00\u53d1\u677fEVB_WL\u8f6f\u4ef6\u5f00\u53d1\u73af\u5883\u51c6\u5907"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#21-mdk","text":"MDK \u5373RealView MDK \u6216MDK-ARM\uff08Microcontroller Development kit\uff09\uff0c\u662f ARM \u516c\u53f8\u6536\u8d2dKeil\u516c\u53f8\u4ee5\u540e\uff0c\u57fa\u4e8euVision\u754c\u9762\u63a8\u51fa\u7684\u9488\u5bf9ARM7\u3001ARM9\u3001Cortex-M0\u3001Cortex-M1\u3001Cortex-M2\u3001Cortex-M3\u3001Cortex-R4\u7b49ARM\u5904\u7406\u5668\u7684\u5d4c\u5165\u5f0f\u8f6f\u4ef6\u5f00\u53d1\u5de5\u5177\u3002MDK-ARM \u96c6\u6210\u4e86\u4e1a\u5185\u6700\u9886\u5148\u7684\u6280\u672f\uff0c\u5305\u62ec uVision4 \u96c6\u6210\u5f00\u53d1\u73af\u5883\u4e0e RealView \u7f16\u8bd1\u5668RVCT\u3002\u652f\u6301 ARM7\u3001ARM9 \u548c\u6700\u65b0\u7684Cortex-M3/M1/M0 \u6838\u5904\u7406\u5668\uff0c\u81ea\u52a8\u914d\u7f6e\u542f\u52a8\u4ee3\u7801\uff0c\u96c6\u6210 Flash \u70e7\u5199\u6a21\u5757\uff0c\u5f3a\u5927\u7684 Simulation \u8bbe\u5907\u6a21\u62df\uff0c\u6027\u80fd\u5206\u6790\u7b49\u529f\u80fd\uff0c\u4e0e ARM \u4e4b\u524d\u7684\u5de5\u5177\u5305 ADS \u7b49\u76f8\u6bd4\uff0cRealView \u7f16\u8bd1\u5668\u7684\u6700\u65b0\u7248\u672c\u53ef\u5c06\u6027\u80fd\u6539\u5584\u8d85\u8fc7 20%\u3002 Keil\u516c\u53f8\u5f00\u53d1\u7684ARM\u5f00\u53d1\u5de5\u5177MDK\uff0c\u662f\u7528\u6765\u5f00\u53d1\u57fa\u4e8eARM\u6838\u7684\u7cfb\u5217\u5fae\u63a7\u5236\u5668\u7684\u5d4c\u5165\u5f0f\u5e94\u7528\u7a0b\u5e8f\u3002\u5b83\u9002\u5408\u4e0d\u540c\u5c42\u6b21\u7684\u5f00\u53d1\u8005\u4f7f\u7528\uff0c\u5305\u62ec\u4e13\u4e1a\u7684\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u5de5\u7a0b\u5e08\u548c\u5d4c\u5165\u5f0f\u8f6f\u4ef6\u5f00\u53d1\u7684\u5165\u95e8\u8005\u3002MDK\u5305\u542b\u4e86\u5de5\u4e1a\u6807\u51c6\u7684Keil C\u7f16\u8bd1\u5668\u3001\u5b8f\u6c47\u7f16\u5668\u3001\u8c03\u8bd5\u5668\u3001\u5b9e\u65f6\u5185\u6838\u7b49\u7ec4\u4ef6\uff0c\u652f\u6301\u6240\u6709\u57fa\u4e8eARM\u7684\u8bbe\u5907\uff0c\u80fd\u5e2e\u52a9\u5de5\u7a0b\u5e08\u6309\u7167\u8ba1\u5212\u5b8c\u6210\u9879\u76ee\u3002","title":"2.1 MDK\u8f6f\u4ef6\u4ecb\u7ecd"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#22-mdk","text":"\u767b\u5f55MDK\u5b98\u7f51\uff0c\u4e0b\u8f7dMDK5\u8f6f\u4ef6\uff0c\u4e0b\u8f7d\u5730\u5740\uff1a http://www2.keil.com/mdk5 \u6216\u8005 https://www.keil.com/download/product/ \u4e0b\u8f7d\u7684\u7248\u672c\u6700\u597d\u57285.24\u4ee5\u4e0a\uff0c\u672c\u5f00\u53d1\u6559\u7a0b\u4ee55.24\u7248\u672c\u4e3a\u4f8b\uff0c\u53cc\u51fbMDK524\u5e94\u7528\u7a0b\u5e8f\u6587\u4ef6\uff0c\u70b9\u51fbnext>>\u3002 \u6253\u4e0a I agree\u524d\u9762\u7684\u52fe\u52fe\uff0c\u5373\u662f\u540c\u610f\u4e00\u4e9b\u5b89\u88c5\u534f\u8bae\u3002\u70b9\u51fbnext>>\u3002 \u9009\u62e9\u5b89\u88c5\u8def\u5f84\uff0c\u53ef\u4ee5\u9ed8\u8ba4\u4e5f\u53ef\u4ee5\u5b89\u88c5\u5728\u6211\u4eec\u81ea\u5df1\u5efa\u7acb\u7684\u6587\u4ef6\u5939\u4e0b\u3002\u70b9\u51fbnext>>\u3002 \u8fd9\u91cc\u586b\u5199\u7684\u662f\u6211\u4eec\u7684\u4e00\u4e9b\u4fe1\u606f\uff0c\u586b\u5199\u5b8c\u6574\u540e\uff0c\u7ee7\u7eednext>>\u3002 \u7136\u540e\u7b49\u5f85\u5b89\u88c5\u5b8c\u6210\u5373\u53ef\u3002 \u5b89\u88c5\u5b8c\u6210\uff0c\u70b9\u51fbFinish\u3002 \u7136\u540e\u4f1a\u8df3\u51fa\u6765\u8fd9\u4e2a\u754c\u9762\uff0c\u8fd9\u4e2a\u6211\u4eec\u540e\u9762\u518d\u8bb2\uff0c\u5148\u70b9OK\uff0c\u628a\u5f39\u6846\u90fd\u53c9\u6389\u3002 \u6fc0\u6d3bMDK\uff0c\u5bfc\u5165License,\u6fc0\u6d3bMDK\u540e\u4fbf\u53ef\u4f7f\u7528\u4e86\u3002 \u7279\u522b\u63d0\u793a\uff1a\u4e00\u5b9a\u8981\u8f93\u5165License\u6fc0\u6d3bMDK\u8f6f\u4ef6\uff0c\u5efa\u8bae\u8d2d\u4e70\u6b63\u7248License\u3002","title":"2.2 MDK\u5b89\u88c5"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#23-mdk","text":"\u5b89\u88c5\u5b8cMDK\u540e\uff0c\u6211\u4eec\u9700\u8981\u5b89\u88c5\u5f00\u53d1\u5957\u4ef6\u4e2d\u5355\u7247\u673a\u578b\u53f7\u5bf9\u5e94\u7684Pack\u3002 \u5b89\u88c5\u65b9\u5f0f\u4e00 \u767b\u5f55\u5b98\u7f51\uff1ahttp://www.keil.com/dd2/pack/ \u4e0b\u8f7dKeil.STM32WLxx_DFP.1.0.0.pack \u540e\u5b89\u88c5\uff0c\u5982\u4e0b\u56fe \u5b89\u88c5\u65b9\u5f0f\u4e8c MDK\u8f6f\u4ef6\u4e0a\u5728\u7ebf\u5b89\u88c5 \u6253\u5f00\u8f6f\u4ef6\uff0c\u5728\u5bfc\u822a\u680f\u6253\u5f00Pack\u5b89\u88c5\u754c\u9762\uff0c\u7136\u540e\u9009\u62e9ok\u9009\u9879\u3002 \u8fdb\u5165\u5728\u7ebf\u5b89\u88c5\u754c\u9762\uff0c\u9009\u7740STM32WLXX Pack,\u70b9\u51fbInstall\u8fdb\u884c\u5b89\u88c5\u3002 \u81f3\u6b64\uff0c\u6211\u4eec\u5f00\u53d1\u677f\u7684\u5355\u7247\u673a\u7a0b\u5e8f\u5f00\u53d1\u73af\u5883\u5df2\u7ecf\u642d\u5efa\u5b8c\u6bd5\uff0c\u91cd\u542fMDK\u8f6f\u4ef6\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002","title":"2.3 MDK\u5b89\u88c5"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#24-st-link","text":"\u524d\u9762\u8bb2\u4e86\u5f00\u53d1\u677f\u5355\u7247\u673a\u7a0b\u5e8f\u7684\u5f00\u53d1\u73af\u5883\u7684\u642d\u5efa\uff0c\u4f46\u662f\u4e3a\u4e86\u5c06\u7a0b\u5e8f\u70e7\u5f55\u5230\u5f00\u53d1\u677f\u4e2d\u6211\u4eec\u8fd8\u9700\u8981\u4f7f\u7528\u4eff\u771f\u5668\u3002\u6211\u4eec\u8fd9\u5957\u5f00\u53d1\u677f\u9009\u7528ST\u516c\u53f8\u7684ST-Link V2\u4eff\u771f\u5668\u8fdb\u884c\u5f00\u53d1\u677f\u7a0b\u5e8f\u7684\u70e7\u5199\u548c\u4eff\u771f\uff0c\u4e0b\u9762\u4ecb\u7ecdST-Link\u9a71\u52a8\u7684\u5b89\u88c5\u53ca\u73af\u5883\u642d\u5efa\u3002 \u5728ST\u5b98\u7f51\u4e0b\u8f7dST-Link\u9a71\u52a8\uff0c https://www.st.com/content/st_com/zh/products/development-tools/software-development-tools/stm32-software-development-tools/stm32-utilities/stsw-link009.html \uff08\u9a71\u52a8\u67092\u79cd\uff1a 32\u4f4d\u7535\u8111\u7cfb\u7edf\u5b89\u88c5\u201cdpinst_x86\u201d\u300164\u4f4d\u7535\u8111\u7cfb\u7edf\u5b89\u88c5\u201cdpinst_amd64\u201d\uff09\u3002 \u8fd0\u884c\u5bf9\u5e94\u7684\u9a71\u52a8\uff0c\u5b89\u88c5ST-Link V2\u9a71\u52a8\u7a0b\u5e8f\u3002\u5b89\u88c5\u8def\u5f84\u5c3d\u91cf\u4fdd\u6301\u9ed8\u8ba4\u8def\u5f84\u3002 \u5b89\u88c5\u5b8c\u6210\u540e, \u5c06ST-Link\u901a\u8fc7USB\u63a5\u53e3\u8fde\u5165\u7535\u8111\u3002\u6253\u5f00\u201c\u8bbe\u5907\u7ba1\u7406\u5668\u201d\u3002\u82e5\u770b\u5230\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u8868\u793a\u9a71\u52a8\u5b89\u88c5\u6210\u529f\u3002 \u8fd9\u91cc\u63d0\u9192 2 \u70b9: 1\uff0c \u5404\u79cd windows \u7248\u672c\u8bbe\u5907\u540d\u79f0\u548c\u6240\u5728\u8bbe\u5907\u7ba1\u7406\u5668\u680f\u76ee\u53ef\u80fd\u4e0d\u4e00\u6837\uff0c\u4f8b\u5982 WIN10 \u63d2\u4e0aSTLINK \u540e\u663e\u793a\u7684\u662f STM32 STLINK\u3002 2\uff0c \u5982\u679c\u8bbe\u5907\u540d\u79f0\u65c1\u8fb9\u663e\u793a\u7684\u662f\u9ec4\u8272\u7684\u53f9\u53f7\uff0c\u8bf7\u76f4\u63a5\u70b9\u51fb\u8bbe\u5907\u540d\u79f0\uff0c\u7136\u540e\u5728\u5f39\u51fa\u7684\u754c\u9762\u70b9\u51fb\u66f4\u65b0\u8bbe\u5907\u9a71\u52a8 \u81f3\u6b64\uff0c ST-Link \u9a71\u52a8\u5df2\u7ecf\u5b89\u88c5\u5b8c\u6210\u3002\u63a5\u4e0b\u6765\u5927\u5bb6\u53ea\u9700\u8981\u5728 MDK\u5de5\u7a0b\u91cc\u9762\u914d\u7f6e\u4e00\u4e0b ST-Link\u5373\u53ef\u3002","title":"2.4 ST-Link\u9a71\u52a8\u5b89\u88c5"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#25-mdk","text":"\u5b89\u88c5\u9a71\u52a8\u6210\u529f\u540e\uff0c\u6253\u5f00MDK\u8f6f\u4ef6\uff0c\u914d\u7f6e\u7a0b\u5e8f\u70e7\u5199\u548c\u4eff\u771f\u7684\u73af\u5883\u3002 \u70b9\u51fb\u8fdb\u5165\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\u6309\u7ebd\uff0c\u8fdb\u5165\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\u3002 \u9009\u62e9Debug\u9009\u9879\uff0c\u8fdb\u5165\u4eff\u771f\u5668\u8bbe\u7f6e\u754c\u9762\u3002 \u4e0b\u62c9\u4eff\u771f\u5668\u9009\u62e9\u5217\u8868\uff0c\u9009\u7740ST-Link Debugger\u5e76\u52fe\u9009\u53f3\u4fa7Use,\u70b9\u51fbSettings\u8fdb\u5165ST-Link V2\u4eff\u771f\u5668\u914d\u7f6e\u754c\u9762\u3002 \u5f00\u53d1\u677f\u8bbe\u8ba1\u7684\u7a0b\u5e8f\u70e7\u5f55\u65b9\u5f0f\u4e3aSW\uff0c\u6b64\u5904Unit\u9009\u62e9ST-Link/V2,\u4e14Port\u9009\u62e9SW,\u5e76\u786e\u8ba4\u53f3\u4fa7\u6846\u5185\u662f\u5426\u68c0\u6d4b\u51faSW\u8bbe\u5907\uff0c\u70b9\u51fb<\u786e\u8ba4>\u4fdd\u5b58\u914d\u7f6e\u3002","title":"2.5  \u7f16\u7a0b\u8f6f\u4ef6(MDK)\u914d\u7f6e"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#26-ch340","text":"\u4e92\u8054\u7f51\u641c\u7d22\u4e0b\u8f7dCH340 \u4e32\u53e3\u82af\u7247\u7684\u9a71\u52a8 \u5b89\u88c5\u65b9\u6cd5\uff1a\u6253\u5f00\u9a71\u52a8\u5b89\u88c5\u7a0b\u5e8f\u70b9\u51fb\u5b89\u88c5\u5373\u53ef\u3002 \u6ce8\uff1a\u82e5\u5b89\u88c5\u5931\u8d25\uff0c\u8bf7\u5148\u70b9\u51fb\u5378\u8f7d\uff0c\u540e\u70b9\u51fb\u5b89\u88c5\u3002","title":"2.6  CH340\u4e32\u53e3\u9a71\u52a8\u5b89\u88c5"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#27","text":"\u5de5\u5177\u4e0b\u8f7d\uff1a http://www.daxia.com/download/sscom.rar \u5b89\u88c5\u65b9\u6cd5\uff1a\u4e32\u53e3\u8c03\u8bd5\u52a9\u624bsscom5.13.1\u662f\u514d\u5b89\u88c5\u7684\uff0c\u89e3\u538b\u51fa\u538b\u7f29\u5305\u5373\u53ef\u76f4\u63a5\u4f7f\u7528\u3002 \u6839\u636ePC\u548c\u7ec8\u7aef\u4e4b\u95f4\u7684\u8fde\u63a5\uff0c\u9009\u62e9\u6b63\u786e\u7684\u4e32\u884c\u7aef\u53e3\u3002 \u6253\u5f00\u7535\u8111\u7684\u8bbe\u5907\u7ba1\u7406\u5668\uff0c\u5728\u7aef\u53e3\u5217\u8868\u53ef\u4ee5\u770b\u5230PC\u4e0e\u5f00\u53d1\u677f\u8fde\u63a5\u7684\u7aef\u53e3\u53f7\u3002 \u6211\u8fd9\u91cc\u663e\u793a\u7684\u662fCOM6\uff0c\u6240\u4ee5\u8981\u5728sscom\u5de5\u5177\u4e2d\u9009\u62e9COM6\uff0c\u5f00\u53d1\u677f\u7a0b\u5e8f\u6ce2\u7279\u7387\u8bbe\u7f6e\u4e3a115200\uff0c\u6240\u4ee5\u6211\u5728sscom\u4e32\u53e3\u5de5\u5177\u4e2d\u9009\u62e9115200\u6ce2\u7279\u7387\u3002","title":"2.7 \u4e32\u53e3\u8c03\u8bd5\u52a9\u624b\u7684\u5b89\u88c5\u4e0e\u4f7f\u7528"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#3-tencentos-tinystm32wl-lorawan-iot-explorer","text":"\u57fa\u4e8eTencentOS Tiny EVB WL\u8981\u5b8c\u6210\u817e\u8baf\u4e91IoT Explorer\u5bf9\u63a5\uff0c\u9700\u8981\u5b8c\u6210\u4e24\u4e2a\u90e8\u5206\u7684\u5de5\u4f5c\u3002 \u4e00\u662f\uff1a\u817e\u8baf\u4e91IoT explorer \u4e0a\u5b8c\u6210\u9879\u76ee\u3001\u4ea7\u54c1\u3001\u8bbe\u5907\u521b\u5efa\u3001\u53c2\u6570\u914d\u7f6e \u4e8c\u662f\uff1a\u57fa\u4e8eTencentOS Tiny\u5b8c\u6210LoRaWAN\u5e94\u7528\u5f00\u53d1\uff0c\u5411\u817e\u8baf\u4e91\u4e0a\u62a5\u4e1a\u52a1\u6570\u636e\u3002","title":"3. \u57fa\u4e8eTencentOS tiny\u7684STM32WL LoRaWAN \u63a5\u5165\u817e\u8baf\u4e91IoT Explorer\u6307\u5f15"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#31-iot-explorer","text":"","title":"3.1  \u817e\u8baf\u4e91IoT explorer\u4e0a\u521b\u5efa\u9879\u76ee\u3001\u4ea7\u54c1\u3001\u8bbe\u5907"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#_1","text":"\u767b\u5f55 \u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u63a7\u5236\u53f0 \uff0c\u9009\u62e9\u3010\u65b0\u5efa\u9879\u76ee\u3011\u3002 \u5728\u65b0\u5efa\u9879\u76ee\u9875\u9762\uff0c\u586b\u5199\u9879\u76ee\u57fa\u672c\u4fe1\u606f\u540e\uff0c\u5355\u51fb\u3010\u4fdd\u5b58\u3011 \u9879\u76ee\u540d\u79f0\uff1a\u8f93\u5165\u201cLoRa \u6e29\u6e7f\u5ea6\u6f14\u793a\u201d\u6216\u5176\u4ed6\u540d\u79f0\u3002 \u9879\u76ee\u63cf\u8ff0\uff1a\u6309\u7167\u5b9e\u9645\u9700\u6c42\u586b\u5199\u9879\u76ee\u63cf\u8ff0\u3002 \u9879\u76ee\u65b0\u5efa\u6210\u529f\u540e\uff0c\u5373\u53ef\u65b0\u5efa\u4ea7\u54c1\u3002","title":"\u521b\u5efa\u9879\u76ee\u548c\u4ea7\u54c1"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#_2","text":"\u8fdb\u5165\u8be5\u9879\u76ee\u7684\u4ea7\u54c1\u5217\u8868\u9875\u9762\uff0c\u5355\u51fb\u3010\u65b0\u5efa\u4ea7\u54c1\u3011\u3002 \u5728\u65b0\u5efa\u4ea7\u54c1\u9875\u9762\uff0c\u586b\u5199\u4ea7\u54c1\u57fa\u672c\u4fe1\u606f\u3002 \u4ea7\u54c1\u540d\u79f0\uff1a\u8f93\u5165\u201cLoRa\u6e29\u6e7f\u5ea6\u76d1\u6d4b\u4eea\u201d\u6216\u5176\u4ed6\u4ea7\u54c1\u540d\u79f0\u3002 \u4ea7\u54c1\u7c7b\u578b\uff1a\u9009\u62e9\u201c\u7528\u6237\u81ea\u5b9a\u4e49\u201d\u3002 \u8bbe\u5907\u7c7b\u578b\uff1a\u9009\u62e9\u201c\u8bbe\u5907\u201d\u3002 \u8ba4\u8bc1\u65b9\u5f0f\uff1a\u9009\u62e9\u201c\u5bc6\u94a5\u8ba4\u8bc1\u201d\u3002 \u901a\u4fe1\u65b9\u5f0f\uff1a\u9009\u62e9\u201cLoRaWAN\u201d\u3002 \u6570\u636e\u534f\u8bae\uff1a\u9009\u62e9\u201c\u81ea\u5b9a\u4e49\u900f\u4f20\u201d\u3002 \u4ea7\u54c1\u65b0\u5efa\u6210\u529f\u540e\uff0c\u60a8\u53ef\u5728\u4ea7\u54c1\u5217\u8868\u9875\u67e5\u770b\u201cLoRa\u6e29\u6e7f\u5ea6\u76d1\u6d4b\u4eea\u201d\u3002","title":"\u65b0\u5efa\u4ea7\u54c1"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#_3","text":"\u5355\u51fb\u4ea7\u54c1\u540d\u79f0\uff0c\u8fdb\u5165\u4ea7\u54c1\u914d\u7f6e\u9875\uff0c\u5728\u3010\u81ea\u5b9a\u4e49\u529f\u80fd\u3011\u914d\u7f6e\u9879\u4e0b\uff0c\u5355\u51fb\u3010\u65b0\u5efa\u529f\u80fd\u3011\uff0c\u81ea\u5b9a\u4e49\u4ea7\u54c1\u529f\u80fd\u3002 \u8fd9\u91cc\u6211\u4eec\u5c31\u4e0d\u4e00\u4e00\u5b9a\u4e49\u6570\u636e\u6a21\u677f\u4e86\uff0c\u76f4\u63a5\u5bfc\u5165\u4e0b\u9762\u7684json\u4ee3\u7801: { \"version\": \"1.0\", \"profile\": { \"ProductId\": \"F2G256SY2G\", \"CategoryId\": \"1\" }, \"properties\": [ { \"id\": \"temperature\", \"name\": \"\u6e29\u5ea6\", \"desc\": \"\", \"mode\": \"r\", \"define\": { \"type\": \"int\", \"min\": \"-100\", \"max\": \"155\", \"start\": \"0\", \"step\": \"1\", \"unit\": \"\u6444\u6c0f\u5ea6\" }, \"required\": false }, { \"id\": \"humidity\", \"name\": \"\u6e7f\u5ea6\", \"desc\": \"\", \"mode\": \"rw\", \"define\": { \"type\": \"int\", \"min\": \"0\", \"max\": \"100\", \"start\": \"0\", \"step\": \"1\", \"unit\": \"%\" }, \"required\": false }, { \"id\": \"period\", \"name\": \"\u4e0a\u62a5\u5468\u671f\", \"desc\": \"\", \"mode\": \"rw\", \"define\": { \"type\": \"int\", \"min\": \"0\", \"max\": \"3600\", \"start\": \"0\", \"step\": \"1\", \"unit\": \"\u79d2\" }, \"required\": false } ], \"events\": [], \"actions\": [] } \u5bfc\u5165\u5b8c\u6210\u540e\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a","title":"\u521b\u5efa\u6570\u636e\u6a21\u677f"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#lorawan","text":"\u5728\u8bbe\u5907\u5f00\u53d1\u9875\u9762\u4e2d\uff0c\u6309\u9700\u8c03\u6574 LoRaWAN \u53c2\u6570\u914d\u7f6e\u3002\u672c\u793a\u4f8b\u4e2d\u4f7f\u7528\u9ed8\u8ba4\u7684 OTAA \u914d\u7f6e\u3002","title":"\u914d\u7f6e LoRaWAN \u53c2\u6570"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#_4","text":"\u5728\u8bbe\u5907\u5f00\u53d1\u9875\u9762\u4e2d\uff0c\u6309\u9700\u8c03\u6574\u8bbe\u5907\u6570\u636e\u89e3\u6790\u3002\u7531\u4e8e LoRa \u7c7b\u8d44\u6e90\u6709\u9650\u8bbe\u5907\u4e0d\u9002\u5408\u76f4\u63a5\u4f20\u8f93 JSON \u683c\u5f0f\u6570\u636e\uff0c\u4f7f\u7528\u201c\u8bbe\u5907\u6570\u636e\u89e3\u6790\u201d\u53ef\u4ee5\u5c06\u8bbe\u5907\u539f\u59cb\u6570\u636e\u8f6c\u5316\u4e3a\u4ea7\u54c1 JSON \u6570\u636e\u3002","title":"\u8bbe\u5907\u6570\u636e\u89e3\u6790"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#_5","text":"\u5728\u672c\u793a\u4f8b\u4e2d\uff0c\u8bbe\u5907\u4e0a\u884c\u6570\u636e\u5171\u67093\u4e2a\uff0c\u5305\u62ec\u6e29\u5ea6\u3001\u6e7f\u5ea6\u3001\u4e0a\u62a5\u5468\u671f3\u4e2a\u5c5e\u6027\u6570\u636e","title":"\u8bbe\u5907\u6570\u636e\u534f\u8bae"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#_6","text":"\u4e0a\u884c\u6570\u636e\u89e3\u6790\u7684\u811a\u672c\u4e3b\u51fd\u6570\u4e3a RawToProtocol\uff0c\u5176\u5e26\u6709 fPort\u3001bytes \u4e24\u4e2a\u5165\u53c2\uff1a - fPort\uff1a\u8bbe\u5907\u4e0a\u62a5\u7684 LoRaWAN \u534f\u8bae\u6570\u636e\u7684 FPort \u5b57\u6bb5\u3002 - bytes\uff1a\u8bbe\u5907\u4e0a\u62a5\u7684 LoRaWAN \u534f\u8bae\u6570\u636e\u7684 FRMPayload \u5b57\u6bb5\u3002 \u811a\u672c\u4e3b\u51fd\u6570\u7684\u51fa\u53c2\u4e3a\u4ea7\u54c1\u6570\u636e\u6a21\u7248\u534f\u8bae\u683c\u5f0f\u7684\u5bf9\u8c61\u3002 \u5728\u4e0a\u884c\u6570\u636e\u89e3\u6790\u90e8\u5206\uff0cjavascript \u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a function RawToProtocol(fPort, bytes) { var data = { \"method\": \"report\", \"clientToken\" : new Date(), \"params\" : {} }; data.params.temperature = bytes[0]; data.params.humidity = bytes[1]; data.params.period = bytes[2] | (bytes[3] << 8); return data; } \u4e0b\u884c\u6570\u636e\u89e3\u6790\u7684\u811a\u672c\u4e3b\u51fd\u6570\u4e3a ProtocolToRaw\uff0c\u5176\u5165\u53c2\u4e3a\u4ea7\u54c1\u6570\u636e\u6a21\u7248\u534f\u8bae\u683c\u5f0f\u7684\u5bf9\u8c61\u3002 \u5728\u4e0b\u884c\u6570\u636e\u89e3\u6790\u90e8\u5206\uff0cjavascript \u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a function ProtocolToRaw(obj) { var data = new Array(); data[0] = 5;// fport=5 data[1] = 0;// unconfirmed mode data[2] = obj.params.period & 0x00FF; data[3] = (obj.params.period >> 8) & 0x00FF; return data; }","title":"\u6570\u636e\u89e3\u6790\u811a\u672c"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#_7","text":"\u5728\u8bbe\u5907\u8c03\u8bd5\u9875\u9762\u4e2d\uff0c\u5355\u51fb\u3010\u65b0\u5efa\u8bbe\u5907\u3011\uff0c\u8bbe\u5907\u540d\u4e3a WL_DEV_001\u3002 DevEUI\u3001APPKEY\u7b49\u4fe1\u606f\u53ef\u4ece WL \u5f00\u53d1\u677f \u7ec8\u7aef\u8bbe\u5907\u83b7\u53d6\u6216\u8005\u8bbe\u7f6e\uff0c\u4e91\u5e73\u53f0\u548c\u7ec8\u7aef\u8981\u4fdd\u6301\u4e00\u81f4\u3002","title":"\u521b\u5efa\u6d4b\u8bd5\u8bbe\u5907"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#_8","text":"\u4fdd\u6301 LoRa \u8282\u70b9\u548c LoRa \u7f51\u5173 \u4e3a\u8fd0\u884c\u72b6\u6001\u3002 \u8fdb\u5165\u3010\u63a7\u5236\u53f0\u3011>\u3010\u4ea7\u54c1\u5f00\u53d1\u3011>\u3010\u8bbe\u5907\u8c03\u8bd5\u3011\uff0c\u53ef\u67e5\u770b\u5230\u8bbe\u5907 \"WL_DEV_001\" \u3002 \u5355\u51fb\u3010\u8c03\u8bd5\u3011\uff0c\u53ef\u8fdb\u5165\u8bbe\u5907\u8be6\u60c5\u9875\u3002 \u5355\u51fb\u3010\u8bbe\u5907\u5c5e\u6027\u3011\uff0c\u53ef\u67e5\u8be2\u8bbe\u5907\u4e0a\u62a5\u5230\u5f00\u53d1\u5e73\u53f0\u7684\u6700\u65b0\u6570\u636e\u53ca\u5386\u53f2\u6570\u636e\u3002 \u8bbe\u5907\u5c5e\u6027\u7684\u6700\u65b0\u503c\uff1a\u4f1a\u663e\u793a\u8bbe\u5907\u4e0a\u62a5\u7684\u6700\u65b0\u6570\u636e\u3002 \u8bbe\u5907\u5c5e\u6027\u7684\u66f4\u65b0\u65f6\u95f4\uff1a\u663e\u793a\u6570\u636e\u7684\u66f4\u65b0\u65f6\u95f4\u3002 \u5355\u51fb\u3010\u67e5\u770b\u3011\uff0c\u53ef\u67e5\u770b\u67d0\u4e2a\u5c5e\u6027\u7684\u5386\u53f2\u4e0a\u62a5\u6570\u636e\u3002","title":"\u67e5\u770b\u8bbe\u5907\u72b6\u6001"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#_9","text":"\u5355\u51fb\u3010\u8bbe\u5907\u65e5\u5fd7\u3011\uff0c\u53ef\u67e5\u8be2\u8be5\u8bbe\u5907\u67d0\u6bb5\u65f6\u95f4\u8303\u56f4\u7684\u6240\u6709\u4e0a\u4e0b\u884c\u6570\u636e\u3002 - \u4e0a\u884c\uff1a\u4e0a\u884c\u6307\u8bbe\u5907\u7aef\u4e0a\u62a5\u5230\u5f00\u53d1\u5e73\u53f0\u7684\u6570\u636e\u3002 - \u4e0b\u884c\uff1a\u4e0b\u884c\u6307\u4ece\u5f00\u53d1\u5e73\u53f0\u4e0b\u53d1\u5230\u8bbe\u5907\u7684\u6570\u636e\u3002","title":"\u67e5\u770b\u8bbe\u5907\u901a\u4fe1\u65e5\u5fd7"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#32-tencentos-tiny-evb_wllorawan","text":"","title":"3.2 \u57fa\u4e8eTencentOS Tiny EVB_WL\u5f00\u53d1\u677f\u5b8c\u6210LoRaWAN\u5e94\u7528\u5f00\u53d1"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#_10","text":"TencentOS tiny\u5b98\u65b9\u5f00\u6e90\u4ed3\u4e0b\u8f7d\u6e90\u7801\uff0c\u5730\u5740\u4e3a\uff1a https://github.com/Tencent/TencentOS-tiny \u8fdb\u5165 < TencentOS-tiny\\board\\RHF0M0E5_STM32WLE5xx\\KEIL\\lorawan> \u76ee\u5f55\uff0c\u6253\u5f00TencentOS_tiny.uvprojx\u5de5\u7a0b\uff1a","title":"\u4e0b\u8f7d\u6e90\u7801"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#lorawan_1","text":"\u6253\u5f00\u5de5\u7a0b\u540e\uff0c\u6211\u4eec\u5728\u5de6\u4fa7\u7684\u5de5\u7a0b\u6587\u4ef6\u5bfc\u822a\u9875\u9762\u53ef\u4ee5\u770b\u5230WL\u7684LoRaWAN\u76f8\u5173\u6e90\u7801\uff0c\u8fd9\u91cc\u521b\u5efa\u4e86\u4e24\u4e2aTencentOS tiny\u7684\u4efb\u52a1\uff0c\u4e00\u4e2a\u8d1f\u8d23\u5904\u7406LoRaWAN MAC\u5c42\u534f\u8bae\uff0c\u4e00\u4e2a\u5904\u7406\u4e1a\u52a1\u3002\u5f00\u53d1\u8005\u5728\u7f16\u8bd1\u524d\u9700\u8981\u914d\u7f6e\u8bbe\u5907\u76f8\u5173\u4fe1\u606f\u3002 \u6253\u5f00commissioning.h\u5934\u6587\u4ef6\uff0c\u5728\u6587\u4ef6\u4e2d\u8f93\u5165\u4e0e\u524d\u6587IoT Explorer\u5e73\u53f0\u5bf9\u5e94\u7684device EUI\u548cAPP KEY\uff0c\u6309\u5982\u4e0b\u56fe\u6240\u793a\u7684\u683c\u5f0f\uff1a \u57fa\u4e8eTencentOS Tiny\u7684WL\u5f00\u53d1\u677f\u7684\u4e1a\u52a1\u6d41\u7a0b\u5982\u4e0b\uff1a 1. main\u51fd\u6570\u4e2d\u5b8c\u6210 \u677f\u7ea7\u521d\u59cb\u5316\uff0c\u4e3b\u8981\u662f board_init\u51fd\u6570\u4e2d\u521d\u59cb\u5316\u597d\u57fa\u7840\u5916\u8bbe\u548cLoRa\u5c04\u9891\u53caLoRa\u534f\u8bae\u6808\uff1b\u5176\u4e2dMX_LoRaWAN_Init\u51fd\u6570\u4f1a\u5b8c\u6210LoRaWAN\u534f\u8bae\u7684\u57fa\u7840\u914d\u7f6e\uff0c\u6bd4\u5982\u9009\u62e9CLASS\u3001\u914d\u7f6e\u901a\u9053\u3001\u914d\u7f6eADR\u7b49\uff1b 2. main\u51fd\u6570\u4e2d\uff0c\u5b8c\u6210\u5185\u6838\u521d\u59cb\u5316\u3001\u521b\u5efa\u4e3b\u7ebf\u7a0b\u5165\u53e3application_entry\uff0c\u542f\u52a8\u5185\u6838\uff1b 3. application_entry\u51fd\u6570\u4e2d\u518d\u521b\u5efalora_mac_process_task\uff1b 4. application_entry\u51fd\u6570\u4e2d\u8c03\u7528lw_send\u51fd\u6570\u5411LoRa\u7f51\u5173\u548c\u4e91\u7aef\u4e0a\u62a5\u7ec8\u7aef\u6570\u636e\u3002\u793a\u4f8b\u4e2d\u662f\u6a21\u62df\u4e863\u4e2a\u5143\u6570\u636e\u53d1\u9001\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u4fee\u6539\u53d1\u9001\u81ea\u5df1\u60f3\u53d1\u9001\u7684\u6570\u636e\uff0c\u914d\u5408\u817e\u8baf\u4e91IoT\u5e73\u53f0\u8bbe\u8ba1\u597d\u5bf9\u5e94\u7684\u6570\u636e\u6a21\u677f\u5373\u53ef\u3002 \u4fee\u6539\u8bbe\u5907\u4fe1\u606f\u540e\uff0c\u5f00\u53d1\u8005\u6309\u7167\u4e0b\u56fe\u6307\u793a\uff0c\u70b9\u51fb\u7f16\u8bd1\u6309\u94ae\u5373\u53ef\u7f16\u8bd1\u5de5\u7a0b\uff0c\u5982\u56fe\uff1a","title":"\u7f16\u8bd1lorawan\u5de5\u7a0b"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#_11","text":"\u9996\u5148\u9700\u8981\u914d\u7f6e\u4e0b\u8f7d\u73af\u5883 \u6309\u4e0b\u56fe\u6240\u793a\u914d\u7f6e\u4e0b\u8f7d\u53c2\u6570 \u7f16\u8bd1\u5b8c\u6210\u540e\u70b9\u51fb\u5982\u56fe\u6240\u793a\u201dLOAD\u201d\u6309\u94ae\u4e0b\u8f7d\u7a0b\u5e8f\u5373\u53ef\u3002 \u5982\u679c\u51fa\u73b0\u65e0\u6cd5\u4e0b\u8f7d\u95ee\u9898\uff0c\u5219\u82af\u7247\u5904\u4e8e\u5199\u4fdd\u62a4\u72b6\u6001\uff0c\u8bf7\u67e5\u770b\u672c\u6587\u7b2c 4 \u5c0f\u8282\u7684\u5185\u5bb9\uff0c\u53bb\u9664\u5199\u4fdd\u62a4\u3002","title":"\u4e0b\u8f7d\u8fd0\u884c"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#_12","text":"\u8fde\u63a5\u597d\u4e32\u53e3\uff0c\u5728PC\u7684\u4e32\u53e3\u52a9\u624b\u4e2d\u53ef\u4ee5\u770b\u5230TencentOS Tiny EVB_WL\u5f00\u53d1\u677f\u6253\u5370LoRa\u4e1a\u52a1\u8fd0\u884c\u7684\u76f8\u5173\u65e5\u5fd7\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u540c\u65f6\u9700\u8981\u67e5\u8be2\u817e\u8baf\u4e91IoT Explore\u4e0a\u7684\u8bbe\u5907\u72b6\u6001\u548c\u4e0a\u62a5\u7684\u6570\u636e\u9879\uff0c\u5982\u56fe\u6240\u793a\uff1a","title":"\u67e5\u770b\u8fd0\u884c\u7ed3\u679c"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#4","text":"","title":"4. \u53bb\u9664\u82af\u7247\u5199\u4fdd\u62a4"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#41-st-link","text":"\u786e\u4fddST-Link\u4e0e\u5f00\u53d1\u677f\u6b63\u5e38\u8fde\u63a5\uff0c\u5e76\u4e14\u5728 MDK \u4e2d\u53ef\u4ee5\u6b63\u5e38\u8bfb\u53d6\u5230\u4fe1\u606f\uff0c\u5982\u56fe\uff1a","title":"4.1. \u4f7f\u7528ST-Link\u8fde\u63a5\u5f00\u53d1\u677f"},{"location":"26.TencentOS_tiny_EVB_WL_Quick_Start/#42-stm32cubeprog","text":"\u5173\u95edMDK\uff0c\u6253\u5f00STM32CubeProg\u8f6f\u4ef6\uff0c\u70b9\u51fb\u53f3\u4e0a\u89d2\u7684 Connect\uff0c\u8fde\u63a5\u6210\u529f\u540e\u663e\u793aConnected\uff1a \u70b9\u51fb\u9009\u62e9 OB \u56fe\u6807\u6309\u94ae\uff0c\u6309\u7167\u56fe\u4e2d\u6d41\u7a0b\u8fdb\u884c\u89e3\u9501\uff1a \u6210\u529f\u4e4b\u540e\u70b9\u51fb dicconnnect \u65ad\u5f00\u8fde\u63a5\uff1a \u82af\u7247\u89e3\u9501\u6210\u529f\uff0c\u6b64\u65f6\u5373\u53ef\u4f7f\u7528MDK\u6b63\u5e38\u4e0b\u8f7d\u3002 \u5199\u5728\u7ed3\u5c3e\u7684\u8bdd\uff1a\u611f\u8c22\u5927\u5bb6\u4f7f\u7528TencentOS Tiny\uff0c\u672c\u6587\u96be\u514d\u6709\u63cf\u8ff0\u4e0d\u6e05\u6670\u7684\u5730\u65b9\uff0c\u5982\u679c\u6709\u4efb\u4f55\u95ee\u9898\uff0c\u6b22\u8fce\u52a0\u5165TencentOS Tiny \u7684\u5b98\u7f51QQ\u6280\u672f\u7fa4\u8fdb\u884c\u4ea4\u6d41\uff0c\u57fa\u4e8eTencentOS Tiny\u76f8\u5173\u7684\u9879\u76ee\u5408\u4f5c\u8bf7\u90ae\u4ef6\u8054\u7cfb supowang@tencent.com","title":"4.2. \u4f7f\u7528STM32CubeProg\u89e3\u9501"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/","text":"1. \u6982\u8ff0 1.1. \u767e\u82b1\u7efd\u653e\u7684\u901a\u4fe1\u6a21\u7ec4 \u968f\u7740\u5d4c\u5165\u5f0f\u7cfb\u7edf\u7ec8\u7aef\u5bf9\u7f51\u7edc\u7684\u9700\u6c42\u8d8a\u6765\u8d8a\u591a\uff0c\u5404\u79cd\u901a\u4fe1\u6a21\u7ec4\u767e\u82b1\u9f50\u653e\uff0c\u51e0\u4e4e\u8986\u76d6\u4e86\u6240\u6709\u7684\u7f51\u7edc\u63a5\u5165\u65b9\u5f0f\uff1aWIFI\u30012G\u30014G Cat.1\u30014G Cat.4\u3001NB-IoT\u3001LoRa\u2026\u2026\u672a\u6765\u8fd8\u4f1a\u6709\u66f4\u591a\u3002 \u5bf9\u4e8e\u5d4c\u5165\u5f0f\u7cfb\u7edf\u7ec8\u7aef\u800c\u8a00\uff0c\u8fd9\u4e9b\u901a\u4fe1\u6a21\u7ec4\u5c4f\u853d\u4e86\u7f51\u7edc\u63a5\u5165\u65b9\u5f0f\u7684\u5dee\u5f02\u5316\uff0c\u65e0\u8bba\u4f7f\u7528\u54ea\u79cd\u65b9\u5f0f\u63a5\u5165\u7f51\u7edc\uff0c\u8bbe\u5907\u4ec5\u4ec5\u9700\u8981\u63d0\u4f9b\u4e00\u4e2a\u4e32\u53e3\u4e0e\u6a21\u7ec4\u4ea4\u4e92\u5373\u53ef\u3002 \u4ea4\u4e92\u53cc\u65b9\u6709\u4e86\u901a\u4fe1\u7684\u786c\u4ef6\u57fa\u7840\uff08\u4e32\u53e3\uff09\uff0c\u8fd8\u9700\u8981\u5236\u5b9a\u548c\u9075\u5faa\u4e00\u5957\u6709\u6548\u7684\u8f6f\u4ef6\u534f\u8bae\uff0c\u76ee\u524d\u5927\u591a\u6570\u6a21\u7ec4\u5382\u5546\u90fd\u91c7\u7528AT\u6307\u4ee4\u96c6\u3002 1.2. AT\u6307\u4ee4\u96c6 AT\u6307\u4ee4\u6709\u4e24\u79cd\uff1a \u2460 \u666e\u901aAT\u6307\u4ee4\uff1a\u4ee5AT\u5f00\u5934\u3001\u6362\u884c\u7b26\u7ed3\u675f\u7684\u4e00\u7ec4\u5b57\u7b26\u4e32\uff0c\u6bcf\u4e2a\u6307\u4ee4\u6267\u884c\u6210\u529f\u4e0e\u5426\u90fd\u6709\u76f8\u5e94\u7684\u8fd4\u56de\u3002 ---> AT <--- OK \u2461\u5176\u4ed6\u7684\u4e00\u4e9b\u975e\u9884\u671f\u7684\u4fe1\u606f\uff0c\u6a21\u5757\u5c06\u6709\u5bf9\u5e94\u7684\u4e00\u4e9b\u4fe1\u606f\u63d0\u793a\uff0c\u4e3b\u52a8\u53d1\u9001\uff1a <--- +IPD:... <--- +URC:... AT\u6307\u4ee4\u4ea4\u4e92\u7c7b\u4f3c\u670d\u52a1\u5668/\u5ba2\u6237\u7aef\u67b6\u6784\uff0c\u4e00\u822c\u6765\u8bf4\u6a21\u7ec4\u4fa7\u4f5c\u4e3aAT\u670d\u52a1\u7aef\uff0cMCU\u4fa7\u4f5c\u4e3aAT\u5ba2\u6237\u7aef\uff0c\u4ea4\u4e92\u65b9\u5f0f\u5bf9\u5e94\u4e5f\u6709\u4e24\u79cd\uff1a \u5ba2\u6237\u7aef\u53d1\u51fa\u4e00\u6761AT\u6307\u4ee4\uff0c\u670d\u52a1\u7aef\u6536\u5230\u5904\u7406\u4e4b\u540e\u8fd4\u56de\u7ed3\u679c\u7ed9\u5ba2\u6237\u7aef\uff1b \u670d\u52a1\u7aef\u4e3b\u52a8\u53d1\u9001\u6570\u636e\u7ed9\u5ba2\u6237\u7aef\uff0c\u5ba2\u6237\u7aef\u88ab\u52a8\u63a5\u6536\u5904\u7406\uff1b \u6574\u4f53\u67b6\u6784\u5982\u4e0b\u56fe\uff1a \u6a21\u7ec4\u7684\u529f\u80fd\u975e\u5e38\u4e30\u5bcc\uff0c\u6709\u4fee\u6539\u6a21\u7ec4\u914d\u7f6e\u7684AT\u6307\u4ee4\u3001\u6709TCP/IP\u534f\u8bae\u6808\u901a\u4fe1\u7684AT\u6307\u4ee4\u3001\u751a\u81f3\u8fd8\u6709MQTT\u3001HTTP\u3001NTP\u534f\u8bae\u6808\u7684\u901a\u4fe1\u6307\u4ee4\uff0c\u8fd9\u4e9b\u6307\u4ee4\u5408\u5728\u4e00\u8d77\u6784\u6210\u4e86\u8be5\u6a21\u7ec4\u7684AT\u6307\u4ee4\u96c6\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u540c\u4e00\u5bb6\u5382\u5546\u7684\u4e0d\u540c\u6a21\u7ec4\u4e4b\u95f4\uff0cAT\u6307\u4ee4\u96c6\u5dee\u5f02\u4e0d\u5927\uff0c\u800c\u4e0d\u540c\u5382\u5546\u4e4b\u95f4\u7684AT\u6307\u4ee4\u96c6\u4e4b\u95f4\u5dee\u5f02\u8f83\u5927\u3002 1.3. AT\u6307\u4ee4\u89e3\u6790\u65b9\u5f0f AT\u6307\u4ee4\u6709\u4e09\u79cd\u89e3\u6790\u65b9\u5f0f\uff1a \u88f8\u673a\u76f4\u63a5\u5728\u4e32\u53e3\u4e2d\u65ad\u5904\u7406\u51fd\u6570\u4e2d\u89e3\u6790 \u56e0\u4e3a\u89e3\u6790\u65f6\u95f4\u672a\u77e5\uff0c\u6240\u4ee5\u8fd9\u79cd\u89e3\u6790\u65b9\u5f0f\u6700\u4e0d\u53ef\u53d6\uff0c\u6781\u5bb9\u6613\u51fa\u73b0\u6570\u636e\u4e22\u5931\u95ee\u9898\u3002 \u88f8\u673a\u4f7f\u7528ringbuff\uff08\u73af\u5f62\u7f13\u51b2\u533a\uff09\u7f13\u5b58\u6570\u636e\uff0c\u5728main\u51fd\u6570\u4e2d\u6784\u9020\u72b6\u6001\u673a\u89e3\u6790 \u4e32\u53e3\u6bcf\u6765\u4e00\u4e2a\u5b57\u7b26\u5c31\u9001\u5165\u7f13\u51b2\u533a\uff0c\u6700\u5927\u7a0b\u5ea6\u4fdd\u8bc1\u6570\u636e\u4e0d\u4f1a\u4e22\u5931\uff0c\u8fd9\u79cd\u89e3\u6790\u65b9\u5f0f\u968f\u7740main\u51fd\u6570\u4e2d\u5176\u5b83\u4e1a\u52a1\u903b\u8f91\u7684\u589e\u591a\uff0c\u5bfc\u81f4\u7f13\u51b2\u533a\u6570\u636e\u8fdf\u8fdf\u5f97\u4e0d\u5230\u89e3\u6790\uff0c\u4f9d\u7136\u4f1a\u51fa\u73b0\u95ee\u9898\u3002 RTOS\u4f7f\u7528ringbuff\u7f13\u5b58\u6570\u636e\uff0c\u521b\u5efa\u4e00\u4e2a\u4efb\u52a1\u4e13\u95e8\u7528\u4e8e\u6570\u636e\u89e3\u6790 \u540c\u6837\uff0c\u4e32\u53e3\u6bcf\u6765\u4e00\u4e2a\u5b57\u7b26\u5c31\u9001\u5165\u7f13\u51b2\u533a\uff0c\u4fdd\u8bc1\u6570\u636e\u4e0d\u4e22\u5931\uff0c\u53ea\u8981\u6570\u636e\u89e3\u6790\u4efb\u52a1\u7684\u4f18\u5148\u7ea7\u591f\u9ad8\uff0c\u6570\u636e\u603b\u662f\u4f1a\u88ab\u53ca\u65f6\u89e3\u6790\uff0c\u5927\u5e45\u63d0\u5347\u7cfb\u7edf\u7684\u5b9e\u65f6\u6027\u80fd\u3002 1.4. AT\u6846\u67b6\u4e0eSAL\u5c42 \u4ec0\u4e48\u662fAT\u6846\u67b6\uff1f\u5176\u5b9e\u5e76\u4e0d\u795e\u79d8~ AT\u6846\u67b6\u662fRTOS\u5b98\u65b9\u4eba\u5458/\u793e\u533a\u5f00\u53d1\u8005\u7f16\u5199\u7684\u4e00\u4e2a\u901a\u7528AT\u6307\u4ee4\u89e3\u6790\u4efb\u52a1\uff0c\u4f7f\u5f00\u53d1\u8005\u53ea\u9700\u8981\u8c03\u7528 AT \u6846\u67b6\u63d0\u4f9b\u7684 API \u5373\u53ef\u5904\u7406\u4e0e\u6a21\u7ec4\u7684\u4ea4\u4e92\u6570\u636e\u3002 SAL\u6846\u67b6\u5168\u79f0Socket Abstract Layer\uff0c\u63d0\u4f9b\u4e86\u7c7b\u4f3csocket\u7f51\u7edc\u7f16\u7a0b\u7684\u62bd\u8c61\u5c42\u3002\u57fa\u4e8eAT\u6846\u67b6\u5b9e\u73b0SAL\u7684\u5e95\u5c42\u51fd\u6570\u53eb\u505a\u901a\u4fe1\u6a21\u7ec4\u7684\u9a71\u52a8\u7a0b\u5e8f\u3002 2. TencentOS-tiny\u7684AT\u6846\u67b6 2.1. \u6574\u4f53\u67b6\u6784 2.2. \u5b9e\u73b0\u539f\u7406 TencentOS-tiny AT \u6846\u67b6\u7684\u5b9e\u73b0\u5728 net/at \u76ee\u5f55\u4e0b\u7684 tos_at.h \u548c tos_at.c \u4e24\u4e2a\u6587\u4ef6\u4e2d\u3002 \u2460 AT\u6846\u67b6\u6240\u6709\u63a5\u6536\u6570\u636e\u7684\u6570\u636e\u6d41\u5411\u5982\u56fe\u6240\u793a\uff1a \u4e32\u53e3\u4e2d\u65ad\u4e2d\u9010\u4e2a\u5b57\u8282\u63a5\u6536\uff0c\u5199\u5165 chr_fifo \u7f13\u51b2\u533a\uff1b \u89e3\u6790\u4efb\u52a1 at_parser \u4ece chr_fifo \u7f13\u51b2\u533a\u4e2d\u9010\u4e2a\u5b57\u8282\u8bfb\u53d6\uff0c\u8bfb\u53d6\u4e00\u884c\u6570\u636e\u5230 recv_cache \uff08\u884c\u7f13\u51b2\u533a\uff09\u5e76\u8fdb\u884c\u5904\u7406\uff1b \u5904\u7406\u4e4b\u540e\u5982\u679c\u4e0d\u662f\u6a21\u7ec4\u4e0a\u62a5\u7684\u666e\u901a\u7684\u6570\u636e\uff0c\u4e5f\u4e0d\u662fAT\u547d\u4ee4\u671f\u671b\u7684\u8fd4\u56de\u7ed3\u679c\uff0c\u4e5f\u4e0d\u662f \"OK\"\u3001\"FAIL\"\u3001\"ERROR\"\uff0c\u5219\u4e3a\u666e\u901a\u6570\u636e\uff0c\u5c06\u884c\u7f13\u51b2\u533a\u7684\u6570\u636e\u590d\u5236\u5230\u7528\u6237\u4f20\u5165\u7684 echo_buffer\u4e2d\uff0c\u7531\u7528\u6237\u5904\u7406\u3002 \u2461 AT\u6846\u67b6\u5c06\u6a21\u7ec4\u4e3b\u52a8\u4e0a\u62a5\u7684\u6570\u636e\u4f5c\u4e3a\u4e8b\u4ef6\uff0c\u5c06\u4e0a\u62a5\u6570\u636e\u7684\u6570\u636e\u5934\u548c\u7528\u6237\u6307\u5b9a\u7684\u56de\u8c03\u5904\u7406\u51fd\u6570\u4f5c\u4e3a\u4e8b\u4ef6\u8868\uff0c\u5728AT\u6846\u67b6\u521d\u59cb\u5316\u65f6\u6ce8\u518c\u3002 \u6bd4\u5982 ESP8266 \u5728 TCP/IP \u901a\u4fe1\u65f6\uff0c\u6536\u5230\u8fdc\u7a0b\u670d\u52a1\u5668\u53d1\u9001\u6765\u7684\u6570\u636e\u65f6\u4f1a\u4f7f\u7528+IPD\u5934\u4e3b\u52a8\u4e0a\u62a5\u6570\u636e\uff0c\u5c06\u6b64\u4e8b\u4ef6\u6ce8\u518c\u7684\u793a\u4f8b\u5982\u4e0b\uff1a /* esp8266.c */ at_event_t esp8266_at_event[] = { { \"+IPD,\", esp8266_incoming_data_process }, }; \u6ce8\u518c\u4e4b\u540e\uff0c\u6bcf\u6b21\u884c\u89e3\u6790\u7684\u65f6\u5019\u90fd\u4f1a\u5224\u65ad\u662f\u5426\u4e3a\u4e8b\u4ef6\u5934\uff0c\u5982\u679c\u662f\u5219\u8bc1\u660e\u6709\u4e8b\u4ef6\u53d1\u751f\uff0c\u62c9\u8d77\u6ce8\u518c\u7684\u56de\u8c03\u51fd\u6570\u8fdb\u884c\u5904\u7406\u3002 \u6ce8\u610f\uff0cAT\u6846\u67b6\u53ea\u4ece chr_fifo \u4e2d\u8bfb\u53d6\u51fa\u4e86\u4e8b\u4ef6\u5934\uff0c\u4e8b\u4ef6\u5934\u4e4b\u540e\u7684\u6240\u6709\u6570\u636e\u4f9d\u7136\u5728\u7f13\u51b2\u533a\u4e2d\uff0c\u6240\u5728\u5f00\u53d1\u8005\u5728\u7f16\u5199\u56de\u8c03\u51fd\u6570\u65f6\u53ef\u4ee5\u8fb9\u8bfb\u51fa\u6570\u636e\uff0c\u8fb9\u89e3\u6790\u6570\u636e\u3002 \u2462 \u5982\u4f55\u5b8c\u6210\u4e00\u6b21\u4ea4\u4e92\uff1f AT\u6846\u67b6\u5c06\u6bcf\u4e00\u6b21\u4ea4\u4e92\u62bd\u8c61\u4e3a\u4e00\u4e2a at_echo_t \u5bf9\u8c61\uff0c\u7528\u6237\u4ea4\u4e92\u7684\u6d41\u7a0b\u5982\u4e0b\uff1a \u2463 \u5982\u4f55\u5b9e\u73b0\u591a\u4e2achannel\u540c\u65f6\u5b58\u5728\uff1f \u5927\u591a\u6570\u901a\u4fe1\u6a21\u7ec4\u5728\u8fdb\u884c TCP/IP \u901a\u4fe1\u65f6\uff0c\u652f\u6301\u540c\u65f6\u521b\u5efa\u591a\u4e2asocket\u901a\u4fe1\uff08\u4e00\u822c\u4e3a6\u4e2a\uff09\uff0c\u4f5c\u4e3a\u4e00\u4e2a\u901a\u7528\u7684AT\u6846\u67b6\uff0c\u4e5f\u4e3a\u4e86\u66f4\u597d\u7684\u4e0a\u5c42SAL\u670d\u52a1\uff0cAT\u6846\u67b6\u4e5f\u76f8\u5e94\u7684\u652f\u6301\u591achannel\u3002 \u6bcf\u4e2achannel\u5bf9\u8c61\u5982\u4e0b\uff1a typedef struct at_data_channel_st { uint8_t is_free; k_chr_fifo_t rx_fifo; uint8_t *rx_fifo_buffer; k_mutex_t rx_lock; at_channel_status_t status; const char *remote_ip; const char *remote_port; } at_data_channel_t; \u6bcf\u6b21\u4e0a\u5c42\u53d1\u8d77 Socket Connect\u8fde\u63a5\u65f6\uff0c\u5c06\u6b64Socket\u7684ip\u548cport\u7ed1\u5b9a\u5230channel\u5bf9\u8c61\uff0c\u7136\u540e\u52a8\u6001\u7533\u8bf7\u4e00\u5757\u5185\u5b58\u4f5c\u4e3a\u8be5channnel\u7684\u63a5\u6536\u7f13\u51b2\u533a\uff0c\u5f53Socket close\u65f6\uff0c\u968f\u5373\u91ca\u653e\u6b64\u7f13\u51b2\u533a\u3002 2.3. TencentOS-tiny AT\u6846\u67b6\u53c2\u6570\u914d\u7f6e AT\u6846\u67b6\u7684\u6240\u6709\u7f13\u51b2\u533a\u5185\u5b58\u90fd\u662f\u4f7f\u7528\u52a8\u6001\u5185\u5b58\uff0c\u5185\u90e8\u673a\u5236\u4f7f\u7528\u5230\u4e86\u4fe1\u53f7\u91cfsem\u3001\u4e92\u65a5\u9501mutex\u3001\u5b57\u7b26\u6d41\u961f\u5217chr_fifo\u3001\u8ba1\u65f6\u8868stopwatch\uff0c\u6240\u4ee5\u8bf7\u9996\u5148\u4fdd\u8bc1\u5728 tos_config.h \u4e2d\u8fd9\u4e9b\u914d\u7f6e\u5904\u4e8e\u4f7f\u80fd\u6a21\u5f0f\uff0c\u5176\u4e2d\u52a8\u6001\u5185\u5b58\u6c60\u7684\u5927\u5c0f\u53ef\u4ee5\u6839\u636e\u968f\u540e AT \u6846\u67b6\u7684\u914d\u7f6e\u4fee\u6539\uff1a #define TOS_CFG_MUTEX_EN 1u #define TOS_CFG_SEM_EN 1u #define TOS_CFG_MMHEAP_EN 1u #define TOS_CFG_MMHEAP_DEFAULT_POOL_EN 1u #define TOS_CFG_MMHEAP_DEFAULT_POOL_SIZE 0x8000 AT\u6846\u67b6\u7684\u6240\u6709\u53ef\u914d\u7f6e\u9009\u9879\u90fd\u5df2\u5728 tos_at.h \u4e2d\u4f7f\u7528\u5b8f\u5b9a\u4e49\u7ed9\u51fa\uff0c\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u9700\u8981\u8fdb\u884c\u88c1\u526a\u914d\u7f6e\uff1a #define AT_DATA_CHANNEL_NUM 6 #define AT_DATA_CHANNEL_FIFO_BUFFER_SIZE (2048 + 1024) #define AT_UART_RX_FIFO_BUFFER_SIZE (2048 + 1024) #define AT_RECV_CACHE_SIZE 2048 #define AT_CMD_BUFFER_SIZE 512 #define AT_PARSER_TASK_STACK_SIZE 2048 #define AT_PARSER_TASK_PRIO 2 \u914d\u7f6e\u9879\u7684\u610f\u4e49\u5982\u4e0b\uff1a \u914d\u7f6e\u9879 \u4f5c\u7528 AT_DATA_CHANNEL_NUM AT\u6846\u67b6\u652f\u6301\u7684\u6700\u5927\u901a\u9053\u6570 AT_DATA_CHANNEL_FIFO_BUFFER_SIZE \u6bcf\u4e2a\u901a\u9053\u7684\u7f13\u51b2\u533a\u5927\u5c0f AT_UART_RX_FIFO_BUFFER_SIZE \u4e32\u53e3\u63a5\u6536\u7f13\u51b2\u533a\u5927\u5c0f AT_RECV_CACHE_SIZE \u884c\u7f13\u51b2\u533a\u5927\u5c0f AT_CMD_BUFFER_SIZE \u547d\u4ee4\u7f13\u51b2\u533a\u5927\u5c0f AT_PARSER_TASK_STACK_SIZE \u89e3\u6790\u4efb\u52a1\u7684\u4efb\u52a1\u6808\u5927\u5c0f AT_PARSER_TASK_PRIO \u89e3\u6790\u4efb\u52a1\u7684\u4efb\u52a1\u4f18\u5148\u7ea7 2.4. AT\u6846\u67b6\u63d0\u4f9b\u7684API AT\u6846\u67b6\u5199\u5165\u4e00\u4e2a\u5b57\u8282\u6570\u636e __API__ void tos_at_uart_input_byte(uint8_t data); \u6b64 API \u901a\u5e38\u5728\u4e32\u53e3\u4e2d\u65ad\u4e2d\u8c03\u7528\u3002 AT\u6846\u67b6\u521d\u59cb\u5316 __API__ int tos_at_init(hal_uart_port_t uart_port, at_event_t *event_table, size_t event_table_size); \u53c2\u6570 \u610f\u4e49 uart_port AT\u6846\u67b6\u4f7f\u7528\u7684\u4e32\u53e3 event_table \u4e8b\u4ef6\u8868\u5730\u5740 event_table_size \u4e8b\u4ef6\u8868\u5927\u5c0f \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u521b\u5efa\u4e00\u4e2a at_echo_t \u5bf9\u8c61 __API__ int tos_at_echo_create(at_echo_t *echo, char *buffer, size_t buffer_size, char *echo_expect); \u53c2\u6570 \u610f\u4e49 echo at_echo_t\u5bf9\u8c61\u53e5\u67c4 buffer \u7528\u4e8e\u4fdd\u5b58\u547d\u4ee4\u6267\u884c\u7ed3\u679c\u7684\u7f13\u51b2\u533a buffer_size \u7f13\u51b2\u533a\u5927\u5c0f echo_expect \u671f\u671b\u7684\u5b57\u7b26\u4e32 \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u6267\u884c\u4e00\u6761AT\u547d\u4ee4,timeout\u8d85\u65f6\u540e\u624d\u8fd4\u56de __API__ int tos_at_cmd_exec(at_echo_t *echo, uint32_t timeout, const char *cmd, ...); \u53c2\u6570 \u610f\u4e49 echo at_echo_t\u5bf9\u8c61\u53e5\u67c4 timeout \u547d\u4ee4\u6267\u884c\u4e4b\u540e\u7684\u7b49\u5f85\u65f6\u95f4 cmd \u8981\u6267\u884c\u7684AT\u547d\u4ee4 \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u6267\u884c\u4e00\u6761AT\u547d\u4ee4\uff0c\u4e00\u65e6\u6709\u671f\u671b\u7ed3\u679c\u7acb\u9a6c\u8fd4\u56de\uff0c\u82e5\u65e0\uff0c\u5219timeout\u8d85\u65f6\u540e\u8fd4\u56de __API__ int tos_at_cmd_exec_until(at_echo_t *echo, uint32_t timeout, const char *cmd, ...); \u53c2\u6570 \u610f\u4e49 echo at_echo_t\u5bf9\u8c61\u53e5\u67c4 timeout \u547d\u4ee4\u6267\u884c\u4e4b\u540e\u7684\u7b49\u5f85\u65f6\u95f4 cmd \u8981\u6267\u884c\u7684AT\u547d\u4ee4 \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u53d1\u9001\u5341\u516d\u8fdb\u5236\u539f\u59cb\u6570\u636e\uff0ctimeout\u8d85\u65f6\u540e\u624d\u8fd4\u56de __API__ int tos_at_raw_data_send(at_echo_t *echo, uint32_t timeout, const uint8_t *buf, size_t size); \u53c2\u6570 \u610f\u4e49 echo at_echo_t\u5bf9\u8c61\u53e5\u67c4 timeout \u547d\u4ee4\u6267\u884c\u4e4b\u540e\u7684\u7b49\u5f85\u65f6\u95f4 buf \u5f85\u53d1\u9001\u7684\u7f13\u51b2\u533a size \u7f13\u51b2\u533a\u5927\u5c0f \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u53d1\u9001\u5341\u516d\u8fdb\u5236\u6570\u636e\uff0c\u4e00\u65e6\u6709\u671f\u671b\u7ed3\u679c\u7acb\u9a6c\u8fd4\u56de\uff0c\u82e5\u65e0\uff0c\u5219timeout\u8d85\u65f6\u540e\u8fd4\u56de __API__ int tos_at_raw_data_send_until(at_echo_t *echo, uint32_t timeout, const uint8_t *buf, size_t size); \u53c2\u6570 \u610f\u4e49 echo at_echo_t\u5bf9\u8c61\u53e5\u67c4 timeout \u547d\u4ee4\u6267\u884c\u4e4b\u540e\u7684\u7b49\u5f85\u65f6\u95f4 buf \u5f85\u53d1\u9001\u7684\u7f13\u51b2\u533a size \u7f13\u51b2\u533a\u5927\u5c0f \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u76f4\u63a5\u4ece\u4e32\u53e3\u63a5\u6536\u7f13\u51b2\u533a\u4e2d\u8bfb\u53d6\u6570\u636e __API__ int tos_at_uart_read(uint8_t *buffer, size_t buffer_len); \u53c2\u6570 \u610f\u4e49 buf \u5b58\u653e\u8bfb\u53d6\u6570\u636e\u7684\u7f13\u51b2\u533a size \u8bfb\u53d6\u6570\u636e\u7684\u957f\u5ea6 \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u76f4\u63a5\u4ece\u4e32\u53e3\u63a5\u6536\u7f13\u51b2\u533a\u4e2d\u8bfb\u53d6\u4e00\u884c\u6570\u636e __API__ int tos_at_uart_readline(uint8_t *buffer, size_t buffer_len); \u53c2\u6570 \u610f\u4e49 buf \u5b58\u653e\u8bfb\u53d6\u6570\u636e\u7684\u7f13\u51b2\u533a size \u8bfb\u53d6\u6570\u636e\u7684\u957f\u5ea6 \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u7533\u8bf7\u4e00\u4e2achannel __API__ int tos_at_channel_alloc(const char *ip, const char *port); \u53c2\u6570 \u610f\u4e49 ip socket ip port socket port \u8fd4\u56de\u503c \u6210\u529f\uff1a\u975e\u8d1f\u503c\u3001\u901a\u9053ID\uff0c\u5931\u8d25\uff1a-1 \u5199\u5165\u6570\u636e\u5230channel\u7684\u63a5\u6536\u7f13\u51b2\u533a __API__ int tos_at_channel_write(int channel_id, uint8_t *buffer, size_t buffer_len); \u53c2\u6570 \u610f\u4e49 channel_id \u5df2\u7ecf\u7533\u8bf7\u6210\u529f\u7684channel \u901a\u9053ID buf \u5b58\u653e\u5199\u5165\u6570\u636e\u7684\u7f13\u51b2\u533a size \u5199\u5165\u6570\u636e\u7684\u957f\u5ea6 \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u5728TCP/IP\u901a\u4fe1\u65f6\uff0c\u89e3\u6790\u5b8cAT\u6307\u4ee4\u4e0a\u62a5\u7684\u6570\u636e\u65f6\uff0c\u5c31\u53ef\u4ee5\u5c06\u771f\u6b63\u7f51\u7edc\u63a5\u6536\u7684\u6570\u636e\u8c03\u7528\u6b64API\u5199\u5165channle\u7684\u63a5\u6536\u7f13\u51b2\u533a\u3002 \u4ecechannel\u7684\u63a5\u6536\u7f13\u51b2\u533a\u4e2d\u8bfb\u53d6\u6570\u636e __API__ int tos_at_channel_read(int channel_id, uint8_t *buffer, size_t buffer_len); \u53c2\u6570 \u610f\u4e49 channel_id \u5df2\u7ecf\u7533\u8bf7\u6210\u529f\u7684channel \u901a\u9053ID buf \u5b58\u653e\u8bfb\u53d6\u6570\u636e\u7684\u7f13\u51b2\u533a size \u8bfb\u53d6\u6570\u636e\u7684\u957f\u5ea6 \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u4ecechannel\u7684\u63a5\u6536\u7f13\u51b2\u533a\u4e2d\u8bfb\u53d6\u6570\u636e\uff0c\u6709\u8d85\u65f6\u65f6\u95f4 __API__ int tos_at_channel_read_timed(int channel_id, uint8_t *buffer, size_t buffer_len, uint32_t timeout); \u53c2\u6570 \u610f\u4e49 channel_id \u5df2\u7ecf\u7533\u8bf7\u6210\u529f\u7684channel \u901a\u9053ID buf \u5b58\u653e\u8bfb\u53d6\u6570\u636e\u7684\u7f13\u51b2\u533a size \u8bfb\u53d6\u6570\u636e\u7684\u957f\u5ea6 timeout \u8bfb\u53d6\u7b49\u5f85\u65f6\u95f4 \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 3. TencentOS-tiny\u7684SAL\u6846\u67b6 3.1. \u4ec0\u4e48\u662fSAL\u6846\u67b6 SAL\u6846\u67b6\u5168\u79f0Socket Abstract Layer\uff0c\u63d0\u4f9b\u4e86\u7c7b\u4f3csocket\u7f51\u7edc\u7f16\u7a0b\u7684\u62bd\u8c61\u5c42\uff0c\u4e3a\u4e0a\u5c42\u5e94\u7528\u4e00\u5c42\u7edf\u4e00\u7684\u7f51\u7edcAPI\uff0c\u5c4f\u853d\u4e86\u5e95\u5c42\u4e0d\u540c\u901a\u4fe1\u6a21\u7ec4/\u65b9\u5f0f\u7684\u5dee\u5f02\u3002 3.2. SAL\u6846\u67b6\u7684\u5b9e\u73b0\u539f\u7406 TencentOS-tiny SAL\u6846\u67b6\u7684\u5b9e\u73b0\u5728 net/sal_module_wrapper \u8def\u5f84\u4e2d\uff0c\u4ec5\u6709\u4e24\u4e2a\u6587\u4ef6\uff1a sal_module_wrapper.h \u548c sal_module_wrapper.c \u3002 SAL\u6846\u67b6\u7684\u5e95\u5c42\u662f\u4e00\u5957\u51fd\u6570\u6307\u9488\uff0c\u5982\u4e0b\uff1a typedef struct sal_module_st { int (*init)(void); int (*get_local_mac)(char *mac); int (*get_local_ip)(char *ip, char *gw, char *mask); int (*parse_domain)(const char *host_name, char *host_ip, size_t host_ip_len); int (*connect)(const char *ip, const char *port, sal_proto_t proto); int (*send)(int sock, const void *buf, size_t len); int (*recv_timeout)(int sock, void *buf, size_t len, uint32_t timeout); int (*recv)(int sock, void *buf, size_t len); int (*sendto)(int sock, char *ip, char *port, const void *buf, size_t len); int (*recvfrom)(int sock, void *buf, size_t len); int (*recvfrom_timeout)(int sock, void *buf, size_t len, uint32_t timeout); int (*close)(int sock); } sal_module_t; \u4e0d\u540c\u7684\u901a\u4fe1\u6a21\u7ec4\u9a71\u52a8\u90fd\u53bb\u5b9e\u73b0\u8fd9\u4e00\u5957\u51fd\u6570\u6307\u9488\u5373\u53ef\uff0cTencentOS-tiny\u5b98\u65b9\u5df2\u7ecf\u63d0\u4f9b\u4e86\u975e\u5e38\u591a\u7684\u901a\u4fe1\u6a21\u7ec4\u9a71\u52a8\u5b9e\u73b0SAL\u6846\u67b6\uff0c\u8986\u76d6\u5e38\u7528\u7684\u901a\u4fe1\u65b9\u5f0f\uff0c\u6bd4\u59822G\u30014G Cat.4\u30014G Cat.1\u3001NB-IoT\u7b49\uff0c\u5728 devices \u6587\u4ef6\u5939\u4e0b\uff1a air724 bc26 bc25_28_95 bc35_28_95_lwm2m ec20 esp8266 m26 m5310a m6312 sim800a sim7600ce \u6b22\u8fce\u8d21\u732e\u66f4\u591a\u9a71\u52a8... 3.3. SAL\u6846\u67b6\u63d0\u4f9b\u7684\u7f51\u7edc\u7f16\u7a0bAPI \u6ce8\u518c\u8be5\u6a21\u7ec4\u5b9e\u73b0\u5230SAL\u6846\u67b6 int tos_sal_module_register(sal_module_t *module); \u53c2\u6570 \u4f5c\u7528 module \u6a21\u7ec4\u5b9e\u73b0\u7684\u51fd\u6570\u6307\u9488\u7ed3\u6784\u4f53\u53e5\u67c4 \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u6a21\u7ec4\u521d\u59cb\u5316 int tos_sal_module_init(void); \u53c2\u6570 \u4f5c\u7528 \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u57df\u540d\u89e3\u6790 int tos_sal_module_parse_domain(const char *host_name, char *host_ip, size_t host_ip_len); \u53c2\u6570 \u4f5c\u7528 host_name \u57df\u540d host_ip \u5b58\u653e\u89e3\u6790\u51fa\u7684ip\u7f13\u51b2\u533a host_ip_len \u7f13\u51b2\u533a\u5927\u5c0f \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u5efa\u7acb TCP/UDP socket\u8fde\u63a5 int tos_sal_module_connect(const char *ip, const char *port, sal_proto_t proto); \u53c2\u6570 \u4f5c\u7528 ip \u76ee\u7684\u4e3b\u673aip port \u76ee\u7684\u4e3b\u673aport proto \u534f\u8bae\u7c7b\u578b\uff1aTOS_SAL_PROTO_TCP\u6216\u8005TOS_SAL_PROTO_UDP \u8fd4\u56de\u503c \u6210\u529f\uff1asocket id\uff0c\u5931\u8d25\uff1a-1 TCP socket\u53d1\u9001\u6570\u636e int tos_sal_module_send(int sock, const void *buf, size_t len); \u53c2\u6570 \u4f5c\u7528 sock socket id buf \u5f85\u53d1\u9001\u6570\u636e len \u5f85\u53d1\u9001\u6570\u636e\u957f\u5ea6 \u8fd4\u56de\u503c \u6210\u529f\uff1a\u5b9e\u9645\u53d1\u9001\u6570\u636e\u7684\u957f\u5ea6\uff0c\u5931\u8d25\uff1a-1 TCP socket\u63a5\u6536\u6570\u636e int tos_sal_module_recv(int sock, void *buf, size_t len); int tos_sal_module_recv_timeout(int sock, void *buf, size_t len, uint32_t timeout); \u53c2\u6570 \u4f5c\u7528 sock socket id buf \u5b58\u653e\u63a5\u6536\u6570\u636e\u7684\u7f13\u51b2\u533a len \u7f13\u51b2\u533a\u957f\u5ea6 timeout \u7b49\u5f85\u8d85\u65f6\u65f6\u95f4 \u8fd4\u56de\u503c \u6210\u529f\uff1a\u5b9e\u9645\u8bfb\u53d6\u6570\u636e\u7684\u957f\u5ea6\uff0c\u5931\u8d25\uff1a-1 UDP socket\u53d1\u9001\u6570\u636e int tos_sal_module_sendto(int sock, char *ip, char *port, const void *buf, size_t len); \u53c2\u6570 \u4f5c\u7528 sock socket id ip \u76ee\u7684\u4e3b\u673aip port \u76ee\u7684\u4e3b\u673aport buf \u5f85\u53d1\u9001\u6570\u636e len \u5f85\u53d1\u9001\u6570\u636e\u957f\u5ea6 \u8fd4\u56de\u503c \u6210\u529f\uff1a\u5b9e\u9645\u53d1\u9001\u6570\u636e\u7684\u957f\u5ea6\uff0c\u5931\u8d25\uff1a-1 UDP socket\u63a5\u6536\u6570\u636e int tos_sal_module_recvfrom(int sock, void *buf, size_t len); int tos_sal_module_recvfrom_timeout(int sock, void *buf, size_t len, uint32_t timeout); \u53c2\u6570 \u4f5c\u7528 sock socket id buf \u5b58\u653e\u63a5\u6536\u6570\u636e\u7684\u7f13\u51b2\u533a len \u7f13\u51b2\u533a\u957f\u5ea6 timeout \u7b49\u5f85\u8d85\u65f6\u65f6\u95f4 \u8fd4\u56de\u503c \u6210\u529f\uff1a\u5b9e\u9645\u8bfb\u53d6\u6570\u636e\u7684\u957f\u5ea6\uff0c\u5931\u8d25\uff1a-1 \u5173\u95edsocket int tos_sal_module_close(int sock); \u53c2\u6570 \u4f5c\u7528 sock socket id \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 4. AT\u6846\u67b6+SAL\u6846\u67b6\u79fb\u690d\u65b9\u6cd5 4.1. \u79fb\u690d\u524d\u7684\u51c6\u5907 \u672c\u6587\u4e2d\u6211\u4f7f\u7528\u5b98\u65b9EVB_MX+\u5f00\u53d1\u677f\u4e3a\u4f8b\uff0c\u4e3b\u63a7\u82af\u7247\u4e3aSTM32L431RCT6\uff0cUSART1\u7528\u4e8eprintf\u6253\u5370\u65e5\u5fd7\u4fe1\u606f\uff0cLPUART1\u7528\u4e8e\u548c\u901a\u4fe1\u6a21\u7ec4\u4ea4\u4e92\uff0c\u901a\u4fe1\u6a21\u7ec4\u4f7f\u7528 WIFI \u6a21\u7ec4 ESP8266\u4e3a\u4f8b\u3002 \u79fb\u690dAT\u6846\u67b6\u524d\u9700\u8981\u51c6\u5907\u597d\u4e00\u4e2a\u79fb\u690d\u597dTencentOS-tiny\u5185\u6838\u7684\u5de5\u7a0b\uff0c\u53ef\u4ee5\u505a\u5230\u4e32\u53e3\u7684\u6b63\u5e38\u6536\u53d1\uff0c\u8fd9\u91cc\u6211\u4f7f\u7528 TencentOS-tiny \u4e2d TencentOS-tiny\\board\\TencentOS_tiny_EVB_MX_Plus\\KEIL\\hello_world \u4e2d\u7684\u5de5\u7a0b\u3002 4.2. \u79fb\u690dAT\u6846\u67b6 TencentOS-tiny AT \u6846\u67b6\u7684\u5b9e\u73b0\u5728 net/at \u76ee\u5f55\u4e0b\u7684 tos_at.h \u548c tos_at.c \u4e24\u4e2a\u6587\u4ef6\u4e2d\uff0cTencentOS-tiny AT\u6846\u67b6\u5e95\u5c42\u4f7f\u7528\u7684\u4e32\u53e3\u9a71\u52a8HAL\u5c42\u5728 platform\\hal\\st\\stm32l4xx\\src \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6 tos_hal_uart.c \u4e2d\uff0c\u5934\u6587\u4ef6\u5728 kernel\\hal\\include \u8def\u5f84\u4e2d\u3002 \u9996\u5148\u5c06\u8fd9\u4e24\u4e2ac\u6587\u4ef6\u6dfb\u52a0\u5230Keil\u5de5\u7a0b\u4e2d\uff1a \u7136\u540e\u5c06\u5934\u6587\u4ef6\u8def\u5f84\u6dfb\u52a0\u5230Keil MDK\u4e2d\uff1a \u7136\u540e\u5728\u4e32\u53e3\u4e2d\u65ad\u4e2d\u914d\u7f6e\u8c03\u7528AT\u6846\u67b6\u7684\u5b57\u8282\u63a5\u6536\u51fd\u6570\uff0c\u7f16\u8f91 stm32l4xx_it.c \u6587\u4ef6\uff1a \u2460 \u6dfb\u52a0AT\u6846\u67b6\u7684\u5934\u6587\u4ef6\uff1a /* Private includes ----------------------------------------------------------*/ /* USER CODE BEGIN Includes */ #include \"tos_at.h\" /* USER CODE END Includes */ \u2461 \u5728\u6587\u4ef6\u6700\u540e\u6dfb\u52a0\u4e32\u53e3\u4e2d\u65ad\u56de\u8c03\u51fd\u6570\uff1a /* USER CODE BEGIN 1 */ void HAL_UART_RxCpltCallback(UART_HandleTypeDef *huart) { extern uint8_t data; if (huart->Instance == LPUART1) { HAL_UART_Receive_IT(&hlpuart1, &data, 1); tos_at_uart_input_byte(data); } } /* USER CODE END 1 */ \u6ce8\u610f\uff0c\u5728\u56de\u8c03\u51fd\u6570\u4e2d\u58f0\u660edata\u53d8\u91cf\u5728\u5916\u90e8\u5b9a\u4e49\uff0c\u8fd9\u662f\u56e0\u4e3aSTM32 HAL\u5e93\u7684\u673a\u5236\uff0c\u9700\u8981\u5728\u521d\u59cb\u5316\u5b8c\u6210\u4e4b\u540e\u5148\u8c03\u7528\u4e00\u6b21\u4e32\u53e3\u63a5\u6536\u51fd\u6570\uff0c\u4f7f\u80fd\u4e32\u53e3\u63a5\u6536\u4e2d\u65ad\uff0c\u7f16\u8f91 usart.c \u6587\u4ef6\uff1a \u2460 \u5728\u6587\u4ef6\u5f00\u5934\u5b9a\u4e49data\u53d8\u91cf\u4e3a\u5168\u5c40\u53d8\u91cf\uff1a /* USER CODE BEGIN 0 */ uint8_t data; /* USER CODE END 0 */ \u2461 \u5728\u4e32\u53e3\u521d\u59cb\u5316\u5b8c\u6210\u4e4b\u540e\u4f7f\u80fd\u63a5\u6536\u4e2d\u65ad\uff1a /* LPUART1 init function */ void MX_LPUART1_UART_Init(void) { hlpuart1.Instance = LPUART1; hlpuart1.Init.BaudRate = 115200; hlpuart1.Init.WordLength = UART_WORDLENGTH_8B; hlpuart1.Init.StopBits = UART_STOPBITS_1; hlpuart1.Init.Parity = UART_PARITY_NONE; hlpuart1.Init.Mode = UART_MODE_TX_RX; hlpuart1.Init.HwFlowCtl = UART_HWCONTROL_NONE; hlpuart1.Init.OneBitSampling = UART_ONE_BIT_SAMPLE_DISABLE; hlpuart1.AdvancedInit.AdvFeatureInit = UART_ADVFEATURE_NO_INIT; if (HAL_UART_Init(&hlpuart1) != HAL_OK) { Error_Handler(); } //\u624b\u52a8\u6dfb\u52a0\uff0c\u4f7f\u80fd\u4e32\u53e3\u4e2d\u65ad HAL_UART_Receive_IT(&hlpuart1, &data, 1); } 4.3. \u79fb\u690dSAL\u6846\u67b6 TencentOS-tiny SAL\u6846\u67b6\u7684\u5b9e\u73b0\u5728 net/sal_module_wrapper \u8def\u5f84\u4e2d\uff0c\u4ec5\u6709\u4e24\u4e2a\u6587\u4ef6\uff1a sal_module_wrapper.h \u548c sal_module_wrapper.c \u3002 \u5c06c\u6587\u4ef6\u6dfb\u52a0\u5230Keil MDK\u5de5\u7a0b\u4e2d\uff1a \u5c06\u5934\u6587\u4ef6\u6240\u5728\u8def\u5f84\u6dfb\u52a0\u5230Keil MDK\u4e2d\uff1a 4.4. \u79fb\u690d\u901a\u4fe1\u6a21\u7ec4\u9a71\u52a8 TencentOS-tiny\u5b98\u65b9\u5df2\u7ecf\u63d0\u4f9b\u4e86\u975e\u5e38\u591a\u7684\u901a\u4fe1\u6a21\u7ec4\u9a71\u52a8\u5b9e\u73b0SAL\u6846\u67b6\uff0c\u8986\u76d6\u5e38\u7528\u7684\u901a\u4fe1\u65b9\u5f0f\uff0c\u6bd4\u59822G\u30014G Cat.4\u30014G Cat.1\u3001NB-IoT\u7b49\uff0c\u5728 devices \u6587\u4ef6\u5939\u4e0b,\uff1a air724 bc26 bc25_28_95 bc35_28_95_lwm2m ec20 esp8266 m26 m5310a m6312 sim800a sim7600ce \u6b22\u8fce\u8d21\u732e\u66f4\u591a\u9a71\u52a8... \u56e0\u4e3a\u8fd9\u4e9b\u9a71\u52a8\u90fd\u662fSAL\u6846\u67b6\u7684\u5b9e\u73b0\uff0c\u6240\u4ee5\u8fd9\u4e9b\u901a\u4fe1\u6a21\u7ec4\u7684\u9a71\u52a8\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u786c\u4ef6\u60c5\u51b5 \u9009\u62e9\u4e00\u79cd\u52a0\u5165\u5230\u5de5\u7a0b\u4e2d \uff0c\u8fd9\u91cc\u6211\u4ee5 WIFI \u6a21\u7ec4 ESP8266\u4e3a\u4f8b\uff0c\u6f14\u793a\u5982\u4f55\u52a0\u5165\u901a\u4fe1\u6a21\u7ec4\u9a71\u52a8\u5230\u5de5\u7a0b\u4e2d\u3002 ESP8266\u7684\u9a71\u52a8\u5728 devices\\esp8266 \u76ee\u5f55\u4e2d\u3002 \u9996\u5148\u5c06 esp8266.c \u6587\u4ef6\u52a0\u5165\u5230Keil MDK\u5de5\u7a0b\u4e2d\uff1a \u7136\u540e\u5c06 esp8266.h \u5934\u6587\u4ef6\u6240\u5728\u8def\u5f84\u6dfb\u52a0\u5230Keil MDK\u5de5\u7a0b\u4e2d\uff1a \u79fb\u690d\u5b8c\u6210\u3002 4.5. \u6d4b\u8bd5\u7f51\u7edc\u901a\u4fe1 \u79fb\u690d\u5b8c\u6210\u4e4b\u540e\uff0c\u53ef\u76f4\u63a5\u4f7f\u7528\u5b98\u65b9\u63d0\u4f9b\u7684\u793a\u4f8b\u4ee3\u7801\u8fdb\u884c\u6d4b\u8bd5\uff0c\u6d4b\u8bd5\u53ccsocket\u8fdb\u884cTCP\u901a\u4fe1\u7684\u6d4b\u8bd5\u7a0b\u5e8f\u4e3a examples\\tcp_through_module\\tcp_through_module.c \u3002 \u5c06\u5de5\u7a0b\u4e2d\u7684 helloworld \u793a\u4f8b\u4ee3\u7801\u66f4\u6362\u4e3a\u8be5\u6587\u4ef6\uff0c\u5982\u56fe\uff1a \u5728\u8fd9\u4e2a\u793a\u4f8b\u4e2d\uff0c\u9996\u5148\u901a\u8fc7\u5b8f\u5b9a\u4e49\u6765\u914d\u7f6e\u5f53\u524d\u4f7f\u7528\u7684\u662f\u54ea\u4e2a\u6a21\u7ec4\uff1a \u7136\u540e\u8c03\u7528\u5bf9\u5e94\u6a21\u7ec4\u7684\u521d\u59cb\u5316\u51fd\u6570\uff1a \u6b64\u5904\u9700\u8981\u6ce8\u610f\uff1a\u521d\u59cb\u5316\u6a21\u7ec4\u65f6\u6307\u5b9a\u7684\u4e32\u53e3\u53f7\u5373\u4e3aAT\u901a\u4fe1\u6a21\u7ec4\u6240\u4f7f\u7528\u7684\u4e32\u53e3\uff0c\u5728 tos_hal_uart.h \u4e2d\u5b9a\u4e49\uff1a typedef enum hal_uart_port_en { HAL_UART_PORT_0 = 0, //\u5bf9\u5e94LPUART1 HAL_UART_PORT_1, //\u5bf9\u5e94USART1 HAL_UART_PORT_2, //\u4f9d\u6b64\u7c7b\u63a8 HAL_UART_PORT_3, HAL_UART_PORT_4, HAL_UART_PORT_5, HAL_UART_PORT_6, } hal_uart_port_t; \u6700\u540e\u4fee\u6539\u4e24\u4e2aTCP Socket \u7684ip\u548c\u7aef\u53e3\u4e3a\u81ea\u5df1\u6d4b\u8bd5\u670d\u52a1\u5668\u7684ip\u548c\u7aef\u53e3\uff1a socket_id_0 = tos_sal_module_connect(\"117.50.111.72\", \"8080\", TOS_SAL_PROTO_TCP); socket_id_1 = tos_sal_module_connect(\"117.50.111.72\", \"8001\", TOS_SAL_PROTO_TCP); TCP\u6d4b\u8bd5\u670d\u52a1\u5668\u9700\u8981\u81ea\u5df1\u642d\u5efa\u6216\u8005\u4f7f\u7528\u4e00\u4e9b\u5c0f\u5de5\u5177\uff0c\u6b64\u5904\u4e0d\u518d\u8be6\u8ff0\u3002 \u4fee\u6539\u5b8c\u6210\u4e4b\u540e\uff0c\u7f16\u8bd1\u7a0b\u5e8f\uff0c\u70e7\u5f55\u5230\u5f00\u53d1\u677f\u4e2d\uff0c\u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u67e5\u770b\u7ed3\u679c\uff1a \u5728 socket0 \u7684\u670d\u52a1\u7aef\u67e5\u770b\u6a21\u7ec4\u53d1\u9001\u7684\u6d88\u606f\uff1a \u5728 socket1 \u7684\u670d\u52a1\u7aef\u67e5\u770b\u6a21\u7ec4\u53d1\u9001\u7684\u6d88\u606f\uff1a \u81f3\u6b64\uff0c\u6d4b\u8bd5\u5b8c\u6210\u3002 5. \u5982\u4f55\u9002\u914d\u4e00\u4e2a\u65b0\u7684\u901a\u4fe1\u6a21\u7ec4\u9a71\u52a8 \u57fa\u4e8e\u6a21\u7ec4\u7684AT\u6307\u4ee4\u96c6\uff0c\u4f7f\u7528 TencentOS-tiny AT \u6846\u67b6\u4e0e\u6a21\u7ec4\u4ea4\u4e92\uff0c\u5b9e\u73b0SAL\u6846\u67b6\u6240\u5b9a\u4e49\u7684\u51fd\u6570\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u79f0\u4e3a\u901a\u4fe1\u6a21\u7ec4\u9002\u914d\u3002 \u672c\u6587\u4e2d\u6211\u4ee5\u79fb\u8fdc\u901a\u4fe1\u76844G\u901a\u4fe1\u6a21\u7ec4 EC20 \u4f5c\u4e3a\u793a\u4f8b\uff0c\u8bb2\u8ff0\u4e00\u4e2a\u5168\u65b0\u7684\u901a\u4fe1\u6a21\u7ec4\u9002\u914d\u6d41\u7a0b\u3002 Step1. \u4f7f\u7528\u4e32\u53e3\u52a9\u624b\u8c03\u8bd5\uff0c\u719f\u6089\u8be5\u6a21\u7ec4\u7684AT\u6307\u4ee4\u96c6 \u9002\u914dSAL\u5c42\u9700\u8981\u719f\u6089\u6a21\u7ec4\u7684\u4e09\u7c7bAT\u6307\u4ee4\uff1a \u57fa\u672c\u67e5\u8be2\u914d\u7f6e\u6307\u4ee4 TCP/IP\u7f51\u7edc\u534f\u8bae\u6808AT\u6307\u4ee4 TCP/IP\u7f51\u7edc\u534f\u8bae\u6808\u6570\u636e\u63a5\u6536\u673a\u5236 \u6bd4\u5982EC20\u76f8\u5173\u7684AT\u6307\u4ee4\u5982\u4e0b\uff1a \u2460 \u57fa\u672c\u67e5\u8be2\u914d\u7f6e\u6307\u4ee4 \u6d4b\u8bd5AT\u6307\u4ee4\u662f\u5426\u6b63\u5e38\uff1f AT OK \u67e5\u8be2SIM\u5361\u662f\u5426\u6b63\u5e38\uff1f AT+CPIN? +CPIN: READY OK \u67e5\u8be2\u6a21\u7ec4\u7684\u4fe1\u53f7\u5f3a\u5ea6 AT+CSQ +CSQ: 17,0 OK \u67e5\u8be2\u6a21\u7ec4\u662f\u5426\u6ce8\u518c\u5230GSM\u7f51\u7edc AT+CREG? +CREG: 0,1 OK \u67e5\u8be2\u6a21\u7ec4\u662f\u5426\u6ce8\u518c\u4e0aGPRS\u7f51\u7edc AT+CGREG? +CGREG: 0,1 OK \u8bbe\u7f6eGPRS\u7684APN AT+QICSGP=1,1,\"CMNET\" OK \u6fc0\u6d3b\u79fb\u52a8\u573a\u666f AT+QIACT=1 OK \u2461 TCP/IP\u7f51\u7edc\u534f\u8bae\u6808AT\u6307\u4ee4 TCP/IP\u7f51\u7edc\u534f\u8bae\u6808\u81f3\u5c11\u9700\u8981TCP/UDP socket\u7684\u901a\u4fe1AT\u6307\u4ee4\uff0c\u5176\u5b83\u4e0a\u5c42\u534f\u8bae\u7684AT\u6307\u4ee4\u6682\u65f6\u4e0d\u7528\u3002 \u5efa\u7acbSocket AT+QIOPEN=1,0,\"TCP\",\"117.50.111.72\",8902,0,0 OK +QIOPEN: 0,0 \u5728\u5efa\u7acbsocket\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\uff0c\u6709\u7684\u901a\u4fe1\u6a21\u7ec4\u9700\u8981\u63d0\u524d\u4f7f\u7528AT\u6307\u4ee4\u914d\u7f6e\u5355\u94fe\u8def\u6a21\u5f0f\u8fd8\u662f\u591a\u94fe\u8def\u6a21\u5f0f\uff08eg. ESP8266\uff09,\u800c\u6709\u7684\u901a\u4fe1\u6a21\u7ec4\u9ed8\u8ba4\u76f4\u63a5\u652f\u6301\u591a\u94fe\u8def\u6a21\u5f0f\uff0c\u65e0\u9700\u914d\u7f6e\u3002 \u53d1\u9001\u6570\u636e AT+QISEND=0 > hello<0x1a> SEND OK \u53d1\u9001\u6570\u636e\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\uff0c\u6709\u7684\u901a\u4fe1\u6a21\u7ec4\u53d1\u9001\u6570\u636e\u4f7f\u7528ASCII\u5b57\u7b26(eg. ESP8266\u3001EC20\u7b49)\uff0c\u800c\u6709\u7684\u901a\u4fe1\u6a21\u7ec4\u53d1\u9001\u6570\u636e\u4f7f\u7528\u5341\u516d\u8fdb\u5236\uff08eg. NB-IoT\u7c7b\u6a21\u7ec4\uff09 \u63a5\u6536\u6570\u636e \u63a5\u4e0b\u6765\u7684\u4e00\u8282\u91cd\u70b9\u8bb2\u8ff0\u3002 \u5173\u95edSocket AT+QICLOSE=0 OK \u2462 TCP/IP\u7f51\u7edc\u534f\u8bae\u6808\u6570\u636e\u63a5\u6536\u673a\u5236 \u901a\u4fe1\u6a21\u7ec4\u5728\u63a5\u6536\u5230\u670d\u52a1\u5668\u53d1\u6765\u7684\u6570\u636e\u65f6\uff0c\u4f1a\u6709\u4e24\u79cd\u65b9\u5f0f\u4e0a\u62a5\u7ed9MCU\uff1a \u4f7f\u7528\u56fa\u5b9a\u7684IP\u5934\u4e0a\u62a5socket id\u548c\u6570\u636e\u957f\u5ea6\uff0c\u9700\u8981\u518d\u6b21\u53bb\u8bfb\u53d6\u6570\u636e(\u7f13\u51b2\u6a21\u5f0f\u63a5\u6536) //\u6a21\u7ec4\u4e0a\u62a5 +QIURC: \"recv\",0 //MCU\u53d1\u51faAT\u6307\u4ee4\u53bb\u8bfb\u53d6\u6570\u636e AT+QIRD=0,1500 +QIRD: 14 Hello, client! OK \u4f7f\u7528\u56fa\u5b9a\u7684IP\u5934\u4e0a\u62a5socket id\u548c\u6570\u636e\u957f\u5ea6\uff0c\u540c\u65f6\u4e00\u8d77\u4e0a\u62a5\u6570\u636e(\u76f4\u63a5\u6a21\u5f0f\u63a5\u6536) +QIURC: \"recv\",0,14 Hello, client! \u6709\u7684\u6a21\u7ec4\u53ea\u652f\u6301\u67d0\u4e00\u79cd\u6a21\u5f0f\uff0c\u6709\u7684\u6a21\u7ec4\u4e24\u79cd\u6a21\u5f0f\u90fd\u652f\u6301\uff0c\u53ef\u4ee5\u81ea\u5df1\u914d\u7f6e\uff0c\u5bf9\u4e8eTencentOS-tiny\u7684AT\u6846\u67b6\u6765\u8bf4\uff0c\u7b2c\u4e8c\u79cd\u76f4\u63a5\u4e0a\u62a5\u6a21\u5f0f\u89e3\u6790\u8d77\u6765\u4f1a\u66f4\u52a0\u65b9\u4fbf\u3002 Step2. \u4e09\u7c7bAT\u6307\u4ee4\uff0c\u4e09\u79cd\u5b9e\u73b0\u65b9\u5f0f \u4e0a\u9762\u8bb2\u8ff0\u4e86\u9002\u914dSAL\u5c42\u9700\u8981\u719f\u6089\u6a21\u7ec4\u7684\u4e09\u7c7bAT\u6307\u4ee4\uff1a\u57fa\u672c\u67e5\u8be2\u914d\u7f6e\u6307\u4ee4\u3001TCP/IP\u7f51\u7edc\u534f\u8bae\u6808AT\u6307\u4ee4\u3001TCP/IP\u7f51\u7edc\u534f\u8bae\u6808\u6570\u636e\u63a5\u6536\u673a\u5236\uff0c\u8fd9\u8282\u8bb2\u8ff0\u5982\u4f55\u4f7f\u7528AT\u6846\u67b6\u5b9e\u73b0\u8fd9\u4e09\u7c7bAT\u6307\u4ee4\u3002 \u2460 \u53ea\u9700\u8981\u5224\u65ad\u662f\u5426\u8fd4\u56deOK\u7684AT\u6307\u4ee4 \u8fd9\u4e00\u7c7bAT\u6307\u4ee4\u7684\u5b9e\u73b0\u51fd\u6570\u9664\u4e86\u6307\u4ee4\u5185\u5bb9\u4e0d\u540c\uff0c\u522b\u7684\u90fd\u76f8\u540c\uff0c\u6bd4\u5982\u5173\u95ed\u56de\u663e\u7684AT\u6307\u4ee4\uff1a ATE0 OK \u5bf9\u5e94\u7684\u5b9e\u73b0\u65b9\u6cd5\u5982\u4e0b\uff1a static int ec20_echo_close(void) { at_echo_t echo; /* \u521b\u5efa\u4e00\u4e2aecho \u5bf9\u8c61\uff0c\u7f13\u51b2\u533a\u4e3aNULL\uff0c\u671f\u671b\u5b57\u7b26\u4e32\u4e3aNULL */ tos_at_echo_create(&echo, NULL, 0, NULL); /* \u6267\u884cAT\u547d\u4ee4\uff0c\u8d85\u65f6\u65f6\u957f1000ms */ tos_at_cmd_exec(&echo, 1000, \"ATE0\\r\\n\"); /* \u5224\u65ad\u6267\u884c\u7ed3\u679c\u662f\u5426\u4e3aOK */ if (echo.status == AT_ECHO_STATUS_OK) { return 0; } return -1; } \u2461 \u9700\u8981\u5224\u65ad\u662f\u5426OK\uff0c\u4e5f\u9700\u8981\u89e3\u6790\u6267\u884c\u7ed3\u679c\u7684AT\u6307\u4ee4 \u8fd9\u4e00\u7c7bAT\u6307\u4ee4\u7684\u5b9e\u73b0\u51fd\u6570\u4e2d\uff0c\u4e0d\u540c\u70b9\u5728\u4e8e\uff0c\u521b\u5efaecho\u5bf9\u8c61\u7684\u65f6\u5019\u9700\u8981\u4f20\u5165\u4e00\u4e2abuffer\u6765\u5b58\u653e\u6307\u4ee4\u6267\u884c\u7684\u7ed3\u679c\uff0c\u6bd4\u5982\u67e5\u8be2\u4fe1\u53f7\u5f3a\u5ea6\u7684AT\u6307\u4ee4\uff1a AT+CSQ +CSQ: 17,0 OK \u5bf9\u5e94\u7684\u5b9e\u73b0\u65b9\u6cd5\u5982\u4e0b\uff1a static int ec20_signal_quality_check(void) { int rssi, ber; at_echo_t echo; char echo_buffer[32], *str; int try = 0; /* \u521b\u5efaecho\u5bf9\u8c61\uff0c\u4f20\u5165\u4e00\u4e2a\u7f13\u51b2\u533a\u5b58\u653eAT\u547d\u4ee4\u6267\u884c\u7ed3\u679c */ tos_at_echo_create(&echo, echo_buffer, sizeof(echo_buffer), NULL); /* \u5c1d\u8bd5\u68c0\u6d4b10\u6b21\uff0c\u4e00\u65e6\u6709\u4e00\u6b21\u6b63\u5e38\uff0c\u8fd4\u56de */ while (try++ < 10) { /* \u6267\u884cAT\u547d\u4ee4\uff0c\u8d85\u65f6\u65f6\u957f1000ms */ tos_at_cmd_exec(&echo, 1000, \"AT+CSQ\\r\\n\"); /* \u5224\u65ad\u6267\u884c\u7ed3\u679c\u662f\u5426\u8fd4\u56de\u4e86OK */ if (echo.status != AT_ECHO_STATUS_OK) { return -1; } /* \u4eceAT\u6307\u4ee4\u7684\u6267\u884c\u7ed3\u679c\u4e2d\u89e3\u6790\u63d0\u53d6CSQ\u503c\u8fdb\u884c\u5224\u65ad */ str = strstr(echo.buffer, \"+CSQ:\"); sscanf(str, \"+CSQ:%d,%d\", &rssi, &ber); if (rssi != 99) { return 0; } } return -1; } \u2462 \u6a21\u7ec4\u4e3b\u52a8\u4e0a\u62a5\u7684\u6570\u636e\u5904\u7406 \u8fd9\u4e00\u7c7bAT\u6307\u4ee4\u5bf9\u5e94TCP/IP\u534f\u8bae\u6808\u63a5\u6536\u6570\u636e\u7684\u4e0a\u62a5\u673a\u5236\uff0c\u4f7f\u7528AT\u6846\u67b6\u7684\u4e8b\u4ef6\u673a\u5236\u8fdb\u884c\u5904\u7406\u3002 \u9996\u5148\u5c06\u56fa\u5b9a\u7684ip\u5934\u548c\u4e8b\u4ef6\u5904\u7406\u56de\u8c03\u51fd\u6570\u6ce8\u518c\uff1a at_event_t ec20_at_event[] = { { \"+QIURC: \\\"recv\\\",\", ec20_incoming_data_process}, //\u5904\u7406\u8fdc\u7a0b\u670d\u52a1\u5668\u53d1\u6765\u7684\u6570\u636e { \"+QIURC: \\\"dnsgip\\\",\", ec20_domain_data_process}, //\u5904\u7406\u57df\u540d\u89e3\u6790\u7ed3\u679c\uff0c\u6682\u65f6\u4e0d\u7ba1 }; \u4e8b\u4ef6\u5904\u7406\u56de\u8c03\u51fd\u6570\u81ea\u5df1\u7f16\u5199\uff0c\u4e3b\u8981\u4f5c\u7528\u662f\u63d0\u53d6\u6a21\u7ec4\u4e0a\u62a5\u7684scoketid\u3001\u6570\u636e\u957f\u5ea6\u3001\u6570\u636e\u5185\u5bb9\uff0c\u7136\u540e\u5c06\u6570\u636e\u5185\u5bb9\u5199\u5165\u5230\u5bf9\u5e94socket id \u7684channel\u4e2d\u3002 \u9700\u8981\u6ce8\u610f\uff0cAT\u6846\u67b6\u4e00\u65e6\u8bfb\u53d6\u89e3\u6790\u5230\u56fa\u5b9a\u7684IP\u5934\uff0c\u5219\u505c\u6b62\u89e3\u6790\uff0c\u62c9\u8d77\u5bf9\u5e94\u7684\u56de\u8c03\u51fd\u6570\uff0c\u6240\u4ee5\u5728\u56de\u8c03\u51fd\u6570\u4e2d\u53ef\u4ee5\u7ee7\u7eed\u4ece\u7f13\u51b2\u533a\u4e2d\u4e00\u8fb9\u8bfb\u53d6\u4e00\u8fb9\u89e3\u6790\u3002 \u89e3\u6790\u793a\u4f8b\u5982\u4e0b\uff1a __STATIC__ void ec20_incoming_data_process(void) { uint8_t data; int channel_id = 0, data_len = 0, read_len; uint8_t buffer[128]; /* \u6a21\u7ec4\u4e0a\u62a5\u7684\u6570\u636e\u683c\u5f0f\uff1a +QIURC: \"recv\",<sockid>,<datalen> <data content> */ /* \u6ce8\u518c\u7684ip\u5934\u662f\uff1a[+QIURC: \"recv\",]\u56de\u8c03\u51fd\u6570\u88ab\u62c9\u8d77\u6267\u884c\u540e\uff0c\u63a5\u7740\u5904\u7406\u540e\u8fb9\u7684\u6570\u636e\u5373\u53ef */ /* \u8bfb\u53d6\u89e3\u6790socket id */ while (1) { if (tos_at_uart_read(&data, 1) != 1) { return; } if (data == ',') { break; } channel_id = channel_id * 10 + (data - '0'); } /* \u8bfb\u53d6\u89e3\u6790\u6570\u636e\u957f\u5ea6 */ while (1) { if (tos_at_uart_read(&data, 1) != 1) { return; } if (data == '\\r') { break; } data_len = data_len * 10 + (data - '0'); } /* \u8bfb\u53d6'\\r'\u4e4b\u540e\u7684'\\n'\uff0c\u4e0d\u4f5c\u4efb\u4f55\u5904\u7406 */ if (tos_at_uart_read(&data, 1) != 1) { return; } /* \u6839\u636e\u89e3\u6790\u51fa\u7684\u6570\u636e\u957f\u5ea6\u548c\u7f13\u51b2\u533a\u7684\u957f\u5ea6\uff0c\u5faa\u73af\u8bfb\u53d6\u6570\u636e\u5185\u5bb9\uff0c\u5199\u5165\u5230\u5bf9\u5e94 socket id \u7684channel\u4e2d */ do { #define MIN(a, b) ((a) < (b) ? (a) : (b)) read_len = MIN(data_len, sizeof(buffer)); /* \u8bfb\u53d6\u6570\u636e */ if (tos_at_uart_read(buffer, read_len) != read_len) { return; } /* \u5199\u5165\u5230\u5bf9\u5e94\u7684channel\u4e2d */ if (tos_at_channel_write(channel_id, buffer, read_len) <= 0) { return; } data_len -= read_len; } while (data_len > 0); return; } Step3. \u6574\u4f53\u9002\u914d\u6d41\u7a0b \u524d\u4e24\u6b65\u90fd\u662f\u7ec6\u8282\u6027\u7684\u5904\u7406\uff0c\u8fd9\u4e00\u6b65\u4ece\u6574\u4f53\u7684\u89d2\u5ea6\u8bb2\u8ff0\u9002\u914d\u6d41\u7a0b\u3002 \u2460 \u6a21\u7ec4\u521d\u59cb\u5316 static int ec20_init(void) { printf(\"Init ec20 ...\\n\" ); /* \u5173\u95ed\u56de\u663e */ if (ec20_echo_close() != 0) { printf(\"echo close failed,please check your module\\n\"); return -1; } /* \u68c0\u6d4bSIM\u5361\u662f\u5426\u6b63\u5e38 */ if(ec20_sim_card_check() != 0) { printf(\"sim card check failed,please insert your card\\n\"); return -1; } /* \u68c0\u6d4b\u4fe1\u53f7\u5f3a\u5ea6\u662f\u5426\u6b63\u5e38 */ if (ec20_signal_quality_check() != 0) { printf(\"signal quality check status failed\\n\"); return -1; } /* \u68c0\u6d4b\u662f\u5426\u6ce8\u518c\u5230GSM\u7f51\u7edc */ if(ec20_gsm_network_check() != 0) { printf(\"GSM network register status check fail\\n\"); return -1; } /* \u68c0\u6d4b\u662f\u5426\u6ce8\u518c\u5230GPRS\u7f51\u7edc */ if(ec20_gprs_network_check() != 0) { printf(\"GPRS network register status check fail\\n\"); return -1; } /* \u5173\u95edAPN */ if(ec20_close_apn() != 0) { printf(\"close apn failed\\n\"); return -1; } /* \u8bbe\u7f6eAPN\uff0c\u6fc0\u6d3b\u79fb\u52a8\u573a\u666f */ if (ec20_set_apn() != 0) { printf(\"apn set FAILED\\n\"); return -1; } printf(\"Init ec20 ok\\n\" ); return 0; } \u2461 \u5c06\u5b9e\u73b0\u7684\u51fd\u6570\u6620\u5c04\u5230SAL\u6846\u67b6\u4e0a\uff1a sal_module_t sal_module_ec20 = { .init = ec20_init, .connect = ec20_connect, .send = ec20_send, .recv_timeout = ec20_recv_timeout, .recv = ec20_recv, .sendto = ec20_sendto, .recvfrom = ec20_recvfrom, .recvfrom_timeout = ec20_recvfrom_timeout, .close = ec20_close, .parse_domain = ec20_parse_domain, }; \u2462 \u518d\u6b21\u5c01\u88c5\uff0c\u7559\u51fa\u4e00\u4e2a\u5916\u90e8\u8c03\u7528\u63a5\u53e3\uff0c\u4f9b\u4e0a\u5c42\u5e94\u7528\u7a0b\u5e8f\u8c03\u7528\uff1a int ec20_sal_init(hal_uart_port_t uart_port) { /* \u521d\u59cb\u5316AT\u6846\u67b6\u53ca\u5176\u4e32\u53e3 */ if (tos_at_init(uart_port, ec20_at_event, sizeof(ec20_at_event) / sizeof(ec20_at_event[0])) != 0) { return -1; } /* \u5c06\u7b2c\u2461\u6b65\u4e2d\u6620\u5c04\u7684\u51fd\u6570\u5173\u7cfb\uff0c\u6ce8\u518c\u5230SAL\u6846\u67b6 */ if (tos_sal_module_register(&sal_module_ec20) != 0) { return -1; } /* \u8c03\u7528SAL\u521d\u59cb\u5316\u51fd\u6570\uff0c\u56e0\u4e3a\u63a5\u53e3\u548c\u6620\u5c04\u7684\u5b58\u5728\uff0c\u6700\u7ec8\u8c03\u7528\u5230ec20_init */ if (tos_sal_module_init() != 0) { return -1; } return 0; }","title":"27.AT_Firmware_and_SAL_Firmware_User_Guide"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#1","text":"","title":"1. \u6982\u8ff0"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#11","text":"\u968f\u7740\u5d4c\u5165\u5f0f\u7cfb\u7edf\u7ec8\u7aef\u5bf9\u7f51\u7edc\u7684\u9700\u6c42\u8d8a\u6765\u8d8a\u591a\uff0c\u5404\u79cd\u901a\u4fe1\u6a21\u7ec4\u767e\u82b1\u9f50\u653e\uff0c\u51e0\u4e4e\u8986\u76d6\u4e86\u6240\u6709\u7684\u7f51\u7edc\u63a5\u5165\u65b9\u5f0f\uff1aWIFI\u30012G\u30014G Cat.1\u30014G Cat.4\u3001NB-IoT\u3001LoRa\u2026\u2026\u672a\u6765\u8fd8\u4f1a\u6709\u66f4\u591a\u3002 \u5bf9\u4e8e\u5d4c\u5165\u5f0f\u7cfb\u7edf\u7ec8\u7aef\u800c\u8a00\uff0c\u8fd9\u4e9b\u901a\u4fe1\u6a21\u7ec4\u5c4f\u853d\u4e86\u7f51\u7edc\u63a5\u5165\u65b9\u5f0f\u7684\u5dee\u5f02\u5316\uff0c\u65e0\u8bba\u4f7f\u7528\u54ea\u79cd\u65b9\u5f0f\u63a5\u5165\u7f51\u7edc\uff0c\u8bbe\u5907\u4ec5\u4ec5\u9700\u8981\u63d0\u4f9b\u4e00\u4e2a\u4e32\u53e3\u4e0e\u6a21\u7ec4\u4ea4\u4e92\u5373\u53ef\u3002 \u4ea4\u4e92\u53cc\u65b9\u6709\u4e86\u901a\u4fe1\u7684\u786c\u4ef6\u57fa\u7840\uff08\u4e32\u53e3\uff09\uff0c\u8fd8\u9700\u8981\u5236\u5b9a\u548c\u9075\u5faa\u4e00\u5957\u6709\u6548\u7684\u8f6f\u4ef6\u534f\u8bae\uff0c\u76ee\u524d\u5927\u591a\u6570\u6a21\u7ec4\u5382\u5546\u90fd\u91c7\u7528AT\u6307\u4ee4\u96c6\u3002","title":"1.1. \u767e\u82b1\u7efd\u653e\u7684\u901a\u4fe1\u6a21\u7ec4"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#12-at","text":"AT\u6307\u4ee4\u6709\u4e24\u79cd\uff1a \u2460 \u666e\u901aAT\u6307\u4ee4\uff1a\u4ee5AT\u5f00\u5934\u3001\u6362\u884c\u7b26\u7ed3\u675f\u7684\u4e00\u7ec4\u5b57\u7b26\u4e32\uff0c\u6bcf\u4e2a\u6307\u4ee4\u6267\u884c\u6210\u529f\u4e0e\u5426\u90fd\u6709\u76f8\u5e94\u7684\u8fd4\u56de\u3002 ---> AT <--- OK \u2461\u5176\u4ed6\u7684\u4e00\u4e9b\u975e\u9884\u671f\u7684\u4fe1\u606f\uff0c\u6a21\u5757\u5c06\u6709\u5bf9\u5e94\u7684\u4e00\u4e9b\u4fe1\u606f\u63d0\u793a\uff0c\u4e3b\u52a8\u53d1\u9001\uff1a <--- +IPD:... <--- +URC:... AT\u6307\u4ee4\u4ea4\u4e92\u7c7b\u4f3c\u670d\u52a1\u5668/\u5ba2\u6237\u7aef\u67b6\u6784\uff0c\u4e00\u822c\u6765\u8bf4\u6a21\u7ec4\u4fa7\u4f5c\u4e3aAT\u670d\u52a1\u7aef\uff0cMCU\u4fa7\u4f5c\u4e3aAT\u5ba2\u6237\u7aef\uff0c\u4ea4\u4e92\u65b9\u5f0f\u5bf9\u5e94\u4e5f\u6709\u4e24\u79cd\uff1a \u5ba2\u6237\u7aef\u53d1\u51fa\u4e00\u6761AT\u6307\u4ee4\uff0c\u670d\u52a1\u7aef\u6536\u5230\u5904\u7406\u4e4b\u540e\u8fd4\u56de\u7ed3\u679c\u7ed9\u5ba2\u6237\u7aef\uff1b \u670d\u52a1\u7aef\u4e3b\u52a8\u53d1\u9001\u6570\u636e\u7ed9\u5ba2\u6237\u7aef\uff0c\u5ba2\u6237\u7aef\u88ab\u52a8\u63a5\u6536\u5904\u7406\uff1b \u6574\u4f53\u67b6\u6784\u5982\u4e0b\u56fe\uff1a \u6a21\u7ec4\u7684\u529f\u80fd\u975e\u5e38\u4e30\u5bcc\uff0c\u6709\u4fee\u6539\u6a21\u7ec4\u914d\u7f6e\u7684AT\u6307\u4ee4\u3001\u6709TCP/IP\u534f\u8bae\u6808\u901a\u4fe1\u7684AT\u6307\u4ee4\u3001\u751a\u81f3\u8fd8\u6709MQTT\u3001HTTP\u3001NTP\u534f\u8bae\u6808\u7684\u901a\u4fe1\u6307\u4ee4\uff0c\u8fd9\u4e9b\u6307\u4ee4\u5408\u5728\u4e00\u8d77\u6784\u6210\u4e86\u8be5\u6a21\u7ec4\u7684AT\u6307\u4ee4\u96c6\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u540c\u4e00\u5bb6\u5382\u5546\u7684\u4e0d\u540c\u6a21\u7ec4\u4e4b\u95f4\uff0cAT\u6307\u4ee4\u96c6\u5dee\u5f02\u4e0d\u5927\uff0c\u800c\u4e0d\u540c\u5382\u5546\u4e4b\u95f4\u7684AT\u6307\u4ee4\u96c6\u4e4b\u95f4\u5dee\u5f02\u8f83\u5927\u3002","title":"1.2. AT\u6307\u4ee4\u96c6"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#13-at","text":"AT\u6307\u4ee4\u6709\u4e09\u79cd\u89e3\u6790\u65b9\u5f0f\uff1a \u88f8\u673a\u76f4\u63a5\u5728\u4e32\u53e3\u4e2d\u65ad\u5904\u7406\u51fd\u6570\u4e2d\u89e3\u6790 \u56e0\u4e3a\u89e3\u6790\u65f6\u95f4\u672a\u77e5\uff0c\u6240\u4ee5\u8fd9\u79cd\u89e3\u6790\u65b9\u5f0f\u6700\u4e0d\u53ef\u53d6\uff0c\u6781\u5bb9\u6613\u51fa\u73b0\u6570\u636e\u4e22\u5931\u95ee\u9898\u3002 \u88f8\u673a\u4f7f\u7528ringbuff\uff08\u73af\u5f62\u7f13\u51b2\u533a\uff09\u7f13\u5b58\u6570\u636e\uff0c\u5728main\u51fd\u6570\u4e2d\u6784\u9020\u72b6\u6001\u673a\u89e3\u6790 \u4e32\u53e3\u6bcf\u6765\u4e00\u4e2a\u5b57\u7b26\u5c31\u9001\u5165\u7f13\u51b2\u533a\uff0c\u6700\u5927\u7a0b\u5ea6\u4fdd\u8bc1\u6570\u636e\u4e0d\u4f1a\u4e22\u5931\uff0c\u8fd9\u79cd\u89e3\u6790\u65b9\u5f0f\u968f\u7740main\u51fd\u6570\u4e2d\u5176\u5b83\u4e1a\u52a1\u903b\u8f91\u7684\u589e\u591a\uff0c\u5bfc\u81f4\u7f13\u51b2\u533a\u6570\u636e\u8fdf\u8fdf\u5f97\u4e0d\u5230\u89e3\u6790\uff0c\u4f9d\u7136\u4f1a\u51fa\u73b0\u95ee\u9898\u3002 RTOS\u4f7f\u7528ringbuff\u7f13\u5b58\u6570\u636e\uff0c\u521b\u5efa\u4e00\u4e2a\u4efb\u52a1\u4e13\u95e8\u7528\u4e8e\u6570\u636e\u89e3\u6790 \u540c\u6837\uff0c\u4e32\u53e3\u6bcf\u6765\u4e00\u4e2a\u5b57\u7b26\u5c31\u9001\u5165\u7f13\u51b2\u533a\uff0c\u4fdd\u8bc1\u6570\u636e\u4e0d\u4e22\u5931\uff0c\u53ea\u8981\u6570\u636e\u89e3\u6790\u4efb\u52a1\u7684\u4f18\u5148\u7ea7\u591f\u9ad8\uff0c\u6570\u636e\u603b\u662f\u4f1a\u88ab\u53ca\u65f6\u89e3\u6790\uff0c\u5927\u5e45\u63d0\u5347\u7cfb\u7edf\u7684\u5b9e\u65f6\u6027\u80fd\u3002","title":"1.3. AT\u6307\u4ee4\u89e3\u6790\u65b9\u5f0f"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#14-atsal","text":"\u4ec0\u4e48\u662fAT\u6846\u67b6\uff1f\u5176\u5b9e\u5e76\u4e0d\u795e\u79d8~ AT\u6846\u67b6\u662fRTOS\u5b98\u65b9\u4eba\u5458/\u793e\u533a\u5f00\u53d1\u8005\u7f16\u5199\u7684\u4e00\u4e2a\u901a\u7528AT\u6307\u4ee4\u89e3\u6790\u4efb\u52a1\uff0c\u4f7f\u5f00\u53d1\u8005\u53ea\u9700\u8981\u8c03\u7528 AT \u6846\u67b6\u63d0\u4f9b\u7684 API \u5373\u53ef\u5904\u7406\u4e0e\u6a21\u7ec4\u7684\u4ea4\u4e92\u6570\u636e\u3002 SAL\u6846\u67b6\u5168\u79f0Socket Abstract Layer\uff0c\u63d0\u4f9b\u4e86\u7c7b\u4f3csocket\u7f51\u7edc\u7f16\u7a0b\u7684\u62bd\u8c61\u5c42\u3002\u57fa\u4e8eAT\u6846\u67b6\u5b9e\u73b0SAL\u7684\u5e95\u5c42\u51fd\u6570\u53eb\u505a\u901a\u4fe1\u6a21\u7ec4\u7684\u9a71\u52a8\u7a0b\u5e8f\u3002","title":"1.4. AT\u6846\u67b6\u4e0eSAL\u5c42"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#2-tencentos-tinyat","text":"","title":"2. TencentOS-tiny\u7684AT\u6846\u67b6"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#21","text":"","title":"2.1. \u6574\u4f53\u67b6\u6784"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#22","text":"TencentOS-tiny AT \u6846\u67b6\u7684\u5b9e\u73b0\u5728 net/at \u76ee\u5f55\u4e0b\u7684 tos_at.h \u548c tos_at.c \u4e24\u4e2a\u6587\u4ef6\u4e2d\u3002 \u2460 AT\u6846\u67b6\u6240\u6709\u63a5\u6536\u6570\u636e\u7684\u6570\u636e\u6d41\u5411\u5982\u56fe\u6240\u793a\uff1a \u4e32\u53e3\u4e2d\u65ad\u4e2d\u9010\u4e2a\u5b57\u8282\u63a5\u6536\uff0c\u5199\u5165 chr_fifo \u7f13\u51b2\u533a\uff1b \u89e3\u6790\u4efb\u52a1 at_parser \u4ece chr_fifo \u7f13\u51b2\u533a\u4e2d\u9010\u4e2a\u5b57\u8282\u8bfb\u53d6\uff0c\u8bfb\u53d6\u4e00\u884c\u6570\u636e\u5230 recv_cache \uff08\u884c\u7f13\u51b2\u533a\uff09\u5e76\u8fdb\u884c\u5904\u7406\uff1b \u5904\u7406\u4e4b\u540e\u5982\u679c\u4e0d\u662f\u6a21\u7ec4\u4e0a\u62a5\u7684\u666e\u901a\u7684\u6570\u636e\uff0c\u4e5f\u4e0d\u662fAT\u547d\u4ee4\u671f\u671b\u7684\u8fd4\u56de\u7ed3\u679c\uff0c\u4e5f\u4e0d\u662f \"OK\"\u3001\"FAIL\"\u3001\"ERROR\"\uff0c\u5219\u4e3a\u666e\u901a\u6570\u636e\uff0c\u5c06\u884c\u7f13\u51b2\u533a\u7684\u6570\u636e\u590d\u5236\u5230\u7528\u6237\u4f20\u5165\u7684 echo_buffer\u4e2d\uff0c\u7531\u7528\u6237\u5904\u7406\u3002 \u2461 AT\u6846\u67b6\u5c06\u6a21\u7ec4\u4e3b\u52a8\u4e0a\u62a5\u7684\u6570\u636e\u4f5c\u4e3a\u4e8b\u4ef6\uff0c\u5c06\u4e0a\u62a5\u6570\u636e\u7684\u6570\u636e\u5934\u548c\u7528\u6237\u6307\u5b9a\u7684\u56de\u8c03\u5904\u7406\u51fd\u6570\u4f5c\u4e3a\u4e8b\u4ef6\u8868\uff0c\u5728AT\u6846\u67b6\u521d\u59cb\u5316\u65f6\u6ce8\u518c\u3002 \u6bd4\u5982 ESP8266 \u5728 TCP/IP \u901a\u4fe1\u65f6\uff0c\u6536\u5230\u8fdc\u7a0b\u670d\u52a1\u5668\u53d1\u9001\u6765\u7684\u6570\u636e\u65f6\u4f1a\u4f7f\u7528+IPD\u5934\u4e3b\u52a8\u4e0a\u62a5\u6570\u636e\uff0c\u5c06\u6b64\u4e8b\u4ef6\u6ce8\u518c\u7684\u793a\u4f8b\u5982\u4e0b\uff1a /* esp8266.c */ at_event_t esp8266_at_event[] = { { \"+IPD,\", esp8266_incoming_data_process }, }; \u6ce8\u518c\u4e4b\u540e\uff0c\u6bcf\u6b21\u884c\u89e3\u6790\u7684\u65f6\u5019\u90fd\u4f1a\u5224\u65ad\u662f\u5426\u4e3a\u4e8b\u4ef6\u5934\uff0c\u5982\u679c\u662f\u5219\u8bc1\u660e\u6709\u4e8b\u4ef6\u53d1\u751f\uff0c\u62c9\u8d77\u6ce8\u518c\u7684\u56de\u8c03\u51fd\u6570\u8fdb\u884c\u5904\u7406\u3002 \u6ce8\u610f\uff0cAT\u6846\u67b6\u53ea\u4ece chr_fifo \u4e2d\u8bfb\u53d6\u51fa\u4e86\u4e8b\u4ef6\u5934\uff0c\u4e8b\u4ef6\u5934\u4e4b\u540e\u7684\u6240\u6709\u6570\u636e\u4f9d\u7136\u5728\u7f13\u51b2\u533a\u4e2d\uff0c\u6240\u5728\u5f00\u53d1\u8005\u5728\u7f16\u5199\u56de\u8c03\u51fd\u6570\u65f6\u53ef\u4ee5\u8fb9\u8bfb\u51fa\u6570\u636e\uff0c\u8fb9\u89e3\u6790\u6570\u636e\u3002 \u2462 \u5982\u4f55\u5b8c\u6210\u4e00\u6b21\u4ea4\u4e92\uff1f AT\u6846\u67b6\u5c06\u6bcf\u4e00\u6b21\u4ea4\u4e92\u62bd\u8c61\u4e3a\u4e00\u4e2a at_echo_t \u5bf9\u8c61\uff0c\u7528\u6237\u4ea4\u4e92\u7684\u6d41\u7a0b\u5982\u4e0b\uff1a \u2463 \u5982\u4f55\u5b9e\u73b0\u591a\u4e2achannel\u540c\u65f6\u5b58\u5728\uff1f \u5927\u591a\u6570\u901a\u4fe1\u6a21\u7ec4\u5728\u8fdb\u884c TCP/IP \u901a\u4fe1\u65f6\uff0c\u652f\u6301\u540c\u65f6\u521b\u5efa\u591a\u4e2asocket\u901a\u4fe1\uff08\u4e00\u822c\u4e3a6\u4e2a\uff09\uff0c\u4f5c\u4e3a\u4e00\u4e2a\u901a\u7528\u7684AT\u6846\u67b6\uff0c\u4e5f\u4e3a\u4e86\u66f4\u597d\u7684\u4e0a\u5c42SAL\u670d\u52a1\uff0cAT\u6846\u67b6\u4e5f\u76f8\u5e94\u7684\u652f\u6301\u591achannel\u3002 \u6bcf\u4e2achannel\u5bf9\u8c61\u5982\u4e0b\uff1a typedef struct at_data_channel_st { uint8_t is_free; k_chr_fifo_t rx_fifo; uint8_t *rx_fifo_buffer; k_mutex_t rx_lock; at_channel_status_t status; const char *remote_ip; const char *remote_port; } at_data_channel_t; \u6bcf\u6b21\u4e0a\u5c42\u53d1\u8d77 Socket Connect\u8fde\u63a5\u65f6\uff0c\u5c06\u6b64Socket\u7684ip\u548cport\u7ed1\u5b9a\u5230channel\u5bf9\u8c61\uff0c\u7136\u540e\u52a8\u6001\u7533\u8bf7\u4e00\u5757\u5185\u5b58\u4f5c\u4e3a\u8be5channnel\u7684\u63a5\u6536\u7f13\u51b2\u533a\uff0c\u5f53Socket close\u65f6\uff0c\u968f\u5373\u91ca\u653e\u6b64\u7f13\u51b2\u533a\u3002","title":"2.2. \u5b9e\u73b0\u539f\u7406"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#23-tencentos-tiny-at","text":"AT\u6846\u67b6\u7684\u6240\u6709\u7f13\u51b2\u533a\u5185\u5b58\u90fd\u662f\u4f7f\u7528\u52a8\u6001\u5185\u5b58\uff0c\u5185\u90e8\u673a\u5236\u4f7f\u7528\u5230\u4e86\u4fe1\u53f7\u91cfsem\u3001\u4e92\u65a5\u9501mutex\u3001\u5b57\u7b26\u6d41\u961f\u5217chr_fifo\u3001\u8ba1\u65f6\u8868stopwatch\uff0c\u6240\u4ee5\u8bf7\u9996\u5148\u4fdd\u8bc1\u5728 tos_config.h \u4e2d\u8fd9\u4e9b\u914d\u7f6e\u5904\u4e8e\u4f7f\u80fd\u6a21\u5f0f\uff0c\u5176\u4e2d\u52a8\u6001\u5185\u5b58\u6c60\u7684\u5927\u5c0f\u53ef\u4ee5\u6839\u636e\u968f\u540e AT \u6846\u67b6\u7684\u914d\u7f6e\u4fee\u6539\uff1a #define TOS_CFG_MUTEX_EN 1u #define TOS_CFG_SEM_EN 1u #define TOS_CFG_MMHEAP_EN 1u #define TOS_CFG_MMHEAP_DEFAULT_POOL_EN 1u #define TOS_CFG_MMHEAP_DEFAULT_POOL_SIZE 0x8000 AT\u6846\u67b6\u7684\u6240\u6709\u53ef\u914d\u7f6e\u9009\u9879\u90fd\u5df2\u5728 tos_at.h \u4e2d\u4f7f\u7528\u5b8f\u5b9a\u4e49\u7ed9\u51fa\uff0c\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u9700\u8981\u8fdb\u884c\u88c1\u526a\u914d\u7f6e\uff1a #define AT_DATA_CHANNEL_NUM 6 #define AT_DATA_CHANNEL_FIFO_BUFFER_SIZE (2048 + 1024) #define AT_UART_RX_FIFO_BUFFER_SIZE (2048 + 1024) #define AT_RECV_CACHE_SIZE 2048 #define AT_CMD_BUFFER_SIZE 512 #define AT_PARSER_TASK_STACK_SIZE 2048 #define AT_PARSER_TASK_PRIO 2 \u914d\u7f6e\u9879\u7684\u610f\u4e49\u5982\u4e0b\uff1a \u914d\u7f6e\u9879 \u4f5c\u7528 AT_DATA_CHANNEL_NUM AT\u6846\u67b6\u652f\u6301\u7684\u6700\u5927\u901a\u9053\u6570 AT_DATA_CHANNEL_FIFO_BUFFER_SIZE \u6bcf\u4e2a\u901a\u9053\u7684\u7f13\u51b2\u533a\u5927\u5c0f AT_UART_RX_FIFO_BUFFER_SIZE \u4e32\u53e3\u63a5\u6536\u7f13\u51b2\u533a\u5927\u5c0f AT_RECV_CACHE_SIZE \u884c\u7f13\u51b2\u533a\u5927\u5c0f AT_CMD_BUFFER_SIZE \u547d\u4ee4\u7f13\u51b2\u533a\u5927\u5c0f AT_PARSER_TASK_STACK_SIZE \u89e3\u6790\u4efb\u52a1\u7684\u4efb\u52a1\u6808\u5927\u5c0f AT_PARSER_TASK_PRIO \u89e3\u6790\u4efb\u52a1\u7684\u4efb\u52a1\u4f18\u5148\u7ea7","title":"2.3. TencentOS-tiny AT\u6846\u67b6\u53c2\u6570\u914d\u7f6e"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#24-atapi","text":"AT\u6846\u67b6\u5199\u5165\u4e00\u4e2a\u5b57\u8282\u6570\u636e __API__ void tos_at_uart_input_byte(uint8_t data); \u6b64 API \u901a\u5e38\u5728\u4e32\u53e3\u4e2d\u65ad\u4e2d\u8c03\u7528\u3002 AT\u6846\u67b6\u521d\u59cb\u5316 __API__ int tos_at_init(hal_uart_port_t uart_port, at_event_t *event_table, size_t event_table_size); \u53c2\u6570 \u610f\u4e49 uart_port AT\u6846\u67b6\u4f7f\u7528\u7684\u4e32\u53e3 event_table \u4e8b\u4ef6\u8868\u5730\u5740 event_table_size \u4e8b\u4ef6\u8868\u5927\u5c0f \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u521b\u5efa\u4e00\u4e2a at_echo_t \u5bf9\u8c61 __API__ int tos_at_echo_create(at_echo_t *echo, char *buffer, size_t buffer_size, char *echo_expect); \u53c2\u6570 \u610f\u4e49 echo at_echo_t\u5bf9\u8c61\u53e5\u67c4 buffer \u7528\u4e8e\u4fdd\u5b58\u547d\u4ee4\u6267\u884c\u7ed3\u679c\u7684\u7f13\u51b2\u533a buffer_size \u7f13\u51b2\u533a\u5927\u5c0f echo_expect \u671f\u671b\u7684\u5b57\u7b26\u4e32 \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u6267\u884c\u4e00\u6761AT\u547d\u4ee4,timeout\u8d85\u65f6\u540e\u624d\u8fd4\u56de __API__ int tos_at_cmd_exec(at_echo_t *echo, uint32_t timeout, const char *cmd, ...); \u53c2\u6570 \u610f\u4e49 echo at_echo_t\u5bf9\u8c61\u53e5\u67c4 timeout \u547d\u4ee4\u6267\u884c\u4e4b\u540e\u7684\u7b49\u5f85\u65f6\u95f4 cmd \u8981\u6267\u884c\u7684AT\u547d\u4ee4 \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u6267\u884c\u4e00\u6761AT\u547d\u4ee4\uff0c\u4e00\u65e6\u6709\u671f\u671b\u7ed3\u679c\u7acb\u9a6c\u8fd4\u56de\uff0c\u82e5\u65e0\uff0c\u5219timeout\u8d85\u65f6\u540e\u8fd4\u56de __API__ int tos_at_cmd_exec_until(at_echo_t *echo, uint32_t timeout, const char *cmd, ...); \u53c2\u6570 \u610f\u4e49 echo at_echo_t\u5bf9\u8c61\u53e5\u67c4 timeout \u547d\u4ee4\u6267\u884c\u4e4b\u540e\u7684\u7b49\u5f85\u65f6\u95f4 cmd \u8981\u6267\u884c\u7684AT\u547d\u4ee4 \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u53d1\u9001\u5341\u516d\u8fdb\u5236\u539f\u59cb\u6570\u636e\uff0ctimeout\u8d85\u65f6\u540e\u624d\u8fd4\u56de __API__ int tos_at_raw_data_send(at_echo_t *echo, uint32_t timeout, const uint8_t *buf, size_t size); \u53c2\u6570 \u610f\u4e49 echo at_echo_t\u5bf9\u8c61\u53e5\u67c4 timeout \u547d\u4ee4\u6267\u884c\u4e4b\u540e\u7684\u7b49\u5f85\u65f6\u95f4 buf \u5f85\u53d1\u9001\u7684\u7f13\u51b2\u533a size \u7f13\u51b2\u533a\u5927\u5c0f \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u53d1\u9001\u5341\u516d\u8fdb\u5236\u6570\u636e\uff0c\u4e00\u65e6\u6709\u671f\u671b\u7ed3\u679c\u7acb\u9a6c\u8fd4\u56de\uff0c\u82e5\u65e0\uff0c\u5219timeout\u8d85\u65f6\u540e\u8fd4\u56de __API__ int tos_at_raw_data_send_until(at_echo_t *echo, uint32_t timeout, const uint8_t *buf, size_t size); \u53c2\u6570 \u610f\u4e49 echo at_echo_t\u5bf9\u8c61\u53e5\u67c4 timeout \u547d\u4ee4\u6267\u884c\u4e4b\u540e\u7684\u7b49\u5f85\u65f6\u95f4 buf \u5f85\u53d1\u9001\u7684\u7f13\u51b2\u533a size \u7f13\u51b2\u533a\u5927\u5c0f \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u76f4\u63a5\u4ece\u4e32\u53e3\u63a5\u6536\u7f13\u51b2\u533a\u4e2d\u8bfb\u53d6\u6570\u636e __API__ int tos_at_uart_read(uint8_t *buffer, size_t buffer_len); \u53c2\u6570 \u610f\u4e49 buf \u5b58\u653e\u8bfb\u53d6\u6570\u636e\u7684\u7f13\u51b2\u533a size \u8bfb\u53d6\u6570\u636e\u7684\u957f\u5ea6 \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u76f4\u63a5\u4ece\u4e32\u53e3\u63a5\u6536\u7f13\u51b2\u533a\u4e2d\u8bfb\u53d6\u4e00\u884c\u6570\u636e __API__ int tos_at_uart_readline(uint8_t *buffer, size_t buffer_len); \u53c2\u6570 \u610f\u4e49 buf \u5b58\u653e\u8bfb\u53d6\u6570\u636e\u7684\u7f13\u51b2\u533a size \u8bfb\u53d6\u6570\u636e\u7684\u957f\u5ea6 \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u7533\u8bf7\u4e00\u4e2achannel __API__ int tos_at_channel_alloc(const char *ip, const char *port); \u53c2\u6570 \u610f\u4e49 ip socket ip port socket port \u8fd4\u56de\u503c \u6210\u529f\uff1a\u975e\u8d1f\u503c\u3001\u901a\u9053ID\uff0c\u5931\u8d25\uff1a-1 \u5199\u5165\u6570\u636e\u5230channel\u7684\u63a5\u6536\u7f13\u51b2\u533a __API__ int tos_at_channel_write(int channel_id, uint8_t *buffer, size_t buffer_len); \u53c2\u6570 \u610f\u4e49 channel_id \u5df2\u7ecf\u7533\u8bf7\u6210\u529f\u7684channel \u901a\u9053ID buf \u5b58\u653e\u5199\u5165\u6570\u636e\u7684\u7f13\u51b2\u533a size \u5199\u5165\u6570\u636e\u7684\u957f\u5ea6 \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u5728TCP/IP\u901a\u4fe1\u65f6\uff0c\u89e3\u6790\u5b8cAT\u6307\u4ee4\u4e0a\u62a5\u7684\u6570\u636e\u65f6\uff0c\u5c31\u53ef\u4ee5\u5c06\u771f\u6b63\u7f51\u7edc\u63a5\u6536\u7684\u6570\u636e\u8c03\u7528\u6b64API\u5199\u5165channle\u7684\u63a5\u6536\u7f13\u51b2\u533a\u3002 \u4ecechannel\u7684\u63a5\u6536\u7f13\u51b2\u533a\u4e2d\u8bfb\u53d6\u6570\u636e __API__ int tos_at_channel_read(int channel_id, uint8_t *buffer, size_t buffer_len); \u53c2\u6570 \u610f\u4e49 channel_id \u5df2\u7ecf\u7533\u8bf7\u6210\u529f\u7684channel \u901a\u9053ID buf \u5b58\u653e\u8bfb\u53d6\u6570\u636e\u7684\u7f13\u51b2\u533a size \u8bfb\u53d6\u6570\u636e\u7684\u957f\u5ea6 \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u4ecechannel\u7684\u63a5\u6536\u7f13\u51b2\u533a\u4e2d\u8bfb\u53d6\u6570\u636e\uff0c\u6709\u8d85\u65f6\u65f6\u95f4 __API__ int tos_at_channel_read_timed(int channel_id, uint8_t *buffer, size_t buffer_len, uint32_t timeout); \u53c2\u6570 \u610f\u4e49 channel_id \u5df2\u7ecf\u7533\u8bf7\u6210\u529f\u7684channel \u901a\u9053ID buf \u5b58\u653e\u8bfb\u53d6\u6570\u636e\u7684\u7f13\u51b2\u533a size \u8bfb\u53d6\u6570\u636e\u7684\u957f\u5ea6 timeout \u8bfb\u53d6\u7b49\u5f85\u65f6\u95f4 \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1","title":"2.4. AT\u6846\u67b6\u63d0\u4f9b\u7684API"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#3-tencentos-tinysal","text":"","title":"3. TencentOS-tiny\u7684SAL\u6846\u67b6"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#31-sal","text":"SAL\u6846\u67b6\u5168\u79f0Socket Abstract Layer\uff0c\u63d0\u4f9b\u4e86\u7c7b\u4f3csocket\u7f51\u7edc\u7f16\u7a0b\u7684\u62bd\u8c61\u5c42\uff0c\u4e3a\u4e0a\u5c42\u5e94\u7528\u4e00\u5c42\u7edf\u4e00\u7684\u7f51\u7edcAPI\uff0c\u5c4f\u853d\u4e86\u5e95\u5c42\u4e0d\u540c\u901a\u4fe1\u6a21\u7ec4/\u65b9\u5f0f\u7684\u5dee\u5f02\u3002","title":"3.1. \u4ec0\u4e48\u662fSAL\u6846\u67b6"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#32-sal","text":"TencentOS-tiny SAL\u6846\u67b6\u7684\u5b9e\u73b0\u5728 net/sal_module_wrapper \u8def\u5f84\u4e2d\uff0c\u4ec5\u6709\u4e24\u4e2a\u6587\u4ef6\uff1a sal_module_wrapper.h \u548c sal_module_wrapper.c \u3002 SAL\u6846\u67b6\u7684\u5e95\u5c42\u662f\u4e00\u5957\u51fd\u6570\u6307\u9488\uff0c\u5982\u4e0b\uff1a typedef struct sal_module_st { int (*init)(void); int (*get_local_mac)(char *mac); int (*get_local_ip)(char *ip, char *gw, char *mask); int (*parse_domain)(const char *host_name, char *host_ip, size_t host_ip_len); int (*connect)(const char *ip, const char *port, sal_proto_t proto); int (*send)(int sock, const void *buf, size_t len); int (*recv_timeout)(int sock, void *buf, size_t len, uint32_t timeout); int (*recv)(int sock, void *buf, size_t len); int (*sendto)(int sock, char *ip, char *port, const void *buf, size_t len); int (*recvfrom)(int sock, void *buf, size_t len); int (*recvfrom_timeout)(int sock, void *buf, size_t len, uint32_t timeout); int (*close)(int sock); } sal_module_t; \u4e0d\u540c\u7684\u901a\u4fe1\u6a21\u7ec4\u9a71\u52a8\u90fd\u53bb\u5b9e\u73b0\u8fd9\u4e00\u5957\u51fd\u6570\u6307\u9488\u5373\u53ef\uff0cTencentOS-tiny\u5b98\u65b9\u5df2\u7ecf\u63d0\u4f9b\u4e86\u975e\u5e38\u591a\u7684\u901a\u4fe1\u6a21\u7ec4\u9a71\u52a8\u5b9e\u73b0SAL\u6846\u67b6\uff0c\u8986\u76d6\u5e38\u7528\u7684\u901a\u4fe1\u65b9\u5f0f\uff0c\u6bd4\u59822G\u30014G Cat.4\u30014G Cat.1\u3001NB-IoT\u7b49\uff0c\u5728 devices \u6587\u4ef6\u5939\u4e0b\uff1a air724 bc26 bc25_28_95 bc35_28_95_lwm2m ec20 esp8266 m26 m5310a m6312 sim800a sim7600ce \u6b22\u8fce\u8d21\u732e\u66f4\u591a\u9a71\u52a8...","title":"3.2. SAL\u6846\u67b6\u7684\u5b9e\u73b0\u539f\u7406"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#33-salapi","text":"\u6ce8\u518c\u8be5\u6a21\u7ec4\u5b9e\u73b0\u5230SAL\u6846\u67b6 int tos_sal_module_register(sal_module_t *module); \u53c2\u6570 \u4f5c\u7528 module \u6a21\u7ec4\u5b9e\u73b0\u7684\u51fd\u6570\u6307\u9488\u7ed3\u6784\u4f53\u53e5\u67c4 \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u6a21\u7ec4\u521d\u59cb\u5316 int tos_sal_module_init(void); \u53c2\u6570 \u4f5c\u7528 \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u57df\u540d\u89e3\u6790 int tos_sal_module_parse_domain(const char *host_name, char *host_ip, size_t host_ip_len); \u53c2\u6570 \u4f5c\u7528 host_name \u57df\u540d host_ip \u5b58\u653e\u89e3\u6790\u51fa\u7684ip\u7f13\u51b2\u533a host_ip_len \u7f13\u51b2\u533a\u5927\u5c0f \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1 \u5efa\u7acb TCP/UDP socket\u8fde\u63a5 int tos_sal_module_connect(const char *ip, const char *port, sal_proto_t proto); \u53c2\u6570 \u4f5c\u7528 ip \u76ee\u7684\u4e3b\u673aip port \u76ee\u7684\u4e3b\u673aport proto \u534f\u8bae\u7c7b\u578b\uff1aTOS_SAL_PROTO_TCP\u6216\u8005TOS_SAL_PROTO_UDP \u8fd4\u56de\u503c \u6210\u529f\uff1asocket id\uff0c\u5931\u8d25\uff1a-1 TCP socket\u53d1\u9001\u6570\u636e int tos_sal_module_send(int sock, const void *buf, size_t len); \u53c2\u6570 \u4f5c\u7528 sock socket id buf \u5f85\u53d1\u9001\u6570\u636e len \u5f85\u53d1\u9001\u6570\u636e\u957f\u5ea6 \u8fd4\u56de\u503c \u6210\u529f\uff1a\u5b9e\u9645\u53d1\u9001\u6570\u636e\u7684\u957f\u5ea6\uff0c\u5931\u8d25\uff1a-1 TCP socket\u63a5\u6536\u6570\u636e int tos_sal_module_recv(int sock, void *buf, size_t len); int tos_sal_module_recv_timeout(int sock, void *buf, size_t len, uint32_t timeout); \u53c2\u6570 \u4f5c\u7528 sock socket id buf \u5b58\u653e\u63a5\u6536\u6570\u636e\u7684\u7f13\u51b2\u533a len \u7f13\u51b2\u533a\u957f\u5ea6 timeout \u7b49\u5f85\u8d85\u65f6\u65f6\u95f4 \u8fd4\u56de\u503c \u6210\u529f\uff1a\u5b9e\u9645\u8bfb\u53d6\u6570\u636e\u7684\u957f\u5ea6\uff0c\u5931\u8d25\uff1a-1 UDP socket\u53d1\u9001\u6570\u636e int tos_sal_module_sendto(int sock, char *ip, char *port, const void *buf, size_t len); \u53c2\u6570 \u4f5c\u7528 sock socket id ip \u76ee\u7684\u4e3b\u673aip port \u76ee\u7684\u4e3b\u673aport buf \u5f85\u53d1\u9001\u6570\u636e len \u5f85\u53d1\u9001\u6570\u636e\u957f\u5ea6 \u8fd4\u56de\u503c \u6210\u529f\uff1a\u5b9e\u9645\u53d1\u9001\u6570\u636e\u7684\u957f\u5ea6\uff0c\u5931\u8d25\uff1a-1 UDP socket\u63a5\u6536\u6570\u636e int tos_sal_module_recvfrom(int sock, void *buf, size_t len); int tos_sal_module_recvfrom_timeout(int sock, void *buf, size_t len, uint32_t timeout); \u53c2\u6570 \u4f5c\u7528 sock socket id buf \u5b58\u653e\u63a5\u6536\u6570\u636e\u7684\u7f13\u51b2\u533a len \u7f13\u51b2\u533a\u957f\u5ea6 timeout \u7b49\u5f85\u8d85\u65f6\u65f6\u95f4 \u8fd4\u56de\u503c \u6210\u529f\uff1a\u5b9e\u9645\u8bfb\u53d6\u6570\u636e\u7684\u957f\u5ea6\uff0c\u5931\u8d25\uff1a-1 \u5173\u95edsocket int tos_sal_module_close(int sock); \u53c2\u6570 \u4f5c\u7528 sock socket id \u8fd4\u56de\u503c \u6210\u529f\uff1a0\uff0c\u5931\u8d25\uff1a-1","title":"3.3. SAL\u6846\u67b6\u63d0\u4f9b\u7684\u7f51\u7edc\u7f16\u7a0bAPI"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#4-atsal","text":"","title":"4. AT\u6846\u67b6+SAL\u6846\u67b6\u79fb\u690d\u65b9\u6cd5"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#41","text":"\u672c\u6587\u4e2d\u6211\u4f7f\u7528\u5b98\u65b9EVB_MX+\u5f00\u53d1\u677f\u4e3a\u4f8b\uff0c\u4e3b\u63a7\u82af\u7247\u4e3aSTM32L431RCT6\uff0cUSART1\u7528\u4e8eprintf\u6253\u5370\u65e5\u5fd7\u4fe1\u606f\uff0cLPUART1\u7528\u4e8e\u548c\u901a\u4fe1\u6a21\u7ec4\u4ea4\u4e92\uff0c\u901a\u4fe1\u6a21\u7ec4\u4f7f\u7528 WIFI \u6a21\u7ec4 ESP8266\u4e3a\u4f8b\u3002 \u79fb\u690dAT\u6846\u67b6\u524d\u9700\u8981\u51c6\u5907\u597d\u4e00\u4e2a\u79fb\u690d\u597dTencentOS-tiny\u5185\u6838\u7684\u5de5\u7a0b\uff0c\u53ef\u4ee5\u505a\u5230\u4e32\u53e3\u7684\u6b63\u5e38\u6536\u53d1\uff0c\u8fd9\u91cc\u6211\u4f7f\u7528 TencentOS-tiny \u4e2d TencentOS-tiny\\board\\TencentOS_tiny_EVB_MX_Plus\\KEIL\\hello_world \u4e2d\u7684\u5de5\u7a0b\u3002","title":"4.1. \u79fb\u690d\u524d\u7684\u51c6\u5907"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#42-at","text":"TencentOS-tiny AT \u6846\u67b6\u7684\u5b9e\u73b0\u5728 net/at \u76ee\u5f55\u4e0b\u7684 tos_at.h \u548c tos_at.c \u4e24\u4e2a\u6587\u4ef6\u4e2d\uff0cTencentOS-tiny AT\u6846\u67b6\u5e95\u5c42\u4f7f\u7528\u7684\u4e32\u53e3\u9a71\u52a8HAL\u5c42\u5728 platform\\hal\\st\\stm32l4xx\\src \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6 tos_hal_uart.c \u4e2d\uff0c\u5934\u6587\u4ef6\u5728 kernel\\hal\\include \u8def\u5f84\u4e2d\u3002 \u9996\u5148\u5c06\u8fd9\u4e24\u4e2ac\u6587\u4ef6\u6dfb\u52a0\u5230Keil\u5de5\u7a0b\u4e2d\uff1a \u7136\u540e\u5c06\u5934\u6587\u4ef6\u8def\u5f84\u6dfb\u52a0\u5230Keil MDK\u4e2d\uff1a \u7136\u540e\u5728\u4e32\u53e3\u4e2d\u65ad\u4e2d\u914d\u7f6e\u8c03\u7528AT\u6846\u67b6\u7684\u5b57\u8282\u63a5\u6536\u51fd\u6570\uff0c\u7f16\u8f91 stm32l4xx_it.c \u6587\u4ef6\uff1a \u2460 \u6dfb\u52a0AT\u6846\u67b6\u7684\u5934\u6587\u4ef6\uff1a /* Private includes ----------------------------------------------------------*/ /* USER CODE BEGIN Includes */ #include \"tos_at.h\" /* USER CODE END Includes */ \u2461 \u5728\u6587\u4ef6\u6700\u540e\u6dfb\u52a0\u4e32\u53e3\u4e2d\u65ad\u56de\u8c03\u51fd\u6570\uff1a /* USER CODE BEGIN 1 */ void HAL_UART_RxCpltCallback(UART_HandleTypeDef *huart) { extern uint8_t data; if (huart->Instance == LPUART1) { HAL_UART_Receive_IT(&hlpuart1, &data, 1); tos_at_uart_input_byte(data); } } /* USER CODE END 1 */ \u6ce8\u610f\uff0c\u5728\u56de\u8c03\u51fd\u6570\u4e2d\u58f0\u660edata\u53d8\u91cf\u5728\u5916\u90e8\u5b9a\u4e49\uff0c\u8fd9\u662f\u56e0\u4e3aSTM32 HAL\u5e93\u7684\u673a\u5236\uff0c\u9700\u8981\u5728\u521d\u59cb\u5316\u5b8c\u6210\u4e4b\u540e\u5148\u8c03\u7528\u4e00\u6b21\u4e32\u53e3\u63a5\u6536\u51fd\u6570\uff0c\u4f7f\u80fd\u4e32\u53e3\u63a5\u6536\u4e2d\u65ad\uff0c\u7f16\u8f91 usart.c \u6587\u4ef6\uff1a \u2460 \u5728\u6587\u4ef6\u5f00\u5934\u5b9a\u4e49data\u53d8\u91cf\u4e3a\u5168\u5c40\u53d8\u91cf\uff1a /* USER CODE BEGIN 0 */ uint8_t data; /* USER CODE END 0 */ \u2461 \u5728\u4e32\u53e3\u521d\u59cb\u5316\u5b8c\u6210\u4e4b\u540e\u4f7f\u80fd\u63a5\u6536\u4e2d\u65ad\uff1a /* LPUART1 init function */ void MX_LPUART1_UART_Init(void) { hlpuart1.Instance = LPUART1; hlpuart1.Init.BaudRate = 115200; hlpuart1.Init.WordLength = UART_WORDLENGTH_8B; hlpuart1.Init.StopBits = UART_STOPBITS_1; hlpuart1.Init.Parity = UART_PARITY_NONE; hlpuart1.Init.Mode = UART_MODE_TX_RX; hlpuart1.Init.HwFlowCtl = UART_HWCONTROL_NONE; hlpuart1.Init.OneBitSampling = UART_ONE_BIT_SAMPLE_DISABLE; hlpuart1.AdvancedInit.AdvFeatureInit = UART_ADVFEATURE_NO_INIT; if (HAL_UART_Init(&hlpuart1) != HAL_OK) { Error_Handler(); } //\u624b\u52a8\u6dfb\u52a0\uff0c\u4f7f\u80fd\u4e32\u53e3\u4e2d\u65ad HAL_UART_Receive_IT(&hlpuart1, &data, 1); }","title":"4.2. \u79fb\u690dAT\u6846\u67b6"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#43-sal","text":"TencentOS-tiny SAL\u6846\u67b6\u7684\u5b9e\u73b0\u5728 net/sal_module_wrapper \u8def\u5f84\u4e2d\uff0c\u4ec5\u6709\u4e24\u4e2a\u6587\u4ef6\uff1a sal_module_wrapper.h \u548c sal_module_wrapper.c \u3002 \u5c06c\u6587\u4ef6\u6dfb\u52a0\u5230Keil MDK\u5de5\u7a0b\u4e2d\uff1a \u5c06\u5934\u6587\u4ef6\u6240\u5728\u8def\u5f84\u6dfb\u52a0\u5230Keil MDK\u4e2d\uff1a","title":"4.3. \u79fb\u690dSAL\u6846\u67b6"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#44","text":"TencentOS-tiny\u5b98\u65b9\u5df2\u7ecf\u63d0\u4f9b\u4e86\u975e\u5e38\u591a\u7684\u901a\u4fe1\u6a21\u7ec4\u9a71\u52a8\u5b9e\u73b0SAL\u6846\u67b6\uff0c\u8986\u76d6\u5e38\u7528\u7684\u901a\u4fe1\u65b9\u5f0f\uff0c\u6bd4\u59822G\u30014G Cat.4\u30014G Cat.1\u3001NB-IoT\u7b49\uff0c\u5728 devices \u6587\u4ef6\u5939\u4e0b,\uff1a air724 bc26 bc25_28_95 bc35_28_95_lwm2m ec20 esp8266 m26 m5310a m6312 sim800a sim7600ce \u6b22\u8fce\u8d21\u732e\u66f4\u591a\u9a71\u52a8... \u56e0\u4e3a\u8fd9\u4e9b\u9a71\u52a8\u90fd\u662fSAL\u6846\u67b6\u7684\u5b9e\u73b0\uff0c\u6240\u4ee5\u8fd9\u4e9b\u901a\u4fe1\u6a21\u7ec4\u7684\u9a71\u52a8\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u786c\u4ef6\u60c5\u51b5 \u9009\u62e9\u4e00\u79cd\u52a0\u5165\u5230\u5de5\u7a0b\u4e2d \uff0c\u8fd9\u91cc\u6211\u4ee5 WIFI \u6a21\u7ec4 ESP8266\u4e3a\u4f8b\uff0c\u6f14\u793a\u5982\u4f55\u52a0\u5165\u901a\u4fe1\u6a21\u7ec4\u9a71\u52a8\u5230\u5de5\u7a0b\u4e2d\u3002 ESP8266\u7684\u9a71\u52a8\u5728 devices\\esp8266 \u76ee\u5f55\u4e2d\u3002 \u9996\u5148\u5c06 esp8266.c \u6587\u4ef6\u52a0\u5165\u5230Keil MDK\u5de5\u7a0b\u4e2d\uff1a \u7136\u540e\u5c06 esp8266.h \u5934\u6587\u4ef6\u6240\u5728\u8def\u5f84\u6dfb\u52a0\u5230Keil MDK\u5de5\u7a0b\u4e2d\uff1a \u79fb\u690d\u5b8c\u6210\u3002","title":"4.4. \u79fb\u690d\u901a\u4fe1\u6a21\u7ec4\u9a71\u52a8"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#45","text":"\u79fb\u690d\u5b8c\u6210\u4e4b\u540e\uff0c\u53ef\u76f4\u63a5\u4f7f\u7528\u5b98\u65b9\u63d0\u4f9b\u7684\u793a\u4f8b\u4ee3\u7801\u8fdb\u884c\u6d4b\u8bd5\uff0c\u6d4b\u8bd5\u53ccsocket\u8fdb\u884cTCP\u901a\u4fe1\u7684\u6d4b\u8bd5\u7a0b\u5e8f\u4e3a examples\\tcp_through_module\\tcp_through_module.c \u3002 \u5c06\u5de5\u7a0b\u4e2d\u7684 helloworld \u793a\u4f8b\u4ee3\u7801\u66f4\u6362\u4e3a\u8be5\u6587\u4ef6\uff0c\u5982\u56fe\uff1a \u5728\u8fd9\u4e2a\u793a\u4f8b\u4e2d\uff0c\u9996\u5148\u901a\u8fc7\u5b8f\u5b9a\u4e49\u6765\u914d\u7f6e\u5f53\u524d\u4f7f\u7528\u7684\u662f\u54ea\u4e2a\u6a21\u7ec4\uff1a \u7136\u540e\u8c03\u7528\u5bf9\u5e94\u6a21\u7ec4\u7684\u521d\u59cb\u5316\u51fd\u6570\uff1a \u6b64\u5904\u9700\u8981\u6ce8\u610f\uff1a\u521d\u59cb\u5316\u6a21\u7ec4\u65f6\u6307\u5b9a\u7684\u4e32\u53e3\u53f7\u5373\u4e3aAT\u901a\u4fe1\u6a21\u7ec4\u6240\u4f7f\u7528\u7684\u4e32\u53e3\uff0c\u5728 tos_hal_uart.h \u4e2d\u5b9a\u4e49\uff1a typedef enum hal_uart_port_en { HAL_UART_PORT_0 = 0, //\u5bf9\u5e94LPUART1 HAL_UART_PORT_1, //\u5bf9\u5e94USART1 HAL_UART_PORT_2, //\u4f9d\u6b64\u7c7b\u63a8 HAL_UART_PORT_3, HAL_UART_PORT_4, HAL_UART_PORT_5, HAL_UART_PORT_6, } hal_uart_port_t; \u6700\u540e\u4fee\u6539\u4e24\u4e2aTCP Socket \u7684ip\u548c\u7aef\u53e3\u4e3a\u81ea\u5df1\u6d4b\u8bd5\u670d\u52a1\u5668\u7684ip\u548c\u7aef\u53e3\uff1a socket_id_0 = tos_sal_module_connect(\"117.50.111.72\", \"8080\", TOS_SAL_PROTO_TCP); socket_id_1 = tos_sal_module_connect(\"117.50.111.72\", \"8001\", TOS_SAL_PROTO_TCP); TCP\u6d4b\u8bd5\u670d\u52a1\u5668\u9700\u8981\u81ea\u5df1\u642d\u5efa\u6216\u8005\u4f7f\u7528\u4e00\u4e9b\u5c0f\u5de5\u5177\uff0c\u6b64\u5904\u4e0d\u518d\u8be6\u8ff0\u3002 \u4fee\u6539\u5b8c\u6210\u4e4b\u540e\uff0c\u7f16\u8bd1\u7a0b\u5e8f\uff0c\u70e7\u5f55\u5230\u5f00\u53d1\u677f\u4e2d\uff0c\u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u67e5\u770b\u7ed3\u679c\uff1a \u5728 socket0 \u7684\u670d\u52a1\u7aef\u67e5\u770b\u6a21\u7ec4\u53d1\u9001\u7684\u6d88\u606f\uff1a \u5728 socket1 \u7684\u670d\u52a1\u7aef\u67e5\u770b\u6a21\u7ec4\u53d1\u9001\u7684\u6d88\u606f\uff1a \u81f3\u6b64\uff0c\u6d4b\u8bd5\u5b8c\u6210\u3002","title":"4.5. \u6d4b\u8bd5\u7f51\u7edc\u901a\u4fe1"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#5","text":"\u57fa\u4e8e\u6a21\u7ec4\u7684AT\u6307\u4ee4\u96c6\uff0c\u4f7f\u7528 TencentOS-tiny AT \u6846\u67b6\u4e0e\u6a21\u7ec4\u4ea4\u4e92\uff0c\u5b9e\u73b0SAL\u6846\u67b6\u6240\u5b9a\u4e49\u7684\u51fd\u6570\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u79f0\u4e3a\u901a\u4fe1\u6a21\u7ec4\u9002\u914d\u3002 \u672c\u6587\u4e2d\u6211\u4ee5\u79fb\u8fdc\u901a\u4fe1\u76844G\u901a\u4fe1\u6a21\u7ec4 EC20 \u4f5c\u4e3a\u793a\u4f8b\uff0c\u8bb2\u8ff0\u4e00\u4e2a\u5168\u65b0\u7684\u901a\u4fe1\u6a21\u7ec4\u9002\u914d\u6d41\u7a0b\u3002","title":"5. \u5982\u4f55\u9002\u914d\u4e00\u4e2a\u65b0\u7684\u901a\u4fe1\u6a21\u7ec4\u9a71\u52a8"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#step1-at","text":"\u9002\u914dSAL\u5c42\u9700\u8981\u719f\u6089\u6a21\u7ec4\u7684\u4e09\u7c7bAT\u6307\u4ee4\uff1a \u57fa\u672c\u67e5\u8be2\u914d\u7f6e\u6307\u4ee4 TCP/IP\u7f51\u7edc\u534f\u8bae\u6808AT\u6307\u4ee4 TCP/IP\u7f51\u7edc\u534f\u8bae\u6808\u6570\u636e\u63a5\u6536\u673a\u5236 \u6bd4\u5982EC20\u76f8\u5173\u7684AT\u6307\u4ee4\u5982\u4e0b\uff1a","title":"Step1. \u4f7f\u7528\u4e32\u53e3\u52a9\u624b\u8c03\u8bd5\uff0c\u719f\u6089\u8be5\u6a21\u7ec4\u7684AT\u6307\u4ee4\u96c6"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#1_1","text":"\u6d4b\u8bd5AT\u6307\u4ee4\u662f\u5426\u6b63\u5e38\uff1f AT OK \u67e5\u8be2SIM\u5361\u662f\u5426\u6b63\u5e38\uff1f AT+CPIN? +CPIN: READY OK \u67e5\u8be2\u6a21\u7ec4\u7684\u4fe1\u53f7\u5f3a\u5ea6 AT+CSQ +CSQ: 17,0 OK \u67e5\u8be2\u6a21\u7ec4\u662f\u5426\u6ce8\u518c\u5230GSM\u7f51\u7edc AT+CREG? +CREG: 0,1 OK \u67e5\u8be2\u6a21\u7ec4\u662f\u5426\u6ce8\u518c\u4e0aGPRS\u7f51\u7edc AT+CGREG? +CGREG: 0,1 OK \u8bbe\u7f6eGPRS\u7684APN AT+QICSGP=1,1,\"CMNET\" OK \u6fc0\u6d3b\u79fb\u52a8\u573a\u666f AT+QIACT=1 OK","title":"\u2460 \u57fa\u672c\u67e5\u8be2\u914d\u7f6e\u6307\u4ee4"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#2-tcpipat","text":"TCP/IP\u7f51\u7edc\u534f\u8bae\u6808\u81f3\u5c11\u9700\u8981TCP/UDP socket\u7684\u901a\u4fe1AT\u6307\u4ee4\uff0c\u5176\u5b83\u4e0a\u5c42\u534f\u8bae\u7684AT\u6307\u4ee4\u6682\u65f6\u4e0d\u7528\u3002 \u5efa\u7acbSocket AT+QIOPEN=1,0,\"TCP\",\"117.50.111.72\",8902,0,0 OK +QIOPEN: 0,0 \u5728\u5efa\u7acbsocket\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\uff0c\u6709\u7684\u901a\u4fe1\u6a21\u7ec4\u9700\u8981\u63d0\u524d\u4f7f\u7528AT\u6307\u4ee4\u914d\u7f6e\u5355\u94fe\u8def\u6a21\u5f0f\u8fd8\u662f\u591a\u94fe\u8def\u6a21\u5f0f\uff08eg. ESP8266\uff09,\u800c\u6709\u7684\u901a\u4fe1\u6a21\u7ec4\u9ed8\u8ba4\u76f4\u63a5\u652f\u6301\u591a\u94fe\u8def\u6a21\u5f0f\uff0c\u65e0\u9700\u914d\u7f6e\u3002 \u53d1\u9001\u6570\u636e AT+QISEND=0 > hello<0x1a> SEND OK \u53d1\u9001\u6570\u636e\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\uff0c\u6709\u7684\u901a\u4fe1\u6a21\u7ec4\u53d1\u9001\u6570\u636e\u4f7f\u7528ASCII\u5b57\u7b26(eg. ESP8266\u3001EC20\u7b49)\uff0c\u800c\u6709\u7684\u901a\u4fe1\u6a21\u7ec4\u53d1\u9001\u6570\u636e\u4f7f\u7528\u5341\u516d\u8fdb\u5236\uff08eg. NB-IoT\u7c7b\u6a21\u7ec4\uff09 \u63a5\u6536\u6570\u636e \u63a5\u4e0b\u6765\u7684\u4e00\u8282\u91cd\u70b9\u8bb2\u8ff0\u3002 \u5173\u95edSocket AT+QICLOSE=0 OK","title":"\u2461 TCP/IP\u7f51\u7edc\u534f\u8bae\u6808AT\u6307\u4ee4"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#3-tcpip","text":"\u901a\u4fe1\u6a21\u7ec4\u5728\u63a5\u6536\u5230\u670d\u52a1\u5668\u53d1\u6765\u7684\u6570\u636e\u65f6\uff0c\u4f1a\u6709\u4e24\u79cd\u65b9\u5f0f\u4e0a\u62a5\u7ed9MCU\uff1a \u4f7f\u7528\u56fa\u5b9a\u7684IP\u5934\u4e0a\u62a5socket id\u548c\u6570\u636e\u957f\u5ea6\uff0c\u9700\u8981\u518d\u6b21\u53bb\u8bfb\u53d6\u6570\u636e(\u7f13\u51b2\u6a21\u5f0f\u63a5\u6536) //\u6a21\u7ec4\u4e0a\u62a5 +QIURC: \"recv\",0 //MCU\u53d1\u51faAT\u6307\u4ee4\u53bb\u8bfb\u53d6\u6570\u636e AT+QIRD=0,1500 +QIRD: 14 Hello, client! OK \u4f7f\u7528\u56fa\u5b9a\u7684IP\u5934\u4e0a\u62a5socket id\u548c\u6570\u636e\u957f\u5ea6\uff0c\u540c\u65f6\u4e00\u8d77\u4e0a\u62a5\u6570\u636e(\u76f4\u63a5\u6a21\u5f0f\u63a5\u6536) +QIURC: \"recv\",0,14 Hello, client! \u6709\u7684\u6a21\u7ec4\u53ea\u652f\u6301\u67d0\u4e00\u79cd\u6a21\u5f0f\uff0c\u6709\u7684\u6a21\u7ec4\u4e24\u79cd\u6a21\u5f0f\u90fd\u652f\u6301\uff0c\u53ef\u4ee5\u81ea\u5df1\u914d\u7f6e\uff0c\u5bf9\u4e8eTencentOS-tiny\u7684AT\u6846\u67b6\u6765\u8bf4\uff0c\u7b2c\u4e8c\u79cd\u76f4\u63a5\u4e0a\u62a5\u6a21\u5f0f\u89e3\u6790\u8d77\u6765\u4f1a\u66f4\u52a0\u65b9\u4fbf\u3002","title":"\u2462 TCP/IP\u7f51\u7edc\u534f\u8bae\u6808\u6570\u636e\u63a5\u6536\u673a\u5236"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#step2-at","text":"\u4e0a\u9762\u8bb2\u8ff0\u4e86\u9002\u914dSAL\u5c42\u9700\u8981\u719f\u6089\u6a21\u7ec4\u7684\u4e09\u7c7bAT\u6307\u4ee4\uff1a\u57fa\u672c\u67e5\u8be2\u914d\u7f6e\u6307\u4ee4\u3001TCP/IP\u7f51\u7edc\u534f\u8bae\u6808AT\u6307\u4ee4\u3001TCP/IP\u7f51\u7edc\u534f\u8bae\u6808\u6570\u636e\u63a5\u6536\u673a\u5236\uff0c\u8fd9\u8282\u8bb2\u8ff0\u5982\u4f55\u4f7f\u7528AT\u6846\u67b6\u5b9e\u73b0\u8fd9\u4e09\u7c7bAT\u6307\u4ee4\u3002 \u2460 \u53ea\u9700\u8981\u5224\u65ad\u662f\u5426\u8fd4\u56deOK\u7684AT\u6307\u4ee4 \u8fd9\u4e00\u7c7bAT\u6307\u4ee4\u7684\u5b9e\u73b0\u51fd\u6570\u9664\u4e86\u6307\u4ee4\u5185\u5bb9\u4e0d\u540c\uff0c\u522b\u7684\u90fd\u76f8\u540c\uff0c\u6bd4\u5982\u5173\u95ed\u56de\u663e\u7684AT\u6307\u4ee4\uff1a ATE0 OK \u5bf9\u5e94\u7684\u5b9e\u73b0\u65b9\u6cd5\u5982\u4e0b\uff1a static int ec20_echo_close(void) { at_echo_t echo; /* \u521b\u5efa\u4e00\u4e2aecho \u5bf9\u8c61\uff0c\u7f13\u51b2\u533a\u4e3aNULL\uff0c\u671f\u671b\u5b57\u7b26\u4e32\u4e3aNULL */ tos_at_echo_create(&echo, NULL, 0, NULL); /* \u6267\u884cAT\u547d\u4ee4\uff0c\u8d85\u65f6\u65f6\u957f1000ms */ tos_at_cmd_exec(&echo, 1000, \"ATE0\\r\\n\"); /* \u5224\u65ad\u6267\u884c\u7ed3\u679c\u662f\u5426\u4e3aOK */ if (echo.status == AT_ECHO_STATUS_OK) { return 0; } return -1; } \u2461 \u9700\u8981\u5224\u65ad\u662f\u5426OK\uff0c\u4e5f\u9700\u8981\u89e3\u6790\u6267\u884c\u7ed3\u679c\u7684AT\u6307\u4ee4 \u8fd9\u4e00\u7c7bAT\u6307\u4ee4\u7684\u5b9e\u73b0\u51fd\u6570\u4e2d\uff0c\u4e0d\u540c\u70b9\u5728\u4e8e\uff0c\u521b\u5efaecho\u5bf9\u8c61\u7684\u65f6\u5019\u9700\u8981\u4f20\u5165\u4e00\u4e2abuffer\u6765\u5b58\u653e\u6307\u4ee4\u6267\u884c\u7684\u7ed3\u679c\uff0c\u6bd4\u5982\u67e5\u8be2\u4fe1\u53f7\u5f3a\u5ea6\u7684AT\u6307\u4ee4\uff1a AT+CSQ +CSQ: 17,0 OK \u5bf9\u5e94\u7684\u5b9e\u73b0\u65b9\u6cd5\u5982\u4e0b\uff1a static int ec20_signal_quality_check(void) { int rssi, ber; at_echo_t echo; char echo_buffer[32], *str; int try = 0; /* \u521b\u5efaecho\u5bf9\u8c61\uff0c\u4f20\u5165\u4e00\u4e2a\u7f13\u51b2\u533a\u5b58\u653eAT\u547d\u4ee4\u6267\u884c\u7ed3\u679c */ tos_at_echo_create(&echo, echo_buffer, sizeof(echo_buffer), NULL); /* \u5c1d\u8bd5\u68c0\u6d4b10\u6b21\uff0c\u4e00\u65e6\u6709\u4e00\u6b21\u6b63\u5e38\uff0c\u8fd4\u56de */ while (try++ < 10) { /* \u6267\u884cAT\u547d\u4ee4\uff0c\u8d85\u65f6\u65f6\u957f1000ms */ tos_at_cmd_exec(&echo, 1000, \"AT+CSQ\\r\\n\"); /* \u5224\u65ad\u6267\u884c\u7ed3\u679c\u662f\u5426\u8fd4\u56de\u4e86OK */ if (echo.status != AT_ECHO_STATUS_OK) { return -1; } /* \u4eceAT\u6307\u4ee4\u7684\u6267\u884c\u7ed3\u679c\u4e2d\u89e3\u6790\u63d0\u53d6CSQ\u503c\u8fdb\u884c\u5224\u65ad */ str = strstr(echo.buffer, \"+CSQ:\"); sscanf(str, \"+CSQ:%d,%d\", &rssi, &ber); if (rssi != 99) { return 0; } } return -1; } \u2462 \u6a21\u7ec4\u4e3b\u52a8\u4e0a\u62a5\u7684\u6570\u636e\u5904\u7406 \u8fd9\u4e00\u7c7bAT\u6307\u4ee4\u5bf9\u5e94TCP/IP\u534f\u8bae\u6808\u63a5\u6536\u6570\u636e\u7684\u4e0a\u62a5\u673a\u5236\uff0c\u4f7f\u7528AT\u6846\u67b6\u7684\u4e8b\u4ef6\u673a\u5236\u8fdb\u884c\u5904\u7406\u3002 \u9996\u5148\u5c06\u56fa\u5b9a\u7684ip\u5934\u548c\u4e8b\u4ef6\u5904\u7406\u56de\u8c03\u51fd\u6570\u6ce8\u518c\uff1a at_event_t ec20_at_event[] = { { \"+QIURC: \\\"recv\\\",\", ec20_incoming_data_process}, //\u5904\u7406\u8fdc\u7a0b\u670d\u52a1\u5668\u53d1\u6765\u7684\u6570\u636e { \"+QIURC: \\\"dnsgip\\\",\", ec20_domain_data_process}, //\u5904\u7406\u57df\u540d\u89e3\u6790\u7ed3\u679c\uff0c\u6682\u65f6\u4e0d\u7ba1 }; \u4e8b\u4ef6\u5904\u7406\u56de\u8c03\u51fd\u6570\u81ea\u5df1\u7f16\u5199\uff0c\u4e3b\u8981\u4f5c\u7528\u662f\u63d0\u53d6\u6a21\u7ec4\u4e0a\u62a5\u7684scoketid\u3001\u6570\u636e\u957f\u5ea6\u3001\u6570\u636e\u5185\u5bb9\uff0c\u7136\u540e\u5c06\u6570\u636e\u5185\u5bb9\u5199\u5165\u5230\u5bf9\u5e94socket id \u7684channel\u4e2d\u3002 \u9700\u8981\u6ce8\u610f\uff0cAT\u6846\u67b6\u4e00\u65e6\u8bfb\u53d6\u89e3\u6790\u5230\u56fa\u5b9a\u7684IP\u5934\uff0c\u5219\u505c\u6b62\u89e3\u6790\uff0c\u62c9\u8d77\u5bf9\u5e94\u7684\u56de\u8c03\u51fd\u6570\uff0c\u6240\u4ee5\u5728\u56de\u8c03\u51fd\u6570\u4e2d\u53ef\u4ee5\u7ee7\u7eed\u4ece\u7f13\u51b2\u533a\u4e2d\u4e00\u8fb9\u8bfb\u53d6\u4e00\u8fb9\u89e3\u6790\u3002 \u89e3\u6790\u793a\u4f8b\u5982\u4e0b\uff1a __STATIC__ void ec20_incoming_data_process(void) { uint8_t data; int channel_id = 0, data_len = 0, read_len; uint8_t buffer[128]; /* \u6a21\u7ec4\u4e0a\u62a5\u7684\u6570\u636e\u683c\u5f0f\uff1a +QIURC: \"recv\",<sockid>,<datalen> <data content> */ /* \u6ce8\u518c\u7684ip\u5934\u662f\uff1a[+QIURC: \"recv\",]\u56de\u8c03\u51fd\u6570\u88ab\u62c9\u8d77\u6267\u884c\u540e\uff0c\u63a5\u7740\u5904\u7406\u540e\u8fb9\u7684\u6570\u636e\u5373\u53ef */ /* \u8bfb\u53d6\u89e3\u6790socket id */ while (1) { if (tos_at_uart_read(&data, 1) != 1) { return; } if (data == ',') { break; } channel_id = channel_id * 10 + (data - '0'); } /* \u8bfb\u53d6\u89e3\u6790\u6570\u636e\u957f\u5ea6 */ while (1) { if (tos_at_uart_read(&data, 1) != 1) { return; } if (data == '\\r') { break; } data_len = data_len * 10 + (data - '0'); } /* \u8bfb\u53d6'\\r'\u4e4b\u540e\u7684'\\n'\uff0c\u4e0d\u4f5c\u4efb\u4f55\u5904\u7406 */ if (tos_at_uart_read(&data, 1) != 1) { return; } /* \u6839\u636e\u89e3\u6790\u51fa\u7684\u6570\u636e\u957f\u5ea6\u548c\u7f13\u51b2\u533a\u7684\u957f\u5ea6\uff0c\u5faa\u73af\u8bfb\u53d6\u6570\u636e\u5185\u5bb9\uff0c\u5199\u5165\u5230\u5bf9\u5e94 socket id \u7684channel\u4e2d */ do { #define MIN(a, b) ((a) < (b) ? (a) : (b)) read_len = MIN(data_len, sizeof(buffer)); /* \u8bfb\u53d6\u6570\u636e */ if (tos_at_uart_read(buffer, read_len) != read_len) { return; } /* \u5199\u5165\u5230\u5bf9\u5e94\u7684channel\u4e2d */ if (tos_at_channel_write(channel_id, buffer, read_len) <= 0) { return; } data_len -= read_len; } while (data_len > 0); return; }","title":"Step2. \u4e09\u7c7bAT\u6307\u4ee4\uff0c\u4e09\u79cd\u5b9e\u73b0\u65b9\u5f0f"},{"location":"27.AT_Firmware_and_SAL_Firmware_User_Guide/#step3","text":"\u524d\u4e24\u6b65\u90fd\u662f\u7ec6\u8282\u6027\u7684\u5904\u7406\uff0c\u8fd9\u4e00\u6b65\u4ece\u6574\u4f53\u7684\u89d2\u5ea6\u8bb2\u8ff0\u9002\u914d\u6d41\u7a0b\u3002 \u2460 \u6a21\u7ec4\u521d\u59cb\u5316 static int ec20_init(void) { printf(\"Init ec20 ...\\n\" ); /* \u5173\u95ed\u56de\u663e */ if (ec20_echo_close() != 0) { printf(\"echo close failed,please check your module\\n\"); return -1; } /* \u68c0\u6d4bSIM\u5361\u662f\u5426\u6b63\u5e38 */ if(ec20_sim_card_check() != 0) { printf(\"sim card check failed,please insert your card\\n\"); return -1; } /* \u68c0\u6d4b\u4fe1\u53f7\u5f3a\u5ea6\u662f\u5426\u6b63\u5e38 */ if (ec20_signal_quality_check() != 0) { printf(\"signal quality check status failed\\n\"); return -1; } /* \u68c0\u6d4b\u662f\u5426\u6ce8\u518c\u5230GSM\u7f51\u7edc */ if(ec20_gsm_network_check() != 0) { printf(\"GSM network register status check fail\\n\"); return -1; } /* \u68c0\u6d4b\u662f\u5426\u6ce8\u518c\u5230GPRS\u7f51\u7edc */ if(ec20_gprs_network_check() != 0) { printf(\"GPRS network register status check fail\\n\"); return -1; } /* \u5173\u95edAPN */ if(ec20_close_apn() != 0) { printf(\"close apn failed\\n\"); return -1; } /* \u8bbe\u7f6eAPN\uff0c\u6fc0\u6d3b\u79fb\u52a8\u573a\u666f */ if (ec20_set_apn() != 0) { printf(\"apn set FAILED\\n\"); return -1; } printf(\"Init ec20 ok\\n\" ); return 0; } \u2461 \u5c06\u5b9e\u73b0\u7684\u51fd\u6570\u6620\u5c04\u5230SAL\u6846\u67b6\u4e0a\uff1a sal_module_t sal_module_ec20 = { .init = ec20_init, .connect = ec20_connect, .send = ec20_send, .recv_timeout = ec20_recv_timeout, .recv = ec20_recv, .sendto = ec20_sendto, .recvfrom = ec20_recvfrom, .recvfrom_timeout = ec20_recvfrom_timeout, .close = ec20_close, .parse_domain = ec20_parse_domain, }; \u2462 \u518d\u6b21\u5c01\u88c5\uff0c\u7559\u51fa\u4e00\u4e2a\u5916\u90e8\u8c03\u7528\u63a5\u53e3\uff0c\u4f9b\u4e0a\u5c42\u5e94\u7528\u7a0b\u5e8f\u8c03\u7528\uff1a int ec20_sal_init(hal_uart_port_t uart_port) { /* \u521d\u59cb\u5316AT\u6846\u67b6\u53ca\u5176\u4e32\u53e3 */ if (tos_at_init(uart_port, ec20_at_event, sizeof(ec20_at_event) / sizeof(ec20_at_event[0])) != 0) { return -1; } /* \u5c06\u7b2c\u2461\u6b65\u4e2d\u6620\u5c04\u7684\u51fd\u6570\u5173\u7cfb\uff0c\u6ce8\u518c\u5230SAL\u6846\u67b6 */ if (tos_sal_module_register(&sal_module_ec20) != 0) { return -1; } /* \u8c03\u7528SAL\u521d\u59cb\u5316\u51fd\u6570\uff0c\u56e0\u4e3a\u63a5\u53e3\u548c\u6620\u5c04\u7684\u5b58\u5728\uff0c\u6700\u7ec8\u8c03\u7528\u5230ec20_init */ if (tos_sal_module_init() != 0) { return -1; } return 0; }","title":"Step3. \u6574\u4f53\u9002\u914d\u6d41\u7a0b"},{"location":"28.BLE_Device_Quick_Start/","text":"1 \u64cd\u4f5c\u573a\u666f \u4f7f\u7528BLE\u84dd\u7259\u6a21\u62df\u4e00\u6b3e\u667a\u80fd\u706f\uff0c\u914d\u5408\u201c\u817e\u8baf\u8fde\u8fde\u201d\u5c0f\u7a0b\u5e8f\u5b9e\u73b0\u8bbe\u5907\u63a5\u5165\uff0c\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u53ef\u4ee5\u8fdc\u7a0b\u63a7\u5236\u706f\u7684\u4eae\u5ea6\u3001\u989c\u8272\u3001\u5f00\u5173\uff0c\u5e76\u5b9e\u65f6\u83b7\u53d6\u667a\u80fd\u706f\u4e0a\u62a5\u5230\u5f00\u53d1\u5e73\u53f0\u7684\u6570\u636e\u3002 \u672c\u6587\u6863\u4e3b\u8981\u6307\u5bfc\u60a8\u5982\u4f55\u4f7f\u7528NRF52832\u6a21\u7ec4\u5728\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u521b\u5efa\u667a\u80fd\u706f\u4ea7\u54c1\u5e76\u901a\u8fc7\u624b\u673a\u63a5\u5165\u3002 2 \u524d\u63d0\u6761\u4ef6 \u4e3a\u4e86\u901a\u8fc7\u4e0b\u9762\u7684\u6b65\u9aa4\u5feb\u901f\u7406\u89e3\u8be5\u4e1a\u52a1\u6d41\u7a0b\uff0c\u9700\u8981\u505a\u597d\u4ee5\u4e0b\u51c6\u5907\u5de5\u4f5c\uff1a - \u7533\u8bf7\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u670d\u52a1\u3002 - \u51c6\u5907\u4e00\u5757NRF52832\u5f00\u53d1\u677f\u3002 - \u4e0b\u8f7d\u6700\u65b0\u7248\u672c\u4ee3\u7801\u3002 - \u5b89\u88c5python\u3001JLink\u9a71\u52a8\u7a0b\u5e8f\u3002 3 \u64cd\u4f5c\u6b65\u9aa4 3.1 \u63a7\u5236\u53f0\u64cd\u4f5c 3.1.1 \u65b0\u5efa\u9879\u76ee \u767b\u5f55 \u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u63a7\u5236\u53f0 \uff0c\u9009\u62e9\u3010\u65b0\u5efa\u9879\u76ee\u3011\u3002 \u5728\u65b0\u5efa\u9879\u76ee\u9875\u9762\uff0c\u586b\u5199\u9879\u76ee\u57fa\u672c\u4fe1\u606f\uff0c\u5b8c\u6210\u540e\u70b9\u51fb\u4fdd\u5b58\u3002 \u9879\u76ee\u540d\u79f0\uff1a\u8f93\u5165\u201c\u667a\u80fd\u706f\u6f14\u793a\u201d\u6216\u5176\u4ed6\u540d\u79f0\u3002 \u9879\u76ee\u63cf\u8ff0\uff1a\u6309\u7167\u5b9e\u9645\u9700\u6c42\u586b\u5199\u9879\u76ee\u63cf\u8ff0\u3002 3.1.2 \u65b0\u5efa\u4ea7\u54c1 \u8fdb\u5165\u8be5\u9879\u76ee\u7684\u4ea7\u54c1\u5217\u8868\u9875\u9762\uff0c\u5355\u51fb\u3010\u65b0\u5efa\u4ea7\u54c1\u3011\u3002 \u5728\u65b0\u5efa\u4ea7\u54c1\u9875\u9762\uff0c\u586b\u5199\u4ea7\u54c1\u57fa\u672c\u4fe1\u606f\uff0c\u5b8c\u6210\u540e\u70b9\u51fb\u4fdd\u5b58\u3002 \u4ea7\u54c1\u540d\u79f0\uff1a\u8f93\u5165\u201c\u84dd\u7259\u667a\u80fd\u706f\u201d\u6216\u5176\u4ed6\u4ea7\u54c1\u540d\u79f0\u3002 \u4ea7\u54c1\u7c7b\u578b\uff1a\u9009\u62e9\u201c\u667a\u6167\u751f\u6d3b\u2014\u7535\u5de5\u7167\u660e\u2014\u706f\u201d\u3002 \u8bbe\u5907\u7c7b\u578b\uff1a\u9009\u62e9\u201c\u8bbe\u5907\u201d\u3002 \u8ba4\u8bc1\u65b9\u5f0f\uff1a\u9009\u62e9\u201c\u5bc6\u94a5\u8ba4\u8bc1\u201d\u3002 \u901a\u4fe1\u65b9\u5f0f\uff1a\u9009\u62e9\u201cBLE\u201d\u3002 \u5176\u4ed6\u9009\u9879\u4fdd\u6301\u9ed8\u8ba4\u3002 3.1.3 \u521b\u5efa\u6570\u636e\u6a21\u677f \u6253\u5f00\u521a\u521a\u521b\u5efa\u7684\u3010\u84dd\u7259\u667a\u80fd\u706f\u3011\u4ea7\u54c1\u3002 \u9009\u62e9\u3010\u6570\u636e\u6a21\u677f\u3011\uff0c\u70b9\u51fb\u3010\u5bfc\u5165JSON\u3011\u3002 \u6253\u5f00\u4ee3\u7801\u4e2d\u7684 examples\\nimble_llsync\\date_templatenrf52832.json \uff0c\u5982\u679c\u51fa\u73b0\u4e71\u7801\u8bf7\u5c06\u60a8\u7684\u7f16\u8f91\u5668\u4fee\u6539\u4e3autf8\u7f16\u7801\uff0c\u5c06\u6587\u4ef6\u4e2d\u7684\u4ee3\u7801\u7c98\u8d34\u8fdb\u6765\uff0c\u70b9\u51fb\u3010\u5bfc\u5165\u3011\u3002 3.1.4 \u4ea4\u4e92\u5f00\u53d1\u914d\u7f6e \u914d\u7f6e\u4ea7\u54c1\u5728\u5c0f\u7a0b\u5e8f\u7aef\u7684\u63a7\u5236\u9762\u677f\u3001\u914d\u7f51\u5f15\u5bfc\u3001\u5feb\u6377\u5165\u53e3\uff0c\u82e5\u4e0d\u914d\u7f6e\u5219\u4f7f\u7528\u7cfb\u7edf\u9ed8\u8ba4\u914d\u7f6e\u3002 3.1.5 \u65b0\u5efa\u8bbe\u5907 \u5728\u8bbe\u5907\u8c03\u8bd5\u9875\u9762\u4e2d\uff0c\u5355\u51fb\u3010\u65b0\u5efa\u8bbe\u5907\u3011\uff0c\u8f93\u5165\u8bbe\u5907\u540d\u201cble_device_01\u201d\u6216\u5176\u4ed6\u8bbe\u5907\u540d\u79f0\uff0c\u70b9\u51fb\u3010\u4fdd\u5b58\u3011\u3002 3.2 \u8bbe\u5907\u7aef\u64cd\u4f5c 3.2.1 \u786c\u4ef6\u7b80\u4ecb\u4e0e\u8fde\u63a5 \u5f00\u53d1\u677f\u5b9e\u7269\u5982\u4e0b\uff1a \u6307\u793a\u706f\u4f5c\u7528\u5982\u4e0b - LED1: \u5f00\u5173 - LED2: action - LED3: replay - LED4: \u672a\u4f7f\u7528 \u4f7f\u7528USB\u7ebf\u8fde\u63a5\u5f00\u53d1\u677f\u5de6\u4e0a\u89d2\u4e32\u53e3\u3002 \u4f7f\u7528JLink\u8fde\u63a5\u5f00\u53d1\u677f\u53f3\u4e0b\u89d2\u4e0b\u8f7d\u7ebf\u63a5\u53e3\u3002 \u6253\u5f00\u5de6\u4e0a\u89d2\u7535\u6e90\u5f00\u5173\u3002 \u6253\u5f00\u8bbe\u5907\u7ba1\u7406\u5668\uff0c\u786e\u4fdd\u4e32\u53e3\u548cJLink\u80fd\u591f\u6b63\u5e38\u8bc6\u522b\uff0c\u82e5\u4e0d\u80fd\u8bc6\u522b\u8bf7\u91cd\u65b0\u5b89\u88c5\u9a71\u52a8\u3002 3.2.2 \u51c6\u5907\u8f6f\u4ef6\u73af\u5883 \u65b0\u4e70\u5230\u7684nrf52832\u5f00\u53d1\u677f\u53ef\u80fd\u5df2\u7ecf\u70e7\u5199\u4e86 NORDIC \u5b98\u65b9\u84dd\u7259\u534f\u8bae\u6808\uff0c\u9700\u8981\u8fdb\u884c\u64e6\u9664\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4\u4e0b\u8f7d\u5931\u8d25\u3001\u7a0b\u5e8f\u5f02\u5e38\u6216\u5176\u4ed6\u95ee\u9898 \u542f\u52a8 JFlash.exe\uff0c\u9009\u62e9 File -> New project \u70b9\u51fb\u7701\u7565\u53f7\u6dfb\u52a0\u8bbe\u5907 \u5728\u201cDevice\u201d\u4e2d\u8f93\u5165nrf52832\uff0c\u9009\u62e9\u5177\u4f53\u82af\u7247\u578b\u53f7\uff0c\u4f8b\u7a0b\u4e2d\u4f7f\u7528\u7684\u4e3anRF52832_xxAA \u9009\u62e9 Target -> Manual Programming -> Erase Chip \u64e6\u9664\u82af\u7247 \u64e6\u9664\u5b8c\u6210\u540e\u5373\u53ef\u7ee7\u7eed\u8fdb\u884c\u4e4b\u540e\u7684\u5f00\u53d1 3.2.3 \u4ee3\u7801\u4fee\u6539\u4e0e\u70e7\u5f55 \u6253\u5f00\u5de5\u7a0b board\\Nordic_NRF52832\\KEIL\\llsync\\TencentOS_tiny.uvprojx \u3002 \u6253\u5f00\u6587\u4ef6 ble_qiot_import.c \uff0c\u627e\u5230\u4ee5\u4e0b\u4e09\u4e2a\u5b8f\u5e76\u4fee\u6539\u4e3a\u4f60\u81ea\u5df1\u7684\u8bbe\u5907\u4fe1\u606f\u3002 \u5728\u3010\u8bbe\u5907\u8c03\u8bd5\u3011\u9875\u9762\u4e2d\u9009\u62e9\u3010\u8bbe\u5907\u4fe1\u606f\u3011\u5b50\u9875\u9762\uff0c\u5c06\u3010\u8bbe\u5907\u540d\u79f0\u3011\u3001\u3010\u8bbe\u5907\u5bc6\u94a5\u3011\u3001\u3010\u4ea7\u54c1ID\u3011\u5206\u522b\u586b\u5165 DEVICE_NAME , SECRET_KEY , PRODUCT_ID \u3002 \u5728 ble_qiot_ret_status_t ble_qiot_explorer_init(void) \u4e2d\u6216\u5176\u4ed6\u5408\u9002\u7684\u5730\u65b9\u4fee\u6539\u65e5\u5fd7\u7b49\u7ea7 ble_qiot_set_log_level(BLE_QIOT_LOG_LEVEL_DEBUG); \uff0c\u4ee5\u4fbf\u5f00\u53d1\u8c03\u8bd5\u3002 \u7f16\u8bd1\u4e0b\u8f7d\u5e76\u8fd0\u884c\u3002 3.3 \u817e\u8baf\u8fde\u8fde\u5c0f\u7a0b\u5e8f\u8c03\u8bd5 \u5fae\u4fe1\u4e3b\u9875\u9762\u4e0b\u62c9\u5e76\u641c\u7d22\u3010\u817e\u8baf\u8fde\u8fde\u3011\u5c0f\u7a0b\u5e8f\u3002 \u70b9\u51fb\u4e0b\u65b9\u7684\u3010\u52a0\u53f7\u3011\u6dfb\u52a0\u8bbe\u5907\u3002 \u5f85\u626b\u63cf\u5230\u84dd\u7259\u8bbe\u5907\u540e\u70b9\u51fb\u53f3\u4fa7\u7684\u3010\u8fde\u63a5\u3011\u3002 \u5728\u3010\u6211\u7684\u8bbe\u5907\u3011\u4e2d\u6253\u5f00\u521a\u521a\u6dfb\u52a0\u7684\u84dd\u7259\u8bbe\u5907\u3002 \u70b9\u51fb\u53f3\u4fa7\u7684\u3010\u7acb\u5373\u8fde\u63a5\u3011\u8fde\u63a5\u8bbe\u5907\u3002 \u8fde\u63a5\u6210\u529f\u540e\u70b9\u51fb\u3010\u7535\u706f\u5f00\u5173\u3011\uff0c\u53ef\u4ee5\u770b\u5230\u5f00\u53d1\u7248\u4e0a\u3010LED1\u3011\u968f\u4e4b\u53d8\u5316\u3002 \u70b9\u51fb\u3010\u4eae\u5ea6\u3011\u6216\u3010\u989c\u8272\u3011\u6309\u94ae\u8fdb\u884c\u8bbe\u7f6e \u67e5\u770b\u4e32\u53e3\u6253\u5370\uff0c\u53ef\u4ee5\u770b\u5230\u4eae\u5ea6\u3001\u989c\u8272\u8bbe\u7f6e\u6210\u529f 4 Q&A Q: \u5b9e\u9645\u4ea7\u54c1\u4e2d\u5982\u4f55\u5904\u7406\u8bbe\u5907\u4fe1\u606f\uff1f A: \u4f8b\u7a0b\u4e2d DEVICE_NAME , SECRET_KEY , PRODUCT_ID \u76f4\u63a5\u5199\u5728\u4ee3\u7801\u4e2d\uff0c\u4ea7\u54c1\u4e2d\u5e94\u4fdd\u5b58\u5728Flash\u4e2d\uff0c\u540c\u65f6\u4fee\u6539 ble_qiot_import.c \u4e2d ble_get_product_id() , ble_get_device_name() , ble_get_psk() \u4e09\u4e2a\u51fd\u6570\u3002 Q: LLSync SDK \u9700\u8981\u591a\u5927\u7684 Flash \u6765\u4fdd\u5b58\u914d\u7f6e\u4fe1\u606f\uff1f A: \u76ee\u524d\u53ea\u9700\u8981\u4e0d\u523032\u5b57\u8282\u3002 Q: \u5982\u679c\u5f00\u53d1\u5176\u4ed6 BLE \u82af\u7247\uff0c\u6709\u4ec0\u4e48\u6ce8\u610f\u4e8b\u9879\uff1f A: components\\connectivity\\qcloud_iot_explorer_ble\\inc\\ble_qiot_import.h \u4e3a\u7528\u6237\u9700\u8981\u79fb\u690d\u9002\u914d\u7684\u63a5\u53e3\uff0c\u4e0e\u84dd\u7259\u534f\u8bae\u6808\u76f8\u5173\u7684\u63a5\u53e3\u5728 ble_qiot_import.c \u4e2d\u5df2\u7ecf\u5b8c\u6210\u4e86\u9002\u914d\uff0c\u7528\u6237\u4ec5\u9700\u6839\u636e\u5b9e\u9645\u4ea7\u54c1\u8981\u5f00\u53d1 ble_write_flash() , ble_read_flash() \u7b49\u63a5\u53e3\u3002 5 \u53c2\u8003\u8d44\u6599 LLSync SDK \u5185\u76f8\u5173\u6587\u6863 LLSync SDK \u63a5\u5165\u6307\u5f15 LLSync SDK \u4f7f\u7528\u53c2\u8003","title":"28.BLE_Device_Quick_Start"},{"location":"28.BLE_Device_Quick_Start/#1","text":"\u4f7f\u7528BLE\u84dd\u7259\u6a21\u62df\u4e00\u6b3e\u667a\u80fd\u706f\uff0c\u914d\u5408\u201c\u817e\u8baf\u8fde\u8fde\u201d\u5c0f\u7a0b\u5e8f\u5b9e\u73b0\u8bbe\u5907\u63a5\u5165\uff0c\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u53ef\u4ee5\u8fdc\u7a0b\u63a7\u5236\u706f\u7684\u4eae\u5ea6\u3001\u989c\u8272\u3001\u5f00\u5173\uff0c\u5e76\u5b9e\u65f6\u83b7\u53d6\u667a\u80fd\u706f\u4e0a\u62a5\u5230\u5f00\u53d1\u5e73\u53f0\u7684\u6570\u636e\u3002 \u672c\u6587\u6863\u4e3b\u8981\u6307\u5bfc\u60a8\u5982\u4f55\u4f7f\u7528NRF52832\u6a21\u7ec4\u5728\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u521b\u5efa\u667a\u80fd\u706f\u4ea7\u54c1\u5e76\u901a\u8fc7\u624b\u673a\u63a5\u5165\u3002","title":"1 \u64cd\u4f5c\u573a\u666f"},{"location":"28.BLE_Device_Quick_Start/#2","text":"\u4e3a\u4e86\u901a\u8fc7\u4e0b\u9762\u7684\u6b65\u9aa4\u5feb\u901f\u7406\u89e3\u8be5\u4e1a\u52a1\u6d41\u7a0b\uff0c\u9700\u8981\u505a\u597d\u4ee5\u4e0b\u51c6\u5907\u5de5\u4f5c\uff1a - \u7533\u8bf7\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u670d\u52a1\u3002 - \u51c6\u5907\u4e00\u5757NRF52832\u5f00\u53d1\u677f\u3002 - \u4e0b\u8f7d\u6700\u65b0\u7248\u672c\u4ee3\u7801\u3002 - \u5b89\u88c5python\u3001JLink\u9a71\u52a8\u7a0b\u5e8f\u3002","title":"2 \u524d\u63d0\u6761\u4ef6"},{"location":"28.BLE_Device_Quick_Start/#3","text":"","title":"3 \u64cd\u4f5c\u6b65\u9aa4"},{"location":"28.BLE_Device_Quick_Start/#31","text":"","title":"3.1 \u63a7\u5236\u53f0\u64cd\u4f5c"},{"location":"28.BLE_Device_Quick_Start/#311","text":"\u767b\u5f55 \u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u63a7\u5236\u53f0 \uff0c\u9009\u62e9\u3010\u65b0\u5efa\u9879\u76ee\u3011\u3002 \u5728\u65b0\u5efa\u9879\u76ee\u9875\u9762\uff0c\u586b\u5199\u9879\u76ee\u57fa\u672c\u4fe1\u606f\uff0c\u5b8c\u6210\u540e\u70b9\u51fb\u4fdd\u5b58\u3002 \u9879\u76ee\u540d\u79f0\uff1a\u8f93\u5165\u201c\u667a\u80fd\u706f\u6f14\u793a\u201d\u6216\u5176\u4ed6\u540d\u79f0\u3002 \u9879\u76ee\u63cf\u8ff0\uff1a\u6309\u7167\u5b9e\u9645\u9700\u6c42\u586b\u5199\u9879\u76ee\u63cf\u8ff0\u3002","title":"3.1.1 \u65b0\u5efa\u9879\u76ee"},{"location":"28.BLE_Device_Quick_Start/#312","text":"\u8fdb\u5165\u8be5\u9879\u76ee\u7684\u4ea7\u54c1\u5217\u8868\u9875\u9762\uff0c\u5355\u51fb\u3010\u65b0\u5efa\u4ea7\u54c1\u3011\u3002 \u5728\u65b0\u5efa\u4ea7\u54c1\u9875\u9762\uff0c\u586b\u5199\u4ea7\u54c1\u57fa\u672c\u4fe1\u606f\uff0c\u5b8c\u6210\u540e\u70b9\u51fb\u4fdd\u5b58\u3002 \u4ea7\u54c1\u540d\u79f0\uff1a\u8f93\u5165\u201c\u84dd\u7259\u667a\u80fd\u706f\u201d\u6216\u5176\u4ed6\u4ea7\u54c1\u540d\u79f0\u3002 \u4ea7\u54c1\u7c7b\u578b\uff1a\u9009\u62e9\u201c\u667a\u6167\u751f\u6d3b\u2014\u7535\u5de5\u7167\u660e\u2014\u706f\u201d\u3002 \u8bbe\u5907\u7c7b\u578b\uff1a\u9009\u62e9\u201c\u8bbe\u5907\u201d\u3002 \u8ba4\u8bc1\u65b9\u5f0f\uff1a\u9009\u62e9\u201c\u5bc6\u94a5\u8ba4\u8bc1\u201d\u3002 \u901a\u4fe1\u65b9\u5f0f\uff1a\u9009\u62e9\u201cBLE\u201d\u3002 \u5176\u4ed6\u9009\u9879\u4fdd\u6301\u9ed8\u8ba4\u3002","title":"3.1.2 \u65b0\u5efa\u4ea7\u54c1"},{"location":"28.BLE_Device_Quick_Start/#313","text":"\u6253\u5f00\u521a\u521a\u521b\u5efa\u7684\u3010\u84dd\u7259\u667a\u80fd\u706f\u3011\u4ea7\u54c1\u3002 \u9009\u62e9\u3010\u6570\u636e\u6a21\u677f\u3011\uff0c\u70b9\u51fb\u3010\u5bfc\u5165JSON\u3011\u3002 \u6253\u5f00\u4ee3\u7801\u4e2d\u7684 examples\\nimble_llsync\\date_templatenrf52832.json \uff0c\u5982\u679c\u51fa\u73b0\u4e71\u7801\u8bf7\u5c06\u60a8\u7684\u7f16\u8f91\u5668\u4fee\u6539\u4e3autf8\u7f16\u7801\uff0c\u5c06\u6587\u4ef6\u4e2d\u7684\u4ee3\u7801\u7c98\u8d34\u8fdb\u6765\uff0c\u70b9\u51fb\u3010\u5bfc\u5165\u3011\u3002","title":"3.1.3 \u521b\u5efa\u6570\u636e\u6a21\u677f"},{"location":"28.BLE_Device_Quick_Start/#314","text":"\u914d\u7f6e\u4ea7\u54c1\u5728\u5c0f\u7a0b\u5e8f\u7aef\u7684\u63a7\u5236\u9762\u677f\u3001\u914d\u7f51\u5f15\u5bfc\u3001\u5feb\u6377\u5165\u53e3\uff0c\u82e5\u4e0d\u914d\u7f6e\u5219\u4f7f\u7528\u7cfb\u7edf\u9ed8\u8ba4\u914d\u7f6e\u3002","title":"3.1.4 \u4ea4\u4e92\u5f00\u53d1\u914d\u7f6e"},{"location":"28.BLE_Device_Quick_Start/#315","text":"\u5728\u8bbe\u5907\u8c03\u8bd5\u9875\u9762\u4e2d\uff0c\u5355\u51fb\u3010\u65b0\u5efa\u8bbe\u5907\u3011\uff0c\u8f93\u5165\u8bbe\u5907\u540d\u201cble_device_01\u201d\u6216\u5176\u4ed6\u8bbe\u5907\u540d\u79f0\uff0c\u70b9\u51fb\u3010\u4fdd\u5b58\u3011\u3002","title":"3.1.5 \u65b0\u5efa\u8bbe\u5907"},{"location":"28.BLE_Device_Quick_Start/#32","text":"","title":"3.2 \u8bbe\u5907\u7aef\u64cd\u4f5c"},{"location":"28.BLE_Device_Quick_Start/#321","text":"\u5f00\u53d1\u677f\u5b9e\u7269\u5982\u4e0b\uff1a \u6307\u793a\u706f\u4f5c\u7528\u5982\u4e0b - LED1: \u5f00\u5173 - LED2: action - LED3: replay - LED4: \u672a\u4f7f\u7528 \u4f7f\u7528USB\u7ebf\u8fde\u63a5\u5f00\u53d1\u677f\u5de6\u4e0a\u89d2\u4e32\u53e3\u3002 \u4f7f\u7528JLink\u8fde\u63a5\u5f00\u53d1\u677f\u53f3\u4e0b\u89d2\u4e0b\u8f7d\u7ebf\u63a5\u53e3\u3002 \u6253\u5f00\u5de6\u4e0a\u89d2\u7535\u6e90\u5f00\u5173\u3002 \u6253\u5f00\u8bbe\u5907\u7ba1\u7406\u5668\uff0c\u786e\u4fdd\u4e32\u53e3\u548cJLink\u80fd\u591f\u6b63\u5e38\u8bc6\u522b\uff0c\u82e5\u4e0d\u80fd\u8bc6\u522b\u8bf7\u91cd\u65b0\u5b89\u88c5\u9a71\u52a8\u3002","title":"3.2.1 \u786c\u4ef6\u7b80\u4ecb\u4e0e\u8fde\u63a5"},{"location":"28.BLE_Device_Quick_Start/#322","text":"\u65b0\u4e70\u5230\u7684nrf52832\u5f00\u53d1\u677f\u53ef\u80fd\u5df2\u7ecf\u70e7\u5199\u4e86 NORDIC \u5b98\u65b9\u84dd\u7259\u534f\u8bae\u6808\uff0c\u9700\u8981\u8fdb\u884c\u64e6\u9664\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4\u4e0b\u8f7d\u5931\u8d25\u3001\u7a0b\u5e8f\u5f02\u5e38\u6216\u5176\u4ed6\u95ee\u9898 \u542f\u52a8 JFlash.exe\uff0c\u9009\u62e9 File -> New project \u70b9\u51fb\u7701\u7565\u53f7\u6dfb\u52a0\u8bbe\u5907 \u5728\u201cDevice\u201d\u4e2d\u8f93\u5165nrf52832\uff0c\u9009\u62e9\u5177\u4f53\u82af\u7247\u578b\u53f7\uff0c\u4f8b\u7a0b\u4e2d\u4f7f\u7528\u7684\u4e3anRF52832_xxAA \u9009\u62e9 Target -> Manual Programming -> Erase Chip \u64e6\u9664\u82af\u7247 \u64e6\u9664\u5b8c\u6210\u540e\u5373\u53ef\u7ee7\u7eed\u8fdb\u884c\u4e4b\u540e\u7684\u5f00\u53d1","title":"3.2.2 \u51c6\u5907\u8f6f\u4ef6\u73af\u5883"},{"location":"28.BLE_Device_Quick_Start/#323","text":"\u6253\u5f00\u5de5\u7a0b board\\Nordic_NRF52832\\KEIL\\llsync\\TencentOS_tiny.uvprojx \u3002 \u6253\u5f00\u6587\u4ef6 ble_qiot_import.c \uff0c\u627e\u5230\u4ee5\u4e0b\u4e09\u4e2a\u5b8f\u5e76\u4fee\u6539\u4e3a\u4f60\u81ea\u5df1\u7684\u8bbe\u5907\u4fe1\u606f\u3002 \u5728\u3010\u8bbe\u5907\u8c03\u8bd5\u3011\u9875\u9762\u4e2d\u9009\u62e9\u3010\u8bbe\u5907\u4fe1\u606f\u3011\u5b50\u9875\u9762\uff0c\u5c06\u3010\u8bbe\u5907\u540d\u79f0\u3011\u3001\u3010\u8bbe\u5907\u5bc6\u94a5\u3011\u3001\u3010\u4ea7\u54c1ID\u3011\u5206\u522b\u586b\u5165 DEVICE_NAME , SECRET_KEY , PRODUCT_ID \u3002 \u5728 ble_qiot_ret_status_t ble_qiot_explorer_init(void) \u4e2d\u6216\u5176\u4ed6\u5408\u9002\u7684\u5730\u65b9\u4fee\u6539\u65e5\u5fd7\u7b49\u7ea7 ble_qiot_set_log_level(BLE_QIOT_LOG_LEVEL_DEBUG); \uff0c\u4ee5\u4fbf\u5f00\u53d1\u8c03\u8bd5\u3002 \u7f16\u8bd1\u4e0b\u8f7d\u5e76\u8fd0\u884c\u3002","title":"3.2.3 \u4ee3\u7801\u4fee\u6539\u4e0e\u70e7\u5f55"},{"location":"28.BLE_Device_Quick_Start/#33","text":"\u5fae\u4fe1\u4e3b\u9875\u9762\u4e0b\u62c9\u5e76\u641c\u7d22\u3010\u817e\u8baf\u8fde\u8fde\u3011\u5c0f\u7a0b\u5e8f\u3002 \u70b9\u51fb\u4e0b\u65b9\u7684\u3010\u52a0\u53f7\u3011\u6dfb\u52a0\u8bbe\u5907\u3002 \u5f85\u626b\u63cf\u5230\u84dd\u7259\u8bbe\u5907\u540e\u70b9\u51fb\u53f3\u4fa7\u7684\u3010\u8fde\u63a5\u3011\u3002 \u5728\u3010\u6211\u7684\u8bbe\u5907\u3011\u4e2d\u6253\u5f00\u521a\u521a\u6dfb\u52a0\u7684\u84dd\u7259\u8bbe\u5907\u3002 \u70b9\u51fb\u53f3\u4fa7\u7684\u3010\u7acb\u5373\u8fde\u63a5\u3011\u8fde\u63a5\u8bbe\u5907\u3002 \u8fde\u63a5\u6210\u529f\u540e\u70b9\u51fb\u3010\u7535\u706f\u5f00\u5173\u3011\uff0c\u53ef\u4ee5\u770b\u5230\u5f00\u53d1\u7248\u4e0a\u3010LED1\u3011\u968f\u4e4b\u53d8\u5316\u3002 \u70b9\u51fb\u3010\u4eae\u5ea6\u3011\u6216\u3010\u989c\u8272\u3011\u6309\u94ae\u8fdb\u884c\u8bbe\u7f6e \u67e5\u770b\u4e32\u53e3\u6253\u5370\uff0c\u53ef\u4ee5\u770b\u5230\u4eae\u5ea6\u3001\u989c\u8272\u8bbe\u7f6e\u6210\u529f","title":"3.3 \u817e\u8baf\u8fde\u8fde\u5c0f\u7a0b\u5e8f\u8c03\u8bd5"},{"location":"28.BLE_Device_Quick_Start/#4-qa","text":"Q: \u5b9e\u9645\u4ea7\u54c1\u4e2d\u5982\u4f55\u5904\u7406\u8bbe\u5907\u4fe1\u606f\uff1f A: \u4f8b\u7a0b\u4e2d DEVICE_NAME , SECRET_KEY , PRODUCT_ID \u76f4\u63a5\u5199\u5728\u4ee3\u7801\u4e2d\uff0c\u4ea7\u54c1\u4e2d\u5e94\u4fdd\u5b58\u5728Flash\u4e2d\uff0c\u540c\u65f6\u4fee\u6539 ble_qiot_import.c \u4e2d ble_get_product_id() , ble_get_device_name() , ble_get_psk() \u4e09\u4e2a\u51fd\u6570\u3002 Q: LLSync SDK \u9700\u8981\u591a\u5927\u7684 Flash \u6765\u4fdd\u5b58\u914d\u7f6e\u4fe1\u606f\uff1f A: \u76ee\u524d\u53ea\u9700\u8981\u4e0d\u523032\u5b57\u8282\u3002 Q: \u5982\u679c\u5f00\u53d1\u5176\u4ed6 BLE \u82af\u7247\uff0c\u6709\u4ec0\u4e48\u6ce8\u610f\u4e8b\u9879\uff1f A: components\\connectivity\\qcloud_iot_explorer_ble\\inc\\ble_qiot_import.h \u4e3a\u7528\u6237\u9700\u8981\u79fb\u690d\u9002\u914d\u7684\u63a5\u53e3\uff0c\u4e0e\u84dd\u7259\u534f\u8bae\u6808\u76f8\u5173\u7684\u63a5\u53e3\u5728 ble_qiot_import.c \u4e2d\u5df2\u7ecf\u5b8c\u6210\u4e86\u9002\u914d\uff0c\u7528\u6237\u4ec5\u9700\u6839\u636e\u5b9e\u9645\u4ea7\u54c1\u8981\u5f00\u53d1 ble_write_flash() , ble_read_flash() \u7b49\u63a5\u53e3\u3002","title":"4 Q&amp;A"},{"location":"28.BLE_Device_Quick_Start/#5","text":"LLSync SDK \u5185\u76f8\u5173\u6587\u6863 LLSync SDK \u63a5\u5165\u6307\u5f15 LLSync SDK \u4f7f\u7528\u53c2\u8003","title":"5 \u53c2\u8003\u8d44\u6599"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/","text":"\u4e00\u3001\u7532\u919b\u76d1\u6d4b\u4eea\u4ecb\u7ecd \u7532\u919b\u662f\u5ba4\u5185\u4e00\u9879\u975e\u5e38\u91cd\u8981\u7684\u6307\u6807\uff0c\u8d2d\u4e70\u4e00\u53f0\u7532\u919b\u76d1\u6d4b\u4eea\u53c8\u663e\u5f97\u592a\u4e0d\u5212\u7b97\uff0c\u4eca\u5929\u5c31\u6765\u6559\u5927\u5bb6\u5982\u4f55\u4f7f\u7528TOS_EVB_G0\u5f00\u53d1\u677f + TencentOS-tiny\u7269\u8054\u7f51\u64cd\u4f5c\u7cfb\u7edf\uff0c\u6765\u81ea\u5236\u4e00\u4e2a\u7b80\u5355\u7684\u7532\u919b\u76d1\u6d4b\u4eea\u3002 \u672c\u9879\u76ee\u5236\u4f5c\u7684\u7532\u919b\u76d1\u6d4b\u4eea\u53ef\u4ee5\u5b9e\u65f6\u7684\u68c0\u6d4b\u5ba4\u5185\u7532\u919b\u6d53\u5ea6\uff0c\u5728OLED\u5c4f\u5e55\u4e0a\u663e\u793a\u5177\u4f53\u6570\u503c\uff0c\u540c\u65f6\u8fd8\u53ef\u4ee5\u5c06\u6570\u636e\u5b9e\u65f6\u4e0a\u62a5\u5230\u817e\u8baf\u4e91\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0IoT Explorer\uff0c\u7528\u6237\u53ef\u4ee5\u5728\u201c\u817e\u8baf\u8fde\u8fde\u201d\u5c0f\u7a0b\u5e8f\u5b9e\u65f6\u67e5\u770b\u6570\u636e\uff0c\u5e76\u901a\u8fc7\u516c\u4f17\u53f7\u53ca\u65f6\u63a5\u6536\u544a\u8b66\u4fe1\u606f\u3002 \u672c\u9879\u76ee\u6240\u9700\u8981\u7684\u7269\u54c1\u6e05\u5355\u6709\uff1a TOS_EVB_G0\u5f00\u53d1\u677f x 1 \u82f1\u56fd Dart \u7532\u919b\u4f20\u611f\u5668 x 1 E53\u7532\u919b\u4f20\u611f\u5668\u5e95\u677f x 1 \u6210\u54c1\u7ec4\u88c5\u56fe\uff08\u5b89\u88c5\u5404\u63a5\u63d2\u4ef6\u65f6\uff0c\u8bf7\u52a1\u5fc5\u53c2\u8003\u6210\u54c1\u56fe\uff0c\u4e0d\u8981\u5f04\u9519\u65b9\u5411\uff0c\u5426\u5219\u53ef\u80fd\u70e7\u574fMCU\uff09 \u597d\u5566~\u63a5\u4e0b\u6765\u5f00\u59cb\u6211\u4eec\u7684\u5236\u4f5c\uff01 \u4e8c\u3001TOS_EVB_G0\u5f00\u53d1\u677f 1. \u5f00\u53d1\u677f\u7279\u6027 TOS_EVB_G0 \u5f00\u53d1\u677f\u662f\u7531\u817e\u8bafTencentOS-tiny\u56e2\u961f\u8bbe\u8ba1\u7684\u4e00\u6b3e\u7269\u8054\u7f51\u5f00\u53d1\u677f\uff0c\u677f\u8f7d\u8d44\u6e90\u5982\u4e0b\uff1a \u4e3b\u63a7\u82af\u7247\u91c7\u7528STM32G070RB\uff0cFlash:128KB\u3001RAM:36KB\uff1b \u677f\u8f7d\u817e\u8baf\u4e91\u5b9a\u5236\u56fa\u4ef6\u7248ESP8266 WIFI\u6a21\u7ec4\uff1b \u677f\u8f7dE53\u4f20\u611f\u5668\u6807\u51c6\u63a5\u53e3\uff0c\u65b9\u4fbf\u8fde\u63a5\u5404\u79cdE53\u4f20\u611f\u5668\uff1b \u677f\u8f7d0.91'OLED\u663e\u793a\u5c4f\u5e55\uff1b \u677f\u8f7d8MB SPI Flash\uff0c\u53ef\u7528\u4e8e\u56fa\u4ef6\u5347\u7ea7\uff1b \u677f\u8f7dCH340 \u8f6c\u4e32\u53e3\u8fde\u63a5\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e00\u6839USB\u7ebf\u8fde\u63a5\u81f3\u7535\u8111\uff0c\u67e5\u770b\u4e32\u53e3\u65e5\u5fd7\uff0c\u5347\u7ea7esp8266\u56fa\u4ef6\uff0c\u53d1\u9001AT\u6307\u4ee4 \u4e0b\u9762\u662f\u6bcf\u90e8\u5206\u8be6\u7ec6\u7684\u8bf4\u660e\u3002 2. \u5f00\u53d1\u677f\u786c\u4ef6\u7535\u8def\u8be6\u89e3 2.1. \u6700\u5c0f\u7cfb\u7edf\u7535\u8def \u6700\u5c0f\u7cfb\u7edf\u90e8\u5206\u7531\u7535\u6e90\u7535\u8def\u3001\u65f6\u949f\u7535\u8def\u3001Boot\u7535\u8def\u3001\u590d\u4f4d\u7535\u8def\u3001\u4e0b\u8f7d\u7535\u8def\u7ec4\u6210\uff1a 2.2. WIFI\u7535\u8def WIFI\u90e8\u5206\u5305\u62ecESP8266 WIFI\u6a21\u7ec4\u4f9b\u7535\u7535\u8def\u3001\u4e32\u53e3\u901a\u4fe1\u7535\u8def\uff1a 2.3. E53\u6269\u5c55\u63a5\u53e3\u7535\u8def E53\u6269\u5c55\u63a5\u53e3\u4f9b\u5916\u90e8\u4f20\u611f\u5668\u8fde\u63a5\uff0c\u5305\u62ec\uff1a\u4e00\u4e2a\u4e32\u53e3\u3001\u4e00\u4e2aSPI\u63a5\u53e3\u3001\u4e00\u4e2aIIC\u63a5\u53e3\u3001\u56db\u4e2a\u666e\u901aGPIO\u53e3\u3001\u4e00\u4e2aADC\u6a21\u62df\u91c7\u96c6\u63a5\u53e3\uff0c\u4e00\u4e2aDAC\u6a21\u62df\u8f93\u51fa\u63a5\u53e3\uff0c\u5982\u56fe\uff1a 2.4. USB\u8f6c\u4e32\u53e3\u7535\u8def USB\u8f6c\u4e32\u53e3\u7535\u8def\u5c06\u4e32\u53e3\u4fe1\u606f\u8f6c\u6362\u4e3aUSB\u53e3\u4fe1\u53f7\uff0c\u4f7f\u5f97\u5f00\u53d1\u677f\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7USB\u7ebf\u8fde\u63a5\u81f3PC\uff0c\u5728PC\u4e0a\u4f7f\u7528\u4e32\u53e3\u52a9\u624b\u67e5\u770b\u65e5\u5fd7\uff1a 2.5. OLED\u663e\u793a\u5c4f\u5e55\u7535\u8def OLED\u5c4f\u5e55\u90e8\u5206\u5305\u62ecOLED\u4f9b\u7535\u90e8\u5206\u548c\u901a\u4fe1\u90e8\u5206\uff1a 2.6. \u8fde\u63a5Micor USB\u7ebf 2.7. \u8fde\u63a5ST-Link\u4e0b\u8f7d\u5668 \u5f00\u53d1\u677f3v3---> STlink 3.3V \u5f00\u53d1\u677fDIO---> STlink SWDIO \u5f00\u53d1\u677fCLK---> STlink SWCLK \u5f00\u53d1\u677fGND---> STlink GND \u8bf7\u5927\u5bb6\u53c2\u8003\u4e0b\u56fe\u8fdb\u884c\u8fde\u63a5\uff0c\u5343\u4e07\u4e0d\u8981\u63a5\u53cd\u63a5\u9519\uff0c\u4ee5\u514d\u70e7\u6389MCU 3. \u5f00\u53d1\u677f\u8f6f\u4ef6\u73af\u5883\u51c6\u5907 3.1 MDK\u8f6f\u4ef6\u4ecb\u7ecd MDK \u5373RealView MDK \u6216MDK-ARM\uff08Microcontroller Development kit\uff09\uff0c\u662f ARM \u516c\u53f8\u6536\u8d2dKeil\u516c\u53f8\u4ee5\u540e\uff0c\u57fa\u4e8euVision\u754c\u9762\u63a8\u51fa\u7684\u9488\u5bf9ARM7\u3001ARM9\u3001Cortex-M0\u3001Cortex-M1\u3001Cortex-M2\u3001Cortex-M3\u3001Cortex-R4\u7b49ARM\u5904\u7406\u5668\u7684\u5d4c\u5165\u5f0f\u8f6f\u4ef6\u5f00\u53d1\u5de5\u5177\u3002MDK-ARM \u96c6\u6210\u4e86\u4e1a\u5185\u6700\u9886\u5148\u7684\u6280\u672f\uff0c\u5305\u62ec uVision4 \u96c6\u6210\u5f00\u53d1\u73af\u5883\u4e0e RealView \u7f16\u8bd1\u5668RVCT\u3002\u652f\u6301 ARM7\u3001ARM9 \u548c\u6700\u65b0\u7684Cortex-M3/M1/M0 \u6838\u5904\u7406\u5668\uff0c\u81ea\u52a8\u914d\u7f6e\u542f\u52a8\u4ee3\u7801\uff0c\u96c6\u6210 Flash \u70e7\u5199\u6a21\u5757\uff0c\u5f3a\u5927\u7684 Simulation \u8bbe\u5907\u6a21\u62df\uff0c\u6027\u80fd\u5206\u6790\u7b49\u529f\u80fd\uff0c\u4e0e ARM \u4e4b\u524d\u7684\u5de5\u5177\u5305 ADS \u7b49\u76f8\u6bd4\uff0cRealView \u7f16\u8bd1\u5668\u7684\u6700\u65b0\u7248\u672c\u53ef\u5c06\u6027\u80fd\u6539\u5584\u8d85\u8fc7 20%\u3002 Keil\u516c\u53f8\u5f00\u53d1\u7684ARM\u5f00\u53d1\u5de5\u5177MDK\uff0c\u662f\u7528\u6765\u5f00\u53d1\u57fa\u4e8eARM\u6838\u7684\u7cfb\u5217\u5fae\u63a7\u5236\u5668\u7684\u5d4c\u5165\u5f0f\u5e94\u7528\u7a0b\u5e8f\u3002\u5b83\u9002\u5408\u4e0d\u540c\u5c42\u6b21\u7684\u5f00\u53d1\u8005\u4f7f\u7528\uff0c\u5305\u62ec\u4e13\u4e1a\u7684\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u5de5\u7a0b\u5e08\u548c\u5d4c\u5165\u5f0f\u8f6f\u4ef6\u5f00\u53d1\u7684\u5165\u95e8\u8005\u3002MDK\u5305\u542b\u4e86\u5de5\u4e1a\u6807\u51c6\u7684Keil C\u7f16\u8bd1\u5668\u3001\u5b8f\u6c47\u7f16\u5668\u3001\u8c03\u8bd5\u5668\u3001\u5b9e\u65f6\u5185\u6838\u7b49\u7ec4\u4ef6\uff0c\u652f\u6301\u6240\u6709\u57fa\u4e8eARM\u7684\u8bbe\u5907\uff0c\u80fd\u5e2e\u52a9\u5de5\u7a0b\u5e08\u6309\u7167\u8ba1\u5212\u5b8c\u6210\u9879\u76ee\u3002 3.2 MDK\u5b89\u88c5 \u767b\u5f55MDK\u5b98\u7f51\uff0c\u4e0b\u8f7dMDK5\u8f6f\u4ef6\uff0c\u4e0b\u8f7d\u5730\u5740\uff1a http://www2.keil.com/mdk5 \u6216\u8005 https://www.keil.com/download/product/ \u4e0b\u8f7d\u7684\u7248\u672c\u6700\u597d\u57285.24\u4ee5\u4e0a\uff0c\u672c\u5f00\u53d1\u6559\u7a0b\u4ee55.24\u7248\u672c\u4e3a\u4f8b\uff0c\u53cc\u51fbMDK524\u5e94\u7528\u7a0b\u5e8f\u6587\u4ef6\uff0c\u70b9\u51fbnext>>\u3002 \u6253\u4e0a I agree\u524d\u9762\u7684\u52fe\u52fe\uff0c\u5373\u662f\u540c\u610f\u4e00\u4e9b\u5b89\u88c5\u534f\u8bae\u3002\u70b9\u51fbnext>>\u3002 \u9009\u62e9\u5b89\u88c5\u8def\u5f84\uff0c\u53ef\u4ee5\u9ed8\u8ba4\u4e5f\u53ef\u4ee5\u5b89\u88c5\u5728\u6211\u4eec\u81ea\u5df1\u5efa\u7acb\u7684\u6587\u4ef6\u5939\u4e0b\u3002\u70b9\u51fbnext>>\u3002 \u8fd9\u91cc\u586b\u5199\u7684\u662f\u6211\u4eec\u7684\u4e00\u4e9b\u4fe1\u606f\uff0c\u586b\u5199\u5b8c\u6574\u540e\uff0c\u7ee7\u7eednext>>\u3002 \u7136\u540e\u7b49\u5f85\u5b89\u88c5\u5b8c\u6210\u5373\u53ef\u3002 \u5b89\u88c5\u5b8c\u6210\uff0c\u70b9\u51fbFinish\u3002 \u7136\u540e\u4f1a\u8df3\u51fa\u6765\u8fd9\u4e2a\u754c\u9762\uff0c\u8fd9\u4e2a\u6211\u4eec\u540e\u9762\u518d\u8bb2\uff0c\u5148\u70b9OK\uff0c\u628a\u5f39\u6846\u90fd\u53c9\u6389\u3002 \u6fc0\u6d3bMDK\uff0c\u5bfc\u5165License,\u6fc0\u6d3bMDK\u540e\u4fbf\u53ef\u4f7f\u7528\u4e86\u3002 \u7279\u522b\u63d0\u793a\uff1a\u4e00\u5b9a\u8981\u8f93\u5165License\u6fc0\u6d3bMDK\u8f6f\u4ef6\uff0c\u5efa\u8bae\u8d2d\u4e70\u6b63\u7248License\u3002 3.3 MDK\u5b89\u88c5 \u5b89\u88c5\u5b8cMDK\u540e\uff0c\u6211\u4eec\u9700\u8981\u5b89\u88c5\u5f00\u53d1\u5957\u4ef6\u4e2d\u5355\u7247\u673a\u578b\u53f7\u5bf9\u5e94\u7684Pack\u3002 \u5b89\u88c5\u65b9\u5f0f\u4e00 \u767b\u5f55\u5b98\u7f51\uff1ahttp://www.keil.com/dd2/pack/ \u4e0b\u8f7dKeil.STM32G0xx_DFP.x.x.x.pack \u540e\u5b89\u88c5\u3002 \u5b89\u88c5\u65b9\u5f0f\u4e8c MDK\u8f6f\u4ef6\u4e0a\u5728\u7ebf\u5b89\u88c5 \u6253\u5f00\u8f6f\u4ef6\uff0c\u5728\u5bfc\u822a\u680f\u6253\u5f00Pack\u5b89\u88c5\u754c\u9762\uff0c\u7136\u540e\u9009\u62e9ok\u9009\u9879\u3002 \u8fdb\u5165\u5728\u7ebf\u5b89\u88c5\u754c\u9762\uff0c\u9009\u7740STM32G0XX Pack,\u70b9\u51fbInstall\u8fdb\u884c\u5b89\u88c5\u3002 \u81f3\u6b64\uff0c\u6211\u4eec\u5f00\u53d1\u677f\u7684\u5355\u7247\u673a\u7a0b\u5e8f\u5f00\u53d1\u73af\u5883\u5df2\u7ecf\u642d\u5efa\u5b8c\u6bd5\uff0c\u91cd\u542fMDK\u8f6f\u4ef6\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002 3.4 ST-Link\u9a71\u52a8\u5b89\u88c5 \u524d\u9762\u8bb2\u4e86\u5f00\u53d1\u677f\u5355\u7247\u673a\u7a0b\u5e8f\u7684\u5f00\u53d1\u73af\u5883\u7684\u642d\u5efa\uff0c\u4f46\u662f\u4e3a\u4e86\u5c06\u7a0b\u5e8f\u70e7\u5f55\u5230\u5f00\u53d1\u677f\u4e2d\u6211\u4eec\u8fd8\u9700\u8981\u4f7f\u7528\u4eff\u771f\u5668\u3002\u6211\u4eec\u8fd9\u5957\u5f00\u53d1\u677f\u9009\u7528ST\u516c\u53f8\u7684ST-Link V2\u4eff\u771f\u5668\u8fdb\u884c\u5f00\u53d1\u677f\u7a0b\u5e8f\u7684\u70e7\u5199\u548c\u4eff\u771f\uff0c\u4e0b\u9762\u4ecb\u7ecdST-Link\u9a71\u52a8\u7684\u5b89\u88c5\u53ca\u73af\u5883\u642d\u5efa\u3002 \u5728ST\u5b98\u7f51\u4e0b\u8f7dST-Link\u9a71\u52a8\uff0c https://www.st.com/content/st_com/zh/products/development-tools/software-development-tools/stm32-software-development-tools/stm32-utilities/stsw-link009.html \uff08\u9a71\u52a8\u67092\u79cd\uff1a 32\u4f4d\u7535\u8111\u7cfb\u7edf\u5b89\u88c5\u201cdpinst_x86\u201d\u300164\u4f4d\u7535\u8111\u7cfb\u7edf\u5b89\u88c5\u201cdpinst_amd64\u201d\uff09\u3002 \u8fd0\u884c\u5bf9\u5e94\u7684\u9a71\u52a8\uff0c\u5b89\u88c5ST-Link V2\u9a71\u52a8\u7a0b\u5e8f\u3002\u5b89\u88c5\u8def\u5f84\u5c3d\u91cf\u4fdd\u6301\u9ed8\u8ba4\u8def\u5f84\u3002 \u5b89\u88c5\u5b8c\u6210\u540e, \u5c06ST-Link\u901a\u8fc7USB\u63a5\u53e3\u8fde\u5165\u7535\u8111\u3002\u6253\u5f00\u201c\u8bbe\u5907\u7ba1\u7406\u5668\u201d\u3002\u82e5\u770b\u5230\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u8868\u793a\u9a71\u52a8\u5b89\u88c5\u6210\u529f\u3002 \u8fd9\u91cc\u63d0\u9192 2 \u70b9: 1\uff0c \u5404\u79cd windows \u7248\u672c\u8bbe\u5907\u540d\u79f0\u548c\u6240\u5728\u8bbe\u5907\u7ba1\u7406\u5668\u680f\u76ee\u53ef\u80fd\u4e0d\u4e00\u6837\uff0c\u4f8b\u5982 WIN10 \u63d2\u4e0aSTLINK \u540e\u663e\u793a\u7684\u662f STM32 STLINK\u3002 2\uff0c \u5982\u679c\u8bbe\u5907\u540d\u79f0\u65c1\u8fb9\u663e\u793a\u7684\u662f\u9ec4\u8272\u7684\u53f9\u53f7\uff0c\u8bf7\u76f4\u63a5\u70b9\u51fb\u8bbe\u5907\u540d\u79f0\uff0c\u7136\u540e\u5728\u5f39\u51fa\u7684\u754c\u9762\u70b9\u51fb\u66f4\u65b0\u8bbe\u5907\u9a71\u52a8 \u81f3\u6b64\uff0c ST-Link \u9a71\u52a8\u5df2\u7ecf\u5b89\u88c5\u5b8c\u6210\u3002\u63a5\u4e0b\u6765\u5927\u5bb6\u53ea\u9700\u8981\u5728 MDK\u5de5\u7a0b\u91cc\u9762\u914d\u7f6e\u4e00\u4e0b ST-Link\u5373\u53ef\u3002 3.5 CH340\u4e32\u53e3\u9a71\u52a8\u5b89\u88c5 \u4e92\u8054\u7f51\u641c\u7d22\u4e0b\u8f7dCH340 \u4e32\u53e3\u82af\u7247\u7684\u9a71\u52a8 \u5b89\u88c5\u65b9\u6cd5\uff1a\u6253\u5f00\u9a71\u52a8\u5b89\u88c5\u7a0b\u5e8f\u70b9\u51fb\u5b89\u88c5\u5373\u53ef\u3002 \u6ce8\uff1a\u82e5\u5b89\u88c5\u5931\u8d25\uff0c\u8bf7\u5148\u70b9\u51fb\u5378\u8f7d\uff0c\u540e\u70b9\u51fb\u5b89\u88c5\u3002 3.7 \u4e32\u53e3\u8c03\u8bd5\u52a9\u624b\u7684\u5b89\u88c5\u4e0e\u4f7f\u7528 \u5de5\u5177\u4e0b\u8f7d\uff1a http://www.daxia.com/download/sscom.rar \u5b89\u88c5\u65b9\u6cd5\uff1a\u4e32\u53e3\u8c03\u8bd5\u52a9\u624bsscom5.13.1\u662f\u514d\u5b89\u88c5\u7684\uff0c\u89e3\u538b\u51fa\u538b\u7f29\u5305\u5373\u53ef\u76f4\u63a5\u4f7f\u7528\u3002 \u6839\u636ePC\u548c\u7ec8\u7aef\u4e4b\u95f4\u7684\u8fde\u63a5\uff0c\u9009\u62e9\u6b63\u786e\u7684\u4e32\u884c\u7aef\u53e3\u3002 \u6253\u5f00\u7535\u8111\u7684\u8bbe\u5907\u7ba1\u7406\u5668\uff0c\u5728\u7aef\u53e3\u5217\u8868\u53ef\u4ee5\u770b\u5230PC\u4e0e\u5f00\u53d1\u677f\u8fde\u63a5\u7684\u7aef\u53e3\u53f7\u3002 \u6211\u8fd9\u91cc\u663e\u793a\u7684\u662fCOM26\uff0c\u6240\u4ee5\u8981\u5728sscom\u5de5\u5177\u4e2d\u9009\u62e9COM26\uff0c\u5f00\u53d1\u677f\u7a0b\u5e8f\u6ce2\u7279\u7387\u8bbe\u7f6e\u4e3a115200\uff0c\u6240\u4ee5\u6211\u5728sscom\u4e32\u53e3\u5de5\u5177\u4e2d\u9009\u62e9115200\u6ce2\u7279\u7387\u3002 \u4e09\u3001\u70e7\u5199\u817e\u8baf\u4e91\u5b9a\u5236\u56fa\u4ef6 1. \u4e0b\u8f7d\u56fa\u4ef6 \u817e\u8baf\u4e91IoT AT\u6307\u4ee4\u662f\u4e00\u5957\u9488\u5bf9\u4f7f\u7528\u901a\u8baf\u6a21\u7ec4\uff082G/4G/NB/WIFI\uff09\u63a5\u5165\u817e\u8baf\u4e91\u7269\u8054\u5e73\u53f0\u7684\u5b9a\u5236AT\u6307\u4ee4\u96c6\uff0c\u5982\u679c\u901a\u8baf\u6a21\u7ec4\u5b9e\u73b0\u4e86\u8be5\u6307\u4ee4\u96c6\uff0c\u5219\u8bbe\u5907\u63a5\u5165\u548c\u901a\u8baf\u66f4\u4e3a\u7b80\u5355\uff0c\u6240\u9700\u4ee3\u7801\u91cf\u66f4\u5c11\u3002 ESP8266\u4f5c\u4e3aIoT\u9886\u57df\u4f7f\u7528\u6700\u5e7f\u6cdb\u7684\u4e00\u6b3eWiFi\u82af\u7247/\u6a21\u7ec4\uff0c\u817e\u8baf\u4e91\u5728\u5176\u901a\u7528AT\u6307\u4ee4\u57fa\u7840\u4e0a\uff0c\u589e\u52a0\u4e86\u817e\u8baf\u4e91IoT AT\u6307\u4ee4\u96c6\uff0c\u5f62\u6210\u4e00\u4e2a\u5b9a\u5236\u7684\u6a21\u7ec4\u56fa\u4ef6QCloud_IoT_AT_ESP8266\u3002 \u4e0b\u8f7d\u94fe\u63a5\uff1a https://github.com/tencentyun/qcloud-iot-esp-wifi \u4f7f\u7528git\u4e0b\u8f7d\u7684\u547d\u4ee4\u5982\u4e0b\uff1a git clone https://github.com/tencentyun/qcloud-iot-esp-wifi.git \u4e0b\u8f7d\u4e4b\u540e\u5373\u53ef\u5728\u56fe\u4e2d\u5708\u51fa\u7684\u6587\u4ef6\u5939\u4e2d\u770b\u5230\u5b9a\u5236\u56fa\u4ef6\uff1a 2. \u4e0b\u8f7d\u70e7\u5199\u5de5\u5177 \u4f7f\u7528\u4e50\u946b\u5b98\u65b9\u4e0b\u8f7d\u5de5\u5177ESPFlashDownloadTool\uff0c\u4e0b\u8f7d\u94fe\u63a5\u5982\u4e0b\uff1a https://www.espressif.com/zh-hans/support/download/other-tools \u70b9\u51fb\u4e0b\u8f7dFlash \u4e0b\u8f7d\u5de5\u5177\uff08ESP8266 & ESP32 & ESP32-S2\uff09\uff1a \u4e0b\u8f7d\u4e4b\u540e\u89e3\u538b\u5373\u53ef\u3002 3. \u56fa\u4ef6\u8bf4\u660e \u817e\u8baf\u4e91IoT\u5b9a\u5236\u7684AT\u6a21\u7ec4\u56fa\u4ef6QCloud_IoT_AT_ESP8266\uff0c\u9002\u7528\u4e8e\u6240\u6709FLASH\u5927\u5c0f\u4e3a2MB\u6216\u80052MB\u4ee5\u4e0a\u7684ESP8266\u6a21\u7ec4\u3002 AT\u4e32\u53e3\u4f7f\u7528UART0\uff0c\u9ed8\u8ba4\u7684Tx\u4e3aGPIO1\uff0cRx\u4e3aGPIO3\u3002\u4f46\u56e0\u4e3aESP8266\u7684UART0 \u9ed8\u8ba4\u4f1a\u5728\u4e0a\u7535\u542f\u52a8\u671f\u95f4\u8f93\u51fa\u4e00\u4e9b\u6253\u5370\uff0c\u5982\u679c\u6253\u5370\u4fe1\u606f\u5f71\u54cd\u8bbe\u5907\u529f\u80fd\uff0c\u53ef\u5728\u4e0a\u7535\u671f\u95f4\u5c06 U0TXD(GPIO1)\u3001U0RXD(GPIO3) \u5206\u522b\u4e0e U0RTS (GPIO15)\uff0cU0CTS(GPIO13)\u8fdb\u884c\u4ea4\u6362\uff0c\u4ee5\u5c4f\u853d\u6253\u5370\u3002\u56e0\u6b64\u63d0\u4f9b\u4e24\u4e2a\u7248\u672c\u7684\u56fa\u4ef6\uff1a \u540d\u79f0\u5305\u542bUART_1_3\u7684\u56fa\u4ef6\u4e32\u53e3\u4f7f\u7528\u7684Tx\u4e3aGPIO1\uff0cRx\u4e3aGPIO3\u3002 \u540d\u79f0\u5305\u542bUART_15_13\u7684\u56fa\u4ef6\u4e32\u53e3\u4f7f\u7528\u7684Tx\u4e3aGPIO15\uff0cRx\u4e3aGPIO13\u3002 \u8fdb\u5165QCloud_IoT_AT_ESP8266_FW\uff0c\u672c\u6587\u4e2d\u6211\u4eec\u4f7f\u7528\u7b2c\u4e00\u4e2a\u56fa\u4ef6\uff1a 4. \u70e7\u5199\u56fa\u4ef6 4.1. \u5207\u6362boot\u9009\u62e9\u7aef\u5b50\u548c\u4e32\u53e3\u9009\u62e9\u7aef\u5b50 \u2460 \u5c06\u5f00\u53d1\u677f\u4e0a\u7684ESP8266\u542f\u52a8\u5f15\u811a\u914d\u7f6e\u7aef\u5b50\u5207\u6362\u5230\u4f4e\u7535\u5e73\uff1b \u2461 \u5c06\u5f00\u53d1\u677f\u4e0a\u7684\u4e32\u53e3\u9009\u62e9\u7aef\u5b50\u7f6e\u4e8e\u4e2d\u95f4\uff0c\u4f7fESP8266\u76f4\u63a5\u4e0ePC\u4e32\u53e3\u8fde\u63a5\uff1a \u65b9\u6cd5\u53c2\u8003\u4e0b\u56fe\uff1a 4.2. \u8fd0\u884cFlash\u70e7\u5199\u5de5\u5177 \u53cc\u51fb\u5de5\u5177\uff0c\u8fd0\u884c\uff1a \u9009\u62e9\u5f00\u53d1\u8005\u6a21\u5f0f\uff1a \u9009\u62e9ESP8266\u4e0b\u8f7d\u5de5\u5177\uff1a 4.3. \u5f00\u59cb\u4e0b\u8f7d \u6309\u7167\u56fe\u4e2d\u8fdb\u884c\u64cd\u4f5c\uff1a \u70b9\u51fb\u4e0b\u8f7d\u4e4b\u540e\uff0c\u6309\u4e0b\u5f00\u53d1\u677f\u4e0a\u7684\u590d\u4f4d\u952e\uff0cFlash\u4e0b\u8f7d\u5de5\u5177\u5f00\u59cb\u4e0b\u8f7d\uff1a \u82e5\u6ca1\u6709\u663e\u793a\uff0c\u8bf7\u68c0\u67e5\u63a5\u7ebf\u7aef\u5b50\u662f\u5426\u8fde\u63a5\u6b63\u786e\u3002 4.4. \u4e0b\u8f7d\u5b8c\u6210 \u4e0b\u8f7d\u5b8c\u6210\u4e4b\u540e\u5982\u56fe\uff1a \u5173\u95ed\u5de5\u5177\uff0c\u5c06boot\u9009\u62e9\u5f15\u811a\u62d4\u4e0b\uff0c\u5c06\u4e32\u53e3\u9009\u62e9\u7aef\u5b50\u6062\u590d\u9ed8\u8ba4\u3002 \u6ce8\u610f\uff1a\u5b8c\u6210\u56fa\u4ef6\u4e0b\u8f7d\u540e\uff0c\u4e00\u5b9a\u5207\u8bb0\u5c06\u8df3\u7ebf\u7aef\u5b50\u6062\u590d\u5230\u9ed8\u8ba4\u72b6\u6001\uff0c\u9ed8\u8ba4\u7aef\u5b50\u600e\u4e48\u77ed\u63a5\u53ef\u4ee5\u53c2\u8003\u524d\u9762\u5b8c\u6574\u7684\u7ec4\u88c5\u6210\u54c1\u56fe\uff0c\u5426\u5219wifi\u5c06\u6ca1\u6cd5\u5de5\u4f5c\uff0cMCU\u4e5f\u6ca1\u6cd5\u63a7\u5236wifi\u3002 \u56db\u3001\u57fa\u4e8eTencentOS tiny\u63a5\u5165\u817e\u8baf\u4e91IoT Explorer\u6307\u5f15 \u57fa\u4e8eTencentOS Tiny EVB G0\u8981\u5b8c\u6210\u817e\u8baf\u4e91IoT Explorer\u5bf9\u63a5\uff0c\u9700\u8981\u5b8c\u6210\u4e24\u4e2a\u90e8\u5206\u7684\u5de5\u4f5c\u3002 \u4e00\u662f\uff1a\u817e\u8baf\u4e91IoT explorer \u4e0a\u5b8c\u6210\u9879\u76ee\u3001\u4ea7\u54c1\u3001\u8bbe\u5907\u521b\u5efa\u3001\u53c2\u6570\u914d\u7f6e \u4e8c\u662f\uff1a\u57fa\u4e8eTencentOS Tiny\u5b8c\u6210\u5e94\u7528\u5f00\u53d1\uff0c\u5411\u817e\u8baf\u4e91\u4e0a\u62a5\u4e1a\u52a1\u6570\u636e\u3002 1. \u4e91\u7aef\u64cd\u4f5c\u6b65\u9aa4 1.1. \u65b0\u5efa\u9879\u76ee \u767b\u5f55 \u817e\u8baf\u4e91\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0 \uff0c\u70b9\u51fb\u65b0\u5efa\u9879\u76ee\uff0c\u586b\u5199\u9879\u76ee\u540d\u79f0\u548c\u7b80\u4ecb\uff1a 2.2. \u65b0\u5efa\u4ea7\u54c1 \u70b9\u51fb\u9879\u76ee\u540d\u79f0\u8fdb\u5165\u5230\u8be5\u9879\u76ee\u4e2d\uff0c\u70b9\u51fb\u65b0\u5efa\u4ea7\u54c1\uff1a \u4ea7\u54c1\u65b0\u5efa\u6210\u529f\u540e\uff0c\u53ef\u5728\u4ea7\u54c1\u5217\u8868\u9875\u67e5\u770b\u5230\uff1a 2.3. \u6570\u636e\u6a21\u677f \u8fdb\u5165\u4ea7\u54c1\uff0c\u70b9\u51fb\u3010\u6570\u636e\u6a21\u677f\u3011\uff0c\u70b9\u51fb\u3010\u5bfc\u5165JSON\u3011\uff0c\u5bfc\u5165\u4e0b\u9762\u7684JSON\u4ee3\u7801\uff1a { \"version\": \"1.0\", \"profile\": { \"ProductId\": \"BDDSF87WEA\", \"CategoryId\": \"1\" }, \"properties\": [ { \"id\": \"ch20_ppm_value\", \"name\": \"\u7532\u919b\u6d53\u5ea6\u503c\", \"desc\": \"\", \"mode\": \"r\", \"define\": { \"type\": \"float\", \"min\": \"0\", \"max\": \"2\", \"start\": \"0\", \"step\": \"0.001\", \"unit\": \"ppm(mg/m3)\" }, \"required\": false } ], \"events\": [], \"actions\": [] } \u5bfc\u5165\u4e4b\u540e\u81ea\u52a8\u6839\u636ejson\u6587\u4ef6\u521b\u5efa\u7684\u5c5e\u6027\u5982\u4e0b\uff1a 2.4. \u521b\u5efa\u8bbe\u5907 \u70b9\u51fb\u3010\u8bbe\u5907\u8c03\u8bd5\u3011\uff0c\u8fdb\u5165\u540e\u70b9\u51fb\u3010\u65b0\u5efa\u8bbe\u5907\u3011\uff0c\u521b\u5efa\u771f\u5b9e\u8bbe\u5907\uff1a \u521b\u5efa\u6210\u529f\u4e4b\u540e\u8fdb\u5165\u8bbe\u5907\uff0c\u67e5\u770b\u5230\u4ea7\u54c1ID\u3001\u8bbe\u5907\u540d\u79f0\u3001\u8bbe\u5907\u79d8\u94a5\uff1a 2. \u57fa\u4e8eTencentOS Tiny \u5b8c\u6210\u8bbe\u5907\u4fa7\u5e94\u7528\u5f00\u53d1 \u8fdb\u5165 < TencentOS-tiny\\board\\TencentOS_tiny_EVB_G0\\KEIL\\mqtt_iot_explorer_tc_ch20_oled> \u76ee\u5f55\uff0c\u6253\u5f00TencentOS_tiny.uvprojx\u5de5\u7a0b\u3002 2.1. \u4fee\u6539WIFI\u63a5\u5165\u4fe1\u606f \u6253\u5f00 mqtt_iot_explorer_tc_ch20_oled.c \u6587\u4ef6\u7f16\u8f91\uff0c\u4fee\u6539\u8981\u63a5\u5165WIFI\u7684\u540d\u79f0\u548c\u5bc6\u7801\uff08\u5efa\u8bae\u4f7f\u7528\u624b\u673a\u70ed\u70b9\uff0c\u4e0d\u8981\u6709\u7279\u6b8a\u5b57\u7b26\uff09\uff1a 2.2. \u4fee\u6539\u4e91\u7aef\u5bf9\u63a5\u4fe1\u606f \u540c\u6837\u5728\u6b64\u6587\u4ef6\u5b8f\uff0c\u4fee\u6539\u4e91\u7aef\u914d\u7f6e\u4fe1\u606f\uff0c\u4f7f\u7528\u4e4b\u524d\u5728\u4e91\u7aef\u67e5\u770b\u7684\u4fe1\u606f\u66ff\u6362\uff1a 2.3. \u7f16\u8bd1\u5de5\u7a0b \u70b9\u51fb\u7f16\u8bd1\u6309\u94ae\uff0c\u7f16\u8bd1\u6574\u4e2a\u5de5\u7a0b\uff1a 2.4. \u4e0b\u8f7d\u7a0b\u5e8f \u70b9\u51fb\u8fdb\u5165\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\u6309\u7ebd\uff0c\u8fdb\u5165\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\uff1a \u9009\u62e9Debug\u9009\u9879\uff0c\u8fdb\u5165\u4eff\u771f\u5668\u8bbe\u7f6e\u754c\u9762\u3002 \u4e0b\u62c9\u4eff\u771f\u5668\u9009\u62e9\u5217\u8868\uff0c\u9009\u7740ST-Link Debugger\u5e76\u52fe\u9009\u53f3\u4fa7Use,\u70b9\u51fbSettings\u8fdb\u5165ST-Link V2\u4eff\u771f\u5668\u914d\u7f6e\u754c\u9762\u3002 \u5f00\u53d1\u677f\u8bbe\u8ba1\u7684\u7a0b\u5e8f\u70e7\u5f55\u65b9\u5f0f\u4e3aSW\uff0c\u6b64\u5904Unit\u9009\u62e9ST-Link/V2,\u4e14Port\u9009\u62e9SW,\u5e76\u786e\u8ba4\u53f3\u4fa7\u6846\u5185\u662f\u5426\u68c0\u6d4b\u51faSW\u8bbe\u5907\uff0c\u70b9\u51fb<\u786e\u8ba4>\u4fdd\u5b58\u914d\u7f6e\u3002 \u70b9\u51fb\u786e\u5b9a\u4e4b\u540e\uff0c\u56de\u5230\u4e3b\u754c\u9762\uff0c\u70b9\u51fb\u4e0b\u8f7d\u6309\u94ae\uff1a 2.5. \u4f7f\u7528\u4e32\u53e3\u52a9\u624b\u67e5\u770b\u65e5\u5fd7 \u8fd0\u884csscom\u8f6f\u4ef6\uff0c\u6253\u5f00\u7535\u8111\u4e0a\u5f00\u53d1\u677f\u5bf9\u5e94\u7684\u4e32\u53e3\uff0c\u6bd4\u5982\u6211\u9009\u62e9COM26\uff0c\u70b9\u51fb\u3010\u6253\u5f00\u4e32\u53e3\u3011\uff1a \u6309\u4e0b\u5f00\u53d1\u677f\u4e0a\u7684\u590d\u4f4d\u952e\uff0c\u7a0b\u5e8f\u5f00\u59cb\u8fd0\u884c\uff0c\u5373\u53ef\u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u770b\u5230\u7cfb\u7edf\u8fd0\u884c\u6253\u5370\u7684\u65e5\u5fd7\uff1a 3. \u4e91\u7aef\u5e73\u53f0\u67e5\u770b\u8bbe\u5907\u6570\u636e \u56de\u5230\u817e\u8baf\u4e91\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\uff0c\u53ef\u4ee5\u770b\u5230\u8bbe\u5907\u72b6\u6001\u53d8\u4e3a\u3010\u5728\u7ebf\u3011\uff1a \u70b9\u51fb\u3010\u8bbe\u5907\u65e5\u5fd7\u3011\u4e00\u680f\uff0c\u53ef\u4ee5\u770b\u5230\u8bbe\u5907\u4e0a\u62a5\u7684\u7532\u919b\u6d53\u5ea6\u503c\uff1a \u70b9\u51fb\u3010\u8bbe\u5907\u5c5e\u6027\u3011\u4e00\u680f\uff0c\u70b9\u51fb\u3010\u7532\u919b\u6d53\u5ea6\u503c\u3011\u540e\u7684\u3010\u67e5\u770b\u3011\uff0c\u5373\u53ef\u770b\u5230\u7532\u919b\u6d53\u5ea6\u503c\u7684\u5386\u53f2\u6570\u636e\u66f2\u7ebf\u56fe\uff1a \u4e94\u3001\u817e\u8baf\u8fde\u8fde\u5c0f\u7a0b\u5e8f\u64cd\u4f5c\u6b65\u9aa4 1. \u6dfb\u52a0\u5bb6\u5ead \u624b\u673a\u7aef\u5728\u3010\u5fae\u4fe1\u3011\u641c\u7d22\u3010\u817e\u8baf\u8fde\u8fde\u3011\u5c0f\u7a0b\u5e8f\uff0c\u9996\u6b21\u4f7f\u7528\u9700\u8981\u8fdb\u5165\u540e\u70b9\u51fb\u3010\u6211\u7684\u3011->\u3010\u5bb6\u5ead\u7ba1\u7406\u3011\uff0c\u6dfb\u52a0\u4e00\u4e2a\u4f60\u559c\u6b22\u7684\u540d\u79f0\u5373\u53ef\u3002 2. \u6dfb\u52a0\u8c03\u8bd5\u8bbe\u5907 \u8fd4\u56de\u3010\u9996\u9875\u3011\uff0c\u70b9\u51fb\u53f3\u4e0a\u89d2\u201c\u52a0\u53f7\u201d\u56fe\u6807\uff1a \u8fdb\u5165\u540e\u70b9\u51fb\u53f3\u4e0a\u89d2\u626b\u7801\u56fe\u6807\uff1a \u5728\u817e\u8baf\u4e91\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u8fdb\u5165\u3010\u8bbe\u5907\u8c03\u8bd5\u3011\uff0c\u70b9\u51fb\u5bf9\u5e94\u8bbe\u5907\u540e\u7684\u3010\u4e8c\u7ef4\u7801\u3011\uff1a \u817e\u8baf\u8fde\u8fde\u626b\u63cf\u6b64\u4e8c\u7ef4\u7801\u5373\u53ef\u6210\u529f\u6dfb\u52a0\u8bbe\u5907\uff0c\u6dfb\u52a0\u6210\u529f\u4e4b\u540e\u5982\u56fe\uff1a \u70b9\u51fb\u6b64\u8bbe\u5907\u5373\u53ef\u5b9e\u65f6\u67e5\u770b\u6570\u636e\uff0c\u5e76\u4e0b\u53d1\u63a7\u5236\u6307\u4ee4\uff1a 3. \u4fee\u6539\u817e\u8baf\u8fde\u8fde\u663e\u793a\u9762\u677f \u8fdb\u5165\u3010\u4ea4\u4e92\u5f00\u53d1\u3011\uff0c\u70b9\u51fb\u3010\u9762\u677f\u914d\u7f6e\u3011\u4e00\u680f\uff1a \u5728\u6b64\u9875\u9762\u4e2d\u53ef\u4ee5\u81ea\u5df1\u6839\u636e\u559c\u597d\u914d\u7f6e\u5c0f\u7a0b\u5e8f\u663e\u793a\u9762\u677f\uff0c\u5982\u56fe\uff1a \u4fdd\u5b58\u4e4b\u540e\uff0c\u5728\u817e\u8baf\u8fde\u8fde\u5c0f\u7a0b\u5e8f\u5220\u9664\u8bbe\u5907\uff0c\u91cd\u65b0\u626b\u63cf\u7ed1\u5b9a\u8bbe\u5907\u5373\u53ef\u751f\u6548\u3002 \u516d\u3001\u817e\u8baf\u8fde\u8fde\u516c\u4f17\u53f7\u62a5\u8b66\u64cd\u4f5c\u6b65\u9aa4 1. \u521b\u5efa\u6570\u636e\u6d41 \u70b9\u51fb\u5de6\u4fa7\u3010\u6570\u636e\u5f00\u53d1\u3011\u4e00\u680f\uff0c\u70b9\u51fb\u3010\u65b0\u5efa\u6570\u636e\u6d41\u3011\uff1a \u586b\u5199\u6570\u636e\u6d41\u540d\u79f0\uff1a 2. \u8bbe\u8ba1\u6570\u636e\u6d41 \u6dfb\u52a0\u5e76\u8bbe\u7f6e\u3010\u8bbe\u5907\u6570\u636e\u3011\u8282\u70b9\uff1a \u6dfb\u52a0\u5e76\u8bbe\u7f6e\u3010\u8fc7\u6ee4\u8282\u70b9\u3011\uff1a \u6dfb\u52a0\u5e76\u8bbe\u7f6e\u3010\u63a8\u9001\u8282\u70b9\u3011\uff1a 3. \u542f\u52a8\u6570\u636e\u6d41 \u8bbe\u8ba1\u5b8c\u6210\u540e\uff0c\u70b9\u51fb\u3010\u4fdd\u5b58\u6309\u94ae\u3011\uff0c\u518d\u70b9\u51fb\u3010\u542f\u7528\u3011\uff1a 4. \u5173\u6ce8\u817e\u8baf\u8fde\u8fde\u516c\u4f17\u53f7 \u5728\u5fae\u4fe1\u5173\u6ce8\u3010\u817e\u8baf\u8fde\u8fde\u3011\u516c\u4f17\u53f7\uff1a \u5173\u6ce8\u540e\uff0c\u5982\u679c\u6709\u4efb\u4f55\u544a\u8b66\u6d88\u606f\uff0c\u5373\u53ef\u5728\u516c\u4f17\u53f7\u63a5\u6536\u5230\u3002 \u5982\u679c\u4ec5\u4ec5\u4e3a\u4e86\u6d4b\u8bd5\u544a\u8b66\u529f\u80fd\uff0c\u53ef\u4ee5\u5148\u5c06\u544a\u8b66\u503c\u8bbe\u8f83\u5c0f\u7684\u503c\uff0c\u6bd4\u5982\u8bbe\u4e3a0.070\uff0c\u6d4b\u8bd5\u5b8c\u6210\u4e4b\u540e\u518d\u6062\u590d\u56fd\u5bb6\u89c4\u5b9a\u6807\u51c60.80\u3002 \u81f3\u6b64\uff0c\u57fa\u4e8eTencentOS-tiny\u7684\u7532\u919b\u76d1\u6d4b\u4eea\u5236\u4f5c\u5b8c\u6210\u3002","title":"29.TencentOS_Tiny_EVB_G0_QuickStart"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#_1","text":"\u7532\u919b\u662f\u5ba4\u5185\u4e00\u9879\u975e\u5e38\u91cd\u8981\u7684\u6307\u6807\uff0c\u8d2d\u4e70\u4e00\u53f0\u7532\u919b\u76d1\u6d4b\u4eea\u53c8\u663e\u5f97\u592a\u4e0d\u5212\u7b97\uff0c\u4eca\u5929\u5c31\u6765\u6559\u5927\u5bb6\u5982\u4f55\u4f7f\u7528TOS_EVB_G0\u5f00\u53d1\u677f + TencentOS-tiny\u7269\u8054\u7f51\u64cd\u4f5c\u7cfb\u7edf\uff0c\u6765\u81ea\u5236\u4e00\u4e2a\u7b80\u5355\u7684\u7532\u919b\u76d1\u6d4b\u4eea\u3002 \u672c\u9879\u76ee\u5236\u4f5c\u7684\u7532\u919b\u76d1\u6d4b\u4eea\u53ef\u4ee5\u5b9e\u65f6\u7684\u68c0\u6d4b\u5ba4\u5185\u7532\u919b\u6d53\u5ea6\uff0c\u5728OLED\u5c4f\u5e55\u4e0a\u663e\u793a\u5177\u4f53\u6570\u503c\uff0c\u540c\u65f6\u8fd8\u53ef\u4ee5\u5c06\u6570\u636e\u5b9e\u65f6\u4e0a\u62a5\u5230\u817e\u8baf\u4e91\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0IoT Explorer\uff0c\u7528\u6237\u53ef\u4ee5\u5728\u201c\u817e\u8baf\u8fde\u8fde\u201d\u5c0f\u7a0b\u5e8f\u5b9e\u65f6\u67e5\u770b\u6570\u636e\uff0c\u5e76\u901a\u8fc7\u516c\u4f17\u53f7\u53ca\u65f6\u63a5\u6536\u544a\u8b66\u4fe1\u606f\u3002 \u672c\u9879\u76ee\u6240\u9700\u8981\u7684\u7269\u54c1\u6e05\u5355\u6709\uff1a TOS_EVB_G0\u5f00\u53d1\u677f x 1 \u82f1\u56fd Dart \u7532\u919b\u4f20\u611f\u5668 x 1 E53\u7532\u919b\u4f20\u611f\u5668\u5e95\u677f x 1 \u6210\u54c1\u7ec4\u88c5\u56fe\uff08\u5b89\u88c5\u5404\u63a5\u63d2\u4ef6\u65f6\uff0c\u8bf7\u52a1\u5fc5\u53c2\u8003\u6210\u54c1\u56fe\uff0c\u4e0d\u8981\u5f04\u9519\u65b9\u5411\uff0c\u5426\u5219\u53ef\u80fd\u70e7\u574fMCU\uff09 \u597d\u5566~\u63a5\u4e0b\u6765\u5f00\u59cb\u6211\u4eec\u7684\u5236\u4f5c\uff01","title":"\u4e00\u3001\u7532\u919b\u76d1\u6d4b\u4eea\u4ecb\u7ecd"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#tos_evb_g0","text":"","title":"\u4e8c\u3001TOS_EVB_G0\u5f00\u53d1\u677f"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#1","text":"TOS_EVB_G0 \u5f00\u53d1\u677f\u662f\u7531\u817e\u8bafTencentOS-tiny\u56e2\u961f\u8bbe\u8ba1\u7684\u4e00\u6b3e\u7269\u8054\u7f51\u5f00\u53d1\u677f\uff0c\u677f\u8f7d\u8d44\u6e90\u5982\u4e0b\uff1a \u4e3b\u63a7\u82af\u7247\u91c7\u7528STM32G070RB\uff0cFlash:128KB\u3001RAM:36KB\uff1b \u677f\u8f7d\u817e\u8baf\u4e91\u5b9a\u5236\u56fa\u4ef6\u7248ESP8266 WIFI\u6a21\u7ec4\uff1b \u677f\u8f7dE53\u4f20\u611f\u5668\u6807\u51c6\u63a5\u53e3\uff0c\u65b9\u4fbf\u8fde\u63a5\u5404\u79cdE53\u4f20\u611f\u5668\uff1b \u677f\u8f7d0.91'OLED\u663e\u793a\u5c4f\u5e55\uff1b \u677f\u8f7d8MB SPI Flash\uff0c\u53ef\u7528\u4e8e\u56fa\u4ef6\u5347\u7ea7\uff1b \u677f\u8f7dCH340 \u8f6c\u4e32\u53e3\u8fde\u63a5\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e00\u6839USB\u7ebf\u8fde\u63a5\u81f3\u7535\u8111\uff0c\u67e5\u770b\u4e32\u53e3\u65e5\u5fd7\uff0c\u5347\u7ea7esp8266\u56fa\u4ef6\uff0c\u53d1\u9001AT\u6307\u4ee4 \u4e0b\u9762\u662f\u6bcf\u90e8\u5206\u8be6\u7ec6\u7684\u8bf4\u660e\u3002","title":"1. \u5f00\u53d1\u677f\u7279\u6027"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#2","text":"","title":"2. \u5f00\u53d1\u677f\u786c\u4ef6\u7535\u8def\u8be6\u89e3"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#21","text":"\u6700\u5c0f\u7cfb\u7edf\u90e8\u5206\u7531\u7535\u6e90\u7535\u8def\u3001\u65f6\u949f\u7535\u8def\u3001Boot\u7535\u8def\u3001\u590d\u4f4d\u7535\u8def\u3001\u4e0b\u8f7d\u7535\u8def\u7ec4\u6210\uff1a","title":"2.1. \u6700\u5c0f\u7cfb\u7edf\u7535\u8def"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#22-wifi","text":"WIFI\u90e8\u5206\u5305\u62ecESP8266 WIFI\u6a21\u7ec4\u4f9b\u7535\u7535\u8def\u3001\u4e32\u53e3\u901a\u4fe1\u7535\u8def\uff1a","title":"2.2. WIFI\u7535\u8def"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#23-e53","text":"E53\u6269\u5c55\u63a5\u53e3\u4f9b\u5916\u90e8\u4f20\u611f\u5668\u8fde\u63a5\uff0c\u5305\u62ec\uff1a\u4e00\u4e2a\u4e32\u53e3\u3001\u4e00\u4e2aSPI\u63a5\u53e3\u3001\u4e00\u4e2aIIC\u63a5\u53e3\u3001\u56db\u4e2a\u666e\u901aGPIO\u53e3\u3001\u4e00\u4e2aADC\u6a21\u62df\u91c7\u96c6\u63a5\u53e3\uff0c\u4e00\u4e2aDAC\u6a21\u62df\u8f93\u51fa\u63a5\u53e3\uff0c\u5982\u56fe\uff1a","title":"2.3. E53\u6269\u5c55\u63a5\u53e3\u7535\u8def"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#24-usb","text":"USB\u8f6c\u4e32\u53e3\u7535\u8def\u5c06\u4e32\u53e3\u4fe1\u606f\u8f6c\u6362\u4e3aUSB\u53e3\u4fe1\u53f7\uff0c\u4f7f\u5f97\u5f00\u53d1\u677f\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7USB\u7ebf\u8fde\u63a5\u81f3PC\uff0c\u5728PC\u4e0a\u4f7f\u7528\u4e32\u53e3\u52a9\u624b\u67e5\u770b\u65e5\u5fd7\uff1a","title":"2.4. USB\u8f6c\u4e32\u53e3\u7535\u8def"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#25-oled","text":"OLED\u5c4f\u5e55\u90e8\u5206\u5305\u62ecOLED\u4f9b\u7535\u90e8\u5206\u548c\u901a\u4fe1\u90e8\u5206\uff1a","title":"2.5. OLED\u663e\u793a\u5c4f\u5e55\u7535\u8def"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#26-micor-usb","text":"","title":"2.6. \u8fde\u63a5Micor USB\u7ebf"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#27-st-link","text":"\u5f00\u53d1\u677f3v3---> STlink 3.3V \u5f00\u53d1\u677fDIO---> STlink SWDIO \u5f00\u53d1\u677fCLK---> STlink SWCLK \u5f00\u53d1\u677fGND---> STlink GND \u8bf7\u5927\u5bb6\u53c2\u8003\u4e0b\u56fe\u8fdb\u884c\u8fde\u63a5\uff0c\u5343\u4e07\u4e0d\u8981\u63a5\u53cd\u63a5\u9519\uff0c\u4ee5\u514d\u70e7\u6389MCU","title":"2.7. \u8fde\u63a5ST-Link\u4e0b\u8f7d\u5668"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#3","text":"","title":"3. \u5f00\u53d1\u677f\u8f6f\u4ef6\u73af\u5883\u51c6\u5907"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#31-mdk","text":"MDK \u5373RealView MDK \u6216MDK-ARM\uff08Microcontroller Development kit\uff09\uff0c\u662f ARM \u516c\u53f8\u6536\u8d2dKeil\u516c\u53f8\u4ee5\u540e\uff0c\u57fa\u4e8euVision\u754c\u9762\u63a8\u51fa\u7684\u9488\u5bf9ARM7\u3001ARM9\u3001Cortex-M0\u3001Cortex-M1\u3001Cortex-M2\u3001Cortex-M3\u3001Cortex-R4\u7b49ARM\u5904\u7406\u5668\u7684\u5d4c\u5165\u5f0f\u8f6f\u4ef6\u5f00\u53d1\u5de5\u5177\u3002MDK-ARM \u96c6\u6210\u4e86\u4e1a\u5185\u6700\u9886\u5148\u7684\u6280\u672f\uff0c\u5305\u62ec uVision4 \u96c6\u6210\u5f00\u53d1\u73af\u5883\u4e0e RealView \u7f16\u8bd1\u5668RVCT\u3002\u652f\u6301 ARM7\u3001ARM9 \u548c\u6700\u65b0\u7684Cortex-M3/M1/M0 \u6838\u5904\u7406\u5668\uff0c\u81ea\u52a8\u914d\u7f6e\u542f\u52a8\u4ee3\u7801\uff0c\u96c6\u6210 Flash \u70e7\u5199\u6a21\u5757\uff0c\u5f3a\u5927\u7684 Simulation \u8bbe\u5907\u6a21\u62df\uff0c\u6027\u80fd\u5206\u6790\u7b49\u529f\u80fd\uff0c\u4e0e ARM \u4e4b\u524d\u7684\u5de5\u5177\u5305 ADS \u7b49\u76f8\u6bd4\uff0cRealView \u7f16\u8bd1\u5668\u7684\u6700\u65b0\u7248\u672c\u53ef\u5c06\u6027\u80fd\u6539\u5584\u8d85\u8fc7 20%\u3002 Keil\u516c\u53f8\u5f00\u53d1\u7684ARM\u5f00\u53d1\u5de5\u5177MDK\uff0c\u662f\u7528\u6765\u5f00\u53d1\u57fa\u4e8eARM\u6838\u7684\u7cfb\u5217\u5fae\u63a7\u5236\u5668\u7684\u5d4c\u5165\u5f0f\u5e94\u7528\u7a0b\u5e8f\u3002\u5b83\u9002\u5408\u4e0d\u540c\u5c42\u6b21\u7684\u5f00\u53d1\u8005\u4f7f\u7528\uff0c\u5305\u62ec\u4e13\u4e1a\u7684\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u5de5\u7a0b\u5e08\u548c\u5d4c\u5165\u5f0f\u8f6f\u4ef6\u5f00\u53d1\u7684\u5165\u95e8\u8005\u3002MDK\u5305\u542b\u4e86\u5de5\u4e1a\u6807\u51c6\u7684Keil C\u7f16\u8bd1\u5668\u3001\u5b8f\u6c47\u7f16\u5668\u3001\u8c03\u8bd5\u5668\u3001\u5b9e\u65f6\u5185\u6838\u7b49\u7ec4\u4ef6\uff0c\u652f\u6301\u6240\u6709\u57fa\u4e8eARM\u7684\u8bbe\u5907\uff0c\u80fd\u5e2e\u52a9\u5de5\u7a0b\u5e08\u6309\u7167\u8ba1\u5212\u5b8c\u6210\u9879\u76ee\u3002","title":"3.1 MDK\u8f6f\u4ef6\u4ecb\u7ecd"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#32-mdk","text":"\u767b\u5f55MDK\u5b98\u7f51\uff0c\u4e0b\u8f7dMDK5\u8f6f\u4ef6\uff0c\u4e0b\u8f7d\u5730\u5740\uff1a http://www2.keil.com/mdk5 \u6216\u8005 https://www.keil.com/download/product/ \u4e0b\u8f7d\u7684\u7248\u672c\u6700\u597d\u57285.24\u4ee5\u4e0a\uff0c\u672c\u5f00\u53d1\u6559\u7a0b\u4ee55.24\u7248\u672c\u4e3a\u4f8b\uff0c\u53cc\u51fbMDK524\u5e94\u7528\u7a0b\u5e8f\u6587\u4ef6\uff0c\u70b9\u51fbnext>>\u3002 \u6253\u4e0a I agree\u524d\u9762\u7684\u52fe\u52fe\uff0c\u5373\u662f\u540c\u610f\u4e00\u4e9b\u5b89\u88c5\u534f\u8bae\u3002\u70b9\u51fbnext>>\u3002 \u9009\u62e9\u5b89\u88c5\u8def\u5f84\uff0c\u53ef\u4ee5\u9ed8\u8ba4\u4e5f\u53ef\u4ee5\u5b89\u88c5\u5728\u6211\u4eec\u81ea\u5df1\u5efa\u7acb\u7684\u6587\u4ef6\u5939\u4e0b\u3002\u70b9\u51fbnext>>\u3002 \u8fd9\u91cc\u586b\u5199\u7684\u662f\u6211\u4eec\u7684\u4e00\u4e9b\u4fe1\u606f\uff0c\u586b\u5199\u5b8c\u6574\u540e\uff0c\u7ee7\u7eednext>>\u3002 \u7136\u540e\u7b49\u5f85\u5b89\u88c5\u5b8c\u6210\u5373\u53ef\u3002 \u5b89\u88c5\u5b8c\u6210\uff0c\u70b9\u51fbFinish\u3002 \u7136\u540e\u4f1a\u8df3\u51fa\u6765\u8fd9\u4e2a\u754c\u9762\uff0c\u8fd9\u4e2a\u6211\u4eec\u540e\u9762\u518d\u8bb2\uff0c\u5148\u70b9OK\uff0c\u628a\u5f39\u6846\u90fd\u53c9\u6389\u3002 \u6fc0\u6d3bMDK\uff0c\u5bfc\u5165License,\u6fc0\u6d3bMDK\u540e\u4fbf\u53ef\u4f7f\u7528\u4e86\u3002 \u7279\u522b\u63d0\u793a\uff1a\u4e00\u5b9a\u8981\u8f93\u5165License\u6fc0\u6d3bMDK\u8f6f\u4ef6\uff0c\u5efa\u8bae\u8d2d\u4e70\u6b63\u7248License\u3002","title":"3.2 MDK\u5b89\u88c5"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#33-mdk","text":"\u5b89\u88c5\u5b8cMDK\u540e\uff0c\u6211\u4eec\u9700\u8981\u5b89\u88c5\u5f00\u53d1\u5957\u4ef6\u4e2d\u5355\u7247\u673a\u578b\u53f7\u5bf9\u5e94\u7684Pack\u3002 \u5b89\u88c5\u65b9\u5f0f\u4e00 \u767b\u5f55\u5b98\u7f51\uff1ahttp://www.keil.com/dd2/pack/ \u4e0b\u8f7dKeil.STM32G0xx_DFP.x.x.x.pack \u540e\u5b89\u88c5\u3002 \u5b89\u88c5\u65b9\u5f0f\u4e8c MDK\u8f6f\u4ef6\u4e0a\u5728\u7ebf\u5b89\u88c5 \u6253\u5f00\u8f6f\u4ef6\uff0c\u5728\u5bfc\u822a\u680f\u6253\u5f00Pack\u5b89\u88c5\u754c\u9762\uff0c\u7136\u540e\u9009\u62e9ok\u9009\u9879\u3002 \u8fdb\u5165\u5728\u7ebf\u5b89\u88c5\u754c\u9762\uff0c\u9009\u7740STM32G0XX Pack,\u70b9\u51fbInstall\u8fdb\u884c\u5b89\u88c5\u3002 \u81f3\u6b64\uff0c\u6211\u4eec\u5f00\u53d1\u677f\u7684\u5355\u7247\u673a\u7a0b\u5e8f\u5f00\u53d1\u73af\u5883\u5df2\u7ecf\u642d\u5efa\u5b8c\u6bd5\uff0c\u91cd\u542fMDK\u8f6f\u4ef6\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002","title":"3.3 MDK\u5b89\u88c5"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#34-st-link","text":"\u524d\u9762\u8bb2\u4e86\u5f00\u53d1\u677f\u5355\u7247\u673a\u7a0b\u5e8f\u7684\u5f00\u53d1\u73af\u5883\u7684\u642d\u5efa\uff0c\u4f46\u662f\u4e3a\u4e86\u5c06\u7a0b\u5e8f\u70e7\u5f55\u5230\u5f00\u53d1\u677f\u4e2d\u6211\u4eec\u8fd8\u9700\u8981\u4f7f\u7528\u4eff\u771f\u5668\u3002\u6211\u4eec\u8fd9\u5957\u5f00\u53d1\u677f\u9009\u7528ST\u516c\u53f8\u7684ST-Link V2\u4eff\u771f\u5668\u8fdb\u884c\u5f00\u53d1\u677f\u7a0b\u5e8f\u7684\u70e7\u5199\u548c\u4eff\u771f\uff0c\u4e0b\u9762\u4ecb\u7ecdST-Link\u9a71\u52a8\u7684\u5b89\u88c5\u53ca\u73af\u5883\u642d\u5efa\u3002 \u5728ST\u5b98\u7f51\u4e0b\u8f7dST-Link\u9a71\u52a8\uff0c https://www.st.com/content/st_com/zh/products/development-tools/software-development-tools/stm32-software-development-tools/stm32-utilities/stsw-link009.html \uff08\u9a71\u52a8\u67092\u79cd\uff1a 32\u4f4d\u7535\u8111\u7cfb\u7edf\u5b89\u88c5\u201cdpinst_x86\u201d\u300164\u4f4d\u7535\u8111\u7cfb\u7edf\u5b89\u88c5\u201cdpinst_amd64\u201d\uff09\u3002 \u8fd0\u884c\u5bf9\u5e94\u7684\u9a71\u52a8\uff0c\u5b89\u88c5ST-Link V2\u9a71\u52a8\u7a0b\u5e8f\u3002\u5b89\u88c5\u8def\u5f84\u5c3d\u91cf\u4fdd\u6301\u9ed8\u8ba4\u8def\u5f84\u3002 \u5b89\u88c5\u5b8c\u6210\u540e, \u5c06ST-Link\u901a\u8fc7USB\u63a5\u53e3\u8fde\u5165\u7535\u8111\u3002\u6253\u5f00\u201c\u8bbe\u5907\u7ba1\u7406\u5668\u201d\u3002\u82e5\u770b\u5230\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u8868\u793a\u9a71\u52a8\u5b89\u88c5\u6210\u529f\u3002 \u8fd9\u91cc\u63d0\u9192 2 \u70b9: 1\uff0c \u5404\u79cd windows \u7248\u672c\u8bbe\u5907\u540d\u79f0\u548c\u6240\u5728\u8bbe\u5907\u7ba1\u7406\u5668\u680f\u76ee\u53ef\u80fd\u4e0d\u4e00\u6837\uff0c\u4f8b\u5982 WIN10 \u63d2\u4e0aSTLINK \u540e\u663e\u793a\u7684\u662f STM32 STLINK\u3002 2\uff0c \u5982\u679c\u8bbe\u5907\u540d\u79f0\u65c1\u8fb9\u663e\u793a\u7684\u662f\u9ec4\u8272\u7684\u53f9\u53f7\uff0c\u8bf7\u76f4\u63a5\u70b9\u51fb\u8bbe\u5907\u540d\u79f0\uff0c\u7136\u540e\u5728\u5f39\u51fa\u7684\u754c\u9762\u70b9\u51fb\u66f4\u65b0\u8bbe\u5907\u9a71\u52a8 \u81f3\u6b64\uff0c ST-Link \u9a71\u52a8\u5df2\u7ecf\u5b89\u88c5\u5b8c\u6210\u3002\u63a5\u4e0b\u6765\u5927\u5bb6\u53ea\u9700\u8981\u5728 MDK\u5de5\u7a0b\u91cc\u9762\u914d\u7f6e\u4e00\u4e0b ST-Link\u5373\u53ef\u3002","title":"3.4 ST-Link\u9a71\u52a8\u5b89\u88c5"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#35-ch340","text":"\u4e92\u8054\u7f51\u641c\u7d22\u4e0b\u8f7dCH340 \u4e32\u53e3\u82af\u7247\u7684\u9a71\u52a8 \u5b89\u88c5\u65b9\u6cd5\uff1a\u6253\u5f00\u9a71\u52a8\u5b89\u88c5\u7a0b\u5e8f\u70b9\u51fb\u5b89\u88c5\u5373\u53ef\u3002 \u6ce8\uff1a\u82e5\u5b89\u88c5\u5931\u8d25\uff0c\u8bf7\u5148\u70b9\u51fb\u5378\u8f7d\uff0c\u540e\u70b9\u51fb\u5b89\u88c5\u3002","title":"3.5  CH340\u4e32\u53e3\u9a71\u52a8\u5b89\u88c5"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#37","text":"\u5de5\u5177\u4e0b\u8f7d\uff1a http://www.daxia.com/download/sscom.rar \u5b89\u88c5\u65b9\u6cd5\uff1a\u4e32\u53e3\u8c03\u8bd5\u52a9\u624bsscom5.13.1\u662f\u514d\u5b89\u88c5\u7684\uff0c\u89e3\u538b\u51fa\u538b\u7f29\u5305\u5373\u53ef\u76f4\u63a5\u4f7f\u7528\u3002 \u6839\u636ePC\u548c\u7ec8\u7aef\u4e4b\u95f4\u7684\u8fde\u63a5\uff0c\u9009\u62e9\u6b63\u786e\u7684\u4e32\u884c\u7aef\u53e3\u3002 \u6253\u5f00\u7535\u8111\u7684\u8bbe\u5907\u7ba1\u7406\u5668\uff0c\u5728\u7aef\u53e3\u5217\u8868\u53ef\u4ee5\u770b\u5230PC\u4e0e\u5f00\u53d1\u677f\u8fde\u63a5\u7684\u7aef\u53e3\u53f7\u3002 \u6211\u8fd9\u91cc\u663e\u793a\u7684\u662fCOM26\uff0c\u6240\u4ee5\u8981\u5728sscom\u5de5\u5177\u4e2d\u9009\u62e9COM26\uff0c\u5f00\u53d1\u677f\u7a0b\u5e8f\u6ce2\u7279\u7387\u8bbe\u7f6e\u4e3a115200\uff0c\u6240\u4ee5\u6211\u5728sscom\u4e32\u53e3\u5de5\u5177\u4e2d\u9009\u62e9115200\u6ce2\u7279\u7387\u3002","title":"3.7 \u4e32\u53e3\u8c03\u8bd5\u52a9\u624b\u7684\u5b89\u88c5\u4e0e\u4f7f\u7528"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#_2","text":"","title":"\u4e09\u3001\u70e7\u5199\u817e\u8baf\u4e91\u5b9a\u5236\u56fa\u4ef6"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#1_1","text":"\u817e\u8baf\u4e91IoT AT\u6307\u4ee4\u662f\u4e00\u5957\u9488\u5bf9\u4f7f\u7528\u901a\u8baf\u6a21\u7ec4\uff082G/4G/NB/WIFI\uff09\u63a5\u5165\u817e\u8baf\u4e91\u7269\u8054\u5e73\u53f0\u7684\u5b9a\u5236AT\u6307\u4ee4\u96c6\uff0c\u5982\u679c\u901a\u8baf\u6a21\u7ec4\u5b9e\u73b0\u4e86\u8be5\u6307\u4ee4\u96c6\uff0c\u5219\u8bbe\u5907\u63a5\u5165\u548c\u901a\u8baf\u66f4\u4e3a\u7b80\u5355\uff0c\u6240\u9700\u4ee3\u7801\u91cf\u66f4\u5c11\u3002 ESP8266\u4f5c\u4e3aIoT\u9886\u57df\u4f7f\u7528\u6700\u5e7f\u6cdb\u7684\u4e00\u6b3eWiFi\u82af\u7247/\u6a21\u7ec4\uff0c\u817e\u8baf\u4e91\u5728\u5176\u901a\u7528AT\u6307\u4ee4\u57fa\u7840\u4e0a\uff0c\u589e\u52a0\u4e86\u817e\u8baf\u4e91IoT AT\u6307\u4ee4\u96c6\uff0c\u5f62\u6210\u4e00\u4e2a\u5b9a\u5236\u7684\u6a21\u7ec4\u56fa\u4ef6QCloud_IoT_AT_ESP8266\u3002 \u4e0b\u8f7d\u94fe\u63a5\uff1a https://github.com/tencentyun/qcloud-iot-esp-wifi \u4f7f\u7528git\u4e0b\u8f7d\u7684\u547d\u4ee4\u5982\u4e0b\uff1a git clone https://github.com/tencentyun/qcloud-iot-esp-wifi.git \u4e0b\u8f7d\u4e4b\u540e\u5373\u53ef\u5728\u56fe\u4e2d\u5708\u51fa\u7684\u6587\u4ef6\u5939\u4e2d\u770b\u5230\u5b9a\u5236\u56fa\u4ef6\uff1a","title":"1. \u4e0b\u8f7d\u56fa\u4ef6"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#2_1","text":"\u4f7f\u7528\u4e50\u946b\u5b98\u65b9\u4e0b\u8f7d\u5de5\u5177ESPFlashDownloadTool\uff0c\u4e0b\u8f7d\u94fe\u63a5\u5982\u4e0b\uff1a https://www.espressif.com/zh-hans/support/download/other-tools \u70b9\u51fb\u4e0b\u8f7dFlash \u4e0b\u8f7d\u5de5\u5177\uff08ESP8266 & ESP32 & ESP32-S2\uff09\uff1a \u4e0b\u8f7d\u4e4b\u540e\u89e3\u538b\u5373\u53ef\u3002","title":"2. \u4e0b\u8f7d\u70e7\u5199\u5de5\u5177"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#3_1","text":"\u817e\u8baf\u4e91IoT\u5b9a\u5236\u7684AT\u6a21\u7ec4\u56fa\u4ef6QCloud_IoT_AT_ESP8266\uff0c\u9002\u7528\u4e8e\u6240\u6709FLASH\u5927\u5c0f\u4e3a2MB\u6216\u80052MB\u4ee5\u4e0a\u7684ESP8266\u6a21\u7ec4\u3002 AT\u4e32\u53e3\u4f7f\u7528UART0\uff0c\u9ed8\u8ba4\u7684Tx\u4e3aGPIO1\uff0cRx\u4e3aGPIO3\u3002\u4f46\u56e0\u4e3aESP8266\u7684UART0 \u9ed8\u8ba4\u4f1a\u5728\u4e0a\u7535\u542f\u52a8\u671f\u95f4\u8f93\u51fa\u4e00\u4e9b\u6253\u5370\uff0c\u5982\u679c\u6253\u5370\u4fe1\u606f\u5f71\u54cd\u8bbe\u5907\u529f\u80fd\uff0c\u53ef\u5728\u4e0a\u7535\u671f\u95f4\u5c06 U0TXD(GPIO1)\u3001U0RXD(GPIO3) \u5206\u522b\u4e0e U0RTS (GPIO15)\uff0cU0CTS(GPIO13)\u8fdb\u884c\u4ea4\u6362\uff0c\u4ee5\u5c4f\u853d\u6253\u5370\u3002\u56e0\u6b64\u63d0\u4f9b\u4e24\u4e2a\u7248\u672c\u7684\u56fa\u4ef6\uff1a \u540d\u79f0\u5305\u542bUART_1_3\u7684\u56fa\u4ef6\u4e32\u53e3\u4f7f\u7528\u7684Tx\u4e3aGPIO1\uff0cRx\u4e3aGPIO3\u3002 \u540d\u79f0\u5305\u542bUART_15_13\u7684\u56fa\u4ef6\u4e32\u53e3\u4f7f\u7528\u7684Tx\u4e3aGPIO15\uff0cRx\u4e3aGPIO13\u3002 \u8fdb\u5165QCloud_IoT_AT_ESP8266_FW\uff0c\u672c\u6587\u4e2d\u6211\u4eec\u4f7f\u7528\u7b2c\u4e00\u4e2a\u56fa\u4ef6\uff1a","title":"3. \u56fa\u4ef6\u8bf4\u660e"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#4","text":"","title":"4. \u70e7\u5199\u56fa\u4ef6"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#41-boot","text":"\u2460 \u5c06\u5f00\u53d1\u677f\u4e0a\u7684ESP8266\u542f\u52a8\u5f15\u811a\u914d\u7f6e\u7aef\u5b50\u5207\u6362\u5230\u4f4e\u7535\u5e73\uff1b \u2461 \u5c06\u5f00\u53d1\u677f\u4e0a\u7684\u4e32\u53e3\u9009\u62e9\u7aef\u5b50\u7f6e\u4e8e\u4e2d\u95f4\uff0c\u4f7fESP8266\u76f4\u63a5\u4e0ePC\u4e32\u53e3\u8fde\u63a5\uff1a \u65b9\u6cd5\u53c2\u8003\u4e0b\u56fe\uff1a","title":"4.1. \u5207\u6362boot\u9009\u62e9\u7aef\u5b50\u548c\u4e32\u53e3\u9009\u62e9\u7aef\u5b50"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#42-flash","text":"\u53cc\u51fb\u5de5\u5177\uff0c\u8fd0\u884c\uff1a \u9009\u62e9\u5f00\u53d1\u8005\u6a21\u5f0f\uff1a \u9009\u62e9ESP8266\u4e0b\u8f7d\u5de5\u5177\uff1a","title":"4.2. \u8fd0\u884cFlash\u70e7\u5199\u5de5\u5177"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#43","text":"\u6309\u7167\u56fe\u4e2d\u8fdb\u884c\u64cd\u4f5c\uff1a \u70b9\u51fb\u4e0b\u8f7d\u4e4b\u540e\uff0c\u6309\u4e0b\u5f00\u53d1\u677f\u4e0a\u7684\u590d\u4f4d\u952e\uff0cFlash\u4e0b\u8f7d\u5de5\u5177\u5f00\u59cb\u4e0b\u8f7d\uff1a \u82e5\u6ca1\u6709\u663e\u793a\uff0c\u8bf7\u68c0\u67e5\u63a5\u7ebf\u7aef\u5b50\u662f\u5426\u8fde\u63a5\u6b63\u786e\u3002","title":"4.3. \u5f00\u59cb\u4e0b\u8f7d"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#44","text":"\u4e0b\u8f7d\u5b8c\u6210\u4e4b\u540e\u5982\u56fe\uff1a \u5173\u95ed\u5de5\u5177\uff0c\u5c06boot\u9009\u62e9\u5f15\u811a\u62d4\u4e0b\uff0c\u5c06\u4e32\u53e3\u9009\u62e9\u7aef\u5b50\u6062\u590d\u9ed8\u8ba4\u3002 \u6ce8\u610f\uff1a\u5b8c\u6210\u56fa\u4ef6\u4e0b\u8f7d\u540e\uff0c\u4e00\u5b9a\u5207\u8bb0\u5c06\u8df3\u7ebf\u7aef\u5b50\u6062\u590d\u5230\u9ed8\u8ba4\u72b6\u6001\uff0c\u9ed8\u8ba4\u7aef\u5b50\u600e\u4e48\u77ed\u63a5\u53ef\u4ee5\u53c2\u8003\u524d\u9762\u5b8c\u6574\u7684\u7ec4\u88c5\u6210\u54c1\u56fe\uff0c\u5426\u5219wifi\u5c06\u6ca1\u6cd5\u5de5\u4f5c\uff0cMCU\u4e5f\u6ca1\u6cd5\u63a7\u5236wifi\u3002","title":"4.4. \u4e0b\u8f7d\u5b8c\u6210"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#tencentos-tinyiot-explorer","text":"\u57fa\u4e8eTencentOS Tiny EVB G0\u8981\u5b8c\u6210\u817e\u8baf\u4e91IoT Explorer\u5bf9\u63a5\uff0c\u9700\u8981\u5b8c\u6210\u4e24\u4e2a\u90e8\u5206\u7684\u5de5\u4f5c\u3002 \u4e00\u662f\uff1a\u817e\u8baf\u4e91IoT explorer \u4e0a\u5b8c\u6210\u9879\u76ee\u3001\u4ea7\u54c1\u3001\u8bbe\u5907\u521b\u5efa\u3001\u53c2\u6570\u914d\u7f6e \u4e8c\u662f\uff1a\u57fa\u4e8eTencentOS Tiny\u5b8c\u6210\u5e94\u7528\u5f00\u53d1\uff0c\u5411\u817e\u8baf\u4e91\u4e0a\u62a5\u4e1a\u52a1\u6570\u636e\u3002","title":"\u56db\u3001\u57fa\u4e8eTencentOS tiny\u63a5\u5165\u817e\u8baf\u4e91IoT Explorer\u6307\u5f15"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#1_2","text":"","title":"1. \u4e91\u7aef\u64cd\u4f5c\u6b65\u9aa4"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#11","text":"\u767b\u5f55 \u817e\u8baf\u4e91\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0 \uff0c\u70b9\u51fb\u65b0\u5efa\u9879\u76ee\uff0c\u586b\u5199\u9879\u76ee\u540d\u79f0\u548c\u7b80\u4ecb\uff1a","title":"1.1. \u65b0\u5efa\u9879\u76ee"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#22","text":"\u70b9\u51fb\u9879\u76ee\u540d\u79f0\u8fdb\u5165\u5230\u8be5\u9879\u76ee\u4e2d\uff0c\u70b9\u51fb\u65b0\u5efa\u4ea7\u54c1\uff1a \u4ea7\u54c1\u65b0\u5efa\u6210\u529f\u540e\uff0c\u53ef\u5728\u4ea7\u54c1\u5217\u8868\u9875\u67e5\u770b\u5230\uff1a","title":"2.2. \u65b0\u5efa\u4ea7\u54c1"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#23","text":"\u8fdb\u5165\u4ea7\u54c1\uff0c\u70b9\u51fb\u3010\u6570\u636e\u6a21\u677f\u3011\uff0c\u70b9\u51fb\u3010\u5bfc\u5165JSON\u3011\uff0c\u5bfc\u5165\u4e0b\u9762\u7684JSON\u4ee3\u7801\uff1a { \"version\": \"1.0\", \"profile\": { \"ProductId\": \"BDDSF87WEA\", \"CategoryId\": \"1\" }, \"properties\": [ { \"id\": \"ch20_ppm_value\", \"name\": \"\u7532\u919b\u6d53\u5ea6\u503c\", \"desc\": \"\", \"mode\": \"r\", \"define\": { \"type\": \"float\", \"min\": \"0\", \"max\": \"2\", \"start\": \"0\", \"step\": \"0.001\", \"unit\": \"ppm(mg/m3)\" }, \"required\": false } ], \"events\": [], \"actions\": [] } \u5bfc\u5165\u4e4b\u540e\u81ea\u52a8\u6839\u636ejson\u6587\u4ef6\u521b\u5efa\u7684\u5c5e\u6027\u5982\u4e0b\uff1a","title":"2.3. \u6570\u636e\u6a21\u677f"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#24","text":"\u70b9\u51fb\u3010\u8bbe\u5907\u8c03\u8bd5\u3011\uff0c\u8fdb\u5165\u540e\u70b9\u51fb\u3010\u65b0\u5efa\u8bbe\u5907\u3011\uff0c\u521b\u5efa\u771f\u5b9e\u8bbe\u5907\uff1a \u521b\u5efa\u6210\u529f\u4e4b\u540e\u8fdb\u5165\u8bbe\u5907\uff0c\u67e5\u770b\u5230\u4ea7\u54c1ID\u3001\u8bbe\u5907\u540d\u79f0\u3001\u8bbe\u5907\u79d8\u94a5\uff1a","title":"2.4. \u521b\u5efa\u8bbe\u5907"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#2-tencentos-tiny","text":"\u8fdb\u5165 < TencentOS-tiny\\board\\TencentOS_tiny_EVB_G0\\KEIL\\mqtt_iot_explorer_tc_ch20_oled> \u76ee\u5f55\uff0c\u6253\u5f00TencentOS_tiny.uvprojx\u5de5\u7a0b\u3002","title":"2. \u57fa\u4e8eTencentOS Tiny \u5b8c\u6210\u8bbe\u5907\u4fa7\u5e94\u7528\u5f00\u53d1"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#21-wifi","text":"\u6253\u5f00 mqtt_iot_explorer_tc_ch20_oled.c \u6587\u4ef6\u7f16\u8f91\uff0c\u4fee\u6539\u8981\u63a5\u5165WIFI\u7684\u540d\u79f0\u548c\u5bc6\u7801\uff08\u5efa\u8bae\u4f7f\u7528\u624b\u673a\u70ed\u70b9\uff0c\u4e0d\u8981\u6709\u7279\u6b8a\u5b57\u7b26\uff09\uff1a","title":"2.1. \u4fee\u6539WIFI\u63a5\u5165\u4fe1\u606f"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#22_1","text":"\u540c\u6837\u5728\u6b64\u6587\u4ef6\u5b8f\uff0c\u4fee\u6539\u4e91\u7aef\u914d\u7f6e\u4fe1\u606f\uff0c\u4f7f\u7528\u4e4b\u524d\u5728\u4e91\u7aef\u67e5\u770b\u7684\u4fe1\u606f\u66ff\u6362\uff1a","title":"2.2. \u4fee\u6539\u4e91\u7aef\u5bf9\u63a5\u4fe1\u606f"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#23_1","text":"\u70b9\u51fb\u7f16\u8bd1\u6309\u94ae\uff0c\u7f16\u8bd1\u6574\u4e2a\u5de5\u7a0b\uff1a","title":"2.3. \u7f16\u8bd1\u5de5\u7a0b"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#24_1","text":"\u70b9\u51fb\u8fdb\u5165\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\u6309\u7ebd\uff0c\u8fdb\u5165\u5de5\u7a0b\u914d\u7f6e\u754c\u9762\uff1a \u9009\u62e9Debug\u9009\u9879\uff0c\u8fdb\u5165\u4eff\u771f\u5668\u8bbe\u7f6e\u754c\u9762\u3002 \u4e0b\u62c9\u4eff\u771f\u5668\u9009\u62e9\u5217\u8868\uff0c\u9009\u7740ST-Link Debugger\u5e76\u52fe\u9009\u53f3\u4fa7Use,\u70b9\u51fbSettings\u8fdb\u5165ST-Link V2\u4eff\u771f\u5668\u914d\u7f6e\u754c\u9762\u3002 \u5f00\u53d1\u677f\u8bbe\u8ba1\u7684\u7a0b\u5e8f\u70e7\u5f55\u65b9\u5f0f\u4e3aSW\uff0c\u6b64\u5904Unit\u9009\u62e9ST-Link/V2,\u4e14Port\u9009\u62e9SW,\u5e76\u786e\u8ba4\u53f3\u4fa7\u6846\u5185\u662f\u5426\u68c0\u6d4b\u51faSW\u8bbe\u5907\uff0c\u70b9\u51fb<\u786e\u8ba4>\u4fdd\u5b58\u914d\u7f6e\u3002 \u70b9\u51fb\u786e\u5b9a\u4e4b\u540e\uff0c\u56de\u5230\u4e3b\u754c\u9762\uff0c\u70b9\u51fb\u4e0b\u8f7d\u6309\u94ae\uff1a","title":"2.4. \u4e0b\u8f7d\u7a0b\u5e8f"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#25","text":"\u8fd0\u884csscom\u8f6f\u4ef6\uff0c\u6253\u5f00\u7535\u8111\u4e0a\u5f00\u53d1\u677f\u5bf9\u5e94\u7684\u4e32\u53e3\uff0c\u6bd4\u5982\u6211\u9009\u62e9COM26\uff0c\u70b9\u51fb\u3010\u6253\u5f00\u4e32\u53e3\u3011\uff1a \u6309\u4e0b\u5f00\u53d1\u677f\u4e0a\u7684\u590d\u4f4d\u952e\uff0c\u7a0b\u5e8f\u5f00\u59cb\u8fd0\u884c\uff0c\u5373\u53ef\u5728\u4e32\u53e3\u52a9\u624b\u4e2d\u770b\u5230\u7cfb\u7edf\u8fd0\u884c\u6253\u5370\u7684\u65e5\u5fd7\uff1a","title":"2.5. \u4f7f\u7528\u4e32\u53e3\u52a9\u624b\u67e5\u770b\u65e5\u5fd7"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#3_2","text":"\u56de\u5230\u817e\u8baf\u4e91\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\uff0c\u53ef\u4ee5\u770b\u5230\u8bbe\u5907\u72b6\u6001\u53d8\u4e3a\u3010\u5728\u7ebf\u3011\uff1a \u70b9\u51fb\u3010\u8bbe\u5907\u65e5\u5fd7\u3011\u4e00\u680f\uff0c\u53ef\u4ee5\u770b\u5230\u8bbe\u5907\u4e0a\u62a5\u7684\u7532\u919b\u6d53\u5ea6\u503c\uff1a \u70b9\u51fb\u3010\u8bbe\u5907\u5c5e\u6027\u3011\u4e00\u680f\uff0c\u70b9\u51fb\u3010\u7532\u919b\u6d53\u5ea6\u503c\u3011\u540e\u7684\u3010\u67e5\u770b\u3011\uff0c\u5373\u53ef\u770b\u5230\u7532\u919b\u6d53\u5ea6\u503c\u7684\u5386\u53f2\u6570\u636e\u66f2\u7ebf\u56fe\uff1a","title":"3. \u4e91\u7aef\u5e73\u53f0\u67e5\u770b\u8bbe\u5907\u6570\u636e"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#_3","text":"","title":"\u4e94\u3001\u817e\u8baf\u8fde\u8fde\u5c0f\u7a0b\u5e8f\u64cd\u4f5c\u6b65\u9aa4"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#1_3","text":"\u624b\u673a\u7aef\u5728\u3010\u5fae\u4fe1\u3011\u641c\u7d22\u3010\u817e\u8baf\u8fde\u8fde\u3011\u5c0f\u7a0b\u5e8f\uff0c\u9996\u6b21\u4f7f\u7528\u9700\u8981\u8fdb\u5165\u540e\u70b9\u51fb\u3010\u6211\u7684\u3011->\u3010\u5bb6\u5ead\u7ba1\u7406\u3011\uff0c\u6dfb\u52a0\u4e00\u4e2a\u4f60\u559c\u6b22\u7684\u540d\u79f0\u5373\u53ef\u3002","title":"1. \u6dfb\u52a0\u5bb6\u5ead"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#2_2","text":"\u8fd4\u56de\u3010\u9996\u9875\u3011\uff0c\u70b9\u51fb\u53f3\u4e0a\u89d2\u201c\u52a0\u53f7\u201d\u56fe\u6807\uff1a \u8fdb\u5165\u540e\u70b9\u51fb\u53f3\u4e0a\u89d2\u626b\u7801\u56fe\u6807\uff1a \u5728\u817e\u8baf\u4e91\u7269\u8054\u7f51\u5f00\u53d1\u5e73\u53f0\u8fdb\u5165\u3010\u8bbe\u5907\u8c03\u8bd5\u3011\uff0c\u70b9\u51fb\u5bf9\u5e94\u8bbe\u5907\u540e\u7684\u3010\u4e8c\u7ef4\u7801\u3011\uff1a \u817e\u8baf\u8fde\u8fde\u626b\u63cf\u6b64\u4e8c\u7ef4\u7801\u5373\u53ef\u6210\u529f\u6dfb\u52a0\u8bbe\u5907\uff0c\u6dfb\u52a0\u6210\u529f\u4e4b\u540e\u5982\u56fe\uff1a \u70b9\u51fb\u6b64\u8bbe\u5907\u5373\u53ef\u5b9e\u65f6\u67e5\u770b\u6570\u636e\uff0c\u5e76\u4e0b\u53d1\u63a7\u5236\u6307\u4ee4\uff1a","title":"2. \u6dfb\u52a0\u8c03\u8bd5\u8bbe\u5907"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#3_3","text":"\u8fdb\u5165\u3010\u4ea4\u4e92\u5f00\u53d1\u3011\uff0c\u70b9\u51fb\u3010\u9762\u677f\u914d\u7f6e\u3011\u4e00\u680f\uff1a \u5728\u6b64\u9875\u9762\u4e2d\u53ef\u4ee5\u81ea\u5df1\u6839\u636e\u559c\u597d\u914d\u7f6e\u5c0f\u7a0b\u5e8f\u663e\u793a\u9762\u677f\uff0c\u5982\u56fe\uff1a \u4fdd\u5b58\u4e4b\u540e\uff0c\u5728\u817e\u8baf\u8fde\u8fde\u5c0f\u7a0b\u5e8f\u5220\u9664\u8bbe\u5907\uff0c\u91cd\u65b0\u626b\u63cf\u7ed1\u5b9a\u8bbe\u5907\u5373\u53ef\u751f\u6548\u3002","title":"3. \u4fee\u6539\u817e\u8baf\u8fde\u8fde\u663e\u793a\u9762\u677f"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#_4","text":"","title":"\u516d\u3001\u817e\u8baf\u8fde\u8fde\u516c\u4f17\u53f7\u62a5\u8b66\u64cd\u4f5c\u6b65\u9aa4"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#1_4","text":"\u70b9\u51fb\u5de6\u4fa7\u3010\u6570\u636e\u5f00\u53d1\u3011\u4e00\u680f\uff0c\u70b9\u51fb\u3010\u65b0\u5efa\u6570\u636e\u6d41\u3011\uff1a \u586b\u5199\u6570\u636e\u6d41\u540d\u79f0\uff1a","title":"1. \u521b\u5efa\u6570\u636e\u6d41"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#2_3","text":"\u6dfb\u52a0\u5e76\u8bbe\u7f6e\u3010\u8bbe\u5907\u6570\u636e\u3011\u8282\u70b9\uff1a \u6dfb\u52a0\u5e76\u8bbe\u7f6e\u3010\u8fc7\u6ee4\u8282\u70b9\u3011\uff1a \u6dfb\u52a0\u5e76\u8bbe\u7f6e\u3010\u63a8\u9001\u8282\u70b9\u3011\uff1a","title":"2. \u8bbe\u8ba1\u6570\u636e\u6d41"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#3_4","text":"\u8bbe\u8ba1\u5b8c\u6210\u540e\uff0c\u70b9\u51fb\u3010\u4fdd\u5b58\u6309\u94ae\u3011\uff0c\u518d\u70b9\u51fb\u3010\u542f\u7528\u3011\uff1a","title":"3. \u542f\u52a8\u6570\u636e\u6d41"},{"location":"29.TencentOS_Tiny_EVB_G0_QuickStart/#4_1","text":"\u5728\u5fae\u4fe1\u5173\u6ce8\u3010\u817e\u8baf\u8fde\u8fde\u3011\u516c\u4f17\u53f7\uff1a \u5173\u6ce8\u540e\uff0c\u5982\u679c\u6709\u4efb\u4f55\u544a\u8b66\u6d88\u606f\uff0c\u5373\u53ef\u5728\u516c\u4f17\u53f7\u63a5\u6536\u5230\u3002 \u5982\u679c\u4ec5\u4ec5\u4e3a\u4e86\u6d4b\u8bd5\u544a\u8b66\u529f\u80fd\uff0c\u53ef\u4ee5\u5148\u5c06\u544a\u8b66\u503c\u8bbe\u8f83\u5c0f\u7684\u503c\uff0c\u6bd4\u5982\u8bbe\u4e3a0.070\uff0c\u6d4b\u8bd5\u5b8c\u6210\u4e4b\u540e\u518d\u6062\u590d\u56fd\u5bb6\u89c4\u5b9a\u6807\u51c60.80\u3002 \u81f3\u6b64\uff0c\u57fa\u4e8eTencentOS-tiny\u7684\u7532\u919b\u76d1\u6d4b\u4eea\u5236\u4f5c\u5b8c\u6210\u3002","title":"4. \u5173\u6ce8\u817e\u8baf\u8fde\u8fde\u516c\u4f17\u53f7"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/","text":"Qmk\uff08Quick Makefile\uff09 1. \u4ecb\u7ecd Qmk \u662f\u4ec0\u4e48 qmk \uff0c \u662fTencentOS\u7684\u4e00\u4e2aMakefile\u7f16\u8bd1\u6846\u67b6\u3002 Qmk \u7684\u7279\u70b9 \u4f7f\u7528\u7b80\u5355\uff0c\u4efb\u610f\u76ee\u5f55\u5747\u53efmake\uff0c\u652f\u6301\u5e2e\u52a9 make help \uff1b \u652f\u6301Makefile\u8c03\u8bd5\uff0c\u4efb\u4f55 \u76ee\u5f55 make BP= dm \u6253\u5370Makefile \u7684\u6240\u6709\u53d8\u91cf\u503c\u3002 \u652f\u6301\u7f16\u8bd1\u8c03\u8bd5, make V=1 \uff0c Make V=2 \u3002 \u652f\u6301\u5b8f\u6269\u5c55\u8c03\u8bd5\u3002 make E=1 \u3002 \u76ee\u5f55\u5206\u79bb\u3002\u6e90\u7801\uff0c\u7f16\u8bd1\u4ea7\u7269\u76ee\u5f55\u5206\u79bb\u3002 \u5165\u95e8\u7b80\u5355\uff0c\u65b0\u6e90\u7801\u76ee\u5f55 Makefile \u62f7\u8d1d\u5373\u53ef\u4f7f\u7528\uff1b \u591a\u67b6\u6784\u652f\u6301\u3002\u652f\u6301\u591a\u79cd MCU ARCH\u3001\u591a\u79cdCC\u5de5\u5177\u94fe\uff1b \u6a21\u677f\u5316\u3002\u591a\u79cd\u573a\u666f\u7684Makefile\u62f7\u8d1d\u5373\u7528; \u914d\u7f6e\u5316\u3002board-pack\u63d0\u4f9bmcu/arch/bsp\u7b49\u7f16\u8bd1\u65f6\u53c2\u6570\u3001\u76ee\u5f55\u7684\u914d\u7f6e\uff1b \u8026\u5408\u4f4e\u3002\u8ddf\u6e90\u7801\u76ee\u5f55\u7ed3\u6784\u7684\u8026\u5408\u4f4e\uff1b \u5b50\u76ee\u5f55\u5355\u72ecmake\u652f\u6301\u3002\u652f\u6301\u5b50\u76ee\u5f55\u7f16\u8bd1.a\u9759\u6001\u5e93\uff1b TencentOS\u7684make\u7f16\u8bd1 TencentOS\u7684\u6574\u4f53make # \u8fdb\u5165board\u76ee\u5f55\u652f\u6301qmk\u7684board cd board/TencentOS_tiny_EVB_MX_Plus/GCC-QMK # \u672c\u76ee\u5f55\u7f16\u8bd1 make # \u67e5\u770b\u5e2e\u52a9 make help TencentOS\u7684\u6574\u4f53\u7f16\u8bd1\u8fc7\u7a0b\u662f\uff1a - \u5148\u7f16\u8bd1\u9759\u6001\u5e93 \u4ece board/ \u4e0b\u7684\u9876\u7ea7Makefile\u5f00\u59cb\uff0c\u8be5Makefile \u786e\u5b9a\u4e86BP \u3002 Makefile \u901a\u8fc7 make -C BP= \u8bbf\u95ee\u5404\u4e2a\u76ee\u5f55\uff0cBP\u7528\u4e8e\u9009\u62e9 qmk/board-pack \u4e0b\u7684\u4e00\u4e2a bp.xxx \u4f5c\u4e3a\u7f16\u8bd1\u53c2\u6570\u96c6\u5408\u3002 make -C BP= \u8fdb\u5165 arch/ kernel/ platform/vendor_bsp \u7b49\u9700\u8981\u7684\u76ee\u5f55\u3002 make\u8fdb\u5165\u5404\u4e2a\u76ee\u5f55\uff0c\u6839\u636e BP \uff0c\u751f\u6210\u5bf9\u5e94\u7684 .a \u9759\u6001\u5e93\uff0c\u5982\u8bbf\u95ee arch/ , \u751f\u6210 libarch.a \uff0c\u5177\u5907\u7f16\u8bd1\u54ea\u4e9barch/\u4e0b\u7684\u6e90\u7801\u6587\u4ef6\u7531 board-pack \u786e\u5b9a\u3002 make\u9012\u5f52\u8bbf\u95ee\u5176\u4ed6\u6e90\u7801\u76ee\u5f55\uff0c\u76ee\u5f55\u7684 \u8282\u70b9Makefile \u901a\u8fc7BP\u6e32\u67d3 include Make.tpl \u6a21\u677f\u751f\u6210\u3002 \u4f9d\u636e\u76ee\u5f55\u7684 \u8282\u70b9Makefile \uff0c\u751f\u6210 libxxx.a \u3002 \u5404\u4e2a\u6e90\u7801\u76ee\u5f55\u8282\u70b9\uff0c\u4f9d\u6b21\u751f\u6210 .a \u9759\u6001\u5e93\u6587\u4ef6\uff0c\u5747\u4f4d\u4e8e build/ \u76ee\u5f55\u4e0b \u3002 \u518d\u94fe\u63a5 make \u56de\u5230 board/ \u7684\u9876\u7ea7Makefile\u3002 \u9700\u8981\u94fe\u63a5\u751f\u6210 elf \u7684\u76ee\u5f55\u901a\u8fc7 include Make.exec \u3002 \u7f16\u8bd1\u672c\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u6240\u6709\u6e90\u6587\u4ef6\uff0c\u751f\u6210 .o \u6587\u4ef6\u3002 \u6839\u636e LD_A_FILES \u548c LD_L_LISTS \u8fdb\u884c\u94fe\u63a5\u3002 \u6574\u4f53\u94fe\u63a5\u5b8c\u6210\uff0c\u751f\u6210\u6587\u4ef6\u4f4d\u4e8e build/ \u76ee\u5f55\u4e0b\u3002 TecentOS\u7684\u5b50\u76ee\u5f55make # \u8fdb\u5165\u67d0\u5305\u542bMakefile\u7684\u76ee\u5f55 cd kernel/ # \u672c\u76ee\u5f55\u7f16\u8bd1\uff0c\u4f7f\u7528Linux_Posix\u4f5c\u4e3aBoard-Pack make BP=Linux_Posix # \u672c\u76ee\u5f55\u7f16\u8bd1\uff0c\u4f7f\u7528TencentOS_tiny_EVB_MX_Plus\u4f5c\u4e3aBoard-Pack make BP=TencentOS_tiny_EVB_MX_Plus # \u67e5\u770b\u5e2e\u52a9 make help \u5355\u76ee\u5f55\u7684\u7f16\u8bd1\u8fc7\u7a0b\u662f\uff1a 3. make\u8bbf\u95ee\u672c\u76ee\u5f55\uff0c\u8bfb\u53d6\u672c\u76ee\u5f55Makefile\uff0c\u6839\u636e\u547d\u4ee4\u884c make BP=xxx \u7684BP\uff0c\u9009\u62e9 mk/board-pack \u3002 3. \u6839\u636eBP\u9009\u62e9\u7684\u6784\u5efa\u53c2\u6570\u3002 3. \u4f7f\u7528ar\u8fdb\u884c\u6253\u5305\uff0c.a \u6587\u4ef6\u653e\u5728 build/ \u76ee\u5f55\u3002 3. \u6784\u5efa\u5b8c\u6210\u3002 Qmk \u7684\u6982\u5ff5 generic-Makefile(mk/generic) qmk/generic/Make.tpl \u5c5e\u4e8e\u8fd9\u7c7b\u3002 \u53c8\u79f0\u5168\u5c40\u901a\u7528\u578bMakefile\u6a21\u677f\u3002\u4f4d\u4e8e mk/generic) \u3002 \u8981\u6c42\u5bf9\u6240\u6709board\u3001\u6240\u6709gcc-toolchain\u3001cpu\u3001arch\u3001bsp\u9002\u7528\u3002 \u6240\u4ee5\u4e00\u822c\u53ea\u5305\u542b\u901a\u7528\u7684\u89c4\u5219\u3002 \u6a21\u677f\u6587\u4ef6 \u8bf4\u660e Make.tpl \u4e00\u4e2a\u76ee\u5f55\u6216\u8005\u591a\u4e2a\u76ee\u5f55\u7f16\u8bd1\u6210 .a \u7684\u901a\u7528\u6a21\u677f Make.exec \u591a\u4e2a .a \u94fe\u63a5\u6210 elf \uff0c\u751f\u6210 .bin \u7684\u901a\u7528\u6a21\u677f Make.lib \u5904\u7406\u591a\u4e2a .o \u751f\u6210 .a \u7684\u901a\u7528\u6a21\u677f Make.subdirs \u5904\u7406 make\u9012\u5f52\u8fdb\u5165\u591a\u4e2asubdir make\u7684\u901a\u7528\u6a21\u677f Make.depend \u5904\u7406 \u4e00\u4e2a .o \u4f9d\u8d56\u591a\u4e2a .h ,\u7684\u89c4\u5219\u6a21\u677f Make.debug \u7528\u4e8e\u8c03\u8bd5Makefile\u7684\u6a21\u677f Make.tools \u7528\u4e8e\u5c4f\u853d\u5728\u591a\u79cdOS\u4f7f\u7528qmk\uff0csed\u3001\u7b49\u57fa\u7840shell/cli\u547d\u4ee4\u8def\u5f84\u4e0d\u540c boardpack-Makefile(mk/board-pack) board-pack/bp.TencentOS_tiny_EVB_MX_Plus \u5c5e\u4e8e\u8fd9\u7c7b\u3002 \u53c8\u79f0\u677f\u7ea7Makefile\u6a21\u677f\u3002\u662f\u4e00\u4e2a\u786c\u4ef6\u4ea7\u54c1\u5de5\u7a0b\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u5728\u7f16\u8bd1\u65f6\u7684\u53c2\u6570\u62bd\u8c61\u6587\u4ef6\u3002 \u4f4d\u4e8emk/board-pack \u7684 bp.${BP}\uff0c\u5c5e\u4e8eboard\u914d\u7f6e\u578bMakefile\uff0c\u9700\u8981\u786e\u5b9a\u5de5\u5177\u94fe\uff0cmcu\uff0carch\u3001board\u3001bsp\u7b49\u65b9\u9762\u7684\u7f16\u8bd1\u65f6\u53c2\u6570\u96c6\u5408\u3002 \u5d4c\u5165\u5f0f\u5e94\u7528\u5f00\u53d1\u5de5\u7a0b\u5e08\u4e3b\u8981\u4fee\u6539\u8fd9\u90e8\u5206Makefile\u3002 srctree-Makefile kernel/Makefile arch/Makefile \u90fd\u5c5e\u4e8e\u8fd9\u7c7b\u3002 \u53c8\u79f0\u8282\u70b9Makefile\uff0c\u4f4d\u4e8e\u5404\u4e2a\u6e90\u7801\u76ee\u5f55\u7684 Makefile\u3002\u591a\u4e2aboard\u90fd\u9002\u7528\u7684Makefile\uff0c\u5c5e\u4e8e\u6e90\u7801\u8282\u70b9\u914d\u7f6e\u578bMakefile\u3002 \u4e0d\u80fd\u5305\u542barch\uff0cboard\u7ea7\u522b\u7684\u7f16\u8bd1\u53c2\u6570\u3002 link-Makefile board/TencentOS_tiny_EVB_MX_Plus/GCC-QMK/app_tencent_os_mqtt/Makefile \u5c5e\u4e8e\u8fd9\u7c7b\u3002 Qmk \u7684\u4f7f\u7528 \u5f53\u524d\u76ee\u5f55\u6240\u6709.c\uff0c\u7f16\u8bd1\u6210\u4e00\u4e2a.a\u5e93 \u8fd9\u7c7bMakefile\u7f16\u5199\u53c2\u8003 osal/posix/Makefile \u3002 \u590d\u5236\u7c98\u8d34 \u4ee5\u4e0b Makefile \u5185\u5bb9\u5230\u6e90\u7801\u76ee\u5f55 Makefile\u3002 \u65e0\u9700\u4fee\u6539\u3002 \u6ce8\u610f TREE_LIB_ENABLE=0 \uff0c,cc\u548car\u65f6\uff0c\u53ea\u641c\u7d22\u5f53\u524d\u76ee\u5f55\u6e90\u7801\uff0c\u4e0d\u5305\u542b\u5b50\u76ee\u5f55\uff1b \u6ce8\u610f lib= \uff0c\u8868\u793a\u94fe\u63a5\u540e\u7684\u5e93\u540d\u4f7f\u7528\u76ee\u5f55\u540d\uff1b \u6709\u7279\u522b\u7684CFLAG\u8bf7\u6839\u636e\u60c5\u51b5\u914d\u7f6e CFGFLAGS \u3002 \u6ce8\u610f\u677f\u7ea7\u7684\u7f16\u8bd1\u53c2\u6570\u8bf7\u914d\u7f6e\u5230pack-Makefile\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4\u5176\u4ed6pack\u7f16\u8bd1\u62a5\u9519. ################################################################### #automatic detection QTOP and LOCALDIR CUR_DIR := $(patsubst %/,%,$(dir $(realpath $(firstword $(MAKEFILE_LIST))))) TRYQTOP := $(shell if [ -n \"$$QTOP\" ] ; then\\ echo $$QTOP;\\ else\\ cd $(CUR_DIR); while /usr/bin/test ! -d qmk ; do \\ dir=`cd ../;pwd`; \\ if [ \"$$dir\" = \"/\" ] ; then \\ echo Cannot find QTOP in $(firstword $(MAKEFILE_LIST)) 1>&2; \\ exit 1; \\ fi ; \\ cd $$dir; \\ done ; \\ pwd; \\ fi) QTOP ?= $(realpath ${TRYQTOP}) ifeq ($(QTOP),) $(error Please run this in a tree) endif LOCALDIR = $(patsubst %/,%,$(subst $(realpath $(QTOP))/,,$(CUR_DIR))) #################################################################### TREE_LIB_ENABLE=0 lib= subdirs= CFGFLAGS += -I$(CUR_DIR)/include include ${QTOP}/qmk/generic/Make.tpl \u67d0\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u7684\u6240\u6709.c\uff0c\u7f16\u8bd1\u6210\u4e00\u4e2a.a\u5e93 \u8fd9\u7c7bMakefile\u7f16\u5199\u53c2\u8003 kernel/Makefile \u3002 \u590d\u5236\u7c98\u8d34 \u4ee5\u4e0b Makefile \u5185\u5bb9\u5230\u6e90\u7801\u76ee\u5f55 Makefile\u3002 \u65e0\u9700\u4fee\u6539\u3002 \u6709\u7279\u522b\u7684CFLAG\u8bf7\u6839\u636e\u60c5\u51b5\u914d\u7f6e CFGFLAGS \u3002 \u6ce8\u610f TREE_LIB_ENABLE=1 ,cc\u548car\u65f6\uff0c\u4f1a\u9012\u5f52\u641c\u7d22\u6e90\u7801\uff0c\u5305\u542b\u5f53\u524d\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u3002 \u6ce8\u610f lib= \uff0c\u8868\u793a\u94fe\u63a5\u540e\u7684\u5e93\u540d\u4f7f\u7528\u76ee\u5f55\u540d\uff1b \u6ce8\u610f\u677f\u7ea7\u7684\u7f16\u8bd1\u53c2\u6570\u8bf7\u914d\u7f6e\u5230pack-Makefile\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4\u5176\u4ed6pack\u7f16\u8bd1\u62a5\u9519. ################################################################### #automatic detection QTOP and LOCALDIR CUR_DIR := $(patsubst %/,%,$(dir $(realpath $(firstword $(MAKEFILE_LIST))))) TRYQTOP := $(shell if [ -n \"$$QTOP\" ] ; then\\ echo $$QTOP;\\ else\\ cd $(CUR_DIR); while /usr/bin/test ! -d qmk ; do \\ dir=`cd ../;pwd`; \\ if [ \"$$dir\" = \"/\" ] ; then \\ echo Cannot find QTOP in $(firstword $(MAKEFILE_LIST)) 1>&2; \\ exit 1; \\ fi ; \\ cd $$dir; \\ done ; \\ pwd; \\ fi) QTOP ?= $(realpath ${TRYQTOP}) ifeq ($(QTOP),) $(error Please run this in a tree) endif LOCALDIR = $(patsubst %/,%,$(subst $(realpath $(QTOP))/,,$(CUR_DIR))) #################################################################### TREE_LIB_ENABLE=1 lib= subdirs= CFGFLAGS += -I${QTOP}/kernel/core/include CFGFLAGS += -I${QTOP}/kernel/evtdrv/include CFGFLAGS += -I${QTOP}/kernel/hal/include CFGFLAGS += -I${QTOP}/kernel/pm/include include ${QTOP}/qmk/generic/Make.tpl \u5f53\u524d\u76ee\u5f55\u8fdb\u5165\u6240\u6709\u5b50\u76ee\u5f55\u3001\u8fdb\u5165\u6307\u5b9a\u76ee\u5f55\u7f16\u8bd1 \u8fd9\u7c7bMakefile\u7f16\u5199\u53c2\u8003 platform/Makefile \u3002 \u590d\u5236\u7c98\u8d34 \u4ee5\u4e0b Makefile \u5185\u5bb9\u5230\u6e90\u7801\u76ee\u5f55 Makefile\u3002 \u65e0\u9700\u4fee\u6539\u3002 \u6709\u7279\u522b\u7684CFLAG\u8bf7\u6839\u636e\u60c5\u51b5\u914d\u7f6e CFGFLAGS \u3002 \u6ce8\u610f subdirs= \u4e3a\u7a7a\uff0c\u9ed8\u8ba4\u4f1a\u8fdb\u5165\u6240\u6709\u5b50\u76ee\u5f55\u3002 \u5982\u679c\u9700\u8981\u6307\u5b9a\u5b50\u76ee\u5f55\u8bf7\u7ed9 subdirs \u8d4b\u503c\u3002 ################################################################### #automatic detection QTOP and LOCALDIR CUR_DIR := $(patsubst %/,%,$(dir $(realpath $(firstword $(MAKEFILE_LIST))))) TRYQTOP := $(shell if [ -n \"$$QTOP\" ] ; then\\ echo $$QTOP;\\ else\\ cd $(CUR_DIR); while /usr/bin/test ! -e qmk ; do \\ dir=`cd ../;pwd`; \\ if [ \"$$dir\" = \"/\" ] ; then \\ echo Cannot find QTOP in $(firstword $(MAKEFILE_LIST)) 1>&2; \\ exit 1; \\ fi ; \\ cd $$dir; \\ done ; \\ pwd; \\ fi) QTOP ?= $(realpath ${TRYQTOP}) ifeq ($(QTOP),) $(error Please run this in a tree) endif LOCALDIR = $(patsubst %/,%,$(subst $(realpath $(QTOP))/,,$(CUR_DIR))) #################################################################### TREE_LIB_ENABLE=0 lib= subdirs= include ${QTOP}/qmk/generic/Make.tpl \u65b0\u589e\u4e00\u4e2a board-pack\uff0c\u652f\u6301\u65b0\u7684board \u53c2\u8003 mk/board-pack/ \u4e0b\u7684\u5404\u4e2a\u6587\u4ef6\u3002 \u53c2\u8003 qmk/board-pack/bp.TencentOS_tiny_EVB_MX_Plus \u3002 board-pack \u662f\u5bf9 board \u5728\u7f16\u8bd1\u65f6\u7684\u4e00\u4e2a\u62bd\u8c61\u3002 \u4e00\u4e2aboard \u786e\u5b9a\u4e86 MCU\u3001 arch\u3001\u5de5\u5177\u94fe\uff0c\u628a\u8fd9\u4e9b\u7f16\u8bd1\u65f6\u53c2\u6570\u5199\u6210\u4e00\u4e2abp.xxx\u3002 \u65b0\u6574\u4e00\u4e2aboard-pack\u7684\u6b65\u9aa4\uff1a - qmk/board-pack/\u76ee\u5f55\u4e0b\uff0c\u65b0\u5efa\u4e00\u4e2abp.xxx. - \u5728bp.xxx\u5b9a\u4e49\u4ee5\u4e0b\u53d8\u91cf\uff1a \u6ce8\u610f CFGFLAGS \u9700\u8981\u5305\u62ec cpu\u3001arch\u3001board \u7b49\u7c7b\u578b\u7684FLAG\u3002 \u8d4b\u503c\u5efa\u8bae\u7528`+=`\uff0c\u4e0d\u5141\u8bb8\u7528 `:=`\u3002\u6ce8\u610f \u53ef\u4ee5\u5f15\u7528`QTOP`\uff0c`BLDROOT`\u53d8\u91cf,\u4e0d\u5efa\u8bae\u5f15\u7528\u5176\u4ed6`qmk/generic/`\u6a21\u677f\u7684\u53d8\u91cf\u3002 Makefile\u53d8\u91cf\u540d \u53d8\u91cf\u8d4b\u503c\u4e3e\u4f8b \u53d8\u91cf\u8bf4\u660e CROSS_COMPILE CROSS_COMPILE =arm-none-eabi- \u5de5\u5177\u94fe\u524d\u7f00 CC CC = $(CROSS_COMPILE)gcc \u5de5\u5177\u94fe CXX CXX = $(CROSS_COMPILE)g++ \u5de5\u5177\u94fe LD LD = $(CROSS_COMPILE)ld \u5de5\u5177\u94fe ARFLAGS ARFLAGS = -rc \u5de5\u5177\u94fe STRIP STRIP = $(CROSS_COMPILE)strip \u5de5\u5177\u94fe CFGFLAGS \u53c2\u8003 bp.TencentOS_tiny_EVB_MX_Plus \u5bf9CFLAGS\u3001CXXFLAGS \u8fdb\u884c\u589e\u52a0 ARCH_LSRCS \u53c2\u8003 bp.TencentOS_tiny_EVB_MX_Plus board-pack\u5bf9\u5e94\u7684arch/\u6e90\u7801\uff0c`make -C arch/\u65f6\u9700\u8981\u7f16\u8bd1\u7684\u6e90\u7801\uff0c\u7edd\u5bf9\u8def\u5f84\uff0c\u6216\u76f8\u5bf9\u4e8eQTOP\u7684\u76f8\u5bf9\u8def\u5f84 BSP_LSRCS \u53c2\u8003 bp.TencentOS_tiny_EVB_MX_Plus board-pack\u5bf9\u5e94\u7684board/bsp\u6e90\u7801 PLATFORM_VENDOR_BSP_LSRCS \u53c2\u8003 bp.TencentOS_tiny_EVB_MX_Plus board-pack\u5bf9\u5e94\u7684vendor_bsp \u6e90\u7801,`make -C platform/vendor_bsp\u65f6\u9700\u8981\u7f16\u8bd1\u7684\u6e90\u7801 PLATFORM_VENDOR_BSP_LSRCS \u53c2\u8003 bp.TencentOS_tiny_EVB_MX_Plus board-pack\u5bf9\u5e94\u7684vendor_bsp \u6e90\u7801,`make -C platform/vendor_bsp\u65f6\u9700\u8981\u7f16\u8bd1\u7684\u6e90\u7801 PLATFORM_HAL_LSRCS \u53c2\u8003 bp.TencentOS_tiny_EVB_MX_Plus board-pack\u5bf9\u5e94\u7684 hal \u6e90\u7801,`make -C platform/hal\u65f6 Qmk \u7684\u6a21\u677f\u7684\u5185\u7f6e\u53d8\u91cf \u53d8\u91cf\u540d \u8d4b\u503c \u53d8\u91cf\u503c\u8bf4\u660e \u503c\u4e3e\u4f8b AR bp\u4e2d\u8d4b\u503c \u5de5\u5177\u94fe \"arm-none-eabi-ar\" ARCH_LSRCS bp\u4e2d\u8d4b\u503c \u8fdb\u5165arch/\u9700\u8981\u7f16\u8bd1\u7684\u6e90\u7801\uff0c\u7edd\u5bf9\u8def\u5f84\u6216\u76f8\u5bf9\u4e8eQTOP\u7684\u6e90\u7801\u8def\u5f84 \"/root/democode/TencentOS-tiny/arch/arm/arm-v7m/cortex-m4/gcc/port_c.c /root/democode/TencentOS-tiny/arch/arm/arm-v7m/cortex-m4/gcc/port_s.S /root/democode/TencentOS-tiny/arch/arm/arm-v7m/common/tos_fault.c /root/democode/TencentOS-tiny/arch/arm/arm-v7m/common/tos_cpu.c /root/democode/TencentOS-tiny/arch/arm/arm-v7m/cortex-m4/gcc/port_c.c /root/democode/TencentOS-tiny/arch/arm/arm-v7m/cortex-m4/gcc/port_s.S /root/democode/TencentOS-tiny/arch/arm/arm-v7m/common/tos_fault.c /root/democode/TencentOS-tiny/arch/arm/arm-v7m/common/tos_cpu.c \" ARFLAGS bp\u4e2d\u8d4b\u503c \u5de5\u5177\u94fe\u53c2\u6570 ar \u53c2\u6570,\u542b\u4e49\u89c1 ar --help BLDDIR \u7981\u6b62\u8d4b\u503c \u6807\u8bc6.o\u7b49\u7f16\u8bd1\u4ea7\u7269\u6240\u5728\u7684\u76ee\u5f55\uff0c\u8ddf\u6e90\u7801LOCALDIR\u6709\u5173 \"/root/democode/TencentOS-tiny/build/TencentOS_tiny_EVB_MX_Plus.arm-none-eabi-gcc.tos/arch\" BLDROOT \u7981\u6b62\u8d4b\u503c \u6807\u8bc6\u7f16\u8bd1\u4ea7\u7269\u4f4d\u7f6e\u76ee\u5f55\u3002 \"/root/democode/TencentOS-tiny/build/TencentOS_tiny_EVB_MX_Plus.arm-none-eabi-gcc.tos\" BLD_SUFFIX \u7981\u6b62\u8d4b\u503c \u7f16\u8bd1\u4ea7\u7269\u4f4d\u7f6e\u76ee\u5f55\u7684\u540e\u7f00\u540d BOBJS \u7981\u6b62\u8d4b\u503c \u6240\u6709OBJ\u96c6\u5408\uff0c\u7edd\u5bf9\u8def\u5f84 \"/root/democode/TencentOS-tiny/build/TencentOS_tiny_EVB_MX_Plus.arm-none-eabi-gcc.tos/arch/arm/arm-v7m/cortex-m4/gcc/port_c.o /root/democode/TencentOS-tiny/build/TencentOS_tiny_EVB_MX_Plus.arm-none-eabi-gcc.tos/arch/arm/arm-v7m/cortex-m4/gcc/port_s.o /root/democode/TencentOS-tiny/build/TencentOS_tiny_EVB_MX_Plus.arm-none-eabi-gcc.tos/arch/arm/arm-v7m/common/tos_fault.o /root/democode/TencentOS-tiny/build/TencentOS_tiny_EVB_MX_Plus.arm-none-eabi-gcc.tos/arch/arm/arm-v7m/common/tos_cpu.o\" CC bp\u4e2d\u8d4b\u503c \"arm-none-eabi-gcc\" CROSS_COMPILE \u5de5\u5177\u94fe \"arm-none-eabi-\" CURDIR \u7981\u6b62\u8d4b\u503c \u6807\u8bc6\u5f53\u524dMakefile \u6240\u5728\u7684\u76ee\u5f55 \"/root/democode/TencentOS-tiny/arch\" CUR_DIR \u7981\u6b62\u8d4b\u503c \u6807\u8bc6\u5f53\u524dMakefile \u6240\u5728\u7684\u76ee\u5f55 \"/root/democode/TencentOS-tiny/arch\" CUR_MK_NODE_DIR \u7981\u6b62\u8d4b\u503c \u6807\u8bc6\u5f53\u524dMakefile \u6240\u5728\u7684\u76ee\u5f55 \"/root/democode/TencentOS-tiny/arch\" CXX bp\u4e2d\u8d4b\u503c \"arm-none-eabi-g++\" LD bp\u4e2d\u8d4b\u503c \"arm-none-eabi-ld\" LDFLAGS bp\u4e2d\u8d4b\u503c \" \" LOBJS \u7981\u6b62\u8d4b\u503c OBJ\u6587\u4ef6\u96c6\u5408\uff0c\u76f8\u5bf9\u8def\u5f84\uff0c\u76f8\u5bf9\u4e8e\u5f53\u524dMakefile\u76ee\u5f55 \"arm/arm-v7m/cortex-m4/gcc/port_c.o arm/arm-v7m/cortex-m4/gcc/port_s.o arm/arm-v7m/common/tos_fault.o arm/arm-v7m/common/tos_cpu.o\" LOCALDIR \u7981\u6b62\u8d4b\u503c \u6e90\u7801\u76ee\u5f55\u4f4d\u7f6e\uff0c\u76f8\u5bf9\u8def\u5f84\uff0c\u76f8\u5bf9\u4e8eQTOP \"arch\" LSRCS \u7981\u6b62\u5728bp\u4e2d\u8d4b\u503c\uff0c\u53ef\u4ee5\u5728src-Makefile\u8d4b\u503c \u7f16\u8bd1\u6e90\u4ee3\u7801\u6587\u4ef6\u96c6\u5408\uff0c\u76f8\u5bf9\u8def\u5f84\uff0c\u76f8\u5bf9\u4e8e\u5f53\u524dMakefile\u76ee\u5f55\uff0c\u6216\u8005\u7edd\u5bf9\u8def\u5f84 \"arm/arm-v7m/cortex-m4/gcc/port_c.c arm/arm-v7m/cortex-m4/gcc/port_s.S arm/arm-v7m/common/tos_fault.c arm/arm-v7m/common/tos_cpu.c \" QTOP \u7981\u6b62\u8d4b\u503c \u6e90\u7801\u4e00\u7ea7\u76ee\u5f55 \"/root/democode/TencentOS-tiny\" RANLIB bp\u4e2d\u8d4b\u503c \"arm-none-eabi-ranlib\" STRIP bp\u4e2d\u8d4b\u503c \"arm-none-eabi-strip\" TREE_LIB_ENABLE src-Makefile\u8d4b\u503c\uff0c\u975e0 \u8868\u793a\u7f16\u8bd1\u6240\u6709\u5b50\u76ee\u5f55\u6e90\u7801 LSRCS\u662f\u5426\u628a\u5b50\u76ee\u5f55\u6e90\u7801 \"0\" lib \u4e0d\u5efa\u8bae\u8d4b\u503c .a \u5e93\u540d\u53d8\u91cf\uff0c\u9ed8\u8ba4\u76ee\u5f55\u540d \"libarch\" targetlib \u7981\u6b62\u8d4b\u503c \"/root/democode/TencentOS-tiny/build/TencentOS_tiny_EVB_MX_Plus.arm-none-eabi-gcc.tos/libarch.a\" qmk\u7684 make \u547d\u4ee4\u884c\u53c2\u6570 make help make V=1 E=1 # verbose\u6253\u5370\u7f16\u8bd1\u65f6\u7684\u547d\u4ee4 make V=1 # \u8c03\u8bd5\u5934\u6587\u4ef6\u5305\u542b\uff0c\u5b8f\u6269\u5c55\u65f6\u5f88\u6709\u7528\uff0c\u4f1a\u5728\u751f\u6210`.o`\u6587\u4ef6\u7684\u540c\u65f6\u751f\u6210`.i`\u9884\u5904\u7406\u6587\u4ef6 make E=1 # verbose\u6253\u5370\u94fe\u63a5\u65f6\u7684\u5e93\u641c\u7d22\u8fc7\u7a0b make V=2 make V=3 \u8c03\u8bd5Makefile #\u8fdb\u5165\u542bMakefile\u7684\u76ee\u5f55 make BP=TencentOS_tiny_EVB_MX_Plus dm Qmk \u540e\u7eed","title":"Qmk\uff08Quick Makefile\uff09"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#qmkquick-makefile","text":"","title":"Qmk\uff08Quick Makefile\uff09"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#1","text":"","title":"1. \u4ecb\u7ecd"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#qmk","text":"qmk \uff0c \u662fTencentOS\u7684\u4e00\u4e2aMakefile\u7f16\u8bd1\u6846\u67b6\u3002","title":"Qmk \u662f\u4ec0\u4e48"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#qmk_1","text":"\u4f7f\u7528\u7b80\u5355\uff0c\u4efb\u610f\u76ee\u5f55\u5747\u53efmake\uff0c\u652f\u6301\u5e2e\u52a9 make help \uff1b \u652f\u6301Makefile\u8c03\u8bd5\uff0c\u4efb\u4f55 \u76ee\u5f55 make BP= dm \u6253\u5370Makefile \u7684\u6240\u6709\u53d8\u91cf\u503c\u3002 \u652f\u6301\u7f16\u8bd1\u8c03\u8bd5, make V=1 \uff0c Make V=2 \u3002 \u652f\u6301\u5b8f\u6269\u5c55\u8c03\u8bd5\u3002 make E=1 \u3002 \u76ee\u5f55\u5206\u79bb\u3002\u6e90\u7801\uff0c\u7f16\u8bd1\u4ea7\u7269\u76ee\u5f55\u5206\u79bb\u3002 \u5165\u95e8\u7b80\u5355\uff0c\u65b0\u6e90\u7801\u76ee\u5f55 Makefile \u62f7\u8d1d\u5373\u53ef\u4f7f\u7528\uff1b \u591a\u67b6\u6784\u652f\u6301\u3002\u652f\u6301\u591a\u79cd MCU ARCH\u3001\u591a\u79cdCC\u5de5\u5177\u94fe\uff1b \u6a21\u677f\u5316\u3002\u591a\u79cd\u573a\u666f\u7684Makefile\u62f7\u8d1d\u5373\u7528; \u914d\u7f6e\u5316\u3002board-pack\u63d0\u4f9bmcu/arch/bsp\u7b49\u7f16\u8bd1\u65f6\u53c2\u6570\u3001\u76ee\u5f55\u7684\u914d\u7f6e\uff1b \u8026\u5408\u4f4e\u3002\u8ddf\u6e90\u7801\u76ee\u5f55\u7ed3\u6784\u7684\u8026\u5408\u4f4e\uff1b \u5b50\u76ee\u5f55\u5355\u72ecmake\u652f\u6301\u3002\u652f\u6301\u5b50\u76ee\u5f55\u7f16\u8bd1.a\u9759\u6001\u5e93\uff1b","title":"Qmk \u7684\u7279\u70b9"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#tencentosmake","text":"","title":"TencentOS\u7684make\u7f16\u8bd1"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#tencentosmake_1","text":"# \u8fdb\u5165board\u76ee\u5f55\u652f\u6301qmk\u7684board cd board/TencentOS_tiny_EVB_MX_Plus/GCC-QMK # \u672c\u76ee\u5f55\u7f16\u8bd1 make # \u67e5\u770b\u5e2e\u52a9 make help TencentOS\u7684\u6574\u4f53\u7f16\u8bd1\u8fc7\u7a0b\u662f\uff1a - \u5148\u7f16\u8bd1\u9759\u6001\u5e93 \u4ece board/ \u4e0b\u7684\u9876\u7ea7Makefile\u5f00\u59cb\uff0c\u8be5Makefile \u786e\u5b9a\u4e86BP \u3002 Makefile \u901a\u8fc7 make -C BP= \u8bbf\u95ee\u5404\u4e2a\u76ee\u5f55\uff0cBP\u7528\u4e8e\u9009\u62e9 qmk/board-pack \u4e0b\u7684\u4e00\u4e2a bp.xxx \u4f5c\u4e3a\u7f16\u8bd1\u53c2\u6570\u96c6\u5408\u3002 make -C BP= \u8fdb\u5165 arch/ kernel/ platform/vendor_bsp \u7b49\u9700\u8981\u7684\u76ee\u5f55\u3002 make\u8fdb\u5165\u5404\u4e2a\u76ee\u5f55\uff0c\u6839\u636e BP \uff0c\u751f\u6210\u5bf9\u5e94\u7684 .a \u9759\u6001\u5e93\uff0c\u5982\u8bbf\u95ee arch/ , \u751f\u6210 libarch.a \uff0c\u5177\u5907\u7f16\u8bd1\u54ea\u4e9barch/\u4e0b\u7684\u6e90\u7801\u6587\u4ef6\u7531 board-pack \u786e\u5b9a\u3002 make\u9012\u5f52\u8bbf\u95ee\u5176\u4ed6\u6e90\u7801\u76ee\u5f55\uff0c\u76ee\u5f55\u7684 \u8282\u70b9Makefile \u901a\u8fc7BP\u6e32\u67d3 include Make.tpl \u6a21\u677f\u751f\u6210\u3002 \u4f9d\u636e\u76ee\u5f55\u7684 \u8282\u70b9Makefile \uff0c\u751f\u6210 libxxx.a \u3002 \u5404\u4e2a\u6e90\u7801\u76ee\u5f55\u8282\u70b9\uff0c\u4f9d\u6b21\u751f\u6210 .a \u9759\u6001\u5e93\u6587\u4ef6\uff0c\u5747\u4f4d\u4e8e build/ \u76ee\u5f55\u4e0b \u3002 \u518d\u94fe\u63a5 make \u56de\u5230 board/ \u7684\u9876\u7ea7Makefile\u3002 \u9700\u8981\u94fe\u63a5\u751f\u6210 elf \u7684\u76ee\u5f55\u901a\u8fc7 include Make.exec \u3002 \u7f16\u8bd1\u672c\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u6240\u6709\u6e90\u6587\u4ef6\uff0c\u751f\u6210 .o \u6587\u4ef6\u3002 \u6839\u636e LD_A_FILES \u548c LD_L_LISTS \u8fdb\u884c\u94fe\u63a5\u3002 \u6574\u4f53\u94fe\u63a5\u5b8c\u6210\uff0c\u751f\u6210\u6587\u4ef6\u4f4d\u4e8e build/ \u76ee\u5f55\u4e0b\u3002","title":"TencentOS\u7684\u6574\u4f53make"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#tecentosmake","text":"# \u8fdb\u5165\u67d0\u5305\u542bMakefile\u7684\u76ee\u5f55 cd kernel/ # \u672c\u76ee\u5f55\u7f16\u8bd1\uff0c\u4f7f\u7528Linux_Posix\u4f5c\u4e3aBoard-Pack make BP=Linux_Posix # \u672c\u76ee\u5f55\u7f16\u8bd1\uff0c\u4f7f\u7528TencentOS_tiny_EVB_MX_Plus\u4f5c\u4e3aBoard-Pack make BP=TencentOS_tiny_EVB_MX_Plus # \u67e5\u770b\u5e2e\u52a9 make help \u5355\u76ee\u5f55\u7684\u7f16\u8bd1\u8fc7\u7a0b\u662f\uff1a 3. make\u8bbf\u95ee\u672c\u76ee\u5f55\uff0c\u8bfb\u53d6\u672c\u76ee\u5f55Makefile\uff0c\u6839\u636e\u547d\u4ee4\u884c make BP=xxx \u7684BP\uff0c\u9009\u62e9 mk/board-pack \u3002 3. \u6839\u636eBP\u9009\u62e9\u7684\u6784\u5efa\u53c2\u6570\u3002 3. \u4f7f\u7528ar\u8fdb\u884c\u6253\u5305\uff0c.a \u6587\u4ef6\u653e\u5728 build/ \u76ee\u5f55\u3002 3. \u6784\u5efa\u5b8c\u6210\u3002","title":"TecentOS\u7684\u5b50\u76ee\u5f55make"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#qmk_2","text":"","title":"Qmk \u7684\u6982\u5ff5"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#generic-makefilemkgeneric","text":"qmk/generic/Make.tpl \u5c5e\u4e8e\u8fd9\u7c7b\u3002 \u53c8\u79f0\u5168\u5c40\u901a\u7528\u578bMakefile\u6a21\u677f\u3002\u4f4d\u4e8e mk/generic) \u3002 \u8981\u6c42\u5bf9\u6240\u6709board\u3001\u6240\u6709gcc-toolchain\u3001cpu\u3001arch\u3001bsp\u9002\u7528\u3002 \u6240\u4ee5\u4e00\u822c\u53ea\u5305\u542b\u901a\u7528\u7684\u89c4\u5219\u3002 \u6a21\u677f\u6587\u4ef6 \u8bf4\u660e Make.tpl \u4e00\u4e2a\u76ee\u5f55\u6216\u8005\u591a\u4e2a\u76ee\u5f55\u7f16\u8bd1\u6210 .a \u7684\u901a\u7528\u6a21\u677f Make.exec \u591a\u4e2a .a \u94fe\u63a5\u6210 elf \uff0c\u751f\u6210 .bin \u7684\u901a\u7528\u6a21\u677f Make.lib \u5904\u7406\u591a\u4e2a .o \u751f\u6210 .a \u7684\u901a\u7528\u6a21\u677f Make.subdirs \u5904\u7406 make\u9012\u5f52\u8fdb\u5165\u591a\u4e2asubdir make\u7684\u901a\u7528\u6a21\u677f Make.depend \u5904\u7406 \u4e00\u4e2a .o \u4f9d\u8d56\u591a\u4e2a .h ,\u7684\u89c4\u5219\u6a21\u677f Make.debug \u7528\u4e8e\u8c03\u8bd5Makefile\u7684\u6a21\u677f Make.tools \u7528\u4e8e\u5c4f\u853d\u5728\u591a\u79cdOS\u4f7f\u7528qmk\uff0csed\u3001\u7b49\u57fa\u7840shell/cli\u547d\u4ee4\u8def\u5f84\u4e0d\u540c","title":"generic-Makefile(mk/generic)"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#boardpack-makefilemkboard-pack","text":"board-pack/bp.TencentOS_tiny_EVB_MX_Plus \u5c5e\u4e8e\u8fd9\u7c7b\u3002 \u53c8\u79f0\u677f\u7ea7Makefile\u6a21\u677f\u3002\u662f\u4e00\u4e2a\u786c\u4ef6\u4ea7\u54c1\u5de5\u7a0b\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u5728\u7f16\u8bd1\u65f6\u7684\u53c2\u6570\u62bd\u8c61\u6587\u4ef6\u3002 \u4f4d\u4e8emk/board-pack \u7684 bp.${BP}\uff0c\u5c5e\u4e8eboard\u914d\u7f6e\u578bMakefile\uff0c\u9700\u8981\u786e\u5b9a\u5de5\u5177\u94fe\uff0cmcu\uff0carch\u3001board\u3001bsp\u7b49\u65b9\u9762\u7684\u7f16\u8bd1\u65f6\u53c2\u6570\u96c6\u5408\u3002 \u5d4c\u5165\u5f0f\u5e94\u7528\u5f00\u53d1\u5de5\u7a0b\u5e08\u4e3b\u8981\u4fee\u6539\u8fd9\u90e8\u5206Makefile\u3002","title":"boardpack-Makefile(mk/board-pack)"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#srctree-makefile","text":"kernel/Makefile arch/Makefile \u90fd\u5c5e\u4e8e\u8fd9\u7c7b\u3002 \u53c8\u79f0\u8282\u70b9Makefile\uff0c\u4f4d\u4e8e\u5404\u4e2a\u6e90\u7801\u76ee\u5f55\u7684 Makefile\u3002\u591a\u4e2aboard\u90fd\u9002\u7528\u7684Makefile\uff0c\u5c5e\u4e8e\u6e90\u7801\u8282\u70b9\u914d\u7f6e\u578bMakefile\u3002 \u4e0d\u80fd\u5305\u542barch\uff0cboard\u7ea7\u522b\u7684\u7f16\u8bd1\u53c2\u6570\u3002","title":"srctree-Makefile"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#link-makefile","text":"board/TencentOS_tiny_EVB_MX_Plus/GCC-QMK/app_tencent_os_mqtt/Makefile \u5c5e\u4e8e\u8fd9\u7c7b\u3002","title":"link-Makefile"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#qmk_3","text":"","title":"Qmk \u7684\u4f7f\u7528"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#ca","text":"\u8fd9\u7c7bMakefile\u7f16\u5199\u53c2\u8003 osal/posix/Makefile \u3002 \u590d\u5236\u7c98\u8d34 \u4ee5\u4e0b Makefile \u5185\u5bb9\u5230\u6e90\u7801\u76ee\u5f55 Makefile\u3002 \u65e0\u9700\u4fee\u6539\u3002 \u6ce8\u610f TREE_LIB_ENABLE=0 \uff0c,cc\u548car\u65f6\uff0c\u53ea\u641c\u7d22\u5f53\u524d\u76ee\u5f55\u6e90\u7801\uff0c\u4e0d\u5305\u542b\u5b50\u76ee\u5f55\uff1b \u6ce8\u610f lib= \uff0c\u8868\u793a\u94fe\u63a5\u540e\u7684\u5e93\u540d\u4f7f\u7528\u76ee\u5f55\u540d\uff1b \u6709\u7279\u522b\u7684CFLAG\u8bf7\u6839\u636e\u60c5\u51b5\u914d\u7f6e CFGFLAGS \u3002 \u6ce8\u610f\u677f\u7ea7\u7684\u7f16\u8bd1\u53c2\u6570\u8bf7\u914d\u7f6e\u5230pack-Makefile\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4\u5176\u4ed6pack\u7f16\u8bd1\u62a5\u9519. ################################################################### #automatic detection QTOP and LOCALDIR CUR_DIR := $(patsubst %/,%,$(dir $(realpath $(firstword $(MAKEFILE_LIST))))) TRYQTOP := $(shell if [ -n \"$$QTOP\" ] ; then\\ echo $$QTOP;\\ else\\ cd $(CUR_DIR); while /usr/bin/test ! -d qmk ; do \\ dir=`cd ../;pwd`; \\ if [ \"$$dir\" = \"/\" ] ; then \\ echo Cannot find QTOP in $(firstword $(MAKEFILE_LIST)) 1>&2; \\ exit 1; \\ fi ; \\ cd $$dir; \\ done ; \\ pwd; \\ fi) QTOP ?= $(realpath ${TRYQTOP}) ifeq ($(QTOP),) $(error Please run this in a tree) endif LOCALDIR = $(patsubst %/,%,$(subst $(realpath $(QTOP))/,,$(CUR_DIR))) #################################################################### TREE_LIB_ENABLE=0 lib= subdirs= CFGFLAGS += -I$(CUR_DIR)/include include ${QTOP}/qmk/generic/Make.tpl","title":"\u5f53\u524d\u76ee\u5f55\u6240\u6709.c\uff0c\u7f16\u8bd1\u6210\u4e00\u4e2a.a\u5e93"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#ca_1","text":"\u8fd9\u7c7bMakefile\u7f16\u5199\u53c2\u8003 kernel/Makefile \u3002 \u590d\u5236\u7c98\u8d34 \u4ee5\u4e0b Makefile \u5185\u5bb9\u5230\u6e90\u7801\u76ee\u5f55 Makefile\u3002 \u65e0\u9700\u4fee\u6539\u3002 \u6709\u7279\u522b\u7684CFLAG\u8bf7\u6839\u636e\u60c5\u51b5\u914d\u7f6e CFGFLAGS \u3002 \u6ce8\u610f TREE_LIB_ENABLE=1 ,cc\u548car\u65f6\uff0c\u4f1a\u9012\u5f52\u641c\u7d22\u6e90\u7801\uff0c\u5305\u542b\u5f53\u524d\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u3002 \u6ce8\u610f lib= \uff0c\u8868\u793a\u94fe\u63a5\u540e\u7684\u5e93\u540d\u4f7f\u7528\u76ee\u5f55\u540d\uff1b \u6ce8\u610f\u677f\u7ea7\u7684\u7f16\u8bd1\u53c2\u6570\u8bf7\u914d\u7f6e\u5230pack-Makefile\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4\u5176\u4ed6pack\u7f16\u8bd1\u62a5\u9519. ################################################################### #automatic detection QTOP and LOCALDIR CUR_DIR := $(patsubst %/,%,$(dir $(realpath $(firstword $(MAKEFILE_LIST))))) TRYQTOP := $(shell if [ -n \"$$QTOP\" ] ; then\\ echo $$QTOP;\\ else\\ cd $(CUR_DIR); while /usr/bin/test ! -d qmk ; do \\ dir=`cd ../;pwd`; \\ if [ \"$$dir\" = \"/\" ] ; then \\ echo Cannot find QTOP in $(firstword $(MAKEFILE_LIST)) 1>&2; \\ exit 1; \\ fi ; \\ cd $$dir; \\ done ; \\ pwd; \\ fi) QTOP ?= $(realpath ${TRYQTOP}) ifeq ($(QTOP),) $(error Please run this in a tree) endif LOCALDIR = $(patsubst %/,%,$(subst $(realpath $(QTOP))/,,$(CUR_DIR))) #################################################################### TREE_LIB_ENABLE=1 lib= subdirs= CFGFLAGS += -I${QTOP}/kernel/core/include CFGFLAGS += -I${QTOP}/kernel/evtdrv/include CFGFLAGS += -I${QTOP}/kernel/hal/include CFGFLAGS += -I${QTOP}/kernel/pm/include include ${QTOP}/qmk/generic/Make.tpl","title":"\u67d0\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u7684\u6240\u6709.c\uff0c\u7f16\u8bd1\u6210\u4e00\u4e2a.a\u5e93"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#_1","text":"\u8fd9\u7c7bMakefile\u7f16\u5199\u53c2\u8003 platform/Makefile \u3002 \u590d\u5236\u7c98\u8d34 \u4ee5\u4e0b Makefile \u5185\u5bb9\u5230\u6e90\u7801\u76ee\u5f55 Makefile\u3002 \u65e0\u9700\u4fee\u6539\u3002 \u6709\u7279\u522b\u7684CFLAG\u8bf7\u6839\u636e\u60c5\u51b5\u914d\u7f6e CFGFLAGS \u3002 \u6ce8\u610f subdirs= \u4e3a\u7a7a\uff0c\u9ed8\u8ba4\u4f1a\u8fdb\u5165\u6240\u6709\u5b50\u76ee\u5f55\u3002 \u5982\u679c\u9700\u8981\u6307\u5b9a\u5b50\u76ee\u5f55\u8bf7\u7ed9 subdirs \u8d4b\u503c\u3002 ################################################################### #automatic detection QTOP and LOCALDIR CUR_DIR := $(patsubst %/,%,$(dir $(realpath $(firstword $(MAKEFILE_LIST))))) TRYQTOP := $(shell if [ -n \"$$QTOP\" ] ; then\\ echo $$QTOP;\\ else\\ cd $(CUR_DIR); while /usr/bin/test ! -e qmk ; do \\ dir=`cd ../;pwd`; \\ if [ \"$$dir\" = \"/\" ] ; then \\ echo Cannot find QTOP in $(firstword $(MAKEFILE_LIST)) 1>&2; \\ exit 1; \\ fi ; \\ cd $$dir; \\ done ; \\ pwd; \\ fi) QTOP ?= $(realpath ${TRYQTOP}) ifeq ($(QTOP),) $(error Please run this in a tree) endif LOCALDIR = $(patsubst %/,%,$(subst $(realpath $(QTOP))/,,$(CUR_DIR))) #################################################################### TREE_LIB_ENABLE=0 lib= subdirs= include ${QTOP}/qmk/generic/Make.tpl","title":"\u5f53\u524d\u76ee\u5f55\u8fdb\u5165\u6240\u6709\u5b50\u76ee\u5f55\u3001\u8fdb\u5165\u6307\u5b9a\u76ee\u5f55\u7f16\u8bd1"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#board-packboard","text":"\u53c2\u8003 mk/board-pack/ \u4e0b\u7684\u5404\u4e2a\u6587\u4ef6\u3002 \u53c2\u8003 qmk/board-pack/bp.TencentOS_tiny_EVB_MX_Plus \u3002 board-pack \u662f\u5bf9 board \u5728\u7f16\u8bd1\u65f6\u7684\u4e00\u4e2a\u62bd\u8c61\u3002 \u4e00\u4e2aboard \u786e\u5b9a\u4e86 MCU\u3001 arch\u3001\u5de5\u5177\u94fe\uff0c\u628a\u8fd9\u4e9b\u7f16\u8bd1\u65f6\u53c2\u6570\u5199\u6210\u4e00\u4e2abp.xxx\u3002 \u65b0\u6574\u4e00\u4e2aboard-pack\u7684\u6b65\u9aa4\uff1a - qmk/board-pack/\u76ee\u5f55\u4e0b\uff0c\u65b0\u5efa\u4e00\u4e2abp.xxx. - \u5728bp.xxx\u5b9a\u4e49\u4ee5\u4e0b\u53d8\u91cf\uff1a \u6ce8\u610f CFGFLAGS \u9700\u8981\u5305\u62ec cpu\u3001arch\u3001board \u7b49\u7c7b\u578b\u7684FLAG\u3002 \u8d4b\u503c\u5efa\u8bae\u7528`+=`\uff0c\u4e0d\u5141\u8bb8\u7528 `:=`\u3002\u6ce8\u610f \u53ef\u4ee5\u5f15\u7528`QTOP`\uff0c`BLDROOT`\u53d8\u91cf,\u4e0d\u5efa\u8bae\u5f15\u7528\u5176\u4ed6`qmk/generic/`\u6a21\u677f\u7684\u53d8\u91cf\u3002 Makefile\u53d8\u91cf\u540d \u53d8\u91cf\u8d4b\u503c\u4e3e\u4f8b \u53d8\u91cf\u8bf4\u660e CROSS_COMPILE CROSS_COMPILE =arm-none-eabi- \u5de5\u5177\u94fe\u524d\u7f00 CC CC = $(CROSS_COMPILE)gcc \u5de5\u5177\u94fe CXX CXX = $(CROSS_COMPILE)g++ \u5de5\u5177\u94fe LD LD = $(CROSS_COMPILE)ld \u5de5\u5177\u94fe ARFLAGS ARFLAGS = -rc \u5de5\u5177\u94fe STRIP STRIP = $(CROSS_COMPILE)strip \u5de5\u5177\u94fe CFGFLAGS \u53c2\u8003 bp.TencentOS_tiny_EVB_MX_Plus \u5bf9CFLAGS\u3001CXXFLAGS \u8fdb\u884c\u589e\u52a0 ARCH_LSRCS \u53c2\u8003 bp.TencentOS_tiny_EVB_MX_Plus board-pack\u5bf9\u5e94\u7684arch/\u6e90\u7801\uff0c`make -C arch/\u65f6\u9700\u8981\u7f16\u8bd1\u7684\u6e90\u7801\uff0c\u7edd\u5bf9\u8def\u5f84\uff0c\u6216\u76f8\u5bf9\u4e8eQTOP\u7684\u76f8\u5bf9\u8def\u5f84 BSP_LSRCS \u53c2\u8003 bp.TencentOS_tiny_EVB_MX_Plus board-pack\u5bf9\u5e94\u7684board/bsp\u6e90\u7801 PLATFORM_VENDOR_BSP_LSRCS \u53c2\u8003 bp.TencentOS_tiny_EVB_MX_Plus board-pack\u5bf9\u5e94\u7684vendor_bsp \u6e90\u7801,`make -C platform/vendor_bsp\u65f6\u9700\u8981\u7f16\u8bd1\u7684\u6e90\u7801 PLATFORM_VENDOR_BSP_LSRCS \u53c2\u8003 bp.TencentOS_tiny_EVB_MX_Plus board-pack\u5bf9\u5e94\u7684vendor_bsp \u6e90\u7801,`make -C platform/vendor_bsp\u65f6\u9700\u8981\u7f16\u8bd1\u7684\u6e90\u7801 PLATFORM_HAL_LSRCS \u53c2\u8003 bp.TencentOS_tiny_EVB_MX_Plus board-pack\u5bf9\u5e94\u7684 hal \u6e90\u7801,`make -C platform/hal\u65f6","title":"\u65b0\u589e\u4e00\u4e2a board-pack\uff0c\u652f\u6301\u65b0\u7684board"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#qmk_4","text":"\u53d8\u91cf\u540d \u8d4b\u503c \u53d8\u91cf\u503c\u8bf4\u660e \u503c\u4e3e\u4f8b AR bp\u4e2d\u8d4b\u503c \u5de5\u5177\u94fe \"arm-none-eabi-ar\" ARCH_LSRCS bp\u4e2d\u8d4b\u503c \u8fdb\u5165arch/\u9700\u8981\u7f16\u8bd1\u7684\u6e90\u7801\uff0c\u7edd\u5bf9\u8def\u5f84\u6216\u76f8\u5bf9\u4e8eQTOP\u7684\u6e90\u7801\u8def\u5f84 \"/root/democode/TencentOS-tiny/arch/arm/arm-v7m/cortex-m4/gcc/port_c.c /root/democode/TencentOS-tiny/arch/arm/arm-v7m/cortex-m4/gcc/port_s.S /root/democode/TencentOS-tiny/arch/arm/arm-v7m/common/tos_fault.c /root/democode/TencentOS-tiny/arch/arm/arm-v7m/common/tos_cpu.c /root/democode/TencentOS-tiny/arch/arm/arm-v7m/cortex-m4/gcc/port_c.c /root/democode/TencentOS-tiny/arch/arm/arm-v7m/cortex-m4/gcc/port_s.S /root/democode/TencentOS-tiny/arch/arm/arm-v7m/common/tos_fault.c /root/democode/TencentOS-tiny/arch/arm/arm-v7m/common/tos_cpu.c \" ARFLAGS bp\u4e2d\u8d4b\u503c \u5de5\u5177\u94fe\u53c2\u6570 ar \u53c2\u6570,\u542b\u4e49\u89c1 ar --help BLDDIR \u7981\u6b62\u8d4b\u503c \u6807\u8bc6.o\u7b49\u7f16\u8bd1\u4ea7\u7269\u6240\u5728\u7684\u76ee\u5f55\uff0c\u8ddf\u6e90\u7801LOCALDIR\u6709\u5173 \"/root/democode/TencentOS-tiny/build/TencentOS_tiny_EVB_MX_Plus.arm-none-eabi-gcc.tos/arch\" BLDROOT \u7981\u6b62\u8d4b\u503c \u6807\u8bc6\u7f16\u8bd1\u4ea7\u7269\u4f4d\u7f6e\u76ee\u5f55\u3002 \"/root/democode/TencentOS-tiny/build/TencentOS_tiny_EVB_MX_Plus.arm-none-eabi-gcc.tos\" BLD_SUFFIX \u7981\u6b62\u8d4b\u503c \u7f16\u8bd1\u4ea7\u7269\u4f4d\u7f6e\u76ee\u5f55\u7684\u540e\u7f00\u540d BOBJS \u7981\u6b62\u8d4b\u503c \u6240\u6709OBJ\u96c6\u5408\uff0c\u7edd\u5bf9\u8def\u5f84 \"/root/democode/TencentOS-tiny/build/TencentOS_tiny_EVB_MX_Plus.arm-none-eabi-gcc.tos/arch/arm/arm-v7m/cortex-m4/gcc/port_c.o /root/democode/TencentOS-tiny/build/TencentOS_tiny_EVB_MX_Plus.arm-none-eabi-gcc.tos/arch/arm/arm-v7m/cortex-m4/gcc/port_s.o /root/democode/TencentOS-tiny/build/TencentOS_tiny_EVB_MX_Plus.arm-none-eabi-gcc.tos/arch/arm/arm-v7m/common/tos_fault.o /root/democode/TencentOS-tiny/build/TencentOS_tiny_EVB_MX_Plus.arm-none-eabi-gcc.tos/arch/arm/arm-v7m/common/tos_cpu.o\" CC bp\u4e2d\u8d4b\u503c \"arm-none-eabi-gcc\" CROSS_COMPILE \u5de5\u5177\u94fe \"arm-none-eabi-\" CURDIR \u7981\u6b62\u8d4b\u503c \u6807\u8bc6\u5f53\u524dMakefile \u6240\u5728\u7684\u76ee\u5f55 \"/root/democode/TencentOS-tiny/arch\" CUR_DIR \u7981\u6b62\u8d4b\u503c \u6807\u8bc6\u5f53\u524dMakefile \u6240\u5728\u7684\u76ee\u5f55 \"/root/democode/TencentOS-tiny/arch\" CUR_MK_NODE_DIR \u7981\u6b62\u8d4b\u503c \u6807\u8bc6\u5f53\u524dMakefile \u6240\u5728\u7684\u76ee\u5f55 \"/root/democode/TencentOS-tiny/arch\" CXX bp\u4e2d\u8d4b\u503c \"arm-none-eabi-g++\" LD bp\u4e2d\u8d4b\u503c \"arm-none-eabi-ld\" LDFLAGS bp\u4e2d\u8d4b\u503c \" \" LOBJS \u7981\u6b62\u8d4b\u503c OBJ\u6587\u4ef6\u96c6\u5408\uff0c\u76f8\u5bf9\u8def\u5f84\uff0c\u76f8\u5bf9\u4e8e\u5f53\u524dMakefile\u76ee\u5f55 \"arm/arm-v7m/cortex-m4/gcc/port_c.o arm/arm-v7m/cortex-m4/gcc/port_s.o arm/arm-v7m/common/tos_fault.o arm/arm-v7m/common/tos_cpu.o\" LOCALDIR \u7981\u6b62\u8d4b\u503c \u6e90\u7801\u76ee\u5f55\u4f4d\u7f6e\uff0c\u76f8\u5bf9\u8def\u5f84\uff0c\u76f8\u5bf9\u4e8eQTOP \"arch\" LSRCS \u7981\u6b62\u5728bp\u4e2d\u8d4b\u503c\uff0c\u53ef\u4ee5\u5728src-Makefile\u8d4b\u503c \u7f16\u8bd1\u6e90\u4ee3\u7801\u6587\u4ef6\u96c6\u5408\uff0c\u76f8\u5bf9\u8def\u5f84\uff0c\u76f8\u5bf9\u4e8e\u5f53\u524dMakefile\u76ee\u5f55\uff0c\u6216\u8005\u7edd\u5bf9\u8def\u5f84 \"arm/arm-v7m/cortex-m4/gcc/port_c.c arm/arm-v7m/cortex-m4/gcc/port_s.S arm/arm-v7m/common/tos_fault.c arm/arm-v7m/common/tos_cpu.c \" QTOP \u7981\u6b62\u8d4b\u503c \u6e90\u7801\u4e00\u7ea7\u76ee\u5f55 \"/root/democode/TencentOS-tiny\" RANLIB bp\u4e2d\u8d4b\u503c \"arm-none-eabi-ranlib\" STRIP bp\u4e2d\u8d4b\u503c \"arm-none-eabi-strip\" TREE_LIB_ENABLE src-Makefile\u8d4b\u503c\uff0c\u975e0 \u8868\u793a\u7f16\u8bd1\u6240\u6709\u5b50\u76ee\u5f55\u6e90\u7801 LSRCS\u662f\u5426\u628a\u5b50\u76ee\u5f55\u6e90\u7801 \"0\" lib \u4e0d\u5efa\u8bae\u8d4b\u503c .a \u5e93\u540d\u53d8\u91cf\uff0c\u9ed8\u8ba4\u76ee\u5f55\u540d \"libarch\" targetlib \u7981\u6b62\u8d4b\u503c \"/root/democode/TencentOS-tiny/build/TencentOS_tiny_EVB_MX_Plus.arm-none-eabi-gcc.tos/libarch.a\"","title":"Qmk \u7684\u6a21\u677f\u7684\u5185\u7f6e\u53d8\u91cf"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#qmk-make","text":"make help","title":"qmk\u7684 make \u547d\u4ee4\u884c\u53c2\u6570"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#make-v1-e1","text":"# verbose\u6253\u5370\u7f16\u8bd1\u65f6\u7684\u547d\u4ee4 make V=1 # \u8c03\u8bd5\u5934\u6587\u4ef6\u5305\u542b\uff0c\u5b8f\u6269\u5c55\u65f6\u5f88\u6709\u7528\uff0c\u4f1a\u5728\u751f\u6210`.o`\u6587\u4ef6\u7684\u540c\u65f6\u751f\u6210`.i`\u9884\u5904\u7406\u6587\u4ef6 make E=1 # verbose\u6253\u5370\u94fe\u63a5\u65f6\u7684\u5e93\u641c\u7d22\u8fc7\u7a0b make V=2 make V=3","title":"make V=1 E=1"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#makefile","text":"#\u8fdb\u5165\u542bMakefile\u7684\u76ee\u5f55 make BP=TencentOS_tiny_EVB_MX_Plus dm","title":"\u8c03\u8bd5Makefile"},{"location":"qmk/01.%20Intro_Qmk_A_Makefile_Framework_For_TencentOS/#qmk_5","text":"","title":"Qmk \u540e\u7eed"}]}